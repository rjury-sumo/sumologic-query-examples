# Linux - Cloud Security Monitoring and Analytics

## Searches

### Log Searches

- **Accounts Created**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Accounts Created**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Accounts Deleted**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Accounts Deleted**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Active Services Over Time**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Active Services Over Time**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Events by Service**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Events by Service**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Excessive Failed Access Attempts**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Excessive Failed Access Attempts**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Failed Logins**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Failed Logins**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Failed Logins**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Failed Logins**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Failed Logins**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Failed Logins**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Login Failure Outlier**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Login Failure Outlier**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Recent sudo Attempts**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **Recent sudo Attempts**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **Root Login Failures**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Root Login Failures**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Root Login Failures**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Root Login Failures**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Root Login Success**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Root Login Success**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Root Login Success**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Root Login Success**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Root User Logins - Failure**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Root User Logins - Failure**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Root User Logins - Success**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Root User Logins - Success**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Running Services (Daemons)**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Running Services (Daemons)**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Stopped Services**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Stopped Services**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Successful Logins**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Successful Logins**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Successful Logins**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Successful Logins**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **Successful Logins**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Successful Logins**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity 
- **sudo Attempt Outlier**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Attempt Outlier**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Attempts**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Attempts**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **sudo Attempts**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Attempts**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **sudo Attempts by Host**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Attempts by Host**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Attempts by User**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Attempts by User**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Failures**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Failures**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Failures Over Time**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **sudo Failures Over Time**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity 
- **System Stopped**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **System Stopped**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **System Time Change Attempt**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **System Time Change Attempt**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Total Services**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Total Services**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Total Services**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview 
- **Total Services**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Total Services Running by Host**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **Total Services Running by Host**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **User Account Created**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **User Account Created**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **User Account Deleted**: from Dashboard: Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring 
- **User Account Deleted**: from Dashboard: Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Linux - Cloud Security Monitoring and Analytics|Accounts Created|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory={{Logsdatasource}}  "useradd" and ("new user" or "new account")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<msg\>.+)\$" nodrop<br />\| parse field=msg "name=\*, UID=" as dest\_user nodrop<br />\| parse field=msg "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user, UID, GID, home, shell nodrop<br />\| parse field=msg ", shell=\*\\"" as shell nodrop<br />\| parse field=msg "account=\*, uid=\*, gid=\*, home=\*, shell=\*" as dest\_user, UID, GID, home, shell nodrop<br />\| parse field=msg "account=\*, uid=" as dest\_user nodrop<br />\| "Local Server" as type \| \_sourceHost as dest\_ip<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Accounts Created|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory = Labs/OS/linux/Security\* "useradd" and ("new user" or "new account")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<msg\>.+)\$" nodrop<br />\| parse field=msg "name=\*, UID=" as dest\_user nodrop<br />\| parse field=msg "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user, UID, GID, home, shell nodrop<br />\| parse field=msg ", shell=\*\\"" as shell nodrop<br />\| parse field=msg "account=\*, uid=\*, gid=\*, home=\*, shell=\*" as dest\_user, UID, GID, home, shell nodrop<br />\| parse field=msg "account=\*, uid=" as dest\_user nodrop<br />\| "Local Server" as type \| \_sourceHost as dest\_ip<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Accounts Deleted|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory = Labs/OS/linux/Security\* (("userdel" and "delete user") or "account deleted")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<msg\>.+)\$" nodrop<br />\| dest\_host as dest\_ip<br />\| parse field=msg "delete user '\*'" as dest\_user nodrop<br />\| parse "account=\*, group=\*, gid=" as dest\_user, dest\_group nodrop<br />\| parse "account=\*, uid=" as dest\_user nodrop <br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Accounts Deleted|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory={{Logsdatasource}}  (("userdel" and "delete user") or "account deleted")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<msg\>.+)\$" nodrop<br />\| dest\_host as dest\_ip<br />\| parse field=msg "delete user '\*'" as dest\_user nodrop<br />\| parse "account=\*, group=\*, gid=" as dest\_user, dest\_group nodrop<br />\| parse "account=\*, uid=" as dest\_user nodrop <br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Active Services Over Time|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}} <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice, service<br />\| transpose row \_timeslice column service|
|Linux - Cloud Security Monitoring and Analytics|Active Services Over Time|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\*<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice, service<br />\| transpose row \_timeslice column service|
|Linux - Cloud Security Monitoring and Analytics|Events by Service|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}} <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| count as eventCount by service<br />\| sort by eventCount|
|Linux - Cloud Security Monitoring and Analytics|Events by Service|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\*<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| count as eventCount by service<br />\| sort by eventCount|
|Linux - Cloud Security Monitoring and Analytics|Excessive Failed Access Attempts|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 5m<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, protocol, src\_host, src\_ip, src\_user<br />\| 5 as threshold<br />\| where eventCount \> threshold<br />\| sort by \_timeslice, dest\_host, dest\_user, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Excessive Failed Access Attempts|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 5m<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, protocol, src\_host, src\_ip, src\_user<br />\| 5 as threshold<br />\| where eventCount \> threshold<br />\| sort by \_timeslice, dest\_host, dest\_user, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Failed Logins|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Failed Logins|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Failed Logins|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user<br />\| sort by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Failed Logins|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory = Labs/OS/linux/Security\* ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Failed Logins|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Failed Logins|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user<br />\| sort by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Login Failure Outlier|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| outlier eventCount|
|Linux - Cloud Security Monitoring and Analytics|Login Failure Outlier|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| outlier eventCount|
|Linux - Cloud Security Monitoring and Analytics|Recent sudo Attempts|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory = Labs/OS/linux/Security\* "sudo"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, src\_user, dest\_user, src\_host, command<br />\| fields -eventCount<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Recent sudo Attempts|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory={{Logsdatasource}}  "sudo"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, src\_user, dest\_user, src\_host, command<br />\| fields -eventCount<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root Login Failures|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| where src\_user="root" or dest\_user="root"<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root Login Failures|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| where src\_user="root" or dest\_user="root"<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root Login Failures|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory = Labs/OS/linux/Security\* ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| where src\_user="root" or dest\_user="root"<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root Login Failures|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| where src\_user="root" or dest\_user="root"<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root Login Success|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory = Labs/OS/linux/Security\* ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| where src\_user="root" or dest\_user="root"<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root Login Success|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| where src\_user="root" or dest\_user="root"<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root Login Success|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| where src\_user="root" or dest\_user="root"<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root Login Success|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| where src\_user="root" or dest\_user="root"<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Root User Logins - Failure|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| where src\_user="root" or dest\_user="root"<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user<br />\| sort by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Root User Logins - Failure|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| where src\_user="root" or dest\_user="root"<br />\| if (message matches "sshd[\*", "ssh", "") as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user<br />\| sort by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Root User Logins - Success|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| where src\_user="root" or dest\_user="root"<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user<br />\| sort by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Root User Logins - Success|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| where src\_user="root" or dest\_user="root"<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user<br />\| sort by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Running Services (Daemons)|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\*<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| count as eventCount, first(\_messagetime) as latest, last(\_messagetime) as earliest by service, dest\_host <br />\| formatDate(fromMillis(latest),"MM/dd/yyyy HH:mm:ss Z") as %"LatestTime" <br />\| formatDate(fromMillis(earliest),"MM/dd/yyyy HH:mm:ss Z") as %"EarliestTime" <br />\| fields -latest, earliest, eventCount<br />\| sort by %"LatestTime" |
|Linux - Cloud Security Monitoring and Analytics|Running Services (Daemons)|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}} <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| count as eventCount, first(\_messagetime) as latest, last(\_messagetime) as earliest by service, dest\_host <br />\| formatDate(fromMillis(latest),"MM/dd/yyyy HH:mm:ss Z") as %"LatestTime" <br />\| formatDate(fromMillis(earliest),"MM/dd/yyyy HH:mm:ss Z") as %"EarliestTime" <br />\| fields -latest, earliest, eventCount<br />\| sort by %"LatestTime" |
|Linux - Cloud Security Monitoring and Analytics|Stopped Services|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}}  (rsyslog or rsyslogd or syslog or ossec or ntpd) and (stopped or "exiting on signal 15" or start\*)<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<service\>\\w\*)\\[\\d+\\]:\\s+ntpd (?\<state\>[\\s\\S]\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<service\>\\w\*):\\s+\\[[\\s\\S]\*\\] (?\<state\>[\\s\\S]\*)\$" nodrop<br />\| if (state in ("exiting on signal 15", "exiting on signal 15."), "stopped", if (state in ("start"), "running", if (state in ("(re)start"), "restarted","unknown"))) as state<br />\| where state != "unknown"<br />\| \_sourceHost as src\_host \| src\_host as dest\_host<br />\| where dest\_ip matches "{{dest\_ip}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| count as eventCount, first(\_messagetime) as latest, last(\_messagetime) as earliest by dest\_host, service, state<br />\| formatDate(fromMillis(latest),"MM/dd/yyyy HH:mm:ss Z") as %"LatestTime" <br />\| formatDate(fromMillis(earliest),"MM/dd/yyyy HH:mm:ss Z") as %"EarliestTime" <br />\| fields -latest, earliest, eventCount<br />\| where state="stopped"<br />\| sort by - %"LatestTime" |
|Linux - Cloud Security Monitoring and Analytics|Stopped Services|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\* (rsyslog or rsyslogd or syslog or ossec or ntpd) and (stopped or "exiting on signal 15" or start\*)<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<service\>\\w\*)\\[\\d+\\]:\\s+ntpd (?\<state\>[\\s\\S]\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<service\>\\w\*):\\s+\\[[\\s\\S]\*\\] (?\<state\>[\\s\\S]\*)\$" nodrop<br />\| if (state in ("exiting on signal 15", "exiting on signal 15."), "stopped", if (state in ("start"), "running", if (state in ("(re)start"), "restarted","unknown"))) as state<br />\| where state != "unknown"<br />\| \_sourceHost as src\_host \| src\_host as dest\_host<br />\| where dest\_ip matches "{{dest\_ip}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| count as eventCount, first(\_messagetime) as latest, last(\_messagetime) as earliest by dest\_host, service, state<br />\| formatDate(fromMillis(latest),"MM/dd/yyyy HH:mm:ss Z") as %"LatestTime" <br />\| formatDate(fromMillis(earliest),"MM/dd/yyyy HH:mm:ss Z") as %"EarliestTime" <br />\| fields -latest, earliest, eventCount<br />\| where state="stopped"<br />\| sort by - %"LatestTime" |
|Linux - Cloud Security Monitoring and Analytics|Successful Logins|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user<br />\| sort by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Successful Logins|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory = Labs/OS/linux/Security\* ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Successful Logins|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Successful Logins|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user<br />\| sort by \_timeslice, dest\_host, dest\_user, message, protocol, src\_host, src\_ip, src\_user|
|Linux - Cloud Security Monitoring and Analytics|Successful Logins|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory = Labs/OS/linux/Security\* ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|Successful Logins|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Login Activity|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<\_sourceHost\>\\S\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?:\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse field=message "pam\_unix(\*:\*):" as deamon, ltype nodrop \| if (deamon="sshd", "ssh", "") as protocol \| fields -deamon, ltype<br />\| parse "session \* for user \* by \*(uid=" as action, dest\_user, src\_user nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "rhost=\* " as src\_host nodrop<br />\| parse "Accepted \* for \* from \* port \* \*" as type, dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\| if (isEmpty(message),"Authentication successful",message) as message<br />\| if (isEmpty(src\_host),\_sourceHost,src\_host) as src\_host \| src\_host as src\_ip<br />\| if (isEmpty(src\_user),dest\_user,src\_user) as src\_user<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where src\_host matches "{{src\_host}}"<br />\| where src\_ip matches "{{src\_ip}}"<br />\| where src\_user matches "{{src\_user}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempt Outlier|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory = Labs/OS/linux/Security\*  sudo<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier eventCount|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempt Outlier|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory={{Logsdatasource}}   sudo<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier eventCount|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempts|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory={{Logsdatasource}}  sudo<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempts|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory={{Logsdatasource}}  sudo<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| where process="sudo"<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempts|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory = Labs/OS/linux/Security\* sudo<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempts|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory = Labs/OS/linux/Security\* sudo<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| where process="sudo"<br />\| timeslice 1m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempts by Host|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory={{Logsdatasource}}   sudo<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| count as eventCount by dest\_host<br />\| sort eventCount, dest\_host|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempts by Host|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory = Labs/OS/linux/Security\*  sudo<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| count as eventCount by dest\_host<br />\| sort eventCount, dest\_host|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempts by User|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory = Labs/OS/linux/Security\*  sudo<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| count as eventCount by dest\_user, src\_user<br />\| sort eventCount, dest\_user, src\_user|
|Linux - Cloud Security Monitoring and Analytics|sudo Attempts by User|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory={{Logsdatasource}}   sudo<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| count as eventCount by dest\_user, src\_user<br />\| sort eventCount, dest\_user, src\_user|
|Linux - Cloud Security Monitoring and Analytics|sudo Failures|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory={{Logsdatasource}}  sudo "user NOT in sudoers"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| fields dest\_user, src\_user, dest\_host, tty, workingdirectory \| fields -\_raw<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|sudo Failures|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory = Labs/OS/linux/Security\* sudo "user NOT in sudoers"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| fields dest\_user, src\_user, dest\_host, tty, workingdirectory \| fields -\_raw<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|sudo Failures Over Time|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory={{Logsdatasource}}  sudo "user NOT in sudoers"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| fields dest\_user, src\_user, dest\_host, tty, workingdirectory \| fields -\_raw<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|sudo Failures Over Time|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - Privileged Activity|\_sourceCategory = Labs/OS/linux/Security\* sudo "user NOT in sudoers"<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| \_sourceHost as dest\_host<br />\| extract "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "TTY=\* ; PWD=\* ;" as tty, workingdirectory nodrop<br />\| parse "USER=\* ;" as dest\_user nodrop<br />\| where process="sudo"<br />\| where src\_user matches "{{src\_user}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| fields dest\_user, src\_user, dest\_host, tty, workingdirectory \| fields -\_raw<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| sort \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|System Stopped|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}}  "kernel: Kernel logging (proc) stopped." <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| "Linux OS Stopped" as msg\_summary <br />\| msg\_summary as message \| fields -msg\_summary<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, message<br />\| fields -eventCount<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|System Stopped|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\* "kernel: Kernel logging (proc) stopped." <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| "Linux OS Stopped" as msg\_summary <br />\| msg\_summary as message \| fields -msg\_summary<br />\| where dest\_host matches "{{dest\_host}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, message<br />\| fields -eventCount<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|System Time Change Attempt|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}}  (sudo and ((COMMAND date) or "ntpd stop" or (ntpd synchronized) or (ln and localtime)))<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?\<message\>.+)\$" nodrop<br />\| extract "sudo:\\s+(?\<src\_user\>[^ ]+?)\\s:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "synchronized to \*," as src\_host nodrop <br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip \| src\_host as dest\_host<br />\| where (message matches "\*date \*") or (message matches "\*date\*") or (message matches "\*synchronized to\*") or (message matches "\*ntpd stop\*") or (message matches "\*ln\*localtime")<br />\| if (message matches "\*synchronized to\*","Change/Configuration/SystemTime/Success","Change/Configuration/SystemTime/Attempt") as classification <br />\| if (message matches "\*synchronized to\*","System Time Synchronized", "System Time Change attempt") as message<br />\| where message="System Time Change attempt"<br />\| where dest\_ip matches "{{dest\_ip}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, src\_host, src\_user, dest\_user|
|Linux - Cloud Security Monitoring and Analytics|System Time Change Attempt|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\* (sudo and ((COMMAND date) or "ntpd stop" or (ntpd synchronized) or (ln and localtime)))<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_host\>\\S\*)\\s(?\<message\>.+)\$" nodrop<br />\| extract "sudo:\\s+(?\<src\_user\>[^ ]+?)\\s:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "synchronized to \*," as src\_host nodrop <br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip \| src\_host as dest\_host<br />\| where (message matches "\*date \*") or (message matches "\*date\*") or (message matches "\*synchronized to\*") or (message matches "\*ntpd stop\*") or (message matches "\*ln\*localtime")<br />\| if (message matches "\*synchronized to\*","Change/Configuration/SystemTime/Success","Change/Configuration/SystemTime/Attempt") as classification <br />\| if (message matches "\*synchronized to\*","System Time Synchronized", "System Time Change attempt") as message<br />\| where message="System Time Change attempt"<br />\| where dest\_ip matches "{{dest\_ip}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, src\_host, src\_user, dest\_user|
|Linux - Cloud Security Monitoring and Analytics|Total Services|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory={{Logsdatasource}} <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| count as eventCount by service<br />\| count as services|
|Linux - Cloud Security Monitoring and Analytics|Total Services|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}} <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| count as eventCount by service \| count as services|
|Linux - Cloud Security Monitoring and Analytics|Total Services|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Monitoring - Overview|\_sourceCategory = Labs/OS/linux/Security\*<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| count as eventCount by service<br />\| count as services|
|Linux - Cloud Security Monitoring and Analytics|Total Services|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\*<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| count as eventCount by service \| count as services|
|Linux - Cloud Security Monitoring and Analytics|Total Services Running by Host|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\*<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| count dest\_host, service \| count as %"ServiceRunningCount" by dest\_host<br />\| sort by %"ServiceRunningCount", dest\_host|
|Linux - Cloud Security Monitoring and Analytics|Total Services Running by Host|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}} <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<message\>.+)\$" nodrop<br />\| if (isEmpty(dest\_host), \_sourceHost, dest\_host) as dest\_host<br />\| parse regex "(?\<service\>\\w\*)\\[\\d+\\]:\\s+" <br />\| where !isEmpty(service)<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where process matches "{{process}}"<br />\| count dest\_host, service \| count as %"ServiceRunningCount" by dest\_host<br />\| sort by %"ServiceRunningCount", dest\_host|
|Linux - Cloud Security Monitoring and Analytics|User Account Created|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}}  "useradd" and ("new user" or "new account")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<msg\>.+)\$" nodrop<br />\| parse field=msg "name=\*, UID=" as dest\_user nodrop<br />\| parse field=msg "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user, UID, GID, home, shell nodrop<br />\| parse field=msg ", shell=\*\\"" as shell nodrop<br />\| parse field=msg "account=\*, uid=\*, gid=\*, home=\*, shell=\*" as dest\_user, UID, GID, home, shell nodrop<br />\| parse field=msg "account=\*, uid=" as dest\_user nodrop<br />\| "Local Server" as type<br />\| \_sourceHost as dest\_ip<br />\| where dest\_ip matches "{{dest\_ip}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where process matches "{{process}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, process, UID, GID, home, shell, type<br />\| fields -eventCount<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|User Account Created|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\* "useradd" and ("new user" or "new account")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<msg\>.+)\$" nodrop<br />\| parse field=msg "name=\*, UID=" as dest\_user nodrop<br />\| parse field=msg "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user, UID, GID, home, shell nodrop<br />\| parse field=msg ", shell=\*\\"" as shell nodrop<br />\| parse field=msg "account=\*, uid=\*, gid=\*, home=\*, shell=\*" as dest\_user, UID, GID, home, shell nodrop<br />\| parse field=msg "account=\*, uid=" as dest\_user nodrop<br />\| "Local Server" as type<br />\| \_sourceHost as dest\_ip<br />\| where dest\_ip matches "{{dest\_ip}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where process matches "{{process}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, process, UID, GID, home, shell, type<br />\| fields -eventCount<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|User Account Deleted|Logs|Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory = Labs/OS/linux/Security\* (("userdel" and "delete user") or "account deleted")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<msg\>.+)\$" nodrop<br />\| dest\_host as dest\_ip<br />\| parse field=msg "delete user '\*'" as dest\_user nodrop<br />\| parse "account=\*, group=\*, gid=" as dest\_user, dest\_group nodrop<br />\| parse "account=\*, uid=" as dest\_user nodrop <br />\| where dest\_ip matches "{{dest\_ip}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where process matches "{{process}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, process, dest\_group<br />\| fields -eventCount<br />\| sort by \_timeslice|
|Linux - Cloud Security Monitoring and Analytics|User Account Deleted|Logs|Installed Apps/Linux - Cloud Security Monitoring and Analytics/Linux - Security Analytics - User, Service, and System Monitoring|\_sourceCategory={{Logsdatasource}}  (("userdel" and "delete user") or "account deleted")<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S+)\\s+\\w\*" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_host\>\\S\*)\\s+(?\<process\>\\w\*)(?:\\[\\d+\\]:\|:)\\s\*(?\<msg\>.+)\$" nodrop<br />\| dest\_host as dest\_ip<br />\| parse field=msg "delete user '\*'" as dest\_user nodrop<br />\| parse "account=\*, group=\*, gid=" as dest\_user, dest\_group nodrop<br />\| parse "account=\*, uid=" as dest\_user nodrop <br />\| where dest\_ip matches "{{dest\_ip}}"<br />\| where dest\_host matches "{{dest\_host}}"<br />\| where dest\_user matches "{{dest\_user}}"<br />\| where process matches "{{process}}"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, dest\_host, dest\_user, process, dest\_group<br />\| fields -eventCount<br />\| sort by \_timeslice|

