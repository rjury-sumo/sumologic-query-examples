# HAProxy - OpenTelemetry

## Searches

### Log Searches

- **Backend Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Error Log Analysis 
- **Backend Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis 
- **Bytes Served**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight 
- **Bytes Served**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight 
- **Bytes Served - Outlier**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Outlier Analysis 
- **Bytes Served - Outlier**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Outlier Analysis 
- **Client Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Outlier Analysis 
- **Client Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Outlier Analysis 
- **Client Locations - 4xx Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types 
- **Client Locations - 4xx Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Access Types 
- **Client Locations - 4xx Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Web Server Operations 
- **Client Locations - 4xx Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations 
- **Client Locations with Critical Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis 
- **Client Locations with Critical Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Error Log Analysis 
- **Critical Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis 
- **Critical Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Error Log Analysis 
- **Highly Malicious Threats**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Threat Analysis 
- **Highly Malicious Threats**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis 
- **HTTP Methods**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight 
- **HTTP Methods**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight 
- **Media Types Served**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight 
- **Media Types Served**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight 
- **Non 200 Response Status Codes**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types 
- **Non 200 Response Status Codes**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Access Types 
- **Non 200 Response Status Codes**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations 
- **Non 200 Response Status Codes**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Web Server Operations 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Trends 
- **Number of Visitors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Outlier Analysis 
- **Number of Visitors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Outlier Analysis 
- **Responses Over Time**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Trends 
- **Responses Over Time**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Overview 
- **Responses Over Time**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Responses Over Time**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends 
- **Server Down Events**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Error Log Analysis 
- **Server Down Events**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis 
- **Server Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Outlier Analysis 
- **Server Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Outlier Analysis 
- **Threat Count**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis 
- **Threat Count**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Threat Analysis 
- **Threat Locations**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Threat Analysis 
- **Threat Locations**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis 
- **Threats by Actors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis 
- **Threats by Actors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Threat Analysis 
- **Threats by Malicious Confidence**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Threat Analysis 
- **Threats by Malicious Confidence**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis 
- **Threats by Source**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Threat Analysis 
- **Threats by Source**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight 
- **Top 10 Threats**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Threat Analysis 
- **Top 10 Threats**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Web Server Operations 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Access Types 
- **Top 5 Clients Causing Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis 
- **Top 5 Clients Causing Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Error Log Analysis 
- **Top 5 Highly Malicious URLs**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Threat Analysis 
- **Top 5 Highly Malicious URLs**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis 
- **Top 5 Referrers**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight 
- **Top 5 Referrers**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight 
- **Top 5 Urls**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight 
- **Top 5 Urls**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight 
- **Top 5 URLs Causing 4xx Responses**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations 
- **Top 5 URLs Causing 4xx Responses**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Web Server Operations 
- **Top 5 URLs Causing 4xx Responses**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types 
- **Top 5 URLs Causing 4xx Responses**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Access Types 
- **Top 5 URLs with Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Top 5 URLs with Errors**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Overview 
- **Traffic Distribution by Server**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends 
- **Traffic Distribution by Server**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Trends 
- **Traffic Volume and Bytes Served**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Trends 
- **Traffic Volume and Bytes Served**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends 
- **United States**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Locations 
- **United States**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Locations 
- **Visitor Locations**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Visitor Locations**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Overview 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Trends 
- **Visitor Platforms**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types 
- **Visitor Platforms**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Access Types 
- **Visitor Platforms**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Web Server Operations 
- **Visitor Platforms**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations 
- **Visits by Country Over Time**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Locations 
- **Visits by Country Over Time**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Locations 
- **Visits by US Regions Over Time**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Locations 
- **Visits by US Regions Over Time**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Locations 
- **Worldwide**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Locations 
- **Worldwide**: from Dashboard: HAProxy - OpenTelemetry/HAProxy - Visitor Locations

### Metric Searches

- **4xx Responses**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Availability - Redispatch Warnings/ Retry Warnings**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Availability - Redispatch/Retry Warnings**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **Average Latency**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Average Latency**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **Backend Connection Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **Backend Denials**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Backend Network Traffic**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Backend Queue**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Backend Server Connection Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Bytes - IN**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics 
- **Bytes - OUT**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics 
- **Bytes In**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Bytes In**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **Bytes Out**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Bytes Out**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **Connections Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Current Session Count**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **Current Sessions**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics 
- **Current Sessions/s**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Failed Health Checks**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Frontend Denials**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Frontend Network Traffic**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Frontend Requests / Second**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **HTTP Response Codes**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **HTTP Response Codes**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **HTTP Response Codes (Total)**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics 
- **HTTP Response Codes Ratio 4xx**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics 
- **HTTP Response Codes Ratio 5xx**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics 
- **Percent of 4XX HTTP Response Codes**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **Percent of 5XX HTTP Response Codes**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics 
- **Percent of 5XX HTTP Response Codes**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Percentage of 3xx Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Percentage of 4xx Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Percentage of 5xx Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview 
- **Request Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics 
- **Requests Denied**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics 
- **Response Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics 
- **Response Errors**: from Dashboard: Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|HAProxy - OpenTelemetry/Metrics|4xx Responses|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=4xx deployment.environment={{deployment.environment}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry/Metrics|Availability - Redispatch Warnings/ Retry Warnings|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.requests.redispatched deployment.environment={{deployment.environment}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND ) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name  ={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry/Metrics|Availability - Redispatch/Retry Warnings|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.requests.redispatched haproxy.service\_name=backend deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name ={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name|
|HAProxy - OpenTelemetry/Metrics|Average Latency|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.sessions.average haproxy.service\_name=backend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| avg by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name|
|HAProxy - OpenTelemetry/Metrics|Average Latency|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.sessions.average deployment.environment={{deployment.environment}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}}  \| avg by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry/Metrics|Backend Connection Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.connections.errors haproxy.service\_name=backend deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}   haproxy.proxy\_name={{haproxy.proxy\_name}} \| filter latest \> 0|
|HAProxy - OpenTelemetry|Backend Denials|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.responses.denied haproxy.service\_name=backend  deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}   haproxy.proxy\_name={{haproxy.proxy\_name}} webengine.system=haproxy \| sum by webengine.node.name,webengine.cluster.name|
|HAProxy - OpenTelemetry/Logs|Backend Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy backend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+backend\\s+(?\<frontend\_name\>\\S+)\\s+(?\<msg\>.\*)" nodrop<br />\| where length(frontend\_name) \> 0<br />\| timeslice 1s<br />\| count as count by \_timeslice, webengine.cluster.name, frontend\_name, msg<br />\| fields -count|
|HAProxy - OpenTelemetry|Backend Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy backend<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+backend\\s+(?\<frontend\_name\>\\S+)\\s+(?\<msg\>.\*)" nodrop<br />\| where length(frontend\_name) \> 0<br />\| timeslice 1s<br />\| count as count by \_timeslice, webengine.cluster.name, frontend\_name, msg<br />\| fields -count|
|HAProxy - OpenTelemetry|Backend Network Traffic|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.bytes.input haproxy.service\_name=backend  deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}   haproxy.proxy\_name={{haproxy.proxy\_name}} webengine.system=haproxy \| sum by webengine.node.name,webengine.cluster.name|
|HAProxy - OpenTelemetry|Backend Queue|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.requests.queued haproxy.service\_name=backend deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}   haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum |
|HAProxy - OpenTelemetry/Metrics|Backend Server Connection Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.connections.errors deployment.environment={{deployment.environment}}  (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND ) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name  ={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry/Metrics|Bytes - IN|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics|sumo.datasource=haproxy metric=haproxy.bytes.input haproxy.service\_name=frontend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name, webengine.node.name, haproxy.proxy\_name  |
|HAProxy - OpenTelemetry/Metrics|Bytes - OUT|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics|sumo.datasource=haproxy metric=haproxy.bytes.output haproxy.service\_name=frontend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name, webengine.node.name, haproxy.proxy\_name  |
|HAProxy - OpenTelemetry/Metrics|Bytes In|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.bytes.input deployment.environment={{deployment.environment}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name  ={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}} \|avg by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry/Metrics|Bytes In|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.bytes.input haproxy.service\_name=backend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}}\| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name|
|HAProxy - OpenTelemetry/Metrics|Bytes Out|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.bytes.output haproxy.service\_name={{haproxy.service\_name}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND) deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}} \| avg by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry/Metrics|Bytes Out|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.bytes.output haproxy.service\_name=backend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name ={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}}\| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name|
|HAProxy - OpenTelemetry|Bytes Served|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| sum(bytes\_read) as Bytes\_Served<br />\| Bytes\_Served/(1024\*1024\*1024) as Gbytes\_Served<br />\| fields Gbytes\_Served|
|HAProxy - OpenTelemetry/Logs|Bytes Served|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| sum(bytes\_read) as Bytes\_Served<br />\| Bytes\_Served/(1024\*1024\*1024) as Gbytes\_Served<br />\| fields Gbytes\_Served|
|HAProxy - OpenTelemetry|Bytes Served - Outlier|Logs|HAProxy - OpenTelemetry/HAProxy - Outlier Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where bytes\_read != "-" and !isEmpty(bytes\_read)<br />\| number(bytes\_read)<br />\| (bytes\_read/(1024\*1024)) as mbytes <br />\| timeslice {{timeslice}}<br />\| sum(mbytes) as mbytes by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier mbytes window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|HAProxy - OpenTelemetry/Logs|Bytes Served - Outlier|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Outlier Analysis|webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where bytes\_read != "-" and !isEmpty(bytes\_read)<br />\| number(bytes\_read)<br />\| (bytes\_read/(1024\*1024)) as mbytes <br />\| timeslice {{timeslice}}<br />\| sum(mbytes) as mbytes by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier mbytes window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|HAProxy - OpenTelemetry|Client Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Outlier Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where (status\_code matches "4\*") <br />\| timeslice {{timeslice}}<br />\| count as client\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier client\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|HAProxy - OpenTelemetry/Logs|Client Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Outlier Analysis|webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where (status\_code matches "4\*") <br />\| timeslice {{timeslice}}<br />\| count as client\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier client\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|HAProxy - OpenTelemetry|Client Locations - 4xx Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*" <br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip|
|HAProxy - OpenTelemetry/Logs|Client Locations - 4xx Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*" <br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip|
|HAProxy - OpenTelemetry|Client Locations - 4xx Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)" <br />\| where status\_code matches "4\*" <br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip|
|HAProxy - OpenTelemetry/Logs|Client Locations - 4xx Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)" <br />\| where status\_code matches "4\*" <br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip|
|HAProxy - OpenTelemetry|Client Locations with Critical Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)/1:\\s+(?\<msg\>.\*)"<br />\| where length(msg) \> 0<br />\| where !isEmpty(c\_ip)<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude)|
|HAProxy - OpenTelemetry/Logs|Client Locations with Critical Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)/1:\\s+(?\<msg\>.\*)"<br />\| where length(msg) \> 0<br />\| where !isEmpty(c\_ip)<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude)|
|HAProxy - OpenTelemetry|Connections Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.connections.errors haproxy.service\_name=backend deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}   haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by metric|
|HAProxy - OpenTelemetry|Critical Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)/1:\\s+(?\<msg\>.\*)"<br />\| where length(msg) \> 0<br />\| timeslice 1s<br />\| count as count by \_timeslice, webengine.cluster.name, c\_ip, frontend\_name, msg<br />\| sort by \_timeslice<br />\| limit 100|
|HAProxy - OpenTelemetry/Logs|Critical Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)/1:\\s+(?\<msg\>.\*)"<br />\| where length(msg) \> 0<br />\| timeslice 1s<br />\| count as count by \_timeslice, webengine.cluster.name, c\_ip, frontend\_name, msg<br />\| sort by \_timeslice<br />\| limit 100|
|HAProxy - OpenTelemetry/Metrics|Current Session Count|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy  metric=haproxy.sessions.count  haproxy.service\_name=backend deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name  ={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name |
|HAProxy - OpenTelemetry/Metrics|Current Sessions|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics|sumo.datasource=haproxy metric=haproxy.sessions.count haproxy.service\_name=frontend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| avg by webengine.cluster.name, webengine.node.name, haproxy.proxy\_name|
|HAProxy - OpenTelemetry/Metrics|Current Sessions/s|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy  metric=haproxy.sessions.count deployment.environment={{deployment.environment}}  (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND ) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name  ={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name |
|HAProxy - OpenTelemetry/Metrics|Failed Health Checks|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.failed\_checks deployment.environment={{deployment.environment}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry|Frontend Denials|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.responses.denied haproxy.service\_name=frontend deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}   haproxy.proxy\_name={{haproxy.proxy\_name}} webengine.system=haproxy \| sum by webengine.node.name,webengine.cluster.name|
|HAProxy - OpenTelemetry|Frontend Network Traffic|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.bytes.input haproxy.service\_name=frontend  deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}   haproxy.proxy\_name={{haproxy.proxy\_name}} webengine.system=haproxy \| sum by webengine.node.name,webengine.cluster.name|
|HAProxy - OpenTelemetry|Frontend Requests / Second|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.sessions.rate haproxy.service\_name=frontend deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}   haproxy.proxy\_name={{haproxy.proxy\_name}} webengine.system=haproxy \| sum by webengine.node.name,webengine.cluster.name|
|HAProxy - OpenTelemetry|Highly Malicious Threats|Logs|HAProxy - OpenTelemetry/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as threat\_count by c\_ip, method, status\_code, bytes\_read, referrer, user\_agent, request<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence) and malicious\_confidence matches "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(threat\_count) as threat\_count by c\_ip, method, status\_code, bytes\_read, referrer, user\_agent, request, malicious\_confidence, actor<br />\| sort by threat\_count<br />\| limit 20|
|HAProxy - OpenTelemetry/Logs|Highly Malicious Threats|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as threat\_count by c\_ip, method, status\_code, bytes\_read, referrer, user\_agent, request<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence) and malicious\_confidence matches "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(threat\_count) as threat\_count by c\_ip, method, status\_code, bytes\_read, referrer, user\_agent, request, malicious\_confidence, actor<br />\| sort by threat\_count<br />\| limit 20|
|HAProxy - OpenTelemetry|HTTP Methods|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !isBlank(method)<br />\| count as count by method<br />\| sort by count, method asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|HTTP Methods|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !isBlank(method)<br />\| count as count by method<br />\| sort by count, method asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Metrics|HTTP Response Codes|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=\* haproxy.service\_name=backend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| parse field=status\_code \*  as code \| avg by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,code|
|HAProxy - OpenTelemetry/Metrics|HTTP Response Codes|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=\* deployment.environment={{deployment.environment}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}}\| parse field=status\_code \*  as code \| avg by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,code,haproxy.service\_name|
|HAProxy - OpenTelemetry/Metrics|HTTP Response Codes (Total)|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=\* haproxy.service\_name=frontend deployment.environment={{deployment.environment}}  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name, webengine.node.name|
|HAProxy - OpenTelemetry/Metrics|HTTP Response Codes Ratio 4xx|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=\* haproxy.service\_name=frontend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name, webengine.node.name, haproxy.proxy\_name |
|HAProxy - OpenTelemetry/Metrics|HTTP Response Codes Ratio 5xx|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=\* haproxy.service\_name=frontend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name, webengine.node.name, haproxy.proxy\_name |
|HAProxy - OpenTelemetry/Logs|Media Types Served|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| parse regex field=request "^/[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$" nodrop<br />\| parse regex field=request "/\\S+?(?\<email\_prefix\>(?:%40\|@)[^.]+?)\\.\\w+" nodrop<br />\| where email\_prefix = "" and !isBlank(type)<br />\| count as count by type<br />\| sort count, type asc|
|HAProxy - OpenTelemetry|Media Types Served|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| parse regex field=request "^/[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$" nodrop<br />\| parse regex field=request "/\\S+?(?\<email\_prefix\>(?:%40\|@)[^.]+?)\\.\\w+" nodrop<br />\| where email\_prefix = "" and !isBlank(type)<br />\| count as count by type<br />\| sort count, type asc|
|HAProxy - OpenTelemetry/Logs|Non 200 Response Status Codes|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)"<br />\| where !(status\_code matches "2\*")<br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|HAProxy - OpenTelemetry/Logs|Non 200 Response Status Codes|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !(status\_code matches "2\*")<br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|HAProxy - OpenTelemetry|Non 200 Response Status Codes|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)"<br />\| where !(status\_code matches "2\*")<br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|HAProxy - OpenTelemetry|Non 200 Response Status Codes|Logs|HAProxy - OpenTelemetry/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !(status\_code matches "2\*")<br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|HAProxy - OpenTelemetry/Logs|Number of Hits by Server - One Day Time Comparison|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| count as Number\_of\_Hits by host.name  <br />\| compare with timeshift 1d|
|HAProxy - OpenTelemetry|Number of Hits by Server - One Day Time Comparison|Logs|HAProxy - OpenTelemetry/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| count as Number\_of\_Hits by host.name  <br />\| compare with timeshift 1d|
|HAProxy - OpenTelemetry/Logs|Number of Visitors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Outlier Analysis|webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !isEmpty(c\_ip)<br />\| timeslice {{timeslice}}<br />\| count as hits by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier hits window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|HAProxy - OpenTelemetry|Number of Visitors|Logs|HAProxy - OpenTelemetry/HAProxy - Outlier Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !isEmpty(c\_ip)<br />\| timeslice {{timeslice}}<br />\| count as hits by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier hits window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|HAProxy - OpenTelemetry/Metrics|Percent of 4XX HTTP Response Codes|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=4xx haproxy.service\_name=backend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name|
|HAProxy - OpenTelemetry/Metrics|Percent of 5XX HTTP Response Codes|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=5xx haproxy.service\_name=backend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name|
|HAProxy - OpenTelemetry/Metrics|Percent of 5XX HTTP Response Codes|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=5xx deployment.environment={{deployment.environment}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}} \| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry|Percentage of 3xx Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=\*  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name,haproxy.service\_name,webengine.node.name|
|HAProxy - OpenTelemetry|Percentage of 4xx Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=\*  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name,haproxy.service\_name,webengine.node.name|
|HAProxy - OpenTelemetry|Percentage of 5xx Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy metric=haproxy.requests.total status\_code=\*  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name,haproxy.service\_name,webengine.node.name|
|HAProxy - OpenTelemetry/Metrics|Request Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics|sumo.datasource=haproxy metric=haproxy.requests.errors haproxy.service\_name=frontend webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name, webengine.node.name, haproxy.proxy\_name |
|HAProxy - OpenTelemetry/Metrics|Requests Denied|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Frontend Metrics|sumo.datasource=haproxy metric=haproxy.requests.denied haproxy.service\_name=frontend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} \| sum by webengine.cluster.name, webengine.node.name, haproxy.proxy\_name |
|HAProxy - OpenTelemetry/Metrics|Response Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Server Metrics|sumo.datasource=haproxy metric=haproxy.responses.errors deployment.environment={{deployment.environment}} (!haproxy.service\_name=BACKEND  and !haproxy.service\_name=FRONTEND) webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} haproxy.proxy\_name={{haproxy.proxy\_name}} haproxy.service\_name={{haproxy.service\_name}}\| sum by webengine.cluster.name,webengine.node.name,haproxy.proxy\_name,haproxy.service\_name|
|HAProxy - OpenTelemetry/Metrics|Response Errors|Metrics|Installed Apps/HAProxy - OpenTelemetry/Metrics/HAProxy - Backend Metrics|sumo.datasource=haproxy metric=haproxy.responses.errors haproxy.service\_name=backend deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} <br />webengine.node.name={{webengine.node.name}}  haproxy.proxy\_name={{haproxy.proxy\_name}} \| filter latest \> 0|
|HAProxy - OpenTelemetry/Logs|Responses Over Time|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| if(status\_code matches "2\*", 1, 0) as successes <br />\| if(status\_code matches "3\*", 1, 0) as redirects <br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 5m<br />\| sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice|
|HAProxy - OpenTelemetry|Responses Over Time|Logs|HAProxy - OpenTelemetry/HAProxy - Overview|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| !isEmpty(c\_ip)<br />\| if(status\_code matches "2\*", 1, 0) as Successes <br />\| if(status\_code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(status\_code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 5m<br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc<br />|
|HAProxy - OpenTelemetry|Responses Over Time|Logs|HAProxy - OpenTelemetry/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| if(status\_code matches "2\*", 1, 0) as successes <br />\| if(status\_code matches "3\*", 1, 0) as redirects <br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 5m<br />\| sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice|
|HAProxy - OpenTelemetry|Responses Over Time|Logs|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| !isEmpty(c\_ip)<br />\| if(status\_code matches "2\*", 1, 0) as Successes <br />\| if(status\_code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(status\_code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 5m<br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc<br />|
|HAProxy - OpenTelemetry|Server Down Events|Logs|HAProxy - OpenTelemetry/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy Server<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+Server\\s+(?\<frontend\_name\>\\S+)/(?\<backend\_name\>\\S+)\\s+is\\s+DOWN,\\s+reason:\\s+(?\<reason\>.\*),\\s+info:\\s+\\"(?\<info\>.\*)\\",\\s+check\\s+duration:\\s+(?\<check\_duration\>\\d+)ms.\\s+(?\<active\>\\d+)\\s+active\\s+and\\s+(?\<backup\>\\d+)\\s+backup\\s+servers\\s+left.\\s+(?\<sessions\>\\d+) sessions\\s+active,\\s+(?\<requeued\>\\d+)\\s+requeued,\\s+(?\<remaining\>\\d+)\\s+remaining\\s+in\\s+queue." nodrop<br />\| where length(frontend\_name) \> 0 and length(backend\_name) \> 0<br />\| timeslice 1s<br />\| count as count by \_timeslice, webengine.cluster.name, frontend\_name, backend\_name, reason, info<br />\| fields -count|
|HAProxy - OpenTelemetry/Logs|Server Down Events|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  sumo.datasource=haproxy Server<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+Server\\s+(?\<frontend\_name\>\\S+)/(?\<backend\_name\>\\S+)\\s+is\\s+DOWN,\\s+reason:\\s+(?\<reason\>.\*),\\s+info:\\s+\\"(?\<info\>.\*)\\",\\s+check\\s+duration:\\s+(?\<check\_duration\>\\d+)ms.\\s+(?\<active\>\\d+)\\s+active\\s+and\\s+(?\<backup\>\\d+)\\s+backup\\s+servers\\s+left.\\s+(?\<sessions\>\\d+) sessions\\s+active,\\s+(?\<requeued\>\\d+)\\s+requeued,\\s+(?\<remaining\>\\d+)\\s+remaining\\s+in\\s+queue." nodrop<br />\| where length(frontend\_name) \> 0 and length(backend\_name) \> 0<br />\| timeslice 1s<br />\| count as count by \_timeslice, webengine.cluster.name, frontend\_name, backend\_name, reason, info<br />\| fields -count|
|HAProxy - OpenTelemetry|Server Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Outlier Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where (status\_code matches "5\*") <br />\| timeslice {{timeslice}}<br />\| count as server\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier server\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|HAProxy - OpenTelemetry/Logs|Server Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Outlier Analysis|webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where (status\_code matches "5\*") <br />\| timeslice {{timeslice}}<br />\| count as server\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier server\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|HAProxy - OpenTelemetry/Logs|Threat Count|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(ip\_count) as threat\_count|
|HAProxy - OpenTelemetry|Threat Count|Logs|HAProxy - OpenTelemetry/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(ip\_count) as threat\_count|
|HAProxy - OpenTelemetry/Logs|Threat Locations|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| lookup latitude, longitude from geo://location on ip = c\_ip<br />\| where !isNull(latitude)|
|HAProxy - OpenTelemetry|Threat Locations|Logs|HAProxy - OpenTelemetry/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| lookup latitude, longitude from geo://location on ip = c\_ip<br />\| where !isNull(latitude)|
|HAProxy - OpenTelemetry/Logs|Threats by Actors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (ip\_count) as threat\_count by Actor|
|HAProxy - OpenTelemetry|Threats by Actors|Logs|HAProxy - OpenTelemetry/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (ip\_count) as threat\_count by Actor|
|HAProxy - OpenTelemetry|Threats by Malicious Confidence|Logs|HAProxy - OpenTelemetry/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (ip\_count) as threat\_count by malicious\_confidence|
|HAProxy - OpenTelemetry/Logs|Threats by Malicious Confidence|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (ip\_count) as threat\_count by malicious\_confidence|
|HAProxy - OpenTelemetry|Threats by Source|Logs|HAProxy - OpenTelemetry/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip,  \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| \_source as source<br />\| sum (ip\_count) as threat\_count by source|
|HAProxy - OpenTelemetry/Logs|Threats by Source|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip,  \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| \_source as source<br />\| sum (ip\_count) as threat\_count by source|
|HAProxy - OpenTelemetry/Logs|Top 10 Search Terms from Popular Search Engines|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where !isBlank(search\_term)<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*","Google","") as engine<br />\| if(referrer matches "\*bing.\*","Bing",engine) as engine<br />\| if(referrer matches "\*ask.com\*","Ask.com",engine) as engine<br />\| if(referrer matches "\*aol.\*","AOL",engine) as engine<br />\| if(referrer matches "\*yahoo.\*","Yahoo",engine) as engine<br />\| where !isBlank(engine) <br />\| count as count by search\_term<br />\| sort count, search\_term asc<br />\| limit 10|
|HAProxy - OpenTelemetry|Top 10 Search Terms from Popular Search Engines|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where !isBlank(search\_term)<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*","Google","") as engine<br />\| if(referrer matches "\*bing.\*","Bing",engine) as engine<br />\| if(referrer matches "\*ask.com\*","Ask.com",engine) as engine<br />\| if(referrer matches "\*aol.\*","AOL",engine) as engine<br />\| if(referrer matches "\*yahoo.\*","Yahoo",engine) as engine<br />\| where !isBlank(engine) <br />\| count as count by search\_term<br />\| sort count, search\_term asc<br />\| limit 10|
|HAProxy - OpenTelemetry/Logs|Top 10 Threats|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as threat\_count by c\_ip, method, status\_code, bytes\_read, referrer, user\_agent, request<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence) and malicious\_confidence matches "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(threat\_count) as request\_count by c\_ip, method, status\_code, bytes\_read, referrer, user\_agent, request, malicious\_confidence, actor<br />\| sort by request\_count<br />\| limit 10|
|HAProxy - OpenTelemetry|Top 10 Threats|Logs|HAProxy - OpenTelemetry/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as threat\_count by c\_ip, method, status\_code, bytes\_read, referrer, user\_agent, request<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence) and malicious\_confidence matches "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(threat\_count) as request\_count by c\_ip, method, status\_code, bytes\_read, referrer, user\_agent, request, malicious\_confidence, actor<br />\| sort by request\_count<br />\| limit 10|
|HAProxy - OpenTelemetry|Top 5 Clients Causing 4xx Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*"<br />\| count as count by c\_ip<br />\| sort count, c\_ip asc<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 Clients Causing 4xx Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*"<br />\| count as count by c\_ip<br />\| sort count, c\_ip asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Top 5 Clients Causing 4xx Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*"<br />\| count as count by c\_ip<br />\| sort count, c\_ip asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Top 5 Clients Causing 4xx Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*"<br />\| count as count by c\_ip<br />\| sort count, c\_ip asc<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 Clients Causing Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)/1:\\s+(?\<msg\>.\*)"<br />\| where length(msg) \> 0 and !isEmpty(c\_ip)<br />\| count as count by c\_ip \| sort by count, c\_ip asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Top 5 Clients Causing Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Error Log Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)/1:\\s+(?\<msg\>.\*)"<br />\| where length(msg) \> 0 and !isEmpty(c\_ip)<br />\| count as count by c\_ip \| sort by count, c\_ip asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Top 5 Highly Malicious URLs|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip, request<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| where malicious\_confidence matches "high"<br />\| count by request<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 Highly Malicious URLs|Logs|HAProxy - OpenTelemetry/HAProxy - Threat Analysis|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count as ip\_count by c\_ip, request<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| where malicious\_confidence matches "high"<br />\| count by request<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Top 5 Referrers|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !isBlank(referer)<br />\| count as count by referer<br />\| sort by count, referer asc<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 Referrers|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !isBlank(referer)<br />\| count as count by referer<br />\| sort by count, referer asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Top 5 Urls|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !isBlank(request)<br />\| count as count by request<br />\| sort by count, request asc<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 Urls|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Traffic Insight|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where !isBlank(request)<br />\| count as count by request<br />\| sort by count, request asc<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 URLs Causing 4xx Responses|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*"<br />\| count as count by request<br />\| sort count, request asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Top 5 URLs Causing 4xx Responses|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*"<br />\| count as count by request<br />\| sort count, request asc<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Top 5 URLs Causing 4xx Responses|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*"<br />\| count as count by request<br />\| sort count, request asc<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 URLs Causing 4xx Responses|Logs|HAProxy - OpenTelemetry/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where status\_code matches "4\*"<br />\| count as count by request<br />\| sort count, request asc<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 URLs with Errors|Logs|HAProxy - OpenTelemetry/HAProxy - Overview|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"\| where status\_code matches "4\*" or status\_code matches "5\*" and  !isEmpty(c\_ip) \|count by status\_code,request<br />\| sort by \_count<br />\| limit 5|
|HAProxy - OpenTelemetry|Top 5 URLs with Errors|Logs|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"\| where status\_code matches "4\*" or status\_code matches "5\*" and  !isEmpty(c\_ip) \|count by status\_code,request<br />\| sort by \_count<br />\| limit 5|
|HAProxy - OpenTelemetry/Logs|Traffic Distribution by Server|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 5m<br />\| count by \_timeslice, host.name  <br />\| transpose row \_timeslice column host.name|
|HAProxy - OpenTelemetry|Traffic Distribution by Server|Logs|HAProxy - OpenTelemetry/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 5m<br />\| count by \_timeslice, host.name  <br />\| transpose row \_timeslice column host.name|
|HAProxy - OpenTelemetry/Logs|Traffic Volume and Bytes Served|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where bytes\_read != "-" and !isEmpty(bytes\_read)<br />\| (bytes\_read/(1024\*1024)) as mbytes <br />\| timeslice 5m<br />\| count as hits, sum(mbytes) as mbytes by \_timeslice |
|HAProxy - OpenTelemetry|Traffic Volume and Bytes Served|Logs|HAProxy - OpenTelemetry/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| where bytes\_read != "-" and !isEmpty(bytes\_read)<br />\| (bytes\_read/(1024\*1024)) as mbytes <br />\| timeslice 5m<br />\| count as hits, sum(mbytes) as mbytes by \_timeslice |
|HAProxy - OpenTelemetry|United States|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Locations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where country\_name = "United States"|
|HAProxy - OpenTelemetry/Logs|United States|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Locations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where country\_name = "United States"|
|HAProxy - OpenTelemetry|Visitor Locations|Logs|HAProxy - OpenTelemetry/HAProxy - Overview|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count by c\_ip \| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip <br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code <br />\| sort \_count|
|HAProxy - OpenTelemetry|Visitor Locations|Logs|Installed Apps/HAProxy - OpenTelemetry/HAProxy-Overview|sumo.datasource=haproxy deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count by c\_ip \| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip <br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code <br />\| sort \_count|
|HAProxy - OpenTelemetry/Logs|Visitor Locations - One Day Time Comparison|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude) and !isEmpty(country\_name)<br />\| sum(\_count) as Visitors\_Locations by country\_name<br />\| sort Visitors\_Locations <br />\| compare with timeshift 1d<br />\| limit 10|
|HAProxy - OpenTelemetry|Visitor Locations - One Day Time Comparison|Logs|HAProxy - OpenTelemetry/HAProxy - Trends|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude) and !isEmpty(country\_name)<br />\| sum(\_count) as Visitors\_Locations by country\_name<br />\| sort Visitors\_Locations <br />\| compare with timeshift 1d<br />\| limit 10|
|HAProxy - OpenTelemetry|Visitor Platforms|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\{(?\<referer\>.\*)\|(?\<user\_agent\>.\*)\\} \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "", "bots/unknown", type) as type<br />\| count type<br />\| sort by \_count, type asc|
|HAProxy - OpenTelemetry|Visitor Platforms|Logs|HAProxy - OpenTelemetry/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "", "bots/unknown", type) as type<br />\| count type<br />\| sort by \_count, type asc|
|HAProxy - OpenTelemetry/Logs|Visitor Platforms|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Web Server Operations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "", "bots/unknown", type) as type<br />\| count type<br />\| sort by \_count, type asc|
|HAProxy - OpenTelemetry/Logs|Visitor Platforms|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Access Types|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>[\\w\\-\\.]+) (?\<ps\>\\w+)\\[(?\<pid\>\\d+)\\]: (?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+) (?\<rs\>[^\\"]\*) (?\<TR1\>\\d+)/(?\<Tw\>\\d+)/(?\<Tc\>\\d+)/(?\<Tr\>\\d+)/(?\<Ta\>\\d+) (?\<status\_code\>\\d+) (?\<bytes\>\\d+) (?\<req\_cookie\>\\S+) (?\<res\_cookie\>\\S+) (?\<t\_state\>[\\w-]+) (?\<actconn\>\\d+)/(?\<feconn\>\\d+)/(?\<beconn\>\\d+)\\/(?\<srv\_conn\>\\d+)/(?\<retries\>\\d+) (?\<srv\_queue\>\\d+)/(?\<backend\_queue\>\\d+) \\{(?\<referer\>.\*)\|(?\<user\_agent\>.\*)\\} \\"(?\<method\>\\w+) (?\<request\>[^\\"]\*) (?\<http\_version\>\\w+)"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "", "bots/unknown", type) as type<br />\| count type<br />\| sort by \_count, type asc|
|HAProxy - OpenTelemetry|Visits by Country Over Time|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Locations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude) and !isEmpty(country\_name)<br />\| timeslice 5m<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \* |
|HAProxy - OpenTelemetry/Logs|Visits by Country Over Time|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Locations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude) and !isEmpty(country\_name)<br />\| timeslice 5m<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \* |
|HAProxy - OpenTelemetry/Logs|Visits by US Regions Over Time|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Locations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| timeslice 5m<br />\| count by c\_ip, \_timeslice<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude) and country\_name = "United States" AND !isEmpty(region)<br />\| sum(\_count) as count by \_timeslice, region<br />\| transpose row \_timeslice column region as \*|
|HAProxy - OpenTelemetry|Visits by US Regions Over Time|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Locations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| timeslice 5m<br />\| count by c\_ip, \_timeslice<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude) and country\_name = "United States" AND !isEmpty(region)<br />\| sum(\_count) as count by \_timeslice, region<br />\| transpose row \_timeslice column region as \*|
|HAProxy - OpenTelemetry/Logs|Worldwide|Logs|Installed Apps/HAProxy - OpenTelemetry/Logs/HAProxy - Visitor Locations|webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude)|
|HAProxy - OpenTelemetry|Worldwide|Logs|HAProxy - OpenTelemetry/HAProxy - Visitor Locations|webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=haproxy<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as haproxy\_log\_message<br />\| parse regex field=haproxy\_log\_message "(?\<syslog\_host\>.\*)\\]:\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message ":\\s+(?\<c\_ip\>[\\w\\.]+):(?\<c\_port\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\[(?\<accept\_date\>.+)\\]\\s+(?\<frontend\_name\>\\S+)\\s+(?\<backend\_name\>\\S+)/(?\<server\_name\>\\S+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<tq\>-?\\d+)/(?\<tw\>-?\\d+)/(?\<tc\>-?\\d+)/(?\<tr\>-?\\d+)/(?\<tt\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<status\_code\>\\d+)\\s+(?\<bytes\_read\>[\\d-]+)\\s+(?\<tsc\>.\*)\\s+(?\<act\>\\d+)/(?\<fe\>\\d+)/(?\<be\>\\d+)/(?\<srv\>\\d+)/(?\<retries\>\\+?\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+(?\<queue\_server\>\\d+)/(?\<queue\_backend\>\\d+)\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\{(?\<request\_headers\>.\*)\\}\\s+" nodrop<br />\| parse regex field=haproxy\_log\_message "\\s+\\"(?\<http\_request\>.\*)\\"" nodrop<br />\| parse regex field=request\_headers "(?\<referer\>\\S+)\\\|(?\<user\_agent\>[^\\"]\*)"<br />\| parse regex field=http\_request "(?\<method\>\\w+)\\s+(?\<request\>[^\\"]\*)\\s+(?\<http\_version\>\\w+)"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude)|

