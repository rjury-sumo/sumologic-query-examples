# JFrog Xray
## Sumo Logic App For: JFrog Xray
The JFrog Xray app provides visibility into the state of artifacts and files in your JFrog Artifactory repository. The pre-configured dashboards present information about issues detected in your software components in Artifactory, including vulnerable containers, artifacts and components; license and security issues; and top Common Vulnerabilities and Exposures (CVEs). The app also helps identify all incoming threats detected via Sumo Logic Threat Intel.
Docs Link: [JFrog Xray](https://help.sumologic.com/?cid=10110)

## Searches

### Log Searches

- **Artifact Package Types**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Artifact Package Types**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Artifacts - Top CVE**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Artifacts - Top CVE**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Artifacts - Top Description**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Artifacts - Top Description**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Artifacts with Vulnerability by Severity**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Artifacts with Vulnerability by Severity**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Components - Top CVE**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Components - Top CVE**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Components - Top Description**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Components - Top Description**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Components Package Types**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Components Package Types**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Components with Vulnerability by Severity**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Components with Vulnerability by Severity**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **CVEs**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **CVEs**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **CVEs**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **CVEs**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Detected Vulnerabilities**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Detected Vulnerabilities**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Detected Vulnerabilities Summary**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Detected Vulnerabilities Summary**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Downloaded Artifacts**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts 
- **License Issues**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **License Issues**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **License Issues**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **License Issues**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Policies**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Policies**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Policies Invoked**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Policies Invoked**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Recent Vulnerable Artifacts**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Recent Vulnerable Artifacts**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Recent Vulnerable Components**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Recent Vulnerable Components**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Recently Discovered Issues**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Recently Discovered Issues**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Security Issues**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Security Issues**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Security Issues**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Security Issues**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Threat by Malicious Confidence**: from Dashboard: JFrog Xray/JFrog Xray - Threat Analysis - New 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis 
- **Threat by Malicious Confidence**: from Dashboard: JFrog Xray/JFrog Xray - Threat Analysis - New 
- **Threat Count**: from Dashboard: JFrog Xray/JFrog Xray - Threat Analysis - New 
- **Threat Count**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis 
- **Threat Count**: from Dashboard: JFrog Xray/JFrog Xray - Threat Analysis - New 
- **Threat Count**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis 
- **Threat Location**: from Dashboard: JFrog Xray/JFrog Xray - Threat Analysis - New 
- **Threat Location**: from Dashboard: JFrog Xray/JFrog Xray - Threat Analysis - New 
- **Threat Location**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis 
- **Threat Location**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis 
- **Threats by Actor**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis 
- **Threats by Actor**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis 
- **Threats by Actor**: from Dashboard: JFrog Xray/JFrog Xray - Threat Analysis - New 
- **Threats by Actor**: from Dashboard: JFrog Xray/JFrog Xray - Threat Analysis - New 
- **Top 10 Artifacts with Most CVEs**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Top 10 Artifacts with Most CVEs**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Top 10 Components with Most CVEs**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Top 10 Components with Most CVEs**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Top 10 CVEs**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Top 10 CVEs**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Top 5 Artifacts with Severity**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Top 5 Artifacts with Severity**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Top 5 Components with Severity**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Top 5 Components with Severity**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Top Clients IPs**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts 
- **Top Clients IPs**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts 
- **Top Users**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts 
- **Top Users**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts 
- **Total Threat Count**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Total Threat Count**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Uploaded Artifacts**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts 
- **Vulnerabilities Severity**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Vulnerabilities Severity**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Vulnerable Artifacts**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Vulnerable Artifacts**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Vulnerable Artifacts**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Vulnerable Artifacts**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Vulnerable Artifacts**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Vulnerable Artifacts**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Vulnerable Components**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Vulnerable Components**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Vulnerable Components**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Vulnerable Components**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities 
- **Vulnerable Components**: from Dashboard: JFrog Xray/JFrog Xray - Detected Vulnerabilities - New 
- **Vulnerable Components**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Vulnerable Containers**: from Dashboard: JFrog Xray/JFrog Xray - Vulnerable Containers - New 
- **Vulnerable Containers**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers 
- **Vulnerable Containers**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Vulnerable Containers**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers 
- **Vulnerable Containers**: from Dashboard: JFrog Xray/JFrog Xray - Vulnerable Containers - New 
- **Vulnerable Containers**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Vulnerable Containers Summary**: from Dashboard: JFrog Xray/JFrog Xray - Vulnerable Containers - New 
- **Vulnerable Containers Summary**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers 
- **Vulnerable Hosts**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers 
- **Vulnerable Hosts**: from Dashboard: JFrog Xray/JFrog Xray - Vulnerable Containers - New 
- **Vulnerable Namespaces**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers 
- **Vulnerable Namespaces**: from Dashboard: JFrog Xray/JFrog Xray - Vulnerable Containers - New 
- **Watches**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Watches**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview 
- **Watches Invoked**: from Dashboard: JFrog Xray/JFrog Xray - Overview - New 
- **Watches Invoked**: from Dashboard: Installed Apps/JFrog Xray/JFrog Xray - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|JFrog Xray|Artifact Package Types|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count as Count by ArtifactPkgType<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Artifact Package Types|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}} <br /><br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count as Count by ArtifactPkgType<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Artifacts - Top CVE|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where !isEmpty(CVE) and Severity matches {{Severity}} and CVE matches "{{CVE}}"<br />\| tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE) as CVE<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ArtifactName, CVE, Severity<br />\| count as Artifacts by CVE, Severity<br />\| sort by Artifacts, CVE|
|JFrog Xray|Artifacts - Top CVE|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}" and !isEmpty(CVE) <br />\| tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE) as CVE<br />\|count by ArtifactName, CVE, Severity<br />\| count as Artifacts by CVE, Severity<br />\| sort by Artifacts, CVE<br />\| limit 10|
|JFrog Xray|Artifacts - Top Description|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"  <br />\|count by ArtifactName, CVE, Description<br />\| sum(\_count) as Incidents, count\_distinct(ArtifactName) as Artifacts, count\_distinct(CVE) as Vulnerabilities by Description<br />\| sort by Incidents, Artifacts, Description asc<br />\| limit 10|
|JFrog Xray|Artifacts - Top Description|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}} and Description matches "{{Description}}"<br />\|where if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ArtifactName, CVE, Description<br />\| sum(\_count) as Incidents, count\_distinct(ArtifactName) as Artifacts, count\_distinct(CVE) as Vulnerabilities by Description<br />\| sort by Incidents, Artifacts, Description asc|
|JFrog Xray|Artifacts with Vulnerability by Severity|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}" and !isEmpty(CVE) <br />\|count by ArtifactName, CVE, Severity<br />\| count\_distinct(ArtifactName) as Artifacts, count\_distinct(CVE) as Vulnerabilities by Severity<br />\| sort by Artifacts, Vulnerabilities, Severity asc|
|JFrog Xray|Artifacts with Vulnerability by Severity|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}} and !isEmpty(CVE)<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ArtifactName, CVE, Severity<br />\| count\_distinct(ArtifactName) as Artifacts, count\_distinct(CVE) as Vulnerabilities by Severity<br />\| sort by Artifacts, Vulnerabilities, Severity asc|
|JFrog Xray|Components - Top CVE|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where !isEmpty(CVE) and Severity matches {{Severity}} and CVE matches "{{CVE}}"<br />\| tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE) as CVE<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ComponentName, CVE, Severity<br />\| count as Components by CVE, Severity<br />\| sort by Components, CVE|
|JFrog Xray|Components - Top CVE|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}" and !isEmpty(CVE) <br />\| tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE) as CVE<br />\|count by ComponentName, CVE, Severity<br />\| count as Components by CVE, Severity<br />\| sort by Components, CVE<br />\| limit 10|
|JFrog Xray|Components - Top Description|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}" and !isEmpty(CVE) <br />\|count by ComponentName, CVE, Description<br />\| sum(\_count) as Incidents, count\_distinct(ComponentName) as Components, count\_distinct(CVE) as Vulnerabilities by Description<br />\| sort by Incidents, Components, Description asc<br />\| limit 10 |
|JFrog Xray|Components - Top Description|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}} and Description matches "{{Description}}"<br />\|where if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ComponentName, CVE, Description<br />\| sum(\_count) as Incidents, count\_distinct(ComponentName) as Components, count\_distinct(CVE) as Vulnerabilities by Description<br />\| sort by Incidents, Components, Description asc|
|JFrog Xray|Components Package Types|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}}<br /><br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count as Count by ComponentPkgType<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Components Package Types|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| count as Count by ComponentPkgType<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Components with Vulnerability by Severity|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}" and !isEmpty(CVE) <br />\|count by ComponentName, CVE, Severity<br />\| count\_distinct(ComponentName) as Components, count\_distinct(CVE) as Vulnerabilities by Severity<br />\| sort by Components, Vulnerabilities, Severity asc|
|JFrog Xray|Components with Vulnerability by Severity|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}} and !isEmpty(CVE)<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ComponentName, CVE, Severity<br />\| count\_distinct(ComponentName) as Components, count\_distinct(CVE) as Vulnerabilities by Severity<br />\| sort by Components, Vulnerabilities, Severity asc|
|JFrog Xray|CVEs|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where !isEmpty(CVE)<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by CVE \| count as %"Number of CVE"|
|JFrog Xray|CVEs|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/<br /><br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by CVE \| count as %"Number of CVEs"|
|JFrog Xray|CVEs|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where !isEmpty(CVE)<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by CVE \| count as %"Number of CVE"|
|JFrog Xray|CVEs|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by CVE \| count as %"Number of CVEs"|
|JFrog Xray|Detected Vulnerabilities|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}}<br />\| timeslice 10m<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by Summary, \_timeslice \| count as %"Number of Vulnerabilities" by \_timeslice<br />\| compare with timeshift {{TimeCompare}}<br />\| fillmissing timeslice(10m)|
|JFrog Xray|Detected Vulnerabilities|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| timeslice 10m<br />\|count by Summary, \_timeslice \| count as %"Number of Vulnerabilities" by \_timeslice<br />\| compare with timeshift 1d<br />\| fillmissing timeslice(10m)|
|JFrog Xray|Detected Vulnerabilities Summary|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}}<br />\| if(isEmpty(CVE), "-", tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE)) as CVE<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ArtifactName, ComponentName, Summary, CVE, Severity<br />\| count\_distinct(ArtifactName) as %"Unique Artifacts", count\_distinct(ComponentName) as %"Unique Components", sum(\_count) as Count by Summary, CVE, Severity <br />\| sort by Count|
|JFrog Xray|Detected Vulnerabilities Summary|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| if(isEmpty(CVE), "-", tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE)) as CVE<br />\|count by ArtifactName, ComponentName, Summary, CVE, Severity<br />\| count\_distinct(ArtifactName) as %"Unique Artifacts", count\_distinct(ComponentName) as %"Unique Components", sum(\_count) as Count by Summary, CVE, Severity <br />\| sort by Count|
|JFrog Xray|Downloaded Artifacts|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts|\_sourceCategory={{ArtifactoryLogDataSource}}   GET<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, Path, protocol, status\_code, size nodrop<br />\| where IP matches "{{IP}}" and path matches "{{ArtifactName}}"<br />\| count as Count by Path, IP, user, size<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|License Issues|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/ and PolicyType matches /(?i)license/<br /><br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by ArtifactName \| count as %"Number of License Issues"|
|JFrog Xray|License Issues|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/ and PolicyType matches /(?i)license/<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by ArtifactName \| count as %"Number of License Issues"|
|JFrog Xray|License Issues|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where PolicyType matches /(?i)license/<br /><br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by ArtifactName \| count as %"Number of License Issues"|
|JFrog Xray|License Issues|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where PolicyType matches /(?i)license/<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by ArtifactName \| count as %"Number of License Issues"|
|JFrog Xray|Policies|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count as Count by PolicyName<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Policies|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count as Count by PolicyName<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Policies Invoked|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by PolicyName\| count as %"Number of Policies"|
|JFrog Xray|Policies Invoked|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by PolicyName\| count as %"Number of Policies"|
|JFrog Xray|Recent Vulnerable Artifacts|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "created", "top\_severity", "issues", "watch\_name", "policy\_name" as IssueCreated, TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| if (isEmpty(Created), IssueCreated, Created) as Created<br />\| if(isEmpty(CVE), "-", tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE)) as CVE<br />\| ArtifactName as %"Artifact Name" \| ArtifactPath as %"Artifact Path"<br />\| ArtifactPkgType as %"Package Type" \| PolicyType as %"Policy Type"<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}" and !isEmpty(CVE) <br />\|count as Count by Created, %"Artifact Name", %"Artifact Path", Severity,  %"Package Type", %"Policy Type", CVE<br />\| sort by Created<br />\| limit 20|
|JFrog Xray|Recent Vulnerable Artifacts|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "created", "top\_severity", "issues", "watch\_name", "policy\_name" as IssueCreated, TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| if (isEmpty(Created), IssueCreated, Created) as Created<br />\| if(isEmpty(CVE), "-", tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE)) as CVE<br />\| where ArtifactName matches "{{ArtifactName}}" and PolicyType matches "{{PolicyType}}" and CVE matches "{{CVE}}"<br />\| ArtifactName as %"Artifact Name" \| ArtifactPath as %"Artifact Path"<br />\| ArtifactPkgType as %"Package Type" \| PolicyType as %"Policy Type"<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}")<br />\|count as Count by Created, %"Artifact Name", %"Artifact Path", Severity,  %"Package Type", %"Policy Type", CVE<br />\| sort by Created<br />\| limit 20|
|JFrog Xray|Recent Vulnerable Components|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "created", "top\_severity", "issues", "watch\_name", "policy\_name" as IssueCreated, TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| if (isEmpty(Created), IssueCreated, Created) as Created<br />\| if(isEmpty(CVE), "-", tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE)) as CVE<br />\| where ComponentName matches "{{ComponentName}}" and PolicyType matches "{{PolicyType}}" and CVE matches "{{CVE}}"<br />\| ComponentName as %"Component Name" \| ComponentPath as %"Component Path"<br />\| ComponentPkgType as %"Package Type" \| PolicyType as %"Policy Type"<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count as Count by Created, %"Component Name", %"Component Path", Severity, %"Package Type", %"Policy Type", CVE<br />\| sort by Created<br />\| limit 20|
|JFrog Xray|Recent Vulnerable Components|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "created", "top\_severity", "issues", "watch\_name", "policy\_name" as IssueCreated, TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| if (isEmpty(Created), IssueCreated, Created) as Created<br />\| if(isEmpty(CVE), "-", tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE)) as CVE<br />\| ComponentName as %"Component Name" \| ComponentPath as %"Component Path"<br />\| ComponentPkgType as %"Package Type" \| PolicyType as %"Policy Type"<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}" and !isEmpty(CVE) <br />\|count as Count by Created, %"Component Name", %"Component Path", Severity, %"Package Type", %"Policy Type", CVE<br />\| sort by Created<br />\| limit 20|
|JFrog Xray|Recently Discovered Issues|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "created", "top\_severity", "issues", "watch\_name", "policy\_name" as IssueCreated, TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| if(isEmpty(CVE), "-", tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE)) as CVE<br />\| if (isEmpty(Created), IssueCreated, Created) as Created<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| WatchName as %"Watch Name" \| PolicyName as %"Policy Name"<br />\| PolicyType as %"Policy Type" \| ArtifactName as %"Artifact Name"<br />\| ComponentName as %"Component Name"<br />\| count by Created, %"Watch Name", %"Policy Name", Severity, CVE, %"Policy Type", %"Artifact Name", %"Component Name", Summary<br />\| sort by Created<br />\| limit 20<br />\| fields - \_count|
|JFrog Xray|Recently Discovered Issues|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "created", "top\_severity", "issues", "watch\_name", "policy\_name" as IssueCreated, TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| if(isEmpty(CVE), "-", tourl(concat("https://nvd.nist.gov/vuln/detail/", CVE), CVE)) as CVE<br />\| if (isEmpty(Created), IssueCreated, Created) as Created<br />\| where WatchName matches "{{WatchName}}" and PolicyName matches "{{PolicyName}}" and Severity matches {{Severity}} and CVE matches "{{CVE}}" and PolicyType matches {{PolicyType}} and ArtifactName matches "{{ArtifactName}}" and ComponentName matches "{{ComponentName}}"<br />\| WatchName as %"Watch Name" \| PolicyName as %"Policy Name"<br />\| PolicyType as %"Policy Type" \| ArtifactName as %"Artifact Name"<br />\| ComponentName as %"Component Name"<br />\| count by Created, %"Watch Name", %"Policy Name", Severity, CVE, %"Policy Type", %"Artifact Name", %"Component Name", Summary<br />\| sort by Created<br />\| limit 20<br />\| fields - \_count|
|JFrog Xray|Security Issues|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where PolicyType matches /(?i)security/<br /><br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by ArtifactName \| count as %"Number of Security Issues"|
|JFrog Xray|Security Issues|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/ and PolicyType matches /(?i)security/<br /><br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by ArtifactName \| count as %"Number of Security Issues"|
|JFrog Xray|Security Issues|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where PolicyType matches /(?i)security/<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by ArtifactName \| count as %"Number of Security Issues"|
|JFrog Xray|Security Issues|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/ and PolicyType matches /(?i)security/<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by ArtifactName \| count as %"Number of Security Issues"|
|JFrog Xray|Threat by Malicious Confidence|Logs|JFrog Xray/JFrog Xray - Threat Analysis - New|\_sourceCategory = Labs/jfrog/artifactory/request PUT<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum (\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|JFrog Xray|Threat by Malicious Confidence|Logs|Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis|\_sourceCategory={{ArtifactoryLogDataSource}}   GET<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum (\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|JFrog Xray|Threat by Malicious Confidence|Logs|Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis|\_sourceCategory={{ArtifactoryLogDataSource}}   PUT<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum (\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|JFrog Xray|Threat by Malicious Confidence|Logs|JFrog Xray/JFrog Xray - Threat Analysis - New|\_sourceCategory = Labs/jfrog/artifactory/request GET<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum (\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|JFrog Xray|Threat Count|Logs|JFrog Xray/JFrog Xray - Threat Analysis - New|\_sourceCategory = Labs/jfrog/artifactory/request GET<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|JFrog Xray|Threat Count|Logs|Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis|\_sourceCategory={{ArtifactoryLogDataSource}}   GET<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|JFrog Xray|Threat Count|Logs|JFrog Xray/JFrog Xray - Threat Analysis - New|\_sourceCategory = Labs/jfrog/artifactory/request PUT<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|JFrog Xray|Threat Count|Logs|Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis|\_sourceCategory={{ArtifactoryLogDataSource}}   PUT<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|JFrog Xray|Threat Location|Logs|JFrog Xray/JFrog Xray - Threat Analysis - New|\_sourceCategory = Labs/jfrog/artifactory/request PUT<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP|
|JFrog Xray|Threat Location|Logs|JFrog Xray/JFrog Xray - Threat Analysis - New|\_sourceCategory = Labs/jfrog/artifactory/request GET<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP|
|JFrog Xray|Threat Location|Logs|Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis|\_sourceCategory={{ArtifactoryLogDataSource}}   GET<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP|
|JFrog Xray|Threat Location|Logs|Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis|\_sourceCategory={{ArtifactoryLogDataSource}}   PUT<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP|
|JFrog Xray|Threats by Actor|Logs|Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis|\_sourceCategory={{ArtifactoryLogDataSource}}   GET<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|JFrog Xray|Threats by Actor|Logs|Installed Apps/JFrog Xray/JFrog Xray - Threat Analysis|\_sourceCategory={{ArtifactoryLogDataSource}}   PUT<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|JFrog Xray|Threats by Actor|Logs|JFrog Xray/JFrog Xray - Threat Analysis - New|\_sourceCategory = Labs/jfrog/artifactory/request GET<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|JFrog Xray|Threats by Actor|Logs|JFrog Xray/JFrog Xray - Threat Analysis - New|\_sourceCategory = Labs/jfrog/artifactory/request PUT<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where if ("{{IP}}" = "\*", true, IP matches "{{IP}}")<br />\|count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|JFrog Xray|Top 10 Artifacts with Most CVEs|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| where !isEmpty(CVE)<br />\| ArtifactName as %"Artifact Name"<br />\|count by CVE, %"Artifact Name"<br />\| count as Vulnerabilities by %"Artifact Name"<br />\| sort by Vulnerabilities<br />\| limit 10|
|JFrog Xray|Top 10 Artifacts with Most CVEs|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}}<br />\| where !isEmpty(CVE)<br />\| ArtifactName as %"Artifact Name"<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by CVE, %"Artifact Name"<br />\| count as Vulnerabilities by %"Artifact Name"<br />\| sort by Vulnerabilities<br />\| limit 10|
|JFrog Xray|Top 10 Components with Most CVEs|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}}<br />\| where !isEmpty(CVE) and !isEmpty(ComponentName)<br />\| ComponentName as %"Component Name"<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by CVE, %"Component Name"<br />\| count as Vulnerabilities by %"Component Name"<br />\| sort by Vulnerabilities<br />\| limit 10|
|JFrog Xray|Top 10 Components with Most CVEs|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| where !isEmpty(CVE) and !isEmpty(ComponentName)<br />\| ComponentName as %"Component Name"<br />\|count by CVE, %"Component Name"<br />\| count as Vulnerabilities by %"Component Name"<br />\| sort by Vulnerabilities<br />\| limit 10|
|JFrog Xray|Top 10 CVEs|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where !isEmpty(CVE)<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count as Count by CVE<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Top 10 CVEs|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where !isEmpty(CVE)<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count as Count by CVE<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Top 5 Artifacts with Severity|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| ArtifactName as %"Artifact Name"<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count as Count by Severity, %"Artifact Name"<br />//\| sort by ArtifactName, Count<br />\| filter %"Artifact Name" in (sum(Count) by %"Artifact Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"Artifact Name" column Severity|
|JFrog Xray|Top 5 Artifacts with Severity|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}}<br />\| ArtifactName as %"Artifact Name"<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count as Count by Severity, %"Artifact Name"<br />//\| sort by ArtifactName, Count<br />\| filter %"Artifact Name" in (sum(Count) by %"Artifact Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"Artifact Name" column Severity|
|JFrog Xray|Top 5 Components with Severity|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}} and !isEmpty(ComponentName)<br />\| ComponentName as %"Component Name"<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count as Count by Severity, %"Component Name"<br />//\| sort by ArtifactName, Count<br />\| filter %"Component Name" in (sum(Count) by %"Component Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"Component Name" column Severity|
|JFrog Xray|Top 5 Components with Severity|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| ComponentName as %"Component Name"<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}" and !isEmpty(ComponentName)<br />\|count as Count by Severity, %"Component Name"<br />\| filter %"Component Name" in (sum(Count) by %"Component Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"Component Name" column Severity|
|JFrog Xray|Top Clients IPs|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts|\_sourceCategory={{ArtifactoryLogDataSource}}   GET<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\|where IP matches "{{IP}}" and path matches "{{ArtifactName}}"<br />\|count as Count by IP<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Top Clients IPs|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts|\_sourceCategory={{ArtifactoryLogDataSource}}   PUT<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\| where IP matches "{{IP}}" and path matches "{{ArtifactName}}"<br />\|count as Count by IP<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Top Users|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts|\_sourceCategory={{ArtifactoryLogDataSource}}   GET<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\| where  IP matches "{{IP}}" and path matches "{{ArtifactName}}"<br />\|count as Count by user<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Top Users|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts|\_sourceCategory={{ArtifactoryLogDataSource}}   PUT<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\| where  IP matches "{{IP}}" and path matches "{{ArtifactName}}"<br />\|count as Count by user<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Total Threat Count|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/artifactory/request (PUT or GET)<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\| count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|JFrog Xray|Total Threat Count|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{ArtifactoryLogDataSource}}   (PUT or GET)<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, path, protocol, status\_code, size nodrop<br />\| count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|JFrog Xray|Uploaded Artifacts|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Artifacts|\_sourceCategory={{ArtifactoryLogDataSource}}   PUT<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*artifactory/request"<br />\| parse "\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\*" as datetime, response\_time, type, IP, user, method, Path, protocol, status\_code, size nodrop<br />\| where IP matches "{{IP}}" and path matches "{{ArtifactName}}"<br />\| count as Count by Path, IP, user, size<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Vulnerabilities Severity|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count as Count by Severity<br />\| sort by Severity asc|
|JFrog Xray|Vulnerabilities Severity|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count as Count by Severity<br />\| sort by Severity asc|
|JFrog Xray|Vulnerable Artifacts|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}}<br />\| timeslice 10m<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ArtifactName, \_timeslice \| count as %"Number of Artifacts" by \_timeslice<br />\| compare with timeshift {{TimeCompare}}<br />\| fillmissing timeslice(10m)|
|JFrog Xray|Vulnerable Artifacts|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by ArtifactName \| count as %"Number of Artifacts"|
|JFrog Xray|Vulnerable Artifacts|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by ArtifactName \| count as %"Number of Artifacts"|
|JFrog Xray|Vulnerable Artifacts|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| timeslice 10m<br />\|count by ArtifactName, \_timeslice \| count as %"Number of Artifacts" by \_timeslice<br />\| compare with timeshift 1d<br />\| fillmissing timeslice(10m)|
|JFrog Xray|Vulnerable Artifacts|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/<br /><br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by ArtifactName \| count as %"Number of Artifacts"|
|JFrog Xray|Vulnerable Artifacts|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by ArtifactName \| count as %"Number of Artifacts"|
|JFrog Xray|Vulnerable Components|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by ComponentName \| count as %"Number of Components"|
|JFrog Xray|Vulnerable Components|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by ComponentName \| count as %"Number of Components"|
|JFrog Xray|Vulnerable Components|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by ComponentName \| count as %"Number of Components"|
|JFrog Xray|Vulnerable Components|Logs|Installed Apps/JFrog Xray/JFrog Xray - Detected Vulnerabilities|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| timeslice 10m<br />\|count by ComponentName, \_timeslice \| count as %"Number of Components" by \_timeslice<br />\| compare with timeshift 1d<br />\| fillmissing timeslice(10m)|
|JFrog Xray|Vulnerable Components|Logs|JFrog Xray/JFrog Xray - Detected Vulnerabilities - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches {{Severity}}<br />\| timeslice 10m<br />\|where if ("{{Description}}" = "\*", true, Description matches "{{Description}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{PolicyType}}" = "\*", true, PolicyType matches "{{PolicyType}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}")<br />\|count by ComponentName, \_timeslice \| count as %"Number of Components" by \_timeslice<br />\| compare with timeshift {{TimeCompare}}<br />\| fillmissing timeslice(10m)|
|JFrog Xray|Vulnerable Components|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where Severity matches /(?i)high/<br /><br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by ComponentName \| count as %"Number of Components"|
|JFrog Xray|Vulnerable Containers|Logs|JFrog Xray/JFrog Xray - Vulnerable Containers - New|\_sourceCategory = Labs/jfrog/kubernetes/events "Successfully pulled image"<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Namespace, Container, Message, Host nodrop<br />\|where if ("{{Container}}" = "\*", true, Container matches "{{Container}}") AND if ("{{Namespace}}" = "\*", true, Namespace matches "{{Namespace}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\|count (container) as VulnerableContainers|
|JFrog Xray|Vulnerable Containers|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers|\_sourceCategory={{KubernetesEventsLogDataSource}}   "Successfully pulled image"<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "timestamp", "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Time, Namespace, Container, Message, Host nodrop<br />\| timeslice 10m<br />\|where  Container matches "{{Container}}" and  Namespace matches "{{Namespace}}" and Host matches "{{Host}}"<br />\|count by Container, \_timeslice \| count as %"Number of Vulnerable Containers" by \_timeslice<br />\| compare with timeshift 1d<br />\| fillmissing timeslice(10m)|
|JFrog Xray|Vulnerable Containers|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/kubernetes/events "Successfully pulled image"<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Namespace, Container, Message, Host nodrop<br />\| count (container) as VulnerableContainers|
|JFrog Xray|Vulnerable Containers|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers|\_sourceCategory={{KubernetesEventsLogDataSource}}   "Successfully pulled image"<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Namespace, Container, Message, Host nodrop<br />\|where  Container matches "{{Container}}" and  Namespace matches "{{Namespace}}" and Host matches "{{Host}}"<br />\|count (container) as VulnerableContainers|
|JFrog Xray|Vulnerable Containers|Logs|JFrog Xray/JFrog Xray - Vulnerable Containers - New|\_sourceCategory = Labs/jfrog/kubernetes/events "Successfully pulled image"<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "timestamp", "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Time, Namespace, Container, Message, Host nodrop<br />\| timeslice 10m<br />\|where if ("{{Container}}" = "\*", true, Container matches "{{Container}}") AND if ("{{Namespace}}" = "\*", true, Namespace matches "{{Namespace}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\|count by Container, \_timeslice \| count as %"Number of Vulnerable Containers" by \_timeslice<br />\| compare with timeshift {{TimeCompare}}<br />\| fillmissing timeslice(10m)|
|JFrog Xray|Vulnerable Containers|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{KubernetesEventsLogDataSource}}   "Successfully pulled image"<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Namespace, Container, Message, Host nodrop<br />\| count (container) as VulnerableContainers<br />|
|JFrog Xray|Vulnerable Containers Summary|Logs|JFrog Xray/JFrog Xray - Vulnerable Containers - New|\_sourceCategory = Labs/jfrog/kubernetes/events "Successfully pulled image"<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "timestamp", "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Time, Namespace, Container, Message, Host nodrop <br />\| parse regex field=Message "Successfully pulled image (?\<ImageName\>.\*)"<br />\| where Namespace matches "{{Namespace}}" and Container matches "{{Container}}" and Host matches "{{Host}}" and ImageName matches "{{ImageName}}"<br />\| formatDate(fromMillis(toLong(Time)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| ImageName as %"Image Name"<br />\| count by Time, Namespace, Container, %"Image Name", Host<br />\| sort by Time<br />\| fields - \_count|
|JFrog Xray|Vulnerable Containers Summary|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers|\_sourceCategory={{KubernetesEventsLogDataSource}}   "Successfully pulled image"<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "timestamp", "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Time, Namespace, Container, Message, Host nodrop <br />\| parse regex field=Message "Successfully pulled image (?\<ImageName\>.\*)"<br />\|where  Container matches "{{Container}}" and  Namespace matches "{{Namespace}}" and Host matches "{{Host}}"<br />\| formatDate(fromMillis(toLong(Time)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| ImageName as %"Image Name"<br />\| count by Time, Namespace, Container, %"Image Name", Host<br />\| sort by Time<br />\| fields - \_count|
|JFrog Xray|Vulnerable Hosts|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers|\_sourceCategory={{KubernetesEventsLogDataSource}}   "Successfully pulled image"<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "timestamp", "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Time, Namespace, Container, Message, Host nodrop<br />\|where  Container matches "{{Container}}" and  Namespace matches "{{Namespace}}" and Host matches "{{Host}}"<br />\|count by Host<br />\| limit 10|
|JFrog Xray|Vulnerable Hosts|Logs|JFrog Xray/JFrog Xray - Vulnerable Containers - New|\_sourceCategory = Labs/jfrog/kubernetes/events "Successfully pulled image"<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "timestamp", "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Time, Namespace, Container, Message, Host nodrop<br />\|where if ("{{Container}}" = "\*", true, Container matches "{{Container}}") AND if ("{{Namespace}}" = "\*", true, Namespace matches "{{Namespace}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\|count by Host<br />\| limit 10|
|JFrog Xray|Vulnerable Namespaces|Logs|Installed Apps/JFrog Xray/JFrog Xray - Vulnerable Containers|\_sourceCategory={{KubernetesEventsLogDataSource}}   "Successfully pulled image"<br />[subquery: \_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "timestamp", "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Time, Namespace, Container, Message, Host nodrop<br />\|where  Container matches "{{Container}}" and  Namespace matches "{{Namespace}}" and Host matches "{{Host}}"<br />\|count by Namespace<br />\| limit 10|
|JFrog Xray|Vulnerable Namespaces|Logs|JFrog Xray/JFrog Xray - Vulnerable Containers - New|\_sourceCategory = Labs/jfrog/kubernetes/events "Successfully pulled image"<br />[subquery: \_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts" as Artifacts nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "display\_name" as ArtifactDisplayName nodrop<br />\| parse field=ArtifactDisplayName "\*" as Field1<br />\| parse regex field=field1 "(?\<field2\>.\*?):(?\<field1\>[^:]+\$)" nodrop<br />\| parse regex field=field2 "(?\<field3\>.\*?):(?\<field2\>[^:]+\$)" nodrop<br />\| if (isEmpty(Field2), "/", Field2) as Field2<br />\| compose Field1, Field2 keywords]<br />\| where \_sourceCategory matches "\*events\*"<br />\| json "type"<br />\| where type matches "ADDED"<br />\| json "timestamp", "object.involvedObject.namespace", "object.involvedObject.name", "object.message", "object.source.host" as Time, Namespace, Container, Message, Host nodrop<br />\|where if ("{{Container}}" = "\*", true, Container matches "{{Container}}") AND if ("{{Namespace}}" = "\*", true, Namespace matches "{{Namespace}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\|count by Namespace<br />\| limit 10|
|JFrog Xray|Watches|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count as Count by WatchName<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Watches|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\| sort by Count<br />\| limit 10|
|JFrog Xray|Watches Invoked|Logs|JFrog Xray/JFrog Xray - Overview - New|\_sourceCategory = Labs/jfrog/xray<br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\|where if ("{{WatchName}}" = "\*", true, WatchName matches "{{WatchName}}") AND if ("{{ComponentName}}" = "\*", true, ComponentName matches "{{ComponentName}}") AND if ("{{ArtifactName}}" = "\*", true, ArtifactName matches "{{ArtifactName}}") AND if ("{{PolicyName}}" = "\*", true, PolicyName matches "{{PolicyName}}")<br />\|count by WatchName \| count as %"Number of Watches"|
|JFrog Xray|Watches Invoked|Logs|Installed Apps/JFrog Xray/JFrog Xray - Overview|\_sourceCategory={{JFrogXrayLogDataSource}}  <br />\| json "top\_severity", "issues", "watch\_name", "policy\_name" as TopSeverity, Issues, WatchName, PolicyName nodrop<br />\| where !(TopSeverity matches "Pending Scan")<br />\| parse regex field=Issues "(?\<Issue\>\\{.\*?(?=,\\{\\"severity\\"\|\\]\$))" multi<br />\| json field=Issue "impacted\_artifacts", "severity", "summary", "cve", "provider", "created", "description", "type" as Artifacts, Severity, Summary, CVE, Provider, Created, Description, PolicyType nodrop<br />\| parse regex field=Artifacts "(?\<Artifact\>\\{.\*?(?=,\\{\\"sha1\\"\|\\]\$))" multi<br />\| json field=Artifact "infected\_files", "path", "name", "display\_name", "pkg\_type" as Files, ArtifactPath, ArtifactName, ArtifactDisplayName, ArtifactPkgType nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "path", "name", "display\_name", "pkg\_type" as ComponentPath, ComponentName, ComponentDisplayName, ComponentPkgType nodrop<br />\| where WatchName matches "{{WatchName}}" and Severity matches "{{Severity}}" and  PolicyType matches "{{PolicyType}}" and ArtifactName matches "{{ArtifactName}}" and CVE matches "{{CVE}}"<br />\|count by WatchName \| count as %"Number of Watches"|

