# CloudPassage Halo
## Sumo Logic App For: CloudPassage Halo
The Sumo Logic App for CloudPassage Halo helps you detect security violations and look for threats across your complex infrastructure by analyzing massive volumes of Halo event data. CloudPassage Halo platform records over 80 different types of security events about your Halo-managed infrastructure, whether you deploy into public cloud environments or your private data center. These events deliver information about your infrastructure and include critical security alerts for firewall changes, access changes, configuration changes, and file integrity changes, and more. This app enables security operators and administrators to correlate security events across their Halo-managed infrastructure.
Docs Link: [CloudPassage Halo](https://help.sumologic.com/?cid=1129)

## Searches

### Log Searches

- **Active Server Counts**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **All Halo Related Metrics Events**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Bottom 10 SW Vulnerabilities**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Critical Issues**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Critical Issues Delta Over 10 Minutes**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Critical Issues Outlier**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Critical Events 
- **Critical Issues Over Time**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Critical Events 
- **Linux Bottom 10 Processes**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Linux Top 10 Processes**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Non Critical Issues**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Number of OS Types**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Number of Processes**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Number of Software Packages**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Number of User Accounts**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Outlier in Critical Issues**: from Search: Installed Apps/CloudPassage Halo/Outlier in Critical Issues 
- **Outlier in Critical Issues**: from Search: CloudPassage Halo/Outlier in Critical Issues 
- **Outlier on Delta (today - yesterday) of Critical Issues**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Critical Events 
- **Top 10 SW Vulnerabilities**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Windows Bottom 10 Services**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview 
- **Windows Top 10 Services**: from Dashboard: Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|CloudPassage Halo|Active Server Counts|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}   "servers\_by\_state\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field= \_first "\\"count\\": (?\<true\_count1\>[0-9]+), \\"state\\": \\"active\\"" multi<br />\| sum(true\_count1) as server\_counter<br />\| toInt(server\_counter)<br />\| format("%d", server\_counter) as server\_counter|
|CloudPassage Halo|All Halo Related Metrics Events|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| timeslice 1m <br />\| count by \_timeslice <br />\| smooth \_count,10 as moving\_avg|
|CloudPassage Halo|Bottom 10 SW Vulnerabilities|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}  "sw\_vulnerability\_summary" "rule\_key"<br />\| parse regex "\\"log\\": \\{\\"sw\_vulnerability\_summary\\"\\: \\{\\"count\\": [0-9]+, \\"issues\\": (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\"count\\": (?\<vuln\_sw\_counter\>\\d+), \\"name\\": \\"(?\<vuln\_sw\_name\>[^,]\*)\\", \\"rule\_key\\": [^,]\*, \\"critical\\": (?\<criticality\>\\w+)," multi<br />\| count by vuln\_sw\_name, vuln\_sw\_counter<br />\| number(vuln\_sw\_counter)<br />\| sort by vuln\_sw\_counter asc<br />\| fields - \_count<br />\| limit 10|
|CloudPassage Halo|Critical Issues|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}  "current\_issues\_by\_criticality\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\"count\\": (?\<true\_count1\>[0-9]+), \\"critical\\": true" multi<br />\| sum(true\_count1) as count\_issues <br />\| toInt(count\_issues)<br />\| format("%d", count\_issues) as count\_issues|
|CloudPassage Halo|Critical Issues Delta Over 10 Minutes|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}   "current\_issues\_by\_criticality\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\"count\\": (?\<true\_count1\>[0-9]+), \\"critical\\": true" multi<br />\| sum(true\_count1) as count\_issues <br />\| toInt(count\_issues)<br />\| format("%d", count\_issues) as count\_issues<br />\| compare timeshift -10m<br />\| count\_issues - count\_issues\_10m as difference<br />\| toInt(difference)<br />\| format("%d", difference) as difference<br />\| concat (count\_issues, "(delta = ", difference, ")") as critical\_issue\_delta\_over\_10Mins<br />\| fields critical\_issue\_delta\_over\_10Mins|
|CloudPassage Halo|Critical Issues Outlier|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Critical Events|\_sourceCategory={{Logsdatasource}}   "current\_issues\_by\_criticality\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| parse regex field=metrics "\\"count\\": (?\<true\_count1\>[0-9]+), \\"critical\\": true" multi<br />\| timeslice 5m<br />\| sum(true\_count1) as count\_issues  by \_timeslice<br />\| outlier count\_issues|
|CloudPassage Halo|Critical Issues Over Time|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Critical Events|\_sourceCategory={{Logsdatasource}}  "current\_issues\_by\_criticality\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| parse regex field=metrics "\\"count\\": (?\<true\_count1\>[0-9]+), \\"critical\\": true" multi<br />\| timeslice 5m<br />\| sum(true\_count1) as count\_issues  by \_timeslice<br /><br />|
|CloudPassage Halo|Linux Bottom 10 Processes|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}   "processes\_summary" "process\_name"<br />\| parse regex "\\"log\\": \\{\\"processes\_summary\\"\\: \\{\\"count\\": [0-9]+, \\"servers\\": (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\"count\\": (?\<count\_proc\>[0-9]+), \\"os\_type\\": \\"linux\\", \\"process\_name\\": \\"(?\<proc\_name\>\\w+)\\"" multi<br />\| count by proc\_name, count\_proc <br />\| number(count\_proc)<br />\| sort by count\_proc asc<br />\| fields - \_count<br />\| limit 10|
|CloudPassage Halo|Linux Top 10 Processes|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}   "processes\_summary" "process\_name" "os\_type"<br />\| parse regex "\\"log\\": \\{\\"processes\_summary\\"\\: \\{\\"count\\": [0-9]+, \\"servers\\": (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\"count\\": (?\<count\_proc\>[0-9]+), \\"os\_type\\": \\"linux\\", \\"process\_name\\": \\"(?\<proc\_name\>\\w+)\\"" multi<br />\| count by count\_proc, proc\_name<br />\| top 10 proc\_name by count\_proc|
|CloudPassage Halo|Non Critical Issues|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}   "current\_issues\_by\_criticality\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\"count\\": (?\<true\_count1\>[0-9]+), \\"critical\\": false" multi<br />\| sum(true\_count1) as count\_issues <br />\| toInt(count\_issues)<br />\| format("%d", count\_issues) as count\_issues|
|CloudPassage Halo|Number of OS Types|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}   "os\_types\_summary"<br />\| parse regex "\\"os\_types\_summary\\": \\{\\"count\\": (?\<num\_of\_os\_types\>\\d\*),"<br />\| first(num\_of\_os\_types) as os\_counter<br />\| toInt(os\_counter)<br />\| format("%d", os\_counter) as os\_counter |
|CloudPassage Halo|Number of Processes|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\"processes\_summary\\": \\{\\"count\\": (?\<num\_of\_processes\>\\d\*),"<br />\| first (num\_of\_processes) as proc\_counter<br />\| toInt(proc\_counter)<br />\| format("%d", proc\_counter) as proc\_counter|
|CloudPassage Halo|Number of Software Packages|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}   "sw\_packages\_summary"<br />\| parse regex "\\"sw\_packages\_summary\\":\\{\\"count\\":(?\<num\_of\_sw\_packages\>\\d\*),"<br />\| first (num\_of\_sw\_packages) as sw\_counter<br />\| toInt(sw\_counter)<br />\| format("%d", sw\_counter) as sw\_counter|
|CloudPassage Halo|Number of User Accounts|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}  "local\_accounts\_summary"<br />\| parse regex "\\"local\_accounts\_summary\\": \\{\\"count\\": (?\<num\_of\_local\_accounts\>\\d\*),"<br />\| first(num\_of\_local\_accounts)  as acct\_counter<br />\| toInt(acct\_counter)<br />\| format("%d", acct\_counter) as acct\_counter|
|CloudPassage Halo|Outlier in Critical Issues|Logs|Installed Apps/CloudPassage Halo/Outlier in Critical Issues|\_sourceCategory={{Logsdatasource}}  "current\_issues\_by\_criticality\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| parse regex field=metrics "\\"count\\": (?\<true\_count1\>[0-9]+), \\"critical\\": true" multi<br />\| timeslice 5m<br />\| sum(true\_count1) as count\_issues  by \_timeslice<br />\| outlier count\_issues<br />\| where count\_issues\_violation =1|
|CloudPassage Halo|Outlier in Critical Issues|Logs|CloudPassage Halo/Outlier in Critical Issues|\_sourceCategory = Labs/Cloudpassage/Halo "current\_issues\_by\_criticality\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| parse regex field=metrics "\\"count\\": (?\<true\_count1\>[0-9]+), \\"critical\\": true" multi<br />\| timeslice 5m<br />\| sum(true\_count1) as count\_issues  by \_timeslice<br />\| outlier count\_issues<br />\| where count\_issues\_violation =1|
|CloudPassage Halo|Outlier on Delta (today - yesterday) of Critical Issues|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Critical Events|\_sourceCategory={{Logsdatasource}}  "current\_issues\_by\_criticality\_summary"<br />\| parse regex "\\"log\\": \\{\\"(?\<metric\_type\>\\w\*)\\"\\: (?\<metrics\>.\*)\\}"<br />\| parse regex field=metrics "\\"count\\": (?\<true\_count1\>[0-9]+), \\"critical\\": true" multi<br />\| timeslice 5m<br /><br />//\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss:SSS") as messageDate<br />\| sum(true\_count1) as count\_issues\_today  by \_timeslice<br />\| compare with timeshift 1d as vs\_yesterday<br />// create a delta field that represents the difference between historical data and current data<br />\|(count\_issues\_today - count\_issues\_today\_vs\_yesterday) as delta<br />// use an Outlier to statistically monitor spikes or dips in the delta<br />\| outlier delta threshold = 2, window = 5<br /><br />|
|CloudPassage Halo|Top 10 SW Vulnerabilities|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}  "sw\_vulnerability\_summary" "rule\_key"<br />\| parse regex "\\"log\\": \\{\\"sw\_vulnerability\_summary\\"\\: \\{\\"count\\": [0-9]+, \\"issues\\": (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\"count\\": (?\<vuln\_sw\_counter\>\\d+), \\"name\\": \\"(?\<vuln\_sw\_name\>[^,]\*)\\", \\"rule\_key\\": [^,]\*, \\"critical\\": (?\<criticality\>\\w+)," multi<br />\| count by vuln\_sw\_counter, vuln\_sw\_name<br />\| top 10 vuln\_sw\_name by vuln\_sw\_counter|
|CloudPassage Halo|Windows Bottom 10 Services|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}   "processes\_summary" "process\_name" "os\_type"<br />\| parse regex "\\"log\\": \\{\\"processes\_summary\\"\\: \\{\\"count\\": [0-9]+, \\"servers\\": (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\{\\"count\\": (?\<count\_svc\>[0-9]+), \\"os\_type\\": \\"windows\\", \\"process\_name\\": \\"(?\<svc\_name\>\\w+\\.\\w+)\\"\\}" multi<br />\| count by svc\_name, count\_svc<br />\| number(count\_svc)<br />\| sort by count\_svc asc<br />\| fields - \_count<br />\| limit 10|
|CloudPassage Halo|Windows Top 10 Services|Logs|Installed Apps/CloudPassage Halo/CloudPassage Halo - Overview|\_sourceCategory={{Logsdatasource}}  "processes\_summary" "process\_name" "os\_type"<br />\| parse regex "\\"log\\": \\{\\"processes\_summary\\"\\: \\{\\"count\\": [0-9]+, \\"servers\\": (?\<metrics\>.\*)\\}"<br />\| first(metrics)<br />\| parse regex field=\_first "\\{\\"count\\": (?\<count\_svc\>[0-9]+), \\"os\_type\\": \\"windows\\", \\"process\_name\\": \\"(?\<svc\_name\>\\w+\\.\\w+)\\"\\}" multi<br />\| count by svc\_name, count\_svc<br />\| top 10 svc\_name by count\_svc|

