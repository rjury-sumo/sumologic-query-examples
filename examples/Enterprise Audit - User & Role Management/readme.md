# Enterprise Audit - User & Role Management

## Searches

### Log Searches

- **Account Locked Vs Account Unlocked**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Active Admins**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities  
- **Active Admins**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New 
- **Active Admins**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities 
- **Active Admins**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities 
- **Active Admins performing Account Unlock**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Active Admins performing Account Unlock**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Active Admins Performing Password Resets**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities 
- **Active Admins Performing Password Resets**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New 
- **Active Users Vs Inactive Users**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities 
- **Activities Over Time**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Authentication Source Comparison**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Authentication Source Comparison**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Current Locked User count**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Current Locked User count**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Current Logged In Users**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Current Logged In Users**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Distribution By Role Activities**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Distribution By User Activities**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Distribution By User Sessions**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Email Change Requested Vs Email Changed**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Events - Recent Sessions**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Events - Recent Sessions**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Geo Location**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities 
- **Geo Location**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities 
- **Geo Location**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New 
- **Geo Location**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities 
- **Geo Location of Admins**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New 
- **Geo Location of Admins**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities  
- **Geo Location Of User Sessions**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Geo Location Of User Sessions**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Locked Out Users Activity**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Locked Out Users Activity**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Logged Out Users Count**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Logged Out Users Count**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **One Day Time Shift Comparison**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **One Day Time Shift Comparison**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities 
- **One Day Time Shift Comparison**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities 
- **One Day Time Shift Comparison**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities 
- **One Day Time Shift Comparison**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New 
- **One Day Time Shift Comparison**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Password Reset Vs Password Changed**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Recent - Email Change Activity**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New 
- **Recent - Email Change Activity**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities 
- **Recent - Password Reset Activity**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New 
- **Recent - Password Reset Activity**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities 
- **Recent - Role Activities**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities 
- **Recent - Roles Assigned/Removed from User**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities  
- **Recent - Roles Assigned/Removed from User**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New 
- **Recent - User Activities**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities 
- **Recent - Users Assigned/Removed from Roles**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities  
- **Recent - Users Assigned/Removed from Roles**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New 
- **System Defined Vs User Defined**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities 
- **Timed Out Users Count**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Timed Out Users Count**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Top Capabilities Added To Roles**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities 
- **Top Roles Added To Users**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New 
- **Top Roles Added To Users**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities  
- **Top Roles Removed From Users**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities  
- **Top Roles Removed From Users**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New 
- **Top Users**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Top Users Added To Roles**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities  
- **Top Users Added To Roles**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New 
- **Top Users By Activities**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview 
- **Top Users Removed From Roles**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities  
- **Top Users Removed From Roles**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New 
- **Trend - Role Events**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities 
- **Trend - User Email Activity**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New 
- **Trend - User Email Activity**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities 
- **Trend - User Events**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities 
- **Trend - User Password Activity**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities 
- **Trend - User Password Activity**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New 
- **Trend - UserLocked Vs Unlocked**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Trend - UserLocked Vs Unlocked**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities 
- **Users Unlocked Activity**: from Dashboard: Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New 
- **Users Unlocked Activity**: from Dashboard: Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Enterprise Audit - User & Role Management|Account Locked Vs Account Unlocked|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLockedOut OR UserUnlocked)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserLockedOut","UserUnlocked")<br />\| count as Count by EventName<br />\| fillmissing values("UserLockedOut", "UserUnlocked") in EventName|
|Enterprise Audit - User & Role Management|Active Admins|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities |\_index=sumologic\_audit\_events (\_sourceCategory=users OR \_sourceCategory=roles) (RolesAssignedToUserUpdated OR UsersAssignedToRoleUpdated)<br />\| json "eventName", "eventTime", "operator.email","operator.id","operator.sourceIp" as EventName, EventTime, Admin, AdminId, AdminIp nodrop<br />\| where EventName in ("RolesAssignedToUserUpdated","UsersAssignedToRoleUpdated")<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count as Count by Admin <br />\| sort by Count<br />\| limit 5<br /><br />|
|Enterprise Audit - User & Role Management|Active Admins|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New|\_index=sumologic\_audit\_events (\_sourceCategory=users OR \_sourceCategory=roles) (RolesAssignedToUserUpdated OR UsersAssignedToRoleUpdated)<br />\| json "eventName", "eventTime", "operator.email","operator.id","operator.sourceIp" as EventName, EventTime, Admin, AdminId, AdminIp nodrop<br />\| where EventName in ("RolesAssignedToUserUpdated","UsersAssignedToRoleUpdated")<br />\|where if ("{{Admin}}" = "\*", true, Admin matches "{{Admin}}") AND if ("{{AdminIp}}" = "\*", true, AdminIp matches "{{AdminIp}}")<br />\|count as Count by Admin <br />\| sort by Count<br />\| limit 5|
|Enterprise Audit - User & Role Management|Active Admins|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities|\_index=sumologic\_audit\_events \_sourceCategory=roles (RoleCreated OR RoleUpdated OR RoleDeleted)<br />\| json "eventName", "to.capabilities", "operator.email", "operator.sourceIp"  as EventName, capabilities\_updated, Admin, AdminIp nodrop<br />\| if(isEmpty(Admin) , "SystemGenerated", Admin) as Admin<br />\| where EventName in ("RoleCreated","RoleUpdated","RoleDeleted") AND EventName matches "{{EventName}}"<br />\| where EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"\|count by Admin, EventName<br />\| transpose row Admin column EventName as %"RoleCreated", %"RoleUpdated", %"RoleDeleted"<br />\| sort by RoleCreated, RoleUpdated, RoleDeleted<br />\| limit 5<br />|
|Enterprise Audit - User & Role Management|Active Admins|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserCreated OR UserUpdated OR UserDeleted)<br />\| json "eventName", "operator.email", "operator.sourceIp" as EventName, Admin, AdminIp nodrop<br />\| if(isEmpty(Admin) , "SystemGenerated", Admin) as Admin<br />\| where EventName in ("UserCreated","UserUpdated", "UserDeleted")<br />\| where  EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"\|count by Admin, EventName<br />\| transpose row Admin column EventName as %"UserCreated", %"UserUpdated", %"UserDeleted"<br />\| sort by UserCreated, UserUpdated, UserDeleted<br />\| limit 5<br />|
|Enterprise Audit - User & Role Management|Active Admins performing Account Unlock|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserUnlocked<br />\| json "eventName", "eventTime", "accountId", "operator", "userSession.sourceIp" as EventName, EventTime, AccountId, operator, UserIp nodrop<br />\| where EventName="UserUnlocked"<br />\| json field=operator "email", "interface" as UnlockedBy , Interface nodrop<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\|count as Unlock\_Count by UnlockedBy<br />\| sort by Unlock\_Count<br />\| limit 5|
|Enterprise Audit - User & Role Management|Active Admins performing Account Unlock|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserUnlocked<br />\| json "eventName", "eventTime", "accountId", "operator" as EventName, EventTime, AccountId, operator nodrop<br />\| where EventName="UserUnlocked"<br />\| json field=operator "email", "interface" as UnlockedBy , Interface nodrop<br />\|where if ("{{UnlockedBy}}" = "\*", true, UnlockedBy matches "{{UnlockedBy}}")<br />\|count as Unlock\_Count by UnlockedBy<br />\| sort by Unlock\_Count<br />\| limit 5|
|Enterprise Audit - User & Role Management|Active Admins Performing Password Resets|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities|\_index=sumologic\_audit\_events \_sourceCategory=users UserPasswordReset<br />\| json "eventName", "operator.email", "operator.sourceIp"  as EventName, Admin, AdminIp nodrop<br />\| where EventName="UserPasswordReset"<br />\| where EventName matches "{{EventName}}" and if("{{Admin}}"="\*", true, Admin matches "{{Admin}}") and if("{{AdminIp}}"="\*", true, AdminIp matches "{{AdminIp}}")<br />\|count as Count by EventName, Admin<br />\| sort by Count<br />\| fields - EventName<br />\| limit 10<br /><br />|
|Enterprise Audit - User & Role Management|Active Admins Performing Password Resets|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users UserPasswordReset<br />\| json "eventName", "eventTime", "operator.email" as EventName, EventTime, Admin nodrop<br />\| where EventName="UserPasswordReset"<br />\|where if ("{{Admin}}" = "\*", true, Admin matches "{{Admin}}")<br />\|count as Count by EventName, Admin<br />\| sort by Count<br />\| fields - EventName<br />\| limit 10|
|Enterprise Audit - User & Role Management|Active Users Vs Inactive Users|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserCreated OR UserUpdated OR UserDeleted)<br />\| json "eventName", "userIdentity.userId", "user.active", "to.active", "operator.email", "operator.sourceIp" as EventName, UserId, ActiveCreated, ActiveUpdated,  Admin, AdminIp nodrop<br />\| where EventName in ("UserCreated","UserUpdated", "UserDeleted")<br />\| where  EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\| if(isNull(ActiveCreated), if(isNull(ActiveUpdated), "-", ActiveUpdated) ,ActiveCreated) as CurrentActive<br />\| withtime CurrentActive<br />\| most\_recent(CurrentActive\_withtime) as Status by UserId<br />\| where Status!="-"<br />\| count as Count by Status<br />\| if(Status matches "true", "Active", "InActive") as Status|
|Enterprise Audit - User & Role Management|Activities Over Time|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events<br />\| where \_sourceCategory in ("users", "roles", "userSessions")<br />\| \_sourceCategory as Category<br />\| timeslice 12h<br />\| count by \_timeslice, Category<br />\| fillmissing timeslice(12h), values("users","roles","userSessions") in Category<br />\| transpose row \_timeslice column Category|
|Enterprise Audit - User & Role Management|Authentication Source Comparison|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLoggedIn<br />\| json "eventName", "authenticationSource", "userSession.sourceIp" as EventName, AuthenticationSource, UserIp nodrop<br />\| where EventName="UserLoggedIn"<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\|count as Count by AuthenticationSource<br />|
|Enterprise Audit - User & Role Management|Authentication Source Comparison|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLoggedIn<br />\| json "eventName", "authenticationSource" as EventName, AuthenticationSource nodrop<br />\| where EventName="UserLoggedIn"<br />\|where if ("{{AuthenticationSource}}" = "\*", true, AuthenticationSource matches "{{AuthenticationSource}}")<br />\|count as Count by AuthenticationSource|
|Enterprise Audit - User & Role Management|Current Locked User count|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLockedOut OR UserUnlocked)<br />\| json "eventName", "userIdentity.userEmail" as EventName, UserId nodrop<br />\| where EventName in ("UserLockedOut", "UserUnlocked")<br />\| withtime EventName<br />\| most\_recent(EventName\_withtime) as LastEvent by UserId<br />\| where LastEvent matches "UserLockedOut"<br />\| count as Count by LastEvent<br />\| fillmissing values("UserLockedOut") in LastEvent|
|Enterprise Audit - User & Role Management|Current Locked User count|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLockedOut OR UserUnlocked)<br />\| json "eventName", "userIdentity.userEmail", "userSession.sourceIp" as EventName, UserId, UserIp nodrop<br />\| where EventName in ("UserLockedOut", "UserUnlocked")<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\| withtime EventName<br />\| most\_recent(EventName\_withtime) as LastEvent by UserId<br />\| where LastEvent matches "UserLockedOut"<br />\| count as Count by LastEvent<br />\| fillmissing values("UserLockedOut") in LastEvent<br />|
|Enterprise Audit - User & Role Management|Current Logged In Users|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLoggedOut OR UserLoggedIn OR UserLoginTimedOut)<br />\| json "eventName", "userSession.id", "sessionIdentity.userId" as EventName, LoginUserId, LogoutUserID nodrop<br />\| where EventName in ("UserLoggedOut","UserLoggedIn","UserLoginTimedOut")<br />\| if(isNull(LoginUserId), LogoutUserID, LoginUserId) as UserId<br />\| withtime EventName<br />\| most\_recent(EventName\_withtime) as LastEvent by UserId<br />\| where UserId!="-"<br />\| where LastEvent matches "UserLoggedIn"<br />\| count as Count by LastEvent<br />\| fillmissing values("UserLoggedIn") in LastEvent|
|Enterprise Audit - User & Role Management|Current Logged In Users|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLoggedOut OR UserLoggedIn OR UserLoginTimedOut)<br />\| json "eventName", "userSession.id", "sessionIdentity.userId", "userSession.sourceIp"  as EventName, LoginUserId, LogoutUserID, UserIp nodrop<br />\| where EventName in ("UserLoggedOut","UserLoggedIn","UserLoginTimedOut")<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\| if(isNull(LoginUserId), LogoutUserID, LoginUserId) as UserId<br />\| withtime EventName<br />\| most\_recent(EventName\_withtime) as LastEvent by UserId<br />\| where UserId!="-"<br />\| where LastEvent matches "UserLoggedIn"<br />\| count as Count by LastEvent<br />\| fillmissing values("UserLoggedIn") in LastEvent<br />|
|Enterprise Audit - User & Role Management|Distribution By Role Activities|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=roles (RoleCreated OR RoleUpdated OR RoleDeleted)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("RoleCreated","RoleUpdated","RoleDeleted")<br />\| count as Count by EventName|
|Enterprise Audit - User & Role Management|Distribution By User Activities|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=users (UserCreated OR UserUpdated OR UserDeleted)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserCreated","UserUpdated","UserDeleted")<br />\| count as Count by EventName|
|Enterprise Audit - User & Role Management|Distribution By User Sessions|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLoggedIn OR UserLoggedOut OR UserLoginTimedOut)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserLoggedIn","UserLoggedOut","UserLoginTimedOut")<br />\| count as Count by EventName|
|Enterprise Audit - User & Role Management|Email Change Requested Vs Email Changed|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=users (UserEmailChanged OR UserEmailChangeRequested)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserEmailChanged","UserEmailChangeRequested")<br />\| count as Count by EventName<br />\| fillmissing values("UserEmailChanged", "UserEmailChangeRequested") in EventName|
|Enterprise Audit - User & Role Management|Events - Recent Sessions|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLoggedOut OR UserLoggedIn OR UserLockedOut OR UserUnlocked OR UserLoginTimedOut)<br />\| json "eventName", "eventTime", "accountId" as EventName, EventTime, AccountId nodrop<br />\| json "userSession.email", "userSession.id" as LoginUser, LoginUserId nodrop<br />\| json "sessionIdentity.userEmail", "sessionIdentity.userId" as LogoutUser, LogoutUserId nodrop<br />\| json "userIdentity.userEmail", "userIdentity.userId" as LockedUser, LockedUserId nodrop<br />\| json "authenticationSource" as AuthenticationSource nodrop<br />\| if(isEmpty(LoginUser), if(isEmpty(LogoutUser), if(isEmpty(LockedUser), "", LockedUser),LogoutUser), LoginUser) as User<br />\| if(isEmpty(LoginUserId), if(isEmpty(LogoutUserId), if(isEmpty(LockedUserId), "", LockedUserId),LogoutUserId), LoginUserId) as UserId<br />\| \_sourceHost as UserIp<br />\| where EventName in ("UserLoggedOut", "UserLoggedIn", "UserLockedOut", "UserUnlocked", "UserLoginTimedOut") AND EventName matches "{{EventName}}"<br />\|where if ("{{User}}" = "\*", true, User matches "{{User}}") AND if ("{{UserIp}}" = "\*", true, UserIp matches "{{UserIp}}") AND if ("{{AuthenticationSource}}" = "\*", true, AuthenticationSource matches "{{AuthenticationSource}}")<br />\|count by EventName, EventTime, User, UserId, UserIp, AuthenticationSource<br />\| sort by EventTime<br />\| fields - \_count, UserId<br />\| limit 100|
|Enterprise Audit - User & Role Management|Events - Recent Sessions|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLoggedOut OR UserLoggedIn OR UserLockedOut OR UserUnlocked OR UserLoginTimedOut)<br />\| json "eventName", "eventTime", "accountId", "userSession.sourceIp" as EventName, EventTime, AccountId, UserIp nodrop<br />\| json "userSession.email", "userSession.id" as LoginUser, LoginUserId nodrop<br />\| json "sessionIdentity.userEmail", "sessionIdentity.userId" as LogoutUser, LogoutUserId nodrop<br />\| json "userIdentity.userEmail", "userIdentity.userId" as LockedUser, LockedUserId nodrop<br />\| json "authenticationSource" as AuthenticationSource nodrop<br />\| if(isEmpty(LoginUser), if(isEmpty(LogoutUser), if(isEmpty(LockedUser), "", LockedUser),LogoutUser), LoginUser) as User<br />\| if(isEmpty(LoginUserId), if(isEmpty(LogoutUserId), if(isEmpty(LockedUserId), "", LockedUserId),LogoutUserId), LoginUserId) as UserId<br />\| \_sourceHost as UserIp<br />\| where EventName in ("UserLoggedOut", "UserLoggedIn", "UserLockedOut", "UserUnlocked", "UserLoginTimedOut") <br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\|count by EventName, EventTime, User, UserId, UserIp, AuthenticationSource<br />\| sort by EventTime<br />\| fields - \_count, UserId<br />\| limit 100<br /><br />|
|Enterprise Audit - User & Role Management|Geo Location|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserEmailChangeRequested OR UserEmailChanged OR UserPasswordReset OR UserPasswordChanged)<br />\| json "eventName", "operator.email", "operator.sourceIp"  as EventName, Admin, AdminIp nodrop<br />\| where EventName in ("UserEmailChangeRequested", "UserEmailChanged", "UserPasswordReset", "UserPasswordChanged") <br />\| where EventName matches "{{EventName}}" and if("{{Admin}}"="\*", true, Admin matches "{{Admin}}") and AdminIp matches "{{AdminIp}}"\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = AdminIp<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />|
|Enterprise Audit - User & Role Management|Geo Location|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities|\_index=sumologic\_audit\_events \_sourceCategory=roles (RoleCreated OR RoleUpdated OR RoleDeleted)<br />\| json "eventName", "to.capabilities", "operator.email", "operator.sourceIp"  as EventName, capabilities\_updated, Admin, AdminIp nodrop<br />\| where EventName in ("RoleCreated","RoleUpdated","RoleDeleted") <br />\| where EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = AdminIp<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />|
|Enterprise Audit - User & Role Management|Geo Location|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users (UserEmailChangeRequested OR UserEmailChanged OR UserPasswordReset OR UserPasswordChanged)<br />\| json "eventName", "operator.sourceIp" as EventName, AdminIp<br />\| where EventName in ("UserEmailChangeRequested", "UserEmailChanged", "UserPasswordReset", "UserPasswordChanged") AND EventName matches "{{EventName}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = AdminIp<br />\|where if ("{{AdminIp}}" = "\*", true, AdminIp matches "{{AdminIp}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Enterprise Audit - User & Role Management|Geo Location|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserCreated OR UserUpdated OR UserDeleted)<br />\| json "eventName", "operator.email", "operator.sourceIp" as EventName, Admin, AdminIp nodrop<br />\| where EventName in ("UserCreated","UserUpdated", "UserDeleted") <br />\| where  EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = AdminIp<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Enterprise Audit - User & Role Management|Geo Location of Admins|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New|\_index=sumologic\_audit\_events (\_sourceCategory=users OR \_sourceCategory=roles) (RolesAssignedToUserUpdated OR UsersAssignedToRoleUpdated)<br />\| json "eventName", "eventTime", "operator.sourceIp" as EventName, EventTime, AdminIp nodrop<br />\| where EventName in ("RolesAssignedToUserUpdated","UsersAssignedToRoleUpdated")<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = AdminIp<br />\|where if ("{{AdminIp}}" = "\*", true, AdminIp matches "{{AdminIp}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Enterprise Audit - User & Role Management|Geo Location of Admins|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities |\_index=sumologic\_audit\_events (\_sourceCategory=users OR \_sourceCategory=roles) (RolesAssignedToUserUpdated OR UsersAssignedToRoleUpdated)<br />\| json "eventName", "eventTime", "operator.sourceIp" as EventName, EventTime, AdminIp nodrop<br />\| where EventName in ("RolesAssignedToUserUpdated","UsersAssignedToRoleUpdated")<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = AdminIp<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br /><br /><br />|
|Enterprise Audit - User & Role Management|Geo Location Of User Sessions|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLoggedIn<br />\| json "eventName", "userSession.sourceIp" as EventName,UserIp  nodrop <br />\| where EventName="UserLoggedIn" AND EventName matches "{{EventName}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = UserIp<br />\|where EventName matches "\*"<br />\|where if ("{{UserIp}}" = "\*", true, UserIp matches "{{UserIp}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Enterprise Audit - User & Role Management|Geo Location Of User Sessions|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLoggedIn<br />\| json "eventName", "userSession.sourceIp" as EventName,UserIp  nodrop <br />\| where EventName="UserLoggedIn" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = UserIp<br />\|where EventName matches "\*"<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />|
|Enterprise Audit - User & Role Management|Locked Out Users Activity|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLockedOut<br />\| json "eventName", "eventTime", "accountId", "userIdentity", "userSession.sourceIp" as EventName, EventTime, AccountId, userIdentity, UserIp nodrop<br />\| where EventName="UserLockedOut"<br />\| json field=userIdentity "userEmail", "userId" as User, UserId nodrop<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\|count by EventName, EventTime, AccountId, User, UserId<br />\| sort by EventTime<br />\| fields - \_count, EventName, AccountId, UserId<br /><br />|
|Enterprise Audit - User & Role Management|Locked Out Users Activity|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLockedOut<br />\| json "eventName", "eventTime", "accountId", "userIdentity" as EventName, EventTime, AccountId, userIdentity nodrop<br />\| where EventName="UserLockedOut"<br />\| json field=userIdentity "userEmail", "userId" as User, UserId nodrop<br />\|where if ("{{User}}" = "\*", true, User matches "{{User}}")<br />\|count by EventName, EventTime, AccountId, User, UserId<br />\| sort by EventTime<br />\| fields - \_count, EventName, AccountId, UserId|
|Enterprise Audit - User & Role Management|Logged Out Users Count|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLoggedOut<br />\| json "eventName", "userSession.sourceIp" as EventName, UserIp nodrop<br />\| where EventName="UserLoggedOut"<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\| count as Count by EventName<br />\| fillmissing values("UserLoggedOut") in EventName<br /><br />|
|Enterprise Audit - User & Role Management|Logged Out Users Count|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLoggedOut<br />\| json "eventName" as EventName nodrop<br />\| where EventName="UserLoggedOut"<br />\| count as Count by EventName<br />\| fillmissing values("UserLoggedOut") in EventName|
|Enterprise Audit - User & Role Management|One Day Time Shift Comparison|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events  \_sourceCategory=userSessions (UserLoggedOut OR UserLoggedIn OR UserLockedOut OR UserUnlocked OR UserLoginTimedOut)<br />\| json "eventName", "userSession.sourceIp" as EventName, UserIp nodrop<br />\| where EventName in ("UserLoggedOut", "UserLoggedIn", "UserLockedOut", "UserUnlocked", "UserLoginTimedOut") <br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\| count as Count by EventName<br />\| fillmissing values("UserLoggedOut", "UserLoggedIn", "UserLockedOut", "UserUnlocked", "UserLoginTimedOut") in EventName <br />\| compare timeshift 1d as Shift\_1d<br /><br />|
|Enterprise Audit - User & Role Management|One Day Time Shift Comparison|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserCreated OR UserUpdated OR UserDeleted)<br />\| json "eventName", "operator.email", "operator.sourceIp" as EventName, Admin, AdminIp nodrop<br />\| where EventName in ("UserCreated","UserUpdated", "UserDeleted")<br />\| where  EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\|count as Count by EventName<br />\| fillmissing values("UserCreated","UserUpdated","UserDeleted") in EventName<br />\| compare with timeshift 1d as Shift\_1d<br />|
|Enterprise Audit - User & Role Management|One Day Time Shift Comparison|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserPasswordReset OR UserPasswordChanged OR UserEmailChangeRequested OR UserEmailChanged)<br />\| json "eventName", "operator.email", "operator.sourceIp"  as EventName, Admin, AdminIp nodrop<br />\| where EventName in ("UserPasswordReset", "UserPasswordChanged", "UserEmailChangeRequested", "UserEmailChanged")<br />\| where EventName matches "{{EventName}}" and if("{{Admin}}"="\*", true, Admin matches "{{Admin}}") and if("{{AdminIp}}"="\*", true, AdminIp matches "{{AdminIp}}")<br />\| count as Count by EventName<br />\| fillmissing values("UserPasswordReset","UserPasswordChanged","UserEmailChangeRequested","UserEmailChanged") in EventName<br />\| compare with timeshift 1d as Shift\_1d<br /><br />|
|Enterprise Audit - User & Role Management|One Day Time Shift Comparison|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities|\_index=sumologic\_audit\_events \_sourceCategory=roles (RoleCreated OR RoleUpdated OR RoleDeleted)<br />\| json "eventName", "to.capabilities", "operator.email", "operator.sourceIp"  as EventName, capabilities\_updated, Admin, AdminIp nodrop<br />\| where EventName in ("RoleCreated","RoleUpdated","RoleDeleted") <br />\| where EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\|count as Count by EventName<br />\| fillmissing values("RoleCreated","RoleUpdated","RoleDeleted") in EventName<br />\| compare with timeshift 1d as Shift\_1d<br /><br />|
|Enterprise Audit - User & Role Management|One Day Time Shift Comparison|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users (UserPasswordReset OR UserPasswordChanged OR UserEmailChangeRequested OR UserEmailChanged)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserPasswordReset", "UserPasswordChanged", "UserEmailChangeRequested", "UserEmailChanged") AND EventName matches "{{EventName}}"<br />\| count as Count by EventName<br />\| fillmissing values("UserPasswordReset","UserPasswordChanged","UserEmailChangeRequested","UserEmailChanged") in EventName<br />\| compare with timeshift 1d as Shift\_1d|
|Enterprise Audit - User & Role Management|One Day Time Shift Comparison|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events  \_sourceCategory=userSessions (UserLoggedOut OR UserLoggedIn OR UserLockedOut OR UserUnlocked OR UserLoginTimedOut)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserLoggedOut", "UserLoggedIn", "UserLockedOut", "UserUnlocked", "UserLoginTimedOut") AND EventName matches "{{EventName}}"<br />\| count as Count by EventName<br />\| fillmissing values("UserLoggedOut", "UserLoggedIn", "UserLockedOut", "UserUnlocked", "UserLoginTimedOut") in EventName <br />\| compare timeshift 1d as Shift\_1d|
|Enterprise Audit - User & Role Management|Password Reset Vs Password Changed|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=users (UserPasswordChanged OR UserPasswordReset)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserPasswordChanged","UserPasswordReset")<br />\| count as Count by EventName<br />\| fillmissing values("UserPasswordChanged", "UserPasswordReset") in EventName|
|Enterprise Audit - User & Role Management|Recent - Email Change Activity|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users UserEmailChanged<br />\| json "eventName", "eventTime", "userIdentity.userId", "newEmail", "oldEmail" as EventName, EventTime, TargetUserId, TargetUserEmail, TargetUserOldEmail nodrop<br />\| where EventName="UserEmailChanged"<br />\|where if ("{{TargetUserEmail}}" = "\*", true, TargetUserEmail matches "{{TargetUserEmail}}")<br />\|count by EventName, EventTime, TargetUserId, TargetUserEmail, TargetUserOldEmail<br />\| sort by EventTime<br />\| fields - \_count, EventName, TargetUserId|
|Enterprise Audit - User & Role Management|Recent - Email Change Activity|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities|\_index=sumologic\_audit\_events \_sourceCategory=users UserEmailChanged<br />\| json "eventName", "eventTime", "userIdentity.userId", "newEmail", "oldEmail","operator.email", "operator.sourceIp" as EventName, EventTime, TargetUserId, TargetUserEmail, TargetUserOldEmail, Admin, AdminIp nodrop<br />\| where EventName="UserEmailChanged"<br />\| where EventName matches "{{EventName}}" and if("{{Admin}}"="\*", true, Admin matches "{{Admin}}") and if("{{AdminIp}}"="\*", true, AdminIp matches "{{AdminIp}}")<br />\|count by EventName, EventTime, TargetUserId, TargetUserEmail, TargetUserOldEmail<br />\| sort by EventTime<br />\| fields - \_count, EventName, TargetUserId<br /><br /><br />|
|Enterprise Audit - User & Role Management|Recent - Password Reset Activity|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users UserPasswordReset<br />\| json "eventName", "eventTime", "operator.email", "operator.id", "operator.sourceIp", "userIdentity.userId", "userIdentity.userEmail" as EventName, EventTime, Admin, AdminId, AdminIp, TargetUserId, TargetUserEmail nodrop<br />\| where EventName="UserPasswordReset"<br />\|where if ("{{Admin}}" = "\*", true, Admin matches "{{Admin}}") AND if ("{{AdminIp}}" = "\*", true, AdminIp matches "{{AdminIp}}") AND if ("{{TargetUserEmail}}" = "\*", true, TargetUserEmail matches "{{TargetUserEmail}}")<br />\|count by EventName, EventTime, Admin, AdminId, AdminIp, TargetUserId, TargetUserEmail<br />\| sort by EventTime<br />\| fields - \_count, EventName, AdminId, TargetUserId|
|Enterprise Audit - User & Role Management|Recent - Password Reset Activity|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities|\_index=sumologic\_audit\_events \_sourceCategory=users UserPasswordReset<br />\| json "eventName", "eventTime", "operator.email", "operator.id", "operator.sourceIp", "userIdentity.userId", "userIdentity.userEmail" as EventName, EventTime, Admin, AdminId, AdminIp, TargetUserId, TargetUserEmail nodrop<br />\| where EventName="UserPasswordReset"<br />\| where EventName matches "{{EventName}}" and if("{{Admin}}"="\*", true, Admin matches "{{Admin}}") and if("{{AdminIp}}"="\*", true, AdminIp matches "{{AdminIp}}")<br />\|count by EventName, EventTime, Admin, AdminId, AdminIp, TargetUserId, TargetUserEmail<br />\| sort by EventTime<br />\| fields - \_count, EventName, AdminId, TargetUserId<br /><br />|
|Enterprise Audit - User & Role Management|Recent - Role Activities|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities|\_index=sumologic\_audit\_events \_sourceCategory=roles (RoleCreated OR RoleUpdated OR RoleDeleted)<br />\| json "eventName", "eventTime", "operator.email", "operator.id", "operator.sourceIp", "roleIdentity.roleId", "roleIdentity.roleName", "role.systemDefined", "to", "from" as EventName, EventTime, Admin, AdminId, AdminIp, RoleId, RoleName, SystemDefined, CurrentValue, PreviousValue nodrop<br />\| json field=CurrentValue "systemDefined", "capabilities[\*]" as SystemDefinedUpdated, Capabilities nodrop<br />\| parse field=Capabilities "[\*]" as Capabilities nodrop<br />\| replace(Capabilities, "\\"", "") as Capabilities<br />\| if(isNull(SystemDefined), if(isNull(SystemDefinedUpdated), "-", SystemDefinedUpdated) , SystemDefined) as SystemDefined<br />\| if(isNull(Capabilities), "-" , Capabilities) as Capabilities<br />\| where EventName in ("RoleCreated","RoleUpdated","RoleDeleted") <br />\| where EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\|count by EventName, EventTime, Admin, AdminId, AdminIp, RoleId, RoleName, SystemDefined, Capabilities<br />\| sort by EventTime<br />\| fields - \_count, AdminId, RoleId|
|Enterprise Audit - User & Role Management|Recent - Roles Assigned/Removed from User|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities |\_index=sumologic\_audit\_events \_sourceCategory=users RolesAssignedToUserUpdated<br />\| json "eventName", "eventTime", "operator.email","operator.id","operator.sourceIp", "userIdentity.userId","userIdentity.userEmail", "rolesAdded[\*].roleName", "rolesDeleted[\*].roleName" as EventName, EventTime, Admin, AdminId, AdminIp, TargetUserId, TargetUserEmail, RolesAdded, RolesRemoved nodrop<br />\| where EventName="RolesAssignedToUserUpdated"<br />\| parse field=RolesAdded "[\*]" as RolesAdded nodrop<br />\| replace(RolesAdded, "\\"", "") as RolesAdded<br />\| replace(RolesAdded, "[]", "-") as RolesAdded<br />\| parse field=RolesRemoved "[\*]" as RolesRemoved nodrop<br />\| replace(RolesRemoved, "\\"", "") as RolesRemoved<br />\| replace(RolesRemoved, "[]", "-") as RolesRemoved<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count by EventName, EventTime, Admin, AdminId, AdminIp, TargetUserId, TargetUserEmail, RolesAdded, RolesRemoved<br />\| sort by EventTime<br />\| fields - \_count, EventTime, EventName, AdminId, TargetUserId|
|Enterprise Audit - User & Role Management|Recent - Roles Assigned/Removed from User|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users RolesAssignedToUserUpdated<br />\| json "eventName", "eventTime", "operator.email","operator.id","operator.sourceIp", "userIdentity.userId","userIdentity.userEmail", "rolesAdded[\*].roleName", "rolesDeleted[\*].roleName" as EventName, EventTime, Admin, AdminId, AdminIp, TargetUserId, TargetUserEmail, RolesAdded, RolesRemoved nodrop<br />\| where EventName="RolesAssignedToUserUpdated"<br />\| parse field=RolesAdded "[\*]" as RolesAdded nodrop<br />\| replace(RolesAdded, "\\"", "") as RolesAdded<br />\| replace(RolesAdded, "[]", "-") as RolesAdded<br />\| parse field=RolesRemoved "[\*]" as RolesRemoved nodrop<br />\| replace(RolesRemoved, "\\"", "") as RolesRemoved<br />\| replace(RolesRemoved, "[]", "-") as RolesRemoved<br />\|where if ("{{Admin}}" = "\*", true, Admin matches "{{Admin}}") AND if ("{{RolesRemoved}}" = "\*", true, RolesRemoved matches "{{RolesRemoved}}") AND if ("{{AdminIp}}" = "\*", true, AdminIp matches "{{AdminIp}}") AND if ("{{TargetUserEmail}}" = "\*", true, TargetUserEmail matches "{{TargetUserEmail}}") AND if ("{{RolesAdded}}" = "\*", true, RolesAdded matches "{{RolesAdded}}")<br />\|count by EventName, EventTime, Admin, AdminId, AdminIp, TargetUserId, TargetUserEmail, RolesAdded, RolesRemoved<br />\| sort by EventTime<br />\| fields - \_count, EventTime, EventName, AdminId, TargetUserId|
|Enterprise Audit - User & Role Management|Recent - User Activities|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserCreated OR UserUpdated OR UserDeleted)<br />\| json "eventName", "eventTime", "operator.email", "operator.id", "operator.sourceIp", "userIdentity.userId", "userIdentity.userEmail", "user.firstName", "user.lastName", "user.active", "to", "from" as EventName, EventTime, Admin, AdminId, AdminIp, UserId, TargetUserEmail, TargetUserFirstName, TargetUserLastName, IsTargetUserActive, CurrentValue, PreviousValue nodrop<br />\| json field=CurrentValue "firstName", "lastName", "active" as UpdatedFirstName, UpdatedLastName, UpdatedIsActive nodrop<br />\| if(isNull(TargetUserFirstName), if(isNull(UpdatedFirstName),"-",UpdatedFirstName) ,TargetUserFirstName) as TargetUserFirstName<br />\| if(isNull(TargetUserLastName), if(isNull(UpdatedLastName),"-",UpdatedLastName) ,TargetUserLastName) as TargetUserLastName<br />\| if(isNull(IsTargetUserActive), if(isNull(UpdatedIsActive),"-",UpdatedIsActive) ,IsTargetUserActive) as IsTargetUserActive<br />\| where EventName in ("UserCreated","UserUpdated", "UserDeleted") <br />\| where  EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\|count by EventName, EventTime, Admin, AdminId, AdminIp, UserId, TargetUserEmail, TargetUserFirstName, TargetUserLastName, IsTargetUserActive<br />\| sort by EventTime<br />\| fields - \_count, AdminId, UserId|
|Enterprise Audit - User & Role Management|Recent - Users Assigned/Removed from Roles|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities |\_index=sumologic\_audit\_events \_sourceCategory=roles UsersAssignedToRoleUpdated<br />\| json "eventName", "eventTime", "operator.email","operator.id","operator.sourceIp", "roleIdentity.roleId","roleIdentity.roleName", "usersAdded[\*].userEmail", "usersDeleted[\*].userEmail" as EventName, EventTime, Admin, AdminId, AdminIp, RoleId, RoleName, UsersAdded, UsersRemoved nodrop<br />\| where EventName="UsersAssignedToRoleUpdated"<br />\| parse field=UsersAdded "[\*]" as UsersAdded nodrop<br />\| replace(UsersAdded, "\\"", "") as UsersAdded<br />\| replace(UsersAdded, "[]", "-") as UsersAdded<br />\| parse field=UsersRemoved "[\*]" as UsersRemoved nodrop<br />\| replace(UsersRemoved, "\\"", "") as UsersRemoved<br />\| replace(UsersRemoved, "[]", "-") as UsersRemoved<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count by EventName, EventTime, Admin, AdminId, AdminIp, RoleId, RoleName, UsersAdded, UsersRemoved<br />\| sort by EventTime<br />\| fields - \_count, EventTime, EventName, AdminId, RoleId<br />|
|Enterprise Audit - User & Role Management|Recent - Users Assigned/Removed from Roles|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=roles UsersAssignedToRoleUpdated<br />\| json "eventName", "eventTime", "operator.email","operator.id","operator.sourceIp", "roleIdentity.roleId","roleIdentity.roleName", "usersAdded[\*].userEmail", "usersDeleted[\*].userEmail" as EventName, EventTime, Admin, AdminId, AdminIp, RoleId, RoleName, UsersAdded, UsersRemoved nodrop<br />\| where EventName="UsersAssignedToRoleUpdated"<br />\| parse field=UsersAdded "[\*]" as UsersAdded nodrop<br />\| replace(UsersAdded, "\\"", "") as UsersAdded<br />\| replace(UsersAdded, "[]", "-") as UsersAdded<br />\| parse field=UsersRemoved "[\*]" as UsersRemoved nodrop<br />\| replace(UsersRemoved, "\\"", "") as UsersRemoved<br />\| replace(UsersRemoved, "[]", "-") as UsersRemoved<br />\|where if ("{{UsersRemoved}}" = "\*", true, UsersRemoved matches "{{UsersRemoved}}") AND if ("{{Admin}}" = "\*", true, Admin matches "{{Admin}}") AND if ("{{RoleName}}" = "\*", true, RoleName matches "{{RoleName}}") AND if ("{{UsersAdded}}" = "\*", true, UsersAdded matches "{{UsersAdded}}") AND if ("{{AdminIp}}" = "\*", true, AdminIp matches "{{AdminIp}}")<br />\|count by EventName, EventTime, Admin, AdminId, AdminIp, RoleId, RoleName, UsersAdded, UsersRemoved<br />\| sort by EventTime<br />\| fields - \_count, EventTime, EventName, AdminId, RoleId|
|Enterprise Audit - User & Role Management|System Defined Vs User Defined|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities|\_index=sumologic\_audit\_events \_sourceCategory=roles RoleCreated<br />\| json "eventName", "role.systemDefined","operator.email", "operator.sourceIp"  as EventName, SystemDefined, Admin, AdminIp nodrop<br />\| where EventNAme="RoleCreated" <br />\| where EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\| count as Count by SystemDefined<br />\| if(SystemDefined="true", "System Defined", "User Defined") as SystemDefined<br />|
|Enterprise Audit - User & Role Management|Timed Out Users Count|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLoginTimedOut<br />\| json "eventName", "userSession.sourceIp"  as EventName, UserIp nodrop<br />\| where EventName="UserLoginTimedOut"<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\| count as Count by EventName<br />\| fillmissing values("UserLoginTimedOut") in EventName<br /><br />|
|Enterprise Audit - User & Role Management|Timed Out Users Count|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserLoginTimedOut<br />\| json "eventName" as EventName nodrop<br />\| where EventName="UserLoginTimedOut"<br />\| count as Count by EventName<br />\| fillmissing values("UserLoginTimedOut") in EventName|
|Enterprise Audit - User & Role Management|Top Capabilities Added To Roles|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities|\_index=sumologic\_audit\_events \_sourceCategory=roles RoleUpdated<br />\| json "eventName", "to.capabilities", "operator.email", "operator.sourceIp"  as EventName, capabilities\_updated, Admin, AdminIp nodrop<br />\| where EventName="RoleUpdated"<br />\| where EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\| parse regex field=capabilities\_updated "\\"(?\<Capability\>.\*?)\\"" multi nodrop<br />\| count as Count by Capability<br />\| sort by Count<br />\| limit 10<br />|
|Enterprise Audit - User & Role Management|Top Roles Added To Users|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users RolesAssignedToUserUpdated<br />\| json "eventName", "eventTime", "rolesAdded[\*]" as EventName, EventTime, RolesAdded nodrop<br />\| where EventName="RolesAssignedToUserUpdated"<br />\| parse regex field=RolesAdded "\\"roleName\\":\\"(?\<RoleName\>.\*?)\\"" multi<br />\|where if ("{{RoleName}}" = "\*", true, RoleName matches "{{RoleName}}") AND if ("{{RolesAdded}}" = "\*", true, RolesAdded matches "{{RolesAdded}}")<br />\|count as Count by RoleName<br />\| sort by Count<br />\| limit 10|
|Enterprise Audit - User & Role Management|Top Roles Added To Users|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities |\_index=sumologic\_audit\_events \_sourceCategory=users RolesAssignedToUserUpdated<br />\| json "eventName", "eventTime", "rolesAdded[\*]","operator.sourceIp" as EventName, EventTime, RolesAdded, AdminIp nodrop<br />\| where EventName="RolesAssignedToUserUpdated"<br />\| where AdminIp matches "{{AdminIp}}"<br />\| parse regex field=RolesAdded "\\"roleName\\":\\"(?\<RoleName\>.\*?)\\"" multi<br />\|count as Count by RoleName<br />\| sort by Count<br />\| limit 10<br />|
|Enterprise Audit - User & Role Management|Top Roles Removed From Users|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities |\_index=sumologic\_audit\_events \_sourceCategory=users RolesAssignedToUserUpdated<br />\| json "eventName", "eventTime", "rolesDeleted[\*]", "operator.sourceIp" as EventName, EventTime, RolesRemoved, AdminIp nodrop<br />\| where EventName="RolesAssignedToUserUpdated"<br />\| parse regex field=RolesRemoved "\\"roleName\\":\\"(?\<RoleName\>.\*?)\\"" multi<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count as Count by RoleName<br />\| sort by Count<br />\| limit 10|
|Enterprise Audit - User & Role Management|Top Roles Removed From Users|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users RolesAssignedToUserUpdated<br />\| json "eventName", "eventTime", "rolesDeleted[\*]" as EventName, EventTime, RolesRemoved nodrop<br />\| where EventName="RolesAssignedToUserUpdated"<br />\| parse regex field=RolesRemoved "\\"roleName\\":\\"(?\<RoleName\>.\*?)\\"" multi<br />\|where if ("{{RoleName}}" = "\*", true, RoleName matches "{{RoleName}}") AND if ("{{RolesRemoved}}" = "\*", true, RolesRemoved matches "{{RolesRemoved}}")<br />\|count as Count by RoleName<br />\| sort by Count<br />\| limit 10|
|Enterprise Audit - User & Role Management|Top Users|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events<br />\| where \_sourceCategory in ("users", "roles", "userSessions")<br />\| json "eventName", "operator.email" as EventName, User nodrop<br />\| json "userSession.email" as LoginUser nodrop<br />\| json "sessionIdentity.userEmail" as LogoutUser nodrop<br />\| json "userIdentity.userEmail" as LockedUser nodrop<br />\| if(isEmpty(LoginUser), if(isEmpty(LogoutUser), if(isEmpty(LockedUser), "", LockedUser),LogoutUser), LoginUser) as UserEmail<br />\| if(isEmpty(UserEmail), User, UserEmail) as User<br />\| count as Count by User<br />\| sort by Count<br />\| limit 10|
|Enterprise Audit - User & Role Management|Top Users Added To Roles|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities |\_index=sumologic\_audit\_events \_sourceCategory=roles UsersAssignedToRoleUpdated<br />\| json "eventName", "eventTime", "usersAdded[\*]", "operator.sourceIp" as EventName, EventTime, UsersAdded, AdminIp nodrop<br />\| where EventName="UsersAssignedToRoleUpdated"<br />\| parse regex field=UsersAdded "\\"userEmail\\":\\"(?\<TargetUserEmail\>.\*?)\\"" multi<br />\| where AdminIp matches "{{AdminIp}}"\|count as Count by TargetUserEmail<br />\| sort by Count<br />\| limit 10<br />|
|Enterprise Audit - User & Role Management|Top Users Added To Roles|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=roles UsersAssignedToRoleUpdated<br />\| json "eventName", "eventTime", "usersAdded[\*]" as EventName, EventTime, UsersAdded nodrop<br />\| where EventName="UsersAssignedToRoleUpdated"<br />\| parse regex field=UsersAdded "\\"userEmail\\":\\"(?\<TargetUserEmail\>.\*?)\\"" multi<br />\|where if ("{{UsersAdded}}" = "\*", true, UsersAdded matches "{{UsersAdded}}") AND if ("{{TargetUserEmail}}" = "\*", true, TargetUserEmail matches "{{TargetUserEmail}}")<br />\|count as Count by TargetUserEmail<br />\| sort by Count<br />\| limit 10|
|Enterprise Audit - User & Role Management|Top Users By Activities|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User & Role Management Overview|\_index=sumologic\_audit\_events<br />\| where \_sourceCategory in ("users", "roles", "userSessions")<br />\| json "eventName", "operator.email" as EventName, User nodrop<br />\| json "userSession.email" as LoginUser nodrop<br />\| json "sessionIdentity.userEmail" as LogoutUser nodrop<br />\| json "userIdentity.userEmail" as LockedUser nodrop<br />\| if(isEmpty(LoginUser), if(isEmpty(LogoutUser), if(isEmpty(LockedUser), "", LockedUser),LogoutUser), LoginUser) as UserEmail<br />\| if(isEmpty(UserEmail), User, UserEmail) as User<br />\| count as Count by User, \_sourceCategory<br />\| transpose row User column \_sourceCategory as %"userSessions", %"users", %"roles"<br />\| sort by userSessions, users, roles<br />\| limit 5|
|Enterprise Audit - User & Role Management|Top Users Removed From Roles|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities |\_index=sumologic\_audit\_events \_sourceCategory=roles UsersAssignedToRoleUpdated<br />\| json "eventName", "eventTime", "usersDeleted[\*]","operator.sourceIp" as EventName, EventTime, UsersRemoved, AdminIp nodrop<br />\| where EventName="UsersAssignedToRoleUpdated"<br />\| parse regex field=UsersRemoved "\\"userEmail\\":\\"(?\<TargetUserEmail\>.\*?)\\"" multi<br />\| where AdminIp matches "{{AdminIp}}"\|count as Count by TargetUserEmail<br />\| sort by Count<br />\| limit 10|
|Enterprise Audit - User & Role Management|Top Users Removed From Roles|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Role Relationship Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=roles UsersAssignedToRoleUpdated<br />\| json "eventName", "eventTime", "usersDeleted[\*]" as EventName, EventTime, UsersRemoved nodrop<br />\| where EventName="UsersAssignedToRoleUpdated"<br />\| parse regex field=UsersRemoved "\\"userEmail\\":\\"(?\<TargetUserEmail\>.\*?)\\"" multi<br />\|where if ("{{UsersRemoved}}" = "\*", true, UsersRemoved matches "{{UsersRemoved}}") AND if ("{{TargetUserEmail}}" = "\*", true, TargetUserEmail matches "{{TargetUserEmail}}")<br />\|count as Count by TargetUserEmail<br />\| sort by Count<br />\| limit 10|
|Enterprise Audit - User & Role Management|Trend - Role Events|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - Role Activities|\_index=sumologic\_audit\_events \_sourceCategory=roles (RoleCreated OR RoleUpdated OR RoleDeleted)<br />\| json "eventName", "to.capabilities", "operator.email", "operator.sourceIp"  as EventName, capabilities\_updated, Admin, AdminIp nodrop<br />\| where EventName in ("RoleCreated","RoleUpdated","RoleDeleted") <br />\| where EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\| timeslice 1d<br />\|count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d), values("RoleCreated","RoleUpdated","RoleDeleted") in EventName<br />\| transpose row \_timeslice column EventName<br />|
|Enterprise Audit - User & Role Management|Trend - User Email Activity|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users (UserEmailChangeRequested OR UserEmailChanged)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserEmailChangeRequested", "UserEmailChanged") AND EventName matches "{{EventName}}"<br />\|timeslice 1d<br />\| count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d), values("UserEmailChangeRequested", "UserEmailChanged") in EventName<br />\| transpose row \_timeslice column EventName|
|Enterprise Audit - User & Role Management|Trend - User Email Activity|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserEmailChangeRequested OR UserEmailChanged)<br />\| json "eventName", "operator.email", "operator.sourceIp"  as EventName, Admin, AdminIp nodrop<br />\| where EventName in ("UserEmailChangeRequested", "UserEmailChanged") <br />\| where EventName matches "{{EventName}}" and if("{{Admin}}"="\*", true, Admin matches "{{Admin}}") and if("{{AdminIp}}"="\*", true, AdminIp matches "{{AdminIp}}")<br />\|timeslice 1d<br />\| count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d), values("UserEmailChangeRequested", "UserEmailChanged") in EventName<br />\| transpose row \_timeslice column EventName<br />|
|Enterprise Audit - User & Role Management|Trend - User Events|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserCreated OR UserUpdated OR UserDeleted)<br />\| json "eventName", "operator.email", "operator.sourceIp" as EventName, Admin, AdminIp nodrop<br />\| where EventName in ("UserCreated","UserUpdated", "UserDeleted") <br />\| where  EventName matches "{{EventName}}" and Admin matches "{{Admin}}" and AdminIp matches "{{AdminIp}}"<br />\| timeslice 1d<br />\| count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d), values("UserCreated","UserUpdated","UserDeleted") in EventName<br />\| transpose row \_timeslice column EventName<br /><br />|
|Enterprise Audit - User & Role Management|Trend - User Password Activity|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities|\_index=sumologic\_audit\_events \_sourceCategory=users (UserPasswordReset OR UserPasswordChanged)<br />\| json "eventName", "operator.email", "operator.sourceIp"  as EventName, Admin, AdminIp nodrop<br />\| where EventName in ("UserPasswordReset", "UserPasswordChanged") <br />\| where EventName matches "{{EventName}}" and if("{{Admin}}"="\*", true, Admin matches "{{Admin}}") and if("{{AdminIp}}"="\*", true, AdminIp matches "{{AdminIp}}")<br />\| timeslice 1d<br />\| count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d), values("UserPasswordReset", "UserPasswordChanged") in EventName<br />\| transpose row \_timeslice column EventName<br />|
|Enterprise Audit - User & Role Management|Trend - User Password Activity|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User(Email, Password) Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=users (UserPasswordReset OR UserPasswordChanged)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserPasswordReset", "UserPasswordChanged") AND EventName matches "{{EventName}}" <br />\| timeslice 1d<br />\| count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d), values("UserPasswordReset", "UserPasswordChanged") in EventName<br />\| transpose row \_timeslice column EventName|
|Enterprise Audit - User & Role Management|Trend - UserLocked Vs Unlocked|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLockedOut OR UserUnlocked)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("UserLockedOut","UserUnlocked")<br />\| timeslice 1d<br />\| count as Count by \_timeSlice, EventName<br />\| fillmissing timeslice(1d), values("UserLockedOut", "UserUnlocked") in EventName<br />\| sort by \_timeSlice<br />\| transpose row \_timeSlice column EventName|
|Enterprise Audit - User & Role Management|Trend - UserLocked Vs Unlocked|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions (UserLockedOut OR UserUnlocked)<br />\| json "eventName", "eventTime", "accountId", "userIdentity", "userSession.sourceIp" as EventName, EventTime, AccountId, userIdentity, UserIp nodrop<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\| where EventName in ("UserLockedOut","UserUnlocked")<br />\| timeslice 1d<br />\| count as Count by \_timeSlice, EventName<br />\| fillmissing timeslice(1d), values("UserLockedOut", "UserUnlocked") in EventName<br />\| sort by \_timeSlice<br />\| transpose row \_timeSlice column EventName<br />|
|Enterprise Audit - User & Role Management|Users Unlocked Activity|Logs|Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities - New|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserUnlocked<br />\| json "eventName", "eventTime", "accountId", "userIdentity", "operator" as EventName, EventTime, AccountId, userIdentity, operator nodrop<br />\| where EventName="UserUnlocked"<br />\| json field=userIdentity "userEmail", "userId" as User, UserId nodrop<br />\| json field=operator "email", "sourceIp", "interface" as UnlockedBy, UnlockedByIp , Interface nodrop<br />\|where if ("{{User}}" = "\*", true, User matches "{{User}}") AND if ("{{UnlockedBy}}" = "\*", true, UnlockedBy matches "{{UnlockedBy}}")<br />\|count by EventName, EventTime, AccountId, User, UserId, UnlockedBy, UnlockedByIp, Interface<br />\| sort by EventTime<br />\| fields - \_count, EventName, AccountId, UserId|
|Enterprise Audit - User & Role Management|Users Unlocked Activity|Logs|Installed Apps/Enterprise Audit - User & Role Management/Enterprise Audit - User Session Activities|\_index=sumologic\_audit\_events \_sourceCategory=userSessions UserUnlocked<br />\| json "eventName", "eventTime", "accountId", "userIdentity", "operator", "userSession.sourceIp" as EventName, EventTime, AccountId, userIdentity, operator, UserIp nodrop<br />\| where EventName="UserUnlocked"<br />\| json field=userIdentity "userEmail", "userId" as User, UserId nodrop<br />\| json field=operator "email", "sourceIp", "interface" as UnlockedBy, UnlockedByIp , Interface nodrop<br />\| where EventName matches "{{EventName}}" and UserIp matches "{{UserIp}}" <br />\|count by EventName, EventTime, AccountId, User, UserId, UnlockedBy, UnlockedByIp, Interface<br />\| sort by EventTime<br />\| fields - \_count, EventName, AccountId, UserId<br />|

