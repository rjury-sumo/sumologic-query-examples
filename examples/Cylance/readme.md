# Cylance
## Sumo Logic App For: Cylance
The Cylance App enables you to analyze Cylance security events by type, status, and detection method. You can use the App to investigate Cylance-specific events and provide operational visibility to team members without logging into Cylance.
Docs Link: [Cylance](https://help.sumologic.com/?cid=6010)

## Searches

### Log Searches

- **Action Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **App Control**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **AuditLog**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Cylance - Systems with Old Interpreter version**: from Search: Cylance/Searches/Cylance - Systems with Old Interpreter version 
- **Cylance - Systems with Old Interpreter version**: from Search: Installed Apps/Cylance/Searches/Cylance - Systems with Old Interpreter version 
- **Detected By Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Device**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Device Control**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Device Control Event Details**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Distinct Hosts**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Distinct Hosts by Zone**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Distinct Hosts By Zone**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Dual Use Subclass Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Event Name**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Event Name**: from Dashboard: Installed Apps/Cylance/Cylance - AuditLog 
- **Event Name Trend**: from Dashboard: Installed Apps/Cylance/Cylance - AuditLog 
- **Event Names**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Event Names**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Event Trend - Time Compare**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Event Trend by Actions**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Event Type Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Event Types**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Events**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Events**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Events**: from Dashboard: Installed Apps/Cylance/Cylance - AuditLog 
- **Events**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Events**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Events**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Events Break Down**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Events by Action**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Events by Interpreter - Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Events by Name - Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Events Time Compare Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Events Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Exploit Attempt**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **External Device Types**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **External Device Types by Zone**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **External Device Vendor and Product IDs**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Malware Subclass Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Old Agents**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Old Interpreter**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **PUP Subclass Trend**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Recent Events**: from Dashboard: Installed Apps/Cylance/Cylance - AuditLog 
- **Recent Exploit Attempt Details**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Recent Malware, Dual Use  and PUP Files**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Recent Safe Files**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Script Control**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Threat**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Threat Class**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Threat Classification**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Threat Related Event Outlier**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Threat Severity**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Threat Severity Across Zones**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Threats Blocked**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Threats Severity by Zone**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Actions**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Top Agent Versions**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Top Blocked, Terminated Processes**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Top Detected By**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Device Names**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Top Event Names**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Top Event Names**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Exploit Control Violation Type**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Top External Device Names**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Top File Names**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top File Types**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Files**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Top Host - High Avg Score Threats**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Hosts**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Top Hosts**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Top Hosts**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Top Hosts**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Top Hosts - Multiple Critical Threats**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Interpreters**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Top Interpreters**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Top Interpreters**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Top IP Address**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top OS**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Top Paths**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Policies**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Top Policies**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Top Policies**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Top Scores**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top SHA**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top SHA Occurring Multiple Times**: from Dashboard: Installed Apps/Cylance/Cylance - Threat Classification 
- **Top Source IPs**: from Dashboard: Installed Apps/Cylance/Cylance - AuditLog 
- **Top Status**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Threat Classification**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Threat Classifications**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Top Threat FileTypes**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Top Users**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Top Users**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Top Users**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Top Users**: from Dashboard: Installed Apps/Cylance/Cylance - AuditLog 
- **Top Violations**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Top Zones**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Top Zones**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Top Zones**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Top Zones**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Top Zones**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Top Zones**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Total Events**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Unique Agent Versions**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Unique Device Names**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Unique Device Names**: from Dashboard: Installed Apps/Cylance/Cylance - Script Control 
- **Unique Device Names**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Unique Devices**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Unique Event Names**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Unique External Device Product IDs**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Unique External Device Vendor IDs**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Unique External Devices**: from Dashboard: Installed Apps/Cylance/Cylance - Device Control 
- **Unique IP Addresses**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Unique IP Addresses**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Unique Mac Addresses**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Unique Policies**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **Unique Threats**: from Dashboard: Installed Apps/Cylance/Cylance - Threat 
- **Unique Users**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Unique Users**: from Dashboard: Installed Apps/Cylance/Cylance - Device 
- **Unique Violation Types**: from Dashboard: Installed Apps/Cylance/Cylance - Memory Exploit Attempts 
- **Unique Zones**: from Dashboard: Installed Apps/Cylance/Cylance - Overview 
- **User Activity Location**: from Dashboard: Installed Apps/Cylance/Cylance - AuditLog

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Cylance|Action Trend|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\| timeslice 5m<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by \_timeslice, event\_name<br />\| transpose row \_timeslice column event\_name|
|Cylance|App Control|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" AppControl<br />\| parse "Event Type: \*," as event\_type nodrop<br />\| parse "Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Action Type: \*, File Path: \*, SHA256: \*" as event\_name, device\_name, ip\_address, action, action\_type, filepath, sha nodrop<br />\| where event\_type = "AppControl"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count|
|Cylance|AuditLog|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" AuditLog<br />\| parse "Event Type: \*," as event\_type<br />\| where event\_type = "AuditLog"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count|
|Cylance/Searches|Cylance - Systems with Old Interpreter version|Logs|Cylance/Searches/Cylance - Systems with Old Interpreter version|\_sourceCategory = Labs/Cylance ScriptControl Interpreter Version<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| if (interpreter="powershell", "Powershell", interpreter) as interpreter<br />\| where event\_type="ScriptControl"<br />\| parse regex field=interpreterVersion "(?\<MajorVersion\>\\d+\\.\\d+)\\."<br />\| num(MajorVersion) as MajorVersion<br />\| where (interpreter = "ActiveScript" and MajorVersion \< {{ActiveScriptMajorVersion}}) or (interpreter = "MacroScript" and MajorVersion \< {{MacroScriptMajorVersion}}) or (interpreter = "Powershell" and MajorVersion \< {{PowershellMajorVersion}})<br />\| count by zone, device\_name, device\_id, user, interpreter, interpreterVersion|
|Cylance/Searches|Cylance - Systems with Old Interpreter version|Logs|Installed Apps/Cylance/Searches/Cylance - Systems with Old Interpreter version|\_sourceCategory={{\_sourceCategory}} ScriptControl Interpreter Version<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| if (interpreter="powershell", "Powershell", interpreter) as interpreter<br />\| where event\_type="ScriptControl"<br />\| parse regex field=interpreterVersion "(?\<MajorVersion\>\\d+\\.\\d+)\\."<br />\| num(MajorVersion) as MajorVersion<br />\| where (interpreter = "ActiveScript" and MajorVersion \< {{ActiveScriptMajorVersion}}) or (interpreter = "MacroScript" and MajorVersion \< {{MacroScriptMajorVersion}}) or (interpreter = "Powershell" and MajorVersion \< {{PowershellMajorVersion}})<br />\| count by zone, device\_name, device\_id, user, interpreter, interpreterVersion|
|Cylance|Detected By Trend|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\| timeslice 1m<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by \_timeslice, detected\_by<br />\| transpose row \_timeslice column detected\_by|
|Cylance|Device|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" Device<br />\| parse "Event Type: \*," as event\_type<br />\| where event\_type = "Device"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count|
|Cylance|Device Control|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" DeviceControl<br />\| parse "Event Type: \*," as event\_type<br />\| where event\_type = "DeviceControl"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count|
|Cylance|Device Control Event Details|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by zone, device\_name, event\_name, external\_device\_type, external\_device\_name, external\_device\_vendor\_id, external\_device\_product\_id, external\_device\_serialno<br />\| sort by \_count|
|Cylance|Distinct Hosts|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(device\_name) as totaldevices|
|Cylance|Distinct Hosts by Zone|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where event\_type="ScriptControl" and !isEmpty(zone)<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(device\_name) by zone<br />\| sort by \_count\_distinct, zone asc|
|Cylance|Distinct Hosts By Zone|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where event\_type="DeviceControl" and !isEmpty(zone)<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\| count\_distinct(device\_name) by zone<br />\| sort by \_count\_distinct, zone asc|
|Cylance|Dual Use Subclass Trend|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification "Dual Use"<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification" and threat\_class="Dual Use"<br />\| timeslice 1d<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\|count by \_timeslice, threat\_subclass<br />\| transpose row \_timeslice column threat\_subclass|
|Cylance|Event Name|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as <br />event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by event\_name<br />\| sort by \_count, event\_name asc|
|Cylance|Event Name|Logs|Installed Apps/Cylance/Cylance - AuditLog|\_sourceCategory={{\_sourceCategory}} "Event Type:" AuditLog<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Message: \*," as msg nodrop \| parse "Source IP: \*," as src\_ip nodrop \| parse "User: \*" as user nodrop<br />\| parse field=msg "Device: \* was auto assigned to Zone: \*" as device\_name, zone nodrop<br />\| parse field=msg "Provider: \*" as provider nodrop<br />\| parse regex field=msg "Device:\\s\*(?\<device\_name\>[^\\s]\*)\\s\*\$" nodrop<br />\| parse field=msg "Tier: \*; Zones: \*; Agent Version: \*" as tier, zone, agent\_version nodrop<br />\| parse field=msg "Policy Assigned: \*; Devices: \*" as policy, device\_name nodrop<br />\| parse field=msg "Device: \*; " as device\_name nodrop<br />\| parse field=msg "Devices: \*" as device\_name nodrop<br />\| parse field=msg "SHA256: \*" as sha nodrop<br />\| parse field=msg "Zone: \*; Policy Assigned: \*; Policy Applied To All Devices In Zone: \*" as zone, policy, PolicyAppliedToAllDevicesInZone<br />\| where event\_type = "AuditLog"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{provider}}" = "\*", true, provider matches "{{provider}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{tier}}" = "\*", true, tier matches "{{tier}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by event\_name \| sort by \_count, event\_name|
|Cylance|Event Name Trend|Logs|Installed Apps/Cylance/Cylance - AuditLog|\_sourceCategory={{\_sourceCategory}} "Event Type:" AuditLog<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Message: \*," as msg nodrop \| parse "Source IP: \*," as src\_ip nodrop \| parse "User: \*" as user nodrop<br />\| parse field=msg "Device: \* was auto assigned to Zone: \*" as device\_name, zone nodrop<br />\| parse field=msg "Provider: \*" as provider nodrop<br />\| parse regex field=msg "Device:\\s\*(?\<device\_name\>[^\\s]\*)\\s\*\$" nodrop<br />\| parse field=msg "Tier: \*; Zones: \*; Agent Version: \*" as tier, zone, agent\_version nodrop<br />\| parse field=msg "Policy Assigned: \*; Devices: \*" as policy, device\_name nodrop<br />\| parse field=msg "Device: \*; " as device\_name nodrop<br />\| parse field=msg "Devices: \*" as device\_name nodrop<br />\| parse field=msg "SHA256: \*" as sha nodrop<br />\| parse field=msg "Zone: \*; Policy Assigned: \*; Policy Applied To All Devices In Zone: \*" as zone, policy, PolicyAppliedToAllDevicesInZone<br />\| where event\_type = "AuditLog"<br />\| timeslice 1d<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{provider}}" = "\*", true, provider matches "{{provider}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{tier}}" = "\*", true, tier matches "{{tier}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by \_timeslice, event\_name <br />\| transpose row \_timeslice column event\_name|
|Cylance|Event Names|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by event\_name \| sort by \_count, event\_name asc|
|Cylance|Event Names|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\| count by event\_name \| sort by \_count, event\_name asc|
|Cylance|Event Trend - Time Compare|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\| timeslice 5m<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\| count by \_timeslice, event\_name<br />\| compare with timeshift 1d 6|
|Cylance|Event Trend by Actions|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type = "ExploitAttempt"<br />\| timeslice 5m<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by \_timeslice, action<br />\| fillmissing timeslice(15m),<br />  values("Blocked", "None", "Terminated") in action<br />\| transpose row \_timeslice column action|
|Cylance|Event Type Trend|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} "Event Type:"<br />\| parse "Event Type: \*," as event\_type<br />\| timeslice 1h<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count by \_timeslice, event\_type<br />\| transpose row \_timeslice column event\_type|
|Cylance|Event Types|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} "Event Type:"<br />\| parse "Event Type: \*," as event\_type<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count by event\_type<br />\| sort by \_count, event\_type asc|
|Cylance|Events|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\| where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\| count|
|Cylance|Events|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count|
|Cylance|Events|Logs|Installed Apps/Cylance/Cylance - AuditLog|\_sourceCategory={{\_sourceCategory}} "Event Type:" AuditLog<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Message: \*," as msg nodrop \| parse "Source IP: \*," as src\_ip nodrop \| parse "User: \*" as user nodrop<br />\| parse field=msg "Device: \* was auto assigned to Zone: \*" as device\_name, zone nodrop<br />\| parse field=msg "Provider: \*" as provider nodrop<br />\| parse regex field=msg "Device:\\s\*(?\<device\_name\>[^\\s]\*)\\s\*\$" nodrop<br />\| parse field=msg "Tier: \*; Zones: \*; Agent Version: \*" as tier, zone, agent\_version nodrop<br />\| parse field=msg "Policy Assigned: \*; Devices: \*" as policy, device\_name nodrop<br />\| parse field=msg "Device: \*; " as device\_name nodrop<br />\| parse field=msg "Devices: \*" as device\_name nodrop<br />\| parse field=msg "SHA256: \*" as sha nodrop<br />\| parse field=msg "Zone: \*; Policy Assigned: \*; Policy Applied To All Devices In Zone: \*" as zone, policy, PolicyAppliedToAllDevicesInZone<br />\| where event\_type = "AuditLog"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{provider}}" = "\*", true, provider matches "{{provider}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{tier}}" = "\*", true, tier matches "{{tier}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count|
|Cylance|Events|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count|
|Cylance|Events|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification "Event Type: ThreatClassification"<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\|count|
|Cylance|Events|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count|
|Cylance|Events Break Down|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\|count by event\_name, threat\_class, threat\_subclass<br />\| sort by event\_name, threat\_class asc, \_count, threat\_subclass asc|
|Cylance|Events by Action|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\| where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\| count event\_name \| sort by \_count, event\_name asc|
|Cylance|Events by Interpreter - Trend|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| if (interpreter="powershell", "Powershell", interpreter) as interpreter<br />\| where event\_type="ScriptControl"<br />\| timeslice 5m<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\| count by \_timeslice, interpreter<br />\| transpose row \_timeslice column interpreter|
|Cylance|Events by Name - Trend|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| where event\_type="ScriptControl"<br />\| timeslice 5m<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by \_timeslice, event\_name <br />\| transpose row \_timeslice column event\_name|
|Cylance|Events Time Compare Trend|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} "Event Type:"<br />\| parse "Event Type: \*," as event\_type<br />\| timeslice 1h<br />\| where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\| count by \_timeslice <br />\| compare with timeshift 1d 6|
|Cylance|Events Trend|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\| timeslice 5m<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by \_timeslice, event\_name<br />\| transpose row \_timeslice column event\_name|
|Cylance|Exploit Attempt|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" ExploitAttempt<br />\| parse "Event Type: \*," as event\_type<br />\| where event\_type = "ExploitAttempt"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count|
|Cylance|External Device Types|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\| count external\_device\_type \| sort by \_count, external\_device\_type asc|
|Cylance|External Device Types by Zone|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by zone, external\_device\_type<br />\| transpose row zone column external\_device\_type|
|Cylance|External Device Vendor and Product IDs|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by external\_device\_vendor\_id, external\_device\_product\_id<br />\| sort by external\_device\_vendor\_id asc, \_count, external\_device\_product\_id asc|
|Cylance|Malware Subclass Trend|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification Malware<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification" and threat\_class="Malware"<br />\| timeslice 1d<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\|count by \_timeslice, threat\_subclass<br />\| transpose row \_timeslice column threat\_subclass|
|Cylance|Old Agents|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device" "Agent Version"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\| parse regex field=agent\_version "(?\<MajorVersion\>\\d+\\.\\d+)\\."<br />\| where !isEmpty(MajorVersion)<br />\| num(MajorVersion) as MajorVersion<br />\| where MajorVersion \< {{AgentMajorVersion}}<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(mac\_address) as unique\_mac\_addresses|
|Cylance|Old Interpreter|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl Interpreter Version<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| if (interpreter="powershell", "Powershell", interpreter) as interpreter<br />\| where event\_type="ScriptControl"<br />\| parse regex field=interpreterVersion "(?\<MajorVersion\>\\d+\\.\\d+)\\."<br />\| num(MajorVersion) as MajorVersion<br />\| where (interpreter = "ActiveScript" and MajorVersion \< {{ActiveScriptMajorVersion}}) or (interpreter = "MacroScript" and MajorVersion \< {{MacroScriptMajorVersion}}) or (interpreter = "Powershell" and MajorVersion \< {{PowershellMajorVersion}})<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(device\_name)|
|Cylance|PUP Subclass Trend|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification PUP<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification" and threat\_class="PUP"<br />\| timeslice 1d<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\|count by \_timeslice, threat\_subclass<br />\| transpose row \_timeslice column threat\_subclass|
|Cylance|Recent Events|Logs|Installed Apps/Cylance/Cylance - AuditLog|\_sourceCategory={{\_sourceCategory}} "Event Type:" AuditLog<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Message: \*," as msg nodrop \| parse "Source IP: \*," as src\_ip nodrop \| parse "User: \*" as user nodrop<br />\| parse field=msg "Device: \* was auto assigned to Zone: \*" as device\_name, zone nodrop<br />\| parse field=msg "Provider: \*" as provider nodrop<br />\| parse regex field=msg "Device:\\s\*(?\<device\_name\>[^\\s]\*)\\s\*\$" nodrop<br />\| parse field=msg "Tier: \*; Zones: \*; Agent Version: \*" as tier, zone, agent\_version nodrop<br />\| parse field=msg "Policy Assigned: \*; Devices: \*" as policy, device\_name nodrop<br />\| parse field=msg "Device: \*; " as device\_name nodrop<br />\| parse field=msg "Devices: \*" as device\_name nodrop<br />\| parse field=msg "SHA256: \*" as sha nodrop<br />\| parse field=msg "Zone: \*; Policy Assigned: \*; Policy Applied To All Devices In Zone: \*" as zone, policy, PolicyAppliedToAllDevicesInZone<br />\| where event\_type = "AuditLog"<br />\| timeslice 1s<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{provider}}" = "\*", true, provider matches "{{provider}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{tier}}" = "\*", true, tier matches "{{tier}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by \_timeslice, event\_name, msg, src\_ip, user, device\_name, zone, policy<br />\| sort by \_timeslice \| limit 30|
|Cylance|Recent Exploit Attempt Details|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt (Blocked or Terminated)<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt" and action in ("Blocked", "Terminated")<br />\| timeslice 5m<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by \_timeslice, action, pname, violation, user, zone, device\_name, device\_id<br />\| topk(20, \_timeslice, \_count) by action|
|Cylance|Recent Malware, Dual Use  and PUP Files|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification ("Malware" or "Dual Use" or "PUP")<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification" and threat\_class in ("Malware", "Dual Use", "PUP")<br />\| timeslice 1s<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\|count by \_timeslice, threat\_class, threat\_subclass, sha, md5<br />\| sort by \_timeslice<br />\| topk(10,\_timeslice) by threat\_class|
|Cylance|Recent Safe Files|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification Trusted Local<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification" and threat\_class="Trusted" and threat\_subclass="Local"<br />\| timeslice 1s<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\|count by \_timeslice, threat\_class, threat\_subclass, sha, md5<br />\| sort by \_timeslice<br />\| topk(10,\_timeslice) by threat\_class|
|Cylance|Script Control|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" ScriptControl<br />\| parse "Event Type: \*," as event\_type<br />\| where event\_type = "ScriptControl"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count|
|Cylance|Threat|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" Threat<br />\| parse "Event Type: \*," as event\_type<br />\| where event\_type = "Threat"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count|
|Cylance|Threat Class|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\| count by threat\_class<br />\| sort by \_count, threat\_class asc|
|Cylance|Threat Classification|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" ThreatClassification<br />\| parse "Event Type: \*," as event\_type<br />\| where event\_type = "ThreatClassification"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count|
|Cylance|Threat Related Event Outlier|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" (Threat or ScriptControl or ExploitAttempt or ThreatClassification or DeviceControl or AppControl)<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| where event\_type in ("Threat", "ScriptControl", "ExploitAttempt", "ThreatClassification", "DeviceControl", "AppControl")<br />\| timeslice 5m<br />\| where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\| count as eventCount by \_timeslice<br />\| outlier eventCount|
|Cylance|Threat Severity|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat" and Severity not in ("Low", "Informational")<br />\| where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\| count\_distinct(file\_name) as CylanceThreatCount by Severity|
|Cylance|Threat Severity Across Zones|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat" and Severity not in ("Low", "Informational")<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count\_distinct(file\_name) as UniqueThreats by zone, Severity<br />\| transpose row Severity column zone|
|Cylance|Threats Blocked|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat" True Quarantined<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat" and score ="100" and Malware\_status="True" and status="Quarantined"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count\_distinct(device\_name) by device\_name, drive\_type, path, file\_name, threatClassification, policy, detected\_by, zone|
|Cylance|Threats Severity by Zone|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat" and Severity not in ("Low", "Informational")<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count\_distinct(file\_name) as UniqueThreats by zone, Severity<br />\| transpose row zone column Severity|
|Cylance|Top Actions|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt" and !isEmpty(action)<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by action<br />\| top 10 action by \_count, action asc|
|Cylance|Top Agent Versions|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device" "Agent Version"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device" and !isEmpty(agent\_version)<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by agent\_version <br />\| Top 10 agent\_version by \_count, agent\_version asc|
|Cylance|Top Blocked, Terminated Processes|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt (Blocked or Terminated)<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt" and action in ("Blocked", "Terminated")<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by pname, action<br />\| top 20 action, pname by \_count, pname asc|
|Cylance|Top Detected By|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by detected\_by \| sort by \_count, detected\_by asc|
|Cylance|Top Device Names|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Device Name"<br />\| parse "Event Type: \*," as event\_type nodrop<br />\| parse "Device Name: \*," as device\_name nodrop<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count by device\_name<br />\| top 10 device\_name by \_count, device\_name asc|
|Cylance|Top Event Names|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by event\_name <br />\| top 10 event\_name by \_count, event\_name asc|
|Cylance|Top Event Names|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by event\_name \| sort by \_count, event\_name asc|
|Cylance|Top Exploit Control Violation Type|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt" and !isEmpty(violation)<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count by violation<br />\| top 10 violation by \_count, violation asc|
|Cylance|Top External Device Names|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl" and !isEmpty(external\_device\_name)<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by external\_device\_type, external\_device\_name <br />\| topk(10,\_count) by external\_device\_type<br />\| sort by external\_device\_type asc|
|Cylance|Top File Names|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity  <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count\_distinct(device\_name) as UniqueHosts by file\_type, file\_name<br />\| top 10 file\_name by UniqueHosts, file\_name asc|
|Cylance|Top File Types|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by file\_type<br />\| top 10 file\_type by \_count, file\_type asc|
|Cylance|Top Files|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by filepath<br />\| top 20 filepath by \_count, filepath asc|
|Cylance|Top Host - High Avg Score Threats|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count\_distinct(file\_name) as UniqueThreats, sum(score) as totalScore, avg(score) as %"Avg Score" by device\_name <br />\| top 10 device\_name by %"Avg Score", UniqueThreats, device\_name asc|
|Cylance|Top Hosts|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id  <br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\| where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\| count by device\_name, ip\_address, mac\_address, device\_id <br />\| where !(isEmpty(device\_name) and isEmpty(ip\_address) and isEmpty(mac\_address) and isEmpty(device\_id))<br />\| top 10 device\_name, mac\_address, ip\_address, device\_id by \_count, device\_name asc, mac\_address asc, ip\_address asc, device\_id|
|Cylance|Top Hosts|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by device\_name, device\_id<br />\| sort by \_count, device\_name asc, device\_id asc|
|Cylance|Top Hosts|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi<br />\| where event\_type="ExploitAttempt" and !isEmpty(ipaddress)<br />\| ipaddress as ip\_address<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by device\_name, ip\_address, device\_id<br />\| top 10 device\_name, ip\_address, device\_id by \_count, device\_name asc, ip\_address, device\_id|
|Cylance|Top Hosts|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by device\_name, device\_id<br />\| top 20 device\_name, device\_id by \_count, device\_name asc, device\_id asc|
|Cylance|Top Hosts - Multiple Critical Threats|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat" and Severity="Critical"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count\_distinct(file\_name) as UniqueThreats by device\_name <br />\| top 10 device\_name by UniqueThreats, device\_name asc|
|Cylance|Top Interpreters|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| if (interpreter="powershell", "Powershell", interpreter) as interpreter<br />\| where event\_type="ScriptControl"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count by interpreter \| sort by \_count, interpreter asc|
|Cylance|Top Interpreters|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| if (interpreter="powershell", "Powershell", interpreter) as interpreter<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by interpreter, interpreterVersion \| sort by \_count, interpreter asc, interpreterVersion<br />\| limit 20|
|Cylance|Top Interpreters|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| if (interpreter="powershell", "Powershell", interpreter) as interpreter<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by interpreter \| sort by \_count, interpreter asc|
|Cylance|Top IP Address|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| ipaddress as ip\_address<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat" and !isEMpty(ip\_address)<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by ip\_address <br />\| top 10 ip\_address by \_count, ip\_address asc|
|Cylance|Top OS|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device" OS<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device" and !isEmpty(OS)<br />\| where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by OS <br />\| top 10 OS by \_count, OS asc|
|Cylance|Top Paths|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by path<br />\| top 20 path by \_count, path|
|Cylance|Top Policies|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by policy<br />\| top 10 policy by \_count, policy asc|
|Cylance|Top Policies|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by policy<br />\| top 20 policy by \_count, policy asc|
|Cylance|Top Policies|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by policy<br />\| sort by \_count, policy asc|
|Cylance|Top Scores|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\| num(score) as score<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count\_distinct(device\_name) as UniqueHosts by score<br />\| top 25 score by score, UniqueHosts|
|Cylance|Top SHA|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| ipaddress as ip\_address<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by sha<br />\| top 10 sha by \_count, sha asc|
|Cylance|Top SHA Occurring Multiple Times|Logs|Installed Apps/Cylance/Cylance - Threat Classification|\_sourceCategory={{\_sourceCategory}} ThreatClassification<br />\| parse "Event Type: \*, Event Name: \*, Threat Class: \*, Threat Subclass: \*, SHA256: \*, MD5: \*" as event\_type, event\_name, threat\_class, threat\_subclass, sha, md5<br />\| where event\_type = "ThreatClassification"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{threat\_class}}" = "\*", true, threat\_class matches "{{threat\_class}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}") AND if ("{{threat\_subclass}}" = "\*", true, threat\_subclass matches "{{threat\_subclass}}")<br />\|count by sha \| where \_count \> 1 \| sort by \_count, sha asc<br />\| limit 10|
|Cylance|Top Source IPs|Logs|Installed Apps/Cylance/Cylance - AuditLog|\_sourceCategory={{\_sourceCategory}} "Event Type:" AuditLog<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Message: \*," as msg nodrop \| parse "Source IP: \*," as src\_ip nodrop \| parse "User: \*" as user nodrop<br />\| parse field=msg "Device: \* was auto assigned to Zone: \*" as device\_name, zone nodrop<br />\| parse field=msg "Provider: \*" as provider nodrop<br />\| parse regex field=msg "Device:\\s\*(?\<device\_name\>[^\\s]\*)\\s\*\$" nodrop<br />\| parse field=msg "Tier: \*; Zones: \*; Agent Version: \*" as tier, zone, agent\_version nodrop<br />\| parse field=msg "Policy Assigned: \*; Devices: \*" as policy, device\_name nodrop<br />\| parse field=msg "Device: \*; " as device\_name nodrop<br />\| parse field=msg "Devices: \*" as device\_name nodrop<br />\| parse field=msg "SHA256: \*" as sha nodrop<br />\| parse field=msg "Zone: \*; Policy Assigned: \*; Policy Applied To All Devices In Zone: \*" as zone, policy, PolicyAppliedToAllDevicesInZone<br />\| where event\_type = "AuditLog"<br />\| where !isEmpty(src\_ip)<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{provider}}" = "\*", true, provider matches "{{provider}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{tier}}" = "\*", true, tier matches "{{tier}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by src\_ip \| top 20 src\_ip by \_count, src\_ip asc|
|Cylance|Top Status|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by status \| sort by \_count, status asc|
|Cylance|Top Threat Classification|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by ThreatClassification <br />\| top 10 ThreatClassification by \_count, ThreatClassification asc|
|Cylance|Top Threat Classifications|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\| where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\| count by ThreatClassification <br />\| sort by \_count, ThreatClassification asc|
|Cylance|Top Threat FileTypes|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count by file\_type<br />\| top 10 file\_type by \_count, file\_type asc|
|Cylance|Top Users|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device" and !isEmpty(user)<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by user <br />\| top 10 user by \_count, user asc|
|Cylance|Top Users|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by user<br />\| top 10 user by \_count, user asc|
|Cylance|Top Users|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by user<br />\| top 20 user by \_count, user asc|
|Cylance|Top Users|Logs|Installed Apps/Cylance/Cylance - AuditLog|\_sourceCategory={{\_sourceCategory}} "Event Type:" AuditLog<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Message: \*," as msg nodrop \| parse "Source IP: \*," as src\_ip nodrop \| parse "User: \*" as user nodrop<br />\| parse field=msg "Device: \* was auto assigned to Zone: \*" as device\_name, zone nodrop<br />\| parse field=msg "Provider: \*" as provider nodrop<br />\| parse regex field=msg "Device:\\s\*(?\<device\_name\>[^\\s]\*)\\s\*\$" nodrop<br />\| parse field=msg "Tier: \*; Zones: \*; Agent Version: \*" as tier, zone, agent\_version nodrop<br />\| parse field=msg "Policy Assigned: \*; Devices: \*" as policy, device\_name nodrop<br />\| parse field=msg "Device: \*; " as device\_name nodrop<br />\| parse field=msg "Devices: \*" as device\_name nodrop<br />\| parse field=msg "SHA256: \*" as sha nodrop<br />\| parse field=msg "Zone: \*; Policy Assigned: \*; Policy Applied To All Devices In Zone: \*" as zone, policy, PolicyAppliedToAllDevicesInZone<br />\| where event\_type = "AuditLog"<br />\| where !isEmpty(user)<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{provider}}" = "\*", true, provider matches "{{provider}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{tier}}" = "\*", true, tier matches "{{tier}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by user \| top 20 user by \_count, user asc|
|Cylance|Top Violations|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt" and !isEmpty(violation)<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by violation<br />\| top 10 violation by \_count, violation asc|
|Cylance|Top Zones|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Zone Names"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Zone Names: (\*)" as zone nodrop<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where !isEmpty(zone)<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count by zone \| sort by \_count, zone asc \| limit 10|
|Cylance|Top Zones|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| ipaddress as ip\_address<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat" and !isEmpty(zone)<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count by zone<br />\| top 10 zone by \_count, zone asc|
|Cylance|Top Zones|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where event\_type="DeviceControl" and !isEmpty(zone)<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by zone<br />\| sort by \_count, zone asc|
|Cylance|Top Zones|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where event\_type = "Device" and !isEmpty(zone)<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by zone <br />\| top 10 zone by \_count, zone asc|
|Cylance|Top Zones|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where event\_type="ScriptControl" and !isEmpty(zone)<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count by zone<br />\| top 20 zone by \_count, zone asc|
|Cylance|Top Zones|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where event\_type="ExploitAttempt" and !isEmpty(zone)<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count by zone <br />\| top 10 zone by \_count, zone asc|
|Cylance|Total Events|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:"<br />\| parse "Event Type: \*," as event\_type<br />\| where !isEmpty(event\_type)<br />\| where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\| count as %"TotalEvents"|
|Cylance|Unique Agent Versions|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device" "Agent Version"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}")  AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(agent\_version) as UniqueAgentVersions|
|Cylance|Unique Device Names|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count\_distinct(device\_name) as UniqueDevices|
|Cylance|Unique Device Names|Logs|Installed Apps/Cylance/Cylance - Script Control|\_sourceCategory={{\_sourceCategory}} ScriptControl<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, File Path: \*, Interpreter: \*, Interpreter Version: \*, Zone Names: (\*), User Name: \*, Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, filepath, interpreter, interpreterVersion, zone, user, device\_id, policy nodrop<br />\| where event\_type="ScriptControl"<br />\|where if ("{{interpreterVersion}}" = "\*", true, interpreterVersion matches "{{interpreterVersion}}") AND if ("{{interpreter}}" = "\*", true, interpreter matches "{{interpreter}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{filepath}}" = "\*", true, filepath matches "{{filepath}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(device\_name) as totaldevices|
|Cylance|Unique Device Names|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(device\_name) as UniqueDevices|
|Cylance|Unique Devices|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*," as device\_name nodrop<br />\| parse "Device Id: \*," as device\_id nodrop<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count\_distinct(device\_name, device\_id) as uniqueDevices|
|Cylance|Unique Event Names|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(event\_name) as UniqueEventNames|
|Cylance|Unique External Device Product IDs|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(external\_device\_product\_ID) as uniqueExternalDeviceProductId|
|Cylance|Unique External Device Vendor IDs|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(external\_device\_vendor\_ID) as uniqueExternalDeviceVendorId|
|Cylance|Unique External Devices|Logs|Installed Apps/Cylance/Cylance - Device Control|\_sourceCategory={{\_sourceCategory}} "Event Type: DeviceControl"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, External Device Type: \*, External Device Vendor ID: \*, External Device Name: \*, External Device Product ID: \*, External Device Serial Number: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as device\_name, external\_device\_type, external\_device\_vendor\_id, external\_device\_name, external\_device\_product\_id, external\_device\_serialno, zone, device\_id, policy nodrop<br />\| where event\_type="DeviceControl"<br />\|where if ("{{external\_device\_serialno}}" = "\*", true, external\_device\_serialno matches "{{external\_device\_serialno}}") AND if ("{{external\_device\_vendor\_id}}" = "\*", true, external\_device\_vendor\_id matches "{{external\_device\_vendor\_id}}") AND if ("{{external\_device\_product\_id}}" = "\*", true, external\_device\_product\_id matches "{{external\_device\_product\_id}}") AND if ("{{external\_device\_type}}" = "\*", true, external\_device\_type matches "{{external\_device\_type}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{external\_device\_name}}" = "\*", true, external\_device\_name matches "{{external\_device\_name}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(external\_device\_serialno) as totalexternaldevices|
|Cylance|Unique IP Addresses|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi<br />\| where event\_type="ExploitAttempt" and !isEmpty(ipaddress)<br />\| ipaddress as ip\_address<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count\_distinct(ip\_address) as UniqueIPAddresses|
|Cylance|Unique IP Addresses|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(ip\_address) as UniqueIPAddresses|
|Cylance|Unique Mac Addresses|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(mac\_address) as UniqueMacAddresses|
|Cylance|Unique Policies|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Event Type:" "Policy Name"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Policy Name: \*" as policy nodrop<br />\| where !isEmpty(policy)<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count\_distinct(policy) as UniquePolicies|
|Cylance|Unique Threats|Logs|Installed Apps/Cylance/Cylance - Threat|\_sourceCategory={{\_sourceCategory}} Threat "Event Type: Threat"<br />\| parse "Is Malware: \*, " as malware\_status nodrop<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by  nodrop <br />\| parse "Device Name: \*, IP Address: (\*), File Name: \*, Path: \*, Drive Type: \*, SHA256: \*, MD5: \*, Status: \*, Cylance Score: \*, Found Date: \*, File Type: \*, Is Running: \*, Auto Run: \*, Detected By: \*, Zone Names: (\*)" as device\_name, ip\_address, file\_name, path, drive\_type, sha, md5, status, score, found, file\_type, isRunning, autoRun, detected\_by, zone  nodrop <br />\| parse "Is Unique To Cylance: \*, Threat Classification: \*, Device Id: \*, Policy Name: \*" as isUniqueToCylance, threatClassification, device\_id, policy nodrop<br />\| if (score = "n/a", "0", score) as score<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where event\_type = "Threat"<br />\| concat(device\_name, file\_name, sha) as Threat<br />\|where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{file\_name}}" = "\*", true, file\_name matches "{{file\_name}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{drive\_type}}" = "\*", true, drive\_type matches "{{drive\_type}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{detected\_by}}" = "\*", true, detected\_by matches "{{detected\_by}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{ThreatClassification}}" = "\*", true, ThreatClassification matches "{{ThreatClassification}}")<br />\|count\_distinct(Threat) as %"Unique Threats"|
|Cylance|Unique Users|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count\_distinct(user) as UniqueUsers|
|Cylance|Unique Users|Logs|Installed Apps/Cylance/Cylance - Device|\_sourceCategory={{\_sourceCategory}} "Event Type: Device"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Device Name: \*, Agent Version: \*, IP Address: (\*), MAC Address: (\*), Logged On Users: (\*), OS: \*, Zone Names: (\*)" as device\_name, agent\_version, ip\_address, mac\_address, LoggedOnUsers, os, zone nodrop<br />\| parse "Device Name: \*, Zone Names: (\*), Device Id: \*" as device\_name, zone, device\_id nodrop<br />\| parse "Device Message: \*, User: \*, Zone Names: (\*), Device Id: \*" as  device\_message, user, zone, device\_id nodrop<br />\| parse regex field=ip\_address "\\s\*(?\<ipaddress\>[^,]\*)" multi nodrop<br />\| parse field=device\_message "Device: \*; " as device\_name nodrop<br />\| if (isempty(ipaddress), ip\_address, ipaddress) as ip\_address<br />\| parse regex field=LoggedOnUsers "\\s\*(?\<users\>[^,]\*)" multi nodrop<br />\| if (isempty(users), user, users) as user<br />\| where event\_type = "Device" and !isEmpty(user)<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\|count\_distinct(user) as UniqueUsers|
|Cylance|Unique Violation Types|Logs|Installed Apps/Cylance/Cylance - Memory Exploit Attempts|\_sourceCategory={{\_sourceCategory}} ExploitAttempt<br />\| parse "Event Type: \*, Event Name: \*, Device Name: \*, IP Address: (\*), Action: \*, Process ID: \*, Process Name: \*, User Name: \*, Violation Type: \*, Zone Names: (\*), Device Id: \*, Policy Name: \*" as event\_type, event\_name, device\_name, ip\_address, action, pid, pname, user, violation, zone, device\_id, policy<br />\| where event\_type="ExploitAttempt"<br />\|where if ("{{ip\_address}}" = "\*", true, ip\_address matches "{{ip\_address}}") AND if ("{{violation}}" = "\*", true, violation matches "{{violation}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{device\_id}}" = "\*", true, device\_id matches "{{device\_id}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}") AND if ("{{pname}}" = "\*", true, pname matches "{{pname}}")<br />\|count\_distinct(violation) as UniqueViolations|
|Cylance|Unique Zones|Logs|Installed Apps/Cylance/Cylance - Overview|\_sourceCategory={{\_sourceCategory}} CylancePROTECT "Zone Names"<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Zone Names: (\*)" as zone nodrop<br />\| parse regex field=zone "\\s\*(?\<zones\>[^,]\*)" multi nodrop<br />\| zones as zone<br />\| where !isEmpty(zone)<br />\|where if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") <br />\|count\_distinct(zone) as UniqueZones|
|Cylance|User Activity Location|Logs|Installed Apps/Cylance/Cylance - AuditLog|\_sourceCategory={{\_sourceCategory}} "Event Type:" AuditLog<br />\| parse "Event Type: \*, Event Name: \*," as event\_type, event\_name nodrop<br />\| parse "Message: \*," as msg nodrop \| parse "Source IP: \*," as src\_ip nodrop \| parse "User: \*" as user nodrop<br />\| parse field=msg "Device: \* was auto assigned to Zone: \*" as device\_name, zone nodrop<br />\| parse field=msg "Provider: \*" as provider nodrop<br />\| parse regex field=msg "Device:\\s\*(?\<device\_name\>[^\\s]\*)\\s\*\$" nodrop<br />\| parse field=msg "Tier: \*; Zones: \*; Agent Version: \*" as tier, zone, agent\_version nodrop<br />\| parse field=msg "Policy Assigned: \*; Devices: \*" as policy, device\_name nodrop<br />\| parse field=msg "Device: \*; " as device\_name nodrop<br />\| parse field=msg "Devices: \*" as device\_name nodrop<br />\| parse field=msg "SHA256: \*" as sha nodrop<br />\| parse field=msg "Zone: \*; Policy Assigned: \*; Policy Applied To All Devices In Zone: \*" as zone, policy, PolicyAppliedToAllDevicesInZone<br />\| where event\_type = "AuditLog"<br />\| where !isEmpty(src\_ip)<br />\| where if ("{{sha}}" = "\*", true, sha matches "{{sha}}") AND if ("{{provider}}" = "\*", true, provider matches "{{provider}}") AND if ("{{zone}}" = "\*", true, zone matches "{{zone}}") AND if ("{{agent\_version}}" = "\*", true, agent\_version matches "{{agent\_version}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{device\_name}}" = "\*", true, device\_name matches "{{device\_name}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{tier}}" = "\*", true, tier matches "{{tier}}") AND if ("{{event\_name}}" = "\*", true, event\_name matches "{{event\_name}}")<br />\| count by src\_ip<br />\| lookup latitude, longitude from geo://location on ip=src\_ip|

