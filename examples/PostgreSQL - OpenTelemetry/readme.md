# PostgreSQL - OpenTelemetry

## Searches

### Log Searches

- **Activity by Database**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Activity by Database Over Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Activity by User**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Activity by User Over Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Average Query Execution Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution 
- **Avg Execution Time by Slow SQL Commands**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries 
- **Connections**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Connections Authorized by  Database - Over Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security 
- **Database System Shut Down Events**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Database System Up Events**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Errors**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Errors and Fatal Events**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Failed Authentication by  Database - Over Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security 
- **Failed Authentications**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security 
- **Failed Authentications by User and Database**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security 
- **Failed Logins**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Fatal Errors**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Fatal Errors**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Geo Location of Incoming Connections**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security 
- **Least Common Errors**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Log Reduce**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Log Severity**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Most Common Errors**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs 
- **Number of queries  - Outlier Flag**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security 
- **Number of Queries Executed by Database**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution 
- **Queries Executed - One Day Time Comparison**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution 
- **Queries executed Over Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Queries Executed Over Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution 
- **Queries Executed Over Time - One Day Time Comparison**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution 
- **Query Execution Time Stats**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution 
- **Slow Queries**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries 
- **Slow Queries**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Slow Queries by Database Over Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries 
- **Slow Queries Over Time**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Slow Query by Command Type**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries 
- **Slowest Query by Database - One Day Time Comparison**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries 
- **Threat Intel Analysis of Incoming Connections**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security 
- **Top 10 Slow Queries by Database**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries 
- **Top Errors and Warnings**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security 
- **Top Users Firing Slow Queries**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries

### Metric Searches

- **Active Clusters**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Active Databases**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview 
- **Buffer Hits  by Relation**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics 
- **Buffer Hits  by Schema**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics 
- **Checkpoint Requested vs Scheduled**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Commits and Rollbacks by Database**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Disk Block Reads  by Relation**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics 
- **Disk Block Reads  by Schema**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics 
- **Disk Usage by Database**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Disk Usage by Relation**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics 
- **Disk Usage by Schema**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics 
- **Heap Only Tuple (HOT) Updates by Relation**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics 
- **Heap Only Tuple (HOT) Updates by Schema**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics 
- **Index Cache Hit Ratio by Database**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Index Scans by Table**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics 
- **Index Size by Table**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics 
- **Indexes Scanned By Table**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics 
- **Least 5 Frequently Scanned Indexes**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Number of Active Database(s)**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Number of Active Host(s)**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Number of Server Processes by Database**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Percentage Change in Database Size**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Replay/Flush/Write Lag**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics 
- **Rows Inserted, Updated  and Deleted by Relation**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics 
- **Rows Inserted, Updated  and Deleted by Schema**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics 
- **Top 5 Frequently Scanned Indexes**: from Dashboard: Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|PostgreSQL - OpenTelemetry|Active Clusters|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} metric=postgresql.backends  \| count by db.cluster.name \| count|
|PostgreSQL - OpenTelemetry|Active Databases|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} metric=postgresql.backends db.name =\* \| count|
|PostgreSQL - OpenTelemetry/Logs|Activity by Database|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name=\* <br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| count as %"Count" by db.name<br />\| sort by %"Count"|
|PostgreSQL - OpenTelemetry/Logs|Activity by Database Over Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} <br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg<br />\| where user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| timeslice 15m<br />\| count as %"Count" by db.name, \_timeslice<br />\| outlier %"Count" by db.name<br />\| fields \_timeslice,db.name, Count\_violation<br />\| transpose row \_timeslice column db.name|
|PostgreSQL - OpenTelemetry/Logs|Activity by User|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name=\* <br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| count as %"Count" by user<br />\| sort by %"Count"|
|PostgreSQL - OpenTelemetry/Logs|Activity by User Over Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} <br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg<br />\| where user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| timeslice 15m<br />\| count as %"Count" by user, \_timeslice<br />\| outlier %"Count" by user<br />\| fields \_timeslice,user, Count\_violation<br />\| transpose row \_timeslice column user|
|PostgreSQL - OpenTelemetry/Logs|Average Query Execution Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where db.name matches "{{db.name}}"<br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| timeslice 5m<br />\| avg(execution\_time\_ms) group by \_timeslice, db.name<br />\| transpose row \_timeslice column db.name  |
|PostgreSQL - OpenTelemetry/Logs|Avg Execution Time by Slow SQL Commands|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> {{slow\_query\_latency\_ms}} and db.name matches "{{db.name}}"<br />\| toUpperCase(query) as query<br />\| parse regex field=query "(?:\\s\|\\\\n\|\\n)+(?\<sql\_cmd\_type\>CREATE\|DROP\|ALTER\|TRUNCATE\|COMMENT\|RENAME\|SELECT\|INSERT\|UPDATE\|DELETE\|GRANT\|INVOKE\|BEGIN\|COMMIT\|ROLLBACK)(?:\\s\|\\\\n\|\\n)+"<br />\| timeslice 1h<br />\| avg(execution\_time\_ms) as avg\_query\_time group by \_timeslice, sql\_cmd\_type<br />\| transpose row \_timeslice column sql\_cmd\_type|
|PostgreSQL - OpenTelemetry/Metrics|Buffer Hits  by Relation|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.blocks\_read source=heap\_hit  db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.name={{db.name}} db.node.name={{db.node.name}} \| sum by db.cluster.name,db.name,db.schema, db.sql.table|
|PostgreSQL - OpenTelemetry/Metrics|Buffer Hits  by Schema|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.blocks\_read source=heap\_hit db.name={{db.name}} db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.node.name={{db.node.name}} \| sum by db.cluster.name,db.name, db.schema|
|PostgreSQL - OpenTelemetry/Metrics|Checkpoint Requested vs Scheduled|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.bgwriter.checkpoint.count type = scheduled db.node.name={{db.node.name}} \| sum by db.cluster.name, db.node.name|
|PostgreSQL - OpenTelemetry/Metrics|Commits and Rollbacks by Database|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.commits db.name={{db.name}} db.node.name={{db.node.name}} \| sum by db.cluster.name, db.name|
|PostgreSQL - OpenTelemetry|Connections|Logs|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}}  connection authorized<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse regex field=\_raw "user=(?\<user\>[\\S]+) database=(?\<database\>[\\S]+)"<br />\| count|
|PostgreSQL - OpenTelemetry/Logs|Connections Authorized by  Database - Over Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security|   sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} connection authorized<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse regex field=\_raw "user=(?\<user\>[\\S]+) database=(?\<database\>[\\S]+)"<br />\| timeslice 1h<br />\| count by \_timeslice, database<br />\| transpose row \_timeslice column database|
|PostgreSQL - OpenTelemetry/Logs|Database System Shut Down Events|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} ("database system" AND "shut down")<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*:  \*" as date,time,time\_zone,thread\_id,severity,msg<br />\| count by date, time, severity,  msg|
|PostgreSQL - OpenTelemetry/Logs|Database System Up Events|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} "database system is ready to accept connections"<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*:  \*" as date,time,time\_zone,thread\_id,severity,msg<br />\| count by date, time, severity,  msg|
|PostgreSQL - OpenTelemetry/Metrics|Disk Block Reads  by Relation|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.blocks\_read source=heap\_read db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.name={{db.name}} db.node.name={{db.node.name}} \| sum by db.cluster.name,db.name,db.schema, db.sql.table|
|PostgreSQL - OpenTelemetry/Metrics|Disk Block Reads  by Schema|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.blocks\_read source=heap\_read db.name={{db.name}} db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.node.name={{db.node.name}} \| sum by db.cluster.name,db.name, db.schema|
|PostgreSQL - OpenTelemetry/Metrics|Disk Usage by Database|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.name={{db.name}} metric=postgresql.db\_size db.node.name={{db.node.name}}  \| avg by db.cluster.name, db.name|
|PostgreSQL - OpenTelemetry/Metrics|Disk Usage by Relation|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.table.size db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.name={{db.name}} db.node.name={{db.node.name}} \| avg by db.cluster.name,db.name,db.schema, db.sql.table|
|PostgreSQL - OpenTelemetry/Metrics|Disk Usage by Schema|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.table.size db.name={{db.name}} db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.node.name={{db.node.name}} \| avg by db.cluster.name,db.name, db.schema|
|PostgreSQL - OpenTelemetry|Errors|Logs|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} <br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db,severity,msg <br />\| where severity = "ERROR"<br />\| count|
|PostgreSQL - OpenTelemetry/Logs|Errors and Fatal Events|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} (ERROR or FATAL)<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| timeslice 15m<br />\| count as event\_count by  \_timeslice<br />\| outlier event\_count window=5,threshold=3,consecutive=2,direction=+<br />|
|PostgreSQL - OpenTelemetry/Logs|Failed Authentication by  Database - Over Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security|   sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} "authentication failed"<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,database,severity,msg<br />\| timeslice 1h<br />\| count by \_timeslice, database<br />\| transpose row \_timeslice column database|
|PostgreSQL - OpenTelemetry/Logs|Failed Authentications|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security|   sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} "authentication failed"<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,database,severity,msg<br />\| count as %"Count" |
|PostgreSQL - OpenTelemetry/Logs|Failed Authentications by User and Database|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security|   sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} "authentication failed"<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,database,severity,msg<br />\| count as %"Count" by user, database, db.cluster.name<br />\| sort by %"Count"|
|PostgreSQL - OpenTelemetry|Failed Logins|Logs|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}}  "authentication failed"<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,database,severity,msg<br />\| count|
|PostgreSQL - OpenTelemetry|Fatal Errors|Logs|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} <br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db,severity,msg <br />\| where severity = "FATAL"<br />\| count|
|PostgreSQL - OpenTelemetry/Logs|Fatal Errors|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} <br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where severity IN ("ERROR", "FATAL") and user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| format("%s %s", date, time) as datetime<br />\| count by datetime, severity, db.name, user, msg|
|PostgreSQL - OpenTelemetry/Logs|Geo Location of Incoming Connections|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security|   sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} connection<br />\| parse "connection received: host=\* port=\*" as ip,port <br />\| where !(ip matches "localhost" or ip matches "127.0.0.1") <br />\| lookup latitude, longitude from geo://location on ip = ip<br />\| count by latitude, longitude<br />\| sort \_count<br /><br />|
|PostgreSQL - OpenTelemetry/Metrics|Heap Only Tuple (HOT) Updates by Relation|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.operations operation=hot\_upd db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.name={{db.name}} db.node.name={{db.node.name}} \| avg by db.cluster.name,db.name, db.schema, db.sql.table|
|PostgreSQL - OpenTelemetry/Metrics|Heap Only Tuple (HOT) Updates by Schema|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.operations operation=hot\_upd db.name={{db.name}} db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.node.name={{db.node.name}} \| avg by db.cluster.name, db.name, db.schema|
|PostgreSQL - OpenTelemetry/Metrics|Index Cache Hit Ratio by Database|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.blocks\_read source=idx\_hit  db.name={{db.name}} db.node.name={{db.node.name}} \| sum by db.cluster.name,db.name|
|PostgreSQL - OpenTelemetry/Metrics|Index Scans by Table|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.index.scans db.sql.table={{db.sql.table}} db.name={{db.name}} db.node.name={{db.node.name}} \| sum by db.cluster.name,db.name, db.sql.table|
|PostgreSQL - OpenTelemetry/Metrics|Index Size by Table|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.index.size db.sql.table={{db.sql.table}} db.name={{db.name}} postgresql.index.name =\* db.node.name={{db.node.name}} \| avg by db.cluster.name,db.name,db.sql.table, postgresql.index.name|
|PostgreSQL - OpenTelemetry/Metrics|Indexes Scanned By Table|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.index.scans db.name={{db.name}} db.node.name={{db.node.name}} db.sql.table={{db.sql.table}} postgresql.index.name=\* \| sum by db.cluster.name, db.name, postgresql.index.name , db.sql.table|
|PostgreSQL - OpenTelemetry/Metrics|Least 5 Frequently Scanned Indexes|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.index.scans postgresql.table.name=\* postgresql.index.name=\* db.name={{db.name}} db.node.name={{db.node.name}} \| sum by db.cluster.name, db.name, postgresql.table.name, postgresql.index.name\| bottomk (5, max)|
|PostgreSQL - OpenTelemetry/Logs|Least Common Errors|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}}<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where severity IN ("ERROR", "FATAL") and  user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| logreduce field=msg by db.cluster.name limit=5,criteria=leastcommon|
|PostgreSQL - OpenTelemetry/Logs|Log Reduce|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}}<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where severity IN ("ERROR", "FATAL") and user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| logreduce field=msg by db.cluster.name|
|PostgreSQL - OpenTelemetry/Logs|Log Severity|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} <br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| count by severity<br />\| sort by \_count|
|PostgreSQL - OpenTelemetry/Logs|Most Common Errors|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Error Logs|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}}<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where severity IN ("ERROR", "FATAL") and user matches "{{user}}" and db.name matches "{{db.name}}"<br />\| logreduce field=msg by db.cluster.name limit=5,criteria=mostcommon|
|PostgreSQL - OpenTelemetry/Metrics|Number of Active Database(s)|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.backends db.name={{db.name}} db.node.name={{db.node.name}} \| count by db.name \| count|
|PostgreSQL - OpenTelemetry/Metrics|Number of Active Host(s)|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.backends db.name={{db.name}} db.node.name={{db.node.name}} \| count by db.node.name \| count|
|PostgreSQL - OpenTelemetry/Logs|Number of queries  - Outlier Flag|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security|   sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| timeslice 15m<br />\| count by \_timeslice , db.name<br />\| outlier \_count  by db.name<br />\| fields  \_timeslice, \_count\_violation, db.name<br />\| transpose row \_timeslice column db.name|
|PostgreSQL - OpenTelemetry/Logs|Number of Queries Executed by Database|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where db.name matches "{{db.name}}"<br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| count by db.name<br />\| sort by \_count|
|PostgreSQL - OpenTelemetry/Metrics|Number of Server Processes by Database|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.backends db.name={{db.name}} db.node.name={{db.node.name}}  |
|PostgreSQL - OpenTelemetry/Metrics|Percentage Change in Database Size|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.db\_size db.name={{db.name}} db.node.name={{db.node.name}} \| avg by db.cluster.name, db.name|
|PostgreSQL - OpenTelemetry/Logs|Queries Executed - One Day Time Comparison|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where db.name matches "{{db.name}}"<br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| count as %"Count" by db.name <br />\| compare with timeshift 1d|
|PostgreSQL - OpenTelemetry/Logs|Queries Executed Over Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where db.name matches "{{db.name}}"<br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| timeslice 5m<br />\| count by \_timeslice, db.name<br />\| transpose row \_timeslice column db.name  |
|PostgreSQL - OpenTelemetry|Queries executed Over Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}}  duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| timeslice 5m<br />\| count by \_timeslice, db.cluster.name<br />\| transpose row \_timeslice column db.cluster.name  |
|PostgreSQL - OpenTelemetry/Logs|Queries Executed Over Time - One Day Time Comparison|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where db.name matches "{{db.name}}"<br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| timeslice 5m<br />\| count as %"Count" by \_timeslice, db.name<br />\| compare with timeshift 1d<br />\| transpose row \_timeslice column db.name|
|PostgreSQL - OpenTelemetry/Logs|Query Execution Time Stats|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL -  Query Execution|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| where db.name matches "{{db.name}}"<br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| avg(execution\_time\_ms) as mean\_execution\_time, pct(execution\_time\_ms, 50) as median\_execution\_time, pct(execution\_time\_ms, 99) as %"99\_pct\_execution\_time" by db.name |
|PostgreSQL - OpenTelemetry/Metrics|Replay/Flush/Write Lag|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.wal.lag wal\_operation\_lag=flush|
|PostgreSQL - OpenTelemetry/Metrics|Rows Inserted, Updated  and Deleted by Relation|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Relation Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.operations operation=upd db.schema={{db.schema}} db.sql.table={{db.sql.table}} db.name={{db.name}} db.node.name={{db.node.name}} \| avg by db.cluster.name,db.name, db.schema, db.sql.table|
|PostgreSQL - OpenTelemetry/Metrics|Rows Inserted, Updated  and Deleted by Schema|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Schema Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.operations operation=upd db.name={{db.name}} db.schema={{db.schema}} db.sql.table={{db.sql.table}}  db.node.name={{db.node.name}} \| avg by db.cluster.name,db.name, db.schema|
|PostgreSQL - OpenTelemetry/Logs|Slow Queries|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> {{slow\_query\_latency\_ms}} and db.name matches "{{db.name}}"<br />\| count|
|PostgreSQL - OpenTelemetry|Slow Queries|Logs|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}}  duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> 5000<br />\| count|
|PostgreSQL - OpenTelemetry/Logs|Slow Queries by Database Over Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> {{slow\_query\_latency\_ms}} and db.name matches "{{db.name}}"<br />\| timeslice 1h<br />\| count by \_timeslice, db.name,db.cluster.name<br />\| transpose row \_timeslice column db.name,db.cluster.name|
|PostgreSQL - OpenTelemetry|Slow Queries Over Time|Logs|Installed Apps/PostgreSQL - OpenTelemetry/PostgreSQL - Overview|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}}  duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> 5000<br />\| timeslice 5m<br />\| count by \_timeslice, db.cluster.name<br />\| transpose row \_timeslice column db.cluster.name  |
|PostgreSQL - OpenTelemetry/Logs|Slow Query by Command Type|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| count by date,time,user,db.name,execution\_time\_ms,query,db.cluster.name<br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> {{slow\_query\_latency\_ms}} and db.name matches "{{db.name}}"<br />\| parse regex field=query "(?:\\s\|\\\\n\|\\n)+(?\<sql\_cmd\_type\>(?i)CREATE\|DROP\|ALTER\|TRUNCATE\|COMMENT\|RENAME\|SELECT\|INSERT\|UPDATE\|DELETE\|GRANT\|INVOKE\|BEGIN\|COMMIT\|ROLLBACK)(?:\\s\|\\\\n\|\\n)+"<br />\| count as frequency by sql\_cmd\_type|
|PostgreSQL - OpenTelemetry/Logs|Slowest Query by Database - One Day Time Comparison|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| count by  db.cluster.name, db.name, execution\_time\_ms<br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> {{slow\_query\_latency\_ms}} and db.name matches "{{db.name}}"<br />\| topk(1,execution\_time\_ms) by db.cluster.name, db.name<br />\| fields - \_rank, \_count<br />\| compare with timeshift 1d|
|PostgreSQL - OpenTelemetry/Logs|Threat Intel Analysis of Incoming Connections|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security|   sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} connection<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "connection received: host=\* port=\*" as ip,port <br />\| count by ip, db.cluster.name<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip<br />\| where type="ip\_address" <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| count by  db.cluster.name, type, actor, ip, malicious\_confidence, label\_name|
|PostgreSQL - OpenTelemetry/Logs|Top 10 Slow Queries by Database|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| count by date,time,user,db.name,execution\_time\_ms,query,db.cluster.name<br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> {{slow\_query\_latency\_ms}} and db.name matches "{{db.name}}"<br />\| topk(10,execution\_time\_ms) by db.cluster.name, db.name<br />\| \_rank as rank<br />\| fields - \_count, \_rank|
|PostgreSQL - OpenTelemetry/Metrics|Top 5 Frequently Scanned Indexes|Metrics|Installed Apps/PostgreSQL - OpenTelemetry/Metrics/PostgreSQL - Database Metrics|sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} metric=postgresql.index.scans postgresql.table.name=\* postgresql.index.name=\* db.name={{db.name}} db.node.name={{db.node.name}} \| sum by db.cluster.name, db.name, postgresql.table.name, postgresql.index.name \| topk (5, max)|
|PostgreSQL - OpenTelemetry/Logs|Top Errors and Warnings|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Security|   sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} (ERROR OR FATAL OR WARNING OR  PANIC)<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,database,severity,msg<br />\| count as frequency by msg, db.cluster.name, database<br />\| sort by frequency|
|PostgreSQL - OpenTelemetry/Logs|Top Users Firing Slow Queries|Logs|Installed Apps/PostgreSQL - OpenTelemetry/Logs/PostgreSQL - Slow Queries|    sumo.datasource=postgresql deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} db.node.name={{db.node.name}} duration<br />\| json "log" as \_rawlog nodrop \| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw \| parse "\* \* \* [\*] \*@\* \*:  \*" as date,time,time\_zone,thread\_id,user,db.name,severity,msg <br />\| parse regex field=msg "duration: (?\<execution\_time\_ms\>[\\S]+) ms  (?\<query\>.+)" <br />\| count by date,time,user,db.name,execution\_time\_ms,query,db.cluster.name<br />\| number (execution\_time\_ms)<br />\| where execution\_time\_ms \> {{slow\_query\_latency\_ms}} and db.name matches "{{db.name}}"<br />\| count by user|

