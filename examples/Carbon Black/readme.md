# Carbon Black
## Sumo Logic App For: Carbon Black
The Sumo Logic App for Carbon Black provides visibility into key endpoint security data from Carbon Black Endpoint Detection and Response (EDR) and Endpoint Standard with pre-configured dashboards for alerts, threats intelligence, feeds, sensors, alerts, users, hosts, processes, IOCs, devices and network status.
Docs Link: [Carbon Black](https://help.sumologic.com/?cid=1966)

## Searches

### Log Searches

- **Active Sensors**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors 
- **Activity**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors 
- **Alerts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Alerts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts 
- **Alerts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Alerts by Device**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device 
- **Alerts by Device OS**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts 
- **Alerts by Group**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts 
- **Alerts by Host after a Critical Threat Identification**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts 
- **Alerts By Mode**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts 
- **Alerts by OS**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts 
- **Alerts by Report**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts 
- **Alerts by Severity**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts 
- **Alerts by Severity and Device**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device 
- **Alerts by Target Priority**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts 
- **Alerts over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Alerts Over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts 
- **Alerts over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Alerts Over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts 
- **CB Server List**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **CB Servers**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Command Line by Process**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Comms IP Distribution**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Devices**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Devices**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device 
- **Devices by Group**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device 
- **Devices by OS**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device 
- **Devices by Target-Priority**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device 
- **Endpoint IP Distribution**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Feeds**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Feeds**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds 
- **Feeds Comparison over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds 
- **Feeds over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds 
- **Fileless Attacks**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **FileMod Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Groups**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Groups**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Host Watchlist Hits**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists 
- **Incidents by Device**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device 
- **Indicators**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Indicators of Compromise 
- **Indicators and Applications**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Indicators of Compromise 
- **Indicators by Severity**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Indicators of Compromise 
- **Indicators of Compromise**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Malware Attacks**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Most Recent Alerts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts 
- **Most Recent Feeds**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds 
- **Most Recent Threats**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Most Recent Threats**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Multiple Users using the same Machine (Top 10)**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **New Binaries Observed**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Outbound and Inbound Alerts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **Policy Deny Actions**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Policy Terminate Actions**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Process Connections to Suspicious Countries**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Process Query Watchlist Hits**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists 
- **Process Watchlist Hits**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists 
- **Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Processes Blocked**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Processes by Associated Feeds**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds 
- **Recent Alerts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts 
- **Recent Policy Actions**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **RegMod Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Remote IP Distribution**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Sensor OS Breakdown**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors 
- **Sensors**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Sensors 24h**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors 
- **Sensors 30d**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors 
- **Sensors 7d**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors 
- **Sensors not Reporting in last 7 days**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors 
- **Tampering Processes Observed**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threat Score Box Plot by Feed**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threat Scores by Feed**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threats**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Threats**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Threats by Feed and Score**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threats by Feeds**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threats by Feeds over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threats by Score**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threats by Severity**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threats by Severity**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Threats Detected**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threats Detected**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Threats Outlier**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Threats Outlier**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Top Applications**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Top Devices**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Top Devices - Multiple Critical Threats**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Top Devices Affected**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Top Feeds**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds 
- **Top FileMod Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Top Groups**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Top Hosts - High Avg Score Threats**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Top Hosts - Multiple Critical Threats**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Top Hosts Affected**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Top Hosts by Alerts Fired**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **Top Hosts by Inbound Alerts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **Top Hosts with Malware Attacks**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence 
- **Top Hosts with Outbound Alerts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **Top Indicators**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Top IOC DNSs**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise 
- **Top IOC MD5s**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise 
- **Top IOC Process and Binary Queries**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise 
- **Top IOC Query Based Feeds**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise 
- **Top IOC's**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Top IOCs**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise 
- **Top Local Ports**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Top Malicious IPv4 Addresses**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise 
- **Top OS**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Top Parent Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Top Paths**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Top Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Top Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Top Processes  by Feed**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds 
- **Top Processes by Host**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Top Protocols**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Top Reasons**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Top RegMod Processes**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes 
- **Top Remote Ports**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Top Scores**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence 
- **Top Threat Feeds**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Top Users**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Top Users by Alerts Fired**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts 
- **Top Users by Alerts Fired**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **Top Watchlists**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Top Watchlists**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists 
- **Unique Comms IP's**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Unique Hosts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **Unique Hosts**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Unique Indicators**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Indicators of Compromise 
- **Unique Interface IP's**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Unique Remote IP's**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network 
- **Unique Users**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **Unique Users**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **User Alerts Over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts 
- **Users**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview 
- **Watchlist Comparison over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists 
- **Watchlist Hits by Name over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists 
- **Watchlist Hits by Type over Time**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists 
- **Watchlists**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview 
- **Watchlists**: from Dashboard: Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Carbon Black/Carbon Black Endpoint Detection and Response|Active Sensors|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:sensor\_id)(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") <br />\| timeslice by 1h <br />\| count\_distinct(sensor\_id) by \_timeslice<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Activity|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:sensor\_id)(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)"<br />\| parse regex "(?:report\_id)(?:\\"\\:\\"\|=')(?\<report\_id\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:comms\_ip)(?:\\"\\:\\"\|=')(?\<comms\_ip\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:interface\_ip)(?:\\"\\:\\"\|=')(?\<interface\_ip\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:username)(?:\\"\\:\\"\|=')(?\<username\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />//\| where !isBlank(report\_id)<br />\| count by hostname, report\_id, username, comms\_ip, interface\_ip,sensor\_id<br />\| sort by \_count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Alerts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count|
|Carbon Black/Carbon Black Endpoint Standard|Alerts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os","severity" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, ActualSeverity2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where !isBlank(Severity) and Severity matches "{{Severity}}"<br />\| count<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Alerts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os","severity" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, ActualSeverity2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| count<br />|
|Carbon Black/Carbon Black Endpoint Standard|Alerts by Device|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device)<br />\| count by Device<br />\| sort by \_count<br />\| limit 10<br /><br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Alerts by Device OS|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where !isBlank(Severity) and Severity matches "{{Severity}}"<br />\| concat(Device\_OS1,Device\_OS2) as Device\_OS<br />\| where !isBlank(Device\_OS)<br />\| count by Device\_OS <br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Alerts by Group|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:group)(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count by group<br />\| sort by \_count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Alerts by Host after a Critical Threat Identification|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\|join ( parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<score\>-?\\d+)"<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| \_messageTime as event\_time<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") <br />) as alert<br />// Find the most recent critical message by hostname (gives the last time it reported) <br />, (parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />     \| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<score\>-?\\d+)"<br />     \| toInt(score)<br />     \| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (score) \>= 80<br />     \| first(\_messageTime) as last\_event\_time by hostname<br />     \| fields hostname,last\_event\_time) as critical\_events<br />on alert.hostname = critical\_events.hostname<br />\| where alert\_event\_time \>  critical\_events\_last\_event\_time<br />\| count by alert\_hostname, alert\_event\_time, alert\_score, alert\_ioc\_type, alert\_feed\_name, alert\_group, alert\_watchlist\_name, alert\_status<br />\| formatDate(alert\_event\_time, "dd/MM/yyyy HH:mm:ss:SSS Z") as alert\_time<br />\| fields alert\_hostname, alert\_time, alert\_score, alert\_ioc\_type, alert\_feed\_name, alert\_group, alert\_watchlist\_name, alert\_status<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Alerts By Mode|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "username(?:\\"\\:\\"\|%3A\|=')(?\<username\>.\*?)(?:\\"\|%20\|\\\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| if (username matches "SYSTEM" or username matches "system",1,0) as kernel<br />\| if (!(username matches "SYSTEM" or username matches "system"),1,0) as user<br />\| timeslice 15m<br />\| sum(kernel) as kernel\_count, sum(user) as user\_count by \_timeslice|
|Carbon Black/Carbon Black Endpoint Detection and Response|Alerts by OS|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:os\_type)(?:\\"\\:\\"\|=')(?\<os\_type\>.\*?)(?:\\"\|')" multi nodrop<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count(os\_type) by os\_type<br />\| sort by \_count<br />\| limit 10<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Alerts by Report|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:report\_id)(?:\\"\\:\\"\|=')(?\<Report\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count as events by Report<br />\| sort by events|
|Carbon Black/Carbon Black Endpoint Standard|Alerts by Severity|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where !isBlank(Severity) and Severity matches "{{Severity}}"<br />\| count(Severity) by Severity|
|Carbon Black/Carbon Black Endpoint Standard|Alerts by Severity and Device|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device) and !isBlank(Severity)<br />\| count(Severity) by Device, Severity<br />\| sort by \_count<br />|
|Carbon Black/Carbon Black Endpoint Standard|Alerts by Target Priority|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where !isBlank(Severity) and Severity matches "{{Severity}}"<br />\| concat(Target\_Priority1,Target\_Priority2) as Target\_Priority<br />\| where !isBlank(Target\_Priority)<br />\| count by Target\_Priority<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Alerts over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| timeslice 15m<br />\| count by \_timeslice|
|Carbon Black/Carbon Black Endpoint Standard|Alerts Over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") <br />\| timeslice 15m<br />\| count as alerts by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier alerts|
|Carbon Black/Carbon Black Endpoint Standard|Alerts over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| timeslice 1h<br />\| count(Severity) by \_timeslice, Severity<br />\| transpose row \_timeslice column Severity|
|Carbon Black/Carbon Black Endpoint Detection and Response|Alerts Over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")\| timeslice 15m<br />\| count as alerts by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier alerts|
|Carbon Black/Carbon Black Endpoint Detection and Response|CB Server List|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:cb\_server)(?:\\"\\:\\"\|=')(?\<cb\_server\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:cb\_version)(?:\\"\\:\\"\|=')(?\<cb\_version\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(cb\_server)  by cb\_server, cb\_version<br />\| fields - \_count\_distinct<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|CB Servers|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:cb\_server)(?:\\"\\:\\"\|=')(?\<cb\_server\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:cb\_version)(?:\\"\\:\\"\|=')(?\<cb\_version\>.\*?)(?:\\"\|')"   <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct (cb\_server)<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Command Line by Process|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:cmdline)(?:\\"\\:\\"\|%3A)(?\<cmdline\>.\*?)(?:\\"\|%20-)" multi<br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| replace(cmdline,")", " ") as cmdline<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}"<br />\| count(cmdline) by process\_name, cmdline<br />\| sort by \_count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Comms IP Distribution|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:comms\_ip)(?:\\"\\:\\"\|=')(?\<comms\_ip\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = comms\_ip<br />\| where !isBlank(postal\_code)<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />|
|Carbon Black/Carbon Black Endpoint Standard|Devices|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )  and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device)<br />\| count\_distinct(Device)<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Devices|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device)<br />\| count\_distinct(Device)|
|Carbon Black/Carbon Black Endpoint Standard|Devices by Group|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(DeviceGroup1,DeviceGroup2) as DeviceGroup<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device)<br />\| count(Device) by DeviceGroup<br />\| sort by \_count<br /><br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Devices by OS|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(Device\_OS1,Device\_OS2) as Device\_OS<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device) and !isBlank(Device\_OS)<br />\| count(Device) by Device\_OS<br />\| sort by \_count<br /><br /><br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Devices by Target-Priority|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(Target\_Priority1,Target\_Priority2) as Target\_Priority<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device) and !isBlank(Target\_Priority)<br />\| count(Device) by Target\_Priority<br />\| sort by \_count<br /><br /><br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Endpoint IP Distribution|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:interface\_ip)(?:\\"\\:\\"\|=')(?\<interface\_ip\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and !isBlank(interface\_ip) <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = interface\_ip<br />\| where !isBlank(postal\_code)<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Feeds|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct ( feed\_name)<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Feeds|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct ( feed\_name)<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Feeds Comparison over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count  by feed\_name<br />\| compare with timeshift 1d 7<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Feeds over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| timeslice 15m<br />\| count by \_timeslice <br />|
|Carbon Black/Carbon Black Endpoint Standard|Fileless Attacks|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}}  FILELESS<br />\| count|
|Carbon Black/Carbon Black Endpoint Detection and Response|FileMod Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:filemod\_count)(?:\\"\\:\|=')(?\<filemod\_count\>.\*?)(?:,\|')" multi<br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}" and filemod\_count \> 0<br />\| count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Groups|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:group)(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(group)<br />|
|Carbon Black/Carbon Black Endpoint Standard|Groups|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os","severity" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, ActualSeverity2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| concat(DeviceGroup1, DeviceGroup2) as DeviceGroup<br />\| where !isBlank(DeviceGroup)<br />\| count\_distinct(DeviceGroup)<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Host Watchlist Hits|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  "watchlist.hit.ingress.host"<br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:status)(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:os\_type)(?:\\"\\:\\"\|=')(?\<os\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:group)(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:alert\_severity)(?:\\"\\:\\"\|=')(?\<alert\_severity\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and watchlist\_name matches "\*"<br />\| count by watchlist\_name, alert\_severity, feed\_name, group, hostname, ioc\_type, os\_type, status<br />\| fields - \_count|
|Carbon Black/Carbon Black Endpoint Standard|Incidents by Device|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Device|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(Incident\_ID1,Incident\_ID2) as Incident\_ID<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device) and !isBlank(Incident\_ID)<br />\| count(Incident\_ID) by Device<br />\| sort by \_count<br /><br /><br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Indicators|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Indicators of Compromise|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json "threat\_indicators[\*].ttps" as threatInfo\_indicators1 nodrop<br />\| json "threatInfo.indicators[\*].indicatorName" as threatInfo\_indicators2 nodrop<br />\| extract field=threatInfo\_indicators1 "\\"(?\<Indicators1\>.\*?)\\"(,\|\\])" multi nodrop<br />\| extract field=threatInfo\_indicators2 "\\"(?\<Indicators2\>.\*?)\\"(,\|\\])" multi nodrop<br />\| json "type" nodrop<br />\| if(isNull(type),"NonS3Data",type) as type<br />\| where (type = "CB\_ANALYTICS" or type = "NonS3Data" or type = "POLICY\_ACTION" or type = "THREAT") and (!isBlank(Indicators1) or !isBlank(Indicators2))<br />\| concat(Indicators1, Indicators2) as Indicators<br />\| where !isBlank(Indicators)<br />\| count by Indicators<br />\| order by \_count<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Indicators and Applications|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Indicators of Compromise|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_indicators[\*].process\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "threatInfo.indicators[\*].applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| where (type = "CB\_ANALYTICS" or type = "POLICY\_ACTION" or type = "THREAT")<br />\| json "threat\_indicators[\*].ttps" as threatInfo\_indicators1 nodrop<br />\| json field=\_raw "threatInfo.indicators[\*].indicatorName" as threatInfo\_indicators2 nodrop<br />\| extract field=threatInfo\_indicators1 "\\"(?\<Indicators1\>.\*?)\\"(,\|\\])" multi nodrop<br />\| extract field=threatInfo\_indicators2 "\\"(?\<Indicators2\>.\*?)\\"(,\|\\])" multi nodrop<br />\| concat(Indicators1, Indicators2) as Indicators<br />\| extract field=Application1 "\\"(?\<Applications1\>.\*?)\\"(,\|\\])" multi nodrop<br />\| extract field=Application2 "\\"(?\<Applications2\>.\*?)\\"(,\|\\])" multi nodrop<br />\| concat(Applications1, Applications2) as Applications<br />\| where !isBlank(Indicators) and !isBlank(Applications)<br />\| count(Indicators) by Applications, Indicators <br />\| order by \_count<br />\| transpose row Indicators column Applications|
|Carbon Black/Carbon Black Endpoint Standard|Indicators by Severity|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Indicators of Compromise|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json "threat\_indicators[\*].ttps" as threatInfo\_indicators1 nodrop<br />\| json field=\_raw "threatInfo.indicators[\*].indicatorName" as threatInfo\_indicators2 nodrop<br />\| extract field=threatInfo\_indicators1 "\\"(?\<Indicators1\>.\*?)\\"(,\|\\])" multi nodrop<br />\| extract field=threatInfo\_indicators2 "\\"(?\<Indicators2\>.\*?)\\"(,\|\\])" multi nodrop<br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| json "type" nodrop<br />\| if(isNull(type),"NonS3Data",type) as type<br />\| where (type = "CB\_ANALYTICS" or type = "NonS3Data" or type = "POLICY\_ACTION" or type = "THREAT")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (!isBlank(Indicators1) or !isBlank(Indicators2))<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| concat(Indicators1, Indicators2) as Indicators<br />\| where !isBlank(Indicators) and !isBlank(Severity)<br />\| count(Indicators) by Severity, Indicators <br />\| order by \_count<br />\| transpose row Indicators column Severity<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Indicators of Compromise|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}}  <br />\| json "threat\_indicators[\*].ttps" as threatInfo\_indicators1 nodrop<br />\| json "threatInfo.indicators[\*].indicatorName" as threatInfo\_indicators2 nodrop<br />\| extract field=threatInfo\_indicators1 "\\"(?\<Indicators1\>.\*?)\\"(,\|\\])" multi nodrop<br />\| extract field=threatInfo\_indicators2 "\\"(?\<Indicators2\>.\*?)\\"(,\|\\])" multi nodrop<br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os","severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score, reason1 nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| json "type" nodrop<br />\| if(isNull(type),"NonS3Data",type) as type<br />\| where (type = "CB\_ANALYTICS" or type = "NonS3Data" or type = "POLICY\_ACTION" or type = "THREAT")<br />\| concat(Indicators1, Indicators2) as Indicators<br />\| where !isBlank(Indicators)<br />\| count\_distinct(Indicators) <br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Malware Attacks|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}}  DETECTED\_MALWARE\_APP<br />\| count|
|Carbon Black/Carbon Black Endpoint Standard|Most Recent Alerts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Alerts|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}")<br />\| if (isNull(url1),"", url1) as url1<br />\| parse field=url1 "\*/investigate" as server nodrop<br />\| if (isNull(server),"",format("%s/alerts?s[c][QUERY\_STRING\_TYPE][0]=alert ID:%s", server, Incident\_ID1)) as Alert\_URL1<br />\| replace (Alert\_URL1, " ", "%20") as Alert\_URL<br />//\| tourl(Alert\_URL ,"") as AlertURL<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(reason1,reason2) as Reason<br />\| concat(eventTime1,eventTime2) as Threat\_Time<br />\| concat(Target\_Priority1,Target\_Priority2) as Target\_Priority<br />\| concat(Device1,Device2) as Device<br />\| concat(url2,Alert\_URL) as Alert\_URL<br />\| concat(Device\_OS1,Device\_OS2) as Device\_OS<br />\| concat(User1,User2) as User<br />\| where !isBlank(Threat\_Time)<br />\| count by Threat\_Time, Alert\_URL, Device, Target\_Priority,Device\_OS, User, Reason, Severity <br />\| fields - \_count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Most Recent Feeds|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| limit 20<br />\| count\_distinct(feed\_name) as feed\_count group by feed\_name, group, hostname, ioc\_type, status, watchlist\_name<br />\| fields - feed\_count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Most Recent Threats|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')"   <br />\| parse regex "sensor\_id(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)" nodrop<br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "timestamp(?:\\"\\:\\"\|=')(?\<timestamp\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "os\_type(?:\\"\\:\\"\|=')(?\<os\_type\>.\*?)(?:\\"\|')" multi nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')"<br />\| toInt(alliance\_score)<br />\| where alliance\_score \>= 0<br /> and ioc\_type != "" and (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count by sensor\_id, group, hostname, ioc\_type, feed\_name, \_messageTime, timestamp, os\_type,status, watchlist\_name, alliance\_score <br />\| sort by \_count, \_messageTime<br />\| formatDate(fromMillis(\_messagetime), "MM-dd-yyyy HH:mm:ss") as threat\_date<br />\| fields threat\_date, sensor\_id, alliance\_score, group, hostname, ioc\_type, feed\_name, os\_type,status, watchlist\_name <br />\| fields - \_messageTime<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Most Recent Threats|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  ((Severity1 = "Threat" and toInt(Score) \>=0) or Severity2 ="WARNING" or Severity2 ="THREAT")<br />\| if (isNull(url1),"", url1) as url1<br />\| parse field=url1 "\*/investigate" as server nodrop<br />\| if (isNull(server),"",format("%s/alerts?s[c][QUERY\_STRING\_TYPE][0]=alert ID:%s", server, Incident\_ID1)) as Alert\_URL1<br />\| replace (Alert\_URL1, " ", "%20") as Alert\_URL<br />//\| tourl(Alert\_URL ,"") as AlertURL<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| concat(reason1,reason2) as Reason<br />\| concat(eventTime1,eventTime2) as Threat\_Time<br />\| concat(Target\_Priority1,Target\_Priority2) as Target\_Priority<br />\| concat(Device1,Device2) as Device<br />\| concat(url2,Alert\_URL) as Alert\_URL<br />\| concat(Device\_OS1,Device\_OS2) as Device\_OS<br />\| concat(User1,User2) as User<br />\| where !isBlank(Threat\_Time)<br />\| count by Threat\_Time, Alert\_URL, Device, Target\_Priority,Device\_OS, User, Reason, Severity <br />\| fields - \_count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Multiple Users using the same Machine (Top 10)|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:username)(?:\\"\\:\\"\|=')(?\<username\>.\*?)(?:\\"\|')" multi<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count(username) by hostname<br />\| sort by \_count<br />\| limit 10<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|New Binaries Observed|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  binaryinfo.observed<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\|count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Outbound and Inbound Alerts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:direction)(?:\\"\\:\\"\|=')(?\<direction\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| timeslice 15m<br />\| count(direction) by \_timeslice,direction<br />\| fillmissing timeslice(15m) in \_timeslice, values("Inbound","Outbound") in direction <br />\| transpose row \_timeslice column direction|
|Carbon Black/Carbon Black Endpoint Standard|Policy Deny Actions|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}}  POLICY\_DENY<br />\| count|
|Carbon Black/Carbon Black Endpoint Standard|Policy Terminate Actions|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}}  POLICY\_TERMINATE<br />\| count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Process Connections to Suspicious Countries|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:remote\_ip\|dst)(?:\\"\\:\\"\|=')(?\<remote\_ip\>.\*?)(?:\\"\|')"  <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and country\_name in ("{{Countries}}" )<br />\| count by country\_name<br />\| sort \_count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Process Query Watchlist Hits|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  "watchlist.hit.query.process"<br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:status)(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:os\_type)(?:\\"\\:\\"\|=')(?\<os\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:group)(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:alert\_severity)(?:\\"\\:\\"\|=')(?\<alert\_severity\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and watchlist\_name matches "\*"<br />\| count by watchlist\_name, alert\_severity, feed\_name, group, hostname, ioc\_type, os\_type, status<br />\| fields - \_count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Process Watchlist Hits|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  "watchlist.hit.ingress.process"<br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:status)(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:os\_type)(?:\\"\\:\\"\|=')(?\<os\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:group)(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:alert\_severity)(?:\\"\\:\\"\|=')(?\<alert\_severity\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and watchlist\_name matches "\*"<br />\| count by watchlist\_name, alert\_severity, feed\_name, group, hostname, ioc\_type, os\_type, status<br />\| fields - \_count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}"<br />\| count\_distinct(process\_name)|
|Carbon Black/Carbon Black Endpoint Detection and Response|Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}"<br />\| count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Processes Blocked|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  ingress.event.processblock<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\|count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Processes by Associated Feeds|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "process\_name(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi nodrop<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count(process\_name) by feed\_name, process\_name <br />\| sort by \_count<br />\| transpose row process\_name column feed\_name<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Recent Alerts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "sensor\_id(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)" nodrop<br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "timestamp(?:\\"\\:\\"\|=')(?\<timestamp\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "os\_type(?:\\"\\:\\"\|=')(?\<os\_type\>.\*?)(?:\\"\|')" multi nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where ioc\_type != "" and (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count by sensor\_id, group, hostname, ioc\_type, feed\_name, \_messageTime, timestamp, os\_type,status, watchlist\_name <br />\| sort by \_count, \_messageTime<br />\| formatDate(fromMillis(\_messagetime), "MM-dd-yyyy HH:mm:ss") as alert\_date<br />\| fields alert\_date, sensor\_id, group, hostname, ioc\_type, feed\_name, os\_type,status, watchlist\_name <br />\| fields - \_messageTime<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Recent Policy Actions|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1  nodrop //Defense Source and syslog-forwarder<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}")<br />\| where (type = "POLICY\_ACTION" or (policy\_applied = "APPLIED" and (sensor\_action = "DENY" or sensor\_action = "TERMINATE")))<br />\| concat(Application1,Application2) as Application<br />\| concat(Reputation1,Reputation2) as Reputation<br />\| concat(url1,url2) as url<br />\| concat(Device1, Device2) as Device<br />\| concat(User1, User2) as User<br />\| concat(DeviceGroup1,DeviceGroup2) as DeviceGroup<br />\| concat(Device\_OS1, Device\_OS2) as Device\_OS<br />\| concat(eventTime1,eventTime2) as eventTime<br />\| where !isBlank(EventTime)<br />//\| formatDate(fromMillis(eventTime), "MM-dd-yyyy HH:mm:ss") as EventTime <br />\| count by EventTime, Application,Reputation, url, Device, User, Device\_OS<br />\| fields - \_count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|RegMod Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:regmod\_count)(?:\\"\\:\|=')(?\<regmod\_count\>.\*?)(?:,\|')" multi<br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}" and regmod\_count \> 0<br />\| count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Remote IP Distribution|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:remote\_ip)(?:\\"\\:\\"\|=')(?\<remote\_ip\>.\*?)(?:\\"\|')" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| where !isBlank(postal\_code)<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Sensor OS Breakdown|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:sensor\_id)(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)"<br />\| parse regex "(?:os\_type)(?:\\"\\:\\"\|=')(?\<os\_type\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| toLowerCase(os\_type) as os\_type<br />\| count\_distinct(sensor\_id) by os\_type|
|Carbon Black/Carbon Black Endpoint Detection and Response|Sensors|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:sensor\_id)(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(sensor\_id)|
|Carbon Black/Carbon Black Endpoint Detection and Response|Sensors 24h|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:sensor\_id)(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(sensor\_id)|
|Carbon Black/Carbon Black Endpoint Detection and Response|Sensors 30d|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:sensor\_id)(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(sensor\_id)|
|Carbon Black/Carbon Black Endpoint Detection and Response|Sensors 7d|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:sensor\_id)(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(sensor\_id)|
|Carbon Black/Carbon Black Endpoint Detection and Response|Sensors not Reporting in last 7 days|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Sensors|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:sensor\_id)(?:\\"\\:\|=)(?\<sensor\_id\>.\*?)(?:,\|\\s)"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />// Find the most recent sensor message by hostname (gives the last time it reported) <br />\| first(\_messageTime) as last\_event by sensor\_id<br />\| sort by last\_event<br />// Filter down to sensors reporting over 7 days ago<br />\| where last\_event \< (now() - (86400 \* 1000 \* 7)) <br />\| formatDate(last\_event, "dd/MM/yyyy HH:mm:ss:SSS Z") as last\_event<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Tampering Processes Observed|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  ingress.event.tamper<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\|count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threat Score Box Plot by Feed|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')"<br />\| toInt(alliance\_score)<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and alliance\_score \>= 0<br />\| min(alliance\_score), max(alliance\_score), pct(alliance\_score,25,50,75) BY feed\_name<br />\| sort BY feed\_name|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threat Scores by Feed|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and alliance\_score \>= 0<br />\| toInt(alliance\_score)<br />\| if(alliance\_score \> 0 AND alliance\_score \< 11, "0 - 10", "N/A") AS %"Threat Score"<br />\| if(alliance\_score \> 10 AND alliance\_score \< 21, "11 - 20", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 20 AND alliance\_score \< 31, "21 - 30", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 30 AND alliance\_score \< 41, "31 - 40", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 40 AND alliance\_score \< 51, "41 - 50", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 50 AND alliance\_score \< 61, "51 - 60", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 60 AND alliance\_score \< 71, "61 - 70", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 70 AND alliance\_score \< 81, "71 - 80", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 80 AND alliance\_score \< 91, "81 - 90", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 90, "91 - 100", %"Threat Score") AS %"Threat Score"<br />\| count AS threats BY %"Threat Score", feed\_name<br />\| transpose row %"Threat Score" column feed\_name|
|Carbon Black/Carbon Black Endpoint Standard|Threats|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "severity" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, ActualSeverity2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}") <br />\| where (Severity1 = "Threat" or Severity2 ="WARNING" or Severity2 ="THREAT")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| count<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Threats|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}") <br />\| where (Severity1 = "Threat" or Severity2 ="WARNING" or Severity2 ="THREAT")<br />\| count<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threats by Feed and Score|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "alliance\_link\_\\w+(?:\\"\\:\\"\|=')(?\<alliance\_link\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and alliance\_score \>= 0<br />\| toInt(alliance\_score)<br />\| replace(alliance\_link, "\\\\u0026", "&") as final\_url<br />\| tourl(final\_url,feed\_name) AS %"Threat Intel Feed"<br />\| alliance\_score AS %"Threat Score"<br />\| count AS %"Count", count\_distinct(hostname) AS %"Distinct Host(s)" BY %"Threat Intel Feed", %"Threat Score"<br />\| sort BY %"Threat Score", count<br />\| fields %"Threat Score", %"Threat Intel Feed", count, %"Distinct Host(s)"  |
|Carbon Black/Carbon Black Endpoint Detection and Response|Threats by Feeds|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| toInt(alliance\_score)<br />\| where alliance\_score \>= 0<br />\| count AS %"Threats Detected" BY feed\_name<br />\| sort BY %"Threats Detected"|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threats by Feeds over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "alliance\_link\_\\w+(?:\\"\\:\\"\|=')(?\<alliance\_link\>.\*?)(?:\\"\|')" <br />\| int(alliance\_score)<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and alliance\_score \>= 0<br />\| timeslice 30m<br />\| count AS %"Threats Detected" BY \_timeslice, feed\_name<br />\| transpose row \_timeslice column feed\_name|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threats by Score|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and alliance\_score \>= 0<br />\| toInt(alliance\_score)<br />\| if(alliance\_score \> 0 AND alliance\_score \< 11, "0 - 10", "N/A") AS %"Threat Score"<br />\| if(alliance\_score \> 10 AND alliance\_score \< 21, "11 - 20", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 20 AND alliance\_score \< 31, "21 - 30", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 30 AND alliance\_score \< 41, "31 - 40", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 40 AND alliance\_score \< 51, "41 - 50", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 50 AND alliance\_score \< 61, "51 - 60", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 60 AND alliance\_score \< 71, "61 - 70", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 70 AND alliance\_score \< 81, "71 - 80", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 80 AND alliance\_score \< 91, "81 - 90", %"Threat Score") AS %"Threat Score"<br />\| if(alliance\_score \> 90, "91 - 100", %"Threat Score") AS %"Threat Score"<br />\| count AS %"Threats Detected" BY %"Threat Score"<br />\| sort BY +%"Threat Score"|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threats by Severity|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<score\>-?\\d+)"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and score \>= 0<br />\| toInt(score)<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| count AS %"Threats Detected" BY Severity<br />\| sort BY +Severity|
|Carbon Black/Carbon Black Endpoint Standard|Threats by Severity|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  ((Severity1 = "Threat" and toInt(Score) \>=0) or Severity2 ="WARNING" or Severity2 ="THREAT") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}" and !isBlank(Severity)<br />\| count AS %"Threats Detected" BY Severity<br />\| sort BY +Severity<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threats Detected|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "alliance\_link\_\\w+(?:\\"\\:\\"\|=')(?\<alliance\_link\>.\*?)(?:\\"\|')"  <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| toInt(alliance\_score)<br />\| where alliance\_score \>= 0<br />\| count AS %"Threats Detected"|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threats Detected|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "alliance\_link\_\\w+(?:\\"\\:\\"\|=')(?\<alliance\_link\>.\*?)(?:\\"\|')"  <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| toInt(alliance\_score)<br />\| where alliance\_score \>= 0<br />\| count AS %"Threats Detected"|
|Carbon Black/Carbon Black Endpoint Detection and Response|Threats Outlier|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"  <br />\| toInt(alliance\_score)<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and alliance\_score \>= 0<br />\| timeslice 15m<br />\| count as Threats by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier Threats|
|Carbon Black/Carbon Black Endpoint Standard|Threats Outlier|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}") <br />\| where (Severity1 = "Threat" or Severity2 ="WARNING" or Severity2 ="THREAT")<br />\| timeslice 15m<br />\| count as Threats by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier Threats<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Top Applications|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_indicators[\*].process\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "threatInfo.indicators[\*].applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" ) and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| extract field=Application1 "\\"(?\<Applications1\>.\*?)\\"(,\|\\])" multi nodrop<br />\| extract field=Application2 "\\"(?\<Applications2\>.\*?)\\"(,\|\\])" multi nodrop<br />\| concat(Applications1,Applications2) as Applications<br />\| where !isBlank(Applications)<br />\| count by Applications<br />\| order by \_count|
|Carbon Black/Carbon Black Endpoint Standard|Top Devices|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device)<br />\| count by Device<br />\| order by \_count<br />\| limit 10<br /><br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Top Devices - Multiple Critical Threats|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and  ((Severity1 = "Threat" and toInt(Score) \>=0) or Severity2 ="WARNING" or Severity2 ="THREAT") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}" )<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity = "Critical"<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device)<br />\| count as UniqueThreats by Device <br />\| top 10 Device by UniqueThreats, Device asc<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Top Devices Affected|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}") <br />\| where (Severity1 = "Threat" or Severity2 ="WARNING" or Severity2 ="THREAT")<br />\| concat(Device1,Device2) as Device<br />\| where !isBlank(Device)<br />\| count(Device) by Device<br />\| sort by \_count<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Feeds|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop <br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| timeslice 15m<br />\| count by feed\_name<br />\| sort by \_count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top FileMod Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:filemod\_count)(?:\\"\\:\|=')(?\<filemod\_count\>.\*?)(?:,\|')" multi<br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| num(filemod\_count)<br />\| sum(filemod\_count) as total\_count group by process\_name<br />\| sort by total\_count<br />\| limit 10<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Groups|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:group)(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count by group<br />\| sort by \_count<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Hosts - High Avg Score Threats|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<alliance\_score\>-?\\d+)"<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and alliance\_score \>= 0<br />\| toInt(alliance\_score)<br />\| count as UniqueThreats, sum(alliance\_score) as totalScore, avg(alliance\_score) as %"Avg Score" by hostname <br />\| top 10 hostname by %"Avg Score", UniqueThreats, hostname asc|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Hosts - Multiple Critical Threats|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<score\>-?\\d+)"<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and score \>= 0<br />\| toInt(score)<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| where Severity="Critical"<br />\| count as UniqueThreats by hostname <br />\| top 10 hostname by UniqueThreats, hostname asc|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Hosts Affected|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and ioc\_type != ""<br />\| count(hostname) by hostname<br />\| sort by \_count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Hosts by Alerts Fired|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and hostname matches "\*"<br />\| count\_frequent(hostname) <br />\| limit 10|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Hosts by Inbound Alerts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:direction)(?:\\"\\:\\"\|=')(?\<direction\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" \| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and direction = "Inbound"<br />\| count by hostname<br />\| topk(10, \_count)|
|Carbon Black/Carbon Black Endpoint Standard|Top Hosts with Malware Attacks|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Threat Intelligence|\_sourceCategory={{EndpointStandardEventsSource}}  DETECTED\_MALWARE\_APP<br />\| json field=\_raw "deviceInfo.deviceName", "device\_name" as Device1, Device2 nodrop<br />\| concat(Device1, Device2) as Device<br />\| count by Device<br />\| top 10 device by \_count<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Hosts with Outbound Alerts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:direction)(?:\\"\\:\\"\|=')(?\<direction\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" \| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and direction = "Outbound"<br />\| count by hostname<br />\| topk(10, \_count)|
|Carbon Black/Carbon Black Endpoint Standard|Top Indicators|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json "threat\_indicators[\*].ttps" as threatInfo\_indicators1 nodrop<br />\| json "threatInfo.indicators[\*].indicatorName" as threatInfo\_indicators2 nodrop<br />\| extract field=threatInfo\_indicators1 "\\"(?\<Indicators1\>.\*?)\\"(,\|\\])" multi nodrop<br />\| extract field=threatInfo\_indicators2 "\\"(?\<Indicators2\>.\*?)\\"(,\|\\])" multi nodrop<br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os", "device\_external\_ip", "policy\_applied","sensor\_action", "threat\_cause\_actor\_name", "threat\_cause\_reputation", "alert\_url", "create\_time", "severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, threatIP2, policy\_applied, sensor\_action, Application2, Reputation2, url2, eventTime2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "deviceInfo.externalIpAddress", "type", "policyAction.applicationName", "policyAction.reputation", "url", "eventTime", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score,threatIP1,type,Application1,Reputation1, url1, eventTime1, reason1  nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| json "type" nodrop<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| where (toInt(Score) \>=0 or int(ActualSeverity2) \>= 0) and (!isBlank(Indicators1) or !isBlank(Indicators2)) and (type = "CB\_ANALYTICS" or type = "POLICY\_ACTION" or type = "THREAT") and (!isBlank(Indicators1) or !isBlank(Indicators2))<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| concat(Device1,Device2) as Device<br />\| concat(user1,User2) as User<br />\| concat(Incident\_ID1,Incident\_ID2) as Incident\_ID<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| concat(Indicators1, Indicators2) as Indicators<br />\| where !isBlank(Indicators)<br />\| count by Indicators<br />\| order by \_count<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top IOC DNSs|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  "dns"<br />\| parse regex "(?:dns\_name\|ioc\_value)(?:\\"\\:\\"\|=')(?\<dns\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and ioc\_type = "dns" <br />\| count\_frequent dns\_name<br />\| limit 10|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top IOC MD5s|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  "md5"<br />\| parse regex "(?:md5\|ioc\_value)(?:\\"\\:\\"\|=')(?\<md5\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and ioc\_type = "md5" <br />\| count\_frequent md5<br />\| limit 10|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top IOC Process and Binary Queries|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:ioc\_query\_string\|search\_query)(?:\\"\\:\\s\\"cb\\.urlver=1&q=\|\\"\\:\\")(?\<search\_query\>.\*?)(?:\\")" nodrop<br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}")  and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and ioc\_type = "query" <br />and (isBlank(hostname) or hostname matches "{{Host\_Name}}")<br />\| count\_frequent search\_query<br />\| limit 10|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top IOC Query Based Feeds|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  "class"<br />\| parse regex "(?:class\|ioc\_value)(?:\\"\\:\\"\|=')(?\<class\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}")  and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and ioc\_type = "class" <br />\| count\_frequent class<br />\| limit 10|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top IOC's|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')"<br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_frequent ioc\_type|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top IOCs|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:ioc\_type)(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_frequent ioc\_type<br />\| limit 10|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Local Ports|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:local\_port\|srcPort)(?:\\"\\:\\"\|=')(?\<local\_port\>.\*?)(?:\\"\|')"  <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br /> and num(local\_port) \<\> 0<br />\| count by local\_port<br />\| top 5 local\_port by \_count<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Malicious IPv4 Addresses|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Indicators of Compromise|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "ioc\_value(?:\\"\\:\\"\|=')(?\<malicious\_ip\>.\*?)(?:\\"\|')" nodrop <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where ioc\_type = "ipv4" and (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = malicious\_ip<br />\| count by  malicious\_ip, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top OS|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:os\_type)(?:\\"\\:\\"\|=')(?\<os\_type\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count(os\_type) by os\_type<br />\| sort by \_count<br />\| limit 10<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Parent Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   parent\_name<br />\| parse regex "(?:parent\_name)(?:\\"\\:\\"\|%3A)(?\<parent\_name\>.\*?)(?:\\"\|%20)" multi<br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and parent\_name matches "{{Parent\_Process\_Name}}" and process\_name matches "{{Process\_Name}}"<br />\| count parent\_name<br />\| sort by \_count<br />\| limit 10<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Paths|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<score\>-?\\d+)"<br />\| parse regex "(?:path)(?:\\"\\:\\"\|=')(?\<path\>.\*?)(?:\\"\|')" multi<br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and score \>= 0 and process\_name matches "{{Process\_Name}}"<br />\| toInt(score)<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| count by path<br />\| top 20 path by \_count, path<br /> |
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}"<br />\| count by process\_name<br />\| sort by \_count<br />\| limit 10<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}"<br />\| count by process\_name<br />\| sort by \_count<br />\| limit 10<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Processes  by Feed|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Feeds|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "process\_name(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_frequent process\_name, feed\_name<br />\| limit 10<br /><br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Processes by Host|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}" and !(isBlank(hostname)) <br />\| count(process\_name) by hostname<br />\| sort by \_count<br />\| limit 10<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Protocols|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:proto\|protocol)(?:\\"\\:\\"\|=')(?\<protocol\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count by protocol<br />\| top 5 protocol by \_count<br />|
|Carbon Black/Carbon Black Endpoint Standard|Top Reasons|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os","severity", "reason\_code" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, ActualSeverity2, reason2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score", "threatInfo.summary" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score, reason1 nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| concat(reason1,reason2) as Reason<br />\| where !isBlank(Reason)<br />\| count by Reason<br />\| order by \_count<br />\| limit 10<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top RegMod Processes|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Processes|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:regmod\_count)(?:\\"\\:\|=')(?\<regmod\_count\>.\*?)(?:,\|')" multi<br />\| parse regex "(?:process\_name)(?:\\"\\:\\"\|=')(?\<process\_name\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and process\_name matches "{{Process\_Name}}"<br />\| num(regmod\_count)<br />\| sum(regmod\_count) as total\_count group by process\_name<br />\| sort by total\_count<br />\| limit 10<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Remote Ports|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:dstPort\|remote\_port)(?:\\"\\:\\"\|=')(?\<remote\_port\>.\*?)(?:\\"\|')"  <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| where num(remote\_port) \<\> 0<br />\| count by remote\_port<br />\| top 5 remote\_port by \_count<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Scores|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Threat Intelligence|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:\\",\\"\|\\s)alliance\_score\_(?:.\*?)(?:\\"\\:\|=')(?\<score\>-?\\d+)"<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*") and score \>= 0<br />\| toInt(score)<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", "Informational")))) as Severity <br />\| count\_distinct(hostname) as UniqueHosts by score<br />\| top 25 score by score, UniqueHosts<br /> |
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Threat Feeds|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:feed\_name)(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count by feed\_name<br />\| sort by \_count|
|Carbon Black/Carbon Black Endpoint Standard|Top Users|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os","severity" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, ActualSeverity2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| concat(User1,User2) as User<br />\| where !isBlank(User)<br />\| count by User<br />\| sort by \_count<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Users by Alerts Fired|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:username)(?:\\"\\:\\"\|=')(?\<username\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_frequent(username) <br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Users by Alerts Fired|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:username)(?:\\"\\:\\"\|=')(?\<username\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_frequent(username) <br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Watchlists|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_frequent(watchlist\_name)|
|Carbon Black/Carbon Black Endpoint Detection and Response|Top Watchlists|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and watchlist\_name matches "\*"<br />\| timeslice 15m<br />\| count\_frequent(watchlist\_name)<br />\| limit 15|
|Carbon Black/Carbon Black Endpoint Detection and Response|Unique Comms IP's|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:comms\_ip)(?:\\"\\:\\"\|=')(?\<comms\_ip\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches Status)<br />\| count\_distinct(comms\_ip) <br />\| sort \_count\_distinct<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Unique Hosts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(hostname)|
|Carbon Black/Carbon Black Endpoint Detection and Response|Unique Hosts|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(hostname)|
|Carbon Black/Carbon Black Endpoint Standard|Unique Indicators|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Indicators of Compromise|\_sourceCategory={{EndpointStandardEventsSource}}  <br />\| json "threat\_indicators[\*].ttps" as threatInfo\_indicators1 nodrop<br />\| json "threatInfo.indicators[\*].indicatorName" as threatInfo\_indicators2 nodrop<br />\| extract field=threatInfo\_indicators1 "\\"(?\<Indicators1\>.\*?)\\"(,\|\\])" multi nodrop<br />\| extract field=threatInfo\_indicators2 "\\"(?\<Indicators2\>.\*?)\\"(,\|\\])" multi nodrop<br />\| json "type" nodrop<br />\| if(isNull(type),"NonS3Data",type) as type<br />\| where (type = "CB\_ANALYTICS" or type = "NonS3Data" or type = "POLICY\_ACTION" or type = "THREAT") and (!isBlank(Indicators1) or !isBlank(Indicators2))<br />\| concat(Indicators1, Indicators2) as Indicators<br />\| where !isBlank(Indicators)<br />\| count\_distinct(Indicators) <br /><br /><br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Unique Interface IP's|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:interface\_ip)(?:\\"\\:\\"\|=')(?\<interface\_ip\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(interface\_ip) <br />\| sort \_count\_distinct<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Unique Remote IP's|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Network|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:remote\_ip)(?:\\"\\:\\"\|=')(?\<remote\_ip\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(remote\_ip) <br />\| sort \_count\_distinct<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Unique Users|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:username)(?:\\"\\:\\"\|=')(?\<username\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct (username) <br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Unique Users|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:username)(?:\\"\\:\\"\|=')(?\<username\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct (username) <br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|User Alerts Over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - User and Host Alerts|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  <br />\| parse regex "(?:username)(?:\\"\\:\\"\|=')(?\<username\>.\*?)(?:\\"\|')" multi<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| timeslice 15m<br />\| count(username) as us\_count by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier us\_count<br /><br />|
|Carbon Black/Carbon Black Endpoint Standard|Users|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Standard/Carbon Black - Endpoint Standard - Overview|\_sourceCategory={{EndpointStandardEventsSource}} <br />\| json field=\_raw "category","device\_name","device\_username", "target\_value", "device\_group", "threat\_id", "device\_os","severity" as Severity2, Device2, User2,Target\_Priority2, DeviceGroup2, Incident\_ID2, Device\_OS2, ActualSeverity2 nodrop //s3<br />\| json field=\_raw "eventDescription", "deviceInfo.deviceName", "deviceInfo.email", "deviceInfo.targetPriorityType", "deviceInfo.groupName", "deviceInfo.deviceType", "threatInfo.incidentId", "ruleName", "threatInfo.score" as description, Device1, User1, Target\_Priority1, DeviceGroup1, Device\_OS1, Incident\_ID1, Rule, Score nodrop //Defense Source and syslog-forwarder<br />\| parse field=description "[Severity: \*]" as Severity1 nodrop<br />\| where (Device1 matches "{{Device}}" or Device2 matches "{{Device}}") and (User1 matches "{{User}}" or User2 matches "{{User}}") and (Incident\_ID1 matches "{{Incident\_ID}}" or Incident\_ID2 matches "{{Incident\_ID}}") and (Target\_Priority1 matches "{{Target\_Priority}}" or Target\_Priority2 matches "{{Target\_Priority}}")<br />\| if (isNull(Score), -1, Score) as Score<br />\| if (isNull(ActualSeverity2), -1, ActualSeverity2) as ActualSeverity2<br />\| if (int(score) \>= 80 , "Critical", if (int(score) \>= 60 , "High", if (int(score) \>= 40 , "Medium", if (int(score) \>= 20 , "Low", if (int(score) =-1, "", "Informational"))))) as ActualSeverity1 <br />\| if (int(ActualSeverity2) \>= 8, "Critical", if (int(ActualSeverity2) \>= 6, "High", if (int(ActualSeverity2) \>= 4, "Medium", if (int(ActualSeverity2) \>= 2,"Low", if (int(ActualSeverity2) =-1, "", "Informational"))))) as ActualSeverity2<br />\| concat(ActualSeverity1, ActualSeverity2) as Severity <br />\| where Severity matches "{{Severity}}"<br />\| concat(User1,User2) as User<br />\| where !isBlank(User)<br />\| count\_distinct(User)<br /><br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Watchlist Comparison over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "watchlist\_name(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and watchlist\_name matches "\*"<br />\| count by watchlist\_name<br />\| compare with timeshift 1d 7<br />|
|Carbon Black/Carbon Black Endpoint Detection and Response|Watchlist Hits by Name over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists|\_sourceCategory={{EndpointDetectionandResponseEventsSource}} <br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and watchlist\_name matches "\*"\| timeslice 15m<br />\| count by \_timeslice, watchlist\_name<br />\| transpose row \_timeslice column watchlist\_name|
|Carbon Black/Carbon Black Endpoint Detection and Response|Watchlist Hits by Type over Time|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}  ("watchlist.hit")<br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')" <br />\| parse regex "(?:alert\_type)(?:\\"\\:\\"\|=)(?\<alert\_type\>.\*?)(?:\\"\|\\s)" <br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />and watchlist\_name matches "\*"<br />\| timeslice 15m<br />\| count by alert\_type, \_timeslice<br />\| fillmissing timeslice(15m) in \_timeslice, values("watchlist.hit.ingress.process","watchlist.hit.query.process", "alert.watchlist.hit.ingress.host", "alert.watchlist.hit.ingress.binary", "alert.watchlist.hit.query.binary") in alert\_type <br />\| transpose row \_timeslice column alert\_type|
|Carbon Black/Carbon Black Endpoint Detection and Response|Watchlists|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Overview|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "{{Host\_Name}}") and (isBlank(ioc\_type) or ioc\_type matches "{{IOC\_Type}}") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "{{Watchlist\_Name}}") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(watchlist\_name)|
|Carbon Black/Carbon Black Endpoint Detection and Response|Watchlists|Logs|Installed Apps/Carbon Black/Carbon Black Endpoint Detection and Response/Carbon Black - EDR - Watchlists|\_sourceCategory={{EndpointDetectionandResponseEventsSource}}   <br />\| parse regex "(?:watchlist\_name)(?:\\"\\:\\"\|=')(?\<watchlist\_name\>.\*?)(?:\\"\|')"<br />\| parse regex "ioc\_type(?:\\"\\:\\"\|=')(?\<ioc\_type\>.\*?)(?:\\"\|')" nodrop  <br />\| parse regex "feed\_name(?:\\"\\:\\"\|=')(?\<feed\_name\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "group(?:\\"\\:\\"\|=')(?\<group\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "(?:hostname\|host)(?:\\"\\:\\"\|=')(?\<hostname\>.\*?)(?:\\"\|')" nodrop<br />\| parse regex "status(?:\\"\\:\\"\|=')(?\<status\>.\*?)(?:\\"\|')" nodrop<br />\| where (isBlank(hostname) or hostname matches "\*") and (isBlank(ioc\_type) or ioc\_type matches "\*") and (isBlank(feed\_name) or feed\_name matches "\*") and (isBlank(watchlist\_name) or watchlist\_name matches "\*") and (isBlank(group) or group matches "\*") and (isBlank(status) or status matches "\*")<br />\| count\_distinct(watchlist\_name)|

