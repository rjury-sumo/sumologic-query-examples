# Azure App Service Plan

## Searches

### Log Searches

- **Distribution  by Operation Type (Read, Write and Delete)**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations 
- **Distribution by Operations**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations 
- **Recent Delete Operations**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations 
- **Recent Write Operations**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations 
- **Top 10 operations that caused the most errors**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations 
- **Users / Applications by Operation type**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations

### Metric Searches

- **Cpu Percentage**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation 
- **Cpu Percentage**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview 
- **Cpu Percentage Trend**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation 
- **Data In**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network 
- **Data In**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview 
- **Data Out**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network 
- **Data Out**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview 
- **Disk QueueLength**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation 
- **Disk QueueLength Trend**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation 
- **Established vs Closing TCP State**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network 
- **Http QueueLength**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation 
- **Http QueueLength Trend**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation 
- **Inbound vs Outbound Socket Count**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network 
- **Memory Percentage**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation 
- **Memory Percentage**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview 
- **Memory Percentage Trend**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation 
- **Outbound Socket State**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network 
- **Socket By TCP Client State**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network 
- **Socket By TCP Server State**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network 
- **Top 10 Resources by Inbound Socket Count**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview 
- **Top 10 Resources by Outbound Socket Count**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview 
- **Top 10 Resources by TCP Established Connection**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview 
- **Total App Service Plans**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview 
- **Total Data In**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network 
- **Total Data Out**: from Dashboard: Installed Apps/Azure App Service Plan/Azure App Service Plan - Network

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Azure App Service Plan|Cpu Percentage|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=CpuPercentage statistic =average<br />\| quantize using max<br />\| max by resource\_name, resource\_group|
|Azure App Service Plan|Cpu Percentage|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}}  metric=CpuPercentage statistic=average<br />\| avg|
|Azure App Service Plan|Cpu Percentage Trend|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=CpuPercentage statistic =average<br />\| avg by resource\_name, resource\_group|
|Azure App Service Plan|Data In|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=BytesReceived statistic=total<br />\| quantize using sum<br />\| sum by resource\_group, resource\_name |
|Azure App Service Plan|Data In|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=BytesReceived statistic=total \| quantize using sum|
|Azure App Service Plan|Data Out|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=BytesSent statistic=total<br />\| quantize using sum<br />\| sum by resource\_group, resource\_name |
|Azure App Service Plan|Data Out|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=BytesSent statistic=total  \| quantize using sum|
|Azure App Service Plan|Disk QueueLength|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}}  metric=DiskQueueLength statistic=average <br />\| quantize using sum<br />\| avg|
|Azure App Service Plan|Disk QueueLength Trend|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=DiskQueueLength statistic =average<br />\| avg by resource\_name, resource\_group|
|Azure App Service Plan|Distribution  by Operation Type (Read, Write and Delete)|Logs|Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} <br /> provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative"<br />\| "OTHERS" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by operationType<br />\| sort by \_count|
|Azure App Service Plan|Distribution by Operations|Logs|Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative" <br />\| count by operationName<br />\| order by \_count|
|Azure App Service Plan|Established vs Closing TCP State|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} (metric=TcpClosing or metric=TcpEstablished) statistic=average<br />\| quantize to 10m using sum<br />\| sum by metric,resource\_group, resource\_name |
|Azure App Service Plan|Http QueueLength|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}}  metric=HttpQueueLength statistic=average<br />\| quantize using sum<br />\| avg|
|Azure App Service Plan|Http QueueLength Trend|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=HttpQueueLength statistic =average<br />\| avg by resource\_name, resource\_group|
|Azure App Service Plan|Inbound vs Outbound Socket Count|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} (metric=SocketInboundAll or metric=SocketOutboundAll)  statistic=average<br />\| quantize using sum<br />\| sum by resource\_group, resource\_name, metric|
|Azure App Service Plan|Memory Percentage|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}}  metric=MemoryPercentage statistic=average<br />\| avg|
|Azure App Service Plan|Memory Percentage|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=MemoryPercentage statistic =average<br />\| quantize using max<br />\| max by resource\_name, resource\_group|
|Azure App Service Plan|Memory Percentage Trend|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Resource Utilisation|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=MemoryPercentage statistic =average<br />\| avg by resource\_name, resource\_group|
|Azure App Service Plan|Outbound Socket State|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} (metric=SocketOutboundTimeWait or metric=SocketOutboundEstablished)  statistic=average<br />\| quantize to 10m using sum<br />\| sum by resource\_group, resource\_name, metric|
|Azure App Service Plan|Recent Delete Operations|Logs|Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "properties.entity", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, entity, identity\_claims\_name, authmethods nodrop<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative"and toUppercase(operationName) matches /DELETE/ <br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message, entity<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure App Service Plan|Recent Write Operations|Logs|Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']"  as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, identity\_claims\_name, authmethods nodrop<br />\| where resultType in ("Accept", "Success") and category="Administrative" and toUppercase(operationName) matches /WRITE/<br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message, resultType<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure App Service Plan|Socket By TCP Client State|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} (metric=TcpFinWait1 or metric=TcpFinWait2 or metric=TcpSynSent or metric=TcpTimeWait) statistic=average<br />\| quantize to 10m using sum<br />\| sum by metric,resource\_group, resource\_name |
|Azure App Service Plan|Socket By TCP Server State|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} (metric=TcpCloseWait or metric=TcpLastAck or metric=TcpSynReceived) statistic=average<br />\| quantize to 10m using sum<br />\| sum by metric,resource\_group, resource\_name |
|Azure App Service Plan|Top 10 operations that caused the most errors|Logs|Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}   provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| json "resultType", "operationName", "properties.statusMessage", "category"  as resultType, operationName, failureMessage, category<br />\| where category="Administrative" and resultType="Failure"<br />\| count as Count by resource\_name, operationname, failureMessage<br />\| order by Count <br />\| limit 10|
|Azure App Service Plan|Top 10 Resources by Inbound Socket Count|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=SocketInboundAll  statistic=average<br />\| quantize using sum<br />\| sum by resource\_group, resource\_name, metric<br />\| topk(10, sum)|
|Azure App Service Plan|Top 10 Resources by Outbound Socket Count|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=SocketOutboundAll  statistic=average<br />\| quantize using sum<br />\| sum by resource\_group, resource\_name, metric<br />\| topk(10, sum)|
|Azure App Service Plan|Top 10 Resources by TCP Established Connection|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=TcpEstablished statistic=average<br />\| sum by resource\_group, resource\_name<br />\| topk(10, sum) |
|Azure App Service Plan|Total App Service Plans|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=CpuPercentage statistic=average<br />\| count by resource\_name <br />\| count|
|Azure App Service Plan|Total Data In|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=BytesReceived statistic=total<br />\| quantize using sum<br />\| sum<br />\| eval \_value/(1024\*1024)|
|Azure App Service Plan|Total Data Out|Metrics|Installed Apps/Azure App Service Plan/Azure App Service Plan - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=serverfarms  resource\_name={{resource\_name}} metric=BytesSent statistic=total<br />\| quantize using sum<br />\| sum<br />\| eval \_value/(1024\*1024)|
|Azure App Service Plan|Users / Applications by Operation type|Logs|Installed Apps/Azure App Service Plan/Azure App Service Plan - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid nodrop<br />\| where resultType in ("Accept", "Success") and category="Administrative"<br />\| if (idtyp =="user", name, appid) as name<br />\| "Others" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by name, operationType<br />\| transpose row name column operationType|

