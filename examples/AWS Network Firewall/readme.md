# AWS Network Firewall
## Sumo Logic App For: AWS Network Firewall
The AWS Network Firewall application provides visibility into traffic flows and alerts generated by AWS Network Firewall.
Docs Link: [AWS Network Firewall](https://help.sumologic.com/?cid=9006)

## Searches

### Log Searches

- **Blocked vs Allowed Over Time**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **High Severity Events**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **IDS Signatures Over Time**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **Outbound Bytes**: from Dashboard: AWS Network Firewall/AWS Network Firewall - Netflow Overview 
- **Outlier - Total IDS Alerts**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **Threat Intel Hits**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **Top 10 Blocked Destination IP**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **Top 10 Blocked Source IP**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **Top 10 Connection**: from Dashboard: AWS Network Firewall/AWS Network Firewall - Netflow Overview 
- **Top 10 Signature**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **Top Alert Destinations by Geo location**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **Top Destination by Geolocation**: from Dashboard: AWS Network Firewall/AWS Network Firewall - Netflow Overview 
- **Total Alerts**: from Dashboard: AWS Network Firewall/AWS Network Firewall - IDS Overview 
- **Traffic By Application**: from Dashboard: AWS Network Firewall/AWS Network Firewall - Netflow Overview 
- **Traffic By Protocol**: from Dashboard: AWS Network Firewall/AWS Network Firewall - Netflow Overview 
- **Traffic Over Time**: from Dashboard: AWS Network Firewall/AWS Network Firewall - Netflow Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|AWS Network Firewall|Blocked vs Allowed Over Time|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* alert <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "alert" nodrop<br />\| where event\_type="alert"<br />\| json field=alert "severity", "signature", "action", "category" nodrop<br />\| timeslice 15m<br />\| count \_timeslice, action<br />\| transpose row \_timeslice column action|
|AWS Network Firewall|High Severity Events|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "app\_proto", "proto", "alert" nodrop<br />\| where event\_type="alert"<br />\| json field=alert "severity", "signature", "action", "category" nodrop<br />\| where severity\<=3<br />\| formatDate(\_messagetime, "MM/dd/yyyy hh:mm:ss") as date<br />\| count date, action, signature, app\_proto, severity,src\_ip, src\_port, dest\_ip, dest\_port, proto <br />\| sort date<br />\| fields - \_count|
|AWS Network Firewall|IDS Signatures Over Time|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "app\_proto", "proto", "alert" nodrop<br />\| where event\_type="alert"<br />\| json field=alert "severity", "signature", "action", "category" nodrop<br />\| timeslice 15m<br />\| count by \_timeslice, signature <br />\| transpose row \_timeslice column signature|
|AWS Network Firewall|Outbound Bytes|Logs|AWS Network Firewall/AWS Network Firewall - Netflow Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "app\_proto", "netflow" nodrop<br />\| json field=netflow "bytes", "pkts" nodrop<br />\| where isPublicIp(dest\_ip)<br />\| where event\_type="netflow"<br />\| timeslice 15m<br />\| sum(bytes) by \_timeslice|
|AWS Network Firewall|Outlier - Total IDS Alerts|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "app\_proto", "proto", "alert" nodrop<br />\| where event\_type="alert"<br />\| json field=alert "severity", "signature", "action", "category" nodrop<br />\| timeslice 1h<br />\| count by \_timeslice<br />\| outlier \_count direction=+|
|AWS Network Firewall|Threat Intel Hits|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "app\_proto", "proto", "alert" nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| where type="ip\_address" and !isNull(malicious\_confidence) <br />\| if (isEmpty(actor), "Unassigned", actor) as Actor <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name <br />\| replace(label\_name, "\\""," ") as label\_name<br />\| timeslice 1m <br />\| count as hits by \_timeslice,dest\_ip, malicious\_confidence, actor, label\_name, \_raw|
|AWS Network Firewall|Top 10 Blocked Destination IP|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "alert" nodrop<br />\| where event\_type="alert"<br />\| json field=alert "severity", "signature", "action", "category" nodrop<br />\| where action="blocked"<br />\| count dest\_ip, proto <br />\| top 10 dest\_ip, proto by \_count|
|AWS Network Firewall|Top 10 Blocked Source IP|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "alert" nodrop<br />\| where event\_type="alert"<br />\| json field=alert "severity", "signature", "action", "category" nodrop<br />\| where action="blocked"<br />\| count src\_ip, proto <br />\| top 10 src\_ip, proto by \_count|
|AWS Network Firewall|Top 10 Connection|Logs|AWS Network Firewall/AWS Network Firewall - Netflow Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "app\_proto", "netflow" nodrop<br />\| json field=netflow "bytes", "pkts" nodrop<br />\| where event\_type="netflow"<br />\| count src\_ip, dest\_ip, dest\_port<br />\| top 10 src\_ip, dest\_ip, dest\_port by \_count|
|AWS Network Firewall|Top 10 Signature|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "alert" nodrop<br />\| where event\_type="alert"<br />\| json field=alert "severity", "signature", "action", "category" nodrop<br />\| count signature<br />\| top 10 signature by \_count|
|AWS Network Firewall|Top Alert Destinations by Geo location|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "app\_proto", "proto", "alert" nodrop \| where event\_type = "alert"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = dest\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|AWS Network Firewall|Top Destination by Geolocation|Logs|AWS Network Firewall/AWS Network Firewall - Netflow Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "app\_proto", "proto", "alert" nodrop <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = dest\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|AWS Network Firewall|Total Alerts|Logs|AWS Network Firewall/AWS Network Firewall - IDS Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "alert" nodrop<br />\| where event\_type="alert"<br />\| json field=alert "severity", "signature", "action", "category" nodrop<br />\| count |
|AWS Network Firewall|Traffic By Application|Logs|AWS Network Firewall/AWS Network Firewall - Netflow Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "app\_proto", "netflow" nodrop<br />\| json field=netflow "bytes", "pkts" nodrop<br />\| where event\_type="netflow"<br />\| timeslice 15m<br />\| count \_timeslice, app\_proto<br />\| transpose row \_timeslice column app\_proto|
|AWS Network Firewall|Traffic By Protocol|Logs|AWS Network Firewall/AWS Network Firewall - Netflow Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "app\_proto", "netflow" nodrop<br />\| json field=netflow "bytes", "pkts" nodrop<br />\| where event\_type="netflow"<br />\| timeslice 15m<br />\| count \_timeslice, proto<br />\| transpose row \_timeslice column proto|
|AWS Network Firewall|Traffic Over Time|Logs|AWS Network Firewall/AWS Network Firewall - Netflow Overview|\_sourceCategory = Labs/AWS/Vanta\* <br />\| json "firewall\_name", "availability\_zone", "event" nodrop<br />\| json field=event "event\_type", "src\_ip", "src\_port", "dest\_ip", "dest\_port", "proto", "app\_proto", "netflow" nodrop<br />\| json field=netflow "bytes", "pkts" nodrop<br />\| where event\_type="netflow"<br />\| timeslice 15m<br />\| count \_timeslice |

