# Duo Security
## Sumo Logic App For: Duo Security
Duo provides two-factor authentication, endpoint remediation, and secure single sign-on tools. The Sumo Logic App for Duo Security helps you monitor your Duo account's authentication logs, administrator logs, and telephony logs. The dashboards provide insight into failed and successful authentications, events breakdown by applications, factors, users,  geo-location of events, admin activities, outliers, threat analysis of authentication and administrator events.
Docs Link: [Duo Security](https://help.sumologic.com/?cid=6115)

## Searches

### Log Searches

- **Admin Actions - One Day Time Comparison**: from Dashboard: Duo Security/Duo Security - Administrator Events 
- **Admin Actions - One Day Time Comparison**: from Dashboard: Installed Apps/Duo Security/Duo Security - Administrator Events 
- **Admin Actions Over Time**: from Dashboard: Duo Security/Duo Security - Administrator Events 
- **Admin Actions Over Time**: from Dashboard: Installed Apps/Duo Security/Duo Security - Administrator Events 
- **Admin Activity**: from Dashboard: Duo Security/Duo Security - Administrator Events 
- **Admin Activity**: from Dashboard: Installed Apps/Duo Security/Duo Security - Administrator Events 
- **Admin Activity**: from Dashboard: Duo Security/Duo Security - Overview 
- **Admin Activity**: from Dashboard: Duo Security/Duo Security - Overview - New 
- **Admin Activity**: from Dashboard: Installed Apps/Duo Security/Duo Security - Overview 
- **Admin Login Error**: from Dashboard: Duo Security/Duo Security - Administrator Events 
- **Admin Login Error**: from Dashboard: Installed Apps/Duo Security/Duo Security - Administrator Events 
- **Authentication by Users - One Day Time Comparison**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Authentication by Users - One Day Time Comparison**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Authentication by Users - One Day Time Comparison**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications 
- **Authentication by Users - One Day Time Comparison**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Authentication by Users Over Time**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Authentication by Users Over Time**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications 
- **Authentication by Users Over Time**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Authentication by Users Over Time**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Action**: from Dashboard: Duo Security/Duo Security - Administrator Events 
- **Breakdown by Action**: from Dashboard: Installed Apps/Duo Security/Duo Security - Administrator Events 
- **Breakdown by Application**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications 
- **Breakdown by Application**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Breakdown by Application**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Application**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Country, State, City**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Breakdown by Country, State, City**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications 
- **Breakdown by Country, State, City**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Country, State, City**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Event Type**: from Dashboard: Installed Apps/Duo Security/Duo Security - Overview 
- **Breakdown by Event Type**: from Dashboard: Duo Security/Duo Security - Overview - New 
- **Breakdown by Event Type**: from Dashboard: Duo Security/Duo Security - Overview 
- **Breakdown by Factor**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Factor**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications 
- **Breakdown by Factor**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Breakdown by Factor**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Failed Reason**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Failed Reason**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Breakdown by Reason**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications 
- **Breakdown by Reason**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Event Over Time**: from Dashboard: Duo Security/Duo Security - Overview 
- **Event Over Time**: from Dashboard: Installed Apps/Duo Security/Duo Security - Overview 
- **Event Over Time**: from Dashboard: Duo Security/Duo Security - Overview - New 
- **Event Type - One Day Time Comparison**: from Dashboard: Installed Apps/Duo Security/Duo Security - Overview 
- **Event Type - One Day Time Comparison**: from Dashboard: Duo Security/Duo Security - Overview 
- **Event Type - One Day Time Comparison**: from Dashboard: Duo Security/Duo Security - Overview - New 
- **Failed Authentications Events Table**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Failed Authentications Events Table**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Geo Location of Authentication Events**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Geo Location of Authentication Events**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Geo Location of Authentication Events**: from Dashboard: Installed Apps/Duo Security/Duo Security - Overview 
- **Geo Location of Authentication Events**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications 
- **Geo Location of Authentication Events**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Geo Location of Authentication Events**: from Dashboard: Duo Security/Duo Security - Overview 
- **Geo Location of Authentication Events**: from Dashboard: Duo Security/Duo Security - Overview - New 
- **Geo Location of Failed Admin Logins**: from Dashboard: Installed Apps/Duo Security/Duo Security - Administrator Events 
- **Geo Location of Failed Admin Logins**: from Dashboard: Duo Security/Duo Security - Administrator Events 
- **Geo Location of Success Admin Logins**: from Dashboard: Installed Apps/Duo Security/Duo Security - Administrator Events 
- **Geo Location of Success Admin Logins**: from Dashboard: Duo Security/Duo Security - Administrator Events 
- **Outlier - Failed Authentication Events**: from Dashboard: Duo Security/Duo Security - Outliers and Threat Analysis 
- **Outlier - Failed Authentication Events**: from Dashboard: Installed Apps/Duo Security/Duo Security - Outliers and Threat Analysis 
- **Outlier - Success Authentication Events**: from Dashboard: Duo Security/Duo Security - Outliers and Threat Analysis 
- **Outlier - Success Authentication Events**: from Dashboard: Installed Apps/Duo Security/Duo Security - Outliers and Threat Analysis 
- **Reason for Failed Authentication**: from Dashboard: Installed Apps/Duo Security/Duo Security - Overview 
- **Reason for Failed Authentication**: from Dashboard: Duo Security/Duo Security - Overview - New 
- **Reason for Failed Authentication**: from Dashboard: Duo Security/Duo Security - Overview 
- **Success Admin Logins**: from Dashboard: Installed Apps/Duo Security/Duo Security - Administrator Events 
- **Success Admin Logins**: from Dashboard: Duo Security/Duo Security - Administrator Events 
- **Success Authentication Events Table**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Success Authentication Events Table**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications 
- **Threat Intel Analysis of Admin Events**: from Dashboard: Installed Apps/Duo Security/Duo Security - Outliers and Threat Analysis 
- **Threat Intel Analysis of Admin Events**: from Dashboard: Duo Security/Duo Security - Outliers and Threat Analysis 
- **Threat Intel Analysis of Authentication Events**: from Dashboard: Duo Security/Duo Security - Outliers and Threat Analysis 
- **Threat Intel Analysis of Authentication Events**: from Dashboard: Installed Apps/Duo Security/Duo Security - Outliers and Threat Analysis 
- **Top 10 Active Users**: from Dashboard: Duo Security/Duo Security - Success Authentications 
- **Top 10 Active Users**: from Dashboard: Installed Apps/Duo Security/Duo Security - Failed Authentications 
- **Top 10 Active Users**: from Dashboard: Duo Security/Duo Security - Failed Authentications 
- **Top 10 Active Users**: from Dashboard: Installed Apps/Duo Security/Duo Security - Success Authentications

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Duo Security|Admin Actions - One Day Time Comparison|Logs|Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by action <br />\| compare with timeshift 1d<br />\| sort by  \_count|
|Duo Security|Admin Actions - One Day Time Comparison|Logs|Installed Apps/Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by action <br />\| compare with timeshift 1d<br />\| sort by  \_count|
|Duo Security|Admin Actions Over Time|Logs|Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\| timeslice 1h<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by \_timeslice, action <br />\| transpose row \_timeslice column action<br />\| fillmissing timeslice(1h)|
|Duo Security|Admin Actions Over Time|Logs|Installed Apps/Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\| timeslice 1h<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by \_timeslice, action <br />\| transpose row \_timeslice column action<br />\| fillmissing timeslice(1h)|
|Duo Security|Admin Activity|Logs|Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by action, user\_name, date\_time, object<br />\| sort by date\_time asc|
|Duo Security|Admin Activity|Logs|Installed Apps/Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by action, user\_name, date\_time, object<br />\| sort by date\_time asc|
|Duo Security|Admin Activity|Logs|Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\| count by action, user\_name, date\_time, object, description<br />\| sort by action<br />\| sort by action, date\_time asc<br />|
|Duo Security|Admin Activity|Logs|Duo Security/Duo Security - Overview - New|\_sourceCategory = Labs/duo administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\| count by action, user\_name, date\_time, object, description<br />\| sort by action<br />\| sort by action, date\_time asc<br />|
|Duo Security|Admin Activity|Logs|Installed Apps/Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\| count by action, user\_name, date\_time, object, description<br />\| sort by action<br />\| sort by action, date\_time asc<br />|
|Duo Security|Admin Login Error|Logs|Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  "admin\_login\_error"<br />\| json field=\_raw "eventtype" as eventtype nodrop   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| where action = "admin\_login\_error"<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| json field=description "error" as error nodrop<br />\| json field=description "email" as email nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}")<br />\|count by user\_name, date\_time, error, ip\_address<br />\| sort by date\_time asc|
|Duo Security|Admin Login Error|Logs|Installed Apps/Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  "admin\_login\_error"<br />\| json field=\_raw "eventtype" as eventtype nodrop   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| where action = "admin\_login\_error"<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| json field=description "error" as error nodrop<br />\| json field=description "email" as email nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}")<br />\|count by user\_name, date\_time, error, ip\_address<br />\| sort by date\_time asc|
|Duo Security|Authentication by Users - One Day Time Comparison|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by user\_name <br />\| sort by \_count  <br />\| compare with timeshift 1d|
|Duo Security|Authentication by Users - One Day Time Comparison|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by user\_name <br />\| sort by \_count  <br />\| compare with timeshift 1d|
|Duo Security|Authentication by Users - One Day Time Comparison|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by user\_name <br />\| sort by \_count  <br />\| compare with timeshift 1d|
|Duo Security|Authentication by Users - One Day Time Comparison|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by user\_name <br />\| sort by \_count  <br />\| compare with timeshift 1d|
|Duo Security|Authentication by Users Over Time|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| timeslice 1h<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice, user\_name <br />\| transpose row \_timeslice column user\_name<br />\| fillmissing timeslice(1h)|
|Duo Security|Authentication by Users Over Time|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| timeslice 1h<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice, user\_name <br />\| transpose row \_timeslice column user\_name<br />\| fillmissing timeslice(1h)|
|Duo Security|Authentication by Users Over Time|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| timeslice 1h<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice, user\_name <br />\| transpose row \_timeslice column user\_name<br />\| fillmissing timeslice(1h)|
|Duo Security|Authentication by Users Over Time|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| timeslice 1h<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice, user\_name <br />\| transpose row \_timeslice column user\_name<br />\| fillmissing timeslice(1h)|
|Duo Security|Breakdown by Action|Logs|Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by action<br />\| sort by \_count|
|Duo Security|Breakdown by Action|Logs|Installed Apps/Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "object" as object <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name<br />\| json field=\_raw "description" as description<br />\| json field=\_raw "action" as action<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by action<br />\| sort by \_count|
|Duo Security|Breakdown by Application|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| json field=\_raw "user.name" as user\_name<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by application\_name<br />\| sort by \_count, application\_name asc|
|Duo Security|Breakdown by Application|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| json field=\_raw "user.name" as user\_name<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by application\_name<br />\| sort by \_count, application\_name asc|
|Duo Security|Breakdown by Application|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| json field=\_raw "user.name" as user\_name<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by application\_name<br />\| sort by \_count, application\_name asc|
|Duo Security|Breakdown by Application|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| json field=\_raw "user.name" as user\_name<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by application\_name<br />\| sort by \_count, application\_name asc|
|Duo Security|Breakdown by Country, State, City|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by Country, State, City<br />\| sort by \_count|
|Duo Security|Breakdown by Country, State, City|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by Country, State, City<br />\| sort by \_count|
|Duo Security|Breakdown by Country, State, City|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by Country, State, City<br />\| sort by \_count|
|Duo Security|Breakdown by Country, State, City|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by Country, State, City<br />\| sort by \_count|
|Duo Security|Breakdown by Event Type|Logs|Installed Apps/Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}    <br />\| json field=\_raw "eventtype" as eventtype   <br />\| count by eventtype<br />\| sort by \_count|
|Duo Security|Breakdown by Event Type|Logs|Duo Security/Duo Security - Overview - New|\_sourceCategory = Labs/duo   <br />\| json field=\_raw "eventtype" as eventtype   <br />\| count by eventtype<br />\| sort by \_count|
|Duo Security|Breakdown by Event Type|Logs|Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}    <br />\| json field=\_raw "eventtype" as eventtype   <br />\| count by eventtype<br />\| sort by \_count|
|Duo Security|Breakdown by Factor|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| json field=\_raw "user.name" as user\_name<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by factor<br />\| sort by \_count, factor asc|
|Duo Security|Breakdown by Factor|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| json field=\_raw "user.name" as user\_name<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by factor<br />\| sort by \_count, factor asc|
|Duo Security|Breakdown by Factor|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| json field=\_raw "user.name" as user\_name<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by factor<br />\| sort by \_count, factor asc|
|Duo Security|Breakdown by Factor|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| json field=\_raw "user.name" as user\_name<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by factor<br />\| sort by \_count, factor asc|
|Duo Security|Breakdown by Failed Reason|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by reason<br />\| sort by \_count, reason asc|
|Duo Security|Breakdown by Failed Reason|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by reason<br />\| sort by \_count, reason asc|
|Duo Security|Breakdown by Reason|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by reason<br />\| sort by \_count, reason asc|
|Duo Security|Breakdown by Reason|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by reason<br />\| sort by \_count, reason asc|
|Duo Security|Event Over Time|Logs|Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}    <br />\| json field=\_raw "eventtype" as eventtype   <br />\| timeslice 1h<br />\| count by \_timeslice, eventtype <br />\| transpose row \_timeslice column eventtype<br />\| fillmissing timeslice(1h)|
|Duo Security|Event Over Time|Logs|Installed Apps/Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}    <br />\| json field=\_raw "eventtype" as eventtype   <br />\| timeslice 1h<br />\| count by \_timeslice, eventtype <br />\| transpose row \_timeslice column eventtype<br />\| fillmissing timeslice(1h)|
|Duo Security|Event Over Time|Logs|Duo Security/Duo Security - Overview - New|\_sourceCategory = Labs/duo   <br />\| json field=\_raw "eventtype" as eventtype   <br />\| timeslice 1h<br />\| count by \_timeslice, eventtype <br />\| transpose row \_timeslice column eventtype<br />\| fillmissing timeslice(1h)|
|Duo Security|Event Type - One Day Time Comparison|Logs|Installed Apps/Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}    <br />\| json field=\_raw "eventtype" as eventtype   <br />\| count by eventtype \| compare with timeshift 1d|
|Duo Security|Event Type - One Day Time Comparison|Logs|Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}    <br />\| json field=\_raw "eventtype" as eventtype   <br />\| count by eventtype \| compare with timeshift 1d|
|Duo Security|Event Type - One Day Time Comparison|Logs|Duo Security/Duo Security - Overview - New|\_sourceCategory = Labs/duo   <br />\| json field=\_raw "eventtype" as eventtype   <br />\| count by eventtype \| compare with timeshift 1d|
|Duo Security|Failed Authentications Events Table|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by date\_time, user\_name, city, result, reason, factor, application\_name<br />\| sort by \_count<br />\| sort by  \_count, date\_time asc|
|Duo Security|Failed Authentications Events Table|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by date\_time, user\_name, city, result, reason, factor, application\_name<br />\| sort by \_count<br />\| sort by  \_count, date\_time asc|
|Duo Security|Geo Location of Authentication Events|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Authentication Events|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Authentication Events|Logs|Installed Apps/Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Authentication Events|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Authentication Events|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Authentication Events|Logs|Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Authentication Events|Logs|Duo Security/Duo Security - Overview - New|\_sourceCategory = Labs/duo authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Failed Admin Logins|Logs|Installed Apps/Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  "admin\_login\_error"<br />\| json field=\_raw "object" as object nodrop<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| where action = "admin\_login\_error"<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| json field=description "error" as error nodrop<br />\| json field=description "email" as email nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip\_address<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Failed Admin Logins|Logs|Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  "admin\_login\_error"<br />\| json field=\_raw "object" as object nodrop<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| where action = "admin\_login\_error"<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| json field=description "error" as error nodrop<br />\| json field=description "email" as email nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip\_address<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Success Admin Logins|Logs|Installed Apps/Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  admin\_login<br />\| json field=\_raw "object" as object nodrop<br />\| json field=\_raw "eventtype" as eventtype nodrop <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| where action = "admin\_login"<br />\| json field=description "factor" as factor nodrop<br />\| json field=description "saml\_idp" as saml\_idp nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\| json field=description "primary\_auth\_method" as primary\_auth\_method nodrop<br />\| json field=description "device" as device nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip\_address<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Geo Location of Success Admin Logins|Logs|Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  admin\_login<br />\| json field=\_raw "object" as object nodrop<br />\| json field=\_raw "eventtype" as eventtype nodrop <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| where action = "admin\_login"<br />\| json field=description "factor" as factor nodrop<br />\| json field=description "saml\_idp" as saml\_idp nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\| json field=description "primary\_auth\_method" as primary\_auth\_method nodrop<br />\| json field=description "device" as device nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip\_address<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Duo Security|Outlier - Failed Authentication Events|Logs|Duo Security/Duo Security - Outliers and Threat Analysis|\_sourceCategory={{Logsdatasource}}  authentication denied <br />\| json field=\_raw "eventtype" as eventtype nodrop<br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result  nodrop <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip  nodrop<br />\| json field=\_raw "access\_device.location.city" as city  nodrop<br />\| json field=\_raw "access\_device.location.country" as country  nodrop<br />\| json field=\_raw "access\_device.location.state" as state  nodrop<br />\| json field=\_raw "application.name" as application\_name  nodrop<br />\| json field=\_raw "factor" as factor  nodrop<br />\| json field=\_raw "reason" as reason  nodrop<br />\| json field=\_raw "result" as result  nodrop<br />\| json field=\_raw "timestamp" as time  nodrop<br />\| json field=\_raw "user.name" as user\_name  nodrop<br />\| timeslice {{Timeslice}}<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{ip}}" = "\*", true, ip matches "{{ip}}")<br />\|count by \_timeslice<br />\| outlier \_count window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Duo Security|Outlier - Failed Authentication Events|Logs|Installed Apps/Duo Security/Duo Security - Outliers and Threat Analysis|\_sourceCategory={{Logsdatasource}}  authentication denied <br />\| json field=\_raw "eventtype" as eventtype nodrop<br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result  nodrop <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip  nodrop<br />\| json field=\_raw "access\_device.location.city" as city  nodrop<br />\| json field=\_raw "access\_device.location.country" as country  nodrop<br />\| json field=\_raw "access\_device.location.state" as state  nodrop<br />\| json field=\_raw "application.name" as application\_name  nodrop<br />\| json field=\_raw "factor" as factor  nodrop<br />\| json field=\_raw "reason" as reason  nodrop<br />\| json field=\_raw "result" as result  nodrop<br />\| json field=\_raw "timestamp" as time  nodrop<br />\| json field=\_raw "user.name" as user\_name  nodrop<br />\| timeslice {{Timeslice}}<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{ip}}" = "\*", true, ip matches "{{ip}}")<br />\|count by \_timeslice<br />\| outlier \_count window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Duo Security|Outlier - Success Authentication Events|Logs|Duo Security/Duo Security - Outliers and Threat Analysis|\_sourceCategory={{Logsdatasource}}  authentication success <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result nodrop  <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip nodrop  <br />\| json field=\_raw "access\_device.location.city" as city nodrop  <br />\| json field=\_raw "access\_device.location.country" as country nodrop  <br />\| json field=\_raw "access\_device.location.state" as state nodrop  <br />\| json field=\_raw "application.name" as application\_name nodrop  <br />\| json field=\_raw "factor" as factor nodrop  <br />\| json field=\_raw "reason" as reason nodrop  <br />\| json field=\_raw "result" as result  nodrop  <br />\| json field=\_raw "timestamp" as time  nodrop  <br />\| json field=\_raw "user.name" as user\_name nodrop  <br />\| timeslice {{Timeslice}}<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{ip}}" = "\*", true, ip matches "{{ip}}")<br />\|count by \_timeslice<br />\| outlier \_count window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Duo Security|Outlier - Success Authentication Events|Logs|Installed Apps/Duo Security/Duo Security - Outliers and Threat Analysis|\_sourceCategory={{Logsdatasource}}  authentication success <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result nodrop  <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip nodrop  <br />\| json field=\_raw "access\_device.location.city" as city nodrop  <br />\| json field=\_raw "access\_device.location.country" as country nodrop  <br />\| json field=\_raw "access\_device.location.state" as state nodrop  <br />\| json field=\_raw "application.name" as application\_name nodrop  <br />\| json field=\_raw "factor" as factor nodrop  <br />\| json field=\_raw "reason" as reason nodrop  <br />\| json field=\_raw "result" as result  nodrop  <br />\| json field=\_raw "timestamp" as time  nodrop  <br />\| json field=\_raw "user.name" as user\_name nodrop  <br />\| timeslice {{Timeslice}}<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{ip}}" = "\*", true, ip matches "{{ip}}")<br />\|count by \_timeslice<br />\| outlier \_count window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Duo Security|Reason for Failed Authentication|Logs|Installed Apps/Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| count by reason<br />\| sort by \_count |
|Duo Security|Reason for Failed Authentication|Logs|Duo Security/Duo Security - Overview - New|\_sourceCategory = Labs/duo authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| count by reason<br />\| sort by \_count |
|Duo Security|Reason for Failed Authentication|Logs|Duo Security/Duo Security - Overview|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\| count by reason<br />\| sort by \_count |
|Duo Security|Success Admin Logins|Logs|Installed Apps/Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  admin\_login<br />\| json field=\_raw "eventtype" as eventtype nodrop<br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| where action = "admin\_login"<br />\| json field=description "factor" as factor nodrop<br />\| json field=description "saml\_idp" as saml\_idp nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\| json field=description "primary\_auth\_method" as primary\_auth\_method nodrop<br />\| json field=description "device" as device nodrop<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}")<br />\|count by user\_name, date\_time, factor, primary\_auth\_method, device<br />\| sort \_count|
|Duo Security|Success Admin Logins|Logs|Duo Security/Duo Security - Administrator Events|\_sourceCategory={{Logsdatasource}}  administrator  admin\_login<br />\| json field=\_raw "eventtype" as eventtype nodrop<br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| where action = "admin\_login"<br />\| json field=description "factor" as factor nodrop<br />\| json field=description "saml\_idp" as saml\_idp nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\| json field=description "primary\_auth\_method" as primary\_auth\_method nodrop<br />\| json field=description "device" as device nodrop<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}")<br />\|count by user\_name, date\_time, factor, primary\_auth\_method, device<br />\| sort \_count|
|Duo Security|Success Authentication Events Table|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by date\_time, user\_name, city, result, reason, factor, application\_name<br />\| sort by date\_time asc|
|Duo Security|Success Authentication Events Table|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by date\_time, user\_name, city, result, reason, factor, application\_name<br />\| sort by date\_time asc|
|Duo Security|Threat Intel Analysis of Admin Events|Logs|Installed Apps/Duo Security/Duo Security - Outliers and Threat Analysis|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype nodrop   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| json field=\_raw "object" as object nodrop<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address<br />\| where type="ip\_address" and malicious\_confidence = "high"<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if(isnull(object),"none", object) as object<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}")<br />\|count by date\_time, ip\_address, action, object, user\_name, description, label\_name|
|Duo Security|Threat Intel Analysis of Admin Events|Logs|Duo Security/Duo Security - Outliers and Threat Analysis|\_sourceCategory={{Logsdatasource}}  administrator  <br />\| json field=\_raw "eventtype" as eventtype nodrop   <br />\| where eventtype = "administrator" <br />\| json field=\_raw "action" as action nodrop<br />\| json field=\_raw "object" as object nodrop<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "username" as user\_name nodrop<br />\| json field=\_raw "description" as description nodrop<br />\| json field=description "ip\_address" as ip\_address nodrop<br /><br />\| where !isNull(ip\_address)<br />\| threatlookup singleIndicator ip\_address<br /><br />// normalize confidence level to a string <br />\| if (\_threatlookup.confidence \>= 85, "high", if (\_threatlookup.confidence \>= 50, "medium", if (\_threatlookup.confidence \>= 15, "low", if (\_threatlookup.confidence \>= 0, "unverified", "unknown")))) as threat\_confidence<br /><br />\| where threat\_confidence in ("high", "medium", "low")<br /><br />//rename to match threat\_\<foo\> convention<br />\| %"\_threatlookup.actors" as threat\_actors<br />\| %"\_threatlookup.type" as type<br />\| %"\_threatlookup.threat\_type" as threat\_type<br /><br />//convert threat valid from to human readable time<br />\| toLong(%"\_threatlookup.valid\_from" \* 1000) as %"\_threatlookup.valid\_from"<br />\| formatDate(%"\_threatlookup.valid\_from", "MM-dd-yyyy") as threat\_valid\_from<br /><br />\| where type matches "ipv4-addr\*" and !isNull(threat\_confidence)<br /><br />\| if (isEmpty(threat\_actors), "Unassigned", threat\_actors) as threat\_actors<br /><br />\| if(isnull(object),"none", object) as object<br />\| where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}")<br />\| count by date\_time, ip\_address, action, object, user\_name, description,threat\_actors, threat\_type,type,threat\_valid\_from|
|Duo Security|Threat Intel Analysis of Authentication Events|Logs|Duo Security/Duo Security - Outliers and Threat Analysis|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result nodrop<br />\| json field=\_raw "access\_device.ip" as ip nodrop<br />\| json field=\_raw "access\_device.location.city" as city nodrop<br />\| json field=\_raw "access\_device.location.country" as country nodrop<br />\| json field=\_raw "access\_device.location.state" as state nodrop<br />\| json field=\_raw "application.name" as application\_name nodrop<br />\| json field=\_raw "factor" as factor nodrop<br />\| json field=\_raw "reason" as reason nodrop<br />\| json field=\_raw "result" as result nodrop<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name nodrop<br /><br />\| where !isNull(ip)<br />\| threatlookup singleIndicator ip<br /><br />// normalize confidence level to a string <br />\| if (\_threatlookup.confidence \>= 85, "high", if (\_threatlookup.confidence \>= 50, "medium", if (\_threatlookup.confidence \>= 15, "low", if (\_threatlookup.confidence \>= 0, "unverified", "unknown")))) as threat\_confidence<br /><br />\| where threat\_confidence in ("high", "medium", "low")<br /><br />//rename to match threat\_\<foo\> convention<br />\| %"\_threatlookup.actors" as threat\_actors<br />\| %"\_threatlookup.type" as type<br />\| %"\_threatlookup.threat\_type" as threat\_type<br /><br />//convert threat valid from to human readable time<br />\| toLong(%"\_threatlookup.valid\_from" \* 1000) as %"\_threatlookup.valid\_from"<br />\| formatDate(%"\_threatlookup.valid\_from", "MM-dd-yyyy") as threat\_valid\_from<br /><br />\| where type matches "ipv4-addr\*" and !isNull(threat\_confidence)<br /><br />\| if (isEmpty(threat\_actors), "Unassigned", threat\_actors) as threat\_actors<br /><br />\| where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{ip}}" = "\*", true, ip matches "{{ip}}")<br />\| count by date\_time, ip, eventtype, result, city, application\_name, factor, reason, user\_name,threat\_actors, threat\_type,type,threat\_valid\_from|
|Duo Security|Threat Intel Analysis of Authentication Events|Logs|Installed Apps/Duo Security/Duo Security - Outliers and Threat Analysis|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result nodrop<br />\| json field=\_raw "access\_device.ip" as ip nodrop<br />\| json field=\_raw "access\_device.location.city" as city nodrop<br />\| json field=\_raw "access\_device.location.country" as country nodrop<br />\| json field=\_raw "access\_device.location.state" as state nodrop<br />\| json field=\_raw "application.name" as application\_name nodrop<br />\| json field=\_raw "factor" as factor nodrop<br />\| json field=\_raw "reason" as reason nodrop<br />\| json field=\_raw "result" as result nodrop<br />\| json field=\_raw "timestamp" as time nodrop<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip<br />\| where type="ip\_address"  and malicious\_confidence = "high"<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{ip}}" = "\*", true, ip matches "{{ip}}")<br />\|count by date\_time, ip, eventtype, result, city, application\_name, factor, reason, user\_name, label\_name|
|Duo Security|Top 10 Active Users|Logs|Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by user\_name<br />\| sort by \_count  <br />\| limit 10|
|Duo Security|Top 10 Active Users|Logs|Installed Apps/Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by user\_name<br />\| sort by \_count  <br />\| limit 10|
|Duo Security|Top 10 Active Users|Logs|Duo Security/Duo Security - Failed Authentications|\_sourceCategory={{Logsdatasource}}  authentication denied<br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result !="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by user\_name<br />\| sort by \_count  <br />\| limit 10|
|Duo Security|Top 10 Active Users|Logs|Installed Apps/Duo Security/Duo Security - Success Authentications|\_sourceCategory={{Logsdatasource}}  authentication <br />\| json field=\_raw "eventtype" as eventtype nodrop  <br />\| where eventtype = "authentication"<br />\| json field=\_raw "result" as result <br />\| where result ="success" <br />\| json field=\_raw "access\_device.ip" as ip<br />\| json field=\_raw "access\_device.location.city" as city<br />\| json field=\_raw "access\_device.location.country" as country<br />\| json field=\_raw "access\_device.location.state" as state<br />\| json field=\_raw "application.name" as application\_name<br />\| json field=\_raw "factor" as factor<br />\| json field=\_raw "reason" as reason<br />\| json field=\_raw "result" as result <br />\| json field=\_raw "timestamp" as time<br />\| time\* 1000 as timemilli<br />\| formatDate(fromMillis(toLong(timemilli)), "MM-dd-yyyy HH:mm:ss") as date\_time<br />\| json field=\_raw "user.name" as user\_name<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{eventtype}}" = "\*", true, eventtype matches "{{eventtype}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{reason}}" = "\*", true, reason matches "{{reason}}") AND if ("{{factor}}" = "\*", true, factor matches "{{factor}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by user\_name<br />\| sort by \_count  <br />\| limit 10|

