# 1Password
## Sumo Logic App For: 1Password
1Password is a secure and convenient password manager for documents, credit card information, and addresses. The Sumo Logic App for 1Password helps you monitor your 1Password accountâ€™s sign-in and item usage events. The dashboards provide insight into failed and successful authentications, events breakdown by client applications, type, category, users, geo-location of events, outliers, and threat analysis of sign-in events. This app helps your secure 1Password vault access by providing insights into user actions and threat intel analysis on clients accessing items in shared vaults.
Docs Link: [1Password](https://help.sumologic.com/?cid=220422)

## Searches

### Log Searches

- **Breakdown by Action**: from Dashboard: 1Password/1Password - Item Usage 
- **Breakdown by Action**: from Dashboard: Installed Apps/1Password/1Password - Item Usage 
- **Breakdown by Client App**: from Dashboard: 1Password/1Password - Failed Sign-ins 
- **Breakdown by Client App**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Breakdown by Client App**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Breakdown by Client App**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Breakdown by Client OS**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Breakdown by Client OS**: from Dashboard: 1Password/1Password - Failed Sign-ins 
- **Breakdown by Client OS**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Breakdown by Client OS**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Breakdown by Country, Region, City**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Breakdown by Country, Region, City**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Breakdown by Country, Region, City**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Breakdown by Country, Region, City**: from Dashboard: 1Password/1Password - Failed Sign-ins 
- **Failed Sign In Events**: from Dashboard: Installed Apps/1Password/1Password - Overview 
- **Failed Sign In Events**: from Dashboard: 1Password/1Password - Overview 
- **Geolocation of Clients**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Geolocation of Clients**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Geolocation of Clients**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Geolocation of Clients**: from Dashboard: 1Password/1Password - Failed Sign-ins 
- **Geolocation of Clients**: from Dashboard: 1Password/1Password - Overview 
- **Geolocation of Clients**: from Dashboard: Installed Apps/1Password/1Password - Overview 
- **Geolocation of Clients**: from Dashboard: 1Password/1Password - Item Usage 
- **Geolocation of Clients**: from Dashboard: Installed Apps/1Password/1Password - Item Usage 
- **Highly Malicious Threat Table**: from Dashboard: 1Password/1Password - Threat Intel 
- **Highly Malicious Threat Table**: from Dashboard: Installed Apps/1Password/1Password - Threat Intel 
- **Item Usage Summary**: from Dashboard: Installed Apps/1Password/1Password - Item Usage 
- **Item Usage Summary**: from Dashboard: 1Password/1Password - Item Usage 
- **One Day Time Comparison**: from Dashboard: Installed Apps/1Password/1Password - Overview 
- **One Day Time Comparison**: from Dashboard: 1Password/1Password - Overview 
- **Outlier - Failed Sign-ins**: from Dashboard: 1Password/1Password - Failed Sign-ins 
- **Outlier - Failed Sign-ins**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Outlier - Sign-in Events**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Outlier - Sign-in Events**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Sign In Events by Category**: from Dashboard: Installed Apps/1Password/1Password - Overview 
- **Sign In Events by Category**: from Dashboard: Installed Apps/1Password/1Password - Overview 
- **Sign In Events by Category**: from Dashboard: 1Password/1Password - Overview 
- **Sign In Events by Category**: from Dashboard: 1Password/1Password - Overview 
- **Sign In Events by Type**: from Dashboard: Installed Apps/1Password/1Password - Overview 
- **Sign In Events by Type**: from Dashboard: Installed Apps/1Password/1Password - Overview 
- **Sign In Events by Type**: from Dashboard: 1Password/1Password - Overview 
- **Sign In Events by Type**: from Dashboard: 1Password/1Password - Overview 
- **Sign-in Events - One Day Time Comparison**: from Dashboard: 1Password/1Password - Failed Sign-ins 
- **Sign-in Events - One Day Time Comparison**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Sign-in Events - One Day Time Comparison**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Sign-in Events - One Day Time Comparison**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Sign-in Events Over Time**: from Dashboard: 1Password/1Password - Failed Sign-ins 
- **Sign-in Events Over Time**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Sign-in Events Over Time**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Sign-in Events Over Time**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Sign-in Summary**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Sign-in Summary**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Sign-in Summary**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Sign-in Summary**: from Dashboard: 1Password/1Password - Failed Sign-ins 
- **Threat by Actors**: from Dashboard: Installed Apps/1Password/1Password - Threat Intel 
- **Threat by Actors**: from Dashboard: 1Password/1Password - Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: 1Password/1Password - Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/1Password/1Password - Threat Intel 
- **Threat Count**: from Dashboard: 1Password/1Password - Threat Intel 
- **Threat Count**: from Dashboard: Installed Apps/1Password/1Password - Threat Intel 
- **Threat Intel - Item Usage Clients**: from Dashboard: 1Password/1Password - Item Usage 
- **Threat Intel - Item Usage Clients**: from Dashboard: Installed Apps/1Password/1Password - Item Usage 
- **Threat Locations**: from Dashboard: 1Password/1Password - Threat Intel 
- **Threat Locations**: from Dashboard: Installed Apps/1Password/1Password - Threat Intel 
- **Threat Table**: from Dashboard: Installed Apps/1Password/1Password - Threat Intel 
- **Threat Table**: from Dashboard: 1Password/1Password - Threat Intel 
- **Top 10 Active Users**: from Dashboard: Installed Apps/1Password/1Password - Failed Sign-ins 
- **Top 10 Active Users**: from Dashboard: Installed Apps/1Password/1Password - Successful Sign-ins 
- **Top 10 Active Users**: from Dashboard: 1Password/1Password - Successful Sign-ins 
- **Top 10 Active Users**: from Dashboard: 1Password/1Password - Failed Sign-ins

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|1Password|Breakdown by Action|Logs|1Password/1Password - Item Usage|\_sourceCategory=Labs/onepassword action<br />\| json "timestamp", "user.name", "client.app\_name", "client.platform\_name", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city", "action", "vault\_uuid", "item\_uuid" as timestamp, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, action, vault\_uuid, item\_uuid<br />\| where action matches  "{{action}}" <br />\| count by action<br />\| sort by \_count|
|1Password|Breakdown by Action|Logs|Installed Apps/1Password/1Password - Item Usage|\_sourceCategory={{\_sourceCategory}} action<br />\| json "timestamp", "user.name", "client.app\_name", "client.platform\_name", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city", "action", "vault\_uuid", "item\_uuid" as timestamp, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, action, vault\_uuid, item\_uuid<br />\| where action matches  "{{action}}" <br />\| count by action<br />\| sort by \_count|
|1Password|Breakdown by Client App|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by client\_app\_name<br />\| sort by count|
|1Password|Breakdown by Client App|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by client\_app\_name<br />\| sort by count|
|1Password|Breakdown by Client App|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by client\_app\_name<br />\| sort by count|
|1Password|Breakdown by Client App|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by client\_app\_name<br />\| sort by count|
|1Password|Breakdown by Client OS|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by client\_os<br />\| sort by count|
|1Password|Breakdown by Client OS|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by client\_os<br />\| sort by count|
|1Password|Breakdown by Client OS|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by client\_os<br />\| sort by count|
|1Password|Breakdown by Client OS|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by client\_os<br />\| sort by count|
|1Password|Breakdown by Country, Region, City|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by country, region, city<br />\| sort by count|
|1Password|Breakdown by Country, Region, City|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by country, region, city<br />\| sort by count|
|1Password|Breakdown by Country, Region, City|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by country, region, city<br />\| sort by count|
|1Password|Breakdown by Country, Region, City|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by country, region, city<br />\| sort by count|
|1Password|Failed Sign In Events|Logs|Installed Apps/1Password/1Password - Overview|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"\| where category in ("credentials\_failed", "mfa\_failed", "modern\_version\_failed", "firewall\_failed")<br />\| count by target\_user\_name, category, type, details, country, city, client\_app\_name, client\_platform<br />\| sort by \_count|
|1Password|Failed Sign In Events|Logs|1Password/1Password - Overview|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"\| where category in ("credentials\_failed", "mfa\_failed", "modern\_version\_failed", "firewall\_failed")<br />\| count by target\_user\_name, category, type, details, country, city, client\_app\_name, client\_platform<br />\| sort by \_count|
|1Password|Geolocation of Clients|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|1Password|Geolocation of Clients|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|1Password|Geolocation of Clients|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|1Password|Geolocation of Clients|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|1Password|Geolocation of Clients|Logs|1Password/1Password - Overview|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"\|lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|1Password|Geolocation of Clients|Logs|Installed Apps/1Password/1Password - Overview|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"\|lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|1Password|Geolocation of Clients|Logs|1Password/1Password - Item Usage|\_sourceCategory=Labs/onepassword action<br />\| json "timestamp", "user.name", "client.app\_name", "client.platform\_name", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city", "action", "vault\_uuid", "item\_uuid" as timestamp, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, action, vault\_uuid, item\_uuid<br />\| where action matches  "{{action}}" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|1Password|Geolocation of Clients|Logs|Installed Apps/1Password/1Password - Item Usage|\_sourceCategory={{\_sourceCategory}} action<br />\| json "timestamp", "user.name", "client.app\_name", "client.platform\_name", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city", "action", "vault\_uuid", "item\_uuid" as timestamp, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, action, vault\_uuid, item\_uuid<br />\| where action matches  "{{action}}" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|1Password|Highly Malicious Threat Table|Logs|1Password/1Password - Threat Intel|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "high"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by timestamp, target\_user\_name, malicious\_confidence, client\_ip, actor, type, category, client\_app\_name, client\_platform, country, region, city<br />\| sort by \_count|
|1Password|Highly Malicious Threat Table|Logs|Installed Apps/1Password/1Password - Threat Intel|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "high"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by timestamp, target\_user\_name, malicious\_confidence, client\_ip, actor, type, category, client\_app\_name, client\_platform, country, region, city<br />\| sort by \_count|
|1Password|Item Usage Summary|Logs|Installed Apps/1Password/1Password - Item Usage|\_sourceCategory={{\_sourceCategory}} action<br />\| json "timestamp", "user.name", "client.app\_name", "client.platform\_name", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city", "action", "vault\_uuid", "item\_uuid" as timestamp, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, action, vault\_uuid, item\_uuid<br />\| where action matches  "{{action}}" <br />\| count by timestamp, action, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, vault\_uuid, item\_uuid|
|1Password|Item Usage Summary|Logs|1Password/1Password - Item Usage|\_sourceCategory=Labs/onepassword action<br />\| json "timestamp", "user.name", "client.app\_name", "client.platform\_name", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city", "action", "vault\_uuid", "item\_uuid" as timestamp, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, action, vault\_uuid, item\_uuid<br />\| where action matches  "{{action}}" <br />\| count by timestamp, action, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, vault\_uuid, item\_uuid|
|1Password|One Day Time Comparison|Logs|Installed Apps/1Password/1Password - Overview|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| count as count by  category, type \| compare with timeshift 1d<br />\| sort by count|
|1Password|One Day Time Comparison|Logs|1Password/1Password - Overview|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| count as count by  category, type \| compare with timeshift 1d<br />\| sort by count|
|1Password|Outlier - Failed Sign-ins|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| timeslice 1d<br />\| count by \_timeslice<br />\| outlier \_count window=5,threshold=2,consecutive=2,direction=+ |
|1Password|Outlier - Failed Sign-ins|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| timeslice 1d<br />\| count by \_timeslice<br />\| outlier \_count window=5,threshold=2,consecutive=2,direction=+ |
|1Password|Outlier - Sign-in Events|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| timeslice 1d<br />\| count by \_timeslice<br />\| outlier \_count window=5,threshold=2,consecutive=2,direction=+ |
|1Password|Outlier - Sign-in Events|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| timeslice 1d<br />\| count by \_timeslice<br />\| outlier \_count window=5,threshold=2,consecutive=2,direction=+ |
|1Password|Sign In Events by Category|Logs|Installed Apps/1Password/1Password - Overview|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| count by category  <br />\| sort by \_count|
|1Password|Sign In Events by Category|Logs|Installed Apps/1Password/1Password - Overview|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| timeslice 1d<br />\| count by category, \_timeslice<br />\| transpose row \_timeslice column category|
|1Password|Sign In Events by Category|Logs|1Password/1Password - Overview|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| timeslice 1d<br />\| count by category, \_timeslice<br />\| transpose row \_timeslice column category|
|1Password|Sign In Events by Category|Logs|1Password/1Password - Overview|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| count by category  <br />\| sort by \_count|
|1Password|Sign In Events by Type|Logs|Installed Apps/1Password/1Password - Overview|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| timeslice 1d<br />\| count by type, \_timeslice<br />\| transpose row \_timeslice column type|
|1Password|Sign In Events by Type|Logs|Installed Apps/1Password/1Password - Overview|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| count by type  <br />\| sort by \_count|
|1Password|Sign In Events by Type|Logs|1Password/1Password - Overview|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| timeslice 1d<br />\| count by type, \_timeslice<br />\| transpose row \_timeslice column type|
|1Password|Sign In Events by Type|Logs|1Password/1Password - Overview|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}"<br />\| count by type  <br />\| sort by \_count|
|1Password|Sign-in Events - One Day Time Comparison|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by target\_user\_name <br />\| compare with timeshift 1d<br />\| sort by count|
|1Password|Sign-in Events - One Day Time Comparison|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by target\_user\_name <br />\| compare with timeshift 1d<br />\| sort by count|
|1Password|Sign-in Events - One Day Time Comparison|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by target\_user\_name <br />\| compare with timeshift 1d<br />\| sort by count|
|1Password|Sign-in Events - One Day Time Comparison|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by target\_user\_name <br />\| compare with timeshift 1d<br />\| sort by count|
|1Password|Sign-in Events Over Time|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| timeslice 1d<br />\| count as count by \_timeslice, target\_user\_name<br />\| transpose row \_timeslice column target\_user\_name|
|1Password|Sign-in Events Over Time|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| timeslice 1d<br />\| count as count by \_timeslice, target\_user\_name<br />\| transpose row \_timeslice column target\_user\_name|
|1Password|Sign-in Events Over Time|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| timeslice 1d<br />\| count as count by \_timeslice, target\_user\_name<br />\| transpose row \_timeslice column target\_user\_name|
|1Password|Sign-in Events Over Time|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| timeslice 1d<br />\| count as count by \_timeslice, target\_user\_name<br />\| transpose row \_timeslice column target\_user\_name|
|1Password|Sign-in Summary|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count by timestamp, target\_user\_name, type, category, details,client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| fields - \_count|
|1Password|Sign-in Summary|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count by timestamp, target\_user\_name, type, category, details,client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| fields - \_count|
|1Password|Sign-in Summary|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count by timestamp, target\_user\_name, type, category, details,client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| fields - \_count|
|1Password|Sign-in Summary|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count by timestamp, target\_user\_name, type, category, details,client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| fields - \_count|
|1Password|Threat by Actors|Logs|Installed Apps/1Password/1Password - Threat Intel|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "{{malicious\_confidence}}"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|1Password|Threat by Actors|Logs|1Password/1Password - Threat Intel|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "{{malicious\_confidence}}"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|1Password|Threat by Malicious Confidence|Logs|1Password/1Password - Threat Intel|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "\*"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|1Password|Threat by Malicious Confidence|Logs|Installed Apps/1Password/1Password - Threat Intel|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "\*"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|1Password|Threat Count|Logs|1Password/1Password - Threat Intel|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "{{malicious\_confidence}}"<br />\| where !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, city from geo://location on ip = client\_ip<br />\| count |
|1Password|Threat Count|Logs|Installed Apps/1Password/1Password - Threat Intel|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "{{malicious\_confidence}}"<br />\| where !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, city from geo://location on ip = client\_ip<br />\| count |
|1Password|Threat Intel - Item Usage Clients|Logs|1Password/1Password - Item Usage|\_sourceCategory=Labs/onepassword action<br />\| json "timestamp", "user.name", "client.app\_name", "client.platform\_name", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city", "action", "vault\_uuid", "item\_uuid" as timestamp, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, action, vault\_uuid, item\_uuid<br />\| where action matches  "{{action}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "\*"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by timestamp, action, user\_name, client\_ip, malicious\_confidence,actor, client\_app\_name, client\_platform, client\_os, client\_os\_version, country, region, city, vault\_uuid, item\_uuid<br />\| sort by \_count|
|1Password|Threat Intel - Item Usage Clients|Logs|Installed Apps/1Password/1Password - Item Usage|\_sourceCategory={{\_sourceCategory}} action<br />\| json "timestamp", "user.name", "client.app\_name", "client.platform\_name", "client.platform\_version", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city", "action", "vault\_uuid", "item\_uuid" as timestamp, user\_name, client\_app\_name, client\_platform, client\_platform\_version, client\_os, client\_os\_version, client\_ip, country, region, city, action, vault\_uuid, item\_uuid<br />\| where action matches  "{{action}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "\*"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by timestamp, action, user\_name, client\_ip, malicious\_confidence,actor, client\_app\_name, client\_platform, client\_os, client\_os\_version, country, region, city, vault\_uuid, item\_uuid<br />\| sort by \_count|
|1Password|Threat Locations|Logs|1Password/1Password - Threat Intel|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "{{malicious\_confidence}}"<br />\| where !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, city from geo://location on ip = client\_ip<br />\| count by client\_ip, country\_coude, country\_name, city, type, actor, malicious\_confidence, user\_agent, latitude, longitude, target\_user\_name, client\_app\_name, categhory<br />\| sort by \_count |
|1Password|Threat Locations|Logs|Installed Apps/1Password/1Password - Threat Intel|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "{{malicious\_confidence}}"<br />\| where !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, city from geo://location on ip = client\_ip<br />\| count by client\_ip, country\_coude, country\_name, city, type, actor, malicious\_confidence, user\_agent, latitude, longitude, target\_user\_name, client\_app\_name, categhory<br />\| sort by \_count |
|1Password|Threat Table|Logs|Installed Apps/1Password/1Password - Threat Intel|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "{{malicious\_confidence}}"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by timestamp, target\_user\_name, malicious\_confidence, client\_ip, actor, type, category, client\_app\_name, client\_platform, country, region, city<br />\| sort by \_count|
|1Password|Threat Table|Logs|1Password/1Password - Threat Intel|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !isBlank(client\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where malicious\_confidence matches "{{malicious\_confidence}}"<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by timestamp, target\_user\_name, malicious\_confidence, client\_ip, actor, type, category, client\_app\_name, client\_platform, country, region, city<br />\| sort by \_count|
|1Password|Top 10 Active Users|Logs|Installed Apps/1Password/1Password - Failed Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by target\_user\_name<br />\| sort by count<br />\| limit 10|
|1Password|Top 10 Active Users|Logs|Installed Apps/1Password/1Password - Successful Sign-ins|\_sourceCategory={{\_sourceCategory}}<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by target\_user\_name<br />\| sort by count<br />\| limit 10|
|1Password|Top 10 Active Users|Logs|1Password/1Password - Successful Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where category matches "\*succ\*"<br />\| count as count by target\_user\_name<br />\| sort by count<br />\| limit 10|
|1Password|Top 10 Active Users|Logs|1Password/1Password - Failed Sign-ins|\_sourceCategory=Labs/onepassword<br />\| json "type", "category", "timestamp",  "details", "target\_user.name", "target\_user.email", "client.app\_name", "client.app\_version", "client.platform\_name", "client.os\_name", "client.os\_version", "client.ip\_address", "location.country", "location.region", "location.city" as type, category, timestamp, details, target\_user\_name, target\_user\_email, client\_app\_name, client\_app\_version, client\_platform, client\_os, client\_os\_version, client\_ip, country, region, city<br />\| where category matches  "{{category}}" AND type matches  "{{type}}" AND country matches  "{{country}}" AND city matches  "{{city}}" AND target\_user\_name matches  "{{target\_user\_name}}" AND client\_app\_name matches  "{{client\_app\_name}}" AND client\_platform matches  "{{client\_platform}}" AND client\_os matches  "{{client\_os}}" <br />\| where !(category matches "\*succ\*")<br />\| count as count by target\_user\_name<br />\| sort by count<br />\| limit 10|

