# Squid Proxy
## Sumo Logic App For: Squid Proxy
The Squid Proxy app is a unified logs and metrics app that helps you monitor activity in Squid Proxy. The preconfigured dashboards provide insight into served and denied requests; performance metrics; IP domain DNS statistics; traffic details; HTTP response codes; URLs experiencing redirects, client errors, and server errors; and quality of service data that helps you understand your users’ experience.
Docs Link: [Squid Proxy](https://help.sumologic.com/?cid=44050)

## Searches

### Log Searches

- **4xx Status Codes by Server**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **5xx Status Codes by Server**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Bytes Served**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Cacheable Content Response Time (ms)**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Quality of Service 
- **Client Errors**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **Client Errors (HTTP Response) - Outlier**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **Denied Request Trend**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Denied Requests**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Destination Experiencing avg response time more than 5 Seconds**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Quality of Service 
- **Destination Locations**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **HTTP Method**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **HTTP Response**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **HTTP Response Trend**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **Non 2xx Response actions**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Overall Content Response Time (ms)**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Quality of Service 
- **Recent Denied Requests**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Redirections**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **Redirections (HTTP Response) - Outlier**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **Remote Hosts Traffic by Requests**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Remote Hosts Traffic by Requests**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Request Trend by Squid Action**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Response Time For TCP_DENIED Action (ms)**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Quality of Service 
- **Response Time For TCP_MISS Action (ms)**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Quality of Service 
- **Response Time For TCP_TUNNEL Action (ms)**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Quality of Service 
- **Server Errors**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **Server Errors (HTTP Response) - Outlier**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **Success (2xx) Response Actions**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Time Spent to Serve Request**: from Dashboard: Squid Proxy/Logs/Squid Proxy - Activity Trend 
- **Top 10 URLs with 4XX Errors**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Top 10 URLs with 5xx Errors**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Top Access Denied URLs**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Top Destination**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Top Remote Hosts**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Top URLs Accessed**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **URLs Experiencing Client Errors**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **URLs Experiencing Redirections**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis 
- **URLs Experiencing Server Errors**: from Dashboard: Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis

### Metric Searches

- **All Requests From  Clients Per Second**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **Amount of CPU Seconds Consumed**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **Average Time For  DNS Service**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Average Time Served For All HTTP Requests**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **Bytes Per Second**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **HTTP Error Per Second**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **HTTP I/O Number of Reads**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **HTTP KB's Received From Clients Per Second**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **HTTP KB's Sent to Clients Per Second**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **HTTP Requests Errors Sent to Clients per Second**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **HTTP Requests Received Per Second**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **KB's of Traffic Received From Servers Per Second**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **KB's of Traffic Sent From Servers Per Second**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **Latency**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Maximum Resident Size**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **Memory Usage Percent**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Number of 
  FQDN Cache Entries**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Number of Current Clients**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Number of External Dns Server Requests**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Number of FQDN Cache Misses**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Number of FQDN Cache Negative Hits**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Number of FQDN Cache Requests**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Number of IP Cache Entries**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Number of IP Cache Hits**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Number of IP Cache Requests**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Number of Objects Stored**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **Page Faults IO**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **Percent of  File Descriptors Used Over Time**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **Percentage Memory Usage Over Time**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **Rate of FQDN Cache Requests**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Rate of IP Cache Hits**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Rate of IP Cache Requests**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics 
- **Requests Per Second**: from Dashboard: Squid Proxy/Squid Proxy - Overview 
- **Reserved Number of File Descriptors**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Performance 
- **Total HTTP KB's for Clients**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **Total HTTP KB's for Servers**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **Total of All Requests From  Clients**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **Total of HTTP Errors Sent  Clients**: from Dashboard: Squid Proxy/Metrics/Squid Proxy - Protocol 
- **Uptime**: from Dashboard: Squid Proxy/Squid Proxy - Overview

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Squid Proxy|4xx Status Codes by Server|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}}  proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| if (isEmpty(pod),\_sourceHost,pod) as \_sourceHost<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| count as count by status\_code,\_sourceHost,proxy\_cluster<br />|
|Squid Proxy|5xx Status Codes by Server|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}}  proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| if (isEmpty(pod),\_sourceHost,pod) as \_sourceHost<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| count as count by status\_code,\_sourceHost,proxy\_cluster<br />|
|Squid Proxy/Metrics|All Requests From  Clients Per Second|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheServerRequests proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta|
|Squid Proxy/Metrics|Amount of CPU Seconds Consumed|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|\_sourceCategory = Labs/squid\* metric=squid\_cacheCpuTime proxy\_cluster={{proxy\_cluster}} host={{host}} \| avg by proxy\_cluster,host|
|Squid Proxy/Metrics|Average Time For  DNS Service|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheDnsSvcTime5 proxy\_cluster={{proxy\_cluster}} host={{host}}|
|Squid Proxy/Metrics|Average Time Served For All HTTP Requests|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|\_sourceCategory = Labs/squid\* metric=squid\_cacheHttpAllSvcTime5 proxy\_cluster=\* host=\*|
|Squid Proxy|Bytes Per Second|Metrics|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* metric=squid\_cacheServerInKb proxy\_cluster={{proxy\_cluster}}  \| avg by proxy\_cluster|
|Squid Proxy/Logs|Bytes Served|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message  nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !isEmpty(method)<br />\| sum(bytes) as %"BytesServed" by method<br />\| sort by %"BytesServed", method asc|
|Squid Proxy/Logs|Cacheable Content Response Time (ms)|Logs|Squid Proxy/Logs/Squid Proxy - Quality of Service|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*\_HIT" or action matches "\*\_MISS"<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy/Logs|Client Errors|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| count as eventCount by status\_code<br />\| sort by eventCount|
|Squid Proxy/Logs|Client Errors (HTTP Response) - Outlier|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| timeslice 15m <br />\| count as clientErrors by \_timeslice <br />\| outlier clientErrors|
|Squid Proxy/Logs|Denied Request Trend|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy \*DENIED\*<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*DENIED\*"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice|
|Squid Proxy|Denied Requests|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} component=proxy proxy\_system=squidproxy \*DENIED\*<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*DENIED\*"<br />\| count as %"DeniedRequests"|
|Squid Proxy/Logs|Destination Experiencing avg response time more than 5 Seconds|Logs|Squid Proxy/Logs/Squid Proxy - Quality of Service|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| lookup latitude, longitude from geo://location on ip=peerhost<br />\| avg (elapsed) as avg\_elapsed by latitude, longitude <br />\| round(avg\_elapsed)<br />\| avg\_elapsed/1000 as avg\_elapsed<br />\| where  avg\_elapsed\> 0<br />\| sort by -  avg\_elapsed <br />\| where !isNull(latitude)<br />|
|Squid Proxy|Destination Locations|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} component=proxy proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| peerhost as dest\_ip<br />\| count by dest\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort by \_count|
|Squid Proxy|HTTP Error Per Second|Metrics|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* metric=squid\_cacheHttpErrors proxy\_cluster={{proxy\_cluster}} \|rate \|sum|
|Squid Proxy/Metrics|HTTP I/O Number of Reads|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|\_sourceCategory = Labs/squid\* metric=squid\_cacheSysNumReads proxy\_cluster={{proxy\_cluster}} host={{host}}\| avg by proxy\_cluster,host|
|Squid Proxy/Metrics|HTTP KB's Received From Clients Per Second|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheHttpInKb proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta|
|Squid Proxy/Metrics|HTTP KB's Sent to Clients Per Second|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheHttpOutKb proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta|
|Squid Proxy|HTTP Method|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster=\* component=proxy proxy\_system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests" by method<br />\| where !isEmpty(method)<br />\| sort %"Requests", method asc|
|Squid Proxy/Metrics|HTTP Requests Errors Sent to Clients per Second|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheHttpErrors proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta|
|Squid Proxy/Metrics|HTTP Requests Received Per Second|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheProtoClientHttpRequests proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta|
|Squid Proxy/Logs|HTTP Response|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !isEmpty(status\_code)<br />\| "" as status\_code\_type<br />\| if(status\_code matches "2\*", "successes", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "3\*", "redirections", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "4\*", "clientErrors", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "5\*", "serverErrors", status\_code\_type) as status\_code\_type <br />\| where status\_code\_type \<\> ""<br />\| count as eventCount by status\_code\_type<br />\| sort by eventCount|
|Squid Proxy/Logs|HTTP Response Trend|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !isEmpty(status\_code)<br />\| "" as status\_code\_type<br />\| if(status\_code matches "2\*", "successes", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "3\*", "redirections", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "4\*", "clientErrors", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "5\*", "serverErrors", status\_code\_type) as status\_code\_type <br />\| where status\_code\_type \<\> ""<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice, status\_code\_type<br />\| transpose row \_timeslice column status\_code\_type|
|Squid Proxy/Metrics|KB's of Traffic Received From Servers Per Second|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheServerInKb proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta|
|Squid Proxy/Metrics|KB's of Traffic Sent From Servers Per Second|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheServerOutKb proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta|
|Squid Proxy|Latency|Metrics|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* metric=squid\_cacheProtoClientHttpRequests proxy\_cluster={{proxy\_cluster}}  \| rate \| avg by metric|
|Squid Proxy/Metrics|Maximum Resident Size|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|\_sourceCategory = Labs/squid\* metric=squid\_cacheMaxResSize proxy\_cluster={{proxy\_cluster}} host={{host}} \| avg by proxy\_cluster,host \| eval \_value/1024|
|Squid Proxy|Memory Usage Percent|Metrics|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* metric=squid\_cacheMemUsage proxy\_cluster={{proxy\_cluster}}|
|Squid Proxy/Logs|Non 2xx Response actions|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !(status\_code matches "2\*") and !isEmpty(status\_code)<br />\| timeslice 1h<br />\| count by \_timeslice, action, status\_code<br />\| transpose row \_timeslice column action, status\_code|
|Squid Proxy/Metrics|Number of <br />  FQDN Cache Entries|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheFqdnEntries proxy\_cluster={{proxy\_cluster}} host={{host}} \| sum|
|Squid Proxy|Number of Current Clients|Metrics|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* metric=squid\_cacheClients proxy\_cluster={{proxy\_cluster}} \| sum|
|Squid Proxy/Metrics|Number of External Dns Server Requests|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheDnsRequests proxy\_cluster={{proxy\_cluster}} host={{host}} \| avg by proxy\_cluster,host\|delta \| filter sum \>0|
|Squid Proxy/Metrics|Number of FQDN Cache Misses|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheFqdnMisses proxy\_cluster={{proxy\_cluster}} host={{host}} \|delta\| filter sum\>0 \| sum|
|Squid Proxy/Metrics|Number of FQDN Cache Negative Hits|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheFqdnNegativeHits proxy\_cluster={{proxy\_cluster}} host={{host}} \|delta\|filter sum\>0\|  sum|
|Squid Proxy/Metrics|Number of FQDN Cache Requests|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheFqdnRequests proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta\| filter sum\>0 \|sum|
|Squid Proxy/Metrics|Number of IP Cache Entries|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheIpEntries proxy\_cluster={{proxy\_cluster}} host={{host}} \| sum|
|Squid Proxy/Metrics|Number of IP Cache Hits|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheIpHits proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta \|filter sum \>0\| sum|
|Squid Proxy/Metrics|Number of IP Cache Requests|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheIpRequests proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta \|filter sum\>0\| sum|
|Squid Proxy/Metrics|Number of Objects Stored|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|\_sourceCategory = Labs/squid\* metric=squid\_cacheNumObjCount proxy\_cluster={{proxy\_cluster}} host={{host}}\| avg by proxy\_cluster,host|
|Squid Proxy/Logs|Overall Content Response Time (ms)|Logs|Squid Proxy/Logs/Squid Proxy - Quality of Service|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy/Metrics|Page Faults IO|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|\_sourceCategory = Labs/squid\* metric=squid\_cacheSysPageFaults proxy\_cluster={{proxy\_cluster}} host={{host}} \| sum|
|Squid Proxy/Metrics|Percent of  File Descriptors Used Over Time|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|(metric=squid\_cacheCurrentFileDescrCnt or metric=squid\_cacheCurrentUnusedFDescrCnt) and proxy\_cluster={{proxy\_cluster}} host={{host}}\| sum by proxy\_cluster,host|
|Squid Proxy/Metrics|Percentage Memory Usage Over Time|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|\_sourceCategory = Labs/squid\* metric=squid\_cacheMemUsage proxy\_cluster={{proxy\_cluster}} host={{host}} \| eval \_value/1024|
|Squid Proxy/Metrics|Rate of FQDN Cache Requests|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheFqdnRequests proxy\_cluster={{proxy\_cluster}} host={{host}} \|rate|
|Squid Proxy/Metrics|Rate of IP Cache Hits|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheIpHits proxy\_cluster={{proxy\_cluster}} host={{host}} \| rate |
|Squid Proxy/Metrics|Rate of IP Cache Requests|Metrics|Squid Proxy/Metrics/Squid Proxy - IP Domain DNS Statistics|\_sourceCategory = Labs/squid\* metric=squid\_cacheIpRequests proxy\_cluster={{proxy\_cluster}} host={{host}} \| rate |
|Squid Proxy/Logs|Recent Denied Requests|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy \*DENIED\*<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| peerhost as dest\_ip<br />\| where action matches "\*DENIED\*"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, remotehost, method, peerstatus, dest\_ip, type, action, status\_code, url<br />\| sort by \_timeslice|
|Squid Proxy/Logs|Redirections|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "3\*"<br />\| count as eventCount by status\_code<br />\| sort by eventCount|
|Squid Proxy/Logs|Redirections (HTTP Response) - Outlier|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "3\*"<br />\| timeslice 15m <br />\| count as redirections by \_timeslice <br />\| outlier redirections|
|Squid Proxy/Logs|Remote Hosts Traffic by Requests|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests", sum(bytes) as bytes by remotehost<br />\| bytes / (1024 \* 1024) as MegaBytes<br />\| where !isEmpty(remotehost)<br />\| total %"MegaBytes" as total\_MegaBytes<br />\| total %"Requests" as %"Total\_Requests"<br />\| %"MegaBytes"/total\_MegaBytes\*100 as %"% Total MegaBytes"<br />\| %"Requests"/%"Total\_Requests"\*100 as %"% Total\_Requests"<br />\| sort by %"% Total\_Requests"<br />\| fields remotehost, %"Requests", %"% Total\_Requests", %"MegaBytes", %"% Total MegaBytes"|
|Squid Proxy/Logs|Remote Hosts Traffic by Requests|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests", sum(bytes) as bytes by remotehost<br />\| bytes / (1024 \* 1024) as MegaBytes<br />\| where !isEmpty(remotehost)<br />\| total %"MegaBytes" as total\_MegaBytes<br />\| total %"Requests" as %"Total\_Requests"<br />\| %"MegaBytes"/total\_MegaBytes\*100 as %"% Total MegaBytes"<br />\| %"Requests"/%"Total\_Requests"\*100 as %"% Total\_Requests"<br />\| sort by %"% Total\_Requests"<br />\| fields remotehost, %"Requests", %"% Total\_Requests", %"MegaBytes", %"% Total MegaBytes"|
|Squid Proxy/Logs|Request Trend by Squid Action|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| timeslice 1h<br />\| count as %"Requests" by \_timeslice, action<br />\| transpose row \_timeslice column action|
|Squid Proxy|Requests Per Second|Metrics|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* metric=squid\_cacheProtoClientHttpRequests proxy\_cluster={{proxy\_cluster}}  \| rate\|avg by proxy\_cluster |
|Squid Proxy/Metrics|Reserved Number of File Descriptors|Metrics|Squid Proxy/Metrics/Squid Proxy - Performance|\_sourceCategory = Labs/squid\* metric=squid\_cacheCurrentResFileDescrCnt proxy\_cluster={{proxy\_cluster}} host={{host}} \| avg by proxy\_cluster,host|
|Squid Proxy/Logs|Response Time For TCP\_DENIED Action (ms)|Logs|Squid Proxy/Logs/Squid Proxy - Quality of Service|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "TCP\_DENIED"<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy/Logs|Response Time For TCP\_MISS Action (ms)|Logs|Squid Proxy/Logs/Squid Proxy - Quality of Service|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "TCP\_MISS"<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy/Logs|Response Time For TCP\_TUNNEL Action (ms)|Logs|Squid Proxy/Logs/Squid Proxy - Quality of Service|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*\_TUNNEL"<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy/Logs|Server Errors|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| count as eventCount by status\_code<br />\| sort by eventCount|
|Squid Proxy/Logs|Server Errors (HTTP Response) - Outlier|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| timeslice 15m <br />\| count as serverErrors by \_timeslice <br />\| outlier serverErrors|
|Squid Proxy/Logs|Success (2xx) Response Actions|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "2\*"<br />\| timeslice 1h<br />\| count by \_timeslice, action, status\_code<br />\| transpose row \_timeslice column action, status\_code|
|Squid Proxy/Logs|Time Spent to Serve Request|Logs|Squid Proxy/Logs/Squid Proxy - Activity Trend|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !isEmpty(method)<br />\| avg(elapsed) as TimeSpent by method<br />\| TimeSpent / 1000 as %"AvgTimeSpentInSec"<br />\| fields - TimeSpent<br />\| sort by %"AvgTimeSpentInSec"|
|Squid Proxy|Top 10 URLs with 4XX Errors|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}}  proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by eventCount, url asc \| limit 10|
|Squid Proxy|Top 10 URLs with 5xx Errors|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}}  proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by eventCount, url asc \| limit 10|
|Squid Proxy|Top Access Denied URLs|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} component=proxy proxy\_system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*\_DENIED"<br />\| count as %"Requests" by url<br />\| where !isEmpty(url)<br />\| top 10 url by %"Requests", url asc<br />\| urldecode(url) as url|
|Squid Proxy|Top Destination|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} component=proxy proxy\_system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| peerhost as dest\_ip<br />\| count as %"Requests" by dest\_ip<br />\| where !isEmpty(dest\_ip)<br />\| Top 10 dest\_ip by %"Requests"|
|Squid Proxy|Top Remote Hosts|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} component=proxy proxy\_system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests" by remotehost<br />\| where !isEmpty(remotehost)<br />\| top 10 remotehost by %"Requests"|
|Squid Proxy|Top URLs Accessed|Logs|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} proxy\_system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests" by url<br />\| where !isEmpty(url)<br />\| top 10 url by %"Requests", url asc<br />\| urldecode(url) as url|
|Squid Proxy/Metrics|Total HTTP KB's for Clients|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* (metric=squid\_cacheHttpInKb or metric=squid\_cacheHttpOutKb ) proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta \|filter sum\>0\| sum \| eval \_value/1024|
|Squid Proxy/Metrics|Total HTTP KB's for Servers|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* (metric=squid\_cacheServerInKb or metric=squid\_cacheServerOutKb ) proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta \|filter sum\>0\| sum \| eval \_value/1024|
|Squid Proxy/Metrics|Total of All Requests From  Clients|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheServerRequests proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta \| filter sum\>0\|sum|
|Squid Proxy/Metrics|Total of HTTP Errors Sent  Clients|Metrics|Squid Proxy/Metrics/Squid Proxy - Protocol|\_sourceCategory = Labs/squid\* metric=squid\_cacheHttpErrors proxy\_cluster={{proxy\_cluster}} host={{host}} \| delta \| filter sum\>0 \|sum|
|Squid Proxy|Uptime|Metrics|Squid Proxy/Squid Proxy - Overview|\_sourceCategory = Labs/squid\* metric=squid\_uptime proxy\_cluster={{proxy\_cluster}} \| avg by host,version \| eval \_value/(100\*3600)|
|Squid Proxy/Logs|URLs Experiencing Client Errors|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by status\_code, eventCount, url|
|Squid Proxy/Logs|URLs Experiencing Redirections|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "3\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by status\_code, eventCount, url|
|Squid Proxy/Logs|URLs Experiencing Server Errors|Logs|Squid Proxy/Logs/Squid Proxy - HTTP Response Analysis|\_sourceCategory = Labs/squid\* proxy\_cluster={{proxy\_cluster}} (\_sourcehost={{host}} or pod={{host}}) proxy\_system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by status\_code, eventCount, url|

