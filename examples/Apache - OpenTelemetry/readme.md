# Apache - OpenTelemetry

## Searches

### Log Searches

- **4xx Status Codes by Server**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **5xx Status Codes by Server**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Browsers and Operating Systems**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types 
- **Bytes Served**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight 
- **Bytes Served - Outlier**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Outlier Analysis 
- **Client Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Outlier Analysis 
- **Client Locations - 4xx Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Client Locations with Critical Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Critical Error Messages**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Critical Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Desktop OS Versions**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types 
- **Error Log Levels**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Error Log Levels**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Error Responses by Server**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Highly Malicious Threats**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis 
- **HTTP Methods**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight 
- **Log Level - One Day Time Comparison**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Log Reduce**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Media Types Served**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight 
- **Messages by Log Level - Over Time**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Non 200 Response Status Codes**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends 
- **Number of Requests by Client - One Day Time Comparison**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Number of Visitors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Outlier Analysis 
- **Popular Mobile Device Versions**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types 
- **Responses Over Time**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends 
- **Responses Over Time**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Server Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Outlier Analysis 
- **Server Errors Over Time**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Threat Count**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis 
- **Threat Locations**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis 
- **Threats by Actors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis 
- **Threats by Malicious Confidence**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis 
- **Threats by Source**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis 
- **Top 10 Bots Observed**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Top 10 Errors from Error Log Files**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Top 10 Messages**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight 
- **Top 10 Threats**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis 
- **Top 10 URLs with 4xx Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Top 10 URLs with 5xx Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Top 5 Clients Causing 5xx Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Top 5 Clients Causing Errors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis 
- **Top 5 Critical Messages**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Top 5 Highly Malicious URLs**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis 
- **Top 5 Referrers**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight 
- **Top 5 Urls**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight 
- **Top 5 URLs Causing 4xx Responses**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Top 5 URLs Causing 5xx Responses**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations 
- **Traffic Distribution by Server**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends 
- **Traffic Volume and Bytes Served**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends 
- **Unique Visitors**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types 
- **United States**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Locations 
- **Visitor Locations**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends 
- **Visitor Platforms**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types 
- **Visitor Platforms Over Time**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types 
- **Visits by Country Over Time**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Locations 
- **Visits by US Regions Over Time**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Locations 
- **Worldwide**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Locations

### Metric Searches

- **Busy Worker Threads**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **Bytes (Sent and Received) Per Request**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status 
- **Bytes (Sent and Received) Per Second**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status 
- **Bytes Per Second**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Closing**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **CPU Children System Utilization**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **CPU Children User Utilization**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **CPU Load Utilization**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **CPU System Utilization**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **CPU User Utilization**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **DNS LookUp**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Duration Per Request**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status 
- **Finishing**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Idle Cleanup**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Idle Worker Threads**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **Keep Alive**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Load Average - 15m**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **Load Average - 1m**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **Load Average - 5m**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization 
- **Logging**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Open**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Reading**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Request Per Second**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Request Per Second**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status 
- **Request Per Second**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status 
- **Sending**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Starting**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis 
- **Time Spend on Handling request**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status 
- **Uptime**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Apache - Overview 
- **Uptime**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status 
- **Waiting**: from Dashboard: Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Apache - OpenTelemetry|4xx Status Codes by Server|Logs|Installed Apps/Apache - OpenTelemetry/Apache - Overview| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "4\*"<br />\| count as count by webengine.node.name, webengine.cluster.name|
|Apache - OpenTelemetry|5xx Status Codes by Server|Logs|Installed Apps/Apache - OpenTelemetry/Apache - Overview| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "5\*"<br />\| count as count by  webengine.node.name, webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Browsers and Operating Systems|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| if (user\_agent matches "\*Windows \*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*Win64\*","Windows","") as OS <br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Darwin/\*" OR user\_agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (user\_agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (user\_agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (user\_agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND user\_agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (user\_agent matches "\*Mobile/\*" OR user\_agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND user\_agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (user\_agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (user\_agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (user\_agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (user\_agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser  <br />\| count by OS,browser<br />\| transpose row browser column os|
|Apache - OpenTelemetry/Metrics|Busy Worker Threads|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization| sumo.datasource=apache metric=apache.workers state=busy webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Bytes (Sent and Received) Per Request|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status|sumo.datasource=apache metric=apache.traffic   webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Bytes (Sent and Received) Per Second|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status|sumo.datasource=apache metric=apache.traffic webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}   \| avg by webengine.cluster.name|
|Apache - OpenTelemetry|Bytes Per Second|Metrics|Installed Apps/Apache - OpenTelemetry/Apache - Overview|sumo.datasource=apache metric=apache.traffic webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Bytes Served|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| sum(size) as Bytes\_Served<br />\| Bytes\_Served/(1024\*1024\*1000) as Gbytes\_Served<br />\| fields Gbytes\_Served|
|Apache - OpenTelemetry/Logs|Bytes Served - Outlier|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Outlier Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where size != "-" and !isEmpty(size)<br />\| number(size)<br />\| (size/(1048576\*1000)) as gbytes <br />\| timeslice {{timeslice}} <br />\| sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier gbytes window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+-|
|Apache - OpenTelemetry/Logs|Client Errors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Outlier Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP 4\*<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where (status\_code matches "4\*") <br />\| timeslice {{timeslice}}<br />\| count as client\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier client\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache - OpenTelemetry/Logs|Client Locations - 4xx Errors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP (40\* OR 41\* OR 42\* OR 43\* or 44\* OR 45\* or 49\*)<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "4\*" <br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Apache - OpenTelemetry/Logs|Client Locations with Critical Errors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} ("emerg" OR "alert" OR "crit") <br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg " \\[(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg "\\[client (?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Apache - OpenTelemetry/Metrics|Closing|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=closing webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|CPU Children System Utilization|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization|sumo.datasource=apache metric=apache.cpu.time mode=system level=children webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}   \| avg by webengine.cluster.name |
|Apache - OpenTelemetry/Metrics|CPU Children User Utilization|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization|sumo.datasource=apache metric=apache.cpu.time mode=user level=children webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name |
|Apache - OpenTelemetry/Metrics|CPU Load Utilization|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization|sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  metric=apache.cpu.load \| avg by webengine.cluster.name |
|Apache - OpenTelemetry/Metrics|CPU System Utilization|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization|sumo.datasource=apache metric=apache.cpu.time mode=system webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}   \| avg by webengine.cluster.name |
|Apache - OpenTelemetry/Metrics|CPU User Utilization|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization|sumo.datasource=apache metric=apache.cpu.time mode=user webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}   \| avg by webengine.cluster.name |
|Apache - OpenTelemetry|Critical Error Messages|Logs|Installed Apps/Apache - OpenTelemetry/Apache - Overview| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} (emerg or alert or crit) <br />// Error Logs<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^\\[[^]]\*]\\s\\[(?\<log\_level\>[a-z:]+)\\]" nodrop<br />\| parse regex field=mesg "\\[[^]]\*]\\s\\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop<br />\| where log\_level in ("emerg", "alert", "crit") // emerg:	System is unusable, alert:	Action must be taken immediately, crit	Critical conditions<br />\| parse field=mesg "[error] \*" as error\_mesg nodrop<br />\| parse field=mesg "[client \*] \*" as src\_ip, error\_mesg nodrop<br />\| count|
|Apache - OpenTelemetry/Logs|Critical Errors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} AND ("emerg" OR "alert" OR "crit") <br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "(?:\\d{4}\\]\|\\[client .+?\\]\|\\[[a-z0-9:-]+?\\]) (?\<reason\>[a-zA-Z].+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?:.+?) (?\<file\>/[a-zA-Z0-9\\.\_].+?)(?:\$\|, \|: \| on line\| (?i)http/1.(?:0\|1))"  nodrop <br />\| parse regex field=mesg " (?\<file\>[a-zA-Z]:\\\\.+?)(?:\$\|, \|: \| on line)" nodrop <br />\| parse regex field=mesg "\\[client (?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop <br />\| parse regex field=mesg "\\[client .+?:(?\<src\_port\>[0-9][0-9]+)\\] " nodrop <br />\| parse regex field=mesg "referer: (?\<referrer\>.+)\$"  nodrop <br />\| parse regex field=mesg " \\[(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg "(?\<reason\>Forbidden): (?\<file\>.+?) doesn't point to a file or directory" nodrop <br />\| parse regex field=mesg "(?\<reason\>Handler for .+? returned invalid result code [0-9]+)" nodrop <br />\| parse regex field=mesg "(?\<reason\>Invalid [a-zA-Z]+ in request) (?\<request\>.+?)(?:\$\| - .+\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "Invalid [a-zA-Z]+ in request .+? (?\<url\>/.+?)(?:\$\|, \|: \| (?i)http/1.(?:0\|1))" nodrop <br />\| parse regex field=mesg "(?\<reason\>Script timed out before returning headers): (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>Symbolic link not allowed.\*?): (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>configuration error):  couldn't .+?: (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>dir\_walk error), .+? filename (?:path\|)(?\<file\>.+?) for uri (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>handler .+? not found) for: (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>need Auth.+?): (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "Cannot map (?\<request\>.+?) to file" nodrop <br />\| parse regex field=mesg "(?:\\d{4}\\]\|\\[client .+?\\]\|\\[[a-z0-9:-]+?\\]) (?\<file\>(?:/[a-zA-Z0-9\\.\_].+?\|[a-zA-Z]:\\\\.+?)) pcfg\_openfile: (?\<reason\>unable to check htaccess file), ensure it is readable" nodrop <br />\| parse regex field=mesg "access to (?\<url\>.+?) (?:denied\|failed)" nodrop <br />\| parse regex field=mesg "access to (?\<file\>.+?) (?:denied\|failed)" nodrop <br />\| parse regex field=mesg "access to (?\<url\>.+?) failed; stat of '(?\<file\>.+?)' failed." nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg " \\[pid (?\<process\_id\>[0-9]+)\\] (?\<reason\>[a-zA-Z].\*)" nodrop <br />\| parse regex field=mesg " \\[pid (?\<process\_id\>[0-9]+):tid (?\<thread\_id\>[0-9]+)\\]" nodrop <br />\| parse regex field=mesg "(?\<reason\>Buggy authn provider failed to set user) for (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "Evaluation of .\*?expression from (?\<file\>.+?):[0-9]+ " nodrop <br />\| parse regex field=mesg "(?\<reason\>Invalid status line from script) '(?\<file\>.+?)':" nodrop <br />\| parse regex field=mesg "(?\<reason\>client submitted cookie '.\*?' more than once): (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>malformed header from script) '(?\<file\>.+?)':" nodrop <br />\| parse regex field=mesg "\\[client (?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<reason\>[a-zA-Z].+?)" nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] (?\<reason\>[a-zA-Z].\*)" nodrop <br />\| parse regex field=mesg " \\[pid (?\<process\_id\>[0-9]+):tid (?\<thread\_id\>[0-9]+)\\] (?\<reason\>[a-zA-Z].\*)" nodrop <br /><br />// 2.2 specific<br />\| parse regex field=mesg "(?\<reason\>client used wrong authentication scheme): (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop<br />\| parse regex field=mesg "(?\<reason\>File does not exist): (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>Invalid [a-zA-Z]+ in request) (?\<request\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>Premature end of script headers): (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>client sent HTTP/1.1 request without hostname) \\(.+?\\): (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| where log\_level in ("emerg", "alert", "crit")<br />\| timeslice 1s<br />\| count as count by \_timeslice, webengine.cluster.name, log\_level, reason<br />\| sort by \_timeslice<br />\| limit 100|
|Apache - OpenTelemetry/Logs|Desktop OS Versions|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP ("macintosh" OR "mac os" OR "windows" OR "i686" or "PC" or ("Linux" AND !android))<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| parse regex field=user\_agent "(?\<os\>Mac OS) (?\<version\>[^;\\)]+?)(?:;\|\\))" nodrop <br />\| parse regex field=user\_agent "(?\<os\>Windows)(?: NT \| )(?\<version\>[\\d.]+)" nodrop <br />\| parse regex field=user\_agent "(?\<os\>Linux) (?\<version\>\\S+?)(?:\\)\|;)" nodrop <br />\| where os != ""<br />\| count as count by os, version<br />\| transpose row version column os|
|Apache - OpenTelemetry/Metrics|DNS LookUp|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=dnslookup webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Duration Per Request|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status|sumo.datasource=apache metric=apache.request.time   webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Error Log Levels|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />// Error Logs<br />\| parse regex field=mesg "^\\[[^]]\*]\\s\\[(?\<log\_level\>[a-z]+)\\]" nodrop<br />\| parse regex field=mesg "\\[[^]]\*]\\s\\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop<br />\| count as count by log\_level<br />\| where !isEmpty(log\_level) and log\_level not in ("en")<br />\| sort count, log\_level asc|
|Apache - OpenTelemetry/Logs|Error Log Levels|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />// Error Logs<br />\| parse regex field=mesg "^\\[[^]]\*]\\s\\[(?\<log\_level\>[a-z]+)\\]" nodrop<br />\| parse regex field=mesg "\\[[^]]\*]\\s\\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop<br />\| count as count by log\_level<br />\| where !isBlank(log\_level)<br />\| sort count, log\_level asc|
|Apache - OpenTelemetry/Logs|Error Responses by Server|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, webengine.node.name<br />\| transpose row \_timeslice column webengine.node.name|
|Apache - OpenTelemetry/Metrics|Finishing|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=finishing webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Highly Malicious Threats|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis|sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as threat\_count by src\_ip, method, status\_code, size, referrer, user\_agent, url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence) and malicious\_confidence matches "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(threat\_count) as threat\_count by src\_ip, method, status\_code, size, url, referrer, user\_agent, malicious\_confidence, actor<br />\| sort by threat\_count<br />\| limit 20|
|Apache - OpenTelemetry/Logs|HTTP Methods|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where !isBlank(method)<br />\| count as count by method<br />\| sort by count, method asc<br />\| limit 5|
|Apache - OpenTelemetry/Metrics|Idle Cleanup|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis|sumo.datasource=apache metric=apache.scoreboard state=idle\_cleanup webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Idle Worker Threads|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization| sumo.datasource=apache metric=apache.workers state=idle webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Keep Alive|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=keepalive webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Load Average - 15m|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization|sumo.datasource=apache metric=apache.load.15  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Load Average - 1m|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization|sumo.datasource=apache metric=apache.load.1  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Load Average - 5m|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Resource Utilization|sumo.datasource=apache metric=apache.load.5  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Log Level - One Day Time Comparison|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg " \\[(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| where !isEmpty(log\_level) and log\_level not in ("en")<br />\| count as count by log\_level<br />\| sort by count<br />\| compare with timeshift 1d|
|Apache - OpenTelemetry/Logs|Log Reduce|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis|sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg " \\[(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] (?\<reason\>[a-zA-Z].\*)" nodrop <br />\| where !isBlank(log\_level) and log\_level not in ("en")<br />\| logreduce(mesg) by webengine.cluster.name limit=25<br />\| \_count as count \| fields -\_count \| sort by count, signature asc|
|Apache - OpenTelemetry/Metrics|Logging|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=logging webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Media Types Served|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| parse regex field=url "^/[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$" nodrop<br />\| parse regex field=url "/\\S+?(?\<email\_prefix\>(?:%40\|@)[^.]+?)\\.\\w+" nodrop <br />\| where email\_prefix = "" and !isBlank(type)<br />\| count as count by type<br />\| sort count, type asc|
|Apache - OpenTelemetry/Logs|Messages by Log Level - Over Time|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />// Error Logs<br />\| parse regex field=mesg "^\\[[^]]\*]\\s\\[(?\<log\_level\>[a-z]+)\\]" nodrop<br />\| parse regex field=mesg "\\[[^]]\*]\\s\\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop<br />\| where !isEmpty(log\_level) and log\_level not in ("en")<br />\| timeslice 1h<br />\| count by \_timeslice, log\_level<br />\| transpose row \_timeslice column log\_level|
|Apache - OpenTelemetry/Logs|Non 200 Response Status Codes|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where !(status\_code matches "2\*")<br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|Apache - OpenTelemetry/Logs|Number of Hits by Server - One Day Time Comparison|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as Number\_of\_Hits by webengine.node.name  <br />\| compare with timeshift 1d|
|Apache - OpenTelemetry/Logs|Number of Requests by Client - One Day Time Comparison|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg " \\[(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg "\\[client (?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| where !isEmpty(log\_level) and log\_level not in ("en") and !isEmpty(src\_ip)<br />\| count as count by src\_ip<br />\| sort by count<br />\| compare with timeshift 1d|
|Apache - OpenTelemetry/Logs|Number of Visitors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Outlier Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where !isEmpty(src\_ip)<br />\| timeslice {{timeslice}}<br />\| count as hits by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier hits window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache - OpenTelemetry/Metrics|Open|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=open webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Popular Mobile Device Versions|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP (iphone or ipad or android or samsung)<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| parse regex field=mesg "\\((?\<device\>iPhone).+? CPU iPhone OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex field=mesg "\\((?\<device\>iPad).+? CPU OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex field=mesg " (?\<device\>Android) (?\<version\>[\\d\\.]+)" nodrop <br />\| parse regex field=mesg "(?\<device\>SAMSUNG).+?(?\<version\>(?:GT-\\w+\|SGH-\\w+\|SPH-\\w+\|SCH-\\w+))" nodrop<br />\| where device != ""<br />\| count as count by device, version <br />\| transpose row version column device|
|Apache - OpenTelemetry/Metrics|Reading|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=reading webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry|Request Per Second|Metrics|Installed Apps/Apache - OpenTelemetry/Apache - Overview|sumo.datasource=apache metric=apache.requests webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Request Per Second|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status| sumo.datasource=apache metric=apache.requests webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Metrics|Request Per Second|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status| sumo.datasource=apache metric=apache.requests webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| avg by webengine.cluster.name|
|Apache - OpenTelemetry|Responses Over Time|Logs|Installed Apps/Apache - OpenTelemetry/Apache - Overview|sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| if(status\_code matches "2\*", 1, 0) as successes <br />\| if(status\_code matches "3\*", 1, 0) as redirects <br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1h <br />\| sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice|
|Apache - OpenTelemetry/Logs|Responses Over Time|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| if(status\_code matches "2\*", 1, 0) as successes <br />\| if(status\_code matches "3\*", 1, 0) as redirects <br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 5m<br />\| sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice|
|Apache - OpenTelemetry/Metrics|Sending|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=sending webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Server Errors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Outlier Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP 5\*<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where (status\_code matches "5\*") <br />\| timeslice {{timeslice}}<br />\| count as server\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier server\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache - OpenTelemetry/Logs|Server Errors Over Time|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP (50\* or 51\* or 52\* or 53\* or 59\*)<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, status\_code<br />\| transpose row \_timeslice column status\_code as \*|
|Apache - OpenTelemetry/Metrics|Starting|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=starting webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Threat Count|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(ip\_count) as threat\_count|
|Apache - OpenTelemetry/Logs|Threat Locations|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Apache - OpenTelemetry/Logs|Threats by Actors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (ip\_count) as threat\_count by Actor|
|Apache - OpenTelemetry/Logs|Threats by Malicious Confidence|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (ip\_count) as threat\_count by malicious\_confidence|
|Apache - OpenTelemetry/Logs|Threats by Source|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as ip\_count by src\_ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| \_source as source<br />\| sum (ip\_count) as threat\_count by source |
|Apache - OpenTelemetry/Metrics|Time Spend on Handling request|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status|sumo.datasource=apache metric=apache.request.time  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}} \| avg by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Top 10 Bots Observed|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Exabot?)\\W" nodrop<br />\| where bot\_name != ""<br />\| if (bot\_name="bing", "Bing", bot\_name) as bot\_name<br />\| count as count by bot\_name<br />\| sort by count, bot\_name asc|
|Apache - OpenTelemetry/Logs|Top 10 Errors from Error Log Files|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />// Error Logs<br />\| parse regex field=mesg "^\\[[^]]\*]\\s\\[(?\<log\_level\>[a-z]+)\\]" nodrop<br />\| parse regex field=mesg "\\[[^]]\*]\\s\\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop<br />\| parse field=mesg "[error] \*" as error\_mesg nodrop<br />\| parse field=mesg "[client \*] \*" as src\_ip, error\_mesg nodrop<br />\| where !isBlank(error\_mesg) and !isBlank(log\_level)<br />\| count as count by error\_mesg <br />\| sort count, error\_mesg asc<br />\| limit 10|
|Apache - OpenTelemetry/Logs|Top 10 Messages|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "(?:\\d{4}\\]\|\\[client .+?\\]\|\\[[a-z0-9:-]+?\\]) (?\<reason\>[a-zA-Z].+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?:.+?) (?\<file\>/[a-zA-Z0-9\\.\_].+?)(?:\$\|, \|: \| on line\| (?i)http/1.(?:0\|1))"  nodrop <br />\| parse regex field=mesg " (?\<file\>[a-zA-Z]:\\\\.+?)(?:\$\|, \|: \| on line)" nodrop <br />\| parse regex field=mesg "\\[client (?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop <br />\| parse regex field=mesg "\\[client .+?:(?\<src\_port\>[0-9][0-9]+)\\] " nodrop <br />\| parse regex field=mesg "referer: (?\<referrer\>.+)\$"  nodrop <br />\| parse regex field=mesg " \\[(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg "(?\<reason\>Forbidden): (?\<file\>.+?) doesn't point to a file or directory" nodrop <br />\| parse regex field=mesg "(?\<reason\>Handler for .+? returned invalid result code [0-9]+)" nodrop <br />\| parse regex field=mesg "(?\<reason\>Invalid [a-zA-Z]+ in request) (?\<request\>.+?)(?:\$\| - .+\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "Invalid [a-zA-Z]+ in request .+? (?\<url\>/.+?)(?:\$\|, \|: \| (?i)http/1.(?:0\|1))" nodrop <br />\| parse regex field=mesg "(?\<reason\>Script timed out before returning headers): (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>Symbolic link not allowed.\*?): (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>configuration error):  couldn't .+?: (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>dir\_walk error), .+? filename (?:path\|)(?\<file\>.+?) for uri (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>handler .+? not found) for: (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>need Auth.+?): (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "Cannot map (?\<request\>.+?) to file" nodrop <br />\| parse regex field=mesg "(?:\\d{4}\\]\|\\[client .+?\\]\|\\[[a-z0-9:-]+?\\]) (?\<file\>(?:/[a-zA-Z0-9\\.\_].+?\|[a-zA-Z]:\\\\.+?)) pcfg\_openfile: (?\<reason\>unable to check htaccess file), ensure it is readable" nodrop <br />\| parse regex field=mesg "access to (?\<url\>.+?) (?:denied\|failed)" nodrop <br />\| parse regex field=mesg "access to (?\<file\>.+?) (?:denied\|failed)" nodrop <br />\| parse regex field=mesg "access to (?\<url\>.+?) failed; stat of '(?\<file\>.+?)' failed." nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg " \\[pid (?\<process\_id\>[0-9]+)\\] (?\<reason\>[a-zA-Z].\*)" nodrop <br />\| parse regex field=mesg " \\[pid (?\<process\_id\>[0-9]+):tid (?\<thread\_id\>[0-9]+)\\]" nodrop <br />\| parse regex field=mesg "(?\<reason\>Buggy authn provider failed to set user) for (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "Evaluation of .\*?expression from (?\<file\>.+?):[0-9]+ " nodrop <br />\| parse regex field=mesg "(?\<reason\>Invalid status line from script) '(?\<file\>.+?)':" nodrop <br />\| parse regex field=mesg "(?\<reason\>client submitted cookie '.\*?' more than once): (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>malformed header from script) '(?\<file\>.+?)':" nodrop <br />\| parse regex field=mesg "\\[client (?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<reason\>[a-zA-Z].+?)" nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] (?\<reason\>[a-zA-Z].\*)" nodrop <br />\| parse regex field=mesg " \\[pid (?\<process\_id\>[0-9]+):tid (?\<thread\_id\>[0-9]+)\\] (?\<reason\>[a-zA-Z].\*)" nodrop <br /><br />// 2.2 specific<br />\| parse regex field=mesg "(?\<reason\>client used wrong authentication scheme): (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop<br />\| parse regex field=mesg "(?\<reason\>File does not exist): (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>Invalid [a-zA-Z]+ in request) (?\<request\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>Premature end of script headers): (?\<file\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| parse regex field=mesg "(?\<reason\>client sent HTTP/1.1 request without hostname) \\(.+?\\): (?\<url\>.+?)(?:\$\|, referer.+\$)" nodrop <br />\| where !isEmpty(log\_level) and log\_level not in ("en") and !isEmpty(reason)<br />\| count as count by reason<br />\| sort by count, reason asc \| limit 10|
|Apache - OpenTelemetry/Logs|Top 10 Search Terms from Popular Search Engines|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP (google OR bing OR aol OR ask OR yahoo) ("p=" OR "q=" OR "wd=" OR "searchfor=")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where !isBlank(search\_term)<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*","Google","") as engine<br />\| if(referrer matches "\*bing.\*","Bing",engine) as engine<br />\| if(referrer matches "\*ask.com\*","Ask.com",engine) as engine<br />\| if(referrer matches "\*aol.\*","AOL",engine) as engine<br />\| if(referrer matches "\*yahoo.\*","Yahoo",engine) as engine<br />\| where !isBlank(engine) <br />\| count as count by search\_term<br />\| sort count, search\_term asc<br />\| limit 10|
|Apache - OpenTelemetry/Logs|Top 10 Threats|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as threat\_count by src\_ip, method, status\_code, size, referrer, user\_agent, url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(threat\_count) as request\_count by src\_ip, method, status\_code, size, url, referrer, user\_agent, malicious\_confidence, actor<br />\| sort by request\_count<br />\| limit 10|
|Apache - OpenTelemetry|Top 10 URLs with 4xx Errors|Logs|Installed Apps/Apache - OpenTelemetry/Apache - Overview| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "4\*"<br />\| count as count by url, status\_code<br />\| sort by count, url asc \| limit 10|
|Apache - OpenTelemetry|Top 10 URLs with 5xx Errors|Logs|Installed Apps/Apache - OpenTelemetry/Apache - Overview| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "5\*"<br />\| count as count by url, status\_code<br />\| sort by count, url asc \| limit 10|
|Apache - OpenTelemetry/Logs|Top 5 Clients Causing 4xx Errors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP (40\* OR 41\* OR 42\* OR 43\* OR 44\* or 45\* or 49\*)<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "4\*"<br />\| count as count by src\_ip<br />\| sort count, src\_ip asc<br />\| limit 5|
|Apache - OpenTelemetry/Logs|Top 5 Clients Causing 5xx Errors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP (40\* OR 41\* OR 42\* OR 43\* OR 44\* or 45\* or 49\*)<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "5\*"<br />\| count as count by src\_ip<br />\| sort count, src\_ip asc<br />\| limit 5|
|Apache - OpenTelemetry/Logs|Top 5 Clients Causing Errors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Error Log Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}}<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg " \\[(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop <br />\| parse regex field=mesg "\\[client (?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "\\[client (?\<src\_ip\>[a-f0-1:]\*)\\] " nodrop <br />\| where !isEmpty(log\_level) and log\_level not in ("en") and !isEmpty(src\_ip)<br />\| count as count by src\_ip \| sort by count, src\_ip asc<br />\| limit 5|
|Apache - OpenTelemetry|Top 5 Critical Messages|Logs|Installed Apps/Apache - OpenTelemetry/Apache - Overview| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} (emerg or alert or crit) <br />// Error Logs<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^\\[[^]]\*]\\s\\[(?\<log\_level\>[a-z:]+)\\]" nodrop<br />\| parse regex field=mesg "\\[[^]]\*]\\s\\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] " nodrop<br />\| where log\_level in ("emerg", "alert", "crit") // emerg:	System is unusable, alert:	Action must be taken immediately, crit	Critical conditions<br />\| parse field=mesg "[error] \*" as error\_mesg nodrop<br />\| parse field=mesg "[client \*] \*" as src\_ip, error\_mesg<br />\| parse regex field=mesg " \\[(?\<module\>[a-z-\_]+):(?\<log\_level\>[a-z]+)\\] (?\<error\_mesg\>.\*)" nodrop <br />\| parse regex field=mesg " \\[pid (?\<process\_id\>[0-9]+)\\] (?\<error\_mesg\>[a-zA-Z].\*)" nodrop <br />\| parse regex field=mesg " \\[pid (?\<process\_id\>[0-9]+):tid (?\<thread\_id\>[0-9]+)\\] (?\<error\_mesg\>[a-zA-Z].\*)" nodrop <br />\| count as count by error\_mesg, webengine.cluster.name<br />\| sort by count<br />\| limit 5|
|Apache - OpenTelemetry/Logs|Top 5 Highly Malicious URLs|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Threat Analysis| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count as ip\_count by src\_ip, url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| where malicious\_confidence matches "high"<br />\| count by url<br />\| limit 5|
|Apache - OpenTelemetry/Logs|Top 5 Referrers|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where !isBlank(referrer)<br />\| count as count by referrer<br />\| sort by count, referrer asc<br />\| limit 5 |
|Apache - OpenTelemetry/Logs|Top 5 Urls|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Traffic Insight| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where !isBlank(url)<br />\| count as count by url<br />\| sort by count, url asc<br />\| limit 5|
|Apache - OpenTelemetry/Logs|Top 5 URLs Causing 4xx Responses|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "4\*"<br />\| count as count by url<br />\| sort count, url asc<br />\| limit 5|
|Apache - OpenTelemetry/Logs|Top 5 URLs Causing 5xx Responses|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Web Server Operations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where status\_code matches "5\*"<br />\| count as count by url<br />\| sort count, url asc<br />\| limit 5|
|Apache - OpenTelemetry/Logs|Traffic Distribution by Server|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| timeslice 5m<br />\| count by \_timeslice, webengine.node.name  <br />\| transpose row \_timeslice column webengine.node.name|
|Apache - OpenTelemetry/Logs|Traffic Volume and Bytes Served|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| where size != "-" and !isEmpty(size)<br />\| (size/(1048576\*1000)) as gbytes <br />\| timeslice 5m<br />\| count as hits, sum(gbytes) as gbytes by \_timeslice |
|Apache - OpenTelemetry/Logs|Unique Visitors|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count\_distinct(src\_ip) as unique\_visitors|
|Apache - OpenTelemetry/Logs|United States|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Locations|sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| parse regex "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where country\_name = "United States"|
|Apache - OpenTelemetry|Uptime|Metrics|Installed Apps/Apache - OpenTelemetry/Apache - Overview|sumo.datasource=apache metric=apache.uptime webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} \| filter latest \> 0 \| sum by webengine.cluster.name \| eval \_value / (60\*60\*24)|
|Apache - OpenTelemetry/Metrics|Uptime|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Server Status| sumo.datasource=apache metric=apache.uptime webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| filter latest \> 0 \| sum by webengine.node.name \| eval \_value / (60\*60)|
|Apache - OpenTelemetry|Visitor Locations|Logs|Installed Apps/Apache - OpenTelemetry/Apache - Overview| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count by src\_ip<br />\| where !isBlank(src\_ip)<br />\| lookup latitude, longitude from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Apache - OpenTelemetry/Logs|Visitor Locations - One Day Time Comparison|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Trends| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude) and !isEmpty(country\_name)<br />\| sum(\_count) as Visitors\_Locations by country\_name<br />\| sort Visitors\_Locations <br />\| compare with timeshift 1d<br />\| limit 10|
|Apache - OpenTelemetry/Logs|Visitor Platforms|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "", "bots/unknown", type) as type<br />\| count type<br />\| sort by \_count, type asc|
|Apache - OpenTelemetry/Logs|Visitor Platforms Over Time|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Access Types| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "", "bots/unknown", type) as type<br />\| timeslice 5m<br />\| count by \_timeslice, type<br />\| transpose row \_timeslice column type|
|Apache - OpenTelemetry/Logs|Visits by Country Over Time|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Locations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| parse regex "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude) and !isEmpty(country\_name)<br />\| timeslice 5m<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \* |
|Apache - OpenTelemetry/Logs|Visits by US Regions Over Time|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Locations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| parse regex "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| timeslice 5m<br />\| count by src\_ip, \_timeslice<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude) and country\_name = "United States" AND !isEmpty(region)<br />\| sum(\_count) as count by \_timeslice, region<br />\| transpose row \_timeslice column region as \* |
|Apache - OpenTelemetry/Metrics|Waiting|Metrics|Installed Apps/Apache - OpenTelemetry/Metrics/Apache - Request State Analysis| sumo.datasource=apache metric=apache.scoreboard state=waiting webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} deployment.environment={{deployment.environment}}  \| sum by webengine.cluster.name|
|Apache - OpenTelemetry/Logs|Worldwide|Logs|Installed Apps/Apache - OpenTelemetry/Logs/Apache - Visitor Locations| sumo.datasource=apache webengine.cluster.name={{webengine.cluster.name}} deployment.environment={{deployment.environment}} webengine.node.name={{webengine.node.name}} HTTP<br />\| parse regex "^(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex field=mesg "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP\\/[\\d\\.]+[\\\\n]\*\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|

