# AWS Security Hub - Cloud Security Monitoring and Analytics

## Searches

### Log Searches

- **All Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **All Security Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Compliance Breakdown**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Critical Severity Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Critical Severity Findings Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Failed Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Failed Compliance Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Findings by Severity**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **High Severity Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **High Severity Findings Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Last 20 Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Last 20 Critical Severity Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Last 20 Failed Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Last 20 Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Last 20 High Severity Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Last 20 Low Severity Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Last 20 Medium Severity Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Last 20 Not Available Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Last 20 Passed Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Last 20 Success Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Last 20 Warning Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Low Severity Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Low Severity Findings Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Medium Severity Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Medium Severity Findings Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview 
- **Not Available Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Not Available Compliance Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Passed Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Passed Compliance Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Success Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Success Compliance Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Warning Compliance Findings**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance 
- **Warning Compliance Outlier**: from Dashboard: AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|AWS Security Hub - Cloud Security Monitoring and Analytics|All Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|All Security Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| timeslice 1h<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Compliance Breakdown|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub AND !(isBlank(compliance\_status))<br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| timeslice 1h<br />\| count by \_timeslice,compliance\_status <br />\| transpose row \_timeslice column compliance\_status|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Critical Severity Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where severity\_bucket="Critical"<br />\| timeslice 1h<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Critical Severity Findings Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where severity\_bucket="Critical"<br />\| timeslice 1h<br />\| count by \_timeslice<br />\| outlier \_count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Failed Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "FAILED"<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Failed Compliance Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub compliance\_status = "FAILED"<br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| timeslice 30m<br />\| fillmissing timeslice(30m)<br />\| count by \_timeslice<br />\| outlier \_count threshold=2|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Findings by Severity|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| timeslice 1h<br />\| count by severity\_bucket,\_timeslice<br />\| transpose row \_timeslice column severity\_bucket|
|AWS Security Hub - Cloud Security Monitoring and Analytics|High Severity Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where severity\_bucket="High"<br />\| timeslice 1h<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|High Severity Findings Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where severity\_bucket="High"<br />\| timeslice 1h<br />\| count by \_timeslice<br />\| outlier \_count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| count by compliance\_status,finding\_id, finding\_type,title,severity\_normalized,resources,\_messagetime<br />\| sort by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Critical Severity Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| timeslice 1h<br />\| where severity\_bucket="Critical"<br />\| count by title,finding\_types,aws\_account\_id,severity\_bucket,\_messagetime,finding\_provider,severity\_normalized<br />\| order by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Failed Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "FAILED"<br />\| count by compliance\_status,finding\_id, finding\_type,title,severity\_normalized,resources,\_messagetime<br />\| sort by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| timeslice 1h<br />\| count by title,finding\_types,aws\_account\_id,severity\_bucket,\_messagetime,finding\_provider,severity\_normalized<br />\| order by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 High Severity Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| timeslice 1h<br />\| where severity\_bucket="High"<br />\| count by title,finding\_types,aws\_account\_id,severity\_bucket,\_messagetime,finding\_provider,severity\_normalized<br />\| order by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Low Severity Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| timeslice 1h<br />\| where severity\_bucket="Low"<br />\| count by title,finding\_types,aws\_account\_id,severity\_bucket,\_messagetime,finding\_provider,severity\_normalized<br />\| order by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Medium Severity Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| timeslice 1h<br />\| where severity\_bucket="Medium"<br />\| count by title,finding\_types,aws\_account\_id,severity\_bucket,\_messagetime,finding\_provider,severity\_normalized<br />\| order by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Not Available Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "NOT\_AVAILABLE"<br />\| count by compliance\_status,finding\_id, finding\_type,title,severity\_normalized,resources,\_messagetime<br />\| sort by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Passed Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "PASSED"<br />\| count by compliance\_status,finding\_id, finding\_type,title,severity\_normalized,resources,\_messagetime<br />\| sort by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Success Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "SUCCESS"<br />\| count by compliance\_status,finding\_id, finding\_type,title,severity\_normalized,resources,\_messagetime<br />\| sort by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Last 20 Warning Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "WARNING"<br />\| count by compliance\_status,finding\_id, finding\_type,title,severity\_normalized,resources,\_messagetime<br />\| sort by \_messagetime<br />\| fields -\_messagetime<br />\| limit 20|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Low Severity Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where severity\_bucket="Low"<br />\| timeslice 1h<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Low Severity Findings Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where severity\_bucket="Low"<br />\| timeslice 1h<br />\| count by \_timeslice<br />\| outlier \_count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Medium Severity Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where severity\_bucket="Medium"<br />\| timeslice 1h<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Medium Severity Findings Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Monitoring - Overview|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| topk(1, updated\_at) by finding\_id<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where severity\_bucket="Medium"<br />\| timeslice 1h<br />\| count by \_timeslice<br />\| outlier \_count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Not Available Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "NOT\_AVAILABLE"<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Not Available Compliance Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub compliance\_status = "NOT\_AVAILABLE"<br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| timeslice 30m<br />\| fillmissing timeslice(30m)<br />\| count by \_timeslice<br />\| outlier \_count threshold=2|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Passed Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "PASSED"<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Passed Compliance Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub compliance\_status = "PASSED"<br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| timeslice 30m<br />\| fillmissing timeslice(30m)<br />\| count by \_timeslice<br />\| outlier \_count threshold=2|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Success Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "SUCCESS"<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Success Compliance Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub compliance\_status = "SUCCESS"<br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\|topk(1, updated\_at) by finding\_id<br /><br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| timeslice 30m<br />\| fillmissing timeslice(30m)<br />\| count by \_timeslice<br />\| outlier \_count threshold=2|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Warning Compliance Findings|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub <br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| where compliance\_status = "WARNING"<br />\| count|
|AWS Security Hub - Cloud Security Monitoring and Analytics|Warning Compliance Outlier|Logs|AWS Security Hub - Cloud Security Monitoring and Analytics/AWS Security Hub - Security Analytics - Compliance|\_sourceCategory = Labs/AWS/SecurityHub compliance\_status = "WARNING"<br />\| json  "AwsAccountId", "Id", "GeneratorId", "ProductArn", "CreatedAt", "UpdatedAt", "Resources", "Severity.Normalized", "SourceUrl", "Title","Types", "Compliance.Status" as aws\_account\_id, finding\_id, generator\_id, product\_arn, created\_at, updated\_at, resources, severity\_normalized, sourceurl, title, finding\_types, compliance\_status nodrop<br />\| where aws\_account\_id matches "{{aws\_account\_id}}"<br />\| where finding\_id matches "{{finding\_id}}"<br />\| where finding\_types matches "{{finding\_types}}"<br />\| where severity\_normalized matches "{{severity\_normalized}}"<br />\| where title matches "{{title}}"<br />\| where compliance\_status matches "{{compliance\_status}}"<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| if (severity\_normalized == 0, "Informational", "Others") as severity\_bucket<br />\| if (severity\_normalized \<= 39, "Low", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 69) and (severity\_normalized \>= 40), "Medium", severity\_bucket) as severity\_bucket<br />\| if ((severity\_normalized \<= 89) and (severity\_normalized \>= 70), "High", severity\_bucket) as severity\_bucket<br />\| if (severity\_normalized \<= 100 and severity\_normalized \>= 90, "Critical", severity\_bucket) as severity\_bucket<br />\|where title matches "\*"<br />\|topk(1, updated\_at) by finding\_id<br />\| parse regex field=product\_arn ":(?\<sechub\_region\>[a-z]\*-[a-z]\*-\\d{1}):"<br />\| parse regex field=finding\_types "\\"(?\<finding\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Type\\":\\"(?\<resource\_type\>.\*?)\\"" multi<br />\| parse regex field=resources "\\"Id\\":\\"(?\<resource\_id\>.\*?)\\"" multi<br />\| parse regex field=product\_arn "product/(?\<finding\_provider\>.\*?)\$"<br />\| where !isBlank(compliance\_status)<br />\| timeslice 30m<br />\| fillmissing timeslice(30m)<br />\| count by \_timeslice<br />\| outlier \_count threshold=2|

