# Apache Tomcat
## Sumo Logic App For: Apache Tomcat
The Apache Tomcat app is a unified logs and metrics app that helps you monitor the availability, performance, health and resource utilization of your Apache Tomcat servers. Preconfigured dashboards provide insight into visitor locations, traffic patterns, errors, resource utilization, garbage collection, web server operations and access from known malicious sources.
Docs Link: [Apache Tomcat](https://help.sumologic.com/?cid=1052)

## Searches

### Log Searches

- **4xx Error**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **5xx Codes**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **5xx Error**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Average Server Startup Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Catalina Overview 
- **Bytes Served**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Bytes Served - Outlier**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Outlier Analysis 
- **Client Errors**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Outlier Analysis 
- **Client Locations - 4xx Errors**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Web Server Operations 
- **Component Errors**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Catalina Overview 
- **Error Responses by Server**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Web Server Operations 
- **Errors by Component**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Catalina Overview 
- **Exceptions**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Catalina Overview 
- **Heap**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Garbage Collection 
- **Highly Malicious Threat Table**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Threat Intel 
- **HTTP Methods**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Log Levels**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Catalina Overview 
- **Media Types Served**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Non 200 Response Status Codes**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Web Server Operations 
- **Non-INFO Errors**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Catalina Overview 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis 
- **Number of Visitors**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Outlier Analysis 
- **Par Old Gen**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Garbage Collection 
- **PS Perm Gen**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Garbage Collection 
- **PS Young Gen**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Garbage Collection 
- **Responses Over Time**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Responses Over Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis 
- **Server Errors**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Outlier Analysis 
- **Server Errors Over Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Web Server Operations 
- **Server State Events Over Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Catalina Overview 
- **Threat Breakdown by Sources**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Threat Intel 
- **Threat by Actors**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Threat Intel 
- **Threat Count**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Threat Intel 
- **Threat Locations**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Threat Intel 
- **Threat Table**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Threat Intel 
- **Top 10 Bots Observed**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Web Server Operations 
- **Top 10 Host - High GC Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Garbage Collection 
- **Top 10 Hosts - Low Average JVM Up-Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Garbage Collection 
- **Top 10 Recent Exceptions**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Catalina Overview 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Top 10 URLs causing Errors**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Web Server Operations 
- **Top 5 Highly Malicious URLs**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Threat Intel 
- **Top 5 Referrers**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Top 5 URIs causing 404 Responses**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Web Server Operations 
- **Top 5 URLs**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Total GC Operation Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Garbage Collection 
- **Total GC Operations**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Garbage Collection 
- **Traffic Distribution by Server**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis 
- **Traffic Volume and Bytes Served**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis 
- **United States**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Locations 
- **Visitor Locations**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis 
- **Visits by Country Over Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Locations 
- **Visits by US State Over Time**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Locations 
- **Worldwide**: from Dashboard: Apache Tomcat/Logs/Apache Tomcat - Visitor Locations

### Metric Searches

- **Average Processing Time**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Busy Threads Percentage (Busy / Current)**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Busy vs Current vs Max threads**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **CPU Usage Percentage Over Time**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Error Count**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Error Count**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Heap Memory Peak usage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory Pool 
- **Heap Memory Percentage Usage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory Pool 
- **Heap Memory Percentage Usage by Server**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory Pool 
- **Heap Memory Usage (MB)**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Heap Memory Usage Percentage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Heap Memory Usage percentage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory Pool 
- **Heap vs Non Heap Memory Usage Percentage**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Memory Pool Usage Percentage**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Non Heap Memory Peak usage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory Pool 
- **Non Heap Memory Percentage Usage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory Pool 
- **Non Heap Memory Percentage Usage by Server**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory Pool 
- **Non Heap Memory Usage (MB)**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Non Heap Memory Usage percentage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory Pool 
- **Physical Memory Used Percentage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Processing Time by Server**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Processing time vs Max Processing time**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Request Count**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Request Processing Time**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Requests**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Requests per Seconds**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Swap Memory Used Percentage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **System CPU Load**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Thread Distribution by Server**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Thread Percentage by Server**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Total Bytes Received**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Total Bytes Received**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Total Bytes Sent**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Total Bytes Sent**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Total Connectors**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Connectors 
- **Total Memory**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Total Physical Memory**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Total Physical Memory**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Total Swap Memory**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Total Swap Memory**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Used Memory**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Used Memory Percentage**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Used Physical Memory**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Used Physical Memory**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory 
- **Used Swap Memory**: from Dashboard: Apache Tomcat/Apache Tomcat - Overview 
- **Used Swap Memory**: from Dashboard: Apache Tomcat/Metrics/Apache Tomcat - Memory

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Apache Tomcat|4xx Error|Logs|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*"<br />\| count|
|Apache Tomcat|5xx Codes|Logs|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "5\*" <br />\| count as count by status\_code, webserver\_farm|
|Apache Tomcat|5xx Error|Logs|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "5\*"<br />\| count<br />|
|Apache Tomcat|Average Processing Time|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_Servlet\_processingTime  webserver\_farm={{webserver\_farm}} \| rate increasing \| sum|
|Apache Tomcat/Logs|Average Server Startup Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Catalina Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} startup \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse "INFO: Server startup in \* ms" as startuptime<br />\| startuptime/1000 as startuptime\_ms<br />\| timeslice 1d<br />\| avg(startuptime\_ms) as avg\_startuptime\_sec by \_timeslice|
|Apache Tomcat/Metrics|Busy Threads Percentage (Busy / Current)|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_current\_threads\_busy webserver\_farm={{webserver\_farm}} host={{host}} \| sum by metric|
|Apache Tomcat/Metrics|Busy vs Current vs Max threads|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_current\_threads\_busy webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host, name|
|Apache Tomcat/Logs|Bytes Served|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where size != "-" and size != ""<br />\| num(size) as size<br />\| sum(size) as Bytes\_Served<br />\| Bytes\_Served/(1024\*1024\*1000) as Gbytes\_Served<br />\| fields Gbytes\_Served|
|Apache Tomcat/Logs|Bytes Served - Outlier|Logs|Apache Tomcat/Logs/Apache Tomcat - Outlier Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where size != "-" and !isEmpty(size)<br />\| number(size)<br />\| (size/(1024\*1024)) as mbytes <br />\| timeslice {{timeslice}}<br />\| sum(mbytes) as mbytes by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier mbytes window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache Tomcat/Logs|Client Errors|Logs|Apache Tomcat/Logs/Apache Tomcat - Outlier Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| timeslice {{timeslice}}<br />\| count as client\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier client\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache Tomcat/Logs|Client Locations - 4xx Errors|Logs|Apache Tomcat/Logs/Apache Tomcat - Web Server Operations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Apache Tomcat/Logs|Component Errors|Logs|Apache Tomcat/Logs/Apache Tomcat - Catalina Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)(?:\$\|\\n(?\<thrown\>[\\s\\S]+)\$)"<br />\| where (loglevel != "INFO")<br />\| count by component<br />\| sort by \_count|
|Apache Tomcat|CPU Usage Percentage Over Time|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_SystemCpuLoad webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm, host|
|Apache Tomcat|Error Count|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_error\_count webserver\_farm={{webserver\_farm}} \| sum by metric|
|Apache Tomcat/Metrics|Error Count|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_error\_count webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host, name|
|Apache Tomcat/Logs|Error Responses by Server|Logs|Apache Tomcat/Logs/Apache Tomcat - Web Server Operations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, host<br />\| transpose row \_timeslice column host|
|Apache Tomcat/Logs|Errors by Component|Logs|Apache Tomcat/Logs/Apache Tomcat - Catalina Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)(?:\$\|\\n(?\<thrown\>[\\s\\S]+)\$)"<br />\| where (loglevel != "INFO")<br />\| timeslice 1h<br />\| count by \_timeslice, component<br />\| transpose row \_timeslice column component|
|Apache Tomcat/Logs|Exceptions|Logs|Apache Tomcat/Logs/Apache Tomcat - Catalina Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \*Exception \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<Component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)\\n(?\<thrown\>[\\s\\S]+)\$"<br />\| where thrown!=""<br />\| parse regex field=thrown "\\((?\<sourcefile\>[^\\)]+)"<br />\| timeslice 1d<br />\| count by \_timeslice|
|Apache Tomcat/Logs|Heap|Logs|Apache Tomcat/Logs/Apache Tomcat - Garbage Collection|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[Metaspace: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| avg(HeapBfrGC) as BeforeGC, avg(HeapAftrGC) as AfterGC by \_timeslice|
|Apache Tomcat/Metrics|Heap Memory Peak usage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory Pool|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_used type="heap memory" webserver\_farm={{webserver\_farm}} host={{host}} \| max by webserver\_farm,host,name|
|Apache Tomcat/Metrics|Heap Memory Percentage Usage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory Pool|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_max type="heap memory" webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host,name|
|Apache Tomcat/Metrics|Heap Memory Percentage Usage by Server|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory Pool|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_max type="heap memory" webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host,name|
|Apache Tomcat/Metrics|Heap Memory Usage (MB)|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* (metric=tomcat\_jmx\_jvm\_memory\_HeapMemoryUsage\_used or metric=tomcat\_jmx\_jvm\_memory\_HeapMemoryUsage.used) webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host \| eval \_value/1024/1024|
|Apache Tomcat/Metrics|Heap Memory Usage percentage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory Pool|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_max type="heap memory" webserver\_farm={{webserver\_farm}} host={{host}} \| sum by name|
|Apache Tomcat/Metrics|Heap Memory Usage Percentage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* (metric=tomcat\_jmx\_jvm\_memory\_HeapMemoryUsage\_used or metric=tomcat\_jmx\_jvm\_memory\_HeapMemoryUsage.used) webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host<br />|
|Apache Tomcat|Heap vs Non Heap Memory Usage Percentage|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* (metric=tomcat\_jmx\_jvm\_memory\_HeapMemoryUsage\_used or metric=tomcat\_jmx\_jvm\_memory\_HeapMemoryUsage.used) webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm, host<br />|
|Apache Tomcat/Logs|Highly Malicious Threat Table|Logs|Apache Tomcat/Logs/Apache Tomcat - Threat Intel|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup type, actor, raw, threatlevel as Malicious\_Confidence from sumo://threat/cs on threat=remote\_ip <br />\| where  type="ip\_address" and !isNull(Malicious\_Confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| where Malicious\_Confidence matches "high"<br />\| count by Malicious\_Confidence, Actor, remote\_ip, status\_code, uri<br />\| sort by \_count<br />\| limit 20|
|Apache Tomcat/Logs|HTTP Methods|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count by method|
|Apache Tomcat/Logs|Log Levels|Logs|Apache Tomcat/Logs/Apache Tomcat - Catalina Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)(?:\$\|\\n(?\<thrown\>[\\s\\S]+)\$)"<br />\| count as count by loglevel<br />\| sort by count|
|Apache Tomcat/Logs|Media Types Served|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| parse regex field=uri "^/[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$"<br />\| count as count by type <br />\| sort by count desc|
|Apache Tomcat|Memory Pool Usage Percentage|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_used webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm,host,name,type|
|Apache Tomcat/Logs|Non 200 Response Status Codes|Logs|Apache Tomcat/Logs/Apache Tomcat - Web Server Operations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}}  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| where !(status\_code matches "2\*") <br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|Apache Tomcat/Metrics|Non Heap Memory Peak usage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory Pool|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_used type="non-heap memory" !name="Metaspace" webserver\_farm={{webserver\_farm}} host={{host}} \| max by webserver\_farm, host, name|
|Apache Tomcat/Metrics|Non Heap Memory Percentage Usage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory Pool|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_max type="non-heap memory" !name="Metaspace"  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host,name|
|Apache Tomcat/Metrics|Non Heap Memory Percentage Usage by Server|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory Pool|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_max type="non-heap memory" !name="Metaspace"  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host,name|
|Apache Tomcat/Metrics|Non Heap Memory Usage (MB)|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* (metric=tomcat\_jmx\_jvm\_memory\_NonHeapMemoryUsage\_used or metric=tomcat\_jmx\_jvm\_memory\_NonHeapMemoryUsage.used) webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host \| eval \_value/1024/1024|
|Apache Tomcat/Metrics|Non Heap Memory Usage percentage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory Pool|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memorypool\_max type="non-heap memory" !name="Metaspace"  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by name|
|Apache Tomcat/Logs|Non-INFO Errors|Logs|Apache Tomcat/Logs/Apache Tomcat - Catalina Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)(?:\$\|\\n(?\<thrown\>[\\s\\S]+)\$)"<br />\| where (loglevel != "INFO")<br />\| timeslice 1h<br />\| count by \_timeslice, loglevel<br />\| transpose row \_timeslice column loglevel|
|Apache Tomcat/Logs|Number of Hits by Server - One Day Time Comparison|Logs|Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as Number\_of\_Hits by host  <br />\| compare with timeshift 1d|
|Apache Tomcat/Logs|Number of Visitors|Logs|Apache Tomcat/Logs/Apache Tomcat - Outlier Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where !isEmpty(remote\_ip)<br />\| timeslice {{timeslice}}<br />\| count as hits by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier hits window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache Tomcat/Logs|Par Old Gen|Logs|Apache Tomcat/Logs/Apache Tomcat - Garbage Collection|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| avg(OldBfrGC) as BeforeGC, avg(OldAftrGC) as AfterGC by \_timeslice|
|Apache Tomcat/Metrics|Physical Memory Used Percentage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalPhysicalMemorySize webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host|
|Apache Tomcat/Metrics|Processing Time by Server|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_processing\_time webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host,name|
|Apache Tomcat/Metrics|Processing time vs Max Processing time|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_processing\_time webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host, name|
|Apache Tomcat/Logs|PS Perm Gen|Logs|Apache Tomcat/Logs/Apache Tomcat - Garbage Collection|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| avg(PermBfrGC) as BeforeGC, avg(PermAftrGC) as AfterGC by \_timeslice|
|Apache Tomcat/Logs|PS Young Gen|Logs|Apache Tomcat/Logs/Apache Tomcat - Garbage Collection|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[Metaspace: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| avg(YngBfrGC) as BeforeGC, avg(YngAftrGC) as AfterGC by \_timeslice|
|Apache Tomcat/Metrics|Request Count|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_request\_count webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host,name|
|Apache Tomcat|Request Processing Time|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_processing\_time name=http-\* webserver\_farm={{webserver\_farm}}\| avg by metric \| rate increasing |
|Apache Tomcat|Requests|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_request\_count name=http-\* webserver\_farm={{webserver\_farm}} \| sum by metric|
|Apache Tomcat|Requests per Seconds|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_request\_count name=http-\* webserver\_farm={{webserver\_farm}} \| rate increasing \| sum|
|Apache Tomcat/Logs|Responses Over Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| if(Status\_Code matches "2\*", 1, 0) as Successes <br />\| if(Status\_Code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(Status\_Code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 1h <br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc|
|Apache Tomcat|Responses Over Time|Logs|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| if(status\_code matches "2\*", 1, 0) as Successes <br />\| if(status\_code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(status\_code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 5m<br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc|
|Apache Tomcat/Logs|Server Errors|Logs|Apache Tomcat/Logs/Apache Tomcat - Outlier Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice {{timeslice}}<br />\| count as server\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier server\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache Tomcat/Logs|Server Errors Over Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Web Server Operations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, status\_code<br />\| transpose row \_timeslice column status\_code |
|Apache Tomcat/Logs|Server State Events Over Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Catalina Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} (shutdown or startup) \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (\_raw matches "\*INFO: A valid shutdown command was received via the shutdown port. Stopping the Server instance.\*",1,0) as shutdown<br />\| if (\_raw matches "\*INFO: Server startup in\*",1,0) as startup<br />\| timeslice 1d<br />\| sum (shutdown) as shutdown, sum(startup) as startup by \_timeslice|
|Apache Tomcat/Metrics|Swap Memory Used Percentage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalSwapSpaceSize webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm,host|
|Apache Tomcat|System CPU Load|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_SystemCpuLoad webserver\_farm={{webserver\_farm}} \| eval \_value\*100 \| avg|
|Apache Tomcat|Thread Distribution by Server|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_current\_thread\_count  webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm, host<br />|
|Apache Tomcat/Metrics|Thread Percentage by Server|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_current\_thread\_count webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host,name|
|Apache Tomcat/Logs|Threat Breakdown by Sources|Logs|Apache Tomcat/Logs/Apache Tomcat - Threat Intel|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_source |
|Apache Tomcat/Logs|Threat by Actors|Logs|Apache Tomcat/Logs/Apache Tomcat - Threat Intel|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by Actor|
|Apache Tomcat/Logs|Threat by Malicious Confidence|Logs|Apache Tomcat/Logs/Apache Tomcat - Threat Intel|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by malicious\_confidence|
|Apache Tomcat/Logs|Threat Count|Logs|Apache Tomcat/Logs/Apache Tomcat - Threat Intel|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|Apache Tomcat/Logs|Threat Locations|Logs|Apache Tomcat/Logs/Apache Tomcat - Threat Intel|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| count by remote\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Apache Tomcat/Logs|Threat Table|Logs|Apache Tomcat/Logs/Apache Tomcat - Threat Intel|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup type, actor, raw, threatlevel as Malicious\_Confidence from sumo://threat/cs on threat=remote\_ip <br />\| where  type="ip\_address" and !isNull(Malicious\_Confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| where Malicious\_Confidence matches "high"<br />\| count by Malicious\_Confidence, Actor, remote\_ip, status\_code, uri<br />\| sort by \_count<br />\| limit 50|
|Apache Tomcat/Logs|Top 10 Bots Observed|Logs|Apache Tomcat/Logs/Apache Tomcat - Web Server Operations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br /> \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"(?\<referrer\>http[s]{0,1}:[^\\"]+)\\"\\s+\\"(?\<user\_agent\>.\*)\\"" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Exabot?)\\W"<br />\| where bot\_name != ""<br />\| if (bot\_name="bing","Bing",bot\_name) as bot\_name<br />\| count as count by bot\_name<br />\| sort by count<br />\| limit 10|
|Apache Tomcat/Logs|Top 10 Host - High GC Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Garbage Collection|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[Metaspace: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| sum(GCOperationTime) as GCOperationTime by Host<br />\| Top 10 Host by GCOperationTime|
|Apache Tomcat/Logs|Top 10 Hosts - Low Average JVM Up-Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Garbage Collection|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[Metaspace: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| avg(gctmaftrJVMStrt) as gctmaftrJVMStrt by Host<br />\| Top 10 Host by gctmaftrJVMStrt asc|
|Apache Tomcat/Logs|Top 10 Recent Exceptions|Logs|Apache Tomcat/Logs/Apache Tomcat - Catalina Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<Component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)\\n(?\<thrown\>[\\s\\S]+)\$"<br />\| where thrown!=""<br />\| parse regex field=thrown "\\((?\<sourcefile\>[^\\)]+)"<br />\| count by time, loglevel, message, method, sourcefile, thrown<br />\| fields time,loglevel, message, method,sourcefile, thrown<br />\| sort by time \| limit 10|
|Apache Tomcat/Logs|Top 10 Search Terms from Popular Search Engines|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} (google or bing or aol or ask or yahoo) ("p=" or "q=" or "wd=" or "searchfor=")<br /> \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"(?\<referrer\>http[s]{0,1}:[^\\"]+)\\""<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)"<br />\| where search\_term != ""<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*","Google","") as engine<br />\| if(referrer matches "\*bing.\*","Bing",engine) as engine<br />\| if(referrer matches "\*ask.com\*","Ask.com",engine) as engine<br />\| if(referrer matches "\*aol.\*","AOL",engine) as engine<br />\| if(referrer matches "\*yahoo.\*","Yahoo",engine) as engine<br />\| where engine != ""<br />\| count as count  by search\_term<br />\| sort count \| limit 10|
|Apache Tomcat|Top 10 URLs causing Errors|Logs|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| count by uri,Host<br />\| top 10 Host,uri by \_count|
|Apache Tomcat/Logs|Top 5 Clients Causing 4xx Errors|Logs|Apache Tomcat/Logs/Apache Tomcat - Web Server Operations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} 404 \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*"<br />\| count as count by remote\_ip<br />\| sort count <br />\| limit 5 |
|Apache Tomcat/Logs|Top 5 Highly Malicious URLs|Logs|Apache Tomcat/Logs/Apache Tomcat - Threat Intel|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}}\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip, uri<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| where malicious\_confidence matches "high"<br />\| count by uri<br />\| limit 5|
|Apache Tomcat/Logs|Top 5 Referrers|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"(?\<referrer\>http[s]{0,1}:[^\\"\\?]+?)(?:\\"\|\\?)"<br />\| where length(referrer) \> 1<br />\| count as count by referrer<br />\| sort by count<br />\| limit 5 |
|Apache Tomcat/Logs|Top 5 URIs causing 404 Responses|Logs|Apache Tomcat/Logs/Apache Tomcat - Web Server Operations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} (400 OR 401 OR 402 OR 403 OR 404) \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code = "404"<br />\| count as count by uri<br />\| sort count, uri asc<br />\| limit 5|
|Apache Tomcat/Logs|Top 5 URLs|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Traffic Insight|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as count by uri<br />\| sort by count<br />\| limit 5|
|Apache Tomcat/Metrics|Total Bytes Received|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_bytes\_received webserver\_farm={{webserver\_farm}} host={{host}} \| sum by metric \| eval \_value\*9.3132257461548E-10|
|Apache Tomcat/Metrics|Total Bytes Received|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_bytes\_received webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host, name|
|Apache Tomcat/Metrics|Total Bytes Sent|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_bytes\_sent webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host, name|
|Apache Tomcat/Metrics|Total Bytes Sent|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_bytes\_sent webserver\_farm={{webserver\_farm}} host={{host}} \| sum by metric \| eval \_value\*9.3132257461548E-10|
|Apache Tomcat/Metrics|Total Connectors|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Connectors|\_sourceCategory = \*tomcat\* metric=tomcat\_connector\_request\_count webserver\_farm={{webserver\_farm}} host={{host}} \| sum by metric|
|Apache Tomcat/Logs|Total GC Operation Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Garbage Collection|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| sum(GCOperationTime) as GCOperationTime by \_timeslice|
|Apache Tomcat/Logs|Total GC Operations|Logs|Apache Tomcat/Logs/Apache Tomcat - Garbage Collection|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| count as count by \_timeslice, GCType<br />\| transpose row \_timeslice column GCType|
|Apache Tomcat/Metrics|Total Memory|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memory\_total webserver\_farm={{webserver\_farm}} host={{host}} \| eval \_value/1024/1024 \| sum by metric|
|Apache Tomcat/Metrics|Total Physical Memory|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalPhysicalMemorySize webserver\_farm={{webserver\_farm}} host={{host}} \| eval \_value/1024/1024 \| sum by metric|
|Apache Tomcat|Total Physical Memory|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalPhysicalMemorySize webserver\_farm={{webserver\_farm}} \| eval \_value/1024/1024 \| sum by metric|
|Apache Tomcat/Metrics|Total Swap Memory|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalSwapSpaceSize webserver\_farm={{webserver\_farm}} \|  eval \_value/1024/1024\| sum by metric|
|Apache Tomcat|Total Swap Memory|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalSwapSpaceSize webserver\_farm={{webserver\_farm}} \|  eval \_value/1024/1024\| sum by metric|
|Apache Tomcat/Logs|Traffic Distribution by Server|Logs|Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| timeslice 1h<br />\| count by \_timeslice, host  <br />\| transpose row \_timeslice column host|
|Apache Tomcat/Logs|Traffic Volume and Bytes Served|Logs|Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where size != "-"<br />\| timeslice 1h<br />\| (size/(1048576\*1000)) as gbytes <br />\| count as hits, sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc|
|Apache Tomcat/Logs|United States|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Locations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| where country\_name="United States" \| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Apache Tomcat/Metrics|Used Memory|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memory\_free webserver\_farm={{webserver\_farm}} host={{host}} \| eval \_value/1024/1024 \| sum by metric|
|Apache Tomcat/Metrics|Used Memory Percentage|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jvm\_memory\_total webserver\_farm={{webserver\_farm}} host={{host}} \| eval \_value/1024/1024 \| sum by webserver\_farm,host|
|Apache Tomcat|Used Physical Memory|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalPhysicalMemorySize webserver\_farm={{webserver\_farm}} \| eval \_value/1024/1024 \| avg by metric|
|Apache Tomcat/Metrics|Used Physical Memory|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalPhysicalMemorySize webserver\_farm={{webserver\_farm}} host={{host}} \| eval \_value/1024/1024 \| sum by metric|
|Apache Tomcat/Metrics|Used Swap Memory|Metrics|Apache Tomcat/Metrics/Apache Tomcat - Memory|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalSwapSpaceSize webserver\_farm={{webserver\_farm}} \| eval \_value/1024/1024 \| avg by metric|
|Apache Tomcat|Used Swap Memory|Metrics|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* metric=tomcat\_jmx\_OperatingSystem\_TotalSwapSpaceSize webserver\_farm={{webserver\_farm}} \| eval \_value/1024/1024 \| avg by metric|
|Apache Tomcat|Visitor Locations|Logs|Apache Tomcat/Apache Tomcat - Overview|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where !(remote\_ip matches "127.0.0.1")<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Apache Tomcat/Logs|Visitor Locations - One Day Time Comparison|Logs|Apache Tomcat/Logs/Apache Tomcat - Logs Timeline Analysis|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| where !isEmpty(country\_name)<br />\| count as Visitors\_Locations by country\_name<br />\| sort Visitors\_Locations <br />\| compare with timeshift 1d<br />\| limit 10|
|Apache Tomcat/Logs|Visits by Country Over Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Locations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| where !isNull(country\_name) AND country\_name != ""<br />\| timeslice 5m<br />\| count by \_timeslice, country\_name <br />\| transpose row \_timeslice column country\_name as \*|
|Apache Tomcat/Logs|Visits by US State Over Time|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Locations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| timeslice 5m<br />\| where country\_name="United States" AND !isNull(region) AND region != ""<br />\| count by \_timeslice, region <br />\| transpose row \_timeslice column region as \*|
|Apache Tomcat/Logs|Worldwide|Logs|Apache Tomcat/Logs/Apache Tomcat - Visitor Locations|\_sourceCategory = \*tomcat\* webserver\_system=tomcat webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\|  lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|

