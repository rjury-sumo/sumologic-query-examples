# MongoDB - OpenTelemetry

## Searches

### Log Searches

- **Arbiter Node(s)**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Balancer Failures**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Chunk Split Failures**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Chunks Moving Between Shards**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Chunks Moving Between Shards**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Chunks Moving by Collection**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Client Connection Requests**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections 
- **CRUD Commands Over Time**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Error Logs by Component**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Error Logs by Context**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Error Summary - Daily**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Errors**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Errors**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Errors by Component**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Failed Login Attempt Summary**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections 
- **Failed Logins by User**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections 
- **Fatal Errors - Daily**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Fatal Errors by Component**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Heartbeat Error Events**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Location of Client Connection Requests**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections 
- **Location of Failed Logins**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections 
- **Log Reduce**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Logs by  Components**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Logs by Severity**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **MongoDB Exit Events**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Primary Node**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Queries by KeysExamined Value**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs 
- **Queries with KeysExamined greater than nreturned**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs 
- **Replication Error Summary**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Replication Errors**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Replication Events**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Replication Warnings**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Secondary Node(s)**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Secondary Node(s) Too Stale**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs 
- **Slow CRUD Commands**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Slow CRUD Commands Over Time**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Slow DB Commands**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Slow DB Commands Over Time**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Slow Queries**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs 
- **Slow Queries by Connection ID**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs 
- **Slow Queries Over Time by Type**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs 
- **Slow Server Status**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Slowest Execution Time (in MS) of  DB  Commands**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Slowest Running Queries by Type**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs 
- **Socket Excpetions**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Stopped Servers**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Summary of Errors**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Summary of Warnings**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Timeout Events**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Up Servers**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview 
- **Warning Summary - Daily**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Warnings**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings 
- **Warnings**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding 
- **Warnings by Component**: from Dashboard: Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|MongoDB - OpenTelemetry|Arbiter Node(s)|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*REPL\*"<br />\| where msg matches "Member is in new state"<br />\| json field=\_raw "attr.hostAndPort" as hostAndPort<br />\| json field=\_raw "attr.newState" as state<br />\| where state ="ARBITER"<br />\| count by timestamp, hostAndPort, state , msg<br />\| fields - \_count<br /><br />|
|MongoDB - OpenTelemetry|Balancer Failures|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity not in  ("W", "E") and context matches "\*Balancer\*"<br />\| count by timestamp,severity,mongodb\_component,context,msg, host.name<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Chunk Split Failures|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*SHARDING\*" and severity = "W" and msg matches "\*splitChunk failed\*"<br />\| count by timestamp,severity,mongodb\_component,context,msg, host.name|
|MongoDB - OpenTelemetry|Chunks Moving Between Shards|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| json field=\_raw "attr" as attr<br />\| where attr matches "\*moveChunk\*"<br />\| json field=\_raw "attr.command.toShard" as shards<br />\| count shards, host.name <br />\| transpose row shards column host.name|
|MongoDB - OpenTelemetry|Chunks Moving Between Shards|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| json field=\_raw "attr" as attr<br />\| where attr matches "\*moveChunk\*"<br />\| json field=\_raw "attr.command.toShard" as shards<br />\| count shards, host.name <br />\| transpose row shards column host.name|
|MongoDB - OpenTelemetry|Chunks Moving by Collection|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| json field=\_raw "attr" as attr<br />\| where attr matches "\*moveChunk\*"<br />\| json field=\_raw "attr.command.moveChunk" as collection<br />\| count collection |
|MongoDB - OpenTelemetry|Client Connection Requests|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component = "NETWORK"<br />\| where msg = "Connection accepted"<br />\| json field=\_raw "attr.remote" as template\_ip<br />\| parse regex field=template\_ip "(?\<client\_ip\>\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3}+):[\\d]+"<br />\| count by client\_ip<br />\| sort \_count|
|MongoDB - OpenTelemetry|CRUD Commands Over Time|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\| where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*" or db\_cmd matches "\*save\*" or db\_cmd matches "\*bulkWrite\*"<br />\| timeslice 1 h<br />\| count by \_timeslice|
|MongoDB - OpenTelemetry|Error Logs by Component|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "E"<br />\| count by mongodb\_component|
|MongoDB - OpenTelemetry|Error Logs by Context|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "E"<br />\| count by context|
|MongoDB - OpenTelemetry|Error Summary - Daily|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "E"<br />\| count by timestamp, severity, mongodb\_component, context , msg<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Errors|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*SHARDING\*" and severity = "E" <br />\| count |
|MongoDB - OpenTelemetry|Errors|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity in ("E") <br />\| count|
|MongoDB - OpenTelemetry|Errors by Component|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity in ("E") <br />\| count by mongodb\_component|
|MongoDB - OpenTelemetry|Failed Login Attempt Summary|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where msg = "Authentication failed"<br />\| json field=\_raw "attr.client" as template\_ip<br />\| json field=\_raw "attr.principalName" as user<br />\| json field=\_raw "attr.authenticationDatabase" as database<br />\| json field=\_raw "attr.result" as reason<br />\| parse regex field=template\_ip "(?\<client\_ip\>\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3}+):[\\d]+"<br />\| count by timestamp, user, database, client\_ip, reason<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Failed Logins by User|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where msg = "Authentication failed"<br />\| json field=\_raw "attr.client" as template\_ip<br />\| json field=\_raw "attr.principalName" as user<br />\| json field=\_raw "attr.authenticationDatabase" as database<br />\| json field=\_raw "attr.result" as reason<br />\| parse regex field=template\_ip "(?\<client\_ip\>\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3}+):[\\d]+"<br />\| count by user, client\_ip<br />\| order by \_count|
|MongoDB - OpenTelemetry|Fatal Errors - Daily|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "F"<br />\| count by timestamp, severity, mongodb\_component, context , msg<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Fatal Errors by Component|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity in ("F") <br />\| count by mongodb\_component|
|MongoDB - OpenTelemetry|Heartbeat Error Events|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*REPL\*"<br />\| json field=\_raw "attr.heartbeatMessage" as heartbeatMessage<br />\| where heartbeatMessage matches "Error\*"<br />\| count by timestamp ,severity,mongodb\_component,msg, host.name<br />\| fields - \_count |
|MongoDB - OpenTelemetry|Location of Client Connection Requests|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}   sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component = "NETWORK"<br />\| where msg = "Connection accepted"<br />\| json field=\_raw "attr.remote" as template\_ip<br />\| parse regex field=template\_ip "(?\<client\_ip\>\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3}+):[\\d]+"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br /><br />|
|MongoDB - OpenTelemetry|Location of Failed Logins|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Logins and Connections| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}   sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where msg = "Authentication failed"<br />\| json field=\_raw "attr.client" as template\_ip<br />\| json field=\_raw "attr.principalName" as user<br />\| json field=\_raw "attr.authenticationDatabase" as database<br />\| json field=\_raw "attr.result" as reason<br />\| parse regex field=template\_ip "(?\<client\_ip\>\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3}+):[\\d]+"<br />\| where !(client\_ip matches "127.0.0.1")<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|MongoDB - OpenTelemetry|Log Reduce|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "E" or severity = "W"  or severity = "F"<br />\| logreduce field=msg by  db.cluster.name|
|MongoDB - OpenTelemetry|Logs by  Components|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| timeslice 1h<br />\| count by mongodb\_component, \_timeslice<br />\| transpose row \_timeslice column mongodb\_component |
|MongoDB - OpenTelemetry|Logs by Severity|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| timeslice 1h<br />\| count by severity, \_timeslice<br />\| transpose row \_timeslice column severity|
|MongoDB - OpenTelemetry|MongoDB Exit Events|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| parse regex field=msg "dbexit:\\s+rc:\\s+(?\<code\>[0-9]+)"<br />\| lookup desc  as error\_description from https://s3.amazonaws.com/sumologic-app-data/mongo\_exit\_codes.csv on code=code<br />\| count by timestamp, severity, msg, error\_description, context, host.name<br />\| order by timestamp<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Primary Node|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*REPL\*"<br />\| where msg matches "Member is in new state"<br />\| json field=\_raw "attr.hostAndPort" as hostAndPort<br />\| json field=\_raw "attr.newState" as state<br />\| where state ="PRIMARY"<br />\| count by timestamp, hostAndPort, state , msg<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Queries by KeysExamined Value|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\|  where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*"<br />\| json field=\_raw "attr.keysExamined" as keysExamined<br />\| json field=\_raw "attr.docsExamined" as docsExamined<br />\| json field=\_raw "attr.nreturned" as nreturned<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| num(KeysExamined) \| num (nreturned)<br />\| count by timestamp, dur, db\_cmd, docsExamined, KeysExamined, nreturned, msg<br />\| fields - \_count<br />\| order by KeysExamined desc<br />|
|MongoDB - OpenTelemetry|Queries with KeysExamined greater than nreturned|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\|  where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*"<br />\| json field=\_raw "attr.keysExamined" as keysExamined<br />\| json field=\_raw "attr.docsExamined" as docsExamined<br />\| json field=\_raw "attr.nreturned" as nreturned<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| num(KeysExamined) \| num (nreturned)<br />\| count by timestamp, dur, db\_cmd, docsExamined, KeysExamined, nreturned, msg<br />\| fields - \_count<br />\| where KeysExamined \> nreturned<br />|
|MongoDB - OpenTelemetry|Replication Error Summary|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "E" and  mongodb\_component matches "\*REPL\*"<br />\| count by timestamp, severity, mongodb\_component, context , msg<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Replication Errors|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "E" and  mongodb\_component matches "\*REPL\*"<br />\| count |
|MongoDB - OpenTelemetry|Replication Events|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*REPL\*"  and !(msg matches "Waiting for pings from other members before syncing") and !(msg matches "Error in heartbeat") and !(msg matches "Not starting an election, since we are not electable")<br />\| count by timestamp, severity, context , msg<br />\| order by timestamp <br />\| limit 100<br />\| fields - \_count<br />|
|MongoDB - OpenTelemetry|Replication Warnings|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "W" and  mongodb\_component matches "\*REPL\*"<br />\| count |
|MongoDB - OpenTelemetry|Secondary Node(s)|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*REPL\*"<br />\| where msg matches "Member is in new state"<br />\| json field=\_raw "attr.hostAndPort" as hostAndPort<br />\| json field=\_raw "attr.newState" as state<br />\| where state ="SECONDARY"<br />\| count by timestamp, hostAndPort, state , msg<br />\| fields - \_count<br /><br />|
|MongoDB - OpenTelemetry|Secondary Node(s) Too Stale|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Replication Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*REPL\*" and msg matches "\*too stale\*"<br />\|count by timestamp ,severity,mongodb\_component,msg, host.name<br />\| fields - \_count |
|MongoDB - OpenTelemetry|Slow CRUD Commands|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\| where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*" or db\_cmd matches "\*save\*" or db\_cmd matches "\*bulkWrite\*"<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| where dur \> 100<br />\| count|
|MongoDB - OpenTelemetry|Slow CRUD Commands Over Time|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\| where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*" or db\_cmd matches "\*save\*" or db\_cmd matches "\*bulkWrite\*"<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| where dur \> 100<br />\| timeslice 1 h<br />\| count by \_timeslice|
|MongoDB - OpenTelemetry|Slow DB Commands|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| number(dur)<br />\| where dur \> 100<br />\|count|
|MongoDB - OpenTelemetry|Slow DB Commands Over Time|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| number(dur)<br />\| where dur \> 100<br />\| timeslice 1 h<br />\| count by \_timeslice|
|MongoDB - OpenTelemetry|Slow Queries|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\| where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*"<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| number(dur)<br />\| where dur \> 100<br />\| count<br />|
|MongoDB - OpenTelemetry|Slow Queries by Connection ID|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\|  where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*"<br />\| count by context<br />\| order by \_count desc<br />\| limit 20<br />|
|MongoDB - OpenTelemetry|Slow Queries Over Time by Type|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\| where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*"<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| number(dur)<br />\| where dur \> 100<br />\| timeslice 1 h<br />\| count by \_timeslice, db\_cmd<br />\| transpose row \_timeslice column db\_cmd<br />|
|MongoDB - OpenTelemetry|Slow Server Status|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where msg matches "\*serverStatus was very slow\*"<br />\| count by timestamp, msg, host.name<br />\| fields -\_count|
|MongoDB - OpenTelemetry|Slowest Execution Time (in MS) of  DB  Commands|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| number(dur)<br />\| max( dur) as max\_duration group by db\_cmd \| order by max\_duration|
|MongoDB - OpenTelemetry|Slowest Running Queries by Type|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Query Logs| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*"<br />\| json field=\_raw "attr.type" as type<br />\| where type matches "\*command\*"<br />\| json field=\_raw "attr.command" as command<br />\| replace (command,"{","") as command<br />\| replace (command,"}","") as command<br />\| parse regex field=command "(?\<db\_cmd\>[\\w\\-\\.]+):\*"<br />\| where db\_cmd matches "\*find\*" or db\_cmd matches "\*insert\*" or db\_cmd matches "\*remove\*" or db\_cmd matches "\*delete\*" or db\_cmd matches "\*update\*"<br />\| json field=\_raw "attr.durationMillis" as dur<br />\| number(dur)<br />\| where dur \> 100<br />\| max( dur) as max\_duration group by db\_cmd<br />|
|MongoDB - OpenTelemetry|Socket Excpetions|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| json field=\_raw "attr" as attr<br />\| where attr matches "\*error\*"<br />\| json field=attr "error.codeName" as codeName<br />\| where codeName = "SocketException" OR codeName = "exception" OR codeName = "socket exception"<br />\| count by timestamp,severity,mongodb\_component,context,msg, host.name<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Stopped Servers|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*" and ( msg matches "\*Waiting for connections\*" or msg matches "\*transition to\*" or msg matches "\*Now exiting\*")<br />\| if (msg matches "\*Now exiting\*", "Down",if (msg matches "\*transition to\*", "Up" ,if (msg matches "\*Waiting for connections\*", "Up", "UnKnown")))  as server\_status <br />\| where !(server\_status = "Up")<br />\| timeslice 100s<br />\| withtime server\_status \| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by host.name<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS", "UTC") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60)) as since\_mins \| format("%.2f", since\_mins) as since\_minutes<br />\| concat ("Since ", since\_minutes, " minutes") as Remark<br />\| fields - m\_time, since\_mins, since\_minutes <br />\| fields host.name, event\_time, server\_status, remark|
|MongoDB - OpenTelemetry|Summary of Errors|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*SHARDING\*" and severity = "E" <br />\| count by timestamp,severity,mongodb\_component,context,msg, host.name<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Summary of Warnings|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*SHARDING\*" and severity = "W" <br />\| count by timestamp,severity,mongodb\_component,context,msg, host.name<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Timeout Events|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where (msg matches "\*Timeout\*" or msg matches "\*timeout\*") and !(msg matches "\*SocketException\*")<br />\| count by timestamp,severity,mongodb\_component,context,msg, host.name<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Up Servers|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*COMMAND\*" and ( msg matches "\*Waiting for connections\*" or msg matches "\*transition to\*" or msg matches "\*Now exiting\*")<br />\| if (msg matches "\*Now exiting\*", "Down",if (msg matches "\*transition to\*", "Up" ,if (msg matches "\*Waiting for connections\*", "Up", "UnKnown")))  as server\_status<br />\| where server\_status = "Up"<br />\| timeslice 100s<br />\| withtime server\_status \| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by Host<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS", "UTC") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60)) as since\_mins \| format("%.2f", since\_mins) as since\_minutes<br />\| concat ("Since ", since\_minutes, " minutes") as Remark<br />\| fields - m\_time, since\_mins, since\_minutes <br />\| fields host.name, event\_time, server\_status, remark|
|MongoDB - OpenTelemetry|Warning Summary - Daily|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity = "W"<br />\| count by timestamp, severity, mongodb\_component, context , msg<br />\| fields - \_count|
|MongoDB - OpenTelemetry|Warnings|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity in ("W")<br />\| count|
|MongoDB - OpenTelemetry|Warnings|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Sharding| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}}  sumo.datasource=mongodb \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where mongodb\_component matches "\*SHARDING\*" and severity = "W" <br />\| count |
|MongoDB - OpenTelemetry|Warnings by Component|Logs|Installed Apps/MongoDB - OpenTelemetry/MongoDB - Errors and Warnings| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=mongodb  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| json field=\_raw "t.\$date" as timestamp<br />\| json field=\_raw "s" as severity<br />\| json field=\_raw "c" as mongodb\_component<br />\| json field=\_raw "ctx" as context<br />\| json field=\_raw "msg" as msg<br />\| where severity in ("W") <br />\| count by mongodb\_component|

