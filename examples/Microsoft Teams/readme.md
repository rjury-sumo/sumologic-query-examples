# Microsoft Teams
## Sumo Logic App For: Microsoft Teams
The Microsoft Teams app provides visibility into the logging that Microsoft exposes in the Office 365 Audit Logs for Microsoft Teams with out-of-the-box dashboards to monitor users, teams, channels and permission changes.
Docs Link: [Microsoft Teams](https://help.sumologic.com/?cid=209210837)

## Searches

### Log Searches

- **25 Most Recent Logins**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Bots Added and Removed Over Time**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Bots Added to Teams**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Bots Removed From Teams**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Channel Setting Changed**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Channel Tabs Added**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Channel Tabs Removed**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Channel Tabs Updated**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Channels Added**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Channels Added**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Channels Added and Removed Over Time**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Channels Removed**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Connector Activity Over Time**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Connectors Added**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Connectors Removed**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Connectors Updated**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Logins**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Logins**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Logins by Client Version**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Logins by Location**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Logins by Location**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Logins by Platform**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Logins this week vs. last week**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Malicious IP Addresses**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Member Role Changes Over Time**: from Dashboard: Microsoft Teams/Teams - User and Role Changes 
- **Members Added**: from Dashboard: Microsoft Teams/Teams - User and Role Changes 
- **Members Removed**: from Dashboard: Microsoft Teams/Teams - User and Role Changes 
- **Tab Activity Over Time**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Team Member Role Change**: from Dashboard: Microsoft Teams/Teams - User and Role Changes 
- **Team Setting Changed**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Teams Created**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Teams Created**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Teams Created and Removed Over Time**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Teams Removed**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Top 10 IP Addresses**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Top 10 Users by Region**: from Dashboard: Microsoft Teams/Teams - User Sessions 
- **Top 5 Bots Added to Teams**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Top 5 Bots Added to Teams**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Top 5 Channel Connectors Added**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Top 5 Channel Setting Changes**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Top 5 Channel Tab Types Added**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Top 5 Channels by Connector Activity**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Top 5 Channels by Tab Activity**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Top 5 Connectors Added**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Top 5 Object Names**: from Dashboard: Microsoft Teams/Teams - User and Role Changes 
- **Top 5 Object Names With Role Changes**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Top 5 Object Types**: from Dashboard: Microsoft Teams/Teams - User and Role Changes 
- **Top 5 Team Setting Changes**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Top 5 Teams with New Channels**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Top 5 Users Adding Channels**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Top 5 Users Adding Channels**: from Dashboard: Microsoft Teams/Teams - Channel Statistics 
- **Top 5 Users Creating Teams**: from Dashboard: Microsoft Teams/Teams - Team Statistics 
- **Top 5 Users Creating Teams**: from Dashboard: Microsoft Teams/Teams - Overview 
- **Top 5 Users Making Role Changes**: from Dashboard: Microsoft Teams/Teams - User and Role Changes 
- **Top 5 Users Making Role Changes**: from Dashboard: Microsoft Teams/Teams - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Microsoft Teams|25 Most Recent Logins|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId", "ObjectId" as workload, operation, email, client\_type<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as login\_time<br />\| count login\_time, email, client\_type<br />\| sort by login\_time<br />\| limit 25<br />\| fields -\_count<br /><br /><br />|
|Microsoft Teams|Bots Added and Removed Over Time|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "TeamName" as workload, operation, email, bot\_name, team\_name<br />\| where workload = "MicrosoftTeams" and (operation = "BotAddedToTeam" or operation = "BotRemovedFromTeam")<br />\| timeslice 1d<br />\| if(operation = "BotAddedToTeam",1,0) as bot\_added<br />\| if(operation = "BotRemovedFromTeam",1,0) as bot\_removed<br />\| sum(bot\_added) as bots\_added, sum(bot\_removed) as bots\_removed by \_timeslice<br />\| fillmissing timeslice(1d)<br /><br /><br /><br />|
|Microsoft Teams|Bots Added to Teams|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "TeamName" as workload, operation, email, bot\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "BotAddedToTeam"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as added\_time<br />\| count added\_time, email, bot\_name, team\_name<br />\| fields -\_count<br />\| sort by added\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Bots Removed From Teams|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "TeamName" as workload, operation, email, bot\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "BotRemovedFromTeam"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as remove\_time<br />\| count remove\_time, email, bot\_name, team\_name<br />\| fields -\_count<br />\| sort by remove\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Channel Setting Changed|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "Name", "NewValue", "OldValue", "TeamName", "ChannelName" as workload, operation, email, setting, new\_value, old\_value, team\_name, channel\_name<br />\| where workload = "MicrosoftTeams" and operation = "ChannelSettingChanged"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as update\_time<br />\| count update\_time, email, team\_name, channel\_name, setting, old\_value, new\_value<br />\| fields -\_count<br />\| sort by update\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Channel Tabs Added|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelName", "TabType", "TeamName" as workload, operation, email, channel\_name, tab\_type, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TabAdded"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as creation\_time<br />\| count creation\_time, email, tab\_type, channel\_name, team\_name<br />\| fields -\_count<br />\| sort by creation\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Channel Tabs Removed|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelName", "TabType", "TeamName" as workload, operation, email, channel\_name, tab\_type, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TabRemoved"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as remove\_time<br />\| count remove\_time, email, tab\_type, channel\_name, team\_name<br />\| fields -\_count<br />\| sort by remove\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Channel Tabs Updated|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelName", "TabType", "TeamName" as workload, operation, email, channel\_name, tab\_type, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TabUpdated"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as update\_time<br />\| count update\_time, email, tab\_type, channel\_name, team\_name<br />\| fields -\_count<br />\| sort by update\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Channels Added|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelType", "ChannelName", "TeamName" as workload, operation, email, channel\_type, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ChannelAdded"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as creation\_time<br />\| count creation\_time, email, channel\_name, channel\_type, team\_name<br />\| fields -\_count<br />\| sort by creation\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Channels Added|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelType", "ChannelName", "TeamName" as workload, operation, email, channel\_type, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ChannelAdded"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as creation\_time<br />\| count creation\_time, email, channel\_name, channel\_type, team\_name<br />\| fields -\_count<br />\| sort by creation\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Channels Added and Removed Over Time|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelType", "ChannelName", "TeamName" as workload, operation, email, channel\_type, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and (operation = "ChannelAdded" or operation = "ChannelDeleted")<br />\| timeslice 1d<br />\| if(operation = "ChannelAdded",1,0) as channel\_created<br />\| if(operation = "ChannelDeleted",1,0) as channel\_deleted<br />\| sum(channel\_created) as channels\_created, sum(channel\_deleted) as channels\_deleted by \_timeslice<br />\| fillmissing timeslice(1d)<br /><br /><br /><br /><br />|
|Microsoft Teams|Channels Removed|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelType", "ChannelName", "TeamName" as workload, operation, email, channel\_type, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ChannelDeleted"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as remove\_time<br />\| count remove\_time, email, channel\_name, channel\_type, team\_name<br />\| fields -\_count<br />\| sort by remove\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Connector Activity Over Time|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "ChannelName", "TeamName" as workload, operation, email, addon\_name, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and (operation = "ConnectorAdded" or operation = "ConnectorUpdated" or operation = "ConnectorRemoved")<br />\| timeslice 1d<br />\| if(operation = "ConnectorAdded",1,0) as connector\_added<br />\| if(operation = "ConnectorUpdated",1,0) as connector\_updated<br />\| if(operation = "ConnectorRemoved",1,0) as connector\_removed<br />\| sum(connector\_added) as connectors\_added, sum(connector\_updated) as connectors\_updated, sum(connector\_removed) as connectors\_removed by \_timeslice<br />\| fillmissing timeslice(1d)<br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Connectors Added|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "ChannelName", "TeamName" as workload, operation, email, addon\_name, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ConnectorAdded"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as creation\_time<br />\| count creation\_time, email, addon\_name, channel\_name, team\_name<br />\| fields -\_count<br />\| sort by creation\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Connectors Removed|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "ChannelName", "TeamName" as workload, operation, email, addon\_name, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ConnectorRemoved"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as remove\_time<br />\| count remove\_time, email, addon\_name, channel\_name, team\_name<br />\| fields -\_count<br />\| sort by remove\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Connectors Updated|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "ChannelName", "TeamName" as workload, operation, email, addon\_name, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ConnectorUpdated"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as update\_time<br />\| count update\_time, email, addon\_name, channel\_name, team\_name<br />\| fields -\_count<br />\| sort by update\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Logins|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId" as workload, operation, email<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| count<br /><br /><br />|
|Microsoft Teams|Logins|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId" as workload, operation, email<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| count<br /><br /><br />|
|Microsoft Teams|Logins by Client Version|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId", "ObjectId" as workload, operation, email, client\_type<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| parse field=client\_type "\*(\*)" as platform, version<br />\| count platform, version<br />\| \_count as logins<br />\| fields -\_count<br />\| sort by platform asc<br /><br /><br /><br />|
|Microsoft Teams|Logins by Location|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId", "ClientIP", "ObjectId" as workload, operation, email, client\_ip, client\_type<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city<br /><br /><br /><br /><br />|
|Microsoft Teams|Logins by Location|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId", "ClientIP", "ObjectId" as workload, operation, email, client\_ip, client\_type<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city<br /><br /><br /><br /><br />|
|Microsoft Teams|Logins by Platform|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId", "ObjectId" as workload, operation, email, client\_type<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| parse field=client\_type "\*(\*)" as platform, version<br />\| count platform<br /><br /><br /><br /><br />|
|Microsoft Teams|Logins this week vs. last week|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId" as workload, operation, email<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| timeslice 1d<br />\| count as Logins by \_timeslice<br />\| fillmissing timeslice(1d)<br />\| compare timeshift 1w as Previous\_Week<br /><br /><br /><br />|
|Microsoft Teams|Malicious IP Addresses|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId", "ClientIP", "ObjectId" as workload, operation, email, client\_ip, client\_type<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by client\_ip, malicious\_confidence, actor<br />\| sort by \_count<br /><br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Member Role Changes Over Time|Logs|Microsoft Teams/Teams - User and Role Changes|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "CommunicationType", "ItemName", "Members[\*].UPN", "Members[\*].Role" as workload, operation, email, object\_type, object\_name, members\_added\_raw, member\_role\_raw<br />\| where workload = "MicrosoftTeams" and (operation = "MemberAdded" or operation = "MemberRemoved" or operation = "MemberRoleChanged")<br />\| timeslice 1d<br />\| if(operation = "MemberAdded",1,0) as member\_added<br />\| if(operation = "MemberRemoved",1,0) as member\_removed<br />\| if(operation = "MemberRoleChanged",1,0) as member\_role\_changed<br />\| sum(member\_added) as members\_added, sum(member\_removed) as members\_removed, sum(member\_role\_changed) as members\_role\_changed by \_timeslice<br />\| fillmissing timeslice(1d)<br /><br />|
|Microsoft Teams|Members Added|Logs|Microsoft Teams/Teams - User and Role Changes|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "CommunicationType", "ItemName", "Members[\*].UPN", "Members[\*].Role" as workload, operation, email, object\_type, object\_name, members\_added\_raw, member\_role\_raw<br />\| where workload = "MicrosoftTeams" and operation = "MemberAdded"<br />\| replace(members\_added\_raw, "[", "") as members\_added\_raw<br />\| replace(members\_added\_raw, "\\"", "") as members\_added\_raw<br />\| replace(members\_added\_raw, ",", "\\n") as members\_added\_raw<br />\| replace(members\_added\_raw, "]", "") as members\_added<br />\| replace(member\_role\_raw, "[", "") as member\_role\_raw<br />\| replace(member\_role\_raw, "\\"", "") as member\_role\_raw<br />\| replace(member\_role\_raw, ",", "\\n") as member\_role\_raw<br />\| replace(member\_role\_raw, "]", "") as member\_role\_number<br />\| replace(member\_role\_number, "2", "Member") as member\_role\_number<br />\| replace(member\_role\_number, "1", "Owner") as member\_role\_number<br />\| replace(member\_role\_number, "3", "Guest") as member\_role<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as added\_time<br />\| count added\_time, email, object\_name, object\_type, members\_added, member\_role<br />\| fields -\_count<br />\| sort by added\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Members Removed|Logs|Microsoft Teams/Teams - User and Role Changes|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "CommunicationType", "ItemName", "Members[\*].UPN" as workload, operation, email, object\_type, object\_name, members\_removed\_raw<br />\| where workload = "MicrosoftTeams" and operation = "MemberRemoved"<br />\| replace(members\_removed\_raw, "[", "") as members\_removed\_raw<br />\| replace(members\_removed\_raw, "\\"", "") as members\_removed\_raw<br />\| replace(members\_removed\_raw, ",", "\\n") as members\_removed\_raw<br />\| replace(members\_removed\_raw, "]", "") as members\_removed<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as remove\_time<br />\| count remove\_time, email, object\_name, object\_type, members\_removed<br />\| fields -\_count<br />\| sort by remove\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Tab Activity Over Time|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelName", "TabType", "TeamName" as workload, operation, email, channel\_name, tab\_type, team\_name<br />\| where workload = "MicrosoftTeams" and (operation = "TabAdded" or operation = "TabRemoved" or operation = "TabUpdated")<br />\| timeslice 1d<br />\| if(operation = "TabAdded",1,0) as tab\_added<br />\| if(operation = "TabRemoved",1,0) as tab\_removed<br />\| if(operation = "TabUpdated",1,0) as tab\_updated<br />\| sum(tab\_added) as tabs\_added, sum(tab\_removed) as tabs\_removed, sum(tab\_updated) as tab\_updated by \_timeslice<br />\| fillmissing timeslice(1d)|
|Microsoft Teams|Team Member Role Change|Logs|Microsoft Teams/Teams - User and Role Changes|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "Members[\*].UPN", "Members[\*].Role", "TeamName" as workload, operation, email, members\_changed\_raw, member\_role\_raw, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "MemberRoleChanged"<br />\| replace(members\_changed\_raw, "[", "") as members\_changed\_raw<br />\| replace(members\_changed\_raw, "\\"", "") as members\_changed\_raw<br />\| replace(members\_changed\_raw, ",", "\\n") as members\_changed\_raw<br />\| replace(members\_changed\_raw, "]", "") as members\_changed<br />\| replace(member\_role\_raw, "[", "") as member\_role\_raw<br />\| replace(member\_role\_raw, "\\"", "") as member\_role\_raw<br />\| replace(member\_role\_raw, ",", "\\n") as member\_role\_raw<br />\| replace(member\_role\_raw, "]", "") as member\_role\_number<br />\| replace(member\_role\_number, "2", "Member") as member\_role\_number<br />\| replace(member\_role\_number, "1", "Owner") as member\_role\_number<br />\| replace(member\_role\_number, "3", "Guest") as member\_role<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as change\_time<br />\| count change\_time, email, team\_name, members\_changed, member\_role<br />\| fields -\_count<br />\| sort by change\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Team Setting Changed|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "Name", "NewValue", "OldValue", "TeamName" as workload, operation, email, setting, new\_value, old\_value, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TeamSettingChanged"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as update\_time<br />\| count update\_time, email, team\_name, setting, old\_value, new\_value<br />\| fields -\_count<br />\| sort by update\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Teams Created|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "TeamName" as workload, operation, email, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TeamCreated"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as creation\_time<br />\| count creation\_time, email, team\_name<br />\| fields -\_count<br />\| sort by creation\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Teams Created|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "TeamName" as workload, operation, email, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TeamCreated"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as creation\_time<br />\| count creation\_time, email, team\_name<br />\| fields -\_count<br />\| sort by creation\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Teams Created and Removed Over Time|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "TeamName" as workload, operation, email, team\_name<br />\| where workload = "MicrosoftTeams" and (operation = "TeamCreated" or operation = "TeamDeleted")<br />\| timeslice 1d<br />\| if(operation = "TeamCreated",1,0) as team\_created<br />\| if(operation = "TeamDeleted",1,0) as team\_deleted<br />\| sum(team\_created) as teams\_created, sum(team\_deleted) as teams\_deleted by \_timeslice<br />\| fillmissing timeslice(1d)<br /><br /><br /><br /><br />|
|Microsoft Teams|Teams Removed|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "TeamName" as workload, operation, email, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TeamDeleted"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as remove\_time<br />\| count remove\_time, email, team\_name<br />\| fields -\_count<br />\| sort by remove\_time<br /><br /><br /><br /><br />|
|Microsoft Teams|Top 10 IP Addresses|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId", "ClientIP", "ObjectId" as workload, operation, email, client\_ip, client\_type<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| count as logins by client\_ip<br />\| sort by logins<br />\| limit 10<br /><br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Top 10 Users by Region|Logs|Microsoft Teams/Teams - User Sessions|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation", "UserId", "ClientIP", "ObjectId" as workload, operation, email, client\_ip, client\_type<br />\| where workload = "MicrosoftTeams" and operation = "TeamsSessionStarted"<br />\| lookup country\_name, region from geo://location on ip = client\_ip<br />\| count as logins by email, country\_name, region<br />\| sort by logins<br />\| limit 10<br /><br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Bots Added to Teams|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "TeamName" as workload, operation, email, bot\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "BotAddedToTeam"<br />\| count bot\_name<br />\| \_count as times\_installed<br />\| fields -\_count<br />\| sort by times\_installed<br />\| limit 5<br /><br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Bots Added to Teams|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "TeamName" as workload, operation, email, bot\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "BotAddedToTeam"<br />\| count bot\_name<br />\| \_count as times\_installed<br />\| fields -\_count<br />\| sort by times\_installed<br />\| limit 5<br /><br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Channel Connectors Added|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "ChannelName", "TeamName" as workload, operation, email, addon\_name, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ConnectorAdded"<br />\| count addon\_name<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br />|
|Microsoft Teams|Top 5 Channel Setting Changes|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "Name", "NewValue", "OldValue", "TeamName", "ChannelName" as workload, operation, email, setting, new\_value, old\_value, team\_name, channel\_name<br />\| where workload = "MicrosoftTeams" and operation = "ChannelSettingChanged"<br />\| count setting<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br />|
|Microsoft Teams|Top 5 Channel Tab Types Added|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelName", "TabType", "TeamName" as workload, operation, email, channel\_name, tab\_type, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TabAdded"<br />\| count tab\_type<br />\| sort \_count<br />\| limit 5<br /><br /><br /><br />|
|Microsoft Teams|Top 5 Channels by Connector Activity|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "ChannelName", "TeamName" as workload, operation, email, addon\_name, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and (operation = "ConnectorAdded" or operation = "ConnectorUpdated" or operation = "ConnectorRemoved")<br />\| count by team\_name, channel\_name<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Channels by Tab Activity|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelName", "TabType", "TeamName" as workload, operation, email, channel\_name, tab\_type, team\_name<br />\| where workload = "MicrosoftTeams" and (operation = "TabAdded" or operation = "TabRemoved" or operation = "TabUpdated")<br />\| count by team\_name, channel\_name<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Connectors Added|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "AddOnName", "ChannelName", "TeamName" as workload, operation, email, addon\_name, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ConnectorAdded"<br />\| count addon\_name<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br />|
|Microsoft Teams|Top 5 Object Names|Logs|Microsoft Teams/Teams - User and Role Changes|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "CommunicationType", "ItemName", "Members[\*].UPN", "Members[\*].Role" as workload, operation, email, object\_type, object\_name, members\_added\_raw, member\_role\_raw<br />\| where workload = "MicrosoftTeams" and (operation = "MemberAdded" or operation = "MemberRemoved" or operation = "MemberRoleChanged")<br />\| count object\_type, object\_name<br />\| sort \_count<br />\| limit 5<br /><br />|
|Microsoft Teams|Top 5 Object Names With Role Changes|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "CommunicationType", "ItemName", "Members[\*].UPN", "Members[\*].Role" as workload, operation, email, object\_type, object\_name, members\_added\_raw, member\_role\_raw<br />\| where workload = "MicrosoftTeams" and (operation = "MemberAdded" or operation = "MemberRemoved" or operation = "MemberRoleChanged")<br />\| count object\_type, object\_name<br />\| sort \_count<br />\| limit 5<br /><br />|
|Microsoft Teams|Top 5 Object Types|Logs|Microsoft Teams/Teams - User and Role Changes|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "CommunicationType", "ItemName", "Members[\*].UPN", "Members[\*].Role" as workload, operation, email, object\_type, object\_name, members\_added\_raw, member\_role\_raw<br />\| where workload = "MicrosoftTeams" and (operation = "MemberAdded" or operation = "MemberRemoved" or operation = "MemberRoleChanged")<br />\| count object\_type<br />\| sort by \_count<br />\| limit 5<br /><br />|
|Microsoft Teams|Top 5 Team Setting Changes|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "Name", "NewValue", "OldValue", "TeamName" as workload, operation, email, setting, new\_value, old\_value, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TeamSettingChanged"<br />\| count setting<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br />|
|Microsoft Teams|Top 5 Teams with New Channels|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelType", "ChannelName", "TeamName" as workload, operation, email, channel\_type, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ChannelAdded"<br />\| count team\_name<br />\| \_count as channel\_count<br />\| sort by channel\_count<br />\| fields -\_count <br />\| limit 5<br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Users Adding Channels|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelType", "ChannelName", "TeamName" as workload, operation, email, channel\_type, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ChannelAdded"<br />\| count email<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Users Adding Channels|Logs|Microsoft Teams/Teams - Channel Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "ChannelType", "ChannelName", "TeamName" as workload, operation, email, channel\_type, channel\_name, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "ChannelAdded"<br />\| count email<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Users Creating Teams|Logs|Microsoft Teams/Teams - Team Statistics|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "TeamName" as workload, operation, email, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TeamCreated"<br />\| count email<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Users Creating Teams|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "TeamName" as workload, operation, email, team\_name<br />\| where workload = "MicrosoftTeams" and operation = "TeamCreated"<br />\| count email<br />\| sort by \_count<br />\| limit 5<br /><br /><br /><br /><br /><br />|
|Microsoft Teams|Top 5 Users Making Role Changes|Logs|Microsoft Teams/Teams - User and Role Changes|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "CommunicationType", "ItemName", "Members[\*].UPN", "Members[\*].Role" as workload, operation, email, object\_type, object\_name, members\_added\_raw, member\_role\_raw<br />\| where workload = "MicrosoftTeams" and (operation = "MemberAdded" or operation = "MemberRemoved" or operation = "MemberRoleChanged")<br />\| count email<br />\| sort by \_count<br />\| limit 5<br /><br />|
|Microsoft Teams|Top 5 Users Making Role Changes|Logs|Microsoft Teams/Teams - Overview|\_sourceCategory = Labs/Microsoft/Team\* <br />\| json "Workload", "Operation" , "UserId", "CommunicationType", "ItemName", "Members[\*].UPN", "Members[\*].Role" as workload, operation, email, object\_type, object\_name, members\_added\_raw, member\_role\_raw<br />\| where workload = "MicrosoftTeams" and (operation = "MemberAdded" or operation = "MemberRemoved" or operation = "MemberRoleChanged")<br />\| count email<br />\| sort by \_count<br />\| limit 5<br /><br />|

