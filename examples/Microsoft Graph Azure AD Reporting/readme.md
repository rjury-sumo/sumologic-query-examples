# Microsoft Graph Azure AD Reporting
## Sumo Logic App For: Microsoft Graph Azure AD Reporting
The Microsoft Graph Azure AD Reporting App of Sumo Logic provides visual representations of your organizationâ€™s Azure AD usage data. The Application dashboard helps you to monitor and analyze user activity, sign-in patterns and provisioning activities. Microsoft Graph Azure AD Reporting dashboards provide powerful tools for monitoring and managing your organization's Azure AD usage data, helping you to identify potential security issues and optimize your identity and access management strategy.
Docs Link: [Microsoft Graph Azure AD Reporting](https://help.sumologic.com/?cid=10198)

## Searches

### Log Searches

- **Audits by Initiators**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Audits by Operations**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Audits by Resource Categories**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Audits by Services**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Average Provisioning Activity Time**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities 
- **Categories by Operations**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Client Apps Used for Sign-Ins**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Failure Reasons**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Geo Locations of Sign-Ins**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Interactive Users Ratio**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Operations by Result**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Provisioning Actions by Status**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities 
- **Provisioning Activities by Action**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities 
- **Provisioning Activities by Initiator**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities 
- **Provisioning Activities by Status**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities 
- **Recent Audits**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Recent Provisioning Activities**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities 
- **Recent Sign-Ins**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Risky Event Types**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Risky Sign-In Reasons**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Sign-Ins**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Sign-Ins by Conditional Access Policy Status**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Sign-Ins by Risk Level**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Sign-Ins by Risk State**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Sign-Ins from Risky Countries**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Sign-Ins Over Time**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Target Resource Types**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits 
- **Top 10 Resources**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins 
- **Top 10 Service Principals**: from Dashboard: Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Microsoft Graph Azure AD Reporting|Audits by Initiators|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| count\_distinct(id) as frequency by initiator<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Audits by Operations|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| if (isNull(operation\_type) or isBlank(operation\_type),"Unknown",operation\_type) as operation\_type<br />\| count\_distinct(id) as frequency by operation\_type<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Audits by Resource Categories|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| count\_distinct(id) as frequency by category<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Audits by Services|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| count\_distinct(id) as frequency by logged\_by\_service<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Average Provisioning Activity Time|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities|\_sourceCategory={{Logsdatasource}}   "provisioningAction" "provisioningSteps" "provisioningStatusInfo"<br />\| json "id","provisioningStatusInfo.status","provisioningAction","durationInMilliseconds","initiatedBy.initiatingType","servicePrincipal.displayName","sourceIdentity.identityType","sourceSystem.displayName","targetIdentity.identityType","targetSystem.displayName" as id,provisioning\_status,provisioning\_action,duration\_in\_ms,initiated\_by,service\_principal,source\_identity\_type,source\_system,target\_identity\_type,target\_system\_name nodrop<br />\| where initiated\_by matches "{{initiated\_by}}"<br />\| where provisioning\_action matches "{{provisioning\_action}}"<br />\| where provisioning\_status matches "{{provisioning\_status}}"<br />\| where service\_principal matches "{{service\_principal}}"<br />\| count\_distinct(id) by duration\_in\_ms<br />\| avg(duration\_in\_ms)|
|Microsoft Graph Azure AD Reporting|Categories by Operations|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| where !isBlank(operation\_type)<br />\| where !isNull(operation\_type)<br />\| count\_distinct(id) as frequency by category|
|Microsoft Graph Azure AD Reporting|Client Apps Used for Sign-Ins|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| count\_distinct(id) as frequency by client\_app\_used<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Failure Reasons|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| if (isNull(result\_reason) or isBlank(result\_reason),"Unknown",result\_reason) as result\_reason<br />\| count\_distinct(id) as frequency by result\_reason<br />\| sort by frequency<br />\| limit 50|
|Microsoft Graph Azure AD Reporting|Geo Locations of Sign-Ins|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by ip<br />\| lookup latitude, longitude from geo://location on ip = ip|
|Microsoft Graph Azure AD Reporting|Interactive Users Ratio|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| if((is\_interactive matches("true")),"is\_interactive","is\_not\_interactive") as is\_interactive<br />\| count\_distinct(id) as frequency by is\_interactive<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Operations by Result|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| count\_distinct(id) as frequency by operation\_result<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Provisioning Actions by Status|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities|\_sourceCategory={{Logsdatasource}}   "provisioningAction" "provisioningSteps" "provisioningStatusInfo"<br />\| json "id","provisioningStatusInfo.status","provisioningAction","durationInMilliseconds","initiatedBy.initiatingType","servicePrincipal.displayName","sourceIdentity.identityType","sourceSystem.displayName","targetIdentity.identityType","targetSystem.displayName" as id,provisioning\_status,provisioning\_action,duration\_in\_ms,initiated\_by,service\_principal,source\_identity\_type,source\_system,target\_identity\_type,target\_system\_name nodrop<br />\| where initiated\_by matches "{{initiated\_by}}"<br />\| where provisioning\_action matches "{{provisioning\_action}}"<br />\| where provisioning\_status matches "{{provisioning\_status}}"<br />\| where service\_principal matches "{{service\_principal}}"<br />\| count\_distinct(id) as frequency by provisioning\_action,provisioning\_status<br />\| transpose row provisioning\_action column provisioning\_status|
|Microsoft Graph Azure AD Reporting|Provisioning Activities by Action|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities|\_sourceCategory={{Logsdatasource}}   "provisioningAction" "provisioningSteps" "provisioningStatusInfo"<br />\| json "id","provisioningStatusInfo.status","provisioningAction","durationInMilliseconds","initiatedBy.initiatingType","servicePrincipal.displayName","sourceIdentity.identityType","sourceSystem.displayName","targetIdentity.identityType","targetSystem.displayName" as id,provisioning\_status,provisioning\_action,duration\_in\_ms,initiated\_by,service\_principal,source\_identity\_type,source\_system,target\_identity\_type,target\_system\_name nodrop<br />\| where initiated\_by matches "{{initiated\_by}}"<br />\| where provisioning\_action matches "{{provisioning\_action}}"<br />\| where provisioning\_status matches "{{provisioning\_status}}"<br />\| where service\_principal matches "{{service\_principal}}"<br />\| count\_distinct(id) as frequency by provisioning\_action<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Provisioning Activities by Initiator|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities|\_sourceCategory={{Logsdatasource}}   "provisioningAction" "provisioningSteps" "provisioningStatusInfo"<br />\| json "id","provisioningStatusInfo.status","provisioningAction","durationInMilliseconds","initiatedBy.initiatingType","servicePrincipal.displayName","sourceIdentity.identityType","sourceSystem.displayName","targetIdentity.identityType","targetSystem.displayName" as id,provisioning\_status,provisioning\_action,duration\_in\_ms,initiated\_by,service\_principal,source\_identity\_type,source\_system,target\_identity\_type,target\_system\_name nodrop<br />\| where initiated\_by matches "{{initiated\_by}}"<br />\| where provisioning\_action matches "{{provisioning\_action}}"<br />\| where provisioning\_status matches "{{provisioning\_status}}"<br />\| where service\_principal matches "{{service\_principal}}"<br />\| count\_distinct(id) as frequency by initiated\_by<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Provisioning Activities by Status|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities|\_sourceCategory={{Logsdatasource}}   "provisioningAction" "provisioningSteps" "provisioningStatusInfo"<br />\| json "id","provisioningStatusInfo.status","provisioningAction","durationInMilliseconds","initiatedBy.initiatingType","servicePrincipal.displayName","sourceIdentity.identityType","sourceSystem.displayName","targetIdentity.identityType","targetSystem.displayName" as id,provisioning\_status,provisioning\_action,duration\_in\_ms,initiated\_by,service\_principal,source\_identity\_type,source\_system,target\_identity\_type,target\_system\_name nodrop<br />\| where initiated\_by matches "{{initiated\_by}}"<br />\| where provisioning\_action matches "{{provisioning\_action}}"<br />\| where provisioning\_status matches "{{provisioning\_status}}"<br />\| where service\_principal matches "{{service\_principal}}"<br />\| count\_distinct(id) as frequency by provisioning\_status<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Recent Audits|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| count\_distinct(id) by \_messageTime,id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,initiator<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time\_stamp<br />\| if (isNull(operation\_type) or isBlank(operation\_type),"Unknown",operation\_type) as operation\_type<br />\| if (isNull(result\_reason) or isBlank(result\_reason),"Unknown",result\_reason) as result\_reason<br />\| top 100 time\_stamp,activity,category,operation\_type,initiator,operation\_result,result\_reason,target\_resource\_type,logged\_by\_service,id by time\_stamp|
|Microsoft Graph Azure AD Reporting|Recent Provisioning Activities|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities|\_sourceCategory={{Logsdatasource}}   "provisioningAction" "provisioningSteps" "provisioningStatusInfo"<br />\| json "id","provisioningStatusInfo.status","provisioningAction","durationInMilliseconds","initiatedBy.initiatingType","servicePrincipal.displayName","sourceIdentity.identityType","sourceSystem.displayName","targetIdentity.identityType","targetSystem.displayName" as id,provisioning\_status,provisioning\_action,duration\_in\_ms,initiated\_by,service\_principal,source\_identity\_type,source\_system,target\_identity\_type,target\_system\_name nodrop<br />\| where initiated\_by matches "{{initiated\_by}}"<br />\| where provisioning\_action matches "{{provisioning\_action}}"<br />\| where provisioning\_status matches "{{provisioning\_status}}"<br />\| where service\_principal matches "{{service\_principal}}"<br />\| count\_distinct(id) by \_messageTime,id,provisioning\_status,provisioning\_action,duration\_in\_ms,initiated\_by,service\_principal,source\_identity\_type,source\_system,target\_identity\_type,target\_system\_name<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time\_stamp<br />\| top 100 time\_stamp,initiated\_by,source\_system,source\_identity\_type,target\_system\_name,target\_identity\_type,provisioning\_action,provisioning\_status,service\_principal,duration\_in\_ms,id by time\_stamp|
|Microsoft Graph Azure AD Reporting|Recent Sign-Ins|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus","userDisplayName" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status,user\_display\_name nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| if((is\_interactive matches("true")),"is\_interactive","is\_not\_interactive") as is\_interactive<br />\| count\_distinct(id) by \_messageTime,id,user\_display\_name,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time\_stamp<br />\| if (isNull(failure\_reason) or isBlank(failure\_reason),"Null",failure\_reason) as failure\_reason<br />\| top 100 time\_stamp,user\_display\_name,client\_app\_used,resource,risk\_reason,risk\_level,risk\_state,risk\_event\_types,failure\_reason,conditional\_activity\_status,is\_interactive by time\_stamp|
|Microsoft Graph Azure AD Reporting|Risky Event Types|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| extract field=risk\_event\_types "\\"?(?\<risk\_event\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| count\_distinct(id) as frequency by risk\_event\_type<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Risky Sign-In Reasons|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| count\_distinct(id) as frequency by risk\_reason<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Sign-Ins|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| count\_distinct(id)|
|Microsoft Graph Azure AD Reporting|Sign-Ins by Conditional Access Policy Status|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| count\_distinct(id) as frequency by conditional\_activity\_status<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Sign-Ins by Risk Level|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| count\_distinct(id) as frequency by risk\_level<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Sign-Ins by Risk State|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| count\_distinct(id) as frequency by risk\_state<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Sign-Ins from Risky Countries|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = ip <br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code <br />\| where !isBlank(country\_code)|
|Microsoft Graph Azure AD Reporting|Sign-Ins Over Time|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| timeslice 1d<br />\| count\_distinct(id) by \_timeslice<br />\| fillmissing timeslice|
|Microsoft Graph Azure AD Reporting|Target Resource Types|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Audits|\_sourceCategory={{Logsdatasource}}   "activityDisplayName" "operationType"<br />\| json "id","activityDisplayName","category","loggedByService","operationType","result","resultReason","targetResources[\*].type","initiatedBy.user","initiatedBy.app" as id,activity,category,logged\_by\_service,operation\_type,operation\_result,result\_reason,target\_resource\_type,is\_user\_initiator,is\_app\_initiator nodrop<br />\| where category matches "{{resource\_category}}"<br />\| where logged\_by\_service matches"{{service}}"<br />\| where operation\_result matches "{{operation\_result}}"<br />\| where operation\_type matches "{{operation\_type}}"<br />\| if (isNull(is\_user\_initiator),"app","user") as initiator<br />\| where initiator matches "{{initiator}}"<br />\| extract field=target\_resource\_type "\\"?(?\<multi\_target\_resource\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| count\_distinct(id) as frequency by multi\_target\_resource\_type<br />\| sort by frequency|
|Microsoft Graph Azure AD Reporting|Top 10 Resources|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Sign-Ins|\_sourceCategory={{Logsdatasource}}   "appDisplayName" "clientAppUsed" "ipAddress" "resourceId"<br />\| json "id","ipAddress","clientAppUsed","isInteractive","resourceDisplayName","riskDetail","riskEventTypes","riskLevelAggregated","riskState","status.failureReason","conditionalAccessStatus" as id, ip,client\_app\_used,is\_interactive,resource,risk\_reason,risk\_event\_types,risk\_level,risk\_state,failure\_reason,conditional\_activity\_status nodrop<br />\| where risk\_reason matches "{{risk\_reason}}"<br />\| where risk\_level matches "{{risk\_level}}"<br />\| where risk\_state matches "{{risk\_state}}"<br />\| where client\_app\_used matches "{{client\_app\_used}}"<br />\| where conditional\_activity\_status matches "{{conditional\_access\_policy\_status}}"<br />\| if(isNull(failure\_reason) or isBlank(failure\_reason),"false","true") as sign\_in\_failed<br />\| where sign\_in\_failed matches "{{sign\_in\_failed}}"<br />\| count\_distinct(id) as frequency by resource<br />\| sort by frequency<br />\| limit 10|
|Microsoft Graph Azure AD Reporting|Top 10 Service Principals|Logs|Installed Apps/Microsoft Graph Azure AD Reporting/Microsoft Graph Azure AD Reporting - Provisioning Activities|\_sourceCategory={{Logsdatasource}}   "provisioningAction" "provisioningSteps" "provisioningStatusInfo"<br />\| json "id","provisioningStatusInfo.status","provisioningAction","durationInMilliseconds","initiatedBy.initiatingType","servicePrincipal.displayName","sourceIdentity.identityType","sourceSystem.displayName","targetIdentity.identityType","targetSystem.displayName" as id,provisioning\_status,provisioning\_action,duration\_in\_ms,initiated\_by,service\_principal,source\_identity\_type,source\_system,target\_identity\_type,target\_system\_name nodrop<br />\| where initiated\_by matches "{{initiated\_by}}"<br />\| where provisioning\_action matches "{{provisioning\_action}}"<br />\| where provisioning\_status matches "{{provisioning\_status}}"<br />\| where service\_principal matches "{{service\_principal}}"<br />\| count\_distinct(id) as frequency by service\_principal<br />\| sort by frequency<br />\| limit 10|

