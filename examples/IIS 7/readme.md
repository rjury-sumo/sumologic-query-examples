# IIS 7

## Searches

### Log Searches

- **400 and 500 Server Errors**: from Dashboard: IIS 7/IIS 7 - Overview - New 
- **IIS 7 - All HTTP Response Codes with their Count**: from Search: IIS 7/Server Operations/IIS 7 - All HTTP Response Codes with their Count 
- **IIS 7 - Client Errors (4xx response codes) per Day**: from Search: IIS 7/Server Operations/IIS 7 - Client Errors (4xx response codes) per Day 
- **IIS 7 - HTTP Status Code Summary over time**: from Search: IIS 7/Server Operations/IIS 7 - HTTP Status Code Summary over time 
- **IIS 7 - Malicious URL Requests**: from Search: IIS 7/Traffic Insights/IIS 7 - Malicious URL Requests 
- **IIS 7 - Robots**: from Search: IIS 7/Traffic Insights/IIS 7 - Robots 
- **IIS 7 - Slowest URLs by Average Time**: from Search: IIS 7/Server Operations/IIS 7 - Slowest URLs by Average Time 
- **IIS 7 - Time Taken to Serve Requests**: from Search: IIS 7/Server Operations/IIS 7 - Time Taken to Serve Requests 
- **IIS 7 - Top 404 URLs**: from Search: IIS 7/Server Operations/IIS 7 - Top 404 URLs 
- **IIS 7 - Top Browsers**: from Search: IIS 7/Traffic Insights/IIS 7 - Top Browsers 
- **IIS 7 - Top Clients**: from Search: IIS 7/Traffic Insights/IIS 7 - Top Clients 
- **IIS 7 - Top Clients Causing Errors**: from Search: IIS 7/Server Operations/IIS 7 - Top Clients Causing Errors 
- **IIS 7 - Top URLs by Count**: from Search: IIS 7/Traffic Insights/IIS 7 - Top URLs by Count 
- **IIS 7 - Traffic Volume Served per Day**: from Search: IIS 7/Traffic Insights/IIS 7 - Traffic Volume Served per Day 
- **Media Types Requested Over Time**: from Dashboard: IIS 7/Traffic Insights/IIS 7 - Traffic Insights - Content and Client Platform - New 
- **OS Platform**: from Dashboard: IIS 7/Traffic Insights/IIS 7 - Traffic Insights - Content and Client Platform - New 
- **OS Platform Breakdown**: from Dashboard: IIS 7/IIS 7 - Overview - New 
- **OSes and Browsers**: from Dashboard: IIS 7/Traffic Insights/IIS 7 - Traffic Insights - Content and Client Platform - New 
- **Response Time Histogram**: from Dashboard: IIS 7/IIS 7 - Overview - New 
- **Top Apps by Request**: from Dashboard: IIS 7/IIS 7 - Overview - New 
- **Top Requested Documents**: from Dashboard: IIS 7/Traffic Insights/IIS 7 - Traffic Insights - Content and Client Platform - New 
- **Visits by Country**: from Dashboard: IIS 7/IIS 7 - Overview - New

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|IIS 7|400 and 500 Server Errors|Logs|IIS 7/IIS 7 - Overview - New|\_sourceCategory = Labs/IIS/\*<br />\| parse regex "\\d+-\\d+-\\d+ \\d+:\\d+:\\d+ (?\<server\_ip\>\\S+) (?\<method\>\\S+) (?\<cs\_uri\_stem\>/\\S+?) \\S+ \\d+ (?\<user\>\\S+) (?\<client\_ip\>[\\.\\d]+) "<br />\| parse regex "(?\<sc\_status\>\\d+) (?\<sc\_substatus\>\\d+) (?\<sc\_win32\_status\>\\d+) (?\<time\_taken\>\\d+)\$"<br />\| if(sc\_status matches "5\*" OR sc\_status matches "4\*", "Error", "") as Errors<br />\| where Errors != ""<br />\|where if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count as Count|
|IIS 7/Server Operations|IIS 7 - All HTTP Response Codes with their Count|Logs|IIS 7/Server Operations/IIS 7 - All HTTP Response Codes with their Count|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| count by sc\_status <br />\| sort by \_count|
|IIS 7/Server Operations|IIS 7 - Client Errors (4xx response codes) per Day|Logs|IIS 7/Server Operations/IIS 7 - Client Errors (4xx response codes) per Day|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| where sc\_status matches "4\*" \| timeslice by 1d \| count by \_timeslice|
|IIS 7/Server Operations|IIS 7 - HTTP Status Code Summary over time|Logs|IIS 7/Server Operations/IIS 7 - HTTP Status Code Summary over time|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors <br />\| timeslice by 1d <br />\| sum(successes) as successes,  sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by \_timeslice|
|IIS 7/Traffic Insights|IIS 7 - Malicious URL Requests|Logs|IIS 7/Traffic Insights/IIS 7 - Malicious URL Requests|\_sourceCategory = Labs/IIS/\* AND ("jsessionid" OR "old" OR "bak") <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| where cs\_uri\_stem matches "\*.old" OR cs\_uri\_stem matches "\*.bak" OR cs\_uri\_query matches "\*jsessionid=\*"|
|IIS 7/Traffic Insights|IIS 7 - Robots|Logs|IIS 7/Traffic Insights/IIS 7 - Robots|\_sourceCategory = Labs/IIS/\* "/robots.txt" <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| count\_frequent cs\_user\_agent|
|IIS 7/Server Operations|IIS 7 - Slowest URLs by Average Time|Logs|IIS 7/Server Operations/IIS 7 - Slowest URLs by Average Time|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| (time\_taken/1000) as seconds <br />\| avg(seconds) as avgtimeinseconds by cs\_uri\_stem <br />\| sort by avgtimeinseconds <br />\| limit 100|
|IIS 7/Server Operations|IIS 7 - Time Taken to Serve Requests|Logs|IIS 7/Server Operations/IIS 7 - Time Taken to Serve Requests|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| (time\_taken/1000) as seconds <br />\| seconds/60 as minutes |
|IIS 7/Server Operations|IIS 7 - Top 404 URLs|Logs|IIS 7/Server Operations/IIS 7 - Top 404 URLs|\_sourceCategory = Labs/IIS/\* "404" <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| where sc\_status matches "404" <br />\| count\_frequent cs\_uri\_stem <br />\| limit 100|
|IIS 7/Traffic Insights|IIS 7 - Top Browsers|Logs|IIS 7/Traffic Insights/IIS 7 - Top Browsers|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| count\_frequent cs\_user\_agent <br />\| limit 100|
|IIS 7/Traffic Insights|IIS 7 - Top Clients|Logs|IIS 7/Traffic Insights/IIS 7 - Top Clients|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| count\_frequent c\_ip <br />\| limit 100|
|IIS 7/Server Operations|IIS 7 - Top Clients Causing Errors|Logs|IIS 7/Server Operations/IIS 7 - Top Clients Causing Errors|\_sourceCategory = Labs/IIS/\* 4\*<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| where sc\_status matches "4\*" <br />\| count\_frequent c\_ip <br />\| limit 100|
|IIS 7/Traffic Insights|IIS 7 - Top URLs by Count|Logs|IIS 7/Traffic Insights/IIS 7 - Top URLs by Count|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| count\_frequent cs\_uri\_stem <br />\| limit 100|
|IIS 7/Traffic Insights|IIS 7 - Traffic Volume Served per Day|Logs|IIS 7/Traffic Insights/IIS 7 - Traffic Volume Served per Day|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop<br />\| parse regex "(?\<s\_sitename\>\\S+?) (?\<cs\_computername\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_version\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_cookie\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<cs\_host\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<sc\_bytes\>\\S+?) (?\<cs\_bytes\>\\S+?) (?\<time\_taken\>\\S+?)\$" nodrop <br />\| timeslice by 1d \| count as hits by \_timeslice|
|IIS 7/Traffic Insights|Media Types Requested Over Time|Logs|IIS 7/Traffic Insights/IIS 7 - Traffic Insights - Content and Client Platform - New|\_sourceCategory = Labs/IIS/\*<br />\| parse regex "\\d+-\\d+-\\d+ \\d+:\\d+:\\d+ (?\<server\_ip\>\\S+) (?\<method\>\\S+) (?\<cs\_uri\_stem\>/\\S+?) \\S+ \\d+ (?\<user\>\\S+) (?\<client\_ip\>[\\.\\d]+) " <br />\| parse regex field=cs\_uri\_stem "\\.(?\<media\_type\>[A-Za-z]+)\$" <br />\| timeslice 1m<br />\|where if ("{{media\_type}}" = "\*", true, media\_type matches "{{media\_type}}")<br />\|count as Requests by \_timeslice, media\_type<br />\| transpose row \_timeslice column media\_type|
|IIS 7/Traffic Insights|OS Platform|Logs|IIS 7/Traffic Insights/IIS 7 - Traffic Insights - Content and Client Platform - New|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "\\d+-\\d+-\\d+ \\d+:\\d+:\\d+ (?\<server\_ip\>\\S+) (?\<method\>\\S+) (?\<cs\_uri\_stem\>/\\S+?) \\S+ \\d+ (?\<user\>\\S+) (?\<client\_ip\>[\\.\\d]+) (?\<agent\>\\S+) " <br />\| if (agent matches "\*iPad\*" OR agent matches "\*iPhone\*" OR agent matches "\*BlackBerry\*" OR agent matches "\*SAMSUNG\*" OR agent matches "\*Galaxy\*" or agent matches "\*Windows Phone\*" or agent matches "\*Android\*" or agent matches "LGE-\*" or agent matches "SCH-\*" or agent matches "\*HUAWEI-\*" or agent matches "\*samsung\*" or agent matches "Dalvik/\*" OR agent matches "Nokia\*" OR agent matches "LG-\*" or agent matches "\*CFNetwork\*" or agent matches "\*UP.Browser/\*" or agent matches "\*QQ\*rowser\*" or agent matches "\*NetFront/\*" or agent matches "\*Mobile Safari\*" or agent matches "\*iemobile\*","Mobile","PC") as type<br />\| if (agent matches "\*Macintosh\*" or agent matches "\*Mac OS\*" or agent matches "\*iMac\*","Mac",type) as type<br />\|where if ("{{cs\_uri\_stem}}" = "\*", true, cs\_uri\_stem matches "{{cs\_uri\_stem}}")<br />\|count type \| sort by \_count|
|IIS 7|OS Platform Breakdown|Logs|IIS 7/IIS 7 - Overview - New|\_sourceCategory = Labs/IIS/\*<br />\| parse regex "\\d+-\\d+-\\d+ \\d+:\\d+:\\d+ (?\<server\_ip\>\\S+) (?\<method\>\\S+) (?\<cs\_uri\_stem\>/\\S+?) \\S+ \\d+ (?\<user\>\\S+) (?\<client\_ip\>[\\.\\d]+) (?\<agent\>\\S+) "<br />\| if (agent matches "\*iPad\*" OR agent matches "\*iPhone\*" OR agent matches "\*BlackBerry\*" OR agent matches "\*SAMSUNG\*" OR agent matches "\*Galaxy\*" or agent matches "\*Windows Phone\*" or agent matches "\*Android\*" or agent matches "LGE-\*" or agent matches "SCH-\*" or agent matches "\*HUAWEI-\*" or agent matches "\*samsung\*" or agent matches "Dalvik/\*" OR agent matches "Nokia\*" OR agent matches "LG-\*" or agent matches "\*CFNetwork\*" or agent matches "\*UP.Browser/\*" or agent matches "\*QQ\*rowser\*" or agent matches "\*NetFront/\*" or agent matches "\*Mobile Safari\*" or agent matches "\*iemobile\*", "Mobile", "PC") as type<br />\| if (agent matches "\*Macintosh\*" or agent matches "\*Mac OS\*" or agent matches "\*iMac\*", "Mac", type) as type<br />\|where if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by type \| sort by \_count|
|IIS 7/Traffic Insights|OSes and Browsers|Logs|IIS 7/Traffic Insights/IIS 7 - Traffic Insights - Content and Client Platform - New|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "\\d+-\\d+-\\d+ \\d+:\\d+:\\d+ (?\<server\_ip\>\\S+) (?\<method\>\\S+) (?\<cs\_uri\_stem\>/\\S+?) \\S+ \\d+ (?\<user\>\\S+) (?\<client\_ip\>[\\.\\d]+) (?\<agent\>\\S+) " <br />\| if ((agent matches "\*Windows NT\*") or (agent matches "\*Windows+NT\*") or (agent matches "\*Windows \*") or (agent matches "\*Win32\*") or (agent matches "\*Win64\*"), "Windows", "Other") as OS \|<br />if (agent matches "\*Macintosh\*","MacOS",OS) as OS \|<br />if ((agent matches "\*Windows Phone\*") or (agent matches "\*Windows+Phone\*"),"Windows Phone",OS) as OS \|<br />if (agent matches "\*Linux\*","Linux",OS) as OS \|<br />if (agent matches "\*iPad\*","iPad",OS) as OS \|<br />if (agent matches "\*iPhone\*","iPhone",OS) as OS \|<br />if (agent matches "\*Android\*","Android",OS) as OS \|<br />if (agent matches "\*Darwin\*","Darwin",OS) as OS \|<br />if (agent matches "\*CrOS\*","Google Chrome",OS) as OS \|<br />if (agent matches "\*MSIE\*","Internet Explorer","Other") as Browser \|<br />if (agent matches "Internet Explorer","Internet Explorer", Browser) as Browser \|<br />if (agent matches "\*Trident\*","Internet Explorer", Browser) as Browser \|<br />if (agent matches "\*Firefox\*","Firefox",Browser) as Browser \|<br />if (agent matches "\*Safari\*","Safari", Browser) as Browser \| <br />if (agent matches "\*Chrome\*","Chrome", Browser) as Browser \|<br />if (agent matches "Opera\*","Opera", Browser) as Browser \| <br />if (agent matches "Dolphin\*","Dolphin", Browser) as Browser<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}")<br />\|count(agent) by OS,Browser <br />\| transpose row os column browser as \*|
|IIS 7|Response Time Histogram|Logs|IIS 7/IIS 7 - Overview - New|\_sourceCategory = Labs/IIS/\*<br />\| parse regex "\\d+-\\d+-\\d+ \\d+:\\d+:\\d+ (?\<server\_ip\>\\S+) (?\<method\>\\S+) (?\<cs\_uri\_stem\>/\\S+?) \\S+ \\d+ (?\<user\>\\S+) (?\<client\_ip\>[\\.\\d]+) "<br />\| parse regex "\\d+ \\d+ \\d+ (?\<time\_taken\>\\d+)\$"<br />\|where if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|avg(time\_taken) as avg\_time\_taken by cs\_uri\_stem<br />\| fields avg\_time\_taken<br />\| (floor(avg\_time\_taken/50)+1)\*50 as avg\_time\_taken\_bucket\_ms<br />\| if (avg\_time\_taken \> 1000, 1001, avg\_time\_taken\_bucket\_ms) as avg\_time\_taken\_bucket\_ms<br />\| count as Frequency by avg\_time\_taken\_bucket\_ms<br />\| sort by + avg\_time\_taken\_bucket\_ms<br />\| if (avg\_time\_taken\_bucket\_ms = 1001, "\>1000", toString(avg\_time\_taken\_bucket\_ms)) as avg\_time\_taken\_bucket\_ms|
|IIS 7|Top Apps by Request|Logs|IIS 7/IIS 7 - Overview - New|\_sourceCategory = Labs/IIS/\*<br />\| parse regex "\\d+-\\d+-\\d+ \\d+:\\d+:\\d+ (?\<server\_ip\>\\S+) (?\<method\>\\S+) (?\<cs\_uri\_stem\>/\\S+?) "<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+)/"<br />\|where if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count as Requests by app  \| sort -Requests \| limit 10|
|IIS 7/Traffic Insights|Top Requested Documents|Logs|IIS 7/Traffic Insights/IIS 7 - Traffic Insights - Content and Client Platform - New|\_sourceCategory = Labs/IIS/\* <br />\| parse regex "\\d+-\\d+-\\d+ \\d+:\\d+:\\d+ (?\<server\_ip\>\\S+) (?\<method\>\\S+) (?\<cs\_uri\_stem\>/\\S+?) \\S+ \\d+ (?\<user\>\\S+) (?\<client\_ip\>[\\.\\d]+) "<br />\|where if ("{{cs\_uri\_stem}}" = "\*", true, cs\_uri\_stem matches "{{cs\_uri\_stem}}")<br />\|count as requests by cs\_uri\_stem <br />\| sort - requests \| limit 10|
|IIS 7|Visits by Country|Logs|IIS 7/IIS 7 - Overview - New|\_sourceCategory = Labs/IIS/\*<br />\| parse regex "(?:80\|443) (?:\\w+\|-+\|\\\\+)+ (?\<client\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) "<br />\| count by client\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip=client\_ip<br />\|where if ("{{country\_name}}" = "\*", true, country\_name matches "{{country\_name}}")|

