# Slack
## Sumo Logic App For: Slack
The Sumo Logic App for Slack provides monitoring and data analytics for Slack users, channels, access logs for workspaces with free, standard, plus and enterprise plans. The app is focused on public channels only.
Docs Link: [Slack](https://help.sumologic.com/?cid=1981)

## Searches

### Log Searches

- **2FA by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Access - Total Entries by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Access - Total Entries by Workspace**: from Dashboard: Slack/Slack - Access - New 
- **Access - Users by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Access - Users by Workspace**: from Dashboard: Slack/Slack - Access - New 
- **Access Information**: from Dashboard: Slack/Slack - Access - New 
- **Access Information**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Access Locations**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Active Channels**: from Dashboard: Installed Apps/Slack/Slack - Public Channels 
- **Admins**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **App - Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **App - Top 10 Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **App - Top 5 Users**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **Audit Action Trend**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Audit Events Locations**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Billable Members by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Bot Summary**: from Dashboard: Installed Apps/Slack/Slack - Bots 
- **Bots**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Bots by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Bots 
- **Bots Information**: from Dashboard: Installed Apps/Slack/Slack - Bots 
- **Browsers by Workspace**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Channel Summary**: from Dashboard: Installed Apps/Slack/Slack - Public Channels 
- **Channels**: from Dashboard: Installed Apps/Slack/Slack - Public Channels 
- **Countries by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Countries by Workspace**: from Dashboard: Slack/Slack - Access - New 
- **Desktop OS Version by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Desktop OS Version by Workspace**: from Dashboard: Slack/Slack - Access - New 
- **Desktop Users**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Desktop Users**: from Dashboard: Slack/Slack - Access - New 
- **File - Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **File - Top 10 Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **File - Top 5 Users**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **File Types**: from Dashboard: Slack/Slack - Public Messages - New 
- **File Types**: from Dashboard: Installed Apps/Slack/Slack - Public Messages 
- **Files Shared by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Guest Activity**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Channel Audit 
- **Guest Activity**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - User Audit 
- **Guests App Activity**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **Guests File Activity**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **In-Active Channels**: from Dashboard: Installed Apps/Slack/Slack - Public Channels 
- **In-Active Members**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Member Information**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Member Roles**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Members**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Members Activity**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Channel Audit 
- **Members Activity**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - User Audit 
- **Members App Activity**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **Members by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Members File Activity**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **Message Types**: from Dashboard: Installed Apps/Slack/Slack - Public Messages 
- **Message Types**: from Dashboard: Slack/Slack - Public Messages - New 
- **Mobile Users**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Mobile Users**: from Dashboard: Slack/Slack - Access - New 
- **OS and Version by Workspace**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Public Messages**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Public Messages by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Recent Attachments**: from Dashboard: Installed Apps/Slack/Slack - Public Messages 
- **Recent Attachments**: from Dashboard: Slack/Slack - Public Messages - New 
- **Recent File Shared**: from Dashboard: Installed Apps/Slack/Slack - Public Messages 
- **Recent File Shared**: from Dashboard: Slack/Slack - Public Messages - New 
- **Recent Messages**: from Dashboard: Installed Apps/Slack/Slack - Public Messages 
- **Recent Messages**: from Dashboard: Slack/Slack - Public Messages - New 
- **Role Changed**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - User Audit 
- **Roles by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Threat by Malicious Confidence**: from Dashboard: Slack/Slack - Access - New 
- **Threat Count**: from Dashboard: Slack/Slack - Access - New 
- **Threat Count**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Threat Location**: from Dashboard: Slack/Slack - Access - New 
- **Threat Location**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Threats by Actor**: from Dashboard: Slack/Slack - Access - New 
- **Threats by Actor**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **TimeZone by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Top 10 Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Top 10 Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Workspace Audit 
- **Top 10 Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Channel Audit 
- **Top 10 Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - User Audit 
- **Top 10 Channels by Attachments**: from Dashboard: Installed Apps/Slack/Slack - Public Channels 
- **Top 10 Channels by Files**: from Dashboard: Installed Apps/Slack/Slack - Public Channels 
- **Top 10 File Types**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **Top 10 Scopes**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - File and App Audit 
- **Top 5 Admins**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - User Audit 
- **Top 5 Channels by Files**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Top 5 Channels by Messages**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Top 5 Guest Members**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Channel Audit 
- **Top 5 Members**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Channel Audit 
- **Top 5 Members by Messages**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Top 5 Users**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Top 5 Users**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Workspace Audit 
- **Top Browser by Workspace**: from Dashboard: Slack/Slack - Access - New 
- **Top Browser by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Top Members Activity**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Top Users**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Top Users**: from Dashboard: Slack/Slack - Access - New 
- **Total File Size**: from Dashboard: Slack/Slack - Public Messages - New 
- **Total File Size**: from Dashboard: Installed Apps/Slack/Slack - Public Messages 
- **Total Public Channels**: from Dashboard: Installed Apps/Slack/Slack - Overview 
- **Trend - Active Bots by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Bots 
- **Trend - Active Members by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Trend - Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - User Audit 
- **Trend - Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Workspace Audit 
- **Trend - Audit Actions**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Channel Audit 
- **Trend - Bots by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Bots 
- **Trend - Messages by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Trend - Messages by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Bots 
- **Trend - Total Members by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Members 
- **Types**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Visitor Platform by Workspace**: from Dashboard: Slack/Slack - Access - New 
- **Visitor Platform by Workspace**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Visitor Platforms**: from Dashboard: Slack/Slack - Access - New 
- **Visitor Platforms**: from Dashboard: Installed Apps/Slack/Slack - Access 
- **Visitors Platform by Workspace**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Workspace**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Audit Overview 
- **Workspace - Added, Removed, Aliased, Renamed Emoji**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Workspace Audit 
- **Workspace - Created, Deleted, Migrated**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Workspace Audit 
- **Workspace - Data Retention and Billing**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Workspace Audit 
- **Workspace - Manual, Corporate, Scheduled Export**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Workspace Audit 
- **Workspace - SSO and 2FA Setting Changes**: from Dashboard: Installed Apps/Slack/Enterprise/Slack - Workspace Audit 
- **Workspaces**: from Dashboard: Installed Apps/Slack/Slack - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Slack|2FA by Workspace|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, User, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Bot matches "false" and !(User matches "slackbot") and Deleted matches "false"<br />\| if(AuthenticationEnabled matches "true", "2FA Enabled", "2FA Disabled") as AuthenticationEnabled<br />\| withtime AuthenticationEnabled<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and UltraRestricted matches "{{UltraRestricted}}" and Restricted matches "{{Restricted}}"<br />\|most\_recent(AuthenticationEnabled\_withtime) as AuthenticationEnabled by ID, Workspace<br />\| count as %"Number of Users" by AuthenticationEnabled, Workspace<br />\| transpose row Workspace column AuthenticationEnabled|
|Slack|Access - Total Entries by Workspace|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| timeslice 30m<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by Id, IP, UserAgent, Workspace, \_timeslice<br />\| sum(Logins) as %"Total Logins" by Workspace, \_timeslice<br />\| transpose row \_timeslice column Workspace|
|Slack|Access - Total Entries by Workspace|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| timeslice 30m<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by Id, IP, UserAgent, Workspace, \_timeslice<br />\| sum(Logins) as %"Total Logins" by Workspace, \_timeslice<br />\| transpose row \_timeslice column Workspace|
|Slack|Access - Users by Workspace|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| timeslice 30m<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\| most\_recent(Logins\_withtime) as Logins by Id, IP, UserAgent, Workspace, \_timeslice<br />\| count by Workspace, \_timeslice<br />\| transpose row \_timeslice column Workspace|
|Slack|Access - Users by Workspace|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| timeslice 30m<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by Id, IP, UserAgent, Workspace, \_timeslice<br />\| count by Workspace, \_timeslice<br />\| transpose row \_timeslice column Workspace|
|Slack|Access Information|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| lookup latitude, longitude, country\_code, country\_name as CountryName, region, city, postal\_code from geo://location on ip = IP<br />\| if (UserAgent matches "\*Windows \*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*Win64\*","Windows","") as OS <br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Darwin/\*" OR UserAgent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (UserAgent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (UserAgent matches "\*Linux\*","Linux",OS) as OS <br />\| if (UserAgent matches "\*iPad\*","iPad",OS) as OS <br />\| if (UserAgent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (UserAgent matches "\*Android\*","Android",OS) as OS <br />\| if (UserAgent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (UserAgent matches "\*BlackBerry\*","BlackBerry",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (UserAgent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (UserAgent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (UserAgent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (UserAgent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND UserAgent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (UserAgent matches "\*Mobile/\*" OR UserAgent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND UserAgent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (UserAgent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (UserAgent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (UserAgent matches "Opera\*","Opera",Browser) as Browser <br />\| if (UserAgent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser<br />\| where Name matches "{{Name}}" and Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and CountryName matches "{{CountryName}}" and UserAgent matches "{{UserAgent}}"<br />\| fields Name, Workspace, Logins, IP, CountryName, OS, Browser, UserAgent<br />\| limit 50|
|Slack|Access Information|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\| withtime Logins<br />\| most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| lookup latitude, longitude, country\_code, country\_name as CountryName, region, city, postal\_code from geo://location on ip = IP<br />\| if (UserAgent matches "\*Windows \*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*Win64\*","Windows","") as OS <br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Darwin/\*" OR UserAgent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (UserAgent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (UserAgent matches "\*Linux\*","Linux",OS) as OS <br />\| if (UserAgent matches "\*iPad\*","iPad",OS) as OS <br />\| if (UserAgent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (UserAgent matches "\*Android\*","Android",OS) as OS <br />\| if (UserAgent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (UserAgent matches "\*BlackBerry\*","BlackBerry",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (UserAgent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (UserAgent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (UserAgent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (UserAgent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND UserAgent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (UserAgent matches "\*Mobile/\*" OR UserAgent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND UserAgent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (UserAgent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (UserAgent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (UserAgent matches "Opera\*","Opera",Browser) as Browser <br />\| if (UserAgent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser<br />\| fields Name, Workspace, Logins, IP, CountryName, OS, Browser, UserAgent<br />\| limit 50|
|Slack|Access Locations|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where Workspace matches "{{Workspace}}"<br />\|most\_recent(Logins\_withtime) as Logins by Id, IP, UserAgent, Workspace<br />\| count by IP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP|
|Slack|Active Channels|Logs|Installed Apps/Slack/Slack - Public Channels|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "channelId", "teamName" as ChannelId, Workspace<br />\| timeslice 15m<br />\| withtime ChannelId<br />\| where Workspace matches "{{Workspace}}"<br />\|most\_recent(ChannelId\_withtime) as ChannelId by ChannelId, Workspace, \_timeslice<br />\| count as %"Number of Channels" by Workspace, \_timeslice<br />\| transpose row \_timeslice column Workspace<br />\| fillmissing timeslice(15m)|
|Slack|Admins|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, Name, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Admin matches "true" and Deleted matches "false"<br />\| withtime ID<br />\| where Workspace matches "{{Workspace}}" <br />\|most\_recent(ID\_withtime) by ID, Workspace<br />\| count as Count by Workspace<br />\| sum(Count) as %"Number of Admins"|
|Slack/Enterprise|App - Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.filetype", "entity.title", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, FileId, File, FileType, Title, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| timeslice 10m<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}" and Action matches "{{Action}}"<br />\|count as Count by \_timeslice, Action<br />\| transpose row \_timeslice column Action<br />\| fillmissing timeslice(10m)|
|Slack/Enterprise|App - Top 10 Actions|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.filetype", "entity.title", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, FileId, File, FileType, Title, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}"  and Action matches "{{Action}}"<br />\|count as Count by Action<br />\| sort by Count<br />\| limit 10|
|Slack/Enterprise|App - Top 5 Users|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.is\_distributed", "entity.is\_directory\_approved", "entity.scopes", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, AppId, App, Distributed, Approved, Scopes, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if (isEmpty(User), UserId, User) as User<br />\| user as %"User Name"<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}" and Action matches "{{Action}}"<br />\|count as Count by %"User Name", Action<br />\| filter %"User Name" in (sum(count) by %"User Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"User Name" column Action<br />\| limit 5|
|Slack/Enterprise|Audit Action Trend|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| timeslice 10m<br />\| where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" AND LogType matches "{{LogType}}" AND  IP matches "{{IP}}" AND user matches "{{user}}"<br />\|count as Count by \_timeslice, LogType<br />\| transpose row \_timeslice column LogType as %"AppAuditLog", %"ChannelAuditLog", %"FileAuditLog", %"UserAuditLog", %"WorkspaceAuditLog"<br />\| %"AppAuditLog" as %"App Audit Log" \|  %"ChannelAuditLog" as  %"Channel Audit Log"\| %"FileAuditLog" as %"File Audit Log"<br />\| %"UserAuditLog" as %"User Audit Log"\| %"WorkspaceAuditLog" as %"Workspace Audit Log"<br />\| fields \_timeslice, %"App Audit Log", %"Channel Audit Log", %"File Audit Log", %"User Audit Log", %"Workspace Audit Log"|
|Slack/Enterprise|Audit Events Locations|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP<br />\| where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" AND LogType matches "{{LogType}}" AND  IP matches "{{IP}}" AND user matches "{{user}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code, IP|
|Slack|Billable Members by Workspace|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, User, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Bot matches "false" and !(User matches "slackbot") and Deleted matches "false"<br />\| if(Billable matches "true", "Billable", "Non-Billable") as Billable<br />\| withtime Billable<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and UltraRestricted matches "{{UltraRestricted}}" and Restricted matches "{{Restricted}}"<br />\|most\_recent(Billable\_withtime) as Billable by ID, Workspace<br />\| count as %"Number of Members" by Billable, Workspace<br />\| transpose row Workspace column Billable|
|Slack|Bot Summary|Logs|Installed Apps/Slack/Slack - Bots|\_sourceCategory={{Logsdatasource}} <br />\| join ("logType":"ConversationLog" \| json "user", "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName" as ID, User, Type, SubType, Time, Text, ChannelId, Channel, Workspace nodrop<br />\| count\_distinct(Time) as Messages by ID, User, Channel, Workspace) as T1,<br />("logType":"ConversationLog"<br />\| json "user", "teamName", "files", "channelId" as ID, Workspace, Files, channelID nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi nodrop<br />\| json field=File "name" as FileName nodrop<br />\| count\_distinct(FileName) as TotalFiles by Workspace, ID, channelID<br />\| sum(TotalFiles) as TotalFiles by Workspace, ID) as T2 , ("logType":"ConversationLog"<br />\| json "user", "teamName", "attachments", "channelId" as ID, Workspace, Attachments, ChannelID nodrop<br />\| parse regex field=Attachments "(?\<Attachment\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi nodrop<br />\| json field=Attachment "fallback" as fallback nodrop<br />\| count\_distinct(fallback) as TotalAttachments by Workspace, ID, ChannelID<br />\| sum(TotalAttachments) as TotalAttachments by Workspace, ID) as T3 on T1.ID = T2.ID and T2.ID = T3.ID and T1.Workspace=T2.Workspace and T2.Workspace=T3.Workspace<br />\| T1\_Workspace as Workspace \| T1\_ID as ID\| T1\_User as BotName \| T1\_Channel as Channel<br />\| where Workspace matches "{{Workspace}}" and BotName matches "{{BotName}}"<br />\| T2\_TotalFiles as %"Total Files"\| T3\_TotalAttachments as %"Total Attachments"<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName" as ID, Name, Deleted, Bot, Workspace nodrop<br />\| where (Bot matches "true" or Name matches "slackbot") and Deleted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| count\_distinct(channel) as %"Number of Channels", sum(T1\_Messages) as %"Total Messages"  by Workspace, BotName,  %"Total Files", %"Total Attachments"<br />\| fields Workspace, BotName, %"Number of Channels", %"Total Messages", %"Total Files", %"Total Attachments"<br />\| sort by %"Total Messages"<br />\| limit 20|
|Slack|Bots|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, Name, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where (Bot matches "true" OR name matches "slackbot") and Deleted matches "false"<br />\| withtime ID<br />\| where Workspace matches "{{Workspace}}" <br />\|most\_recent(ID\_withtime) by ID, Workspace<br />\| count as Count by Workspace<br />\| sum(Count) as %"Number of Bots"|
|Slack|Bots by Workspace|Logs|Installed Apps/Slack/Slack - Bots|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, BotName, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where (Bot matches "true" OR BotName matches "slackbot")<br />\| if(Deleted matches "true", "Deleted", "Active") as Active<br />\| withtime Active<br />\| where Workspace matches "{{Workspace}}" and BotName matches "{{BotName}}"<br />\|most\_recent(Active\_withtime) as Active by ID, Workspace<br />\| count as %"Number of Bots" by Active, Workspace<br />\| transpose row Workspace column Active|
|Slack|Bots Information|Logs|Installed Apps/Slack/Slack - Bots|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id" as ID<br />\| first(\_raw) as FullMessage by id<br />\| json field=FullMessage "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa", "updated" as BotName, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled, Updated nodrop<br />\| where Bot matches "true" or BotName matches "slackbot"<br />\| where Workspace matches "{{Workspace}}" and BotName matches "{{BotName}}"<br />\| formatDate(fromMillis(toLong(Updated\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time <br />\| count by Time, Workspace, ID, BotName, FullName, Deleted, TimeZone, TimeZoneLabel, Bot<br />\| sort by Time<br />\| fields - \_count, ID<br />\| limit 50|
|Slack/Enterprise|Browsers by Workspace|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if (UserAgent matches "\*Windows \*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*Win64\*","Windows","") as OS <br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Darwin/\*" OR UserAgent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (UserAgent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (UserAgent matches "\*Linux\*","Linux",OS) as OS <br />\| if (UserAgent matches "\*iPad\*","iPad",OS) as OS <br />\| if (UserAgent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (UserAgent matches "\*Android\*","Android",OS) as OS <br />\| if (UserAgent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (UserAgent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (UserAgent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (UserAgent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (UserAgent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND UserAgent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (UserAgent matches "\*Mobile/\*" OR UserAgent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND UserAgent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (UserAgent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (UserAgent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (UserAgent matches "Opera\*","Opera",Browser) as Browser <br />\| if (UserAgent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser<br />\| where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" AND LogType matches "{{LogType}}" AND  IP matches "{{IP}}" AND user matches "{{user}}"<br />\|count by browser, Workspace<br />\| transpose row Workspace column browser|
|Slack|Channel Summary|Logs|Installed Apps/Slack/Slack - Public Channels|\_sourceCategory={{Logsdatasource}} <br />\| join ("logType":"channelDetail"<br />\| json "channel\_name", "channel\_id", "teamName", "members" as Channel, ChannelId, Workspace, Members<br />\| withtime Members<br />\| most\_recent(Members\_withtime) as Members by Channel, ChannelId, Workspace) as T1,("logType":"ConversationLog" \| json "user", "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName" as ID, User, Type, SubType, Time, Text, ChannelId, Channel, Workspace nodrop<br />\| count\_distinct(Time) as Messages by ID, ChannelId, Workspace) as T2 on T1.ChannelId = T2.ChannelId and T1.Workspace=T2.Workspace<br />\| T2\_Workspace as Workspace \| T2\_ID as User\| T1\_Channel as Channel<br />\| where Workspace matches "{{Workspace}}"<br />\| T1\_Members as %"Team Members"<br />\| fields Workspace, Channel, User, %"Team Members" ,T2\_Messages<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName" as User, Name, Deleted, Bot, Workspace nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by User, Workspace<br />\| compose User, Workspace]<br />\| sum(T2\_Messages) as %"Total Messages", count\_distinct(User) as %"Members Posted Messages" by Workspace, Channel, %"Team Members"<br />\| fields Workspace, Channel, %"Team Members", %"Total Messages", %"Members Posted Messages"<br />\| sort by %"Total Messages"<br />\| limit 20|
|Slack|Channels|Logs|Installed Apps/Slack/Slack - Public Channels|\_sourceCategory={{Logsdatasource}}  "logType":"channelDetail"<br />\| json "channel\_id", "teamName" as ChannelId, Workspace<br />\| timeslice 15m<br />\| withtime ChannelId<br />\| where Workspace matches "{{Workspace}}"<br />\|most\_recent(ChannelId\_withtime) as ChannelId by ChannelId, Workspace, \_timeslice<br />\| count as %"Number of Channels" by Workspace, \_timeslice<br />\| transpose row \_timeslice column Workspace|
|Slack|Countries by Workspace|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by Id, IP, UserAgent, Workspace<br />\| lookup latitude, longitude, country\_code, Country\_Name as CountryName, region, city, postal\_code from geo://location on ip = IP<br />\| count by Workspace, CountryName<br />\| transpose row Workspace column CountryName|
|Slack|Countries by Workspace|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by Id, IP, UserAgent, Workspace<br />\| lookup latitude, longitude, country\_code, Country\_Name as CountryName, region, city, postal\_code from geo://location on ip = IP<br />\| count by Workspace, CountryName<br />\| transpose row Workspace column CountryName|
|Slack|Desktop OS Version by Workspace|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| sum(Logins) as Logins by ID, Name, Workspace, UserAgent<br />\| parse regex field=UserAgent "(?\<os\>Mac OS) (?\<version\>[^;\\)]+?)(?:;\|\\))" nodrop <br />\| parse regex field=UserAgent "(?\<os\>Windows)(?: NT \| )(?\<version\>[\\d.]+)" nodrop <br />\| parse regex field=UserAgent "(?\<os\>Linux) (?\<version\>\\S+?)(?:\\)\|;)" nodrop<br />\| where !isEmpty(os)<br />\| concat(os,"-",version) as OS\_Name<br />\| count by OS\_Name, Workspace<br />\| transpose row Workspace column OS\_Name|
|Slack|Desktop OS Version by Workspace|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| sum(Logins) as Logins by ID, Name, Workspace, UserAgent<br />\| parse regex field=UserAgent "(?\<os\>Mac OS) (?\<version\>[^;\\)]+?)(?:;\|\\))" nodrop <br />\| parse regex field=UserAgent "(?\<os\>Windows)(?: NT \| )(?\<version\>[\\d.]+)" nodrop <br />\| parse regex field=UserAgent "(?\<os\>Linux) (?\<version\>\\S+?)(?:\\)\|;)" nodrop<br />\| where !isEmpty(os)<br />\| concat(os,"-",version) as OS\_Name<br />\| count by OS\_Name, Workspace<br />\| transpose row Workspace column OS\_Name|
|Slack|Desktop Users|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","Desktop",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Desktop",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count by Type<br />\| where Type matches "Desktop"<br />\| fields \_count|
|Slack|Desktop Users|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","Desktop",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Desktop",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count by Type<br />\| where Type matches "Desktop"<br />\| fields \_count|
|Slack/Enterprise|File - Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (FileAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.filetype", "entity.title", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, FileId, File, FileType, Title, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| timeslice 10m<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}" and Action matches "{{Action}}"<br />\|count as Count by \_timeslice, Action<br />\| transpose row \_timeslice column Action<br />\| fillmissing timeslice(10m)|
|Slack/Enterprise|File - Top 10 Actions|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (FileAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.filetype", "entity.title", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, FileId, File, FileType, Title, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}" and Action matches "{{Action}}"<br />\|count as Count by Action<br />\| sort by Count<br />\| limit 10|
|Slack/Enterprise|File - Top 5 Users|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (FileAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.filetype", "entity.title", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, FileId, File, FileType, Title, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if (isEmpty(User), UserId, User) as User<br />\| user as %"User Name"<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}" and Action matches "{{Action}}"<br />\|count as Count by %"User Name", Action<br />\| filter %"User Name" in (sum(count) by %"User Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"User Name" column Action|
|Slack|File Types|Logs|Slack/Slack - Public Messages - New|\_sourceCategory = Labs/Slack "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "files" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace, Files nodrop<br />\| where !isEmpty(Files)<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "name", "fileSize", "fileType" as FileName, FileSize, FileType<br />\|where if ("{{FileType}}" = "\*", true, FileType matches "{{FileType}}")<br />\|count as Count by FileType<br />\| sort by Count<br />\| limit 10|
|Slack|File Types|Logs|Installed Apps/Slack/Slack - Public Messages|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "files" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace, Files nodrop<br />\| where !isEmpty(Files)<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "name", "fileSize", "fileType" as FileName, FileSize, FileType<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}"  and Channel matches "{{Channel}}"<br />\|count as Count by FileType<br />\| sort by Count<br />\| limit 10|
|Slack|Files Shared by Workspace|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "ts", "channelId", "teamName", "files", "channelName", "userName" as MessageTime, ChannelId, Workspace, files, Channel, Name<br />\| timeslice 15m<br />\| where Workspace matches "{{Workspace}}" <br />\|count\_distinct(MessageTime) as Messages by \_timeslice, Workspace, ChannelId<br />\| sum(Messages) by \_timeslice, Workspace<br />\| transpose row \_timeslice column Workspace<br />\| fillmissing timeslice(15m)|
|Slack/Enterprise|Guest Activity|Logs|Installed Apps/Slack/Enterprise/Slack - Channel Audit|\_sourceCategory={{Logsdatasource}}  (ChannelAuditLog) ({{Email}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.privacy", "entity.name", "entity.id", "entity.is\_shared", "entity.is\_org\_shared", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, ChannelType, Channel, ChannelId, SharedChannel, OrgSharedChannel, Time, Details nodrop<br />\| where Action in ("public\_channel\_created", "private\_channel\_created", "public\_channel\_archive", "private\_channel\_archive", "public\_channel\_unarchive", "private\_channel\_unarchive", "public\_channel\_deleted", "private\_channel\_deleted", "guest\_channel\_join", "guest\_channel\_leave")<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as UserId, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and (is\_restricted matches "true" OR is\_ultra\_restricted matches "true")<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by UserId, Workspace<br />\| compose UserId, Workspace] OR UserId matches "USLACKUSER"<br />\| where Workspace matches "{{Workspace}}" AND User matches "{{User}}" AND Channel matches "{{Channel}}" AND ChannelType matches "{{ChannelType}}" AND Email matches "{{Email}}" AND Action matches "{{Action}}"<br />\| if(isEmpty(User), UserId, User) as User<br />\| count by Time, Action, Workspace, Channel, ChannelType, User, Email, SharedChannel, OrgSharedChannel, Details<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields Time, Action, Workspace, Channel, ChannelType, User, Email, SharedChannel, OrgSharedChannel, Details|
|Slack/Enterprise|Guest Activity|Logs|Installed Apps/Slack/Enterprise/Slack - User Audit|\_sourceCategory={{Logsdatasource}}  (UserAuditLog) ({{AdminEmail}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.email", "entity.name", "entity.id", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, Admin, AdminEmail, AdminID, Email, User, UserId, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(AdminID)<br />\| where Action in ("guest\_created", "guest\_reactivated", "guest\_expiration\_set", "guest\_deactivated", "guest\_expired", "guest\_expiration\_cleared")<br />\|where  Workspace matches "{{Workspace}}" AND AdminEmail matches "{{AdminEmail}}" AND Admin matches "{{Admin}}" AND  User matches "{{User}}" AND Action matches "{{Action}}"<br />\| count by Time, Action, Workspace, User, Email, Admin, AdminEmail, Details<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields Time, Action, Workspace, User, Email, Admin, AdminEmail, Details|
|Slack/Enterprise|Guests App Activity|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.is\_distributed", "entity.is\_directory\_approved", "entity.scopes", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, AppId, App, Distributed, Approved, Scopes, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as UserId, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and (is\_restricted matches "true" OR is\_ultra\_restricted matches "true")<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by UserId, Workspace<br />\| compose UserId, Workspace] OR UserId matches "USLACKUSER"<br />\| if (isEmpty(User), UserId, User) as User<br />\| where Action in ("app\_approved", "app\_installed", "app\_scopes\_expanded", "app\_resources\_added")<br />\| where Action matches "{{Action}}" and User matches "{{User}}" and Workspace matches "{{Workspace}}"<br />\| count by Time, Action, Workspace, User, Email, App, Distributed, Approved, Scopes, Details<br />\| replace (Scopes, "\\",", "\\"\\n") as Scopes<br />\| replace (Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields - \_count|
|Slack/Enterprise|Guests File Activity|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (FileAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.filetype", "entity.title", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, FileId, File, FileType, Title, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as UserId, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and (is\_restricted matches "true" OR is\_ultra\_restricted matches "true")<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by UserId, Workspace<br />\| compose UserId, Workspace] OR UserId matches "USLACKUSER"<br />\| if (isEmpty(User), UserId, User) as User<br />\| where action in ("file\_downloaded", "file\_uploaded", "file\_shared", "file\_public\_link\_created", "file\_public\_link\_revoked")<br />\| where Workspace matches "{{Workspace}}" and  User matches "{{User}}"  and Action matches "{{Action}}"<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| count by Time, Action, Workspace, User, Email, File, FileType, Title, Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields - \_count|
|Slack|In-Active Channels|Logs|Installed Apps/Slack/Slack - Public Channels|\_sourceCategory={{Logsdatasource}}  "logType":"channelDetail"<br />\| json "channel\_name", "channel\_id", "teamName", "members" as Channel, ChannelId, Workspace, Members<br />\| withtime ChannelId<br />\| most\_recent(ChannelId\_withtime) as ChannelId by Channel, ChannelId, Workspace, Members<br />\| where ![subquery: "logType":"ConversationLog"<br />\| json "channelId", "teamName" as ChannelId, Workspace  <br />\| withtime ChannelId<br />\| most\_recent(ChannelId\_withtime) as ChannelId by ChannelId, Workspace <br />\| compose ChannelId, Workspace]<br />\| where Workspace matches "{{Workspace}}"<br />\| sort by Members asc<br />\| fields Workspace, Channel, Members|
|Slack|In-Active Members|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, User, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Bot matches "false" and !(User matches "slackbot") and Deleted matches "false"<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and UltraRestricted matches "{{UltraRestricted}}" and Restricted matches "{{Restricted}}"<br />\|count by ID, User, Workspace, Email<br />\| fields ID, User, Workspace, Email|
|Slack|Member Information|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id" as ID<br />\| first(\_raw) as FullMessage by id<br />\| json field=FullMessage "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa", "updated" as User, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled, Updated nodrop<br />\| where Bot matches "false" and !(User matches "slackbot")<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and UltraRestricted matches "{{UltraRestricted}}" and Restricted matches "{{Restricted}}"<br />\| formatDate(fromMillis(toLong(Updated\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| count by Time, Workspace, ID, User, FullName, Email, Deleted, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, AuthenticationEnabled, Bot, Billable<br />\| sort by Time<br />\| fields - \_count, ID, Time<br />\| limit 50|
|Slack|Member Roles|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, Name, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false"<br />\| if(Admin matches "true", if((Owner matches "true" OR PrimaryOwner matches "true"), "Admins+Owners", "Admins"), if((Owner matches "true" OR PrimaryOwner matches "true"), "Owners", "Users")) as Role<br />\| withtime Role<br />\| where Workspace matches "{{Workspace}}" <br />\|most\_recent(Role\_withtime) as Role by ID, Workspace<br />\| count by Role|
|Slack|Members|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, Name, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false"<br />\| withtime ID<br />\| where Workspace matches "{{Workspace}}" <br />\| count as Count by Workspace<br />\| sum(Count) as %"Number of Members"<br />|
|Slack/Enterprise|Members Activity|Logs|Installed Apps/Slack/Enterprise/Slack - Channel Audit|\_sourceCategory={{Logsdatasource}}  (ChannelAuditLog) ({{Email}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.privacy", "entity.name", "entity.id", "entity.is\_shared", "entity.is\_org\_shared", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, ChannelType, Channel, ChannelId, SharedChannel, OrgSharedChannel, Time, Details nodrop<br />\| where Action in ("public\_channel\_created", "private\_channel\_created", "public\_channel\_archive", "private\_channel\_archive", "public\_channel\_unarchive", "private\_channel\_unarchive", "public\_channel\_deleted", "private\_channel\_deleted", "user\_channel\_join", "user\_channel\_leave")<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as UserId, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and is\_restricted matches "false" and is\_ultra\_restricted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by UserId, Workspace<br />\| compose UserId, Workspace] OR UserId matches "USLACKUSER"<br />\| where Action matches "{{Action}}" and Action matches "{{ChannelType}}" and User matches "{{User}}" and Channel matches "{{Channel}}" and Workspace matches "{{Workspace}}"<br />\| if(isEmpty(User), UserId, User) as User<br />\| count by Time, Action, Workspace, Channel, ChannelType, User, Email, SharedChannel, OrgSharedChannel, Details<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields Time, Action, Workspace, Channel, ChannelType, User, Email, SharedChannel, OrgSharedChannel, Details|
|Slack/Enterprise|Members Activity|Logs|Installed Apps/Slack/Enterprise/Slack - User Audit|\_sourceCategory={{Logsdatasource}}  (UserAuditLog) ({{AdminEmail}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.email", "entity.name", "entity.id", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, Admin, AdminEmail, AdminID, Email, User, UserId, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(AdminID)<br />\| where Action in ("user\_deactivated", "user\_created", "user\_reactivated", "custom\_tos\_accepted")<br />\|where  Workspace matches "{{Workspace}}" AND AdminEmail matches "{{AdminEmail}}" AND Admin matches "{{Admin}}" AND  User matches "{{User}}" AND Action matches "{{Action}}"<br />\| if(isEmpty(Admin), AdminID, Admin) as Admin<br />\| count by Time, Action, Workspace, User, Email, Admin, AdminEmail, Details<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields Time, Action, Workspace, User, Email, Admin, AdminEmail, Details|
|Slack/Enterprise|Members App Activity|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.is\_distributed", "entity.is\_directory\_approved", "entity.scopes", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, AppId, App, Distributed, Approved, Scopes, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as UserId, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and is\_restricted matches "false" and is\_ultra\_restricted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by UserId, Workspace<br />\| compose UserId, Workspace] OR UserId matches "USLACKUSER"<br />\| if (isEmpty(User), UserId, User) as User<br />\| where Action in ("app\_approved", "app\_installed", "app\_scopes\_expanded", "app\_resources\_added")<br />\| where Workspace matches "{{Workspace}}" and  User matches "{{User}}" and Action matches "{{Action}}"<br />\| count by Time, Action, Workspace, User, Email, App, Distributed, Approved, Scopes, Details<br />\| replace (Scopes, "\\",", "\\"\\n") as Scopes<br />\| replace (Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields - \_count|
|Slack|Members by Workspace|Logs|Installed Apps/Slack/Slack - Members| \_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, User, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Bot matches "false" and !(User matches "slackbot")<br />\| if(Deleted matches "false", "Active", "Deleted") as Active<br />\| withtime Active<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and UltraRestricted matches "{{UltraRestricted}}" and Restricted matches "{{Restricted}}"<br />\|most\_recent(Active\_withtime) as Active by ID, Workspace<br />\| count as %"Number of Members" by Active, Workspace<br />\| transpose row Workspace column Active|
|Slack/Enterprise|Members File Activity|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (FileAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.filetype", "entity.title", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, FileId, File, FileType, Title, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as UserId, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and is\_restricted matches "false" and is\_ultra\_restricted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by UserId, Workspace<br />\| compose UserId, Workspace] OR UserId matches "USLACKUSER"<br />\| if (isEmpty(User), UserId, User) as User<br />\| where action in ("file\_downloaded", "file\_uploaded", "file\_shared", "file\_public\_link\_created", "file\_public\_link\_revoked")<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| count by Time, Action, Workspace, User, Email, File, FileType, Title, Details<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}"  and Action matches "{{Action}}"<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields - \_count<br />\| limit 20|
|Slack|Message Types|Logs|Installed Apps/Slack/Slack - Public Messages|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace nodrop<br />\| where !isEmpty(SubType)<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}"  and Channel matches "{{Channel}}"<br />\|count as Count by SubType<br />\| sort by Count|
|Slack|Message Types|Logs|Slack/Slack - Public Messages - New|\_sourceCategory = Labs/Slack "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace nodrop<br />\| where !isEmpty(SubType)<br />\|where if ("{{Workspace}}" = "\*", true, Workspace matches "{{Workspace}}")<br />\|count as Count by SubType<br />\| sort by Count|
|Slack|Mobile Users|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","Desktop",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Desktop",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count by Type<br />\| where Type matches "Mobile"<br />\| fields \_count|
|Slack|Mobile Users|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","Desktop",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Desktop",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count by Type<br />\| where Type matches "Mobile"<br />\| fields \_count|
|Slack/Enterprise|OS and Version by Workspace|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| parse regex field=UserAgent "(?\<OS\>Mac OS) (?\<version\>[^;\\)]+?)(?:;\|\\))" nodrop <br />\| parse regex field=UserAgent "(?\<OS\>Windows)(?: NT \| )(?\<version\>[\\d.]+)" nodrop <br />\| parse regex field=UserAgent "(?\<OS\>Linux) (?\<version\>\\S+?)(?:\\)\|;)" nodrop<br />\| where !isEmpty(OS)<br />\| where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" AND LogType matches "{{LogType}}" AND  IP matches "{{IP}}" AND user matches "{{user}}"<br />\|count by OS, Version, Workspace<br />\| transpose row OS, Version column Workspace|
|Slack|Public Messages|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "teamName", "ts", "channelId", "channelName", "userName" as Workspace, Timestamp, ChannelId, Channel, Name<br />\| where Workspace matches "{{Workspace}}" <br />\|count\_distinct(Timestamp) as messages by ChannelId<br />\| sum(messages)|
|Slack|Public Messages by Workspace|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "ts", "channelId", "teamName", "channelName", "userName" as MessageTime, ChannelId, Workspace, Channel, Name nodrop<br />\| timeslice 15m<br />\| where Workspace matches "{{Workspace}}" <br />\|count\_distinct(MessageTime) as Messages by \_timeslice, Workspace, ChannelId<br />\| sum(Messages) by \_timeslice, Workspace<br />\| transpose row \_timeslice column Workspace<br />\| fillmissing timeslice(15m)|
|Slack|Recent Attachments|Logs|Installed Apps/Slack/Slack - Public Messages|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "attachments", "user" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace, Attachments, ID nodrop<br />\| where !isEmpty(Attachments)<br />\| if (isEmpty(User), ID, User) as User<br />\| parse regex field=Attachments "(?\<Attachment\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=Attachment "id", "text", "author\_name", "author\_link", "pretext", "fallback" as AttachmentId, AttachementText, AuthorName, AuthorLink, PreText, Fallback nodrop<br />\| if (isEmpty(AuthorName), "-", AuthorName) as AuthorName<br />\| where [subquery from=(-24h):"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as ID, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}"  and Channel matches "{{Channel}}"<br />\| formatDate(fromMillis(toLong(MessageTime\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| AttachementText as %"Attachement Text" <br />\| AuthorName as %"Author Name"<br />\| tourl(AuthorLink, "Author Link") as %"Author Link"<br />\| count as Count by Time, Workspace, Channel, User, Text, %"Attachement Text", Fallback, PreText, AuthorName, %"Author Link"<br />\| sort by Time<br />\| limit 20<br />\| fields - Count|
|Slack|Recent Attachments|Logs|Slack/Slack - Public Messages - New|\_sourceCategory = Labs/Slack "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "attachments" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace, Attachments nodrop<br />\| where !isEmpty(Attachments)<br />\| parse regex field=Attachments "(?\<Attachment\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=Attachment "id", "text", "author\_name", "author\_link", "pretext", "fallback" as AttachmentId, AttachementText, AuthorName, AuthorLink, PreText, Fallback nodrop<br />\| if (isEmpty(AuthorName), "-", AuthorName) as AuthorName<br />\| where Workspace matches "{{Workspace}}" and Channel matches "{{Channel}}" and AttachementText matches "{{AttachementText}}" and AuthorName matches "{{AuthorName}}" and User matches "{{User}}"<br />\| formatDate(fromMillis(toLong(MessageTime\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| AttachementText as %"Attachement Text" <br />\| AuthorName as %"Author Name"<br />\| tourl(AuthorLink, "Author Link") as %"Author Link"<br />\| count as Count by Time, Workspace, Channel, User, Text, %"Attachement Text", Fallback, PreText, AuthorName, %"Author Link"<br />\| sort by Time<br />\| limit 20<br />\| fields - Count|
|Slack|Recent File Shared|Logs|Installed Apps/Slack/Slack - Public Messages|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "files", "user" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace, Files, ID nodrop<br />\| where !isEmpty(Files)<br />\| if (isEmpty(User), ID, User) as User<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "name", "fileSize", "fileType", "urlPrivate", "permalink", "urlPrivateDownload" as FileName, FileSize, FileType, PrivateURL, PermanentLink, URLDownload nodrop<br />\| where [subquery from=(-24h):"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as ID, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}"  and Channel matches "{{Channel}}"<br />\| FileName as %"File Name"\| FileSize as %"File Size"\| FileType as %"File Type"\| tourl(PrivateURL, "Private URL") as %"Private URL"<br />\| tourl(PermanentLink, "Permanent Link") as %"Permanent Link" \| tourl(URLDownload, "Download Link") as %"Download Link"<br />\| formatDate(fromMillis(toLong(MessageTime\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| count as Count by Time, Workspace, Channel, User, Text, %"File Name", %"File Size", %"File Type", %"Private URL", %"Permanent Link", %"Download Link"<br />\| sort by Time<br />\| limit 20<br />\| fields - Count|
|Slack|Recent File Shared|Logs|Slack/Slack - Public Messages - New|\_sourceCategory = Labs/Slack "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "files" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace, Files nodrop<br />\| where !isEmpty(Files)<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "name", "fileSize", "fileType", "urlPrivate", "permalink", "urlPrivateDownload" as FileName, FileSize, FileType, PrivateURL, PermanentLink, URLDownload nodrop<br />\| where Workspace matches "{{Workspace}}" and Channel matches "{{Channel}}" and FileName matches "{{FileName}}" and FileType matches "{{FileType}}" and User matches "{{User}}"<br />\| FileName as %"File Name"\| FileSize as %"File Size"\| FileType as %"File Type"\| tourl(PrivateURL, "Private URL") as %"Private URL"<br />\| tourl(PermanentLink, "Permanent Link") as %"Permanent Link" \| tourl(URLDownload, "Download Link") as %"Download Link"<br />\| formatDate(fromMillis(toLong(MessageTime\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| count as Count by Time, Workspace, Channel, User, Text, %"File Name", %"File Size", %"File Type", %"Private URL", %"Permanent Link", %"Download Link"<br />\| sort by Time<br />\| limit 20<br />\| fields - Count|
|Slack|Recent Messages|Logs|Installed Apps/Slack/Slack - Public Messages|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "user" as User, Type, SubType, Time, Text, ChannelId, Channel, Workspace, ID nodrop<br />\| if (isEmpty(User), ID, User) as User<br />\| where [subquery from=(-24h):"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as ID, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}"  and Channel matches "{{Channel}}"<br />\| count by Time, Workspace, Channel, User, SubType, Text<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| limit 50<br />\| fields - \_count|
|Slack|Recent Messages|Logs|Slack/Slack - Public Messages - New|\_sourceCategory = Labs/Slack "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName" as User, Type, SubType, Time, Text, ChannelId, Channel, Workspace nodrop<br />\| where Workspace matches "{{Workspace}}" and Channel matches "{{Channel}}" and Text matches "{{Text}}" and User matches "{{User}}"<br />\| count by Time, Workspace, Channel, User, SubType, Text<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| limit 50<br />\| fields - \_count|
|Slack/Enterprise|Role Changed|Logs|Installed Apps/Slack/Enterprise/Slack - User Audit|\_sourceCategory={{Logsdatasource}}  (UserAuditLog) ({{AdminEmail}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.email", "entity.name", "entity.id", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, Admin, AdminEmail, AdminID, Email, User, UserId, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(AdminID)<br />\| where Action in ("role\_change\_to\_owner", "role\_change\_to\_admin", "role\_change\_to\_user", "role\_change\_to\_guest", "owner\_transferred")<br />\|where  Workspace matches "{{Workspace}}" AND AdminEmail matches "{{AdminEmail}}" AND Admin matches "{{Admin}}" AND  User matches "{{User}}" AND Action matches "{{Action}}"<br />\| if(isEmpty(Admin), AdminID, Admin) as Admin<br />\| count by Time, Action, Workspace, User, Email, Admin, AdminEmail, Details<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| sort by Time<br />\| fields Time, Action, Workspace, User, Email, Admin, AdminEmail, Details|
|Slack|Roles by Workspace|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, User, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Bot matches "false" and !(User matches "slackbot") and Deleted matches "false"<br />\| if(Admin matches "true", if((Owner matches "true" OR PrimaryOwner matches "true"), "Admins+Owners", "Admins"), if((Owner matches "true" OR PrimaryOwner matches "true"), "Owners", if(Restricted matches "true", "Multi-Channel Guest", if(UltraRestricted matches "true", "Single-Channel guest", "Users")))) as Role<br />\| withtime Role<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and UltraRestricted matches "{{UltraRestricted}}" and Restricted matches "{{Restricted}}"<br />\|most\_recent(Role\_withtime) as Role by ID, Workspace<br />\| count by Role, Workspace<br />\| transpose row Workspace column Role|
|Slack|Threat by Malicious Confidence|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| count by IP<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum (\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|Slack|Threat by Malicious Confidence|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| count by IP<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum (\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|Slack|Threat Count|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|Slack|Threat Count|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|Slack|Threat Location|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP|
|Slack|Threat Location|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP|
|Slack|Threats by Actor|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|Slack|Threats by Actor|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| count by IP<br />\| where !isPrivateIP(IP)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=IP <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|Slack|TimeZone by Workspace|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, User, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Bot matches "false" and !(User matches "slackbot") and Deleted matches "false"<br />\| where !isEmpty(TimeZone)<br />\| withtime TimeZone<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and UltraRestricted matches "{{UltraRestricted}}" and Restricted matches "{{Restricted}}"<br />\|most\_recent(TimeZone\_withtime) as TimeZone by ID, Workspace<br />\| count by TimeZone, Workspace<br />\| transpose row Workspace column TimeZone|
|Slack/Enterprise|Top 10 Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| Action as %"Audit Action"<br />\|where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" and LogType matches "{{LogType}}" and  IP matches "{{IP}}" and user matches "{{user}}"<br />\|count as Count by %"Audit Action"<br />\| sort by Count<br />\| limit 10|
|Slack/Enterprise|Top 10 Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - Workspace Audit|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, WorkspaceID, WorkspaceName, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| Action as %"Audit Action"<br />\|where  User matches "{{User}}" AND  WorkspaceName matches "{{WorkspaceName}}" AND Email matches "{{Email}}" AND  Action matches "{{Action}}"<br />\|count as Count by %"Audit Action"<br />\| sort by Count<br />\| limit 10|
|Slack/Enterprise|Top 10 Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - Channel Audit|\_sourceCategory={{Logsdatasource}}  (ChannelAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.privacy", "entity.name", "entity.id", "entity.is\_shared", "entity.is\_org\_shared", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, ChannelType, Channel, ChannelId, SharedChannel, OrgSharedChannel, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| Action as %"Audit Action"<br />\| where Workspace matches "{{Workspace}}" AND User matches "{{User}}" AND Channel matches "{{Channel}}" AND ChannelType matches "{{ChannelType}}" AND Email matches "{{Email}}" AND Action matches "{{Action}}"<br />\|count as Count by %"Audit Action"<br />\| sort by Count<br />\| limit 10|
|Slack/Enterprise|Top 10 Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - User Audit|\_sourceCategory={{Logsdatasource}}  (UserAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.email", "entity.name", "entity.id", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, Admin, AdminEmail, AdminID, Email, User, UserId, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| Action as %"Audit Action"<br />\|where  Workspace matches "{{Workspace}}" AND AdminEmail matches "{{AdminEmail}}" AND Admin matches "{{Admin}}" AND  User matches "{{User}}" AND Action matches "{{Action}}"\|count as Count by %"Audit Action"<br />\| sort by Count<br />\| limit 10|
|Slack|Top 10 Channels by Attachments|Logs|Installed Apps/Slack/Slack - Public Channels|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "channelId", "teamName", "attachments", "channelName" as ChannelId, Workspace, Attachments, Channel nodrop<br />\| parse regex field=Attachments "(?\<Attachment\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi nodrop<br />\| json field=Attachment "fallback" as AttachmentName nodrop<br />\| where Workspace matches "{{Workspace}}"<br />\| count\_distinct(AttachmentName) as TotalAttachments by Workspace, ChannelId, Channel<br />\| where TotalAttachments \> 0<br />\| fields Workspace, Channel, TotalAttachments<br />\| sort by TotalAttachments<br />\| limit 10|
|Slack|Top 10 Channels by Files|Logs|Installed Apps/Slack/Slack - Public Channels|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "channelId", "teamName", "files", "channelName" as ChannelId, Workspace, Files, Channel nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi nodrop<br />\| json field=File "name" as FileName nodrop<br />\| where Workspace matches "{{Workspace}}"<br />\| count\_distinct(FileName) as TotalFiles by Workspace, ChannelId, Channel<br />\| where TotalFiles \> 0<br />\| fields Workspace, Channel, TotalFiles<br />\| sort by TotalFiles<br />\| limit 10|
|Slack/Enterprise|Top 10 File Types|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (FileAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.filetype", "entity.title", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, FileId, File, FileType, Title, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId) and !isEmpty(fileType)<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}" and Action matches "{{Action}}"<br />\|count as Count by fileType<br />\| sort by Count<br />\| limit 10|
|Slack/Enterprise|Top 10 Scopes|Logs|Installed Apps/Slack/Enterprise/Slack - File and App Audit|\_sourceCategory={{Logsdatasource}}  (AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "entity.is\_distributed", "entity.is\_directory\_approved", "entity.scopes", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, AppId, App, Distributed, Approved, Scopes, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId) and !isEmpty(Scopes)<br />\| replace(Scopes, "[", "") as Scopes<br />\| replace(Scopes, "\\"", "") as Scopes<br />\| parse regex field=Scopes "(?\<Scope\>.\*?)[,\\]]" multi<br />\|where Workspace matches "{{Workspace}}" and  User matches "{{User}}" and Action matches "{{Action}}"<br />\|count as Count by Scope<br />\| sort by Count<br />\| limit 10|
|Slack/Enterprise|Top 5 Admins|Logs|Installed Apps/Slack/Enterprise/Slack - User Audit|\_sourceCategory={{Logsdatasource}}  (UserAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.email", "entity.name", "entity.id", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, Admin, AdminEmail, AdminID, Email, User, UserId, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(AdminID)<br />\| if(isEmpty(Admin), AdminID, Admin) as Admin<br />\| Admin as %"Admin Name"<br />\|where  Workspace matches "{{Workspace}}" AND AdminEmail matches "{{AdminEmail}}" AND Admin matches "{{Admin}}" AND  User matches "{{User}}" AND Action matches "{{Action}}"\|count as Count by %"Admin Name", Action<br />\| filter %"Admin Name" in (sum(count) by %"Admin Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"Admin Name" column Action|
|Slack|Top 5 Channels by Files|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "user", "userName", "ts", "channelId", "teamName", "channelName", "files" as ID, Name, Timestamp, ChannelId, Workspace, Channel, files<br />\| where Workspace matches "{{Workspace}}" <br />\|count\_distinct(Timestamp) as Messages by ChannelId, Workspace, Channel<br />\| sum(Messages) as Messages by ChannelId, Channel<br />\| sort by Messages<br />\| limit 5<br />\| fields - ChannelId|
|Slack|Top 5 Channels by Messages|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "user", "userName", "ts", "channelId", "teamName", "channelName" as ID, Name, Timestamp, ChannelId, Workspace, Channel nodrop<br />\| where Workspace matches "{{Workspace}}" <br />\|count\_distinct(Timestamp) as Messages by ChannelId, Workspace, Channel<br />\| sum(Messages) as Messages by ChannelId, Channel<br />\| sort by Messages<br />\| limit 5<br />\| fields - ChannelId|
|Slack/Enterprise|Top 5 Guest Members|Logs|Installed Apps/Slack/Enterprise/Slack - Channel Audit|\_sourceCategory={{Logsdatasource}}  (ChannelAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.privacy", "entity.name", "entity.id", "entity.is\_shared", "entity.is\_org\_shared", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, ChannelType, Channel, ChannelId, SharedChannel, OrgSharedChannel, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as UserId, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and (is\_restricted matches "true" OR is\_ultra\_restricted matches "true")<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by UserId, Workspace<br />\| compose UserId, Workspace] OR UserId matches "USLACKUSER"<br />\| if(isEmpty(User), UserId, User) as User<br />\| User as %"User Name"<br />\| where Workspace matches "{{Workspace}}" AND User matches "{{User}}" AND Channel matches "{{Channel}}" AND ChannelType matches "{{ChannelType}}" AND Email matches "{{Email}}" AND Action matches "{{Action}}"<br />\|count as Count by %"User Name", Action<br />\| filter %"User Name" in (sum(count) by %"User Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"User Name" column Action|
|Slack/Enterprise|Top 5 Members|Logs|Installed Apps/Slack/Enterprise/Slack - Channel Audit|\_sourceCategory={{Logsdatasource}}  (ChannelAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.privacy", "entity.name", "entity.id", "entity.is\_shared", "entity.is\_org\_shared", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, ChannelType, Channel, ChannelId, SharedChannel, OrgSharedChannel, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as UserId, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and is\_restricted matches "false" and is\_ultra\_restricted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by UserId, Workspace<br />\| compose UserId, Workspace] OR UserId matches "USLACKUSER"<br />\| if(isEmpty(User), UserId, User) as User<br />\| User as %"User Name"<br />\| where Workspace matches "{{Workspace}}" AND User matches "{{User}}" AND Channel matches "{{Channel}}" AND ChannelType matches "{{ChannelType}}" AND Email matches "{{Email}}" AND Action matches "{{Action}}"<br />\|count as Count by %"User Name", Action<br />\| filter %"User Name" in (sum(count) by %"User Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"User Name" column Action|
|Slack|Top 5 Members by Messages|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "user", "userName", "ts", "channelId", "teamName", "channelName" as ID, Name, Timestamp, ChannelId, Workspace, Channel nodrop<br />\| where Workspace matches "{{Workspace}}" <br />\|count\_distinct(Timestamp) as Messages by ID, Name, ChannelId, Workspace<br />\| where [subquery: "logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName" as ID, Name, Deleted, Bot, workspace nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| sum(Messages) as Messages by Name<br />\| sort by Messages<br />\| limit 5|
|Slack/Enterprise|Top 5 Users|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if(isEmpty(User), UserId, User) as User<br />\| User as %"User Name"<br />\| where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" AND LogType matches "{{LogType}}" AND  IP matches "{{IP}}" AND user matches "{{user}}"<br />\|count as Count by %"User Name", LogType<br />\| filter %"User Name" in (sum(count) by %"User Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"User Name" column LogType as %"AppAuditLog", %"ChannelAuditLog", %"FileAuditLog", %"UserAuditLog", %"WorkspaceAuditLog"<br />\| %"AppAuditLog" as %"App Audit Log" \|  %"ChannelAuditLog" as  %"Channel Audit Log"\| %"FileAuditLog" as %"File Audit Log"<br />\| %"UserAuditLog" as %"User Audit Log"\| %"WorkspaceAuditLog" as %"Workspace Audit Log"<br />\| fields %"User Name", %"App Audit Log", %"Channel Audit Log", %"File Audit Log", %"User Audit Log", %"Workspace Audit Log"<br />\| limit 5|
|Slack/Enterprise|Top 5 Users|Logs|Installed Apps/Slack/Enterprise/Slack - Workspace Audit|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, WorkspaceID, WorkspaceName, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if(isEmpty(User), UserId, User) as User<br />\| User as %"User Name"<br />\|where  User matches "{{User}}" AND  WorkspaceName matches "{{WorkspaceName}}" AND Email matches "{{Email}}" AND  Action matches "{{Action}}"<br />\|count as Count by %"User Name", Action<br />\| filter %"User Name" in (sum(count) by %"User Name" \| sort by \_sum \| limit 5)<br />\| transpose row %"User Name" column Action|
|Slack|Top Browser by Workspace|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*Windows \*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*Win64\*","Windows","") as OS <br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Darwin/\*" OR UserAgent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (UserAgent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (UserAgent matches "\*Linux\*","Linux",OS) as OS <br />\| if (UserAgent matches "\*iPad\*","iPad",OS) as OS <br />\| if (UserAgent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (UserAgent matches "\*Android\*","Android",OS) as OS <br />\| if (UserAgent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (UserAgent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (UserAgent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (UserAgent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (UserAgent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND UserAgent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (UserAgent matches "\*Mobile/\*" OR UserAgent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND UserAgent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (UserAgent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (UserAgent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (UserAgent matches "Opera\*","Opera",Browser) as Browser <br />\| if (UserAgent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser  <br />\| count by browser, Workspace<br />\| transpose row Workspace column browser as \*|
|Slack|Top Browser by Workspace|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*Windows \*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*Win64\*","Windows","") as OS <br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Darwin/\*" OR UserAgent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (UserAgent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (UserAgent matches "\*Linux\*","Linux",OS) as OS <br />\| if (UserAgent matches "\*iPad\*","iPad",OS) as OS <br />\| if (UserAgent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (UserAgent matches "\*Android\*","Android",OS) as OS <br />\| if (UserAgent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (UserAgent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (UserAgent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (UserAgent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (UserAgent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND UserAgent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (UserAgent matches "\*Mobile/\*" OR UserAgent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND UserAgent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (UserAgent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (UserAgent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (UserAgent matches "Opera\*","Opera",Browser) as Browser <br />\| if (UserAgent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser  <br />\| count by browser, Workspace<br />\| transpose row Workspace column browser as \*|
|Slack|Top Members Activity|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}} <br />\| join ("logType":"ConversationLog" \| json "user", "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName" as ID, User, Type, SubType, Time, Text, ChannelId, Channel, Workspace nodrop<br />\| count\_distinct(Time) as Messages by ID, User, Channel, Workspace) as T1,<br />("logType":"ConversationLog"<br />\| json "user", "teamName", "files", "channelId" as ID, Workspace, Files, channelID nodrop<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi nodrop<br />\| json field=File "name" as FileName nodrop<br />\| count\_distinct(FileName) as TotalFiles by Workspace, ID, channelID<br />\| sum(TotalFiles) as TotalFiles by Workspace, ID) as T2 , ("logType":"ConversationLog"<br />\| json "user", "teamName", "attachments", "channelId" as ID, Workspace, Attachments, ChannelID nodrop<br />\| parse regex field=Attachments "(?\<Attachment\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi nodrop<br />\| json field=Attachment "fallback" as fallback nodrop<br />\| count\_distinct(fallback) as TotalAttachments by Workspace, ID, ChannelID<br />\| sum(TotalAttachments) as TotalAttachments by Workspace, ID) as T3 on T1.ID = T2.ID and T2.ID = T3.ID and T1.Workspace=T2.Workspace and T2.Workspace=T3.Workspace<br />\| T1\_Workspace as Workspace \| T1\_ID as ID \| T1\_User as User \| T1\_Channel as Channel<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}"<br />\| T2\_TotalFiles as %"Total Files"\| T3\_TotalAttachments as %"Total Attachments"<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as ID, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and (is\_restricted matches "{{Restricted}}" OR is\_ultra\_restricted matches "{{UltraRestricted}}")<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| count\_distinct(channel) as %"Number of Channels", sum(T1\_Messages) as %"Total Messages"  by Workspace, User,  %"Total Files", %"Total Attachments"<br />\| fields Workspace, User, %"Number of Channels", %"Total Messages", %"Total Files", %"Total Attachments"<br />\| sort by %"Total Messages"<br />\| limit 20|
|Slack|Top Users|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| sum(Logins) as Logins by ID, Name, Workspace<br />\| sort by Logins<br />\| limit 5<br />\| fields Name, Workspace, Logins|
|Slack|Top Users|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| sum(Logins) as Logins by ID, Name, Workspace<br />\| sort by Logins<br />\| limit 5<br />\| fields Name, Workspace, Logins|
|Slack|Total File Size|Logs|Slack/Slack - Public Messages - New|\_sourceCategory = Labs/Slack "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "files" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace, Files nodrop<br />\| where !isEmpty(Files)<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "name", "fileSize", "fileType" as FileName, FileSize, FileType<br />\|where if ("{{FileType}}" = "\*", true, FileType matches "{{FileType}}")<br />\|sum(FileSize) as TotalInBytes<br />\| TotalInBytes/1024/1024 as TotalInMB<br />\| fields TotalInMB|
|Slack|Total File Size|Logs|Installed Apps/Slack/Slack - Public Messages|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "userName", "type", "subtype", "ts", "text", "channelId", "channelName", "teamName", "files" as User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace, Files nodrop<br />\| where !isEmpty(Files)<br />\| parse regex field=Files "(?\<File\>\\{[^\\}]+(?:\\}\\}\|\\}))" multi<br />\| json field=File "name", "fileSize", "fileType" as FileName, FileSize, FileType<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and Channel matches "{{Channel}}"<br />\|sum(FileSize) as TotalInBytes<br />\| TotalInBytes/1024/1024 as TotalInMB<br />\| fields TotalInMB|
|Slack|Total Public Channels|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"channelDetail"<br />\| json "channel\_id", "teamName", "channel\_name" as ChannelId, Workspace, Channel<br />\| withtime ChannelId<br />\| where Workspace matches "{{Workspace}}" <br />\|most\_recent(ChannelId\_withtime) as ChannelId by ChannelId, Workspace<br />\| count\_distinct(ChannelId) as %"Number of Channels" by Workspace<br />\| sum(%"Number of Channels")|
|Slack|Trend - Active Bots by Workspace|Logs|Installed Apps/Slack/Slack - Bots|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "user", "userName", "type", "subType", "ts", "text", "channelId", "channelName", "teamName" as ID, BotName, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace nodrop<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName" as ID, Name, Deleted, Bot, Workspace nodrop<br />\| where (Bot matches "true" OR Name matches "slackbot") and Deleted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| timeslice 15m<br />\| where Workspace matches "{{Workspace}}" and BotName matches "{{BotName}}"<br />\|count\_distinct(ID) by Workspace, \_timeslice<br />\| transpose row \_timeslice column Workspace<br />\| fillmissing timeslice(15m)<br />|
|Slack|Trend - Active Members by Workspace|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "user", "userName","type", "subType", "ts", "text", "channelId", "channelName", "teamName" as ID, User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace nodrop<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as ID, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and (is\_restricted matches "{{Restricted}}" OR is\_ultra\_restricted matches "{{UltraRestricted}}")<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| timeslice 15m<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}"<br />//\|where if ("{{Workspace}}" = "\*", true, Workspace matches "{{Workspace}}") AND if ("{{User}}" = "\*", true, User matches "{{User}}") AND if ("{{Channel}}" = "\*", true, Channel matches "{{Channel}}")<br />\|count\_distinct(ID) by Workspace, \_timeslice<br />\| transpose row \_timeslice column Workspace<br />\| fillmissing timeslice(15m)|
|Slack/Enterprise|Trend - Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - User Audit|\_sourceCategory={{Logsdatasource}}  (UserAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.email", "entity.name", "entity.id", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, Admin, AdminEmail, AdminID, Email, User, UserId, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| timeslice 10m<br />\|where  Workspace matches "{{Workspace}}" AND AdminEmail matches "{{AdminEmail}}" AND Admin matches "{{Admin}}" AND  User matches "{{User}}" AND Action matches "{{Action}}"<br />\|count as Count by \_timeslice, Action<br />\| transpose row \_timeslice column Action<br />\| fillmissing timeslice(10m)|
|Slack/Enterprise|Trend - Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - Workspace Audit|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, WorkspaceID, WorkspaceName, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| timeslice 10m<br />\|where  User matches "{{User}}" AND  WorkspaceName matches "{{WorkspaceName}}" AND Email matches "{{Email}}" AND  Action matches "{{Action}}"<br />\|count as Count by \_timeslice, Action<br />\| transpose row \_timeslice column Action<br />\| fillmissing timeslice(10m)|
|Slack/Enterprise|Trend - Audit Actions|Logs|Installed Apps/Slack/Enterprise/Slack - Channel Audit|\_sourceCategory={{Logsdatasource}}  (ChannelAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.privacy", "entity.name", "entity.id", "entity.is\_shared", "entity.is\_org\_shared", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, ChannelType, Channel, ChannelId, SharedChannel, OrgSharedChannel, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| timeslice 10m<br />\| where Workspace matches "{{Workspace}}" AND User matches "{{User}}" AND Channel matches "{{Channel}}" AND ChannelType matches "{{ChannelType}}" AND Email matches "{{Email}}" AND Action matches "{{Action}}"<br />\| count as Count by \_timeslice, Action<br />\| transpose row \_timeslice column Action<br />\| fillmissing timeslice(10m)|
|Slack|Trend - Bots by Workspace|Logs|Installed Apps/Slack/Slack - Bots|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, BotName, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Workspace matches "{{Workspace}}" and BotName matches "{{BotName}}"<br />\| where Deleted matches "false" and (Bot matches "true" OR BotName matches "slackbot")<br />\| timeslice 24h<br />\| withtime ID<br />\|most\_recent(ID\_withtime) as Bots by \_timeslice, Workspace, ID<br />\| count by \_timeslice, Workspace<br />\| transpose row \_timeslice column Workspace|
|Slack|Trend - Messages by Workspace|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "user", "userName", "type", "subType", "ts", "text", "channelId", "channelName", "teamName" as ID, User, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace nodrop<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName", "is\_restricted", "is\_ultra\_restricted" as ID, Name, Deleted, Bot, Workspace, is\_restricted, is\_ultra\_restricted nodrop<br />\| where Bot matches "false" and !(Name matches "slackbot") and Deleted matches "false" and (is\_restricted matches "{{Restricted}}" OR is\_ultra\_restricted matches "{{UltraRestricted}}")<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| timeslice 15m<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}"<br />\|count\_distinct(MessageTime) as Messages by \_timeslice, Workspace, ChannelId<br />\| sum(Messages) by \_timeslice, Workspace<br />\| transpose row \_timeslice column Workspace<br />\| fillmissing timeslice(15m)|
|Slack|Trend - Messages by Workspace|Logs|Installed Apps/Slack/Slack - Bots|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "user", "userName", "type", "subType", "ts", "text", "channelId", "channelName", "teamName" as ID, BotName, Type, SubType, MessageTime, Text, ChannelId, Channel, Workspace nodrop<br />\| where [subquery:"logType":"UserLog"<br />\| json "id", "name", "deleted", "is\_bot", "teamName" as ID, Name, Deleted, Bot, Workspace nodrop<br />\| where (Bot matches "true" OR Name matches "slackbot") and Deleted matches "false"<br />\| withtime Name<br />\| most\_recent(Name\_withtime) as Name by ID, Workspace<br />\| compose ID, Workspace]<br />\| timeslice 15m<br />\| where Workspace matches "{{Workspace}}" and BotName matches "{{BotName}}"<br />\|count\_distinct(MessageTime) as Messages by \_timeslice, Workspace, ChannelId<br />\| sum(Messages) by \_timeslice, Workspace<br />\| transpose row \_timeslice column Workspace<br />\| fillmissing timeslice(15m)|
|Slack|Trend - Total Members by Workspace|Logs|Installed Apps/Slack/Slack - Members|\_sourceCategory={{Logsdatasource}}  "logType":"UserLog"<br />\| json "id", "name", "deleted", "real\_name", "tz", "tz\_label", "is\_admin", "is\_owner", "is\_primary\_owner", "is\_restricted", "is\_ultra\_restricted", "is\_bot", "is\_app\_user", "teamName", "billable", "email", "has\_2fa" as ID, User, Deleted, FullName, TimeZone, TimeZoneLabel, Admin, Owner, PrimaryOwner, Restricted, UltraRestricted, Bot, AppUser, Workspace, Billable, Email, AuthenticationEnabled nodrop<br />\| where Workspace matches "{{Workspace}}" and User matches "{{User}}" and UltraRestricted matches "{{UltraRestricted}}" and Restricted matches "{{Restricted}}"<br />\| where Bot matches "false" and !(User matches "slackbot") and Deleted matches "false"<br />\| timeslice 24h<br />\| withtime ID<br />\|most\_recent(ID\_withtime) as Bots by \_timeslice, Workspace, ID<br />\| count by \_timeslice, Workspace<br />\| transpose row \_timeslice column Workspace|
|Slack/Enterprise|Types|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" AND LogType matches "{{LogType}}" AND  IP matches "{{IP}}" AND user matches "{{user}}"<br />\|count as Count by Type|
|Slack|Visitor Platform by Workspace|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","PC",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count by Type, Workspace<br />\| transpose row Workspace column type|
|Slack|Visitor Platform by Workspace|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","PC",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count by Type, Workspace<br />\| transpose row Workspace column type|
|Slack|Visitor Platforms|Logs|Slack/Slack - Access - New|\_sourceCategory = Labs/Slack "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\|where if ("{{UserAgent}}" = "\*", true, UserAgent matches "{{UserAgent}}")<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","PC",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count by Type|
|Slack|Visitor Platforms|Logs|Installed Apps/Slack/Slack - Access|\_sourceCategory={{Logsdatasource}}  "logType":"AccessLog"<br />\| json "user\_id", "username", "teamName", "count", "ip", "user\_agent", "country" as ID, Name, Workspace, Logins, IP, UserAgent, Country nodrop<br />\| withtime Logins<br />\| where Workspace matches "{{Workspace}}" and IP matches "{{IP}}" and UserAgent matches "{{UserAgent}}" and Name matches "{{Name}}" and Country matches "{{Country}}"<br />\|most\_recent(Logins\_withtime) as Logins by ID, Name, IP, UserAgent, Workspace<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","PC",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count by Type|
|Slack/Enterprise|Visitors Platform by Workspace|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if (UserAgent matches "\*iPad\*" OR UserAgent matches "\*iPhone\*" OR UserAgent matches "\*Android\*" OR UserAgent matches "\*BlackBerry\*" OR UserAgent matches "\*Galaxy\*" OR UserAgent matches "LGE-\*" OR UserAgent matches "SCH-\*" OR UserAgent matches "\*HUAWEI-\*" OR UserAgent matches "\*SAMSUNG\*" OR UserAgent matches "\*samsung\*" OR UserAgent matches "Dalvik/\*" OR UserAgent matches "Nokia\*" OR UserAgent matches "LG-\*" OR UserAgent matches "\*CFNetwork\*"  OR UserAgent matches "\*UP.Browser/\*" OR UserAgent matches "\*QQ\*rowser\*" OR UserAgent matches "\*NetFront/\*" OR UserAgent matches "\*Windows Phone\*" OR UserAgent matches "\*Mobile Safari\*" OR UserAgent matches "\*iemobile\*","Mobile","") as type<br />\| if (UserAgent matches "\*Windows\*" OR UserAgent matches "\*Win64\*" OR UserAgent matches "\*Win32\*" OR UserAgent matches "\*i686\*" OR UserAgent matches "\*x86\*","PC",type) as type<br />\| if (UserAgent matches "\*Macintosh\*" OR UserAgent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" AND LogType matches "{{LogType}}" AND  IP matches "{{IP}}" AND user matches "{{user}}"<br />\|count by type, Workspace<br />\| transpose row Workspace column Type|
|Slack/Enterprise|Workspace|Logs|Installed Apps/Slack/Enterprise/Slack - Audit Overview|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog OR UserAuditLog OR ChannelAuditLog OR FileAuditLog OR AppAuditLog)<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| where Type matches "workspace"<br />\| where  Workspace matches "{{Workspace}}" and  action matches "{{action}}" AND LogType matches "{{LogType}}" AND  IP matches "{{IP}}" AND user matches "{{user}}"<br />\|count as Count by Workspace|
|Slack/Enterprise|Workspace - Added, Removed, Aliased, Renamed Emoji|Logs|Installed Apps/Slack/Enterprise/Slack - Workspace Audit|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog) ({{Email}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, WorkspaceID, WorkspaceName, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if(isEmpty(User), UserId, User) as User<br />\| where Action in ("emoji\_added", "emoji\_removed", "emoji\_aliased", "emoji\_renamed")<br />\| where Action matches "{{Action}}" and User matches "{{User}}" and WorkspaceName matches "{{WorkspaceName}}"<br />\| WorkspaceName as %"Workspace Name"<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| count by Time, Action, %"Workspace Name", User, Email, Details<br />\| sort by Time<br />\| fields - \_count|
|Slack/Enterprise|Workspace - Created, Deleted, Migrated|Logs|Installed Apps/Slack/Enterprise/Slack - Workspace Audit|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog) ({{Email}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, WorkspaceID, WorkspaceName, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if(isEmpty(User), UserId, User) as User<br />\| where Action in ("workspace\_created", "workspace\_deleted", "workspace\_accepted\_migration", "workspace\_declined\_migration", "migration\_scheduled", "organization\_created", "organization\_deleted", "organization\_accepted\_migration", "organization\_declined\_migration")<br />\| where Action matches "{{Action}}" and User matches "{{User}}" and WorkspaceName matches "{{WorkspaceName}}"<br />\| WorkspaceName as %"Workspace Name"<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| count by Time, Action, %"Workspace Name", User, Email, Details<br />\| sort by Time<br />\| fields - \_count|
|Slack/Enterprise|Workspace - Data Retention and Billing|Logs|Installed Apps/Slack/Enterprise/Slack - Workspace Audit|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog) ({{Email}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, WorkspaceID, WorkspaceName, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if(isEmpty(User), UserId, User) as User<br />\| where Action in ("pref.public\_channel\_retention\_changed", "pref.private\_channel\_retention\_changed", "pref.dm\_retention\_changed", "pref.file\_retention\_changed", "pref.retention\_override\_changed", "billing\_address\_added")<br />\| where Action matches "{{Action}}" and User matches "{{User}}" and WorkspaceName matches "{{WorkspaceName}}"<br />\| WorkspaceName as %"Workspace Name"<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| count by Time, Action, %"Workspace Name", User, Email, Details<br />\| sort by Time<br />\| fields - \_count|
|Slack/Enterprise|Workspace - Manual, Corporate, Scheduled Export|Logs|Installed Apps/Slack/Enterprise/Slack - Workspace Audit|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog) ({{Email}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, WorkspaceID, WorkspaceName, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if(isEmpty(User), UserId, User) as User<br />\| where Action in ("manual\_export\_started", "manual\_export\_completed", "corporate\_exports\_approved", "corporate\_exports\_enabled", "scheduled\_export\_started", "scheduled\_export\_completed")<br />\| where Action matches "{{Action}}" and User matches "{{User}}" and WorkspaceName matches "{{WorkspaceName}}"<br />\| WorkspaceName as %"Workspace Name"<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| count by Time, Action, %"Workspace Name", User, Email, Details<br />\| sort by Time<br />\| fields - \_count|
|Slack/Enterprise|Workspace - SSO and 2FA Setting Changes|Logs|Installed Apps/Slack/Enterprise/Slack - Workspace Audit|\_sourceCategory={{Logsdatasource}}  (WorkspaceAuditLog) ({{Email}})<br />\| json "logType", "action", "context.ip\_address", "context.ua", "context.location.name", "context.location.type", "actor.user.name", "actor.user.email", "actor.user.id", "entity.id", "entity.name", "date\_create", "details" as LogType, Action, IP, UserAgent, Workspace, Type, User, Email, UserId, WorkspaceID, WorkspaceName, Time, Details nodrop<br />\| where !isEmpty(Workspace) and !isEmpty(UserId)<br />\| if(isEmpty(User), UserId, User) as User<br />\| where Action in ("pref.sso\_setting\_changed", "pref.two\_factor\_auth\_changed")<br />\|where  User matches "{{User}}" AND  WorkspaceName matches "{{WorkspaceName}}" AND Email matches "{{Email}}" AND  Action matches "{{Action}}"<br />\| WorkspaceName as %"Workspace Name"<br />\| replace(Details, "\\",", "\\"\\n") as Details<br />\| formatDate(fromMillis(toLong(Time\*1000)),"yyyy-MM-dd HH:mm:ss.SSS ZZZZ") as Time<br />\| count by Time, Action, %"Workspace Name", User, Email, Details<br />\| sort by Time<br />\| fields - \_count|
|Slack|Workspaces|Logs|Installed Apps/Slack/Slack - Overview|\_sourceCategory={{Logsdatasource}}  "logType":"ConversationLog"<br />\| json "ts", "channelId", "teamName", "files", "channelName", "userName" as MessageTime, ChannelId, Workspace, files, Channel, Name<br />\| where Workspace matches "{{Workspace}}" <br />\|count\_distinct(Workspace) as %"Number of workspaces"|

