# Threat Intel Quick Analysis
## Sumo Logic App For: Threat Intel Quick Analysis
The Sumo Logic Threat Intel Quick Analysis App helps you identify security threats by correlating daily updated threat definitions from CrowdStrike against your log data using the threat lookup service. This App provides pre built dashboards and queries to analyze threats in your environment for malicious IP, Hash 256, Domain, URL and Email.
Docs Link: [Threat Intel Quick Analysis](https://help.sumologic.com/?cid=6100)

## Searches

### Log Searches

- **Domain Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New 
- **Email Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New 
- **Hash 256 Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New 
- **High Malicious Domain Threats**: from Search: Threat Intel Quick Analysis/High Malicious Domain Threats 
- **High Malicious Email Threats**: from Search: Threat Intel Quick Analysis/High Malicious Email Threats 
- **High Malicious Hash 256 Threats**: from Search: Threat Intel Quick Analysis/High Malicious Hash 256 Threats 
- **High Malicious IP Threats**: from Search: Threat Intel Quick Analysis/High Malicious IP Threats 
- **High Malicious IP Threats with SSHScanner Labels filtered out**: from Search: Threat Intel Quick Analysis/High Malicious IP Threats with SSHScanner Labels filtered out 
- **High Malicious URL Threats**: from Search: Threat Intel Quick Analysis/High Malicious URL Threats 
- **IP Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New 
- **Number of Log Lines (Events) Scanned for Threats**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New 
- **Threat Breakdown by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New 
- **Threat Breakdown by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New 
- **Threat Breakdown by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New 
- **Threat Breakdown by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New 
- **Threat by Actor**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New 
- **Threat by Actor**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New 
- **Threat by Actors**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New 
- **Threat by Geo Location**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New 
- **Threat by Malicious Confidence**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New 
- **Threat by Malicious Confidence**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New 
- **Threat by Malicious Confidence**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New 
- **Threat by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New 
- **Threat by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New 
- **Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New 
- **Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New 
- **Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New 
- **Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New 
- **Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New 
- **Threat Table**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New 
- **Threat Table**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New 
- **Threat Table**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New 
- **Threat Table**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New 
- **Threat Table**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New 
- **Threats by Actor**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New 
- **Threats by Actor**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New 
- **Threats by Malicious Confidence**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New 
- **Threats by Malicious Confidence**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New 
- **Threats by Malicious Confidence**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New 
- **Threats Over Time**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New 
- **Threats Over Time**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New 
- **Threats Over Time**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New 
- **Threats Over Time**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New 
- **Threats Over Time**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New 
- **Threats Over Time**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New 
- **Threats Over Time by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New 
- **Threats Over Time by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New 
- **Threats Over Time by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New 
- **Threats Over Time by Sources**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New 
- **URL Threat Count**: from Dashboard: Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Threat Intel Quick Analysis|Domain Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)"<br />\|where if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\|count as domain\_count by domain<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (domain\_count) as threat\_count|
|Threat Intel Quick Analysis|Email Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})"<br />\|where if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\|count as email\_count by email\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (email\_count) as threat\_count|
|Threat Intel Quick Analysis|Hash 256 Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)"<br />\|where if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\|count as hash256\_count by hash\_256<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (hash256\_count) as threat\_count|
|Threat Intel Quick Analysis|High Malicious Domain Threats|Logs|Threat Intel Quick Analysis/High Malicious Domain Threats|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)" <br />\| lookup type, actor, raw, threatlevel  as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and malicious\_confidence = "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name|
|Threat Intel Quick Analysis|High Malicious Email Threats|Logs|Threat Intel Quick Analysis/High Malicious Email Threats|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})" <br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| where type = "email\_address"  and malicious\_confidence = "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name|
|Threat Intel Quick Analysis|High Malicious Hash 256 Threats|Logs|Threat Intel Quick Analysis/High Malicious Hash 256 Threats|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)" <br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256" and malicious\_confidence = "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor|
|Threat Intel Quick Analysis|High Malicious IP Threats|Logs|Threat Intel Quick Analysis/High Malicious IP Threats|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\* <br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address<br />\| where type="ip\_address"  and malicious\_confidence = "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name|
|Threat Intel Quick Analysis|High Malicious IP Threats with SSHScanner Labels filtered out|Logs|Threat Intel Quick Analysis/High Malicious IP Threats with SSHScanner Labels filtered out|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\* <br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address<br />\| where type="ip\_address"  and malicious\_confidence = "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence) <br />\| where !(label\_name matches "\*SSHScanner\*")|
|Threat Intel Quick Analysis|High Malicious URL Threats|Logs|Threat Intel Quick Analysis/High Malicious URL Threats|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url"   and malicious\_confidence = "high"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name|
|Threat Intel Quick Analysis|IP Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\|where if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\|count as ip\_count by ip\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|Threat Intel Quick Analysis|Number of Log Lines (Events) Scanned for Threats|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\|where if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\|count|
|Threat Intel Quick Analysis|Threat Breakdown by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as ip\_count by ip\_address, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_source|
|Threat Intel Quick Analysis|Threat Breakdown by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)"<br />\|where if ("{{hash\_256}}" = "\*", true, hash\_256 matches "{{hash\_256}}")<br />\|count as hash256\_count by hash\_256, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (hash256\_count) as threat\_count by \_source|
|Threat Intel Quick Analysis|Threat Breakdown by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)" <br />\| timeslice 5m<br />\|where if ("{{hash\_256}}" = "\*", true, hash\_256 matches "{{hash\_256}}")<br />\|count as hash256\_count by hash\_256, \_timeslice, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (hash256\_count) as threat\_count by \_timeslice, \_source<br />\| transpose row \_timeslice column \_source|
|Threat Intel Quick Analysis|Threat Breakdown by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})"<br />\|where if ("{{\_source}}" = "\*", true, \_source matches "{{\_source}}")<br />\|count as email\_count by email\_address, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (email\_count) as threat\_count by \_source|
|Threat Intel Quick Analysis|Threat by Actor|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as url\_count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (url\_count) as threat\_count by Actor|
|Threat Intel Quick Analysis|Threat by Actor|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)"<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as domain\_count by domain<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (domain\_count) as threat\_count by Actor|
|Threat Intel Quick Analysis|Threat by Actors|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as ip\_count by ip\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by Actor|
|Threat Intel Quick Analysis|Threat by Geo Location|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip\_address<br />\|where if ("{{malicious\_confidence}}" = "\*", true, malicious\_confidence matches "{{malicious\_confidence}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Threat Intel Quick Analysis|Threat by Malicious Confidence|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)"<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as domain\_count by domain<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (domain\_count) as threat\_count by malicious\_confidence|
|Threat Intel Quick Analysis|Threat by Malicious Confidence|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count by malicious\_confidence|
|Threat Intel Quick Analysis|Threat by Malicious Confidence|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<threat\>\\b[\\w,\\s-]+\\.[A-Za-z]{3}\\b)"  nodrop<br />\| parse regex "(?\<threat\>\\b[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4}\\b)"  nodrop<br />\| parse regex "(?\<threat\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b)" nodrop<br />\| parse regex "(?\<threat\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)" <br />\| parse regex "(?\<threat\>\\b(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*)\\b)" nodrop<br />\| parse regex "(?\<threat\>\\b(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3}\\b)" nodrop<br />\|where if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\|count as threat\_count by threat<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=threat<br />\| where type in ("ip\_address","email\_address", "domain", "url", "file\_name") and !isNull(malicious\_confidence)<br />\| sum (threat\_count) as threat\_count by malicious\_confidence|
|Threat Intel Quick Analysis|Threat by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as url\_count by url, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (url\_count) as threat\_count by \_source|
|Threat Intel Quick Analysis|Threat by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)"<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as domain\_count by domain, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (domain\_count) as threat\_count by \_source|
|Threat Intel Quick Analysis|Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)"<br />\|where if ("{{hash\_256}}" = "\*", true, hash\_256 matches "{{hash\_256}}")<br />\|count as hash256\_count by hash\_256<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (hash256\_count) as threat\_count|
|Threat Intel Quick Analysis|Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)"<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as domain\_count by domain<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (domain\_count) as threat\_count|
|Threat Intel Quick Analysis|Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})"<br />\|where if ("{{\_source}}" = "\*", true, \_source matches "{{\_source}}")<br />\|count as email\_count by email\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (email\_count) as threat\_count|
|Threat Intel Quick Analysis|Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as url\_count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (url\_count) as threat\_count|
|Threat Intel Quick Analysis|Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as ip\_count by ip\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|Threat Intel Quick Analysis|Threat Table|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\| timeslice 5m<br />\| count as ip\_count by ip\_address, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by ip\_address, malicious\_confidence, Actor,  \_source, label\_name<br />\| sort by threat\_count<br />\|where if ("{{malicious\_confidence}}" = "\*", true, malicious\_confidence matches "{{malicious\_confidence}}")|
|Threat Intel Quick Analysis|Threat Table|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)"<br />\|where if ("{{hash\_256}}" = "\*", true, hash\_256 matches "{{hash\_256}}")<br />\|count as hash256\_count by hash\_256, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (hash256\_count) as threat\_count by hash\_256, malicious\_confidence, Actor,  \_source, label\_name<br />\| sort by threat\_count|
|Threat Intel Quick Analysis|Threat Table|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)"<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as domain\_count by domain, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (domain\_count) as threat\_count by domain, malicious\_confidence, Actor,  \_source, label\_name<br />\| sort by threat\_count|
|Threat Intel Quick Analysis|Threat Table|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as url\_count by url, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (url\_count) as threat\_count by url, malicious\_confidence, Actor,  \_source, label\_name|
|Threat Intel Quick Analysis|Threat Table|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})"<br />\|where if ("{{\_source}}" = "\*", true, \_source matches "{{\_source}}")<br />\|count as email\_count by email\_address, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (email\_count) as threat\_count by email\_address, malicious\_confidence, Actor,  \_source, label\_name<br />\| sort by threat\_count|
|Threat Intel Quick Analysis|Threats by Actor|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)"<br />\|where if ("{{hash\_256}}" = "\*", true, hash\_256 matches "{{hash\_256}}")<br />\|count as hash256\_count by hash\_256<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (hash256\_count) as threat\_count by Actor|
|Threat Intel Quick Analysis|Threats by Actor|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})"<br />\|where if ("{{\_source}}" = "\*", true, \_source matches "{{\_source}}")<br />\|count as email\_count by email\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (email\_count) as threat\_count by Actor|
|Threat Intel Quick Analysis|Threats by Malicious Confidence|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)"<br />\|where if ("{{hash\_256}}" = "\*", true, hash\_256 matches "{{hash\_256}}")<br />\|count as hash256\_count by hash\_256<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (hash256\_count) as threat\_count by malicious\_confidence|
|Threat Intel Quick Analysis|Threats by Malicious Confidence|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})"<br />\|where if ("{{\_source}}" = "\*", true, \_source matches "{{\_source}}")<br />\|count as email\_count by email\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (email\_count) as threat\_count by malicious\_confidence|
|Threat Intel Quick Analysis|Threats by Malicious Confidence|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\| count as ip\_count by ip\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by malicious\_confidence<br />\|where if ("{{malicious\_confidence}}" = "\*", true, malicious\_confidence matches "{{malicious\_confidence}}")|
|Threat Intel Quick Analysis|Threats Over Time|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\| timeslice 5m<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as ip\_count by ip\_address, \_timeslice<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_timeslice|
|Threat Intel Quick Analysis|Threats Over Time|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<threat\>\\b[\\w,\\s-]+\\.[A-Za-z]{3}\\b)"  nodrop<br />\| parse regex "(?\<threat\>\\b[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4}\\b)"  nodrop<br />\| parse regex "(?\<threat\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\b)" nodrop<br />\| parse regex "(?\<threat\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)" <br />\| parse regex "(?\<threat\>\\b(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*)\\b)" nodrop<br />\| parse regex "(?\<threat\>\\b(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3}\\b)" nodrop<br />\| timeslice 5m<br />\|where if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\|count as threat\_count by threat, \_timeslice<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=threat<br />\| where type in ("ip\_address","email\_address", "domain", "url", "file\_name") and !isNull(malicious\_confidence)<br />\| sum (threat\_count) as threat\_count by \_timeslice|
|Threat Intel Quick Analysis|Threats Over Time|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Hash 256 - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<hash\_256\>\\b[A-Fa-f0-9]{64}\\b)" <br />\| timeslice 5m<br />\|where if ("{{hash\_256}}" = "\*", true, hash\_256 matches "{{hash\_256}}")<br />\|count as hash256\_count by hash\_256, \_timeslice<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=hash\_256 <br />\| where type = "hash\_sha256"<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (hash256\_count) as threat\_count by \_timeslice|
|Threat Intel Quick Analysis|Threats Over Time|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})" <br />\| timeslice 5m<br />\|where if ("{{\_source}}" = "\*", true, \_source matches "{{\_source}}")<br />\|count as email\_count by email\_address, \_timeslice<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (email\_count) as threat\_count by \_timeslice|
|Threat Intel Quick Analysis|Threats Over Time|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)" <br />\| timeslice 5m<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as domain\_count by domain, \_timeslice<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (domain\_count) as threat\_count by \_timeslice|
|Threat Intel Quick Analysis|Threats Over Time|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\| timeslice 5m<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as url\_count by url, \_timeslice<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (url\_count) as threat\_count by \_timeslice|
|Threat Intel Quick Analysis|Threats Over Time by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - IP - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<ip\_address\>\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" <br />\| where ip\_address != "0.0.0.0" and ip\_address != "127.0.0.1"<br />\| timeslice 5m<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as ip\_count by ip\_address, \_timeslice, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=ip\_address <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_timeslice, \_source<br />\| transpose row \_timeslice column \_source|
|Threat Intel Quick Analysis|Threats Over Time by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Email - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*  (user or email or login or userid or user\_id)<br />\| parse regex "(?\<email\_address\>[A-Za-z0-9.\_%+-]+@[A-Za-z0-9.-]+\\.[a-zA-Z]{2,4})" <br />\| timeslice 5m<br />\|where if ("{{\_source}}" = "\*", true, \_source matches "{{\_source}}")<br />\|count as email\_count by email\_address, \_timeslice, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=email\_address<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (email\_count) as threat\_count by \_timeslice, \_source<br />\| transpose row \_timeslice column \_source|
|Threat Intel Quick Analysis|Threats Over Time by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - URL - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\| timeslice 5m<br />\|where if ("{{\_sourcename}}" = "\*", true, \_sourcename matches "{{\_sourcename}}")<br />\|count as url\_count by url, \_timeslice,\_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (url\_count) as threat\_count by \_timeslice, \_source<br />\| transpose row \_timeslice column \_source|
|Threat Intel Quick Analysis|Threats Over Time by Sources|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Domain - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<domain\>\\b[a-zA-Z0-9][a-zA-Z0-9-\_]{1,61}[a-zA-Z0-9]\\.[a-zA-Z]{2,6}\|[a-zA-Z0-9-]{2,30}\\.[a-zA-Z]{2,3}\\b)" <br />\| timeslice 5m<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as domain\_count by domain, \_timeslice, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| where  type = "domain" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum (domain\_count) as threat\_count by \_timeslice, \_source<br />\| transpose row \_timeslice column \_source|
|Threat Intel Quick Analysis|URL Threat Count|Logs|Threat Intel Quick Analysis/Threat Intel Quick Analysis - Overview - New|\_collector = "Labs - GoogleApps" OR \_sourceCategory = Labs/AWS\*<br />\| parse regex "(?\<url\>(?:http(?:s)?:\\/\\/.)?(?:www\\.)?[-a-zA-Z0-9@:%.\_\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%\_\\+.~#?&//=]\*))" nodrop<br />\| parse regex "(?\<url\>(?:\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\/.\\S+\\.?\\S{0,3})"<br />\|where if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\|count as url\_count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url<br />\| where type = "url" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (url\_count) as threat\_count|

