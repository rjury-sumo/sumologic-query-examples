# Workday
## Sumo Logic App For: Workday
The Sumo Logic App for Workday provides you insights into your authentication or login activity, user activity, and admin activity providing a complete secure monitoring solution. The pre-configured dashboards organize events to identify compliance and incident reporting, common security events, and real-time analysis of suspicious activities.
Docs Link: [Workday](https://help.sumologic.com/?cid=2324)

## Searches

### Log Searches

- **Activity**: from Dashboard: Workday/Workday - User Activity 
- **Activity by users from Malicious IPs**: from Dashboard: Workday/Workday - User Activity 
- **Activity Over Time**: from Dashboard: Workday/Workday - User Activity 
- **Activity Over Time**: from Dashboard: Installed Apps/Workday/Workday - System User Activity 
- **Activity Over Time**: from Dashboard: Workday/Workday - System User Activity 
- **ActivityAction Trend**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **ActivityAction Trend**: from Dashboard: Workday/Workday - API Activity 
- **Anomaly Detection On Failed/Total Logins**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Anomaly Detection On Failed/Total Logins**: from Dashboard: Workday/Workday - Overview 
- **API Client Changes**: from Dashboard: Installed Apps/Workday/Workday - System User Activity 
- **API Client Changes**: from Dashboard: Workday/Workday - System User Activity 
- **Bottom 10 User Agents**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Bottom 10 User Agents**: from Dashboard: Workday/Workday - Login Activity 
- **Business Object Events**: from Dashboard: Installed Apps/Workday/Workday - System User Activity 
- **Business Object Events**: from Dashboard: Workday/Workday - System User Activity 
- **Business Process Events**: from Dashboard: Workday/Workday - System User Activity 
- **Business Process Events**: from Dashboard: Installed Apps/Workday/Workday - System User Activity 
- **Create Activity**: from Dashboard: Workday/Workday - User Activity 
- **Delete Activity**: from Dashboard: Workday/Workday - User Activity 
- **Download Activity**: from Dashboard: Workday/Workday - User Activity 
- **Download Activity by Task**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Download Activity by Task**: from Dashboard: Workday/Workday - Overview 
- **Failed Login Reasons**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Failed Login Reasons**: from Dashboard: Workday/Workday - Login Activity 
- **Failed Logins**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Failed Logins**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Failed Logins**: from Dashboard: Workday/Workday - Login Activity 
- **Failed Logins**: from Dashboard: Workday/Workday - Overview 
- **Failed Logins Over Time**: from Dashboard: Workday/Workday - Overview 
- **Failed Logins Over Time**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Last 20 Recent Logins from Untrusted Devices**: from Dashboard: Workday/Workday - Login Activity 
- **Last 20 Recent Logins from Untrusted Devices**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Last 20 Recently Failed Logins**: from Dashboard: Workday/Workday - Login Activity 
- **Last 20 Recently Failed Logins**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Logins by Authentication Type**: from Dashboard: Workday/Workday - Login Activity 
- **Logins by Authentication Type**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Logins by Device Type**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Logins by Device Type**: from Dashboard: Workday/Workday - Login Activity 
- **Logins by Devices**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Logins by Devices**: from Dashboard: Workday/Workday - Overview 
- **Logins by IP Address**: from Dashboard: Workday/Workday - Login Activity 
- **Logins by IP Address**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Logins by Location**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Logins by Location**: from Dashboard: Workday/Workday - Overview 
- **Logins by Request Originator**: from Dashboard: Workday/Workday - Login Activity 
- **Logins by Request Originator**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Logins by Workday Account**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Logins by Workday Account**: from Dashboard: Workday/Workday - Login Activity 
- **Logins from Malicious Sources**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Logins from Malicious Sources**: from Dashboard: Workday/Workday - Login Activity 
- **Logins Over Time**: from Dashboard: Workday/Workday - Login Activity 
- **Logins Over Time**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Longest User Sessions (in Minutes)**: from Dashboard: Workday/Workday - User Activity 
- **Malicious Actors**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Malicious Actors**: from Dashboard: Workday/Workday - Login Activity 
- **Malicious API Activity**: from Dashboard: Workday/Workday - API Activity 
- **Malicious API Activity**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **Malicious Confidence**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Malicious Confidence**: from Dashboard: Workday/Workday - Login Activity 
- **Malicious IPs**: from Dashboard: Workday/Workday - User Activity 
- **Malicious Logins**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Malicious Logins**: from Dashboard: Workday/Workday - Login Activity 
- **Parameterized Rest API Activity**: from Search: Installed Apps/Workday/Parameterized Rest API Activity 
- **Parameterized Rest API Activity**: from Search: Workday/Parameterized Rest API Activity 
- **Parameterized User Activity**: from Search: Installed Apps/Workday/Parameterized User Activity 
- **Parameterized User Activity**: from Search: Workday/Parameterized User Activity 
- **Permission Changes**: from Dashboard: Installed Apps/Workday/Workday - System User Activity 
- **Permission Changes**: from Dashboard: Workday/Workday - System User Activity 
- **Policy Events**: from Dashboard: Workday/Workday - System User Activity 
- **Policy Events**: from Dashboard: Installed Apps/Workday/Workday - System User Activity 
- **Recent Activity from Untrusted Devices or by Users with Failed Logins**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Recent Activity from Untrusted Devices or by Users with Failed Logins**: from Dashboard: Workday/Workday - Overview 
- **Recent Personal Information Changes**: from Search: Installed Apps/Workday/Recent Personal Information Changes 
- **Recent Personal Information Changes**: from Search: Workday/Recent Personal Information Changes 
- **Recent Rest API Activity**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **Recent Rest API Activity**: from Dashboard: Workday/Workday - API Activity 
- **Recent Web Service Activity**: from Dashboard: Workday/Workday - API Activity 
- **Recent Web Service Activity**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **Recently Failed Logins**: from Search: Workday/Recently Failed Logins 
- **Recently Failed Logins**: from Search: Installed Apps/Workday/Recently Failed Logins 
- **Report Changes**: from Dashboard: Installed Apps/Workday/Workday - System User Activity 
- **Report Changes**: from Dashboard: Workday/Workday - System User Activity 
- **Rest API Calls by URL**: from Dashboard: Workday/Workday - API Activity 
- **Rest API Calls by URL**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **Rest API Requests by Device Type**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **Rest API Requests by Device Type**: from Dashboard: Workday/Workday - API Activity 
- **Rest API Requests by Methods**: from Dashboard: Workday/Workday - API Activity 
- **Rest API Requests by Methods**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **Security Group Changes**: from Dashboard: Installed Apps/Workday/Workday - System User Activity 
- **Security Group Changes**: from Dashboard: Workday/Workday - System User Activity 
- **Successful Logins**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Successful Logins**: from Dashboard: Workday/Workday - Login Activity 
- **Successful Logins**: from Dashboard: Workday/Workday - Overview 
- **Successful Logins**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Top 10 Client IPs**: from Dashboard: Workday/Workday - API Activity 
- **Top 10 Client IPs**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **Top 10 Downloaded Tasks**: from Dashboard: Workday/Workday - User Activity 
- **Top 10 Executed Reports**: from Dashboard: Workday/Workday - User Activity 
- **Top 10 Malicious System Users**: from Dashboard: Workday/Workday - User Activity 
- **Top 10 Malicious User Agents**: from Dashboard: Workday/Workday - User Activity 
- **Top 10 Tasks**: from Dashboard: Workday/Workday - User Activity 
- **Top 10 User Agents**: from Dashboard: Installed Apps/Workday/Workday - Login Activity 
- **Top 10 User Agents**: from Dashboard: Workday/Workday - Login Activity 
- **Top 10 Users**: from Dashboard: Workday/Workday - User Activity 
- **Update Activity**: from Dashboard: Workday/Workday - User Activity 
- **View Activity**: from Dashboard: Workday/Workday - User Activity 
- **Web Services Logins**: from Dashboard: Workday/Workday - API Activity 
- **Web Services Logins**: from Dashboard: Installed Apps/Workday/Workday - API Activity 
- **Write Activity by Task**: from Dashboard: Installed Apps/Workday/Workday - Overview 
- **Write Activity by Task**: from Dashboard: Workday/Workday - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Workday|Activity|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br />\| count by ActivityAction|
|Workday|Activity by users from Malicious IPs|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "deviceType", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, DeviceType, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br /> \| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=ipAddress<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as %"Threat Last Updated" <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| malicious\_confidence as %"Malicious Confidence"<br />\| ipAddress as %"Malicious IP"<br />\| DeviceType as %"Device Type"<br />\| actor as %"Malicious Actor"<br />\| count as %"Count" by %"System User", %"Malicious IP", Task, %"Device Type", %"Malicious Actor", %"Malicious Confidence", %"Threat Last Updated"<br />\| sort by %"Count"|
|Workday|Activity Over Time|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br />\| timeslice 6h<br />\| count by \_timeslice, Task<br />\| transpose row \_timeslice column Task|
|Workday|Activity Over Time|Logs|Installed Apps/Workday/Workday - System User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| timeslice 1h<br />\| where Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| if(Task matches "\*Security Group\*" and (ActivityAction = "WRITE"  OR Task matches "\*Edit\*"), 1, 0) as security\_group\_changes<br />\| if(Task matches "\*Report\*" and (Task matches "\*Edit\*" or Task matches "\*Delete\*"  or ActivityAction = "WRITE") ,1, 0) as report\_changes<br />\| if(Task matches "\*API Client\*" and (ActivityAction = "WRITE" or Task matches "\*Edit\*" or Task matches "\*Delete\*"),1, 0) as api\_client\_changes<br />\| if(Task matches "\*Permissions\*" or Task matches "\*Credentials\*" and (ActivityAction = "WRITE" or Task matches "\*Edit\*" or Task matches "\*Delete\*"), 1, 0) as permission\_changes<br />\| if(Task matches "\*Policy\*", 1, 0) as policy\_events<br />\| if(Task matches "\*Business\*" and Task matches "\*Object\*", 1, 0) as business\_object\_events<br />\| if(Task = "Create Condition Rule" or Task = "Reassign Tasks" or Task = "Create Alert Rule" or Task matches "\*Business Process\*", 1, 0) as business\_process\_events<br />\| sum(security\_group\_changes) as %"Security Group Changes", sum(report\_changes) as %"Report Changes", sum(api\_client\_changes) as %"Api Client Changes", sum(permission\_changes) as %"Permission Changes", sum(policy\_events) as %"Policy Events", sum(business\_object\_events) as %"Business Object Events", sum(business\_process\_events) as %"Business Process Events" by \_timeslice<br />|
|Workday|Activity Over Time|Logs|Workday/Workday - System User Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| timeslice 1h<br />\| where Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| if(Task matches "\*Security Group\*" and (ActivityAction = "WRITE"  OR Task matches "\*Edit\*"), 1, 0) as security\_group\_changes<br />\| if(Task matches "\*Report\*" and (Task matches "\*Edit\*" or Task matches "\*Delete\*"  or ActivityAction = "WRITE") ,1, 0) as report\_changes<br />\| if(Task matches "\*API Client\*" and (ActivityAction = "WRITE" or Task matches "\*Edit\*" or Task matches "\*Delete\*"),1, 0) as api\_client\_changes<br />\| if(Task matches "\*Permissions\*" or Task matches "\*Credentials\*" and (ActivityAction = "WRITE" or Task matches "\*Edit\*" or Task matches "\*Delete\*"), 1, 0) as permission\_changes<br />\| if(Task matches "\*Policy\*", 1, 0) as policy\_events<br />\| if(Task matches "\*Business\*" and Task matches "\*Object\*", 1, 0) as business\_object\_events<br />\| if(Task = "Create Condition Rule" or Task = "Reassign Tasks" or Task = "Create Alert Rule" or Task matches "\*Business Process\*", 1, 0) as business\_process\_events<br />\| sum(security\_group\_changes) as %"Security Group Changes", sum(report\_changes) as %"Report Changes", sum(api\_client\_changes) as %"Api Client Changes", sum(permission\_changes) as %"Permission Changes", sum(policy\_events) as %"Policy Events", sum(business\_object\_events) as %"Business Object Events", sum(business\_process\_events) as %"Business Process Events" by \_timeslice<br />|
|Workday|ActivityAction Trend|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| timeslice 1h<br />\| count by activityAction, \_timeslice<br />\| transpose row \_timeslice column activityAction|
|Workday|ActivityAction Trend|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| timeslice 1h<br />\| count by activityAction, \_timeslice<br />\| transpose row \_timeslice column activityAction|
|Workday|Anomaly Detection On Failed/Total Logins|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Failed\_Signon", "tenant\_name"  nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}"<br />\| timeslice 1h<br />\| count by \_timeslice<br />\| outlier \_count window=6, threshold=2<br />\| where \_count\_std \> 0<br />\| if(\_count\_violation=1,abs(\_count\_error)/\_count\_std, 0) as deviation<br />\| if(deviation \>= 1, 1, 0) as total\_logins\_anomaly<br />\| fields \_timeslice, total\_logins\_anomaly //, \_count\_violation, \_count\_error, \_count\_std, deviation|
|Workday|Anomaly Detection On Failed/Total Logins|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Failed\_Signon", "tenant\_name"  nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}"<br />\| timeslice 1h<br />\| count by \_timeslice<br />\| outlier \_count window=6, threshold=2<br />\| where \_count\_std \> 0<br />\| if(\_count\_violation=1,abs(\_count\_error)/\_count\_std, 0) as deviation<br />\| if(deviation \>= 1, 1, 0) as total\_logins\_anomaly<br />\| fields \_timeslice, total\_logins\_anomaly //, \_count\_violation, \_count\_error, \_count\_std, deviation|
|Workday|API Client Changes|Logs|Installed Apps/Workday/Workday - System User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where Task matches "\*API Client\*" and (ActivityAction = "WRITE" or Task matches "\*Edit\*" or Task matches "\*Delete\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|API Client Changes|Logs|Workday/Workday - System User Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where Task matches "\*API Client\*" and (ActivityAction = "WRITE" or Task matches "\*Edit\*" or Task matches "\*Delete\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Bottom 10 User Agents|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "sessionId", "activityAction", "deviceType", "userAgent", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, SessionID, ActivityAction, DeviceType, %"User Agent",tenant\_name nodrop<br />\| where %"System User" matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and ipAddress matches "{{SessionIPAddress}}"<br />\| if(isBlank(%"User Agent"), "Unknown", %"User Agent") as %"User Agent" <br />\| count as %"Count" by %"User Agent"<br />\| -1\*%"Count" as %"Count"<br />\| top 10 %"User Agent" by %"Count"<br />\| -1\*%"Count" as %"Count"|
|Workday|Bottom 10 User Agents|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "sessionId", "activityAction", "deviceType", "userAgent", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, SessionID, ActivityAction, DeviceType, %"User Agent",tenant\_name nodrop<br />\| where %"System User" matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and ipAddress matches "{{SessionIPAddress}}"<br />\| if(isBlank(%"User Agent"), "Unknown", %"User Agent") as %"User Agent" <br />\| count as %"Count" by %"User Agent"<br />\| -1\*%"Count" as %"Count"<br />\| top 10 %"User Agent" by %"Count"<br />\| -1\*%"Count" as %"Count"|
|Workday|Business Object Events|Logs|Installed Apps/Workday/Workday - System User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where Task matches "\*Business\*" and Task matches "\*Object\*" and !(%"System User" matches "wd-\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Business Object Events|Logs|Workday/Workday - System User Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where Task matches "\*Business\*" and Task matches "\*Object\*" and !(%"System User" matches "wd-\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Business Process Events|Logs|Workday/Workday - System User Activity|\_sourceCategory = Labs/Workday\*  ("Create Condition Rule" or "Reassign Tasks" or "Create Alert Rule" or "Business Process")<br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where %"System User" != "wd-environments" and (Task = "Create Condition Rule" or Task = "Reassign Tasks" or Task = "Create Alert Rule" or Task matches "\*Business Process\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Business Process Events|Logs|Installed Apps/Workday/Workday - System User Activity|\_sourceCategory={{Logsdatasource}}   ("Create Condition Rule" or "Reassign Tasks" or "Create Alert Rule" or "Business Process")<br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where %"System User" != "wd-environments" and (Task = "Create Condition Rule" or Task = "Reassign Tasks" or Task = "Create Alert Rule" or Task matches "\*Business Process\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Create Activity|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and (Task matches "\*Create\*" or Task matches "\*Generate\*" or Task matches "\*Register\*" or Task matches "\*Copy\*")<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count<br />\| limit 50|
|Workday|Delete Activity|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and (Task matches "\*Delete\*" or Task matches "\*Remove\*" or Task matches "\*Purge\*")<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count<br />\| limit 50<br /><br />|
|Workday|Download Activity|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\* !executeCustomReport<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction = "DOWNLOAD"<br />\| count by Time, %"System User", Task<br />\| sort by Time<br />\| fields -\_count<br />\| limit 20|
|Workday|Download Activity by Task|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name"  as  ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and !(%"System User" matches "wd-\*") and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction = "DOWNLOAD"<br />\| count by Task|
|Workday|Download Activity by Task|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\* <br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name"  as  ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and !(%"System User" matches "wd-\*") and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction = "DOWNLOAD"<br />\| count by Task|
|Workday|Failed Login Reasons|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Authentication\_Failure\_Message", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}" and !isBlank(Authentication\_Failure\_Message)<br />\| count by Authentication\_Failure\_Message<br />\| if (isBlank(Authentication\_Failure\_Message), "Unknown", Authentication\_Failure\_Message) as Authentication\_Failure\_Message<br />\| sort by \_count|
|Workday|Failed Login Reasons|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Authentication\_Failure\_Message", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}" and !isBlank(Authentication\_Failure\_Message)<br />\| count by Authentication\_Failure\_Message<br />\| if (isBlank(Authentication\_Failure\_Message), "Unknown", Authentication\_Failure\_Message) as Authentication\_Failure\_Message<br />\| sort by \_count|
|Workday|Failed Logins|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Failed\_Signon", "tenant\_name"  nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}" <br />\| where Failed\_Signon=1<br />\| count|
|Workday|Failed Logins|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Failed\_Signon","tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}" and Failed\_Signon = 1 <br />\| count|
|Workday|Failed Logins|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Failed\_Signon","tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}" and Failed\_Signon = 1 <br />\| count|
|Workday|Failed Logins|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Failed\_Signon", "tenant\_name"  nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}" <br />\| where Failed\_Signon=1<br />\| count|
|Workday|Failed Logins Over Time|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Failed\_Signon", "tenant\_name"  as %"System User",Session\_IP\_Address, Failed\_Signon, tenant\_name<br />\| where !(%"System User" matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Failed\_Signon=1<br />\| timeslice 4h<br />\| count as %"Count" by %"System User", \_timeslice<br />\| transpose row \_timeslice column %"System User"|
|Workday|Failed Logins Over Time|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Failed\_Signon", "tenant\_name"  as %"System User",Session\_IP\_Address, Failed\_Signon, tenant\_name<br />\| where !(%"System User" matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Failed\_Signon=1<br />\| timeslice 4h<br />\| count as %"Count" by %"System User", \_timeslice<br />\| transpose row \_timeslice column %"System User"|
|Workday|Last 20 Recent Logins from Untrusted Devices|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "Session\_Start", "Device\_is\_Trusted", "Invalid\_Credentials", "Account\_Locked\_\_Disabled\_or\_Expired", "Authentication\_Type\_for\_Signon", "Session\_ID", "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Failed\_Signon","tenant\_name" nodrop<br />\| where Device\_is\_Trusted=0 and !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Session\_Start,System\_Account,Session\_IP\_Address,Request\_Originator,Device\_is\_Trusted,Invalid\_Credentials,Account\_Locked\_\_Disabled\_or\_Expired,Authentication\_Type\_for\_Signon,Session\_ID<br />\| fields -\_count<br />\| sort by Session\_Start<br />\| limit 20|
|Workday|Last 20 Recent Logins from Untrusted Devices|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "Session\_Start", "Device\_is\_Trusted", "Invalid\_Credentials", "Account\_Locked\_\_Disabled\_or\_Expired", "Authentication\_Type\_for\_Signon", "Session\_ID", "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Failed\_Signon","tenant\_name" nodrop<br />\| where Device\_is\_Trusted=0 and !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Session\_Start,System\_Account,Session\_IP\_Address,Request\_Originator,Device\_is\_Trusted,Invalid\_Credentials,Account\_Locked\_\_Disabled\_or\_Expired,Authentication\_Type\_for\_Signon,Session\_ID<br />\| fields -\_count<br />\| sort by Session\_Start<br />\| limit 20|
|Workday|Last 20 Recently Failed Logins|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "Session\_Start", "Device\_is\_Trusted", "Invalid\_Credentials", "Account\_Locked\_\_Disabled\_or\_Expired", "Authentication\_Type\_for\_Signon", "Session\_ID", "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Failed\_Signon","tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Failed\_Signon=1 and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Session\_Start,System\_Account,Session\_IP\_Address,Request\_Originator,Device\_is\_Trusted,Invalid\_Credentials,Account\_Locked\_\_Disabled\_or\_Expired,Authentication\_Type\_for\_Signon,Session\_ID<br />\| fields -\_count<br />\| sort by Session\_Start<br />\| limit 20|
|Workday|Last 20 Recently Failed Logins|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "Session\_Start", "Device\_is\_Trusted", "Invalid\_Credentials", "Account\_Locked\_\_Disabled\_or\_Expired", "Authentication\_Type\_for\_Signon", "Session\_ID", "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Failed\_Signon","tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Failed\_Signon=1 and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Session\_Start,System\_Account,Session\_IP\_Address,Request\_Originator,Device\_is\_Trusted,Invalid\_Credentials,Account\_Locked\_\_Disabled\_or\_Expired,Authentication\_Type\_for\_Signon,Session\_ID<br />\| fields -\_count<br />\| sort by Session\_Start<br />\| limit 20|
|Workday|Logins by Authentication Type|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Authentication\_Type\_for\_Signon", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Authentication\_Type\_for\_Signon<br />\| sort by \_count<br />|
|Workday|Logins by Authentication Type|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Authentication\_Type\_for\_Signon", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Authentication\_Type\_for\_Signon<br />\| sort by \_count<br />|
|Workday|Logins by Device Type|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Device\_Type","tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| if(isBlank(device\_type),"Unknown", device\_type) as device\_type<br />\| count by device\_type<br />\| sort by \_count|
|Workday|Logins by Device Type|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Device\_Type","tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| if(isBlank(device\_type),"Unknown", device\_type) as device\_type<br />\| count by device\_type<br />\| sort by \_count|
|Workday|Logins by Devices|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Device\_Type", "tenant\_name"  nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}"<br />\| if(isBlank(device\_type),"Unknown", device\_type) as device\_type<br />\| count by device\_type<br />\| sort by \_count|
|Workday|Logins by Devices|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Device\_Type", "tenant\_name"  nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}"<br />\| if(isBlank(device\_type),"Unknown", device\_type) as device\_type<br />\| count by device\_type<br />\| sort by \_count|
|Workday|Logins by IP Address|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\*  !"Workday Internal"<br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count as %"Count" by Session\_IP\_Address<br />\| top 10 Session\_IP\_Address by %"Count"|
|Workday|Logins by IP Address|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}   !"Workday Internal"<br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count as %"Count" by Session\_IP\_Address<br />\| top 10 Session\_IP\_Address by %"Count"|
|Workday|Logins by Location|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}" <br />\| count by Session\_IP\_Address<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Session\_IP\_Address<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Workday|Logins by Location|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}" <br />\| count by Session\_IP\_Address<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Session\_IP\_Address<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Workday|Logins by Request Originator|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| if(isBlank(Request\_Originator),"Unknown", Request\_Originator) as Request\_Originator<br />\| count by Request\_Originator<br />\| sort by \_count|
|Workday|Logins by Request Originator|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| if(isBlank(Request\_Originator),"Unknown", Request\_Originator) as Request\_Originator<br />\| count by Request\_Originator<br />\| sort by \_count|
|Workday|Logins by Workday Account|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count as %"Count" by System\_Account<br />\| sort by %"Count"|
|Workday|Logins by Workday Account|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count as %"Count" by System\_Account<br />\| sort by %"Count"|
|Workday|Logins from Malicious Sources|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Device\_Type","tenant\_name" as %"System User", session\_ip\_address, Request\_Originator, %"Device Type", tenant\_name nodrop<br />\| where !(%"System User" matches "wd-\*") and session\_ip\_address matches "{{SessionIPAddress}}" and %"System User" matches "{{SystemUser}}" and Request\_Originator matches "{{RequestOriginator}}" and tenant\_name matches "{{TenantName}}" and session\_ip\_address != "0.0.0.0" and session\_ip\_address != "127.0.0.1" and session\_ip\_address!="Workday Internal"<br />\| count by %"System User", %"Device Type", session\_ip\_address<br />\|  lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=session\_ip\_address<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as %"Threat Last Updated" <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| malicious\_confidence as %"Malicious Confidence"<br />\| session\_ip\_address as %"Malicious IP"<br />\| Actor as %"Malicious Actor"<br />\| count as %"Count" by %"System User", %"Malicious IP", %"Device Type", %"Malicious Actor", %"Malicious Confidence", %"Threat Last Updated"|
|Workday|Logins from Malicious Sources|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "Device\_Type","tenant\_name" as %"System User", session\_ip\_address, Request\_Originator, %"Device Type", tenant\_name nodrop<br />\| where !(%"System User" matches "wd-\*") and session\_ip\_address matches "{{SessionIPAddress}}" and %"System User" matches "{{SystemUser}}" and Request\_Originator matches "{{RequestOriginator}}" and tenant\_name matches "{{TenantName}}" and session\_ip\_address != "0.0.0.0" and session\_ip\_address != "127.0.0.1" and session\_ip\_address!="Workday Internal"<br />\| count by %"System User", %"Device Type", session\_ip\_address<br />\|  lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=session\_ip\_address<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as %"Threat Last Updated" <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| malicious\_confidence as %"Malicious Confidence"<br />\| session\_ip\_address as %"Malicious IP"<br />\| Actor as %"Malicious Actor"<br />\| count as %"Count" by %"System User", %"Malicious IP", %"Device Type", %"Malicious Actor", %"Malicious Confidence", %"Threat Last Updated"|
|Workday|Logins Over Time|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Failed\_Signon","tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| timeslice 1h<br />\| if (Failed\_Signon == "1", 1, 0) as is\_failed\_signon<br />\| if (Failed\_Signon == "1", 0, 1) as is\_successful\_signon<br />\| sum(is\_failed\_signon) as failed\_signon\_count, sum(is\_successful\_signon) as successful\_signon\_count, count(Failed\_Signon) as total\_sigons by \_timeslice<br />\| (failed\_signon\_count\*100/total\_sigons) as failed\_sigon\_percent<br />\| (successful\_signon\_count\*100/total\_sigons) as successful\_sigon\_percent<br />\| fields -successful\_signon\_count,failed\_signon\_count,total\_sigons|
|Workday|Logins Over Time|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Failed\_Signon","tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| timeslice 1h<br />\| if (Failed\_Signon == "1", 1, 0) as is\_failed\_signon<br />\| if (Failed\_Signon == "1", 0, 1) as is\_successful\_signon<br />\| sum(is\_failed\_signon) as failed\_signon\_count, sum(is\_successful\_signon) as successful\_signon\_count, count(Failed\_Signon) as total\_sigons by \_timeslice<br />\| (failed\_signon\_count\*100/total\_sigons) as failed\_sigon\_percent<br />\| (successful\_signon\_count\*100/total\_sigons) as successful\_sigon\_percent<br />\| fields -successful\_signon\_count,failed\_signon\_count,total\_sigons|
|Workday|Longest User Sessions (in Minutes)|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "requestTime", "ipAddress", "sessionId", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as Time, ipAddress, SessionID, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br />\| parseDate(Time, "yyyy-MM-dd'T'HH:mm:ss.SSSXXX") as milliseconds<br />\| max(milliseconds) as last\_activity\_date, min(milliseconds) as first\_activity\_date by sessionId, %"System User"<br />\| last\_activity\_date - first\_activity\_date as active\_session\_time<br />\| top 10  %"System User" by active\_session\_time, SessionID<br />\| round(active\_session\_time/(1000\*60)) as %"Session Time(in minutes)"<br />\| SessionID as %"Session ID"<br />\| fields -active\_session\_time, SessionID|
|Workday|Malicious Actors|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Session\_IP\_Address<br />\| where Session\_IP\_Address != "0.0.0.0" and Session\_IP\_Address != "127.0.0.1" and Session\_IP\_Address!="Workday Internal"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Session\_IP\_Address<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by Actor<br />\| sort by \_count|
|Workday|Malicious Actors|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Session\_IP\_Address<br />\| where Session\_IP\_Address != "0.0.0.0" and Session\_IP\_Address != "127.0.0.1" and Session\_IP\_Address!="Workday Internal"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Session\_IP\_Address<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by Actor<br />\| sort by \_count|
|Workday|Malicious API Activity|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "deviceType", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, DeviceType, TenantName nodrop<br />\|  where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}" and (Task matches "\*Web Service\*" or Task matches "api/\*")<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=ipAddress<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as %"Threat Last Updated" <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| malicious\_confidence as %"Malicious Confidence"<br />\| ipAddress as %"Malicious IP"<br />\| DeviceType as %"Device Type"<br />\| actor as %"Malicious Actor"<br />\| count as %"Count" by %"System User", %"Malicious IP", Task, %"Device Type", %"Malicious Actor", %"Malicious Confidence", %"Threat Last Updated"<br />\| sort by %"Count"|
|Workday|Malicious API Activity|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "deviceType", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, DeviceType, TenantName nodrop<br />\|  where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}" and (Task matches "\*Web Service\*" or Task matches "api/\*")<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=ipAddress<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as %"Threat Last Updated" <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| malicious\_confidence as %"Malicious Confidence"<br />\| ipAddress as %"Malicious IP"<br />\| DeviceType as %"Device Type"<br />\| actor as %"Malicious Actor"<br />\| count as %"Count" by %"System User", %"Malicious IP", Task, %"Device Type", %"Malicious Actor", %"Malicious Confidence", %"Threat Last Updated"<br />\| sort by %"Count"|
|Workday|Malicious Confidence|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Session\_IP\_Address<br />\| where Session\_IP\_Address != "0.0.0.0" and Session\_IP\_Address != "127.0.0.1" and Session\_IP\_Address!="Workday Internal"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Session\_IP\_Address<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by malicious\_confidence<br />\| sort by \_count|
|Workday|Malicious Confidence|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count by Session\_IP\_Address<br />\| where Session\_IP\_Address != "0.0.0.0" and Session\_IP\_Address != "127.0.0.1" and Session\_IP\_Address!="Workday Internal"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Session\_IP\_Address<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by malicious\_confidence<br />\| sort by \_count|
|Workday|Malicious IPs|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as  ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=ipAddress<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| malicious\_confidence as %"Malicious Confidence"<br />\| count by ipAddress, %"Malicious Confidence"<br />\| transpose row %"Malicious Confidence" column ipAddress<br />|
|Workday|Malicious Logins|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" as %"System User", session\_ip\_address, Request\_Originator, tenant\_name nodrop<br />\| where !(%"System User" matches "wd-\*") and session\_ip\_address matches "{{SessionIPAddress}}" and %"System User" matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}" and session\_ip\_address != "0.0.0.0" and session\_ip\_address != "127.0.0.1" and session\_ip\_address!="Workday Internal"<br />\| count by session\_ip\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=session\_ip\_address<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = session\_ip\_address<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />|
|Workday|Malicious Logins|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator", "tenant\_name" as %"System User", session\_ip\_address, Request\_Originator, tenant\_name nodrop<br />\| where !(%"System User" matches "wd-\*") and session\_ip\_address matches "{{SessionIPAddress}}" and %"System User" matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}" and session\_ip\_address != "0.0.0.0" and session\_ip\_address != "127.0.0.1" and session\_ip\_address!="Workday Internal"<br />\| count by session\_ip\_address<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=session\_ip\_address<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = session\_ip\_address<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />|
|Workday|Parameterized Rest API Activity|Logs|Installed Apps/Workday/Parameterized Rest API Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "sessionId", "activityAction", "deviceType", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, SessionID, ActivityAction, %"Device Type", tenant\_name nodrop<br />\| parse field=Task "api/\*" as %"API"<br />\| if(isBlank(%"Device Type"),"Unknown", %"Device Type") as %"Device Type"<br />\| if(%"API" matches "\*GET\*", "GET",  if(%"API" matches "\*POST\*", "POST", "OTHER")) as request\_method<br />\| where %"API" matches "{{API\_URL}}" and %"System User" matches "{{SYSTEM\_USER}}"<br />\| request\_method as %"Request Method"<br />\| count by Time, %"System User", %"API", %"Request Method", %"Device Type", tenant\_name<br />\| sort by Time<br />\| fields -\_count|
|Workday|Parameterized Rest API Activity|Logs|Workday/Parameterized Rest API Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "sessionId", "activityAction", "deviceType", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, SessionID, ActivityAction, %"Device Type", tenant\_name nodrop<br />\| parse field=Task "api/\*" as %"API"<br />\| if(isBlank(%"Device Type"),"Unknown", %"Device Type") as %"Device Type"<br />\| if(%"API" matches "\*GET\*", "GET",  if(%"API" matches "\*POST\*", "POST", "OTHER")) as request\_method<br />\| where %"API" matches "{{API\_URL}}" and %"System User" matches "{{SYSTEM\_USER}}"<br />\| request\_method as %"Request Method"<br />\| count by Time, %"System User", %"API", %"Request Method", %"Device Type", tenant\_name<br />\| sort by Time<br />\| fields -\_count|
|Workday|Parameterized User Activity|Logs|Installed Apps/Workday/Parameterized User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "sessionId", "activityAction", "deviceType", "tenant\_name"  as Time, ipAddress, %"System User", Task, Target, SessionID, ActivityAction, %"Device Type", tenant\_name nodrop<br />\| if(isBlank(%"Device Type"),"Unknown", %"Device Type") as %"Device Type"<br />\| where  %"System User" matches "{{SYSTEM\_USER}}"<br />\| count by Time, %"System User", Task, Target, tenant\_name<br />\| sort by Time<br />\| fields -\_count|
|Workday|Parameterized User Activity|Logs|Workday/Parameterized User Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "sessionId", "activityAction", "deviceType", "tenant\_name"  as Time, ipAddress, %"System User", Task, Target, SessionID, ActivityAction, %"Device Type", tenant\_name nodrop<br />\| if(isBlank(%"Device Type"),"Unknown", %"Device Type") as %"Device Type"<br />\| where  %"System User" matches "{{SYSTEM\_USER}}"<br />\| count by Time, %"System User", Task, Target, tenant\_name<br />\| sort by Time<br />\| fields -\_count|
|Workday|Permission Changes|Logs|Installed Apps/Workday/Workday - System User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where (Task matches "\*Permissions\*" or Task matches "\*Credentials\*") and (ActivityAction = "WRITE" or Task matches "\*Edit\*" or Task matches "\*Delete\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Permission Changes|Logs|Workday/Workday - System User Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where (Task matches "\*Permissions\*" or Task matches "\*Credentials\*") and (ActivityAction = "WRITE" or Task matches "\*Edit\*" or Task matches "\*Delete\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Policy Events|Logs|Workday/Workday - System User Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name<br />\| where Task matches "\*Policy\*" and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Policy Events|Logs|Installed Apps/Workday/Workday - System User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name<br />\| where Task matches "\*Policy\*" and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Recent Activity from Untrusted Devices or by Users with Failed Logins|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}   !api<br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "sessionId", "tenant\_name"  as Time, SystemUser, Task, Target, ActivityAction, Session\_ID, tenant\_name nodrop<br />\| where [subquery from=(-24h): \_sourceCategory={{Logsdatasource}}    <br />  \| json "Session\_ID", "Device\_is\_Trusted" <br />  \| where Device\_is\_Trusted = 0 <br />  \| count by Session\_ID <br />  \| compose Session\_ID<br />] or [subquery from=(-24h): \_sourceCategory={{Logsdatasource}}  <br />  \| json "System\_Account", "Failed\_Signon" as SystemUser, Failed\_Signon<br />  \| where Failed\_Signon = 1 <br />  \| count by SystemUser<br />  \| where \_count \> 1<br />  \| compose SystemUser<br />]<br />\| count by Time, SystemUser, Task, Target, ActivityAction<br />\| sort by Time<br />\| fields -\_count<br />\| limit 20|
|Workday|Recent Activity from Untrusted Devices or by Users with Failed Logins|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\*  !api<br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "sessionId", "tenant\_name"  as Time, SystemUser, Task, Target, ActivityAction, Session\_ID, tenant\_name nodrop<br />\| where [subquery from=(-24h): \_sourceCategory = Labs/Workday\*   <br />  \| json "Session\_ID", "Device\_is\_Trusted" <br />  \| where Device\_is\_Trusted = 0 <br />  \| count by Session\_ID <br />  \| compose Session\_ID<br />] or [subquery from=(-24h): \_sourceCategory = Labs/Workday\* <br />  \| json "System\_Account", "Failed\_Signon" as SystemUser, Failed\_Signon<br />  \| where Failed\_Signon = 1 <br />  \| count by SystemUser<br />  \| where \_count \> 1<br />  \| compose SystemUser<br />]<br />\| count by Time, SystemUser, Task, Target, ActivityAction<br />\| sort by Time<br />\| fields -\_count<br />\| limit 20|
|Workday|Recent Personal Information Changes|Logs|Installed Apps/Workday/Recent Personal Information Changes|\_sourceCategory={{Logsdatasource}}  and ("Change My Personal Information"<br />OR "Edit Disability Active View"<br />OR "Edit Date of Birth Active View"<br />OR "Edit Marital Status Active View"<br />OR "Edit Citizenship Status Active View"<br />OR "Edit Military Service Active View"<br />OR "Edit Social Benefits Locality Active View"<br />OR "Edit Medical Exam Status Active View"<br />OR "Edit Relatives' Names Active View"<br />OR "Edit Ethnicity Active View"<br />OR "Payment Elections"<br />OR "Edit Gender Active View"<br />OR "Organizations for Employment"<br />OR "Benefit Elections"<br />OR "Maintain My Worker Documents"<br />OR "Beneficiaries"<br />OR "Dependents"<br />OR "Change Benefits"<br />OR "Contact Information Profile View"<br />OR "My Emergency Contacts"<br />) <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| count by Time, %"System User", Task, Target, ActivityAction, ipAddress<br /><br />|
|Workday|Recent Personal Information Changes|Logs|Workday/Recent Personal Information Changes|\_sourceCategory = Labs/Workday\* and ("Change My Personal Information"<br />OR "Edit Disability Active View"<br />OR "Edit Date of Birth Active View"<br />OR "Edit Marital Status Active View"<br />OR "Edit Citizenship Status Active View"<br />OR "Edit Military Service Active View"<br />OR "Edit Social Benefits Locality Active View"<br />OR "Edit Medical Exam Status Active View"<br />OR "Edit Relatives' Names Active View"<br />OR "Edit Ethnicity Active View"<br />OR "Payment Elections"<br />OR "Edit Gender Active View"<br />OR "Organizations for Employment"<br />OR "Benefit Elections"<br />OR "Maintain My Worker Documents"<br />OR "Beneficiaries"<br />OR "Dependents"<br />OR "Change Benefits"<br />OR "Contact Information Profile View"<br />OR "My Emergency Contacts"<br />) <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| count by Time, %"System User", Task, Target, ActivityAction, ipAddress<br /><br />|
|Workday|Recent Rest API Activity|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "deviceType", "tenant\_name" as Time, ipAddress, %"System User", Task, ActivityAction, %"Device Type", TenantName nodrop<br />\| parse field=Task "api/\*" as api\_url<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| if(isBlank(%"Device Type"),"Unknown", %"Device Type") as %"Device Type"<br />\| if(api\_url matches "\*GET\*", "GET",  if(api\_url matches "\*POST\*", "POST", "OTHER")) as request\_method<br />\| request\_method as %"Request Method"<br />\| count by Time, %"System User", Task, %"Request Method", %"Device Type"<br />\| sort by Time<br />\| fields -\_count<br />\| limit 50|
|Workday|Recent Rest API Activity|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "deviceType", "tenant\_name" as Time, ipAddress, %"System User", Task, ActivityAction, %"Device Type", TenantName nodrop<br />\| parse field=Task "api/\*" as api\_url<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| if(isBlank(%"Device Type"),"Unknown", %"Device Type") as %"Device Type"<br />\| if(api\_url matches "\*GET\*", "GET",  if(api\_url matches "\*POST\*", "POST", "OTHER")) as request\_method<br />\| request\_method as %"Request Method"<br />\| count by Time, %"System User", Task, %"Request Method", %"Device Type"<br />\| sort by Time<br />\| fields -\_count<br />\| limit 50|
|Workday|Recent Web Service Activity|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}" and Task matches "\*Web Service\*"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Recent Web Service Activity|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}" and Task matches "\*Web Service\*"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Recently Failed Logins|Logs|Workday/Recently Failed Logins|\_sourceCategory = Labs/Workday\* <br />\| json "Session\_Start","System\_Account","Session\_IP\_Address","Request\_Originator","Device\_is\_Trusted","Invalid\_Credentials","Account\_Locked\_\_Disabled\_or\_Expired","Authentication\_Type\_for\_Signon","Session\_ID","Failed\_Signon", "Device\_Type", "tenant\_name" nodrop<br />\| where !isBlank(Failed\_Signon)<br />\| where  Failed\_Signon=1<br />\| count by Session\_Start,System\_Account,Session\_IP\_Address,Request\_Originator,Device\_Type, Device\_is\_Trusted,Invalid\_Credentials,Account\_Locked\_\_Disabled\_or\_Expired,Authentication\_Type\_for\_Signon,Session\_ID, tenant\_name<br />\| fields -\_count<br />\| sort by Session\_Start|
|Workday|Recently Failed Logins|Logs|Installed Apps/Workday/Recently Failed Logins|\_sourceCategory={{Logsdatasource}}  <br />\| json "Session\_Start","System\_Account","Session\_IP\_Address","Request\_Originator","Device\_is\_Trusted","Invalid\_Credentials","Account\_Locked\_\_Disabled\_or\_Expired","Authentication\_Type\_for\_Signon","Session\_ID","Failed\_Signon", "Device\_Type", "tenant\_name" nodrop<br />\| where !isBlank(Failed\_Signon)<br />\| where  Failed\_Signon=1<br />\| count by Session\_Start,System\_Account,Session\_IP\_Address,Request\_Originator,Device\_Type, Device\_is\_Trusted,Invalid\_Credentials,Account\_Locked\_\_Disabled\_or\_Expired,Authentication\_Type\_for\_Signon,Session\_ID, tenant\_name<br />\| fields -\_count<br />\| sort by Session\_Start|
|Workday|Report Changes|Logs|Installed Apps/Workday/Workday - System User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where Task matches "\*Report\*" and (Task matches "\*Edit\*" or Task matches "\*Delete\*" or ActivityAction = "WRITE") and !(%"System User" matches "wd-\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Report Changes|Logs|Workday/Workday - System User Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where Task matches "\*Report\*" and (Task matches "\*Edit\*" or Task matches "\*Delete\*" or ActivityAction = "WRITE") and !(%"System User" matches "wd-\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count|
|Workday|Rest API Calls by URL|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| count as %"Count" by api\_url<br />\| sort by %"Count"|
|Workday|Rest API Calls by URL|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| count as %"Count" by api\_url<br />\| sort by %"Count"|
|Workday|Rest API Requests by Device Type|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "deviceType", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, %"Device Type", TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| if(isBlank(%"Device Type"),"Unknown", %"Device Type") as %"Device Type"<br />\| count as %"Count" by %"Device Type"<br />\| sort by %"Count"|
|Workday|Rest API Requests by Device Type|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "deviceType", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, %"Device Type", TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| if(isBlank(%"Device Type"),"Unknown", %"Device Type") as %"Device Type"<br />\| count as %"Count" by %"Device Type"<br />\| sort by %"Count"|
|Workday|Rest API Requests by Methods|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| if(api\_url matches "\*GET\*", "GET",  if(api\_url matches "\*POST\*", "POST", "OTHER")) as request\_method<br />\| count as %"Count" by request\_method<br />\| sort by %"Count"|
|Workday|Rest API Requests by Methods|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| if(api\_url matches "\*GET\*", "GET",  if(api\_url matches "\*POST\*", "POST", "OTHER")) as request\_method<br />\| count as %"Count" by request\_method<br />\| sort by %"Count"|
|Workday|Security Group Changes|Logs|Installed Apps/Workday/Workday - System User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where Task matches "\*Security Group\*" and (ActivityAction = "WRITE"  OR Task matches "\*Edit\*" OR Task matches "\*Delete\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target, ActivityAction<br />\| sort by Time<br />\| fields -\_count|
|Workday|Security Group Changes|Logs|Workday/Workday - System User Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where Task matches "\*Security Group\*" and (ActivityAction = "WRITE"  OR Task matches "\*Edit\*" OR Task matches "\*Delete\*") and Task matches "{{Task}}" and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}"<br />\| count by Time, %"System User", Task, Target, ActivityAction<br />\| sort by Time<br />\| fields -\_count|
|Workday|Successful Logins|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Failed\_Signon", "tenant\_name"  nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}" <br />\| where Failed\_Signon=0<br />\| count|
|Workday|Successful Logins|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Failed\_Signon","tenant\_name" nodrop<br />\| where Failed\_Signon = 0 and !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count|
|Workday|Successful Logins|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\* <br />\| json "System\_Account", "Session\_IP\_Address", "Failed\_Signon", "tenant\_name"  nodrop<br />\| where !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and System\_Account matches "{{SystemUser}}" <br />\| where Failed\_Signon=0<br />\| count|
|Workday|Successful Logins|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "System\_Account", "Session\_IP\_Address", "Request\_Originator","Failed\_Signon","tenant\_name" nodrop<br />\| where Failed\_Signon = 0 and !(System\_Account matches "wd-\*") and Session\_IP\_Address matches "{{SessionIPAddress}}" and System\_Account matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and Request\_Originator matches "{{RequestOriginator}}"<br />\| count|
|Workday|Top 10 Client IPs|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| count by ipAddress<br />\| top 10 ipAddress by \_count<br />\| \_count as %"Count"<br />\| fields -\_count|
|Workday|Top 10 Client IPs|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, TenantName nodrop<br />\| where !(%"System User" matches "wd-\*") and ipAddress matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and TenantName matches "{{TenantName}}"<br />\| parse field=Task "api/\*" as api\_url<br />\| count by ipAddress<br />\| top 10 ipAddress by \_count<br />\| \_count as %"Count"<br />\| fields -\_count|
|Workday|Top 10 Downloaded Tasks|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}"  and activityAction = "DOWNLOAD"<br />\| count as %"Count" by Task<br />\| sort by %"Count"|
|Workday|Top 10 Executed Reports|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\* executeCustomReport<br />\| json "ipAddress", "systemAccount", "target.descriptor", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Target, Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br /> and Task matches "executeCustomReport\*"<br />\| Target as %"Report Name"<br />\| count as %"Count" by %"Report Name"<br />\| top 10 %"Report Name" by %"Count"|
|Workday|Top 10 Malicious System Users|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as  ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=ipAddress<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count as %"Count" by %"System User"<br />\| top 10 %"System User" by %"Count"<br /><br />|
|Workday|Top 10 Malicious User Agents|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json  "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "userAgent", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, %"User Agents", tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br />\| if (isBlank(%"User Agents"), "Unknown", %"User Agents") as %"User Agents" <br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=ipAddress<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count as %"Count" by %"User Agents"<br />\| top 10 %"User Agents" by %"Count" <br />|
|Workday|Top 10 Tasks|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br />\| count as %"Count" by Task<br />\| top 10 Task by %"Count"<br />|
|Workday|Top 10 User Agents|Logs|Installed Apps/Workday/Workday - Login Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "sessionId", "activityAction", "deviceType", "userAgent", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, SessionID, ActivityAction, DeviceType, %"User Agent", tenant\_name nodrop<br />\| where %"System User" matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and ipAddress matches "{{SessionIPAddress}}"<br />\| if(isBlank(%"User Agent"), "Unknown", %"User Agent") as %"User Agent" <br />\| count as %"Count" by %"User Agent"<br />\| top 10 %"User Agent" by %"Count"|
|Workday|Top 10 User Agents|Logs|Workday/Workday - Login Activity|\_sourceCategory = Labs/Workday\* <br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "sessionId", "activityAction", "deviceType", "userAgent", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, SessionID, ActivityAction, DeviceType, %"User Agent", tenant\_name nodrop<br />\| where %"System User" matches "{{SystemUser}}" and tenant\_name matches "{{TenantName}}" and ipAddress matches "{{SessionIPAddress}}"<br />\| if(isBlank(%"User Agent"), "Unknown", %"User Agent") as %"User Agent" <br />\| count as %"Count" by %"User Agent"<br />\| top 10 %"User Agent" by %"Count"|
|Workday|Top 10 Users|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name" as ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}"<br />\| count as %"Count" by %"System User"<br />\| top 10  %"System User" by %"Count"|
|Workday|Update Activity|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\*<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and (Task matches "\*Update\*" or Task matches "\*Edit\*" or Task matches "\*Move\*" or Task matches "\*Reassign\*")<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count<br />\| limit 50|
|Workday|View Activity|Logs|Workday/Workday - User Activity|\_sourceCategory = Labs/Workday\* View<br />\| json "requestTime", "ipAddress", "systemAccount", "taskDisplayName", "target.descriptor", "activityAction", "tenant\_name" as Time, ipAddress, %"System User", Task, Target, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and !(%"System User" matches "wd-\*") and tenant\_name matches "{{TenantName}}" and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction matches "{{ActivityAction}}" and Task matches "\*View\*"<br />\| count by Time, %"System User", Task, Target<br />\| sort by Time<br />\| fields -\_count<br />\| limit 50|
|Workday|Web Services Logins|Logs|Workday/Workday - API Activity|\_sourceCategory = Labs/Workday\*<br />\| json "Request\_Originator", "System\_Account", "Authentication\_Type\_for\_Signon", "Session\_IP\_Address", "tenant\_name" as %"Request Originator", %"System User", %"Authentication Type", session\_ip\_address, TenantName nodrop<br />\| where  !(%"System User" matches "wd-\*") and session\_ip\_address matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and %"Request Originator" = "Web Services" and TenantName matches "{{TenantName}}" <br />\| count as %"Count" by %"System User", %"Authentication Type"<br />\| sort by %"Count"<br /><br />|
|Workday|Web Services Logins|Logs|Installed Apps/Workday/Workday - API Activity|\_sourceCategory={{Logsdatasource}} <br />\| json "Request\_Originator", "System\_Account", "Authentication\_Type\_for\_Signon", "Session\_IP\_Address", "tenant\_name" as %"Request Originator", %"System User", %"Authentication Type", session\_ip\_address, TenantName nodrop<br />\| where  !(%"System User" matches "wd-\*") and session\_ip\_address matches "{{IPAddress}}" and %"System User" matches "{{SystemUser}}" and %"Request Originator" = "Web Services" and TenantName matches "{{TenantName}}" <br />\| count as %"Count" by %"System User", %"Authentication Type"<br />\| sort by %"Count"<br /><br />|
|Workday|Write Activity by Task|Logs|Installed Apps/Workday/Workday - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name"  as  ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and !(%"System User" matches "wd-\*") and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction = "WRITE"<br />\| count by Task|
|Workday|Write Activity by Task|Logs|Workday/Workday - Overview|\_sourceCategory = Labs/Workday\* <br />\| json "ipAddress", "systemAccount", "taskDisplayName", "activityAction", "tenant\_name"  as  ipAddress, %"System User", Task, ActivityAction, tenant\_name nodrop<br />\| where ipAddress matches "{{IPAddress}}" and tenant\_name matches "{{TenantName}}" and !(%"System User" matches "wd-\*") and %"System User" matches "{{SystemUser}}" and Task matches "{{Task}}" and ActivityAction = "WRITE"<br />\| count by Task|

