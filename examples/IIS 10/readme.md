# IIS 10
## Sumo Logic App For: IIS 10
The IIS app is a unified logs and metrics app that helps you monitor the availability, performance, health and resource utilization of your IIS web servers. Preconfigured dashboards and searches provide insight into application pools, ASP.NET applications, requests, latency, visitor locations, visitor access types, traffic patterns, errors, web server operations and access from known malicious sources.
Docs Link: [IIS 10](https://help.sumologic.com/?cid=211231)

## Searches

### Log Searches

- **4xx Errors - Client Locations**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **4xx Status Codes by Server**: from Dashboard: IIS 10/IIS - Overview 
- **5xx Status Codes by Server**: from Dashboard: IIS 10/IIS - Overview 
- **Active Connections**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Active Connections**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Anonymous Users**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Anonymous Users**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Arrival Rate**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Arrival Rate**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Average Redirection Time**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Average Response Time**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Avg. Response Time**: from Dashboard: IIS 10/IIS - Overview 
- **Browsers and Operating Systems**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Bytes Received Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Bytes Sent Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Cache Hit Rate**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Cache Hit Rate**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **CGI Requests Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Client and Server Errors**: from Dashboard: IIS 10/IIS - Overview 
- **Client Error Outliers**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Client Errors by Server**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Client OS Platforms**: from Dashboard: IIS 10/IIS - Overview 
- **Counters_HTTPServiceRequestQueues Log Parser**: from Search: IIS 10/Logs/Searches/Counters_HTTPServiceRequestQueues Log Parser 
- **Cumulative Client Request Percentiles**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Cumulative Response Time Percentiles**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Cumulative User Request Percentiles**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Delete Requests**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Desktop OS Version**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Error Events**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Files Received Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Files Sent Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Get Requests**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Get Requests Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Get Requests Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Highly Malicious Threat Table**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Threat Analysis 
- **HTTP Methods**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights 
- **IIS - All HTTP Response Codes with their Count**: from Search: IIS 10/Logs/Searches/IIS - All HTTP Response Codes with their Count 
- **IIS - Client Errors (4xx response codes) per Day**: from Search: IIS 10/Logs/Searches/IIS - Client Errors (4xx response codes) per Day 
- **IIS - HTTP Status Code Summary over time**: from Search: IIS 10/Logs/Searches/IIS - HTTP Status Code Summary over time 
- **IIS - Malicious URL Requests**: from Search: IIS 10/Logs/Searches/IIS - Malicious URL Requests 
- **IIS - Robots**: from Search: IIS 10/Logs/Searches/IIS - Robots 
- **IIS - Slowest URLs by Average Time**: from Search: IIS 10/Logs/Searches/IIS - Slowest URLs by Average Time 
- **IIS - Time Taken to Serve Requests**: from Search: IIS 10/Logs/Searches/IIS - Time Taken to Serve Requests 
- **IIS - Top 404 URLs**: from Search: IIS 10/Logs/Searches/IIS - Top 404 URLs 
- **IIS - Top Browsers**: from Search: IIS 10/Logs/Searches/IIS - Top Browsers 
- **IIS - Top Clients**: from Search: IIS 10/Logs/Searches/IIS - Top Clients 
- **IIS - Top Clients Causing Errors**: from Search: IIS 10/Logs/Searches/IIS - Top Clients Causing Errors 
- **IIS - Top URLs by Count**: from Search: IIS 10/Logs/Searches/IIS - Top URLs by Count 
- **IIS - Traffic Volume Served per Day**: from Search: IIS 10/Logs/Searches/IIS - Traffic Volume Served per Day 
- **IIS Site Uptime**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **ISAPI Extension Requests Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Media Types Served**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights 
- **Method**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Non 200 Response Status Codes**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Non Anonymous Users**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **NonAnonymous Users**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Number of Requests - Time Compare**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Popular Mobile Device Versions**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Post Requests**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Post Requests Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Post Requests Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Put Requests**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Queue Size**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Queue Size**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Reason Phrase - Time Compare**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Redirections by Server**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Rejection Rate**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Request Outlier**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Requests**: from Dashboard: IIS 10/IIS - Overview 
- **Requests**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Requests by App Over Time**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Requests Per Sec (All methods)**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Trends 
- **Requests Stats by Client IP**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Requests Stats by Server**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **Response Codes Over Time**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Response Time (Avg) by Server**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Response Time (Avg) Outlier**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Response Time Histogram**: from Dashboard: IIS 10/IIS - Overview 
- **Response Time Histogram**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Server Error Outliers**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Server Errors by Server**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Server Errors Over Time**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Site Uptime**: from Dashboard: IIS 10/IIS - Overview 
- **Threat Breakdown by Sources**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Threat Analysis 
- **Threat by Actors**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Threat Analysis 
- **Threat by Malicious Confidence**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Threat Analysis 
- **Threat Count**: from Dashboard: IIS 10/IIS - Overview 
- **Threat Count**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Threat Analysis 
- **Threat Location**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Threat Analysis 
- **Threat Table**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Threat Analysis 
- **Top 10 Bots Observed**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Top 10 Queries**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights 
- **Top 10 Slowest Pages**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Top 10 URLs Facing 404 Errors**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Top 10 URLs with 4xx Errors**: from Dashboard: IIS 10/IIS - Overview 
- **Top 10 URLs with 5xx Errors**: from Dashboard: IIS 10/IIS - Overview 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Top 5 Highly Malicious URLs**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Threat Analysis 
- **Top 5 Referrers**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights 
- **Top 5 URLs**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights 
- **Top Apps by Request**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Top Apps by Request**: from Dashboard: IIS 10/IIS - Overview 
- **Top Client IPs**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Top Cooked URL and Query**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Top Protocol Status**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Top Protocol Versions**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Top Reason Phrase**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Top Request Details by Reason**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Top Requests by Users**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Top Server Errors by Server**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Web Server Operations 
- **Top Server IPs**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Top Slowest Get Requests**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Top Slowest Post Requests**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Top Verbs**: from Dashboard: IIS 10/Logs/Server Operations/IIS - HTTP Error 
- **Total Bytes Transferred Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Total Requests Per Sec**: from Dashboard: IIS 10/Logs/Performance/IIS - Performance Snapshot 
- **Traffic Distribution by Server**: from Dashboard: IIS 10/Logs/Server Operations/IIS - Latency 
- **Unique Visitors**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Unique Visitors Outlier**: from Dashboard: IIS 10/Logs/Server Operations/The IIS - Requests Stats 
- **US Visitors**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Locations 
- **Visitor Location**: from Dashboard: IIS 10/IIS - Overview 
- **Visitor Platforms**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Visitors by US Region Over Time**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Locations 
- **Visitors Platforms Over Time**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types 
- **Visits by Country Over Time**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Locations 
- **W3SVC_WebService Log Parser**: from Search: IIS 10/Logs/Searches/W3SVC_WebService Log Parser 
- **Worldwide Visitors**: from Dashboard: IIS 10/Logs/Traffic Insights/IIS - Visitor Locations

### Metric Searches

- **Anonymous Users Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Application Pool State**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Application Pools**: from Dashboard: IIS 10/IIS - Overview 
- **Applications Restarts**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **Applications Running Over Time**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **ASP.NET Requests**: from Dashboard: IIS 10/IIS - Overview 
- **Avg. Cache Hit Rate**: from Dashboard: IIS 10/IIS - Overview 
- **Avg. Requests Per Sec**: from Dashboard: IIS 10/IIS - Overview 
- **Bytes Received Per Sec (Bytes)**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Bytes Sent Per Sec (Bytes)**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Cache Hit Ratio**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Cache Total Entries**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Cache Turnover Rate**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Compilations Total**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Connections Over Time**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Current Application Pool Uptime (Days)**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Current Blocked Async I/O Requests**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Current CGI Requests**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Current Connections**: from Dashboard: IIS 10/IIS - Overview 
- **Current Flushed Items**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Current ISAPI Extension Requests**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Current Items**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Current Memory Usage (MB)**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Current Metadata Cached**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Current Non-Anonymous Users**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Current Queue Size**: from Dashboard: IIS 10/IIS - Overview 
- **Current Requests**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **Current URIs Cached**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Current Worker Processes**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Data Received and Sent**: from Dashboard: IIS 10/IIS - Overview 
- **Delete Pending**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Delete Requests Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Disabled**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Disabling**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Errors Total Per Sec**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **File Cache Flushes**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **File Cache Hits**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **File Cache Hits/Miss Ratio**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **File Cache Memory Usage**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **File Cache Memory Usage Avg**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **File Cache Memory Usage Total**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **File Cache Misses**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Files Received**: from Dashboard: IIS 10/IIS - Overview 
- **Files Received Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Files Sent Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Get Requests Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Initialized**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Max Worker Processes**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Maximum File Cache Memory Usage**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Metadata Cache Flushes**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Metadata Cache Hits**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Metadata Cache Hits/Miss Ratio**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Metadata Cache Misses**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Options Requests Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Output Cache Entries**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Output Cache Hit Ratio**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Output Cache Hits**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Output Cache Hits/Miss Ratio**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Output Cache Turnover Rate**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Pipeline Instance Count**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Post Requests Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Put Requests Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Queue Rejected Requests**: from Dashboard: IIS 10/IIS - Overview 
- **Recent Worker Process Failures**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Rejected Requests**: from Dashboard: IIS 10/IIS - Overview 
- **Request Execution Time**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **Request Wait Time**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **Requests Executing**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Requests in Application Queue**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Requests Per Sec**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET Applications 
- **Requests Per Sec (All methods)**: from Dashboard: IIS 10/IIS - Overview 
- **Requests Queued**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **Requests Rejected**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **Running**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Shutdown Pending**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Site Uptime**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Sites**: from Dashboard: IIS 10/IIS - Overview 
- **State Server Sessions Abandoned**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **State Server Sessions Active**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **State Server Sessions Timed Out**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **State Server Sessions Total**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **Total Application Pool Recycles**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Total Blocked Async I/O Requests**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total CGI Requests**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Connection Attempts All Instances**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Files Cached**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total Files Flushed**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total Flushed Items**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total Flushed Metadata**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total Flushed URIs**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total Locked Errors**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Logon Attempts**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Metadata Cache Flushed**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total Metadata Cached**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total Method Requests**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Method Requests Per Sec**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Non-Anonymous Users**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Not Found Errors**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Rejected Async I/O Requests**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total Site**: from Dashboard: IIS 10/Metrics/IIS - Web Service 
- **Total URIs Cached**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total URIs Flushes**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Total Worker Processes Created**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Total Worker Processes Failures**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Total Worker Processes Ping Failures**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Total Worker Processes Shutdown Failures**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Total Worker Processes Startup Failures**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Uninitialized**: from Dashboard: IIS 10/Metrics/IIS - Application Pool 
- **Uptime (Days)**: from Dashboard: IIS 10/IIS - Overview 
- **URI Cache Flushes**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **URI Cache Hits**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **URI Cache Hits/Miss Ratio**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **URI Cache Misses**: from Dashboard: IIS 10/Metrics/IIS - Cache Performance 
- **Worker Process Restarts**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET 
- **Worker Processes Running**: from Dashboard: IIS 10/Metrics/IIS - ASP.NET

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|IIS 10/Logs/Server Operations|4xx Errors - Client Locations|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 4\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|IIS 10|4xx Status Codes by Server|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| count as count by sc\_status, host, webserver\_farm|
|IIS 10|5xx Status Codes by Server|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "5\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| count as count by sc\_status, host, webserver\_farm|
|IIS 10/Logs/Performance|Active Connections|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService CurrentConnections \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CurrentConnections = \*;" as CurrentConnections<br />\| withtime CurrentConnections <br />\| most\_recent(CurrentConnections\_withtime) as Current, min(CurrentConnections) as Min, max(CurrentConnections) as Max, avg(CurrentConnections) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Logs/Performance|Active Connections|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService CurrentConnections \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CurrentConnections = \*;" as CurrentConnections<br />\| timeslice 1m<br />\| sum(CurrentConnections) by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Logs/Performance|Anonymous Users|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService CurrentAnonymousUsers \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CurrentAnonymousUsers = \*;" as CurrentAnonymousUsers<br />\| withtime CurrentAnonymousUsers <br />\| most\_recent(CurrentAnonymousUsers\_withtime) as Current, min(CurrentAnonymousUsers) as Min, max(CurrentAnonymousUsers) as Max, avg(CurrentAnonymousUsers) as Avg  by Name<br />\| sort by Current, Name asc|
|IIS 10/Logs/Performance|Anonymous Users|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService CurrentAnonymousUsers \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CurrentAnonymousUsers = \*;" as CurrentAnonymousUsers<br />\| timeslice 1m<br />\| sum(CurrentAnonymousUsers) as CurrentAnonymousUsers by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Metrics|Anonymous Users Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Anonymous\_Users\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Application Pool State|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State  webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| parse field=instance \* as app\_pool\_instance \| sum by webserver\_farm, host, app\_pool\_instance|
|IIS 10|Application Pools|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State  webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm, host, <br />instance \| count|
|IIS 10/Metrics|Applications Restarts|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Application\_Restarts objectname=asp.net webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Applications Running Over Time|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Applications\_Running objectname=asp.net  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Logs/Performance|Arrival Rate|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues ArrivalRate \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "ArrivalRate = \\"\*\\";" as ArrivalRate<br />\| withtime ArrivalRate <br />\| most\_recent(ArrivalRate\_withtime) as Current, min(ArrivalRate) as Min, max(ArrivalRate) as Max, avg(ArrivalRate) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Logs/Performance|Arrival Rate|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues ArrivalRate \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "ArrivalRate = \\"\*\\";" as ArrivalRate<br />\| timeslice 1m<br />\| avg(ArrivalRate) as avgArrivalRate by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10|ASP.NET Requests|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Requests\_Current objectname=asp.net webserver\_farm={{webserver\_farm}} \| sum by metric|
|IIS 10/Logs/Server Operations|Average Redirection Time|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 3\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "3\*"<br />\| avg(time\_taken) as AvgResponseTime|
|IIS 10/Logs/Server Operations|Average Response Time|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| avg(time\_taken) as AvgResponseTime|
|IIS 10|Avg. Cache Hit Rate|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_\*\_Cache\_Hits\_Percent webserver\_farm={{webserver\_farm}} \| avg|
|IIS 10|Avg. Requests Per Sec|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Method\_Requests\_persec webserver\_farm={{webserver\_farm}} \| avg|
|IIS 10|Avg. Response Time|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| sum(time\_taken) as sum\_time\_taken, count as count\_request<br />\| sum\_time\_taken/count\_request as avg\_time\_taken<br />\| fields avg\_time\_taken|
|IIS 10/Logs/Traffic Insights|Browsers and Operating Systems|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if (cs\_User\_Agent matches "\*Windows \*" OR cs\_User\_Agent matches "\*Win32\*" OR cs\_User\_Agent matches "\*Win64\*","Windows","") as OS <br />\| if (cs\_User\_Agent matches "\*Macintosh\*" OR cs\_User\_Agent matches "\*Darwin/\*" OR cs\_User\_Agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (cs\_User\_Agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (cs\_User\_Agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (cs\_User\_Agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (cs\_User\_Agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Android\*","Android",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (cs\_User\_Agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (cs\_User\_Agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (cs\_User\_Agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (cs\_User\_Agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND cs\_User\_Agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (cs\_User\_Agent matches "\*Mobile/\*" OR cs\_User\_Agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND cs\_User\_Agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (cs\_User\_Agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (cs\_User\_Agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (cs\_User\_Agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (cs\_User\_Agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser  <br />\| count by OS,browser<br />\| transpose row Browser column OS|
|IIS 10/Logs/Performance|Bytes Received Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService BytesReceivedPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "BytesReceivedPersec = \\"\*\\";" as BytesReceivedPersec<br />\| timeslice 1m<br />\| avg(BytesReceivedPersec) as avgBytesReceivedPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Metrics|Bytes Received Per Sec (Bytes)|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Bytes\_Received\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Performance|Bytes Sent Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService BytesSentPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "BytesSentPersec = \\"\*\\";" as BytesSentPersec<br />\| timeslice 1m<br />\| avg(BytesSentPersec) as avgBytesSentPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Metrics|Bytes Sent Per Sec (Bytes)|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Bytes\_Sent\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Performance|Cache Hit Rate|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues CacheHitRate \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CacheHitRate = \\"\*\\";" as CacheHitRate<br />\| withtime CacheHitRate <br />\| most\_recent(CacheHitRate\_withtime) as Current, min(CacheHitRate) as Min, max(CacheHitRate) as Max, avg(CacheHitRate) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Logs/Performance|Cache Hit Rate|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues CacheHitRate \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CacheHitRate = \\"\*\\";" as CacheHitRate<br />\| timeslice 1m<br />\| avg(CacheHitRate) as avgCacheHitRate by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Metrics|Cache Hit Ratio|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Cache\_Total\_Hit\_Ratio webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance \| eval \_value/100|
|IIS 10/Metrics|Cache Total Entries|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Cache\_Total\_Entries webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Cache Turnover Rate|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Cache\_Total\_Turnover\_Rate webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Performance|CGI Requests Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService CGIRequestsPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CGIRequestsPersec = \*;" as CGIRequestsPersec<br />\| timeslice 1m<br />\| avg(CGIRequestsPersec) as avgCGIRequestsPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10|Client and Server Errors|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where (sc\_status matches "5\*" or sc\_status matches "4\*")<br />\| count as ErrorCount|
|IIS 10/Logs/Server Operations|Client Error Outliers|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 4\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "4\*"<br />\| timeslice 1m<br />\| count as Requests by \_timeslice<br />\| outlier Requests window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10/Logs/Server Operations|Client Errors by Server|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 4\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count as count by server\_ip, sc\_status<br />\| transpose row server\_ip column sc\_status as \* |
|IIS 10|Client OS Platforms|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by cs\_User\_Agent<br />\| if (cs\_User\_Agent matches "\*iPad\*" or cs\_User\_Agent matches "\*iPhone\*" or cs\_User\_Agent matches "\*BlackBerry\*" or cs\_User\_Agent matches "\*SAMSUNG\*" or cs\_User\_Agent matches "\*Galaxy\*" or cs\_User\_Agent matches "\*Windows Phone\*" or cs\_User\_Agent matches "\*Android\*","Mobile","PC") as type<br />\| if (cs\_User\_Agent matches "\*Macintosh\*" or (cs\_User\_Agent matches "\*iMac\*"),"Mac",type) as type<br />\| count type<br />\| sort by \_count, type asc|
|IIS 10/Metrics|Compilations Total|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Compilations\_Total webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Connections Over Time|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Current\_Connections webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Searches|Counters\_HTTPServiceRequestQueues Log Parser|Logs|IIS 10/Logs/Searches/Counters\_HTTPServiceRequestQueues Log Parser|\_sourceCategory = Labs/iis\* webserver\_system=iis Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name nodrop<br />\| parse field=iis\_log\_message "ArrivalRate = \\"\*\\";" as ArrivalRate nodrop<br />\| parse field=iis\_log\_message "CacheHitRate = \\"\*\\";" as CacheHitRate nodrop<br />\|	parse field=iis\_log\_message "CurrentQueueSize = \*;" as CurrentQueueSize nodrop<br />\|	parse field=iis\_log\_message "MaxQueueItemAge = \\"\*\\";" as MaxQueueItemAge nodrop<br />\|	parse field=iis\_log\_message "RejectionRate = \\"\*\\";" as RejectionRate nodrop|
|IIS 10/Logs/Traffic Insights|Cumulative Client Request Percentiles|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count as Requests by c\_ip \| sort -Requests <br />\| pct(requests,50) as Pct50, pct(requests,55) as Pct55, pct(requests,60) as Pct60, pct(requests,65) as Pct65, pct(requests,70) as Pct70, pct(requests,75) as Pct75, pct(requests,80) as Pct80, pct(requests,85) as Pct85, pct(requests,90) as Pct90, pct(requests,95) as Pct95, pct(requests,98) as Pct98, pct(requests,100) as Pct100|
|IIS 10/Logs/Server Operations|Cumulative Response Time Percentiles|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| avg(time\_taken) as time\_taken by cs\_uri\_stem \| fields time\_taken<br />\| pct(time\_taken,50) as Pct50, pct(time\_taken,55) as Pct55, pct(time\_taken,60) as Pct60, pct(time\_taken,65) as Pct65, pct(time\_taken,70) as Pct70, pct(time\_taken,75) as Pct75, pct(time\_taken,80) as Pct80, pct(time\_taken,85) as Pct85, pct(time\_taken,90) as Pct90, pct(time\_taken,95) as Pct95, pct(time\_taken,98) as Pct98, pct(time\_taken,100) as Pct100|
|IIS 10/Logs/Traffic Insights|Cumulative User Request Percentiles|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as Requests by cs\_username \| where cs\_username != "-" \| sort -Requests <br />\| pct(requests,50) as Pct50, pct(requests,55) as Pct55, pct(requests,60) as Pct60, pct(requests,65) as Pct65, pct(requests,70) as Pct70, pct(requests,75) as Pct75, pct(requests,80) as Pct80, pct(requests,85) as Pct85, pct(requests,90) as Pct90, pct(requests,95) as Pct95, pct(requests,98) as Pct98, pct(requests,100) as Pct100|
|IIS 10/Metrics|Current Application Pool Uptime (Days)|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_Uptime webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| parse field=instance \* as app\_pool\_instance \| sum by webserver\_farm, host, <br />app\_pool\_instance \| eval \_value/86400|
|IIS 10/Metrics|Current Blocked Async I/O Requests|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Current\_Blocked\_Async\_I\_O\_Requests webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Current CGI Requests|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Current\_CGI\_Requests webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10|Current Connections|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Current\_Connections webserver\_farm={{webserver\_farm}} \| sum by metric|
|IIS 10/Metrics|Current Flushed Items|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Output\_Cache\_Current\_Flushed\_Items  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Current ISAPI Extension Requests|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Current\_ISAPI\_Extension\_Requests webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Current Items|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Output\_Cache\_Current\_Items webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Current Memory Usage (MB)|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Output\_Cache\_Current\_Memory\_Usage webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host\| eval \_value/1024|
|IIS 10/Metrics|Current Metadata Cached|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Current\_Metadata\_Cached webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Current Non-Anonymous Users|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Current\_NonAnonymous\_Users webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10|Current Queue Size|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_http\_queues\_CurrentQueueSize webserver\_farm={{webserver\_farm}} \|  parse field=instance \* as app\_pool\_instance \| sum by webserver\_farm, host, <br />app\_pool\_instance|
|IIS 10/Metrics|Current Requests|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Requests\_Current objectname=asp.net webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm,host|
|IIS 10/Metrics|Current URIs Cached|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Current\_URIs\_Cached webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Current Worker Processes|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Worker\_Processes webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by webserver\_farm, host, instance|
|IIS 10|Data Received and Sent|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Bytes\_Received\_persec webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Delete Pending|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| filter latest = 7 \| count|
|IIS 10/Logs/Server Operations|Delete Requests|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} DELETE<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method = "DELETE"<br />\| timeslice 1m<br />\| count by \_timeslice|
|IIS 10/Metrics|Delete Requests Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Delete\_Requests\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Traffic Insights|Desktop OS Version|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} ("macintosh" OR "mac os" OR "windows" OR "i686" or "PC" or ("Linux" AND !android))<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if (cs\_User\_Agent matches "\*Windows NT\*" or cs\_User\_Agent matches "\*Windows+NT\*" or cs\_User\_Agent matches "\*Windows \*" or cs\_User\_Agent matches "\*Win32\*" or cs\_User\_Agent matches "\*Win64\*", "Windows", "Other") as OS <br />\| if (cs\_User\_Agent matches "\*Macintosh\*","MacOS",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Windows Phone\*" or cs\_User\_Agent matches "\*Windows+Phone\*","Windows Phone",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (cs\_User\_Agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (cs\_User\_Agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Android\*","Android",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Darwin\*","Darwin",OS) as OS <br />\| if (cs\_User\_Agent matches "\*CrOS\*","Google Chrome",OS) as OS <br />\| where OS \<\> "Other"<br />\| parse regex field=cs\_User\_Agent "(?\<os\>Windows)\\+NT\\+(?\<version\>[\\d.]+?)(?:;\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<os\>Mac OS)\\+(?\<version\>[X\\+\\d.\\\_]+?)(?:;\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<os\>Linux)\\+(?\<version\>[x\\d.\\\_]+?)(?:;\|\\))" nodrop <br />\| where os != ""<br />\| count as count by os, version<br />\| transpose row Version column Os|
|IIS 10/Metrics|Disabled|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| filter latest = 5 \| count|
|IIS 10/Metrics|Disabling|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| filter latest = 4 \| count|
|IIS 10/Logs/Server Operations|Error Events|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count|
|IIS 10/Metrics|Errors Total Per Sec|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Errors\_Total\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|File Cache Flushes|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_File\_Cache\_Flushes webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|File Cache Hits|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_File\_Cache\_Hits webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|File Cache Hits/Miss Ratio|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_File\_Cache\_Hits\_Percent webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host \| eval \_value/100|
|IIS 10/Metrics|File Cache Memory Usage|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Current\_File\_Cache\_Memory\_Usage webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|File Cache Memory Usage Avg|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Current\_File\_Cache\_Memory\_Usage webserver\_farm={{webserver\_farm}} host={{host}} \| avg by metric \| eval \_value/1024|
|IIS 10/Metrics|File Cache Memory Usage Total|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Current\_File\_Cache\_Memory\_Usage webserver\_farm={{webserver\_farm}} host={{host}} \| sum by metric \| eval \_value/1024|
|IIS 10/Metrics|File Cache Misses|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_File\_Cache\_Misses webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10|Files Received|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Files\_Received webserver\_farm={{webserver\_farm}} \| sum by metric|
|IIS 10/Logs/Performance|Files Received Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService FilesReceivedPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "FilesReceivedPersec = \*;" as FilesReceivedPersec<br />\| timeslice 1m<br />\| avg(FilesReceivedPersec) as avgFilesReceivedPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Metrics|Files Received Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Files\_Received\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Files Sent Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Files\_Sent\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Performance|Files Sent Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService FilesSentPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "FilesSentPersec = \*;" as FilesSentPersec<br />\| timeslice 1m<br />\| avg(FilesSentPersec) as avgFilesSentPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Logs/Server Operations|Get Requests|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method = "GET"<br />\| timeslice 1m<br />\| count by \_timeslice|
|IIS 10/Logs/Performance|Get Requests Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService GetRequestsPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "GetRequestsPersec = \*;" as GetRequestsPersec<br />\| withtime GetRequestsPersec <br />\| most\_recent(GetRequestsPersec\_withtime) as Current, min(GetRequestsPersec) as Min, max(GetRequestsPersec) as Max, avg(GetRequestsPersec) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Logs/Performance|Get Requests Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService GetRequestsPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "GetRequestsPersec = \*;" as GetRequestsPersec<br />\| timeslice 1m<br />\| avg(GetRequestsPersec) as avgGetRequestsPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Metrics|Get Requests Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Get\_Requests\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Traffic Insights|Highly Malicious Threat Table|Logs|IIS 10/Logs/Traffic Insights/IIS - Threat Analysis|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count c\_ip, sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| where malicious\_confidence matches "high"<br />\| count by malicious\_confidence, Actor,c\_ip, sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />\| sort by \_count<br />\| \_count as count<br />\| limit 20<br />\| fields malicious\_confidence, Actor, c\_ip,sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />|
|IIS 10/Logs/Traffic Insights|HTTP Methods|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by method|
|IIS 10/Logs/Searches|IIS - All HTTP Response Codes with their Count|Logs|IIS 10/Logs/Searches/IIS - All HTTP Response Codes with their Count|\_sourceCategory = Labs/iis\* webserver\_system=iis <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by sc\_status <br />\| sort by \_count|
|IIS 10/Logs/Searches|IIS - Client Errors (4xx response codes) per Day|Logs|IIS 10/Logs/Searches/IIS - Client Errors (4xx response codes) per Day|\_sourceCategory = Labs/iis\* webserver\_system=iis 4\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "4\*" <br />\| timeslice by 1d <br />\| count by \_timeslice<br />\| sort by \_timeslice|
|IIS 10/Logs/Searches|IIS - HTTP Status Code Summary over time|Logs|IIS 10/Logs/Searches/IIS - HTTP Status Code Summary over time|\_sourceCategory = Labs/iis\* webserver\_system=iis<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors <br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1d <br />\| sum(successes) as successes, sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by \_timeslice|
|IIS 10/Logs/Searches|IIS - Malicious URL Requests|Logs|IIS 10/Logs/Searches/IIS - Malicious URL Requests|\_sourceCategory = Labs/iis\* webserver\_system=iis ("jsessionid" or "old" or "bak") <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where cs\_uri\_stem matches "\*.old" or cs\_uri\_stem matches "\*.bak" or cs\_uri\_query matches "\*jsessionid=\*"|
|IIS 10/Logs/Searches|IIS - Robots|Logs|IIS 10/Logs/Searches/IIS - Robots|\_sourceCategory = Labs/iis\* webserver\_system=iis "/robots.txt" <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where cs\_uri\_stem = "/robots.txt"<br />\| count\_frequent cs\_User\_Agent|
|IIS 10/Logs/Searches|IIS - Slowest URLs by Average Time|Logs|IIS 10/Logs/Searches/IIS - Slowest URLs by Average Time|\_sourceCategory = Labs/iis\* webserver\_system=iis <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| (time\_taken/1000) as seconds <br />\| avg(seconds) as avgtimeinseconds by cs\_uri\_stem <br />\| sort by avgtimeinseconds <br />\| limit 100|
|IIS 10/Logs/Searches|IIS - Time Taken to Serve Requests|Logs|IIS 10/Logs/Searches/IIS - Time Taken to Serve Requests|\_sourceCategory = Labs/iis\* webserver\_system=iis <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"  <br />\| (time\_taken/1000) as seconds <br />\| seconds/60 as minutes |
|IIS 10/Logs/Searches|IIS - Top 404 URLs|Logs|IIS 10/Logs/Searches/IIS - Top 404 URLs|\_sourceCategory = Labs/iis\* webserver\_system=iis 404<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "404" <br />\| count\_frequent cs\_uri\_stem <br />\| limit 100|
|IIS 10/Logs/Searches|IIS - Top Browsers|Logs|IIS 10/Logs/Searches/IIS - Top Browsers|\_sourceCategory = Labs/iis\* webserver\_system=iis<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count\_frequent cs\_user\_agent <br />\| limit 100|
|IIS 10/Logs/Searches|IIS - Top Clients|Logs|IIS 10/Logs/Searches/IIS - Top Clients|\_sourceCategory = Labs/iis\* webserver\_system=iis <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count\_frequent c\_ip <br />\| limit 100|
|IIS 10/Logs/Searches|IIS - Top Clients Causing Errors|Logs|IIS 10/Logs/Searches/IIS - Top Clients Causing Errors|\_sourceCategory = Labs/iis\* webserver\_system=iis 4\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "4\*" <br />\| count\_frequent c\_ip <br />\| limit 100|
|IIS 10/Logs/Searches|IIS - Top URLs by Count|Logs|IIS 10/Logs/Searches/IIS - Top URLs by Count|\_sourceCategory = Labs/iis\* webserver\_system=iis<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count\_frequent cs\_uri\_stem <br />\| limit 100|
|IIS 10/Logs/Searches|IIS - Traffic Volume Served per Day|Logs|IIS 10/Logs/Searches/IIS - Traffic Volume Served per Day|\_sourceCategory = Labs/iis\* webserver\_system=iis<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| timeslice by 1d <br />\| count as hits by \_timeslice<br />\| sort by \_timeslice|
|IIS 10/Logs/Performance|IIS Site Uptime|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService ServiceUptime \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "ServiceUptime = \*;" as ServiceUptime<br />\| withtime ServiceUptime <br />\| most\_recent(ServiceUptime\_withtime) as ServiceUptime by Name<br />\| ServiceUptime / (60\*60\*24) as ServiceUptimeDays<br />\| sort by ServiceUptimeDays, Name asc<br />\| fields -ServiceUptime|
|IIS 10/Metrics|Initialized|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| filter latest = 2 \| count|
|IIS 10/Logs/Performance|ISAPI Extension Requests Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService ISAPIExtensionRequestsPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "ISAPIExtensionRequestsPersec = \*;" as ISAPIExtensionRequestsPersec<br />\| timeslice 1m<br />\| avg(ISAPIExtensionRequestsPersec) as avgISAPIExtensionRequestsPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Metrics|Max Worker Processes|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Maximum\_Worker\_Processes webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by metric|
|IIS 10/Metrics|Maximum File Cache Memory Usage|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Maximum\_File\_Cache\_Memory\_Usage webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Logs/Traffic Insights|Media Types Served|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_uri\_stem "\\.(?\<media\_type\>[A-Za-z]+)\$" <br />\| count as count by media\_type<br />\| sort by count, media\_type asc|
|IIS 10/Metrics|Metadata Cache Flushes|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Metadata\_Cache\_Flushes webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Metadata Cache Hits|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Metadata\_Cache\_Hits webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Metadata Cache Hits/Miss Ratio|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Metadata\_Cache\_Hits\_Percent  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host \| eval \_value/100|
|IIS 10/Metrics|Metadata Cache Misses|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Metadata\_Cache\_Misses webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Logs/Server Operations|Method|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as Requests by method \| sort by Requests, method asc|
|IIS 10/Logs/Server Operations|Non 200 Response Status Codes|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where !(sc\_status matches "2\*")<br />\| count as count by sc\_status <br />\| sort by count, sc\_status asc|
|IIS 10/Logs/Performance|Non Anonymous Users|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService CurrentNonAnonymousUsers \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CurrentNonAnonymousUsers = \*;" as CurrentNonAnonymousUsers<br />\| timeslice 1m<br />\| sum(CurrentNonAnonymousUsers) as CurrentNonAnonymousUsers by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Logs/Performance|NonAnonymous Users|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService CurrentNonAnonymousUsers \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CurrentNonAnonymousUsers = \*;" as CurrentNonAnonymousUsers<br />\| withtime CurrentNonAnonymousUsers <br />\| most\_recent(CurrentNonAnonymousUsers\_withtime) as Current, min(CurrentNonAnonymousUsers) as Min, max(CurrentNonAnonymousUsers) as Max, avg(CurrentNonAnonymousUsers) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Logs/Server Operations|Number of Requests - Time Compare|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 1m<br />\| count as Requests by \_timeslice  <br />\| compare with timeshift 1d 7|
|IIS 10/Metrics|Options Requests Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Options\_Requests\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Output Cache Entries|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Output\_Cache\_Entries webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Output Cache Hit Ratio|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Output\_Cache\_Hit\_Ratio webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance \| eval \_value/100|
|IIS 10/Metrics|Output Cache Hits|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Output\_Cache\_Hits webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Output Cache Hits/Miss Ratio|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Output\_Cache\_Current\_Hits\_Percent webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host \| eval \_value/100|
|IIS 10/Metrics|Output Cache Turnover Rate|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Output\_Cache\_Turnover\_Rate webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Pipeline Instance Count|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Pipeline\_Instance\_Count webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Traffic Insights|Popular Mobile Device Versions|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}  (iphone or ipad or android or samsung) <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_User\_Agent "(?\<device\>iPad);\\+CPU\\+OS\\+(?\<version\>[\\d\_]+?)(?:\\+\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<device\>iPhone);\\+CPU\\+iPhone\\+OS\\+(?\<version\>[\\d\_]+?)(?:\\+\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<device\>Android)\\+(?\<version\>[\\d.]+?)(?:;\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<device\>SAMSUNG).+?(?\<version\>(?:GT-\\w+\|SGH-\\w+\|SPH-\\w+\|SCH-\\w+))" <br />\| where device != ""<br />\| count as count by device, version <br />\| transpose row version column device|
|IIS 10/Logs/Server Operations|Post Requests|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} POST<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method = "POST"<br />\| timeslice 1m<br />\| count by \_timeslice|
|IIS 10/Logs/Performance|Post Requests Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService PostRequestsPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "PostRequestsPersec = \*;" as PostRequestsPersec<br />\| timeslice 1m<br />\| avg(PostRequestsPersec) as avgPostRequestsPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Logs/Performance|Post Requests Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService PostRequestsPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "PostRequestsPersec = \*;" as PostRequestsPersec<br />\| withtime PostRequestsPersec <br />\| most\_recent(PostRequestsPersec\_withtime) as Current, min(PostRequestsPersec) as Min, max(PostRequestsPersec) as Max, avg(PostRequestsPersec) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Metrics|Post Requests Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Post\_Requests\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Server Operations|Put Requests|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} PUT<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method = "PUT"<br />\| timeslice 1m<br />\| count by \_timeslice|
|IIS 10/Metrics|Put Requests Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Put\_Requests\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10|Queue Rejected Requests|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_http\_queues\_RejectedRequests webserver\_farm={{webserver\_farm}} \|  parse field=instance \* as app\_pool\_instance \| sum by webserver\_farm, host, <br />app\_pool\_instance|
|IIS 10/Logs/Performance|Queue Size|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues CurrentQueueSize \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CurrentQueueSize = \*;" as CurrentQueueSize<br />\| timeslice 1m<br />\| sum(CurrentQueueSize) by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10/Logs/Performance|Queue Size|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues CurrentQueueSize \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "CurrentQueueSize = \*;" as CurrentQueueSize<br />\| withtime CurrentQueueSize <br />\| most\_recent(CurrentQueueSize\_withtime) as Current, min(CurrentQueueSize) as Min, max(CurrentQueueSize) as Max, avg(CurrentQueueSize) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Logs/Server Operations|Reason Phrase - Time Compare|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by Reason\_Phrase<br />\| compare timeshift -1h as HourBefore, timeshift -1d as Yesterday<br />\| \_count as Current \| \_count\_HourBefore as HourBefore \| \_count\_Yesterday as Yesterday<br />\| fields - \_count, \_count\_HourBefore, \_count\_Yesterday|
|IIS 10/Metrics|Recent Worker Process Failures|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Recent\_Worker\_Process\_Failures webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Server Operations|Redirections by Server|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 3\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "3\*"<br />\| count as count by server\_ip, sc\_status<br />\| transpose row server\_ip column sc\_status as \* |
|IIS 10|Rejected Requests|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_http\_queues\_RejectedRequests webserver\_farm={{webserver\_farm}} \| sum by metric|
|IIS 10/Logs/Performance|Rejection Rate|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues RejectionRate \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "RejectionRate = \\"\*\\";" as RejectionRate<br />\| withtime RejectionRate <br />\| most\_recent(RejectionRate\_withtime) as Current, min(RejectionRate) as Min, max(RejectionRate) as Max, avg(RejectionRate) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Metrics|Request Execution Time|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Request\_Execution\_Time objectname=asp.net  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Logs/Server Operations|Request Outlier|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 1m<br />\| count as Requests by \_timeslice<br />\| outlier Requests window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10/Metrics|Request Wait Time|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Request\_Wait\_Time objectname=asp.net  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10|Requests|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count as Requests|
|IIS 10/Logs/Server Operations|Requests|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as Requests|
|IIS 10/Logs/Traffic Insights|Requests by App Over Time|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+?)(?:/\|\$)" nodrop<br />\| if (isEmpty(app), cs\_uri\_stem, app) as app<br />\| timeslice 1m <br />\| count by \_timeslice, app <br />\| transpose row \_timeslice column app|
|IIS 10/Metrics|Requests Executing|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Requests\_Executing webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Requests in Application Queue|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Requests\_in\_Application\_Queue webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Requests Per Sec|Metrics|IIS 10/Metrics/IIS - ASP.NET Applications|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_app\_Requests\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{instance}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Performance|Requests Per Sec (All methods)|Logs|IIS 10/Logs/Performance/IIS - Performance Trends|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService TotalMethodRequestsPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "TotalMethodRequestsPersec = \*;" as TotalMethodRequestsPersec<br />\| timeslice 1m<br />\| avg(TotalMethodRequestsPersec) as avgTotalMethodRequestsPersec by \_timeslice, Name<br />\| transpose row \_timeslice column Name|
|IIS 10|Requests Per Sec (All methods)|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Method\_Requests\_persec webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Requests Queued|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Requests\_Queued objectname=asp.net webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Requests Rejected|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Requests\_Rejected objectname=asp.net webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Logs/Traffic Insights|Requests Stats by Client IP|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors<br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| withtime \_messagetime<br />\| count as Requests, most\_recent(\_messagetime\_withtime), least\_recent(\_messagetime\_withtime), count\_distinct(cs\_uri\_stem) as UniquePagesVisited, sum(successes) as successes, sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by c\_ip<br />\| formatDate(fromMillis(\_mostrecent), "MM/dd/yyyy HH:mm:ss:SSS Z") as LatestRequest<br />\| formatDate(fromMillis(\_leastrecent), "MM/dd/yyyy HH:mm:ss:SSS Z") as EarliestRequest<br />\| top 20 c\_ip, LatestRequest, EarliestRequest, Requests, UniquePagesVisited, successes, redirects, client\_errors, server\_errors by Requests, UniquePagesVisited|
|IIS 10/Logs/Server Operations|Requests Stats by Server|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors <br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| count as Requests, count\_distinct(cs\_uri\_stem) as UniquePagesServed, max(time\_taken) as MaxResponseTime, min(time\_taken) as MinResponseTime, avg(time\_taken) as AvgResponseTime, sum(successes) as successes, sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by server\_ip  <br />\| top 10 server\_ip by Requests, UniquePagesServed, AvgResponseTime, MaxResponseTime, MinResponseTime, successes, redirects, client\_errors, server\_errors|
|IIS 10/Logs/Server Operations|Response Codes Over Time|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| if(sc\_status matches "2\*", 1, 0) as successes \| if(sc\_status matches "3\*", 1, 0) as redirects \| if(sc\_status matches "4\*", 1, 0) as client\_errors \| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1m <br />\| sum(successes) as successes, sum(redirects) as redirects, sum(client\_errors) as client\_errors, sum(server\_errors) as server\_errors by \_timeslice<br />\| sort by \_timeslice asc|
|IIS 10/Logs/Server Operations|Response Time (Avg) by Server|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 1m<br />\| avg(time\_taken) as AvgResTime by \_timeslice, server\_ip<br />\| transpose row \_timeslice column server\_ip|
|IIS 10/Logs/Server Operations|Response Time (Avg) Outlier|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 1m<br />\| avg(time\_taken) as AvgResTime by \_timeslice<br />\| outlier AvgResTime window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10/Logs/Server Operations|Response Time Histogram|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| avg(time\_taken) as time\_taken by cs\_uri\_stem<br />\| fields time\_taken<br />\| int(time\_taken/50) as bucket \| (bucket+1)\*50 as bucketMax <br />\| count as Requests by bucketMax \| sort by bucketMax asc|
|IIS 10|Response Time Histogram|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| avg(time\_taken) as avg\_time\_taken by cs\_uri\_stem<br />\| fields avg\_time\_taken<br />\| (floor(avg\_time\_taken/50)+1)\*50 as avg\_time\_taken\_bucket<br />\| if (avg\_time\_taken \> 1000, 1001, avg\_time\_taken\_bucket) as avg\_time\_taken\_bucket<br />\| count as Frequency by avg\_time\_taken\_bucket<br />\| sort by + avg\_time\_taken\_bucket<br />\| if (avg\_time\_taken\_bucket = 1001, "\>1000", toString(avg\_time\_taken\_bucket)) as avg\_time\_taken\_bucket|
|IIS 10/Metrics|Running|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State  webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| filter latest = 3 \| count|
|IIS 10/Logs/Server Operations|Server Error Outliers|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 5\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "5\*"<br />\| timeslice 1m<br />\| count as Requests by \_timeslice<br />\| outlier Requests window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10/Logs/Server Operations|Server Errors by Server|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 5\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "5\*"<br />\| count as count by server\_ip, sc\_status<br />\| transpose row server\_ip column sc\_status as \* |
|IIS 10/Logs/Server Operations|Server Errors Over Time|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 5\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, sc\_status<br />\| transpose row \_timeslice column sc\_status as \*|
|IIS 10/Metrics|Shutdown Pending|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| filter latest = 6 \| count|
|IIS 10|Site Uptime|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService ServiceUptime \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "ServiceUptime = \*;" as ServiceUptime<br />\| withtime ServiceUptime <br />\| most\_recent(ServiceUptime\_withtime) as ServiceUptime by Name<br />\| ServiceUptime / (60\*60\*24) as ServiceUptimeDays<br />\| sort by ServiceUptimeDays, Name asc<br />\| fields -ServiceUptime|
|IIS 10/Metrics|Site Uptime|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Service\_Uptime webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| parse field=instance \* as site\_instance \| sum by webserver\_farm,host,site\_instance\| eval \_value/86400|
|IIS 10|Sites|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Method\_Requests webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm, host ,instance \| count|
|IIS 10/Metrics|State Server Sessions Abandoned|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_State\_Server\_Sessions\_Abandoned objectname=asp.net webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|State Server Sessions Active|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_State\_Server\_Sessions\_Active objectname=asp.net webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|State Server Sessions Timed Out|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_State\_Server\_Sessions\_Timed\_Out objectname=asp.net  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|State Server Sessions Total|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_State\_Server\_Sessions\_Total objectname=asp.net webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Logs/Traffic Insights|Threat Breakdown by Sources|Logs|IIS 10/Logs/Traffic Insights/IIS - Threat Analysis|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as ip\_count by c\_ip, \_source<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum (ip\_count) as threat\_count by \_source|
|IIS 10/Logs/Traffic Insights|Threat by Actors|Logs|IIS 10/Logs/Traffic Insights/IIS - Threat Analysis|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|IIS 10/Logs/Traffic Insights|Threat by Malicious Confidence|Logs|IIS 10/Logs/Traffic Insights/IIS - Threat Analysis|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|IIS 10/Logs/Traffic Insights|Threat Count|Logs|IIS 10/Logs/Traffic Insights/IIS - Threat Analysis|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|IIS 10|Threat Count|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor\| sum(\_count) as threatCount|
|IIS 10/Logs/Traffic Insights|Threat Location|Logs|IIS 10/Logs/Traffic Insights/IIS - Threat Analysis|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip|
|IIS 10/Logs/Traffic Insights|Threat Table|Logs|IIS 10/Logs/Traffic Insights/IIS - Threat Analysis|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count c\_ip, sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by malicious\_confidence, Actor,c\_ip, sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />\| sort by \_count<br />\| \_count as count<br />\| limit 50<br />\| fields malicious\_confidence, Actor, c\_ip,sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent|
|IIS 10/Logs/Server Operations|Top 10 Bots Observed|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=cs\_User\_Agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Exabot?)\\W"<br />\| where bot\_name != ""<br />\| if (bot\_name="bing","Bing",bot\_name) as bot\_name<br />\| count as count by bot\_name<br />\| sort by count<br />\| limit 10|
|IIS 10/Logs/Traffic Insights|Top 10 Queries|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where cs\_uri\_query != "-"<br />\| count by cs\_uri\_query<br />\| top 10 cs\_uri\_query by \_count, cs\_uri\_query asc<br />\| \_count as count<br />\| fields cs\_uri\_query, count|
|IIS 10/Logs/Traffic Insights|Top 10 Search Terms from Popular Search Engines|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} (google OR bing OR aol OR ask OR yahoo) ("p=" OR "q=" OR "wd=" OR "searchfor=")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_referer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where search\_term != ""<br />\| urldecode(search\_term)<br />\| if(cs\_referer matches "\*google.\*", "Google", "") as engine<br />\| if(cs\_referer matches "\*bing.\*", "Bing", engine) as engine<br />\| if(cs\_referer matches "\*ask.com\*", "Ask.com", engine) as engine<br />\| if(cs\_referer matches "\*aol.\*", "AOL", engine) as engine<br />\| if(cs\_referer matches "\*yahoo.\*", "Yahoo", engine) as engine<br />\| where engine !="" <br />\| count as count by search\_term<br />\| sort count<br />\| limit 10|
|IIS 10/Logs/Server Operations|Top 10 Slowest Pages|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| avg(time\_taken) as AvgResTime by cs\_uri\_stem <br />\| top 20 cs\_uri\_stem by AvgResTime, cs\_uri\_stem asc<br />\| AvgResTime/1000 as AvgResTimeInSec <br />\| format( "%.2f",AvgResTimeInSec) as AvgResTimeInSec<br />\| fields -AvgResTime|
|IIS 10/Logs/Server Operations|Top 10 URLs Facing 404 Errors|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 404<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status="404" <br />\| count by cs\_uri\_stem<br />\| top 10 cs\_uri\_stem by \_count, cs\_uri\_stem asc<br />\| \_count as count<br />\| fields cs\_uri\_stem,count|
|IIS 10|Top 10 URLs with 4xx Errors|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count as count by cs\_uri\_stem, sc\_status<br />\| sort by count, cs\_uri\_stem asc \| limit 10|
|IIS 10|Top 10 URLs with 5xx Errors|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "5\*"<br />\| count as count by cs\_uri\_stem, sc\_status<br />\| sort by count, cs\_uri\_stem asc \| limit 10|
|IIS 10/Logs/Server Operations|Top 5 Clients Causing 4xx Errors|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count as count by c\_ip<br />\| sort count <br />\| limit 5 |
|IIS 10/Logs/Traffic Insights|Top 5 Highly Malicious URLs|Logs|IIS 10/Logs/Traffic Insights/IIS - Threat Analysis|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as ip\_count by c\_ip, cs\_uri\_stem<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| where malicious\_confidence matches "high"<br />\| count by cs\_uri\_stem|
|IIS 10/Logs/Traffic Insights|Top 5 Referrers|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where cs\_referer != "-"<br />\| count as count by cs\_referer<br />\| sort by count<br />\| limit 5 |
|IIS 10/Logs/Traffic Insights|Top 5 URLs|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Traffic Insights|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count as count by cs\_uri\_stem<br />\| sort by count<br />\| limit 5|
|IIS 10/Logs/Traffic Insights|Top Apps by Request|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+?)(?:/\|\$)" nodrop<br />\| if (isEmpty(app), cs\_uri\_stem, app) as app<br />\| count as Requests by app <br />\| top 20 app by Requests, app asc|
|IIS 10|Top Apps by Request|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+?)(?:/\|\$)" nodrop<br />\| if (isEmpty(app), cs\_uri\_stem, app) as app<br />\| count as Requests by app <br />\| top 20 app by Requests, app asc|
|IIS 10/Logs/Server Operations|Top Client IPs|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)"<br />\| count by c\_ip<br />\| top 10 c\_ip by \_count, c\_ip asc<br />\| \_count as count<br />\| fields c\_ip, count|
|IIS 10/Logs/Server Operations|Top Cooked URL and Query|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by cookedurl\_query<br />\| top 25 cookedurl\_query by \_count, cookedurl\_query asc<br />\| \_count as count<br />\| fields cookedurl\_query,count|
|IIS 10/Logs/Server Operations|Top Protocol Status|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by Protocol\_Status<br />\| top 10 Protocol\_Status by \_count, Protocol\_Status asc<br />\| \_count as count<br />\| fields Protocol\_Status, count|
|IIS 10/Logs/Server Operations|Top Protocol Versions|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by protocol\_version<br />\| top 10 protocol\_version by \_count, protocol\_version asc<br />\| \_count as count<br />\| fields protocol\_version, count|
|IIS 10/Logs/Server Operations|Top Reason Phrase|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by Reason\_Phrase<br />\| top 10 Reason\_Phrase by \_count, Reason\_Phrase<br />\| \_count as count<br />\| fields Reason\_Phrase,count|
|IIS 10/Logs/Server Operations|Top Request Details by Reason|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by c\_ip, server\_ip, s\_port, verb, cookedurl\_query, protocol\_version, Protocol\_Status, SiteId, Reason\_Phrase, Queue\_Name<br />\| top 25 c\_ip, server\_ip, s\_port, verb, cookedurl\_query, protocol\_version, Protocol\_Status, Reason\_Phrase, SiteId, Queue\_Name by \_count, c\_ip, server\_ip, s\_port<br />\| \_count as count<br />\| fields c\_ip, server\_ip, s\_port, verb, cookedurl\_query, protocol\_version, Protocol\_Status, Reason\_Phrase, SiteId, Queue\_Name, count|
|IIS 10/Logs/Traffic Insights|Top Requests by Users|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where cs\_username != "-" <br />\| count as Requests by cs\_username <br />\| top 20 cs\_username by Requests, cs\_username asc|
|IIS 10/Logs/Server Operations|Top Server Errors by Server|Logs|IIS 10/Logs/Server Operations/IIS - Web Server Operations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} 5\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "5\*" <br />\| count by server\_ip, cs\_uri\_stem, sc\_status, sc\_substatus, sc\_win32\_status \| sort - \_count<br />\| \_count as count<br />\| fields server\_ip, cs\_uri\_stem, sc\_status, sc\_substatus, sc\_win32\_status, count|
|IIS 10/Logs/Server Operations|Top Server IPs|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by server\_ip, s\_port<br />\| top 10 server\_ip, s\_port by \_count, server\_ip asc, s\_port asc<br />\| \_count as count<br />\| fields server\_ip,s\_port,count|
|IIS 10/Logs/Server Operations|Top Slowest Get Requests|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method="GET"<br />\| avg(time\_taken) as AvgResTime by cs\_uri\_stem, method<br />\| top 20 cs\_uri\_stem by AvgResTime, cs\_uri\_stem asc<br />\| AvgResTime/1000 as AvgResTimeInSec <br />\| format( "%.2f",AvgResTimeInSec) as AvgResTimeInSec<br />\| fields -AvgResTime|
|IIS 10/Logs/Server Operations|Top Slowest Post Requests|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method="POST"<br />\| avg(time\_taken) as AvgResTime by cs\_uri\_stem, method<br />\| top 20 cs\_uri\_stem by AvgResTime, cs\_uri\_stem asc<br />\| AvgResTime/1000 as AvgResTimeInSec <br />\| format( "%.2f",AvgResTimeInSec) as AvgResTimeInSec<br />\| fields -AvgResTime|
|IIS 10/Logs/Server Operations|Top Verbs|Logs|IIS 10/Logs/Server Operations/IIS - HTTP Error|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by verb<br />\| top 10 verb by \_count, verb asc<br />\| \_count as count<br />\| fields verb,count|
|IIS 10/Metrics|Total Application Pool Recycles|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Total\_Application\_Pool\_Recycles webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by webserver\_farm, host, <br />instance|
|IIS 10/Metrics|Total Blocked Async I/O Requests|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Blocked\_Async\_I\_O\_Requests webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host,<br />instance|
|IIS 10/Logs/Performance|Total Bytes Transferred Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService BytesTotalPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "BytesTotalPersec = \\"\*\\";" as BytesTotalPersec<br />\| withtime BytesTotalPersec <br />\| most\_recent(BytesTotalPersec\_withtime) as Current, sum(BytesTotalPersec) as Sum, min(BytesTotalPersec) as Min, max(BytesTotalPersec) as Max, avg(BytesTotalPersec) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Metrics|Total CGI Requests|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_CGI\_Requests webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host,<br />instance|
|IIS 10/Metrics|Total Connection Attempts All Instances|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Connection\_Attempts\_\_all\_instances webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Files Cached|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Total\_Files\_Cached webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Total Files Flushed|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Total\_Flushed\_Files webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Total Flushed Items|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Output\_Cache\_Total\_Flushed\_Items webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Total Flushed Metadata|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Total\_Flushed\_Metadata webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Total Flushed URIs|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Total\_Flushed\_URIs webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Total Locked Errors|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Locked\_Errors  webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}}\| sum by webserver\_farm, host,<br />instance|
|IIS 10/Metrics|Total Logon Attempts|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Logon\_Attempts webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Metadata Cache Flushed|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Total\_Flushed\_Metadata webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Total Metadata Cached|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Total\_Metadata\_Cached  webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Total Method Requests|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Method\_Requests webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Method Requests Per Sec|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Method\_Requests\_persec webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Non-Anonymous Users|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_NonAnonymous\_Users webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Not Found Errors|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Not\_Found\_Errors  webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Rejected Async I/O Requests|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Rejected\_Async\_I\_O\_Requests webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Performance|Total Requests Per Sec|Logs|IIS 10/Logs/Performance/IIS - Performance Snapshot|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} Win32\_PerfFormattedData\_W3SVC\_WebService TotalMethodRequestsPersec \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name<br />\| parse field=iis\_log\_message "TotalMethodRequestsPersec = \*;" as TotalMethodRequestsPersec<br />\| withtime TotalMethodRequestsPersec <br />\| most\_recent(TotalMethodRequestsPersec\_withtime) as Current, min(TotalMethodRequestsPersec) as Min, max(TotalMethodRequestsPersec) as Max, avg(TotalMethodRequestsPersec) as Avg by Name<br />\| sort by Current, Name asc|
|IIS 10/Metrics|Total Site|Metrics|IIS 10/Metrics/IIS - Web Service|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Total\_Method\_Requests webserver\_farm={{webserver\_farm}} host={{host}} instance={{site}} \| sum by webserver\_farm, host ,instance \| count|
|IIS 10/Metrics|Total URIs Cached|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_Total\_URIs\_Cached webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Total URIs Flushes|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_URI\_Cache\_Flushes webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Metrics|Total Worker Processes Created|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Total\_Worker\_Processes\_Created webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Worker Processes Failures|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Total\_Worker\_Process\_Failures webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Worker Processes Ping Failures|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Total\_Worker\_Process\_Ping\_Failures webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Worker Processes Shutdown Failures|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Total\_Worker\_Process\_Shutdown\_Failures webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by webserver\_farm, host, instance|
|IIS 10/Metrics|Total Worker Processes Startup Failures|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Total\_Worker\_Process\_Startup\_Failures webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| sum by webserver\_farm, host, instance|
|IIS 10/Logs/Server Operations|Traffic Distribution by Server|Logs|IIS 10/Logs/Server Operations/IIS - Latency|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as Requests by server\_ip  <br />\| top 10 server\_ip by Requests, server\_ip asc|
|IIS 10/Metrics|Uninitialized|Metrics|IIS 10/Metrics/IIS - Application Pool|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_app\_pool\_was\_Current\_Application\_Pool\_State webserver\_farm={{webserver\_farm}} host={{host}} instance={{application\_pool}} \| filter latest = 1 \| count|
|IIS 10/Logs/Traffic Insights|Unique Visitors|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| Count by c\_ip<br />\| Count|
|IIS 10/Logs/Server Operations|Unique Visitors Outlier|Logs|IIS 10/Logs/Server Operations/The IIS - Requests Stats|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 1m<br />\| count\_distinct(c\_ip) as UniqueVisitors by \_timeslice<br />\| outlier UniqueVisitors window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10|Uptime (Days)|Metrics|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_Service\_Uptime webserver\_farm={{webserver\_farm}} \| sum by webserver\_farm, host\|  eval \_value/86400|
|IIS 10/Metrics|URI Cache Flushes|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_URI\_Cache\_Flushes webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|URI Cache Hits|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_URI\_Cache\_Hits  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|URI Cache Hits/Miss Ratio|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_URI\_Cache\_Hits\_Percent webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host \| eval \_value/100|
|IIS 10/Metrics|URI Cache Misses|Metrics|IIS 10/Metrics/IIS - Cache Performance|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_websvc\_cache\_URI\_Cache\_Misses webserver\_farm={{webserver\_farm}} host={{host}}\| sum by webserver\_farm, host|
|IIS 10/Logs/Traffic Insights|US Visitors|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Locations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_name, region, city from geo://location on ip=c\_ip<br />\| where !isNull(latitude)<br />\| where country\_name = "United States"|
|IIS 10|Visitor Location|Logs|IIS 10/IIS - Overview|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip=c\_ip<br />\| where !isNull(latitude)|
|IIS 10/Logs/Traffic Insights|Visitor Platforms|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if (cs\_User\_Agent matches "\*iPad\*" OR cs\_User\_Agent matches "\*iPhone\*" OR cs\_User\_Agent matches "\*Android\*" OR cs\_User\_Agent matches "\*BlackBerry\*" OR cs\_User\_Agent matches "\*Galaxy\*" OR cs\_User\_Agent matches "LGE-\*" OR cs\_User\_Agent matches "SCH-\*" OR cs\_User\_Agent matches "\*HUAWEI-\*" OR cs\_User\_Agent matches "\*SAMSUNG\*" OR cs\_User\_Agent matches "\*samsung\*" OR cs\_User\_Agent matches "Dalvik/\*" OR cs\_User\_Agent matches "Nokia\*" OR cs\_User\_Agent matches "LG-\*" OR cs\_User\_Agent matches "\*CFNetwork\*"  OR cs\_User\_Agent matches "\*UP.Browser/\*" OR cs\_User\_Agent matches "\*QQ\*rowser\*" OR cs\_User\_Agent matches "\*NetFront/\*" OR cs\_User\_Agent matches "\*Windows Phone\*" OR cs\_User\_Agent matches "\*Mobile Safari\*" OR cs\_User\_Agent matches "\*iemobile\*","Mobile","") as type<br />\| if (cs\_User\_Agent matches "\*Windows\*" OR cs\_User\_Agent matches "\*Win64\*" OR cs\_User\_Agent matches "\*Win32\*" OR cs\_User\_Agent matches "\*i686\*" OR cs\_User\_Agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count type<br />\| sort by \_count|
|IIS 10/Logs/Traffic Insights|Visitors by US Region Over Time|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Locations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| timeslice 5m<br />\| count by \_timeslice, c\_ip<br />\| lookup latitude, longitude, country\_name, region, city, state, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude) and country\_name = "United States"<br />\| sum(\_count) by \_timeslice, region<br />\| transpose row \_timeslice column region|
|IIS 10/Logs/Traffic Insights|Visitors Platforms Over Time|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Access Types|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if (cs\_User\_Agent matches "\*iPad\*" OR cs\_User\_Agent matches "\*iPhone\*" OR cs\_User\_Agent matches "\*Android\*" OR cs\_User\_Agent matches "\*BlackBerry\*" OR cs\_User\_Agent matches "\*Galaxy\*" OR cs\_User\_Agent matches "LGE-\*" OR cs\_User\_Agent matches "SCH-\*" OR cs\_User\_Agent matches "\*HUAWEI-\*" OR cs\_User\_Agent matches "\*SAMSUNG\*" OR cs\_User\_Agent matches "\*samsung\*" OR cs\_User\_Agent matches "Dalvik/\*" OR cs\_User\_Agent matches "Nokia\*" OR cs\_User\_Agent matches "LG-\*" OR cs\_User\_Agent matches "\*CFNetwork\*"  OR cs\_User\_Agent matches "\*UP.Browser/\*" OR cs\_User\_Agent matches "\*QQ\*rowser\*" OR cs\_User\_Agent matches "\*NetFront/\*" OR cs\_User\_Agent matches "\*Windows Phone\*" OR cs\_User\_Agent matches "\*Mobile Safari\*" OR cs\_User\_Agent matches "\*iemobile\*","Mobile","") as type<br />\| if (cs\_User\_Agent matches "\*Windows\*" OR cs\_User\_Agent matches "\*Win64\*" OR cs\_User\_Agent matches "\*Win32\*" OR cs\_User\_Agent matches "\*i686\*" OR cs\_User\_Agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| timeslice 5m<br />\| count by \_timeslice, type<br />\| transpose row \_timeslice column type|
|IIS 10/Logs/Traffic Insights|Visits by Country Over Time|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Locations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| timeslice 5m<br />\| count by \_timeslice, c\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip = c\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name|
|IIS 10/Logs/Searches|W3SVC\_WebService Log Parser|Logs|IIS 10/Logs/Searches/W3SVC\_WebService Log Parser|\_sourceCategory = Labs/iis\* webserver\_system=iis Win32\_PerfFormattedData\_W3SVC\_WebService<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse field=iis\_log\_message "Name = \\"\*\\";" as Name nodrop<br />\| parse field=iis\_log\_message "BytesReceivedPersec = \\"\*\\";" as BytesReceivedPersec nodrop<br />\| parse	field=iis\_log\_message "BytesSentPersec = \\"\*\\";" as BytesSentPersec nodrop<br />\| parse	field=iis\_log\_message "BytesTotalPersec = \\"\*\\";" as BytesTotalPersec nodrop<br />\| parse	field=iis\_log\_message "CGIRequestsPersec = \*;" as CGIRequestsPersec nodrop<br />\| parse	field=iis\_log\_message "CurrentAnonymousUsers = \*;" as CurrentAnonymousUsers nodrop<br />\| parse	field=iis\_log\_message "CurrentConnections = \*;" as CurrentConnections nodrop<br />\| parse	field=iis\_log\_message "CurrentNonAnonymousUsers = \*;" as CurrentNonAnonymousUsers nodrop<br />\| parse	field=iis\_log\_message "FilesReceivedPersec = \*;" as FilesReceivedPersec nodrop<br />\| parse	field=iis\_log\_message "FilesSentPersec = \*;" as FilesSentPersec nodrop<br />\| parse	field=iis\_log\_message "GetRequestsPersec = \*;" as GetRequestsPersec nodrop<br />\| parse	"ISAPIExtensionRequestsPersec = \*;" as GetRequestsPersec nodrop<br />\| parse	"PostRequestsPersec = \*;" as PostRequestsPersec nodrop<br />\| parse	"ServiceUptime = \*;" as ServiceUptime nodrop<br />\| parse "TotalMethodRequestsPersec = \*;" as TotalMethodRequestsPersec nodrop<br />|
|IIS 10/Metrics|Worker Process Restarts|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Worker\_Process\_Restarts objectname=asp.net webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Metrics|Worker Processes Running|Metrics|IIS 10/Metrics/IIS - ASP.NET|\_sourceCategory = Labs/iis\* webserver\_system=iis metric=win\_aspnet\_Worker\_Processes\_Running objectname=asp.net  webserver\_farm={{webserver\_farm}} host={{host}} \| sum by webserver\_farm, host|
|IIS 10/Logs/Traffic Insights|Worldwide Visitors|Logs|IIS 10/Logs/Traffic Insights/IIS - Visitor Locations|\_sourceCategory = Labs/iis\* webserver\_system=iis webserver\_farm={{webserver\_farm}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip=c\_ip<br />\| where !isNull(latitude)|

