# Apache Tomcat - OpenTelemetry

## Searches

### Log Searches

- **4xx Error**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **5xx Codes**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **5xx Error**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Average Server Startup Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview 
- **Bytes Served**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Bytes Served - Outlier**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Outlier Analysis 
- **Client Errors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Outlier Analysis 
- **Client Locations - 4xx Errors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations 
- **Component Errors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview 
- **Error Responses by Server**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations 
- **Errors by Component**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview 
- **Exceptions**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview 
- **Heap**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection 
- **Highly Malicious Threat Table**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel 
- **HTTP Methods**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Log Levels**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview 
- **Media Types Served**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Non 200 Response Status Codes**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations 
- **Non-INFO Errors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis 
- **Number of Visitors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Outlier Analysis 
- **Par Old Gen**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection 
- **PS Perm Gen**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection 
- **PS Young Gen**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection 
- **Responses Over Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Responses Over Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis 
- **Server Errors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Outlier Analysis 
- **Server Errors Over Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations 
- **Server State Events Over Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview 
- **Threat Breakdown by Sources**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel 
- **Threat by Actors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel 
- **Threat Count**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel 
- **Threat Locations**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel 
- **Threat Table**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel 
- **Top 10 Bots Observed**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations 
- **Top 10 Host - High GC Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection 
- **Top 10 Hosts - Low Average JVM Up-Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection 
- **Top 10 Recent Exceptions**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Top 10 URLs causing Errors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations 
- **Top 5 Highly Malicious URLs**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel 
- **Top 5 Referrers**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Top 5 URIs causing 404 Responses**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations 
- **Top 5 URLs**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight 
- **Total GC Operation Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection 
- **Total GC Operations**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection 
- **Traffic Distribution by Server**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis 
- **Traffic Volume and Bytes Served**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis 
- **United States**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Locations 
- **Visitor Locations**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis 
- **Visits by Country Over Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Locations 
- **Visits by US State Over Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Locations 
- **Worldwide**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Locations

### Metric Searches

- **Busy Threads Percentage**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Busy vs Current**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Error Count**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Error Count**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Processing Time by Server**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Processing time vs Max Processing time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Request Count**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Request Processing Time**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Requests**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Requests per Seconds**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Thread Distribution by Server**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview 
- **Total Bytes Received**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Total Bytes Received**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Total Bytes Sent**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Total Bytes Sent**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors 
- **Total Connectors**: from Dashboard: Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Apache Tomcat - OpenTelemetry|4xx Error|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*"<br />\| count|
|Apache Tomcat - OpenTelemetry|5xx Codes|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "5\*" <br />\| count as count by status\_code, webengine.node.name|
|Apache Tomcat - OpenTelemetry|5xx Error|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "5\*"<br />\| count<br />|
|Apache Tomcat - OpenTelemetry/Logs|Average Server Startup Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} startup \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse "INFO: Server startup in \* ms" as startuptime<br />\| startuptime/1000 as startuptime\_ms<br />\| timeslice 1d<br />\| avg(startuptime\_ms) as avg\_startuptime\_sec by \_timeslice|
|Apache Tomcat - OpenTelemetry/Metrics|Busy Threads Percentage|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.threads state=busy \| sum by metric|
|Apache Tomcat - OpenTelemetry/Metrics|Busy vs Current|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.threads state=busy \| sum by deployment.environment, webengine.cluster.name, webengine.node.name, proto\_handler |
|Apache Tomcat - OpenTelemetry/Logs|Bytes Served|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where size != "-" and size != ""<br />\| num(size) as size<br />\| sum(size) as Bytes\_Served<br />\| Bytes\_Served/(1024\*1024\*1000) as Gbytes\_Served<br />\| fields Gbytes\_Served|
|Apache Tomcat - OpenTelemetry/Logs|Bytes Served - Outlier|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Outlier Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where size != "-" and !isEmpty(size)<br />\| number(size)<br />\| (size/(1024\*1024)) as mbytes <br />\| timeslice {{timeslice}}<br />\| sum(mbytes) as mbytes by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier mbytes window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache Tomcat - OpenTelemetry/Logs|Client Errors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Outlier Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| timeslice {{timeslice}}<br />\| count as client\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier client\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache Tomcat - OpenTelemetry/Logs|Client Locations - 4xx Errors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Apache Tomcat - OpenTelemetry/Logs|Component Errors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)(?:\$\|\\n(?\<thrown\>[\\s\\S]+)\$)"<br />\| where (loglevel != "INFO")<br />\| count by component<br />\| sort by \_count|
|Apache Tomcat - OpenTelemetry|Error Count|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.errors  \| sum by metric|
|Apache Tomcat - OpenTelemetry/Metrics|Error Count|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.errors  \| sum by deployment.environment,webengine.cluster.name,webengine.node.name,proto\_handler|
|Apache Tomcat - OpenTelemetry/Logs|Error Responses by Server|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, host<br />\| transpose row \_timeslice column host|
|Apache Tomcat - OpenTelemetry/Logs|Errors by Component|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)(?:\$\|\\n(?\<thrown\>[\\s\\S]+)\$)"<br />\| where (loglevel != "INFO")<br />\| timeslice 1h<br />\| count by \_timeslice, component<br />\| transpose row \_timeslice column component|
|Apache Tomcat - OpenTelemetry/Logs|Exceptions|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \*Exception \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<Component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)\\n(?\<thrown\>[\\s\\S]+)\$"<br />\| where thrown!=""<br />\| parse regex field=thrown "\\((?\<sourcefile\>[^\\)]+)"<br />\| timeslice 1d<br />\| count by \_timeslice|
|Apache Tomcat - OpenTelemetry/Logs|Heap|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[Metaspace: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| avg(HeapBfrGC) as BeforeGC, avg(HeapAftrGC) as AfterGC by \_timeslice|
|Apache Tomcat - OpenTelemetry/Logs|Highly Malicious Threat Table|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup type, actor, raw, threatlevel as Malicious\_Confidence from sumo://threat/cs on threat=remote\_ip <br />\| where  type="ip\_address" and !isNull(Malicious\_Confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| where Malicious\_Confidence matches "high"<br />\| count by Malicious\_Confidence, Actor, remote\_ip, status\_code, uri<br />\| sort by \_count<br />\| limit 20|
|Apache Tomcat - OpenTelemetry/Logs|HTTP Methods|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count by method|
|Apache Tomcat - OpenTelemetry/Logs|Log Levels|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)(?:\$\|\\n(?\<thrown\>[\\s\\S]+)\$)"<br />\| count as count by loglevel<br />\| sort by count|
|Apache Tomcat - OpenTelemetry/Logs|Media Types Served|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| parse regex field=uri "^/[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$"<br />\| count as count by type <br />\| sort by count desc|
|Apache Tomcat - OpenTelemetry/Logs|Non 200 Response Status Codes|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| where !(status\_code matches "2\*") <br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|Apache Tomcat - OpenTelemetry/Logs|Non-INFO Errors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)(?:\$\|\\n(?\<thrown\>[\\s\\S]+)\$)"<br />\| where (loglevel != "INFO")<br />\| timeslice 1h<br />\| count by \_timeslice, loglevel<br />\| transpose row \_timeslice column loglevel|
|Apache Tomcat - OpenTelemetry/Logs|Number of Hits by Server - One Day Time Comparison|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as Number\_of\_Hits by host  <br />\| compare with timeshift 1d|
|Apache Tomcat - OpenTelemetry/Logs|Number of Visitors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Outlier Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where !isEmpty(remote\_ip)<br />\| timeslice {{timeslice}}<br />\| count as hits by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier hits window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache Tomcat - OpenTelemetry/Logs|Par Old Gen|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| avg(OldBfrGC) as BeforeGC, avg(OldAftrGC) as AfterGC by \_timeslice|
|Apache Tomcat - OpenTelemetry/Metrics|Processing Time by Server|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.processing\_time  \| sum by deployment.environment,webengine.cluster.name,webengine.node.name,proto\_handler |
|Apache Tomcat - OpenTelemetry/Metrics|Processing time vs Max Processing time|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.processing\_time  \| sum by deployment.environment,webengine.cluster.name,webengine.node.name,proto\_handler|
|Apache Tomcat - OpenTelemetry/Logs|PS Perm Gen|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| avg(PermBfrGC) as BeforeGC, avg(PermAftrGC) as AfterGC by \_timeslice|
|Apache Tomcat - OpenTelemetry/Logs|PS Young Gen|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[Metaspace: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| avg(YngBfrGC) as BeforeGC, avg(YngAftrGC) as AfterGC by \_timeslice|
|Apache Tomcat - OpenTelemetry/Metrics|Request Count|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.request\_count  \| sum by deployment.environment,webengine.cluster.name,webengine.node.name,proto\_handler|
|Apache Tomcat - OpenTelemetry|Request Processing Time|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.processing\_time  \| avg by metric \| rate \| sum|
|Apache Tomcat - OpenTelemetry|Requests|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.request\_count proto\_handler=\*http\*  \| sum by metric|
|Apache Tomcat - OpenTelemetry|Requests per Seconds|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.request\_count proto\_handler=\*http\* \| rate \| sum|
|Apache Tomcat - OpenTelemetry/Logs|Responses Over Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| if(Status\_Code matches "2\*", 1, 0) as Successes <br />\| if(Status\_Code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(Status\_Code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 1h <br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc|
|Apache Tomcat - OpenTelemetry|Responses Over Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| if(status\_code matches "2\*", 1, 0) as Successes <br />\| if(status\_code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(status\_code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 5m<br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc|
|Apache Tomcat - OpenTelemetry/Logs|Server Errors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Outlier Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice {{timeslice}}<br />\| count as server\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier server\_errors window={{window}}, threshold={{threshold}}, consecutive={{consecutive}}, direction=+|
|Apache Tomcat - OpenTelemetry/Logs|Server Errors Over Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, status\_code<br />\| transpose row \_timeslice column status\_code |
|Apache Tomcat - OpenTelemetry/Logs|Server State Events Over Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} (shutdown or startup) \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (\_raw matches "\*INFO: A valid shutdown command was received via the shutdown port. Stopping the Server instance.\*",1,0) as shutdown<br />\| if (\_raw matches "\*INFO: Server startup in\*",1,0) as startup<br />\| timeslice 1d<br />\| sum (shutdown) as shutdown, sum(startup) as startup by \_timeslice|
|Apache Tomcat - OpenTelemetry|Thread Distribution by Server|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.threads state=busy \| sum by deployment.environment, webengine.cluster.name, webengine.node.name, proto\_handler |
|Apache Tomcat - OpenTelemetry/Logs|Threat Breakdown by Sources|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_source |
|Apache Tomcat - OpenTelemetry/Logs|Threat by Actors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by Actor|
|Apache Tomcat - OpenTelemetry/Logs|Threat by Malicious Confidence|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by malicious\_confidence|
|Apache Tomcat - OpenTelemetry/Logs|Threat Count|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|Apache Tomcat - OpenTelemetry/Logs|Threat Locations|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| count by remote\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Apache Tomcat - OpenTelemetry/Logs|Threat Table|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup type, actor, raw, threatlevel as Malicious\_Confidence from sumo://threat/cs on threat=remote\_ip <br />\| where  type="ip\_address" and !isNull(Malicious\_Confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| where Malicious\_Confidence matches "high"<br />\| count by Malicious\_Confidence, Actor, remote\_ip, status\_code, uri<br />\| sort by \_count<br />\| limit 50|
|Apache Tomcat - OpenTelemetry/Logs|Top 10 Bots Observed|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br /> \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"(?\<referrer\>http[s]{0,1}:[^\\"]+)\\"\\s+\\"(?\<user\_agent\>.\*)\\"" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Exabot?)\\W"<br />\| where bot\_name != ""<br />\| if (bot\_name="bing","Bing",bot\_name) as bot\_name<br />\| count as count by bot\_name<br />\| sort by count<br />\| limit 10|
|Apache Tomcat - OpenTelemetry/Logs|Top 10 Host - High GC Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[Metaspace: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| sum(GCOperationTime) as GCOperationTime by Host<br />\| Top 10 Host by GCOperationTime|
|Apache Tomcat - OpenTelemetry/Logs|Top 10 Hosts - Low Average JVM Up-Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[Metaspace: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| avg(gctmaftrJVMStrt) as gctmaftrJVMStrt by Host<br />\| Top 10 Host by gctmaftrJVMStrt asc|
|Apache Tomcat - OpenTelemetry/Logs|Top 10 Recent Exceptions|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Catalina Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<time\>\\w+\\s+\\d+,\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+\\w+)\\s+(?\<Component\>[\\w\\S]+)\\s+(?\<method\>[\\w\\S]+)\\s+(?\<loglevel\>\\w+):\\s+(?\<message\>[\\s\\w]+)\\n(?\<thrown\>[\\s\\S]+)\$"<br />\| where thrown!=""<br />\| parse regex field=thrown "\\((?\<sourcefile\>[^\\)]+)"<br />\| count by time, loglevel, message, method, sourcefile, thrown<br />\| fields time,loglevel, message, method,sourcefile, thrown<br />\| sort by time \| limit 10|
|Apache Tomcat - OpenTelemetry/Logs|Top 10 Search Terms from Popular Search Engines|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} (google or bing or aol or ask or yahoo) ("p=" or "q=" or "wd=" or "searchfor=")<br /> \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"(?\<referrer\>http[s]{0,1}:[^\\"]+)\\""<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)"<br />\| where search\_term != ""<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*","Google","") as engine<br />\| if(referrer matches "\*bing.\*","Bing",engine) as engine<br />\| if(referrer matches "\*ask.com\*","Ask.com",engine) as engine<br />\| if(referrer matches "\*aol.\*","AOL",engine) as engine<br />\| if(referrer matches "\*yahoo.\*","Yahoo",engine) as engine<br />\| where engine != ""<br />\| count as count  by search\_term<br />\| sort count \| limit 10|
|Apache Tomcat - OpenTelemetry|Top 10 URLs causing Errors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| count by uri,webengine.node.name<br />\| top 10 webengine.node.name,uri by \_count|
|Apache Tomcat - OpenTelemetry/Logs|Top 5 Clients Causing 4xx Errors|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} 404 \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code matches "4\*"<br />\| count as count by remote\_ip<br />\| sort count <br />\| limit 5 |
|Apache Tomcat - OpenTelemetry/Logs|Top 5 Highly Malicious URLs|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Threat Intel|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as ip\_count by remote\_ip, uri<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=remote\_ip <br />\| where malicious\_confidence matches "high"<br />\| count by uri<br />\| limit 5|
|Apache Tomcat - OpenTelemetry/Logs|Top 5 Referrers|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"(?\<referrer\>http[s]{0,1}:[^\\"\\?]+?)(?:\\"\|\\?)"<br />\| where length(referrer) \> 1<br />\| count as count by referrer<br />\| sort by count<br />\| limit 5 |
|Apache Tomcat - OpenTelemetry/Logs|Top 5 URIs causing 404 Responses|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Web Server Operations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} (400 OR 401 OR 402 OR 403 OR 404) \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where status\_code = "404"<br />\| count as count by uri<br />\| sort count, uri asc<br />\| limit 5|
|Apache Tomcat - OpenTelemetry/Logs|Top 5 URLs|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Traffic Insight|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| count as count by uri<br />\| sort by count<br />\| limit 5|
|Apache Tomcat - OpenTelemetry/Metrics|Total Bytes Received|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.traffic direction=received  \| sum by deployment.environment,webengine.cluster.name,webengine.node.name,proto\_handler|
|Apache Tomcat - OpenTelemetry/Metrics|Total Bytes Received|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.traffic direction=received  \| sum by metric \| eval \_value/1024/1024/1024|
|Apache Tomcat - OpenTelemetry/Metrics|Total Bytes Sent|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.traffic direction=sent \| sum by metric \| eval \_value/1024/1024/1024|
|Apache Tomcat - OpenTelemetry/Metrics|Total Bytes Sent|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.traffic direction=sent \| sum by deployment.environment,webengine.cluster.name,webengine.node.name,proto\_handler|
|Apache Tomcat - OpenTelemetry/Metrics|Total Connectors|Metrics|Installed Apps/Apache Tomcat - OpenTelemetry/Metrics/Apache Tomcat - Connectors|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} metric=tomcat.request\_count  \| sum by metric|
|Apache Tomcat - OpenTelemetry/Logs|Total GC Operation Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| sum(GCOperationTime) as GCOperationTime by \_timeslice|
|Apache Tomcat - OpenTelemetry/Logs|Total GC Operations|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Garbage Collection|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} "Times: user" "sys" "real" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] \\[ParOldGen: (?\<OldBfrGC\>\\d+)K-\>(?\<OldAftrGC\>\\d+)K\\((?\<OldSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\) \\[PSPermGen: (?\<PermBfrGC\>\\d+)K-\>(?\<PermAftrGC\>\\d+)K\\((?\<permSize\>\\d+)K\\)], (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]" nodrop<br />\| parse regex "(?\<gctmaftrJVMStrt\>[\\d.]+): \\[(?\<GCType\>.\*) \\[PSYoungGen: (?\<YngBfrGC\>\\d+)K-\>(?\<YngAftrGC\>\\d+)K\\((?\<YngSize\>\\d+)K\\)] (?\<HeapBfrGC\>\\d+)K-\>(?\<HeapAftrGC\>\\d+)K\\((?\<HeapSize\>\\d+)K\\), (?\<GCOperationTime\>[\\d.]+) secs] \\[Times: user=(?\<usertime\>[\\d.]+) sys=(?\<systime\>[\\d.]+), real=(?\<realtime\>[\\d.]+) secs]"<br />\| timeslice 15m<br />\| count as count by \_timeslice, GCType<br />\| transpose row \_timeslice column GCType|
|Apache Tomcat - OpenTelemetry/Logs|Traffic Distribution by Server|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| timeslice 1h<br />\| count by \_timeslice, host  <br />\| transpose row \_timeslice column host|
|Apache Tomcat - OpenTelemetry/Logs|Traffic Volume and Bytes Served|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where size != "-"<br />\| timeslice 1h<br />\| (size/(1048576\*1000)) as gbytes <br />\| count as hits, sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc|
|Apache Tomcat - OpenTelemetry/Logs|United States|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Locations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| where country\_name="United States" \| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Apache Tomcat - OpenTelemetry|Visitor Locations|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Apache Tomcat - Overview|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| where !(remote\_ip matches "127.0.0.1")<br />\| lookup latitude, longitude from geo://location on ip = remote\_ip<br />\| count by latitude, longitude<br />\| sort \_count|
|Apache Tomcat - OpenTelemetry/Logs|Visitor Locations - One Day Time Comparison|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Logs Timeline Analysis|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| where !isEmpty(country\_name)<br />\| count as Visitors\_Locations by country\_name<br />\| sort Visitors\_Locations <br />\| compare with timeshift 1d<br />\| limit 10|
|Apache Tomcat - OpenTelemetry/Logs|Visits by Country Over Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Locations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| where !isNull(country\_name) AND country\_name != ""<br />\| timeslice 5m<br />\| count by \_timeslice, country\_name <br />\| transpose row \_timeslice column country\_name as \*|
|Apache Tomcat - OpenTelemetry/Logs|Visits by US State Over Time|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Locations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| timeslice 5m<br />\| where country\_name="United States" AND !isNull(region) AND region != ""<br />\| count by \_timeslice, region <br />\| transpose row \_timeslice column region as \*|
|Apache Tomcat - OpenTelemetry/Logs|Worldwide|Logs|Installed Apps/Apache Tomcat - OpenTelemetry/Logs/Apache Tomcat - Visitor Locations|sumo.datasource=tomcat deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as \_raw <br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "(?\<remote\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<local\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})\\s+(?\<user\>\\S+)\\s+(?\<hostname\>[\\S]+)\\s+\\[" nodrop<br />\| parse regex "\\s+\\[(?\<date\>[^\\]]+)\\]\\s+\\"(?\<method\>\\w+)\\s+(?\<uri\>\\S+)\\s+(?\<protocol\>\\S+)\\"\\s+(?\<status\_code\>\\d+)\\s+(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "\\"\\s+\\d+\\s+[\\d-]+\\s+(?\<timetaken\>[\\d-]+)"<br />\|  lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|

