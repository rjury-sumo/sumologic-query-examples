# Kubernetes - Control Plane >= 1.16

## Searches

### Log Searches

- **Alerts by Priority**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Alerts by Priority**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Anonymous Request Allowed**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Anonymous Request Allowed**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Attach to cluster-admin Role**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Attach to cluster-admin Role**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Attach/Exec Pod**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Attach/Exec Pod**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **ClusterRole With Pod Exec Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **ClusterRole With Pod Exec Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **ClusterRole With Wildcard Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **ClusterRole With Wildcard Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **ClusterRole With Write Privileges Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **ClusterRole With Write Privileges Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create Disallowed Pod**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create Disallowed Pod**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create HostNetwork Pod**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create HostNetwork Pod**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create NodePort Service**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create NodePort Service**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create Privileged Pod**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create Privileged Pod**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create Sensitive Mount Pod**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create Sensitive Mount Pod**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create/Modify Configmap With Private Credentials**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Create/Modify Configmap With Private Credentials**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Error Logs**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Error Logs**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Error Logs**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Error Logs**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Error Messages**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Error Messages**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Error Messages Count**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Error Messages Count**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Error Stream**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Error Stream**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Events by User**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Events by User**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Job Creations**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Job Creations**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Job Deletions**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Job Deletions**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **K8s ConfigMap Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s ConfigMap Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Deployment Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Deployment Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Deployment Deleted**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Deployment Deleted**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Namespace Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Namespace Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Namespace Deleted**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Namespace Deleted**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Role/Clusterrole Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Role/Clusterrole Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Role/Clusterrole Deleted**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Role/Clusterrole Deleted**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Role/Clusterrolebinding Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Role/Clusterrolebinding Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Role/Clusterrolebinding Deleted**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Role/Clusterrolebinding Deleted**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Service Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Service Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Service Deleted**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Service Deleted**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Serviceaccount Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Serviceaccount Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Serviceaccount Deleted**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **K8s Serviceaccount Deleted**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Kubernetes Rules Triggerred**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Kubernetes Rules Triggerred**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Logs**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Logs**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Message Breakdown by Container**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Message Breakdown by Container**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Operation by a disallowed K8s User**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Operation by a disallowed K8s User**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Pod and Containers Running in Kube-System**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Pod and Containers Running in Kube-System**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Pod Created in Kube Namespace**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Pod Created in Kube Namespace**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Pods Created**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Pods Created**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Pods Deleted**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Pods Deleted**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Scale Operations**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Scale Operations**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Service Account Created in Kube Namespace**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Service Account Created in Kube Namespace**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Severity Breakdown**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Severity Breakdown**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Severity Breakdown**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Severity Breakdown**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Severity Over Time**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Severity Over Time**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Severity Over Time**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Severity Over Time**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **System ClusterRole Modified/Deleted**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **System ClusterRole Modified/Deleted**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **System Message Breakdown**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **System Message Breakdown**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Kube System 
- **Top 10 Kubernetes Rules Triggered**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events 
- **Top 10 Kubernetes Rules Triggered**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Security Audit Events

### Metric Searches

- **500s by Method**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **500s by Method**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Api Server Request Rates by  Clients**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Api Server Request Rates by  Clients**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **API Server Successful Request Rates**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **API Server Successful Request Rates**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **API Server Successful vs Failure Request Rates**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **API Server Successful vs Failure Request Rates**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Bytes sent/Recieved by Client**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Bytes sent/Recieved by Client**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Cache Hit Percentage**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Cache Hit Percentage**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **DB Size**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **DB Size**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Disk Sync Duration**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Disk Sync Duration**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Expire Count**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Expire Count**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Failed Proposals**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Failed Proposals**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Leader Changes**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Leader Changes**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Leaders**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Leaders**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Pending Proposals**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Pending Proposals**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Proposals**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Proposals**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Request Count by Method**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Request Count by Method**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - API Server 
- **Resource Usage - CPU Time Spent**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Resource Usage - CPU Time Spent**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Resource Usage - Memory Usage**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Resource Usage - Memory Usage**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Resource Usage - Open File Descriptors**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Resource Usage - Open File Descriptors**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Scheduler End-to-End Binding Latency**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Scheduler 
- **Scheduler End-to-End Binding Latency**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Scheduler 
- **Scheduling Algorithm Latency**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Scheduler 
- **Scheduling Algorithm Latency**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Scheduler 
- **Scheduling Latency**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Scheduler 
- **Scheduling Latency**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Scheduler 
- **Status**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Scheduler 
- **Status**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Status**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - Controller Manager 
- **Status**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - Scheduler 
- **Watchers**: from Dashboard: Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3 
- **Watchers**: from Dashboard: Installed Apps/Kubernetes - Control Plane >= 1.16/Kubernetes - etcd3

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Kubernetes - Control Plane \>= 1.16|500s by Method|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|(metric=apiserver\_request\_total or metric=apiserver\_request\_count) cluster={{cluster}} code=5\* \| quantize 1m \| rate \| sum by verb|
|Kubernetes - Control Plane \>= 1.16|500s by Method|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|(metric=apiserver\_request\_total or metric=apiserver\_request\_count) cluster={{cluster}} code=5\* \| quantize 1m \| rate \| sum by verb|
|Kubernetes - Control Plane \>= 1.16|Alerts by Priority|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output<br />\| json field=\_raw "\$['log']['output\_fields']['ka.user.name']" as user\_name<br />\| json field=\_raw "log.priority" as priority<br />\| count by priority|
|Kubernetes - Control Plane \>= 1.16|Alerts by Priority|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output<br />\| json field=\_raw "\$['log']['output\_fields']['ka.user.name']" as user\_name<br />\| json field=\_raw "log.priority" as priority<br />\| count by priority|
|Kubernetes - Control Plane \>= 1.16|Anonymous Request Allowed|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Anonymous Request Allowed"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Anonymous Request Allowed|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Anonymous Request Allowed"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Api Server Request Rates by  Clients|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server| cluster={{cluster}}  (metric=apiserver\_request\_count or metric=apiserver\_request\_total) \| quantize 5m \| rate \| sum by client \| topk(500, max)|
|Kubernetes - Control Plane \>= 1.16|Api Server Request Rates by  Clients|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server| cluster={{cluster}}  (metric=apiserver\_request\_count or metric=apiserver\_request\_total) \| quantize 5m \| rate \| sum by client \| topk(500, max)|
|Kubernetes - Control Plane \>= 1.16|API Server Successful Request Rates|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|  cluster={{cluster}} (metric=apiserver\_request\_total or metric=apiserver\_request\_count) code=2\*  \| quantize 5m \| rate \| sum by cluster \| topk(500, max)|
|Kubernetes - Control Plane \>= 1.16|API Server Successful Request Rates|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|  cluster={{cluster}} (metric=apiserver\_request\_total or metric=apiserver\_request\_count) code=2\*  \| quantize 5m \| rate \| sum by cluster \| topk(500, max)|
|Kubernetes - Control Plane \>= 1.16|API Server Successful vs Failure Request Rates|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|  cluster={{cluster}} (metric=apiserver\_request\_total or metric=apiserver\_request\_count) !code=2\*  \| quantize 5m \| rate \| sum by cluster|
|Kubernetes - Control Plane \>= 1.16|API Server Successful vs Failure Request Rates|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|  cluster={{cluster}} (metric=apiserver\_request\_total or metric=apiserver\_request\_count) !code=2\*  \| quantize 5m \| rate \| sum by cluster|
|Kubernetes - Control Plane \>= 1.16|Attach to cluster-admin Role|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Attach to cluster-admin Role"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Attach to cluster-admin Role|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Attach to cluster-admin Role"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Attach/Exec Pod|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Attach/Exec Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Attach/Exec Pod|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Attach/Exec Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Bytes sent/Recieved by Client|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_network\_client\_grpc\_received\_bytes\_total \| quantize 1m \| rate \| sum|
|Kubernetes - Control Plane \>= 1.16|Bytes sent/Recieved by Client|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_network\_client\_grpc\_received\_bytes\_total \| quantize 1m \| rate \| sum|
|Kubernetes - Control Plane \>= 1.16|Cache Hit Percentage|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_grpc\_proxy\_cache\_hits\_total \| quantize 1m |
|Kubernetes - Control Plane \>= 1.16|Cache Hit Percentage|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_grpc\_proxy\_cache\_hits\_total \| quantize 1m |
|Kubernetes - Control Plane \>= 1.16|ClusterRole With Pod Exec Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="ClusterRole With Pod Exec Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|ClusterRole With Pod Exec Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="ClusterRole With Pod Exec Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|ClusterRole With Wildcard Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="ClusterRole With Wildcard Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|ClusterRole With Wildcard Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="ClusterRole With Wildcard Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|ClusterRole With Write Privileges Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="ClusterRole With Write Privileges Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|ClusterRole With Write Privileges Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="ClusterRole With Write Privileges Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create Disallowed Pod|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create Sensitive Mount Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create Disallowed Pod|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create Sensitive Mount Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create HostNetwork Pod|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create HostNetwork Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create HostNetwork Pod|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create HostNetwork Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create NodePort Service|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create NodePort Service"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create NodePort Service|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create NodePort Service"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create Privileged Pod|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create Privileged Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create Privileged Pod|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create Privileged Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create Sensitive Mount Pod|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create Sensitive Mount Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create Sensitive Mount Pod|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create Sensitive Mount Pod"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create/Modify Configmap With Private Credentials|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create/Modify Configmap With Private Credentials"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Create/Modify Configmap With Private Credentials|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Create/Modify Configmap With Private Credentials"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|DB Size|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_debugging\_mvcc\_db\_total\_size\_in\_bytes \| quantize 1m \| max by instance \| eval \_value/1000000000  \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|DB Size|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_debugging\_mvcc\_db\_total\_size\_in\_bytes \| quantize 1m \| max by instance \| eval \_value/1000000000  \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Disk Sync Duration|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_disk\_wal\_fsync\_duration\_seconds\_bucket \| quantize 1m \| rate \| sum by instance|
|Kubernetes - Control Plane \>= 1.16|Disk Sync Duration|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_disk\_wal\_fsync\_duration\_seconds\_bucket \| quantize 1m \| rate \| sum by instance|
|Kubernetes - Control Plane \>= 1.16|Error Logs|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}}  error<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity == "E"<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm") as MessageTime<br />\| count by MessageTime,severity, container, namespace,pod,log|
|Kubernetes - Control Plane \>= 1.16|Error Logs|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|\_sourceCategory={{ApiServerLogSource}}  cluster={{cluster}} (error OR warning)<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity == "E"<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm") as MessageTime<br />\| count by MessageTime,severity,log|
|Kubernetes - Control Plane \>= 1.16|Error Logs|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|\_sourceCategory={{ApiServerLogSource}}  cluster={{cluster}} (error OR warning)<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity == "E"<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm") as MessageTime<br />\| count by MessageTime,severity,log|
|Kubernetes - Control Plane \>= 1.16|Error Logs|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}}  error<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity == "E"<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm") as MessageTime<br />\| count by MessageTime,severity, container, namespace,pod,log|
|Kubernetes - Control Plane \>= 1.16|Error Messages|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System| \_sourceCategory={{KubeSystemLogSource}}  <br />\| parse "\\"log\\":\\"\*       \*\\"" as log\_code,log\_message<br />\| parse field=log\_message "\* \*.\*:\*]\*" as step, resource, action, step\_code, msg<br />\| parse field=log\_code "\* \*" as severity, timestmp<br />\| where severity matches "E\*"<br />\| count by container, severity, resource, msg <br />\| limit 10|
|Kubernetes - Control Plane \>= 1.16|Error Messages|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System| \_sourceCategory={{KubeSystemLogSource}}  <br />\| parse "\\"log\\":\\"\*       \*\\"" as log\_code,log\_message<br />\| parse field=log\_message "\* \*.\*:\*]\*" as step, resource, action, step\_code, msg<br />\| parse field=log\_code "\* \*" as severity, timestmp<br />\| where severity matches "E\*"<br />\| count by container, severity, resource, msg <br />\| limit 10|
|Kubernetes - Control Plane \>= 1.16|Error Messages Count|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}} <br />\| json field=\_raw "log" as log<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity = "E"<br />\| count log<br />\| sort by \_count<br />\| limit 10|
|Kubernetes - Control Plane \>= 1.16|Error Messages Count|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}} <br />\| json field=\_raw "log" as log<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity = "E"<br />\| count log<br />\| sort by \_count<br />\| limit 10|
|Kubernetes - Control Plane \>= 1.16|Error Stream|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System|\_sourceCategory={{KubeSystemLogSource}}  error<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity == "E"<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm") as MessageTime<br />\| count by MessageTime,severity, container, namespace,pod,log|
|Kubernetes - Control Plane \>= 1.16|Error Stream|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System|\_sourceCategory={{KubeSystemLogSource}}  error<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity == "E"<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm") as MessageTime<br />\| count by MessageTime,severity, container, namespace,pod,log|
|Kubernetes - Control Plane \>= 1.16|Events by User|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output<br />\| json field=\_raw "log.priority" as priority<br />\| json field=\_raw "log.rule" as rule<br />//\| where rule="All K8s Audit Events"<br />\| json field=\_raw "\$['log']['output\_fields']['ka.user.name']" as user\_name<br />\| count by user\_name|
|Kubernetes - Control Plane \>= 1.16|Events by User|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output<br />\| json field=\_raw "log.priority" as priority<br />\| json field=\_raw "log.rule" as rule<br />//\| where rule="All K8s Audit Events"<br />\| json field=\_raw "\$['log']['output\_fields']['ka.user.name']" as user\_name<br />\| count by user\_name|
|Kubernetes - Control Plane \>= 1.16|Expire Count|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_debugging\_store\_expires\_total \|sum \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Expire Count|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_debugging\_store\_expires\_total \|sum \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Failed Proposals|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_proposals\_failed\_total \| quantize 1m \| sum \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Failed Proposals|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_proposals\_failed\_total \| quantize 1m \| sum \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Job Creations|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|	\_sourceCategory={{ControlManagerLogSource}}  "Created job"<br />	\| json field=\_raw "log" as log<br />	\| parse field=log "Created job \*" as job<br />  \| parse field=log "\* \*       " as code,time<br />  \| count by time, job|
|Kubernetes - Control Plane \>= 1.16|Job Creations|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|	\_sourceCategory={{ControlManagerLogSource}}  "Created job"<br />	\| json field=\_raw "log" as log<br />	\| parse field=log "Created job \*" as job<br />  \| parse field=log "\* \*       " as code,time<br />  \| count by time, job|
|Kubernetes - Control Plane \>= 1.16|Job Deletions|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}}  "Deleted job"<br />\| json field=\_raw "log" as log<br />\| parse field=log "Deleted job \*" as job\_name<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Job Deletions|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}}  "Deleted job"<br />\| json field=\_raw "log" as log<br />\| parse field=log "Deleted job \*" as job\_name<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s ConfigMap Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s ConfigMap Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s ConfigMap Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s ConfigMap Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Deployment Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Deployment Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Deployment Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Deployment Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Deployment Deleted|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Deployment Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Deployment Deleted|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Deployment Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Namespace Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Namespace Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Namespace Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Namespace Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Namespace Deleted|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Namespace Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Namespace Deleted|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Namespace Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Role/Clusterrole Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Role/Clusterrole Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Role/Clusterrole Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Role/Clusterrole Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Role/Clusterrole Deleted|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Role/Clusterrole Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Role/Clusterrole Deleted|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Role/Clusterrole Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Role/Clusterrolebinding Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Role/Clusterrolebinding Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Role/Clusterrolebinding Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Role/Clusterrolebinding Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Role/Clusterrolebinding Deleted|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Role/Clusterrolebinding Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Role/Clusterrolebinding Deleted|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Role/Clusterrolebinding Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Service Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Service Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Service Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Service Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Service Deleted|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Service Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Service Deleted|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Service Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Serviceaccount Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Serviceaccount Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Serviceaccount Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Serviceaccount Created"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Serviceaccount Deleted|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Serviceaccount Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|K8s Serviceaccount Deleted|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="K8s Serviceaccount Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Kubernetes Rules Triggerred|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output<br />\| json field=\_raw "log.priority" as priority<br />\| json field=\_raw "log.rule" as rule<br />\| json field=\_raw "log.time" as time<br />\| json field=\_raw "log.output" as output<br />\| json field=\_raw "\$['log']['output\_fields']['ka.user.name']" as user\_name<br />\| json field=\_raw "\$['log']['output\_fields']['ka.target.name']" as target\_name<br />\| json field=\_raw "\$['log']['output\_fields']['ka.target.namespace']" as target\_namespace<br />\| count by time, rule, priority, user\_name, target\_name, target\_namespace, output<br />\| sort by time<br />\| limit 500<br />//\| fields - \_count|
|Kubernetes - Control Plane \>= 1.16|Kubernetes Rules Triggerred|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output<br />\| json field=\_raw "log.priority" as priority<br />\| json field=\_raw "log.rule" as rule<br />\| json field=\_raw "log.time" as time<br />\| json field=\_raw "log.output" as output<br />\| json field=\_raw "\$['log']['output\_fields']['ka.user.name']" as user\_name<br />\| json field=\_raw "\$['log']['output\_fields']['ka.target.name']" as target\_name<br />\| json field=\_raw "\$['log']['output\_fields']['ka.target.namespace']" as target\_namespace<br />\| count by time, rule, priority, user\_name, target\_name, target\_namespace, output<br />\| sort by time<br />\| limit 500<br />//\| fields - \_count|
|Kubernetes - Control Plane \>= 1.16|Leader Changes|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_leader\_changes\_seen\_total \| max \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Leader Changes|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_leader\_changes\_seen\_total \| max \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Leaders|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_has\_leader \| max \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Leaders|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_has\_leader \| max \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Logs|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} pod=\*etcd\*<br />\| limit 100<br />\| json  "log"<br />\| count by log, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime, \_count|
|Kubernetes - Control Plane \>= 1.16|Logs|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} pod=\*etcd\*<br />\| limit 100<br />\| json  "log"<br />\| count by log, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime, \_count|
|Kubernetes - Control Plane \>= 1.16|Message Breakdown by Container|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System| \_sourceCategory={{KubeSystemLogSource}}  <br />\| parse "\\"log\\":\\"\*       \*\\"" as log\_code,log\_message<br />\| parse field=log\_message "\* \*.\*:\*]\*" as step, resource, action, step\_code, specific\_message<br />\| fields - log\_message<br />\| count container \| top 10 container by \_count|
|Kubernetes - Control Plane \>= 1.16|Message Breakdown by Container|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System| \_sourceCategory={{KubeSystemLogSource}}  <br />\| parse "\\"log\\":\\"\*       \*\\"" as log\_code,log\_message<br />\| parse field=log\_message "\* \*.\*:\*]\*" as step, resource, action, step\_code, specific\_message<br />\| fields - log\_message<br />\| count container \| top 10 container by \_count|
|Kubernetes - Control Plane \>= 1.16|Operation by a disallowed K8s User|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Disallowed K8s User"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Operation by a disallowed K8s User|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Disallowed K8s User"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Pending Proposals|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_proposals\_pending \| quantize 1m \| sum \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Pending Proposals|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_proposals\_pending \| quantize 1m \| sum \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Pod and Containers Running in Kube-System|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System|\_sourceCategory={{KubeSystemLogSource}}  <br />\| count by namespace, pod, container<br />\| limit 100|
|Kubernetes - Control Plane \>= 1.16|Pod and Containers Running in Kube-System|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System|\_sourceCategory={{KubeSystemLogSource}}  <br />\| count by namespace, pod, container<br />\| limit 100|
|Kubernetes - Control Plane \>= 1.16|Pod Created in Kube Namespace|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Pod Created in Kube Namespace"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Pod Created in Kube Namespace|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Pod Created in Kube Namespace"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Pods Created|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|	\_sourceCategory={{ControlManagerLogSource}}  "Created pod:"<br />	\| json field=\_raw "log" as log<br />	\| parse field=log "Created pod: \*" as pod<br />  \| parse field=log "\* \*       " as code,time<br />  \| count by time, pod|
|Kubernetes - Control Plane \>= 1.16|Pods Created|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|	\_sourceCategory={{ControlManagerLogSource}}  "Created pod:"<br />	\| json field=\_raw "log" as log<br />	\| parse field=log "Created pod: \*" as pod<br />  \| parse field=log "\* \*       " as code,time<br />  \| count by time, pod|
|Kubernetes - Control Plane \>= 1.16|Pods Deleted|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|	\_sourceCategory={{ControlManagerLogSource}}  "Deleted pod:"<br />	\| json field=\_raw "log" as log<br />	\| parse field=log "Deleted pod: \*" as pod<br />  \| parse field=log "\* \*       " as code,time<br />  \| count by time, pod|
|Kubernetes - Control Plane \>= 1.16|Pods Deleted|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|	\_sourceCategory={{ControlManagerLogSource}}  "Deleted pod:"<br />	\| json field=\_raw "log" as log<br />	\| parse field=log "Deleted pod: \*" as pod<br />  \| parse field=log "\* \*       " as code,time<br />  \| count by time, pod|
|Kubernetes - Control Plane \>= 1.16|Proposals|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_proposals\_failed\_total \| quantize 1m \| rate \| sum|
|Kubernetes - Control Plane \>= 1.16|Proposals|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_server\_proposals\_failed\_total \| quantize 1m \| rate \| sum|
|Kubernetes - Control Plane \>= 1.16|Request Count by Method|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|(metric=apiserver\_request\_total or metric=apiserver\_request\_count) cluster={{cluster}} \| quantize 1m \| rate \| sum by verb|
|Kubernetes - Control Plane \>= 1.16|Request Count by Method|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|(metric=apiserver\_request\_total or metric=apiserver\_request\_count) cluster={{cluster}} \| quantize 1m \| rate \| sum by verb|
|Kubernetes - Control Plane \>= 1.16|Resource Usage - CPU Time Spent|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=process\_cpu\_seconds\_total job= kube-etcd \|  quantize 1m \|sum|
|Kubernetes - Control Plane \>= 1.16|Resource Usage - CPU Time Spent|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=process\_cpu\_seconds\_total job= kube-etcd \|  quantize 1m \|sum|
|Kubernetes - Control Plane \>= 1.16|Resource Usage - Memory Usage|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=process\_resident\_memory\_bytes job= kube-etcd\|  quantize 1m \|sum \| eval \_value/1000000000|
|Kubernetes - Control Plane \>= 1.16|Resource Usage - Memory Usage|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=process\_resident\_memory\_bytes job= kube-etcd\|  quantize 1m \|sum \| eval \_value/1000000000|
|Kubernetes - Control Plane \>= 1.16|Resource Usage - Open File Descriptors|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=process\_open\_fds job= kube-etcd \|  quantize 1m \|sum|
|Kubernetes - Control Plane \>= 1.16|Resource Usage - Open File Descriptors|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=process\_open\_fds job= kube-etcd \|  quantize 1m \|sum|
|Kubernetes - Control Plane \>= 1.16|Scale Operations|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}}  Scaled<br />\| json field=\_raw "log" as log<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity == "I"<br />\| parse field=log "Scaled \* replica set \* to \*" as direction,replica\_set,scaled\_to<br />\| first(scaled\_to) as scaled\_to by  replica\_set |
|Kubernetes - Control Plane \>= 1.16|Scale Operations|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}}  Scaled<br />\| json field=\_raw "log" as log<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| where severity == "I"<br />\| parse field=log "Scaled \* replica set \* to \*" as direction,replica\_set,scaled\_to<br />\| first(scaled\_to) as scaled\_to by  replica\_set |
|Kubernetes - Control Plane \>= 1.16|Scheduler End-to-End Binding Latency|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - Scheduler| cluster={{cluster}} metric=scheduler\_binding\_duration\_seconds\_sum  \| quantize 5m \| sum by cluster|
|Kubernetes - Control Plane \>= 1.16|Scheduler End-to-End Binding Latency|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Scheduler| cluster={{cluster}} metric=scheduler\_binding\_duration\_seconds\_sum  \| quantize 5m \| sum by cluster|
|Kubernetes - Control Plane \>= 1.16|Scheduling Algorithm Latency|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Scheduler|cluster={{cluster}} metric=scheduler\_scheduling\_algorithm\_duration\_seconds\_sum  \| quantize 5m \| sum by cluster|
|Kubernetes - Control Plane \>= 1.16|Scheduling Algorithm Latency|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - Scheduler|cluster={{cluster}} metric=scheduler\_scheduling\_algorithm\_duration\_seconds\_sum  \| quantize 5m \| sum by cluster|
|Kubernetes - Control Plane \>= 1.16|Scheduling Latency|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - Scheduler|cluster={{cluster}} metric=scheduler\_e2e\_scheduling\_duration\_seconds\_sum \| quantize 5m \| sum by cluster|
|Kubernetes - Control Plane \>= 1.16|Scheduling Latency|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Scheduler|cluster={{cluster}} metric=scheduler\_e2e\_scheduling\_duration\_seconds\_sum \| quantize 5m \| sum by cluster|
|Kubernetes - Control Plane \>= 1.16|Service Account Created in Kube Namespace|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Service Account Created in Kube Namespace"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Service Account Created in Kube Namespace|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="Service Account Created in Kube Namespace"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|Severity Breakdown|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|	\_sourceCategory={{ControlManagerLogSource}}  <br />	\| json field=\_raw "log" as log<br />	\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />  \| count by severity<br />  \| sort by \_count|
|Kubernetes - Control Plane \>= 1.16|Severity Breakdown|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|	\_sourceCategory={{ControlManagerLogSource}}  <br />	\| json field=\_raw "log" as log<br />	\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />  \| count by severity<br />  \| sort by \_count|
|Kubernetes - Control Plane \>= 1.16|Severity Breakdown|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|\_sourceCategory={{ApiServerLogSource}} <br />\| json field=\_raw "timestamp"<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| count by severity<br />\| sort by \_count|
|Kubernetes - Control Plane \>= 1.16|Severity Breakdown|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|\_sourceCategory={{ApiServerLogSource}} <br />\| json field=\_raw "timestamp"<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| count by severity<br />\| sort by \_count|
|Kubernetes - Control Plane \>= 1.16|Severity Over Time|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|\_sourceCategory={{ApiServerLogSource}}  <br />\| json field=\_raw "timestamp"<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| timeslice 1h<br />\| count by \_timeslice, severity<br />\| transpose row \_timeslice column severity<br />\| fillmissing timeslice(1h)|
|Kubernetes - Control Plane \>= 1.16|Severity Over Time|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - API Server|\_sourceCategory={{ApiServerLogSource}}  <br />\| json field=\_raw "timestamp"<br />\| json field=\_raw "log"<br />\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />\| timeslice 1h<br />\| count by \_timeslice, severity<br />\| transpose row \_timeslice column severity<br />\| fillmissing timeslice(1h)|
|Kubernetes - Control Plane \>= 1.16|Severity Over Time|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}}  <br />	\| json field=\_raw "log" as log<br />	\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />	\| timeslice 1h<br />	\| count \_timeslice, severity <br />	\| transpose row \_timeslice column severity<br />  \| fillmissing timeslice(1h) |
|Kubernetes - Control Plane \>= 1.16|Severity Over Time|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|\_sourceCategory={{ControlManagerLogSource}}  <br />	\| json field=\_raw "log" as log<br />	\| parse regex field=log "^(?\<severity\>.)(?:[0-9])"<br />	\| timeslice 1h<br />	\| count \_timeslice, severity <br />	\| transpose row \_timeslice column severity<br />  \| fillmissing timeslice(1h) |
|Kubernetes - Control Plane \>= 1.16|Status|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|job=kube-controller-manager  metric=up cluster={{cluster}} \| quantize 5m \| sum|
|Kubernetes - Control Plane \>= 1.16|Status|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - Controller Manager|job=kube-controller-manager  metric=up cluster={{cluster}} \| quantize 5m \| sum|
|Kubernetes - Control Plane \>= 1.16|Status|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - Scheduler|metric=up (job=kube-scheduler\*) \| quantize 5m \| sum|
|Kubernetes - Control Plane \>= 1.16|Status|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Scheduler|metric=up (job=kube-scheduler\*) \| quantize 5m \| sum|
|Kubernetes - Control Plane \>= 1.16|System ClusterRole Modified/Deleted|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="System ClusterRole Modified/Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|System ClusterRole Modified/Deleted|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output <br />\| json field=\_raw "log.priority" as priority <br />\| json field=\_raw "log.rule" as rule<br />\| where rule="System ClusterRole Modified/Deleted"<br />\| count|
|Kubernetes - Control Plane \>= 1.16|System Message Breakdown|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System| \_sourceCategory={{KubeSystemLogSource}} <br />\| parse "\\"log\\":\\"\*       \*\\"" as log\_code,log\_message<br />\| parse field=log\_message "\* \*.\*:\*]\*" as step, resource, action, step\_code, log\_message\_spec<br />\| fields - log\_message \| count resource \| top 10 resource by \_count|
|Kubernetes - Control Plane \>= 1.16|System Message Breakdown|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Kube System| \_sourceCategory={{KubeSystemLogSource}} <br />\| parse "\\"log\\":\\"\*       \*\\"" as log\_code,log\_message<br />\| parse field=log\_message "\* \*.\*:\*]\*" as step, resource, action, step\_code, log\_message\_spec<br />\| fields - log\_message \| count resource \| top 10 resource by \_count|
|Kubernetes - Control Plane \>= 1.16|Top 10 Kubernetes Rules Triggered|Logs|Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output<br />\| json field=\_raw "log.priority" as priority<br />\| json field=\_raw "log.rule" as rule<br />\| json field=\_raw "\$['log']['output\_fields']['ka.user.name']" as ka\_user\_name<br />\| count by rule<br />\| limit 10 |
|Kubernetes - Control Plane \>= 1.16|Top 10 Kubernetes Rules Triggered|Logs|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - Security Audit Events|\_sourceCategory={{FalcoLogSource}}  ka output\_fields priority output<br />\| json field=\_raw "log.priority" as priority<br />\| json field=\_raw "log.rule" as rule<br />\| json field=\_raw "\$['log']['output\_fields']['ka.user.name']" as ka\_user\_name<br />\| count by rule<br />\| limit 10 |
|Kubernetes - Control Plane \>= 1.16|Watchers|Metrics|Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_debugging\_store\_watchers \| sum \| timeshift -2m|
|Kubernetes - Control Plane \>= 1.16|Watchers|Metrics|Installed Apps/Kubernetes - Control Plane \>= 1.16/Kubernetes - etcd3|cluster={{cluster}} metric=etcd\_debugging\_store\_watchers \| sum \| timeshift -2m|

