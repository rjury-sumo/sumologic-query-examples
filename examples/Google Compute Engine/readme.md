# Google Compute Engine

## Searches

### Log Searches

- **Google Compute Engine - Instance Statistics**: from Search: Google Compute Engine/Google Compute Engine - Instance Statistics 
- **Google Compute Engine - User Statistics**: from Search: Google Compute Engine/Google Compute Engine - User Statistics

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Google Compute Engine|Google Compute Engine - Instance Statistics|Logs|Google Compute Engine/Google Compute Engine - Instance Statistics|\_sourceCategory = Labs/Gcp/ComputeEngine\* logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "gce\_instance" and log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.protoPayload.resourceName" as resourceName <br />\| parse regex field=resourcename "projects/\\S+/zones/(?\<zone\>\\S+)/instances/(?\<instance\>\\S+)"<br />\| json "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName", "message.data.severity" as project, method, severity<br /><br />\| if (method matches "\*compute.instances.insert", 1, 0) as insert<br />\| if (method matches "\*compute.instances.delete", 1, 0) as delete<br />\| if (method matches "\*compute.instances.start", 1, 0) as start<br />\| if (method matches "\*compute.instances.stop", 1, 0) as stop<br />\| if (method matches "\*compute.instances.reset", 1, 0) as reset<br />\| if (severity matches "WARNING", 1, 0) as warning<br />\| if (severity matches "ERROR", 1, 0) as error<br />\| if (severity matches "CRITICAL", 1, 0) as critical<br />\| if (severity matches "ALERT", 1, 0) as alert<br />\| if (severity matches "EMERGENCY", 1, 0) as emergency<br /><br />\| sum(insert) as inserts, sum(delete) as deletes, sum(start) as starts, sum(stop) as stops, sum(reset) as resets, sum(warning) as warnings, sum(error) as errors, sum(critical) as criticals, sum(alert) as alerts, sum(emergency) as emergencies by instance, zone, project<br />\| inserts+deletes+starts+stops+resets as total\_activity<br />\| warnings+errors+criticals+alerts+emergencies as total\_severity<br />\| fields project, zone, instance, total\_activity, inserts, deletes, starts, stops, resets, total\_severity, emergencies, alerts, criticals, errors, warnings<br />\| sort by total\_activity|
|Google Compute Engine|Google Compute Engine - User Statistics|Logs|Google Compute Engine/Google Compute Engine - User Statistics|\_sourceCategory = Labs/Gcp/ComputeEngine\* logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "gce\_instance" and log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.protoPayload.resourceName" as resourceName <br />\| parse regex field=resourcename "projects/\\S+/zones/(?\<zone\>\\S+)/instances/(?\<instance\>\\S+)"<br />\| json "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail", "message.data.protoPayload.methodName", "message.data.severity" as project, user, method, severity<br /><br />\| if (method matches "\*compute.instances.insert", 1, 0) as insert<br />\| if (method matches "\*compute.instances.delete", 1, 0) as delete<br />\| if (method matches "\*compute.instances.start", 1, 0) as start<br />\| if (method matches "\*compute.instances.stop", 1, 0) as stop<br />\| if (method matches "\*compute.instances.reset", 1, 0) as reset<br />\| if (severity matches "WARNING", 1, 0) as warning<br />\| if (severity matches "ERROR", 1, 0) as error<br />\| if (severity matches "CRITICAL", 1, 0) as critical<br />\| if (severity matches "ALERT", 1, 0) as alert<br />\| if (severity matches "EMERGENCY", 1, 0) as emergency<br /><br />\| sum(insert) as inserts, sum(delete) as deletes, sum(start) as starts, sum(stop) as stops, sum(reset) as resets, sum(warning) as warnings, sum(error) as errors, sum(critical) as criticals, sum(alert) as alerts, sum(emergency) as emergencies by user<br />\| inserts+deletes+starts+stops+resets as total\_activity<br />\| warnings+errors+criticals+alerts+emergencies as total\_severity<br />\| fields user, total\_activity, inserts, deletes, starts, stops, resets, total\_severity, emergencies, alerts, criticals, errors, warnings<br />\| sort by total\_activity|

