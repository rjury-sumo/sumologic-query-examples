# Dropbox
## Sumo Logic App For: Dropbox
Dropbox is a file hosting service that offers cloud storage, file synchronization, personal cloud, and client software. The Sumo Logic App for Dropbox provides visibility into login events, file operations, file statistics, content-sharing operations, and admin actions. The App allows you to secure your dropbox account by monitoring key events such as logins from risky locations, failed logins, content shared with external/non-member users, and key admin actions.
Docs Link: [Dropbox](https://help.sumologic.com/?cid=60047)

## Searches

### Log Searches

- **Active Team Members**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Actors Performing Actions**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Admin Actions by Location**: from Dashboard: Installed Apps/Dropbox/Dropbox - Team Admin Actions 
- **Distribution of Team Linked Apps**: from Dashboard: Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions 
- **Distribution of User Linked Apps**: from Dashboard: Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions 
- **Events Category Distribution**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Failed Login Attempts**: from Dashboard: Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions 
- **Geo Locations of Events**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Geo Locations of File Operations**: from Dashboard: Installed Apps/Dropbox/Dropbox - File Statistics 
- **Linked Apps**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **List of Assets Shared with External Members**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **List of Assets Shared with Non Members**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Login Activity By Time**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Login Events by Location**: from Dashboard: Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions 
- **Recent Admin Actions**: from Dashboard: Installed Apps/Dropbox/Dropbox - Team Admin Actions 
- **Recent File Operations**: from Dashboard: Installed Apps/Dropbox/Dropbox - File Statistics 
- **Recently Added Members**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Share Events with Member**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Share Events with Non Members**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Sign-in From a High Risk Country**: from Dashboard: Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions 
- **Successful Device Links**: from Dashboard: Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions 
- **Top 10 Active Admins**: from Dashboard: Installed Apps/Dropbox/Dropbox - Team Admin Actions 
- **Top 10 Admin Actions**: from Dashboard: Installed Apps/Dropbox/Dropbox - Team Admin Actions 
- **Top 10 Applications**: from Dashboard: Installed Apps/Dropbox/Dropbox - File Statistics 
- **Top 10 File Operations**: from Dashboard: Installed Apps/Dropbox/Dropbox - File Statistics 
- **Top 10 Login & Session Event Types**: from Dashboard: Installed Apps/Dropbox/Dropbox - Overview 
- **Top 10 Users Performing File Operations**: from Dashboard: Installed Apps/Dropbox/Dropbox - File Statistics 
- **Top 10 Users with Device IP Changes**: from Dashboard: Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions 
- **User Activity for File Addition and Deletion**: from Dashboard: Installed Apps/Dropbox/Dropbox - File Statistics

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Dropbox|Active Team Members|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| json field=actor\_is\_team\_member "[0]" as true\_value\_actor\_is\_team\_member \| where %"true\_value\_actor\_is\_team\_member" = "team\_member"<br />\| where actor matches "\*admin\*" or actor matches "\*user\*"<br />\| timeslice 1h<br />\| count\_distinct(actor\_email) by \_timeslice<br />\| sort by \_timeslice|
|Dropbox|Actors Performing Actions|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| count as frequency by actor<br />\| sort by frequency|
|Dropbox|Admin Actions by Location|Logs|Installed Apps/Dropbox/Dropbox - Team Admin Actions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*reports\*") or  event\_category matches("\*domains\*") or  event\_category matches("\*sso\*") or  event\_category matches("\*team\_\*") or  event\_category matches("\*tfa\*")<br />\| count as frequency by location<br />\| where isValidIPv4(location) or isValidIPv6(location)<br />\| where !isNull(location)<br />\| if(isValidIPv4(location), if(!isPrivateIP(location),true,false),true) as all\_public<br />\| where all\_public<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = location|
|Dropbox|Distribution of Team Linked Apps|Logs|Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*apps\*")<br />\| where event\_type matches("\*app\_link\_team\*")<br />\| if(isNull(app\_name),"undefined",app\_name) as app\_name<br />\| count(app\_name) by app\_name<br />\| sort by \_count|
|Dropbox|Distribution of User Linked Apps|Logs|Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*apps\*")<br />\| where event\_type matches("\*app\_link\_user\*")<br />\| if(isNull(app\_name),"undefined",app\_name) as app\_name<br />\| count(app\_name) by app\_name<br />\| sort by \_count|
|Dropbox|Events Category Distribution|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}" <br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| count by event\_category<br />\| sort by event\_category|
|Dropbox|Failed Login Attempts|Logs|Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*logins\*")<br />\| where event\_type matches("\*login\_fail\*")<br />\| count as frequency by email, name<br />\| sort by frequency |
|Dropbox|Geo Locations of Events|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| count as frequency by location<br />\| where isValidIPv4(location) or isValidIPv6(location)<br />\| where !isNull(location)<br />\| if(isValidIPv4(location), if(!isPrivateIP(location),true,false),true) as all\_public<br />\| where all\_public<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = location|
|Dropbox|Geo Locations of File Operations|Logs|Installed Apps/Dropbox/Dropbox - File Statistics|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| where event\_type matches"{{event\_type}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*file\*") or  event\_category matches("\*paper\*")<br />\| count as frequency by location<br />\| where isValidIPv4(location) or isValidIPv6(location)<br />\| where !isNull(location)<br />\| if(isValidIPv4(location), if(!isPrivateIP(location),true,false),true) as all\_not\_private<br />\| where all\_not\_private<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = location|
|Dropbox|Linked Apps|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_type matches "\*app\_link\_user\*" or event\_type matches "\*app\_link\_team\*"<br />\| timeslice 1h<br />\| count\_distinct(app\_name) by \_timeslice<br />\| sort by \_timeslice|
|Dropbox|List of Assets Shared with External Members|Logs|Installed Apps/Dropbox/Dropbox - Overview|<br />\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where (!isNull(country))<br />\| where (!isNull(email))<br />\| json "\$['assets'][\*]['.tag']", "assets[\*].path.contextual", "participants[\*].user.email" as asset\_tags, asset\_path, external\_email<br />\| where !(asset\_tags="[]")<br />\| where !(asset\_path="[]")<br />\| where !(external\_email="[]")<br />\| where event\_category matches("\*sharing\*")<br />\| where involve\_non\_team\_member matches("true")<br />\| email as user\_email<br />\| count as frequency by user\_email, external\_email,asset\_tags,asset\_path<br />\| sort by frequency|
|Dropbox|List of Assets Shared with Non Members|Logs|Installed Apps/Dropbox/Dropbox - Overview|<br />\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| json "\$['assets'][\*]['.tag']", "assets[\*].path.contextual"as asset\_tags, asset\_path<br />\| where !(asset\_tags="[]")<br />\| where !(asset\_path="[]")<br />\| where event\_category matches("\*sharing\*")<br />\| where involve\_non\_team\_member matches("true")<br />\| count as frequency by asset\_tags,asset\_path<br />\| sort by frequency|
|Dropbox|Login Activity By Time|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("logins\*")<br />\| where event\_type matches ("\*success\*") or event\_type matches ("\*fail\*") <br />\| timeslice 1d<br />\| count by \_timeslice, event\_type<br />\| fillmissing timeslice, values all in event\_type<br />\| transpose row \_timeslice column event\_type as login\_success, login\_fail<br />\| ((login\_fail / (login\_success + login\_fail)) \* 100) as percentage\_fail |
|Dropbox|Login Events by Location|Logs|Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*logins\*")<br />\| count as frequency by location<br />\| where isValidIPv4(location) or isValidIPv6(location)<br />\| where !isNull(location)<br />\| if(isValidIPv4(location), if(!isPrivateIP(location),true,false),true) as all\_public<br />\| where all\_public<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = location|
|Dropbox|Recent Admin Actions|Logs|Installed Apps/Dropbox/Dropbox - Team Admin Actions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where (!isNull(email) and !isNull(country))<br />\| where event\_category matches("\*reports\*") or  event\_category matches("\*domains\*") or  event\_category matches("\*sso\*") or  event\_category matches("\*team\_\*") or  event\_category matches("\*tfa\*")<br />\| count\_distinct(email) by name,email,event\_type\_description,country,\_messageTime<br />\| top 100 name,email,event\_type\_description,country,\_messageTime by \_messageTime<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time<br />\| fields - \_messageTime<br />\| fields time,name,email,event\_type\_description,country<br />\| sort by time|
|Dropbox|Recent File Operations|Logs|Installed Apps/Dropbox/Dropbox - File Statistics|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| where event\_type matches"{{event\_type}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where (!isNull(country))<br />\| where (!isNull(email))<br />\| json "\$['assets'][\*]['.tag']", "assets[\*].path.contextual"as asset\_tags, asset\_path<br />\| where !(asset\_tags="[]")<br />\| where !(asset\_path="[]")<br />\| where event\_category matches("\*file\_operations\*") <br />\| count\_distinct(email) by email,name,country,\_messageTime,event\_type,asset\_tags, asset\_path<br />\| top 100 email,name,country,\_messageTime,event\_type,asset\_tags, asset\_path by \_messageTime<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time<br />\| fields - \_messageTime<br />\| fields time,email,name,country,event\_type,asset\_tags, asset\_path<br />\| sort by time|
|Dropbox|Recently Added Members|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where (!isNull(country)) and (!isNull(email))<br />\| where event\_type matches ("\*member\_change\_status\*")<br />\| json field=\_raw "\$['details']['new\_value']['.tag']" as new\_value \| where %"new\_value" = "active"<br />\| count\_distinct(email) by \_messageTime,email,name,country<br />\| top 100 email, name,country by \_messageTime<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time<br />\| fields - \_messageTime<br />\| fields name,email,country,time<br />\| sort by time|
|Dropbox|Share Events with Member|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*sharing\*")<br />\| where involve\_non\_team\_member matches("false")<br />\| count as frequency by event\_type<br />\| sort by frequency<br />\| limit 10|
|Dropbox|Share Events with Non Members|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*sharing\*")<br />\| where involve\_non\_team\_member matches("true")<br />\| count as frequency by event\_type<br />\| sort by frequency<br />\| limit 10|
|Dropbox|Sign-in From a High Risk Country|Logs|Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*logins\*")<br />\| where event\_type matches("login\_success")<br />\| count as frequency by location<br />\| where isValidIPv4(location) or isValidIPv6(location)<br />\| where !isEmpty(location)<br />\| if(isValidIPv4(location), if(!isPrivateIP(location),true,false),true) as is\_public<br />\| where is\_public<br />\| lookup latitude, longitude, country\_code from geo://location on ip = location <br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code <br />\| where !isBlank(country\_code)|
|Dropbox|Successful Device Links|Logs|Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where (!isNull(country) or !isNull(email))<br />\| where event\_category matches("\*devices\*")<br />\| where event\_type matches("\*device\_link\_success\*")<br />\| count\_distinct(email) by email,country,event\_type\_description,\_messageTime<br />\| top 100 email,country,event\_type\_description,\_messageTime by \_messageTime<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time<br />\| fields - \_messageTime<br />\| fields time,email,country,event\_type\_description<br />\| sort by time|
|Dropbox|Top 10 Active Admins|Logs|Installed Apps/Dropbox/Dropbox - Team Admin Actions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where (!isNull(country) and !isNull(email))<br />\| where event\_category matches("\*reports\*") or  event\_category matches("\*domains\*") or  event\_category matches("\*sso\*") or  event\_category matches("\*team\_\*") or  event\_category matches("\*tfa\*")<br />\| count as frequency by email,name,country<br />\| sort by frequency <br />\| limit 10|
|Dropbox|Top 10 Admin Actions|Logs|Installed Apps/Dropbox/Dropbox - Team Admin Actions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*reports\*") or  event\_category matches("\*domains\*") or  event\_category matches("\*sso\*") or  event\_category matches("\*team\_\*") or  event\_category matches("\*tfa\*")<br />\| count as frequency by event\_type<br />\| sort by frequency <br />\| limit 10|
|Dropbox|Top 10 Applications|Logs|Installed Apps/Dropbox/Dropbox - File Statistics|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| where event\_type matches"{{event\_type}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*file\*") or  event\_category matches("\*paper\*")<br />\| where actor matches("\*app\*")<br />\| count as frequency by app\_name<br />\| sort by frequency<br />\| limit 10|
|Dropbox|Top 10 File Operations|Logs|Installed Apps/Dropbox/Dropbox - File Statistics|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| where event\_type matches"{{event\_type}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*file\*") or  event\_category matches("\*paper\*")<br />\| count as frequency by event\_type<br />\| sort by frequency<br />\| limit 10|
|Dropbox|Top 10 Login & Session Event Types|Logs|Installed Apps/Dropbox/Dropbox - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*logins\*") or  event\_category matches("\*apps\*") or event\_category matches("\*devices\*") or event\_category matches("\*passwords\*")<br />\| count as frequency by event\_type\_description<br />\| sort by frequency<br />\| limit 10|
|Dropbox|Top 10 Users Performing File Operations|Logs|Installed Apps/Dropbox/Dropbox - File Statistics|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| where event\_type matches"{{event\_type}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where (!isNull(country)) and (!isNull(email))<br />\| where event\_category matches("\*file\*") or  event\_category matches("\*paper\*")<br />\| count as frequency by email,name,country<br />\| sort by frequency <br />\| limit 10|
|Dropbox|Top 10 Users with Device IP Changes|Logs|Installed Apps/Dropbox/Dropbox - Logins, Devices & Sessions|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where (!isNull(country))<br />\| where event\_category matches("\*devices\*")<br />\| where event\_type matches("\*device\_change\_ip\*")<br />\| count as frequency by name, country<br />\| sort by frequency <br />\| limit 10|
|Dropbox|User Activity for File Addition and Deletion|Logs|Installed Apps/Dropbox/Dropbox - File Statistics|\_sourceCategory={{Logsdatasource}}  <br />\| json "\$['actor']['.tag']","\$['actor']\*['.tag']","\$['actor']\*['account\_id']","\$['actor']\*['display\_name']","\$['actor']\*['email']","\$['actor']\*['team\_member\_id']","\$['event\_type']['.tag']","\$['event\_type']['description']","details.app\_info.display\_name", "origin.geo\_location.ip\_address", "origin.geo\_location.country","\$['event\_category']['.tag']","involve\_non\_team\_member" as actor,actor\_is\_team\_member,actor\_account\_id, actor\_display\_name, actor\_email,actor\_team\_member\_id, event\_type, event\_type\_description, app\_name,location,country, event\_category,involve\_non\_team\_member nodrop<br />\| where actor matches"{{actor}}"<br />\| where event\_category matches"{{event\_category}}"<br />\| where country matches"{{country}}" or isNull(country)<br />\| where involve\_non\_team\_member matches "{{involve\_non\_team\_member}}"<br />\| where event\_type matches"{{event\_type}}"<br />\| json field=actor\_email "[0]" as email nodrop<br />\| if(isNull(email),context.email,email) as email<br />\| json field=actor\_display\_name "[0]" as name nodrop<br />\| if(isNull(name),actor,name) as name<br />\| where event\_category matches("\*file\*")<br />\| where event\_type matches("\*file\_delete\*") or event\_type matches("\*file\_add\*")<br />\| count(event\_type) as Total by event\_type,email,name<br />\| top 100 email,name,event\_type by Total<br />\| fields email,name,event\_type,Total<br />\| sort by Total|

