# Atlassian

## Searches

### Log Searches

- **Alerts Over Time**: from Dashboard: Atlassian/Atlassian - Overview 
- **Average Change Failure Rate - Trend**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Average Deploys per week**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Average Lead Time**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Average Time to Restore Service**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Builds Over Time**: from Dashboard: Atlassian/Atlassian - Overview 
- **Change Failure Rate**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Commits Over Time**: from Dashboard: Atlassian/Atlassian - Overview 
- **Created Vs. Closed Issues**: from Dashboard: Atlassian/Atlassian - Overview 
- **Daily Average lead time Trend**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Daily Avg. Time to Restore Service Trends**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Deploys by Repository**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Deploys Over Time**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Failed Builds**: from Dashboard: Atlassian/Atlassian - Overview 
- **Open Issues by Component**: from Dashboard: Atlassian/Atlassian - Overview 
- **P1 Alerts**: from Dashboard: Atlassian/Atlassian - Overview 
- **Pull Requests Over Time**: from Dashboard: Atlassian/Atlassian - Overview 
- **Repos with Slowest Lead Times  (in Hours)**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Services with Slowest Time (In Hours) to Restore**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance 
- **Top Services by P1 Incidents**: from Dashboard: Atlassian/Atlassian - Software Delivery Performance

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Atlassian|Alerts Over Time|Logs|Atlassian/Atlassian - Overview|\_sourceCategory = Labs/Opsgenie\_alerts <br />\| json  "action" <br />\| timeslice 1d<br />\| count as count by \_timeslice<br />\| (count/1000) as count|
|Atlassian|Average Change Failure Rate - Trend|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/Opsgenie\_alerts OR (\_sourceCategory = Labs/bitbucket production  deploymentEnvironment pipe\_result\_link deploy\_status commit\_link)<br />\| json "alert.createdAt", "alert.updatedAt", "alert.description", "alert.message", "action", "alert.team",  "alert.priority", "alert.source" , "alert.tags[\*]","alert.recipients[\*]" as created\_at, updated\_at, description, message, action, team, priority, source, tags, recipients nodrop // alerts<br />\| json field=\_raw "buildNumber", "deploymentEnvironment", "branch", "repoFullName", "pipe\_result\_link", "deploy\_status", "pr\_id", "commit", "tag", "projectKey", "repoOwner", "commit\_link", "event\_date"  nodrop  // deploys<br />\| if(!isNull(action) and action !="", "opsgenie", "bitbucket") as type <br />\| where (type="opsgenie" and action = "Close" and priority="p1") or (type="bitbucket" and deploymentEnvironment="production" and deploy\_status="0")<br />\| if(type="opsgenie", 1, 0) as p1\_incidents<br />\| if(type="bitbucket", 1, 0) as deploys<br />\| timeslice 1d<br />\| sum(p1\_incidents) as incidents, sum(deploys) as deploys by \_timeslice<br />\| (incidents\*100/deploys) as pct\_change\_failure\_rate<br />\| fields \_timeslice, pct\_change\_failure\_rate|
|Atlassian|Average Deploys per week|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/bitbucket production  deploymentEnvironment pipe\_result\_link deploy\_status commit\_link <br />\| json field=\_raw "buildNumber", "deploymentEnvironment", "branch", "repoFullName", "pipe\_result\_link", "deploy\_status", "pr\_id", "commit", "tag", "projectKey", "repoOwner", "commit\_link", "event\_date" <br />\| if (deploy\_status matches "0", "Success", "Failed") as deploy\_status<br />\| where deploymentEnvironment="production"<br />\| timeslice 7d<br />\| count \_timeslice <br />\| avg (\_count) as avg\_deploys\_week<br />\| round (avg\_deploys\_week)|
|Atlassian|Average Lead Time|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/bitbucket <br />//BB Commit Event<br />\| join<br /> (json "push.changes[0].created",  "push.changes[0].commits[0].date",  "push.changes[0].commits[0].hash"  as  created, bitbucket\_commits\_date, bitbucket\_commit \| where %"x-event-key" = "repo:push" ) as bb\_commit,<br /><br />( json field=\_raw "buildNumber", "deploymentEnvironment", "branch", "repoFullName", "pipe\_result\_link", "deploy\_status", "pr\_id", "commit", "tag", "projectKey", "repoOwner", "commit\_link", "event\_date" as buildNumber,deploymentEnvironment, deploy\_branch, repo\_name, pipe\_result\_link, deploy\_status, pr\_id, deploy\_commit, tag, projectKey, repoOwner,  commit\_link, deployevent\_date ) as deploy\_event<br />on bb\_commit.bitbucket\_commit = deploy\_event.deploy\_commit<br />\| parse regex field= bb\_commit\_bitbucket\_commits\_date "(?\<commits\_date\>\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d)"  nodrop   <br />\| parseDate(commits\_date, "yyyy-MM-dd'T'HH:mm:ss") as commit\_date\_milliseconds<br /><br />\| where deploy\_event\_deploymentEnvironment="production" and deploy\_event\_deploy\_status="0"<br />\| parse regex field=deploy\_event\_deployevent\_date "(?\<d\>[\\S]+) (?\<t\>[\\S]+)"<br />\| concat(d,"T",t) as event\_date<br />\| parseDate(event\_date, "yyyy-MM-dd'T'HH:mm:ss") as deploy\_date\_milliseconds<br />\| deploy\_date\_milliseconds - commit\_date\_milliseconds as lead\_time<br />\| lead\_time/3600000 as lead\_time\_in\_hrs<br />\| avg (lead\_time\_in\_hrs) as avg\_lead\_time\_in\_hrs|
|Atlassian|Average Time to Restore Service|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/Opsgenie\_alerts Close p1<br />\| json "alert.createdAt", "alert.updatedAt", "alert.description", "alert.message", "action", "alert.team",  "alert.priority", "alert.source" , "alert.tags[\*]","alert.recipients[\*]" as created\_at, updated\_at, description, message, action, team, priority, source, tags, recipients nodrop<br />\| where action = "Close" and priority="p1"<br />\| created\_at\*1000000 as created\_at<br />\| updated\_at - created\_at as time\_to\_restore\_service<br />\| time\_to\_restore\_service/3600000000 as time\_to\_restore\_service<br />\| avg (time\_to\_restore\_service) as avg\_time\_to\_restore\_service|
|Atlassian|Builds Over Time|Logs|Atlassian/Atlassian - Overview|\_sourceCategory = Labs/bitbucket %"x-event-key"=repo:commit\_status\_\* ("SUCCESSFUL" OR "FAILED")<br />\| json "commit\_status.state", "commit\_status.commit.message", "commit\_status.name", "commit\_status.type", "actor.display\_name", "repository.full\_name",  "commit\_status.refname",  "commit\_status.commit.links.html.href", "commit\_status.url", "commit\_status.created\_on" as build\_state, build\_commit\_message, commit\_name, type, commit\_user, repo\_name, commit\_branch, commit\_link, build\_status\_link, date\_time<br />\| where build\_state in ("SUCCESSFUL", "FAILED")<br />\| tourl(commit\_link, build\_commit\_message) as commit <br />\| tourl (build\_status\_link, commit\_name) as build<br />\| timeslice 1d<br />\| count by \_timeslice , build\_state<br />\| transpose row \_timeslice column build\_state<br />\| fillmissing timeslice(1d)|
|Atlassian|Change Failure Rate|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/Opsgenie\_alerts OR (\_sourceCategory = Labs/bitbucket production  deploymentEnvironment pipe\_result\_link deploy\_status commit\_link)<br />\| json "alert.createdAt", "alert.updatedAt", "alert.description", "alert.message", "action", "alert.team",  "alert.priority", "alert.source" , "alert.tags[\*]","alert.recipients[\*]" as created\_at, updated\_at, description, message, action, team, priority, source, tags, recipients nodrop // alerts<br />\| json field=\_raw "buildNumber", "deploymentEnvironment", "branch", "repoFullName", "pipe\_result\_link", "deploy\_status", "pr\_id", "commit", "tag", "projectKey", "repoOwner", "commit\_link", "event\_date"  nodrop  // deploys<br />\| if(!isNull(action) and action !="", "opsgenie", "bitbucket") as type <br />\| where (type="opsgenie" and action = "Close" and priority="p1") or (type="bitbucket" and deploymentEnvironment="production" and deploy\_status="0")<br />\| if(type="opsgenie", 1, 0) as p1\_incidents<br />\| if(type="bitbucket", 1, 0) as deploys<br />\| sum(p1\_incidents) as incidents, sum(deploys) as deploys <br />\| (incidents\*100/(deploys)) as pct\_change\_failure\_rate<br />\| fields pct\_change\_failure\_rate|
|Atlassian|Commits Over Time|Logs|Atlassian/Atlassian - Overview|\_sourceCategory = Labs/bitbucket %"x-event-key"="repo:push"<br />\| json "push.changes[0].closed", "push.changes[0].created", "push.changes[0].commits[0].links.html.href", "push.changes[0].commits[0].author.user.display\_name", "push.changes[0].commits[0].summary.raw", "push.changes[0].commits[0].message", "push.changes[0].commits[0].type" , "repository.links.html.href", "repository.full\_name", "push.changes[0].commits[0].date"  as closed, created, commit\_link ,user\_name, summary, message,commit\_type,repo\_link, repo\_name, commits\_date<br />\| where created="true"<br />\| json "push.changes[0].new.name" as branch\_name nodrop<br />\| parse regex field=commits\_date "(?\<commits\_date\>\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d)"   <br />\| timeslice 1d<br />\| count as count by \_timeslice <br />|
|Atlassian|Created Vs. Closed Issues|Logs|Atlassian/Atlassian - Overview|\_sourceCategory = Labs/jira-cloud \*issue\* (Complete or New)<br />\| json field=\_raw "webhookEvent", "issue\_event\_type\_name", "changelog", "issue.fields.creator.displayName", "issue.self",  "issue.key", "timestamp", "issue.fields.issuetype.name", "issue.fields.status.name", "issue.fields.resolution.name", "issue.fields.project.name", "issue.fields.status.statusCategory.name", "user.active",  "issue.fields.assignee.displayName", "issue.fields.summary", "issue.fields.priority.name", "issue.fields.components", "issue.fields.labels" as  event\_name, event\_type, change\_log, issue\_creator, jira\_self, issue\_key, timestamp, type, status, resolution, project\_name, status\_category, is\_active, issue\_assignee, issue\_summary, priority, components, labels  nodrop<br />\| isNull(issue\_assignee) ? "Unassigned" : issue\_assignee as issue\_assignee<br />\| parse regex field=labels "\\"(?\<label\>[\\S]+?)\\"" multi nodrop<br />\| parse regex field=components "\\"name\\":\\"(?\<component\>[\\S]+?)\\"" multi nodrop<br />\| where status\_category in ("New","Complete","To Do","Done")<br />\| json field=change\_log "items" as changes  <br />\| formatDate(fromMillis(timestamp), "MM-dd-yyyy HH:mm:ss", "UTC") as date\_time<br />\| parse regex field=jira\_self "https:\\/\\/(?\<base\_url\>.\*?)\\/" <br />\| concat("https://",base\_url,"/browse/", issue\_key) as issue\_url<br />\| tourl(issue\_url, issue\_key) as issue<br />\| timeslice 1d<br />\| count\_distinct (issue\_key) by status\_category, \_timeslice<br />\| transpose row \_timeslice column status\_category<br />\| fillmissing timeslice(1h)|
|Atlassian|Daily Average lead time Trend|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/bitbucket <br />//BB Commit Event<br />\| join<br /> (json "push.changes[0].created",  "push.changes[0].commits[0].date",  "push.changes[0].commits[0].hash"  as  created, bitbucket\_commits\_date, bitbucket\_commit \| where %"x-event-key" = "repo:push" ) as bb\_commit,<br /><br />( json field=\_raw "buildNumber", "deploymentEnvironment", "branch", "repoFullName", "pipe\_result\_link", "deploy\_status", "pr\_id", "commit", "tag", "projectKey", "repoOwner", "commit\_link", "event\_date" as buildNumber,deploymentEnvironment, deploy\_branch, repo\_name, pipe\_result\_link, deploy\_status, pr\_id, deploy\_commit, tag, projectKey, repoOwner,  commit\_link, deployevent\_date ) as deploy\_event<br />on bb\_commit.bitbucket\_commit = deploy\_event.deploy\_commit<br />\| parse regex field= bb\_commit\_bitbucket\_commits\_date "(?\<commits\_date\>\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d)"  nodrop   <br />\| parseDate(commits\_date, "yyyy-MM-dd'T'HH:mm:ss") as commit\_date\_milliseconds<br /><br />\| where deploy\_event\_deploymentEnvironment="production" and deploy\_event\_deploy\_status="0"<br />\| parse regex field=deploy\_event\_deployevent\_date "(?\<d\>[\\S]+) (?\<t\>[\\S]+)"<br />\| concat(d,"T",t) as event\_date<br />\| parseDate(event\_date, "yyyy-MM-dd'T'HH:mm:ss") as deploy\_date\_milliseconds<br />\| deploy\_date\_milliseconds - commit\_date\_milliseconds as lead\_time<br />\| lead\_time/3600000 as lead\_time\_in\_hrs<br />\| avg (lead\_time\_in\_hrs) as avg\_lead\_time\_in\_hrs by d<br />\| sort by d asc|
|Atlassian|Daily Avg. Time to Restore Service Trends|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/Opsgenie\_alerts Close p1<br />\| json "alert.createdAt", "alert.updatedAt", "alert.description", "alert.message", "action", "alert.team",  "alert.priority", "alert.source" , "alert.tags[\*]","alert.recipients[\*]" as created\_at, updated\_at, description, message, action, team, priority, source, tags, recipients nodrop<br />\| where action = "Close" and priority="p1"<br />\| created\_at\*1000000 as created\_at<br />\| updated\_at - created\_at as time\_to\_restore\_service<br />\| time\_to\_restore\_service/3600000000 as time\_to\_restore\_service<br />\| timeslice 1d<br />\| avg (time\_to\_restore\_service) as avg\_time\_to\_restore\_service by \_timeslice|
|Atlassian|Deploys by Repository|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/bitbucket production  deploymentEnvironment pipe\_result\_link deploy\_status commit\_link <br />\| json field=\_raw "buildNumber", "deploymentEnvironment", "branch", "repoFullName", "pipe\_result\_link", "deploy\_status", "pr\_id", "commit", "tag", "projectKey", "repoOwner", "commit\_link", "event\_date" <br />\| if (deploy\_status matches "0", "Success", "Failed") as deploy\_status<br />\| where deploymentEnvironment="production"<br />\| count as count by repoFullName<br />\| sort|
|Atlassian|Deploys Over Time|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/bitbucket production  deploymentEnvironment pipe\_result\_link deploy\_status commit\_link <br />\| json field=\_raw "buildNumber", "deploymentEnvironment", "branch", "repoFullName", "pipe\_result\_link", "deploy\_status", "pr\_id", "commit", "tag", "projectKey", "repoOwner", "commit\_link", "event\_date" <br />\| if (deploy\_status matches "0", "Success", "Failed") as deploy\_status<br />\| where deploymentEnvironment="production"<br />\| timeslice 1d<br />\| count as count by \_timeslice|
|Atlassian|Failed Builds|Logs|Atlassian/Atlassian - Overview|\_sourceCategory = Labs/bitbucket %"x-event-key"=repo:commit\_status\_\* display\_name full\_name !INPROGRESS !STOPPED<br />\| json "commit\_status.state", "commit\_status.commit.message", "commit\_status.name", "commit\_status.type", "actor.display\_name", "repository.full\_name",  "commit\_status.refname",  "commit\_status.commit.links.html.href", "commit\_status.url", "commit\_status.created\_on" as build\_state, build\_commit\_message, commit\_name, type, commit\_user, repo, commit\_branch, commit\_link, build\_status\_link, date\_time<br />\| where build\_state in ("FAILED")<br />\| parse regex field=date\_time "(?\<date\_time\>\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d)"<br />\| parse regex field=build\_commit\_message "(?\<commit\_msg\_short\>.+)"<br />\| tourl(commit\_link, commit\_msg\_short) as commit <br />\| tourl (build\_status\_link, commit\_name) as build<br />\| replace (date\_time, "T", " ") as date\_time<br />\| count by date\_time, build<br />\| sort by date\_time<br />\| fields -\_count|
|Atlassian|Open Issues by Component|Logs|Atlassian/Atlassian - Overview|\_sourceCategory = Labs/jira-cloud \*issue\*<br />\| json field=\_raw "webhookEvent", "issue\_event\_type\_name", "changelog", "issue.fields.creator.displayName", "issue.self",  "issue.key", "timestamp", "issue.fields.issuetype.name", "issue.fields.status.name", "issue.fields.resolution.name", "issue.fields.project.name", "issue.fields.status.statusCategory.name", "user.active",  "issue.fields.assignee.displayName", "issue.fields.summary", "issue.fields.priority.name", "issue.fields.components", "issue.fields.labels" as  event\_name, event\_type, change\_log, issue\_creator, jira\_self, issue\_key, timestamp, type, status, resolution, project\_name, status\_category, is\_active, issue\_assignee, issue\_summary, priority, components, labels  nodrop<br />\| isNull(issue\_assignee) ? "Unassigned" : issue\_assignee as issue\_assignee<br />\| parse regex field=labels "\\"(?\<label\>[\\S]+?)\\"" multi nodrop<br />\| parse regex field=components "\\"name\\":\\"(?\<component\>[\\S]+?)\\"" multi nodrop<br />\| json field=change\_log "items" as changes<br />\| formatDate(fromMillis(timestamp), "MM-dd-yyyy HH:mm:ss", "UTC") as date\_time<br />\| parse regex field=jira\_self "https:\\/\\/(?\<base\_url\>.\*?)\\/" <br />\| concat("https://",base\_url,"/browse/", issue\_key) as issue\_url<br />\| tourl(issue\_url, issue\_key) as issue<br />\| first(status\_category) by issue\_key, component<br />\| where \_first in ("In Progress","New","To Do")<br />\| count\_distinct (issue\_key) as count by component <br />\| sort|
|Atlassian|P1 Alerts|Logs|Atlassian/Atlassian - Overview|\_sourceCategory = Labs/Opsgenie\_alerts <br />\| json "alert.createdAt", "alert.updatedAt" , "alert.description", "alert.message", "action", "alert.username",  "alert.priority", "alert.source" , "alert.tags[\*]","alert.recipients[\*]", "alert.details" as created\_at, updated\_at, description, message, action, username, priority, source, tags, recipients, alert\_details nodrop<br />\| where priority="p1"<br />\| num(created\_at) <br />\| tolong(created\_at) as created\_at <br />\| formatDate(created\_at, "MM-dd-yyyy HH:mm:ss") as Created\_date\_time<br />\| count by  created\_date\_time, created\_at, username, message, source<br />\| sort by created\_at <br />\| fields - \_count, created\_at  <br />\| limit 10<br />|
|Atlassian|Pull Requests Over Time|Logs|Atlassian/Atlassian - Overview|\_sourceCategory = Labs/bitbucket %"x-event-key"=pullrequest\* <br />\| json "pullrequest.id", "pullrequest.title", "pullrequest.description", "pullrequest.reviewers[\*].display\_name", "pullrequest.destination.repository.full\_name", "pullrequest.destination.branch.name", "pullrequest.created\_on", "pullrequest.source.branch.name", "pullrequest.author.display\_name", "pullrequest.participants[\*].user.display\_name", "pullrequest.state", "pullrequest.comment\_count", "pullrequest.links.html.href" as id, title, description, reviewers, repo\_name, dest\_branch\_name, create\_time, source\_branch\_name, author, participants, state, comment\_count, PR\_link <br />\| tourl (PR\_Link, title) as PR<br />\| timeslice 1d<br />\| count by \_timeslice , %"x-event-key"<br />\| transpose row \_timeslice column %"x-event-key"<br />\| fillmissing timeslice(1d)|
|Atlassian|Repos with Slowest Lead Times  (in Hours)|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/bitbucket <br />//BB Commit Event<br />\| join<br /> (json "push.changes[0].created",  "push.changes[0].commits[0].date",  "push.changes[0].commits[0].hash"  as  created, bitbucket\_commits\_date, bitbucket\_commit \| where %"x-event-key" = "repo:push" ) as bb\_commit,<br /><br />( json field=\_raw "buildNumber", "deploymentEnvironment", "branch", "repoFullName", "pipe\_result\_link", "deploy\_status", "pr\_id", "commit", "tag", "projectKey", "repoOwner", "commit\_link", "event\_date" as buildNumber,deploymentEnvironment, deploy\_branch, repo\_name, pipe\_result\_link, deploy\_status, pr\_id, deploy\_commit, tag, projectKey, repoOwner,  commit\_link, deployevent\_date ) as deploy\_event<br />on bb\_commit.bitbucket\_commit = deploy\_event.deploy\_commit<br />\| parse regex field= bb\_commit\_bitbucket\_commits\_date "(?\<commits\_date\>\\d\\d\\d\\d-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d)"  nodrop   <br />\| parseDate(commits\_date, "yyyy-MM-dd'T'HH:mm:ss") as commit\_date\_milliseconds<br /><br />\| where deploy\_event\_deploymentEnvironment="production" and deploy\_event\_deploy\_status="0"<br />\| parse regex field=deploy\_event\_deployevent\_date "(?\<d\>[\\S]+) (?\<t\>[\\S]+)"<br />\| concat(d,"T",t) as event\_date<br />\| parseDate(event\_date, "yyyy-MM-dd'T'HH:mm:ss") as deploy\_date\_milliseconds<br />\| deploy\_date\_milliseconds - commit\_date\_milliseconds as lead\_time<br />\| lead\_time/3600000 as lead\_time\_in\_hrs<br />\| avg (lead\_time\_in\_hrs) as avg\_lead\_time\_in\_hrs by deploy\_event\_repo\_name<br />\| deploy\_event\_repo\_name as repo\_name<br />\| format( "%.2f",avg\_lead\_time\_in\_hrs) as avg\_lead\_time\_in\_hrs<br />\| fields repo\_name, avg\_lead\_time\_in\_hrs<br />\| sort by avg\_lead\_time\_in\_hrs<br />\| limit 5|
|Atlassian|Services with Slowest Time (In Hours) to Restore|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/Opsgenie\_alerts Close p1<br />\| json "alert.createdAt", "alert.updatedAt", "alert.description", "alert.message", "action", "alert.team",  "alert.priority", "alert.source" , "alert.tags[\*]","alert.recipients[\*]" as created\_at, updated\_at, description, message, action, team, priority, source, tags, recipients nodrop<br />\| where action = "Close" and priority="p1"<br />\| created\_at\*1000000 as created\_at<br />\| updated\_at - created\_at as time\_to\_restore\_service<br />\| time\_to\_restore\_service/3600000000 as time\_to\_restore\_service<br />\| avg (time\_to\_restore\_service) as avg\_time\_to\_restore\_service by source<br />\| format( "%.2f",avg\_time\_to\_restore\_service) as avg\_time\_to\_restore\_service<br />\| sort by avg\_time\_to\_restore\_service desc <br />\| limit 5|
|Atlassian|Top Services by P1 Incidents|Logs|Atlassian/Atlassian - Software Delivery Performance|\_sourceCategory = Labs/Opsgenie\_alerts Close p1<br />\| json "alert.alertId", "alert.createdAt", "alert.updatedAt", "alert.description", "alert.message", "action", "alert.team",  "alert.priority", "alert.source" , "alert.tags[\*]","alert.recipients[\*]" as alertId, created\_at, updated\_at, description, message, action, team, priority, service, tags, recipients nodrop<br />\| where priority="p1"<br />\| count\_distinct(alertId) as incidents by service<br />\| sort by incidents  <br />\| limit 5|

