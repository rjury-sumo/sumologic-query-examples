# StackRox
## Sumo Logic App For: StackRox
The StackRox Kubernetes Security Platform maximizes the inherent security advantages of containers - immutability and declarative configuration - to help you harden your container environment. Our software integrates with tooling across the container ecosystem to provide the industryâ€™s best risk profiling, highlighting those assets that need an immediate fix. The StackRox platform's adaptive detection offers you the best defense against attacks, continuously adjusting its baseline based on application behavior. StackRox leverages input from across the container life cycle to build a feedback loop that continuously improves your security.
Docs Link: [StackRox](https://cdn.stackrox.io/integrations/sumologic-stackrox-app.pdf)

## Searches

### Log Searches

- **Anomalous Process Executions**: from Dashboard: Installed Apps/StackRox/StackRox - Runtime Violations 
- **Anomalous Process Executions**: from Dashboard: StackRox/StackRox - Runtime Violations 
- **Anomalous Process Executions by Cluster**: from Dashboard: StackRox/StackRox - Runtime Violations 
- **Anomalous Process Executions by Cluster**: from Dashboard: Installed Apps/StackRox/StackRox - Runtime Violations 
- **Anomalous Process Executions by Deployment**: from Dashboard: StackRox/StackRox - Runtime Violations 
- **Anomalous Process Executions by Deployment**: from Dashboard: Installed Apps/StackRox/StackRox - Runtime Violations 
- **Bad Image Components**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **Bad Image Components**: from Dashboard: StackRox/StackRox - Image Violations 
- **Clusters with Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Clusters with Violations**: from Dashboard: StackRox/StackRox - Overview 
- **CVEs**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **CVEs**: from Dashboard: StackRox/StackRox - Image Violations 
- **CVEs by Cluster**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **CVEs by Cluster**: from Dashboard: StackRox/StackRox - Image Violations 
- **CVEs by Severity**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **CVEs by Severity**: from Dashboard: StackRox/StackRox - Image Violations 
- **CVEs Over Time**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **CVEs Over Time**: from Dashboard: StackRox/StackRox - Image Violations 
- **Deploy Time Violations**: from Dashboard: StackRox/StackRox - Overview 
- **Deploy Time Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Deployments Using Latest Tag**: from Dashboard: StackRox/StackRox - Image Violations 
- **Deployments Using Latest Tag**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **Deployments with Kubernetes Violations**: from Dashboard: StackRox/StackRox - Kubernetes Violations 
- **Deployments with Kubernetes Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Kubernetes Violations 
- **Deployments with Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Deployments with Violations**: from Dashboard: StackRox/StackRox - Overview 
- **Kubernetes Best Practices Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Kubernetes Violations 
- **Kubernetes Best Practices Violations**: from Dashboard: StackRox/StackRox - Kubernetes Violations 
- **Kubernetes Violations by Namespace**: from Dashboard: StackRox/StackRox - Kubernetes Violations 
- **Kubernetes Violations by Namespace**: from Dashboard: Installed Apps/StackRox/StackRox - Kubernetes Violations 
- **Kubernetes Violations by Severity**: from Dashboard: StackRox/StackRox - Kubernetes Violations 
- **Kubernetes Violations by Severity**: from Dashboard: Installed Apps/StackRox/StackRox - Kubernetes Violations 
- **Malicious Process Executions**: from Dashboard: Installed Apps/StackRox/StackRox - Runtime Violations 
- **Malicious Process Executions**: from Dashboard: StackRox/StackRox - Runtime Violations 
- **Malicious Process Executions by Cluster**: from Dashboard: StackRox/StackRox - Runtime Violations 
- **Malicious Process Executions by Cluster**: from Dashboard: Installed Apps/StackRox/StackRox - Runtime Violations 
- **Malicious Process Executions by Deployment**: from Dashboard: Installed Apps/StackRox/StackRox - Runtime Violations 
- **Malicious Process Executions by Deployment**: from Dashboard: StackRox/StackRox - Runtime Violations 
- **Most Violated Policies**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Most Violated Policies**: from Dashboard: StackRox/StackRox - Overview 
- **Namespaces with Kubernetes Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Kubernetes Violations 
- **Namespaces with Kubernetes Violations**: from Dashboard: StackRox/StackRox - Kubernetes Violations 
- **Processes Targeting Kubernetes Endpoints**: from Dashboard: Installed Apps/StackRox/StackRox - Kubernetes Violations 
- **Processes Targeting Kubernetes Endpoints**: from Dashboard: StackRox/StackRox - Kubernetes Violations 
- **Runtime Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Runtime Violations**: from Dashboard: StackRox/StackRox - Overview 
- **Top CVE Violations**: from Dashboard: StackRox/StackRox - Image Violations 
- **Top CVE Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **Total number of Bad Image Components**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **Total number of Bad Image Components**: from Dashboard: StackRox/StackRox - Image Violations 
- **Total number of Image Violations**: from Dashboard: StackRox/StackRox - Overview 
- **Total number of Image Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Total number of Image Violations**: from Dashboard: StackRox/StackRox - Image Violations 
- **Total number of Image Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Image Violations 
- **Total number of Kubernetes Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Kubernetes Violations 
- **Total number of Kubernetes Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Total number of Kubernetes Violations**: from Dashboard: StackRox/StackRox - Kubernetes Violations 
- **Total number of Kubernetes Violations**: from Dashboard: StackRox/StackRox - Overview 
- **Total Number of Violations**: from Dashboard: StackRox/StackRox - Overview 
- **Total Number of Violations**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Violations by Category**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Violations by Category**: from Dashboard: StackRox/StackRox - Overview 
- **Violations by Cluster**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Violations by Cluster**: from Dashboard: StackRox/StackRox - Overview 
- **Violations by Deployment Label**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Violations by Deployment Label**: from Dashboard: StackRox/StackRox - Overview 
- **Violations by Namespaces**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Violations by Namespaces**: from Dashboard: StackRox/StackRox - Overview 
- **Violations by Severity**: from Dashboard: StackRox/StackRox - Overview 
- **Violations by Severity**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Violations Over Time**: from Dashboard: Installed Apps/StackRox/StackRox - Overview 
- **Violations Over Time**: from Dashboard: StackRox/StackRox - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|StackRox|Anomalous Process Executions|Logs|Installed Apps/StackRox/StackRox - Runtime Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy processViolation processes signal execFilePath args (true or "Anomalous Activity") RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster<br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages", "policy.fields.whitelistEnabled" as policy, policy\_categories, severity, lifecycle\_stage, whitelistEnabled nodrop<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| json "processViolation.processes[0].signal.name", "processViolation.processes[0].signal.execFilePath", "processViolation.processes[0].signal.args" as Process, Path, Args <br />\| where !isBlank(deployment) and (whitelistEnabled contains "true" or Categories contains "Anomalous Activity") and lifecycle\_stage contains "RUNTIME"<br />\| count as Count by deployment, Path, Process, Args<br />\| sort by Count, deployment asc, Path asc, Process asc, Args asc<br />\| fields -Count|
|StackRox|Anomalous Process Executions|Logs|StackRox/StackRox - Runtime Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy processViolation processes signal execFilePath args (true or "Anomalous Activity") RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster<br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages", "policy.fields.whitelistEnabled" as policy, policy\_categories, severity, lifecycle\_stage, whitelistEnabled<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| json "processViolation.processes[0].signal.name", "processViolation.processes[0].signal.execFilePath", "processViolation.processes[0].signal.args" as Process, Path, Args <br />\| where !isBlank(deployment) and (whitelistEnabled contains "true" or Categories contains "Anomalous Activity") and lifecycle\_stage contains "RUNTIME"<br />\| count as Count by deployment, Path, Process, Args<br />\| sort by Count, deployment asc, Path asc, Process asc, Args asc<br />// \| fields -Count|
|StackRox|Anomalous Process Executions by Cluster|Logs|StackRox/StackRox - Runtime Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy (true or "Anomalous Activity") RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages", "policy.fields.whitelistEnabled" as policy, policy\_categories, severity, lifecycle\_stage, whitelistEnabled<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and (whitelistEnabled contains "true" or Categories contains "Anomalous Activity") and lifecycle\_stage contains "RUNTIME"<br />\| count as Count by cluster <br />\| sort by Count, cluster asc|
|StackRox|Anomalous Process Executions by Cluster|Logs|Installed Apps/StackRox/StackRox - Runtime Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy (true or "Anomalous Activity") RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages", "policy.fields.whitelistEnabled" as policy, policy\_categories, severity, lifecycle\_stage, whitelistEnabled nodrop<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and (whitelistEnabled contains "true" or Categories contains "Anomalous Activity") and lifecycle\_stage contains "RUNTIME"<br />\| count as Count by cluster <br />\| sort by Count, cluster asc|
|StackRox|Anomalous Process Executions by Deployment|Logs|StackRox/StackRox - Runtime Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy (true or "Anomalous Activity") RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages", "policy.fields.whitelistEnabled" as policy, policy\_categories, severity, lifecycle\_stage, whitelistEnabled<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and (whitelistEnabled contains "true" or Categories contains "Anomalous Activity") and lifecycle\_stage contains "RUNTIME"<br />\| count as Count by deployment <br />\| sort by Count, deployment asc|
|StackRox|Anomalous Process Executions by Deployment|Logs|Installed Apps/StackRox/StackRox - Runtime Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy (true or "Anomalous Activity") RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages", "policy.fields.whitelistEnabled" as policy, policy\_categories, severity, lifecycle\_stage, whitelistEnabled nodrop<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and (whitelistEnabled contains "true" or Categories contains "Anomalous Activity") and lifecycle\_stage contains "RUNTIME"<br />\| count as Count by deployment <br />\| sort by Count, deployment asc|
|StackRox|Bad Image Components|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy "in Image"<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName", "policy.fields.component" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage, fieldNames, policyComponent nodrop<br />\| where !isBlank(deployment) and ((policy contains "in Image" and (!isBlank(policy\_fields\_cvss) or !isBlank(policy\_fields\_cve) or !isBlank(policyComponent))) or contains(fieldNames, "Image"))<br />\| count as Count by policy<br />\| sort by Count, policy asc|
|StackRox|Bad Image Components|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy "in Image"<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage<br />\| where !isBlank(deployment) and policy contains "in Image" <br />\| count as Count by policy <br />\| sort by Count, policy asc|
|StackRox|Clusters with Violations|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster  <br />\| where !isBlank(deployment) <br />\| count\_distinct(cluster)|
|StackRox|Clusters with Violations|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster  <br />\| where !isBlank(deployment) <br />\| count\_distinct(cluster)|
|StackRox|CVEs|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage, fieldNames nodrop<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss) or contains(fieldNames, "CVSS") or contains(fieldNames, "CVE"))<br />\| count as Count by policy <br />\| sort by Count, policy asc|
|StackRox|CVEs|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy fields cve cvss<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss))<br />\| count as Count by policy <br />\| sort by Count, policy asc|
|StackRox|CVEs by Cluster|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage, fieldNames nodrop<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss) or contains(fieldNames, "CVSS") or contains(fieldNames, "CVE"))<br />\| count as Count by cluster  <br />\| sort by Count, cluster asc|
|StackRox|CVEs by Cluster|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy fields cve cvss<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss))<br />\| count as Count by cluster  <br />\| sort by Count, cluster asc|
|StackRox|CVEs by Severity|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy severity<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage, fieldNames nodrop<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss) or contains(fieldNames, "CVSS") or contains(fieldNames, "CVE"))<br />\| count as Count by severity  <br />\| sort by Count, severity asc|
|StackRox|CVEs by Severity|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy severity fields cve cvss<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss))<br />\| count as Count by severity  <br />\| sort by Count, severity asc|
|StackRox|CVEs Over Time|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName"  as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage, fieldNames nodrop<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss) or contains(fieldNames, "CVSS") or contains(fieldNames, "CVE"))<br />\| timeslice 1d <br />\| count as Count by \_timeslice|
|StackRox|CVEs Over Time|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy fields cve cvss<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss))<br />\| timeslice 1d <br />\| count as Count by \_timeslice|
|StackRox|Deploy Time Violations|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy lifecycleStages DEPLOY <br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace", "policy.lifecycleStages" as deployment, cluster, namespace, lifecycle\_stage <br />\| where !isBlank(deployment)<br />\| where lifecycle\_stage contains "DEPLOY" <br />\| count|
|StackRox|Deploy Time Violations|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy lifecycleStages DEPLOY <br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace", "policy.lifecycleStages" as deployment, cluster, namespace, lifecycle\_stage <br />\| where !isBlank(deployment)<br />\| where lifecycle\_stage contains "DEPLOY" <br />\| count|
|StackRox|Deployments Using Latest Tag|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy "Latest tag" containers image fullName<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.lifecycleStages" as policy, severity, lifecycle\_stage<br />\| json "deployment.containers[0].image.name.fullName" as image<br />\| where !isBlank(deployment) and policy contains "Latest tag"<br />\| count as Count by deployment, image<br />\| sort by Count, deployment, image|
|StackRox|Deployments Using Latest Tag|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy containers image fullName<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName", "policy.policySections[\*].policyGroups[\*].values" as policy, severity, lifecycle\_stage, fieldNames, fieldValues nodrop<br />\| json "deployment.containers[0].image.name.fullName" as image<br />\| where !isBlank(deployment) and (policy contains "Latest tag" or (contains(fieldNames, "Image Tag") and contains(fieldValues, "latest")))<br />\| count as Count by deployment, image<br />\| sort by Count, deployment, image<br />// \| fields deployment, image|
|StackRox|Deployments with Kubernetes Violations|Logs|StackRox/StackRox - Kubernetes Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy categories Kubernetes<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes"<br />\| count\_distinct(deployment)|
|StackRox|Deployments with Kubernetes Violations|Logs|Installed Apps/StackRox/StackRox - Kubernetes Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy categories Kubernetes<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes"<br />\| count\_distinct(deployment)|
|StackRox|Deployments with Violations|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| where !isBlank(deployment) <br />\| count\_distinct(deployment)|
|StackRox|Deployments with Violations|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| where !isBlank(deployment) <br />\| count\_distinct(deployment)|
|StackRox|Kubernetes Best Practices Violations|Logs|Installed Apps/StackRox/StackRox - Kubernetes Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy categories Kubernetes<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster<br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes" <br />\| count as Count by policy <br />\| sort by Count,  policy asc |
|StackRox|Kubernetes Best Practices Violations|Logs|StackRox/StackRox - Kubernetes Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy categories Kubernetes<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster<br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes" <br />\| count as Count by policy <br />\| sort by Count,  policy asc |
|StackRox|Kubernetes Violations by Namespace|Logs|StackRox/StackRox - Kubernetes Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy categories Kubernetes<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories="Kubernetes" <br />\| count as Count by namespace <br />\| sort by Count, namespace asc|
|StackRox|Kubernetes Violations by Namespace|Logs|Installed Apps/StackRox/StackRox - Kubernetes Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy categories Kubernetes<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage nodrop<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories="Kubernetes" <br />\| count as Count by namespace <br />\| sort by Count, namespace asc|
|StackRox|Kubernetes Violations by Severity|Logs|StackRox/StackRox - Kubernetes Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy categories Kubernetes <br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories="Kubernetes"<br />\| count as Count by severity <br />\| sort by Count, severity asc|
|StackRox|Kubernetes Violations by Severity|Logs|Installed Apps/StackRox/StackRox - Kubernetes Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy categories Kubernetes <br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories="Kubernetes"<br />\| count as Count by severity <br />\| sort by Count, severity asc|
|StackRox|Malicious Process Executions|Logs|Installed Apps/StackRox/StackRox - Runtime Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName processViolation processes signal execFilePath args RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "processViolation.processes[0].signal.name", "processViolation.processes[0].signal.execFilePath", "processViolation.processes[0].signal.args" as Process, Path, Args <br />\| json "policy.name", "policy.severity", "policy.lifecycleStages", "policy.fields.processPolicy", "policy.policySections[\*].policyGroups[\*].fieldName" as policy, severity, lifecycle\_stage, policy\_fields\_processPolicy, fieldNames nodrop<br />\| where !isBlank(deployment) and (!isNull(policy\_fields\_processPolicy) or contains(fieldNames, "Process")) and lifecycle\_stage contains "RUNTIME" <br />\| count as Count by deployment, Path, Process, Args<br />\| sort by Count, deployment asc, Path asc, Process asc, Args asc<br />// \| fields -Count|
|StackRox|Malicious Process Executions|Logs|StackRox/StackRox - Runtime Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName processViolation processes signal execFilePath args RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "processViolation.processes[0].signal.name", "processViolation.processes[0].signal.execFilePath", "processViolation.processes[0].signal.args" as Process, Path, Args <br />\| json "policy.name", "policy.severity", "policy.lifecycleStages", "policy.fields.processPolicy" as policy, severity, lifecycle\_stage, policy\_fields\_processPolicy<br />\| where !isBlank(deployment) and !isNull(policy\_fields\_processPolicy) and lifecycle\_stage contains "RUNTIME" <br />\| count as Count by deployment, Path, Process, Args<br />\| sort by Count, deployment asc, Path asc, Process asc, Args asc<br />// \| fields -Count|
|StackRox|Malicious Process Executions by Cluster|Logs|StackRox/StackRox - Runtime Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy fields processPolicy lifecycleStages RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.severity", "policy.lifecycleStages", "policy.fields.processPolicy" as policy, severity, lifecycle\_stage, policy\_fields\_processPolicy<br />\| where !isBlank(deployment) and !isNull(policy\_fields\_processPolicy) and lifecycle\_stage contains "RUNTIME"<br />\| count as Count by cluster <br />\| sort by Count, cluster asc|
|StackRox|Malicious Process Executions by Cluster|Logs|Installed Apps/StackRox/StackRox - Runtime Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy lifecycleStages RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.severity", "policy.lifecycleStages", "policy.fields.processPolicy", "policy.policySections[\*].policyGroups[\*].fieldName" as policy, severity, lifecycle\_stage, policy\_fields\_processPolicy, fieldNames nodrop<br />\| where !isBlank(deployment) and (!isNull(policy\_fields\_processPolicy) or contains(fieldNames, "Process")) and lifecycle\_stage contains "RUNTIME"<br />\| count as Count by cluster <br />\| sort by Count, cluster asc|
|StackRox|Malicious Process Executions by Deployment|Logs|Installed Apps/StackRox/StackRox - Runtime Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy lifecycleStages RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.severity", "policy.lifecycleStages", "policy.fields.processPolicy", "policy.policySections[\*].policyGroups[\*].fieldName" as policy, severity, lifecycle\_stage, policy\_fields\_processPolicy, fieldNames nodrop<br />\| where !isBlank(deployment) and (!isNull(policy\_fields\_processPolicy) or contains(fieldNames, "Process")) and lifecycle\_stage contains "RUNTIME" <br />\| count as Count by deployment <br />\| sort by Count, deployment asc|
|StackRox|Malicious Process Executions by Deployment|Logs|StackRox/StackRox - Runtime Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy fields processPolicy lifecycleStages RUNTIME<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.severity", "policy.lifecycleStages", "policy.fields.processPolicy" as policy, severity, lifecycle\_stage, policy\_fields\_processPolicy<br />\| where !isBlank(deployment) and !isNull(policy\_fields\_processPolicy) and lifecycle\_stage contains "RUNTIME" <br />\| count as Count by deployment <br />\| sort by Count, deployment asc|
|StackRox|Most Violated Policies|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy name<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name" as policy<br />\| where !isBlank(deployment)<br />\| count by policy <br />\| sort by \_count, policy asc|
|StackRox|Most Violated Policies|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy name<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name" as policy<br />\| where !isBlank(deployment)<br />\| count as Count by policy <br />\| sort by Count, policy asc|
|StackRox|Namespaces with Kubernetes Violations|Logs|Installed Apps/StackRox/StackRox - Kubernetes Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy categories Kubernetes<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster<br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes"<br />\| count\_distinct(namespace)|
|StackRox|Namespaces with Kubernetes Violations|Logs|StackRox/StackRox - Kubernetes Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy categories Kubernetes<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster<br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes"<br />\| count\_distinct(namespace)|
|StackRox|Processes Targeting Kubernetes Endpoints|Logs|Installed Apps/StackRox/StackRox - Kubernetes Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy lifecycleStages Kubernetes processViolation processes signal execFilePath args "Process Targeting" Endpoint<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage<br />\| json "processViolation.processes[0].signal.name", "processViolation.processes[0].signal.execFilePath", "processViolation.processes[0].signal.args" as Process, Path, Args <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes" and policy matches "Process Targeting \*Kubernetes\* Endpoint"<br />\| count by deployment, namespace, policy, Path, Process, Args  <br />\| sort by \_count <br />// \| fields deployment, namespace, policy, Path, Process, Args|
|StackRox|Processes Targeting Kubernetes Endpoints|Logs|StackRox/StackRox - Kubernetes Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy lifecycleStages Kubernetes processViolation processes signal execFilePath args "Process Targeting" Endpoint<br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage<br />\| json "processViolation.processes[0].signal.name", "processViolation.processes[0].signal.execFilePath", "processViolation.processes[0].signal.args" as Process, Path, Args <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes" and policy matches "Process Targeting \*Kubernetes\* Endpoint"<br />\| count as Count by deployment, namespace, policy, Path, Process, Args  <br />\| sort by Count |
|StackRox|Runtime Violations|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy lifecycleStages RUNTIME<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.lifecycleStages" as lifecycle\_stage <br />\| where !isBlank(deployment) and lifecycle\_stage contains "RUNTIME" <br />\| count|
|StackRox|Runtime Violations|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy lifecycleStages RUNTIME<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.lifecycleStages" as lifecycle\_stage <br />\| where !isBlank(deployment) and lifecycle\_stage contains "RUNTIME" <br />\| count|
|StackRox|Top CVE Violations|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy violations link fields cve cvss<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage<br />\| json "violations[0].message" as violation\_msg \| parse regex field=violation\_msg "[CVE\|cve:] (?\<CVE\_ID\>CVE\\-\\d{4}\\-\\d+?)(?:\\s\|\\))" nodrop<br />\| json "violations[0].link" as link<br />\| concat("https://security-tracker.debian.org/tracker/",CVE\_ID) as link\_temp<br />\| if (!isEmpty(link), link, link\_temp) as link<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss))<br />\| count as Count by CVE\_ID, policy, link<br />\| sort by Count, policy asc, CVE\_ID asc<br />\| limit 50|
|StackRox|Top CVE Violations|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy violations<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage, fieldNames nodrop<br />\| json "violations[0].message" as violation\_msg \| parse regex field=violation\_msg "(?\<CVE\_ID\>CVE\\-\\d{4}\\-\\d+?)(?:\\s\|\\))" nodrop<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss) or contains(fieldNames, "CVSS") or contains(fieldNames, "CVE"))<br />\| count as Count by CVE\_ID, policy<br />\| sort by Count, policy asc, CVE\_ID asc<br />\| limit 50|
|StackRox|Total number of Bad Image Components|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy "in Image"<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName", "policy.fields.component" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage, fieldNames, policyComponent nodrop<br />\| where !isBlank(deployment) and policy contains "in Image" and (!isBlank(policy\_fields\_cvss) or !isBlank(policy\_fields\_cve) or contains(fieldNames, "Image") or contains(fieldNames, "CVE") or contains(fieldNames, "CVSS") or !isBlank(policyComponent))<br />\| count|
|StackRox|Total number of Bad Image Components|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy "in Image"<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage<br />\| where !isBlank(deployment) and policy contains "in Image"<br />\| count|
|StackRox|Total number of Image Violations|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy fields cve cvss<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.fields.cve", "policy.fields.cvss" as policy\_fields\_cve, policy\_fields\_cvss<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss))<br />\| count|
|StackRox|Total number of Image Violations|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.fields.cve", "policy.fields.cvss", "policy.policySections[\*].policyGroups[\*].fieldName" as policy\_fields\_cve, policy\_fields\_cvss, fieldNames nodrop<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss) or contains(fieldNames, "CVSS") or contains(fieldNames, "CVE"))<br />\| count|
|StackRox|Total number of Image Violations|Logs|StackRox/StackRox - Image Violations|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy fields cve cvss<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss))<br />\| count|
|StackRox|Total number of Image Violations|Logs|Installed Apps/StackRox/StackRox - Image Violations|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.name", "policy.severity", "policy.fields.cve", "policy.fields.cvss", "policy.lifecycleStages", "policy.policySections[\*].policyGroups[\*].fieldName" as policy, severity, policy\_fields\_cve, policy\_fields\_cvss, lifecycle\_stage, policyFieldNames nodrop<br />\| where !isBlank(deployment) and (!isBlank(policy\_fields\_cve) or !isBlank(policy\_fields\_cvss) or contains(policyFieldNames, "CVSS") or contains(policyFieldNames, "CVE"))<br />\| count|
|StackRox|Total number of Kubernetes Violations|Logs|Installed Apps/StackRox/StackRox - Kubernetes Violations|\_sourceCategory={{Logsdatasource}}  deployment name namespace clusterName policy categories Kubernetes <br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes" <br />\| count|
|StackRox|Total number of Kubernetes Violations|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy categories severity Kubernetes<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.categories", "policy.severity" as policy\_categories, severity<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes" <br />\| count|
|StackRox|Total number of Kubernetes Violations|Logs|StackRox/StackRox - Kubernetes Violations|\_sourceCategory = Labs/Stackrox deployment name namespace clusterName policy categories Kubernetes <br />\| json "deployment.name", "deployment.namespace", "deployment.clusterName" as deployment, namespace, cluster <br />\| json "policy.name", "policy.categories", "policy.severity", "policy.lifecycleStages" as policy, policy\_categories, severity, lifecycle\_stage <br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes" <br />\| count|
|StackRox|Total number of Kubernetes Violations|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy categories severity Kubernetes<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.categories", "policy.severity" as policy\_categories, severity<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment) and Categories contains "Kubernetes" <br />\| count|
|StackRox|Total Number of Violations|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| where !isBlank(deployment)<br />\| count|
|StackRox|Total Number of Violations|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace<br />\| where !isBlank(deployment)<br />\| count|
|StackRox|Violations by Category|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy categories<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.categories" as policy\_categories<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment)<br />\| count as Count by Categories <br />\| sort by Count, Categories asc|
|StackRox|Violations by Category|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy categories<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.categories" as policy\_categories<br />\| parse regex field=policy\_categories "\\"(?\<Categories\>[^\\"]\*)\\"" multi <br />\| where !isBlank(deployment)<br />\| count as Count by Categories <br />\| sort by Count, Categories asc|
|StackRox|Violations by Cluster|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| where !isBlank(deployment)<br />\| count(\*) as Count by cluster <br />\| sort by Count, cluster asc|
|StackRox|Violations by Cluster|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| where !isBlank(deployment)<br />\| count(\*) as Count by cluster <br />\| sort by Count, cluster asc|
|StackRox|Violations by Deployment Label|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace labels run<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "deployment.labels.run" as applabel <br />\| where !isBlank(deployment) and !isBlank(applabel)<br />\| count as Count by applabel <br />\| sort by Count, applabel asc|
|StackRox|Violations by Deployment Label|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace labels run<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "deployment.labels.run" as applabel <br />\| where !isBlank(deployment) and !isBlank(applabel)<br />\| count as Count by applabel <br />\| sort by Count, applabel asc|
|StackRox|Violations by Namespaces|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| where !isBlank(deployment)<br />\| count as Count by namespace <br />\| sort by Count, namespace asc|
|StackRox|Violations by Namespaces|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| where !isBlank(deployment)<br />\| count as Count by namespace <br />\| sort by Count, namespace asc|
|StackRox|Violations by Severity|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox  deployment name clusterName namespace policy severity<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.severity" as severity <br />\| where !isBlank(deployment)<br />\| count as Count by severity <br />\| sort by Count, severity asc|
|StackRox|Violations by Severity|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}   deployment name clusterName namespace policy severity<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.severity" as severity <br />\| where !isBlank(deployment)<br />\| count as Count by severity <br />\| sort by Count, severity asc|
|StackRox|Violations Over Time|Logs|Installed Apps/StackRox/StackRox - Overview|\_sourceCategory={{Logsdatasource}}  deployment name clusterName namespace policy severity<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.severity" as severity<br />\| where !isBlank(deployment)<br />\| timeslice 1d <br />\| count by \_timeslice, severity <br />\| transpose row \_timeslice column severity|
|StackRox|Violations Over Time|Logs|StackRox/StackRox - Overview|\_sourceCategory = Labs/Stackrox deployment name clusterName namespace policy severity<br />\| json "deployment.name", "deployment.clusterName", "deployment.namespace" as deployment, cluster, namespace <br />\| json "policy.severity" as severity<br />\| where !isBlank(deployment)<br />\| timeslice 1d <br />\| count as Count by \_timeslice, severity <br />\| transpose row \_timeslice column severity|

