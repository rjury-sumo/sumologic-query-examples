# Windows 2012+ (JSON)
## Sumo Logic App For: Windows 2012+ (JSON)
The Windows JSON App provides insight into your Windows system's operation and events so that you can better manage and maintain your environment. The Windows App consists of predefined searches and dashboards that provide visibility into your environment for real-time analysis of overall usage of Security Status, System Activity, Updates, User Activity and Applications.
Docs Link: [Windows 2012+ (JSON)](https://help.sumologic.com/?cid=9003)

## Searches

### Log Searches

- **(Kerberos) Failed Logins on the Domain Controller or Member Servers**: from Search: Windows 2012+ (JSON)/System Activity/(Kerberos) Failed Logins on the Domain Controller or Member Servers 
- **(Kerberos) Failed Logins on the Domain Controller or Member Servers**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/(Kerberos) Failed Logins on the Domain Controller or Member Servers 
- **(NTLM) Failed Logins**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/(NTLM) Failed Logins 
- **(NTLM) Failed Logins**: from Search: Windows 2012+ (JSON)/System Activity/(NTLM) Failed Logins 
- **Account Policy Changes**: from Search: Installed Apps/Windows 2012+ (JSON)/Security Status/Account Policy Changes 
- **Account Policy Changes**: from Search: Windows 2012+ (JSON)/Security Status/Account Policy Changes 
- **All Directory Service Changes**: from Search: Windows 2012+ (JSON)/System Activity/All Directory Service Changes 
- **All Directory Service Changes**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/All Directory Service Changes 
- **All Directory Service Object Creations**: from Search: Windows 2012+ (JSON)/System Activity/All Directory Service Object Creations 
- **All Directory Service Object Creations**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/All Directory Service Object Creations 
- **All Fatal or Warning Messages by Source Host**: from Search: Installed Apps/Windows 2012+ (JSON)/Updates/All Fatal or Warning Messages by Source Host 
- **All Fatal or Warning Messages by Source Host**: from Dashboard: Windows 2012+ (JSON)/Windows - Overview 
- **All Fatal or Warning Messages by Source Host**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Overview 
- **All Fatal or Warning Messages by Source Host**: from Search: Windows 2012+ (JSON)/Updates/All Fatal or Warning Messages by Source Host 
- **All User Account Changes**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/All User Account Changes 
- **All User Account Changes**: from Search: Windows 2012+ (JSON)/User Activity/All User Account Changes 
- **Audit Log Cleared**: from Search: Installed Apps/Windows 2012+ (JSON)/Security Status/Audit Log Cleared 
- **Audit Log Cleared**: from Dashboard: Windows 2012+ (JSON)/Windows - Overview 
- **Audit Log Cleared**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Overview 
- **Audit Log Cleared**: from Search: Windows 2012+ (JSON)/Security Status/Audit Log Cleared 
- **Audit Policy Changes**: from Search: Installed Apps/Windows 2012+ (JSON)/Security Status/Audit Policy Changes 
- **Audit Policy Changes**: from Search: Windows 2012+ (JSON)/Security Status/Audit Policy Changes 
- **Breakdown by Keyword Tag**: from Dashboard: Windows 2012+ (JSON)/Windows - Event Errors 
- **Breakdown by Keyword Tag**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors 
- **Changes to Administrative Groups**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Overview 
- **Changes to Administrative Groups**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/Changes to Administrative Groups 
- **Changes to Administrative Groups**: from Search: Windows 2012+ (JSON)/User Activity/Changes to Administrative Groups 
- **Changes to Administrative Groups**: from Dashboard: Windows 2012+ (JSON)/Windows - Overview 
- **Closed RDP Sessions Tracking**: from Search: Installed Apps/Windows 2012+ (JSON)/Security Status/Closed RDP Sessions Tracking 
- **Closed RDP Sessions Tracking**: from Search: Windows 2012+ (JSON)/Security Status/Closed RDP Sessions Tracking 
- **Closed Sessions Tracking**: from Search: Installed Apps/Windows 2012+ (JSON)/Security Status/Closed Sessions Tracking 
- **Closed Sessions Tracking**: from Search: Windows 2012+ (JSON)/Security Status/Closed Sessions Tracking 
- **Error Keyword - LogReduce**: from Dashboard: Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword - LogReduce**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword - One Day Time Comparison**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword - One Day Time Comparison**: from Dashboard: Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword - Outlier**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword - Outlier**: from Dashboard: Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword by Computer and Message**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword by Computer and Message**: from Dashboard: Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword Trend**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors 
- **Error Keyword Trend**: from Dashboard: Windows 2012+ (JSON)/Windows - Event Errors 
- **Errors and Warnings Over Time**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Default 
- **Errors and Warnings Over Time**: from Dashboard: Windows 2012+ (JSON)/Windows - Default 
- **Event Distribution Over Time**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Default 
- **Event Distribution Over Time**: from Dashboard: Windows 2012+ (JSON)/Windows - Default 
- **Events by Level**: from Dashboard: Windows 2012+ (JSON)/Windows - Application 
- **Events by Level**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Application 
- **Events Trend**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Application 
- **Events Trend**: from Dashboard: Windows 2012+ (JSON)/Windows - Application 
- **Failed Logins by Hour**: from Dashboard: Windows 2012+ (JSON)/Windows - Login Status 
- **Failed Logins by Hour**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Login Status 
- **Failed Logins Outlier**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Login Status 
- **Failed Logins Outlier**: from Dashboard: Windows 2012+ (JSON)/Windows - Login Status 
- **Failed Logins Over time**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/Failed Logins Over time 
- **Failed Logins Over time**: from Search: Windows 2012+ (JSON)/User Activity/Failed Logins Over time 
- **Failed Logins Source Location**: from Dashboard: Windows 2012+ (JSON)/Windows - Login Status 
- **Failed Logins Source Location**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Login Status 
- **Failed Updates by Host**: from Search: Windows 2012+ (JSON)/Updates/Failed Updates by Host 
- **Failed Updates by Host**: from Search: Installed Apps/Windows 2012+ (JSON)/Updates/Failed Updates by Host 
- **Failed Updates by KB Number**: from Search: Installed Apps/Windows 2012+ (JSON)/Updates/Failed Updates by KB Number 
- **Failed Updates by KB Number**: from Search: Windows 2012+ (JSON)/Updates/Failed Updates by KB Number 
- **Firewall Changes**: from Search: Installed Apps/Windows 2012+ (JSON)/Security Status/Firewall Changes 
- **Firewall Changes**: from Search: Windows 2012+ (JSON)/Security Status/Firewall Changes 
- **Installations and UnInstallations**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Application 
- **Installations and UnInstallations**: from Dashboard: Windows 2012+ (JSON)/Windows - Application 
- **Level Breakdown**: from Dashboard: Windows 2012+ (JSON)/Windows - Application 
- **Level Breakdown**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Application 
- **Logins by Hour**: from Dashboard: Windows 2012+ (JSON)/Windows - Login Status 
- **Logins by Hour**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Login Status 
- **Multiple Failed Logins by Same User**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/Multiple Failed Logins by Same User 
- **Multiple Failed Logins by Same User**: from Search: Windows 2012+ (JSON)/User Activity/Multiple Failed Logins by Same User 
- **Multiple Failed Logins on Local Machine**: from Search: Windows 2012+ (JSON)/User Activity/Multiple Failed Logins on Local Machine 
- **Multiple Failed Logins on Local Machine**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/Multiple Failed Logins on Local Machine 
- **New Accounts Created**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/New Accounts Created 
- **New Accounts Created**: from Search: Windows 2012+ (JSON)/User Activity/New Accounts Created 
- **Recent Policy Changes**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Overview 
- **Recent Policy Changes**: from Dashboard: Windows 2012+ (JSON)/Windows - Overview 
- **Recent Policy Changes**: from Search: Windows 2012+ (JSON)/Security Status/Recent Policy Changes 
- **Recent Policy Changes**: from Search: Installed Apps/Windows 2012+ (JSON)/Security Status/Recent Policy Changes 
- **Report Messages**: from Search: Installed Apps/Windows 2012+ (JSON)/Updates/Report Messages 
- **Report Messages**: from Search: Windows 2012+ (JSON)/Updates/Report Messages 
- **Service Events by Type**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/Service Events by Type 
- **Service Events by Type**: from Search: Windows 2012+ (JSON)/System Activity/Service Events by Type 
- **Service Installed**: from Search: Windows 2012+ (JSON)/System Activity/Service Installed 
- **Service Installed**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/Service Installed 
- **Service Starts**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/Service Starts 
- **Service Starts**: from Search: Windows 2012+ (JSON)/System Activity/Service Starts 
- **Service Stops**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/Service Stops 
- **Service Stops**: from Search: Windows 2012+ (JSON)/System Activity/Service Stops 
- **Successful Group Creations**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/Successful Group Creations 
- **Successful Group Creations**: from Search: Windows 2012+ (JSON)/User Activity/Successful Group Creations 
- **Successful Login Source Location**: from Dashboard: Windows 2012+ (JSON)/Windows - Login Status 
- **Successful Login Source Location**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Login Status 
- **Successful Logins**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Login Status 
- **Successful Logins**: from Dashboard: Windows 2012+ (JSON)/Windows - Login Status 
- **Successful Logons Over time**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/Successful Logons Over time 
- **Successful Logons Over time**: from Search: Windows 2012+ (JSON)/User Activity/Successful Logons Over time 
- **Successful RDP Reconnects**: from Dashboard: Windows 2012+ (JSON)/Windows - Login Status 
- **Successful RDP Reconnects**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Login Status 
- **Successful Updates by Host**: from Search: Windows 2012+ (JSON)/Updates/Successful Updates by Host 
- **Successful Updates by Host**: from Search: Installed Apps/Windows 2012+ (JSON)/Updates/Successful Updates by Host 
- **Successful Updates by KB number**: from Search: Installed Apps/Windows 2012+ (JSON)/Updates/Successful Updates by KB number 
- **Successful Updates by KB number**: from Search: Windows 2012+ (JSON)/Updates/Successful Updates by KB number 
- **System Operations**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Default 
- **System Operations**: from Dashboard: Windows 2012+ (JSON)/Windows - Default 
- **System Restarted**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/System Restarted 
- **System Restarted**: from Search: Windows 2012+ (JSON)/System Activity/System Restarted 
- **System Restarts**: from Dashboard: Windows 2012+ (JSON)/Windows - Overview 
- **System Restarts**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Overview 
- **Top 10 Service Operations**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Default 
- **Top 10 Service Operations**: from Dashboard: Windows 2012+ (JSON)/Windows - Default 
- **Top Error Codes**: from Search: Windows 2012+ (JSON)/Updates/Top Error Codes 
- **Top Error Codes**: from Search: Installed Apps/Windows 2012+ (JSON)/Updates/Top Error Codes 
- **Top Messages**: from Dashboard: Windows 2012+ (JSON)/Windows - Application 
- **Top Messages**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Application 
- **Top Reasons for Failed Logins**: from Search: Windows 2012+ (JSON)/System Activity/Top Reasons for Failed Logins 
- **Top Reasons for Failed Logins**: from Search: Installed Apps/Windows 2012+ (JSON)/System Activity/Top Reasons for Failed Logins 
- **Top Security Events**: from Search: Installed Apps/Windows 2012+ (JSON)/Security Status/Top Security Events 
- **Top Security Events**: from Search: Windows 2012+ (JSON)/Security Status/Top Security Events 
- **Top Services Installed**: from Dashboard: Installed Apps/Windows 2012+ (JSON)/Windows - Overview 
- **Top Services Installed**: from Dashboard: Windows 2012+ (JSON)/Windows - Overview 
- **Unauthorized Account Creations**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/Unauthorized Account Creations 
- **Unauthorized Account Creations**: from Search: Windows 2012+ (JSON)/User Activity/Unauthorized Account Creations 
- **Update Results by KB number**: from Search: Windows 2012+ (JSON)/Updates/Update Results by KB number 
- **Update Results by KB number**: from Search: Installed Apps/Windows 2012+ (JSON)/Updates/Update Results by KB number 
- **User Account Changed**: from Search: Windows 2012+ (JSON)/User Activity/User Account Changed 
- **User Account Changed**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/User Account Changed 
- **User Account Deleted**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/User Account Deleted 
- **User Account Deleted**: from Search: Windows 2012+ (JSON)/User Activity/User Account Deleted 
- **User Added to Administrative Groups**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/User Added to Administrative Groups 
- **User Added to Administrative Groups**: from Search: Windows 2012+ (JSON)/User Activity/User Added to Administrative Groups 
- **User Added to Group**: from Search: Windows 2012+ (JSON)/User Activity/User Added to Group 
- **User Added to Group**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/User Added to Group 
- **User Locked-out**: from Search: Windows 2012+ (JSON)/User Activity/User Locked-out 
- **User Locked-out**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/User Locked-out 
- **User Password Changes**: from Search: Windows 2012+ (JSON)/User Activity/User Password Changes 
- **User Password Changes**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/User Password Changes 
- **User Password Reset Attempts**: from Search: Windows 2012+ (JSON)/User Activity/User Password Reset Attempts 
- **User Password Reset Attempts**: from Search: Installed Apps/Windows 2012+ (JSON)/User Activity/User Password Reset Attempts

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Windows 2012+ (JSON)/System Activity|(Kerberos) Failed Logins on the Domain Controller or Member Servers|Logs|Windows 2012+ (JSON)/System Activity/(Kerberos) Failed Logins on the Domain Controller or Member Servers|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.TargetUserName", "EventData.Workstation", "EventData.Status", "EventData.SubStatus", "Keywords" as event\_id, host, msg\_summary, src\_user, src\_host, status, sub\_status, Keywords nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4771" or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0") and keywords = "Audit Failure"|
|Windows 2012+ (JSON)/System Activity|(Kerberos) Failed Logins on the Domain Controller or Member Servers|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/(Kerberos) Failed Logins on the Domain Controller or Member Servers|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.TargetUserName", "EventData.Workstation", "EventData.Status", "EventData.SubStatus", "Keywords" as event\_id, host, msg\_summary, src\_user, src\_host, status, sub\_status, Keywords nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4771" or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0") and keywords = "Audit Failure"|
|Windows 2012+ (JSON)/System Activity|(NTLM) Failed Logins|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/(NTLM) Failed Logins|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4776\\"" "Audit Failure" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "EventData.TargetUserName", "EventData.Workstation", "EventData.Status", "EventData.PackageName", "Channel", "Keywords" as event\_id, host, msg\_summary, logon\_account, workstation, status, Authentication\_Package, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4776" and channel = "Security" and status != "0x0"|
|Windows 2012+ (JSON)/System Activity|(NTLM) Failed Logins|Logs|Windows 2012+ (JSON)/System Activity/(NTLM) Failed Logins|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4776\\"" "Audit Failure" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "EventData.TargetUserName", "EventData.Workstation", "EventData.Status", "EventData.PackageName", "Channel", "Keywords" as event\_id, host, msg\_summary, logon\_account, workstation, status, Authentication\_Package, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4776" and channel = "Security" and status != "0x0"|
|Windows 2012+ (JSON)/Security Status|Account Policy Changes|Logs|Installed Apps/Windows 2012+ (JSON)/Security Status/Account Policy Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4739\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Level", "Message", "Keywords", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.IpAddress", "EventData.IpPort", "EventData.SubStatus", "Channel" as event\_id, host, event\_type, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, src\_ip, src\_port, result\_code, channel nodrop<br />\| parse regex field=msg\_summary "Change Type:\\s+(?\<change\_type\>[\\s\\S]\*?)Subject:" nodrop<br />\| parse regex field=msg\_summary "Changed Attributes:\\s+(?\<changed\_attributes\>[\\s\\S]\*?)Additional Information:" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4739" and channel = "Security"|
|Windows 2012+ (JSON)/Security Status|Account Policy Changes|Logs|Windows 2012+ (JSON)/Security Status/Account Policy Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4739\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Level", "Message", "Keywords", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.IpAddress", "EventData.IpPort", "EventData.SubStatus", "Channel" as event\_id, host, event\_type, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, src\_ip, src\_port, result\_code, channel nodrop<br />\| parse regex field=msg\_summary "Change Type:\\s+(?\<change\_type\>[\\s\\S]\*?)Subject:" nodrop<br />\| parse regex field=msg\_summary "Changed Attributes:\\s+(?\<changed\_attributes\>[\\s\\S]\*?)Additional Information:" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4739" and channel = "Security"|
|Windows 2012+ (JSON)/System Activity|All Directory Service Changes|Logs|Windows 2012+ (JSON)/System Activity/All Directory Service Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (5136 or 5137 or 5138 or 5139 or 5141) \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.SubjectLogonId", "EventData.DSName", "EventData.DSType", "EventData.ObjectDN", "EventData.ObjectClass", "EventData.AttributeValue", "Task", "Keywords", "Channel", "Level" as event\_id, host, msg\_summary, src\_user, src\_domain, src\_LogonId, directory\_service\_name, directory\_service\_type, object\_dn, object\_class, AttributeValue, task, Keywords, channel, level nodrop<br />\| where event\_id in ("5136", "5137", "5138", "5139", "5141") and channel = "Security"<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| count by event\_id, host, msg\_summary, src\_user, src\_domain, src\_LogonId, directory\_service\_name, directory\_service\_type, object\_dn, object\_class, AttributeValue, task, Keywords, channel, level|
|Windows 2012+ (JSON)/System Activity|All Directory Service Changes|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/All Directory Service Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (5136 or 5137 or 5138 or 5139 or 5141) \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.SubjectLogonId", "EventData.DSName", "EventData.DSType", "EventData.ObjectDN", "EventData.ObjectClass", "EventData.AttributeValue", "Task", "Keywords", "Channel", "Level" as event\_id, host, msg\_summary, src\_user, src\_domain, src\_LogonId, directory\_service\_name, directory\_service\_type, object\_dn, object\_class, AttributeValue, task, Keywords, channel, level nodrop<br />\| where event\_id in ("5136", "5137", "5138", "5139", "5141") and channel = "Security"<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| count by event\_id, host, msg\_summary, src\_user, src\_domain, src\_LogonId, directory\_service\_name, directory\_service\_type, object\_dn, object\_class, AttributeValue, task, Keywords, channel, level|
|Windows 2012+ (JSON)/System Activity|All Directory Service Object Creations|Logs|Windows 2012+ (JSON)/System Activity/All Directory Service Object Creations|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"5137\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.DSName", "Task", "EventData.DSType", "EventData.ObjectDN", "EventData.ObjectClass", "Keywords", "Channel", "Level" as event\_id, host, msg\_summary, src\_user, src\_domain, directory\_service\_name, task, directory\_service\_type, object\_dn, object\_class, Keywords, channel, level nodrop<br />\| where event\_id = "5137"<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| count by event\_id, host, msg\_summary, src\_user, src\_domain, directory\_service\_name, directory\_service\_type, object\_dn, object\_class, Keywords, channel, level|
|Windows 2012+ (JSON)/System Activity|All Directory Service Object Creations|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/All Directory Service Object Creations|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"5137\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.DSName", "Task", "EventData.DSType", "EventData.ObjectDN", "EventData.ObjectClass", "Keywords", "Channel", "Level" as event\_id, host, msg\_summary, src\_user, src\_domain, directory\_service\_name, task, directory\_service\_type, object\_dn, object\_class, Keywords, channel, level nodrop<br />\| where event\_id = "5137"<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| count by event\_id, host, msg\_summary, src\_user, src\_domain, directory\_service\_name, directory\_service\_type, object\_dn, object\_class, Keywords, channel, level|
|Windows 2012+ (JSON)/Updates|All Fatal or Warning Messages by Source Host|Logs|Installed Apps/Windows 2012+ (JSON)/Updates/All Fatal or Warning Messages by Source Host|\_sourceCategory={{Logsdatasource}}   (WARNING or Error or FATAL)<br />\| json "Level", "Keywords" as level, keywords<br />\| count by \_sourceHost, level, keywords|
|Windows 2012+ (JSON)|All Fatal or Warning Messages by Source Host|Logs|Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   (WARNING or Error or FATAL)<br />\| json "Computer", "Level", "Keywords" as host, level, keywords nodrop<br />\| where host matches "{{host}}"<br />\| count as error\_count by host<br />\| sort - error\_count|
|Windows 2012+ (JSON)|All Fatal or Warning Messages by Source Host|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   (WARNING or Error or FATAL)<br />\| json "Computer", "Level", "Keywords" as host, level, keywords nodrop<br />\| where host matches "{{host}}"<br />\| count as error\_count by host<br />\| sort - error\_count|
|Windows 2012+ (JSON)/Updates|All Fatal or Warning Messages by Source Host|Logs|Windows 2012+ (JSON)/Updates/All Fatal or Warning Messages by Source Host|\_sourceCategory={{Logsdatasource}}   (WARNING or Error or FATAL)<br />\| json "Level", "Keywords" as level, keywords<br />\| count by \_sourceHost, level, keywords|
|Windows 2012+ (JSON)/User Activity|All User Account Changes|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/All User Account Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("13824" or "4720" or "4722" or "4723" or "4724" or "4725" or "4726" or "4738" or "4740" or "4767" or "4780" or "4781" or "4794" or "5376" or "5377") \_sourceName=Security<br />\| json "EventID", "Computer", "Level", "Message", "Keywords", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel", "Task" as event\_id, host, event\_type, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, channel, task nodrop<br />\| parse regex field=msg\_summary "Changed Attributes:\\s+(?\<changedAttributes\>[\\s\\S]\*?)Additional Information:" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4720", "4722", "4723", "4724", "4725", "4726", "4738", "4740", "4767", "4780", "4781", "4794", "5376", "5377") and channel = "Security" or task = "13824"<br />\| fields host, task, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, changedAttributes|
|Windows 2012+ (JSON)/User Activity|All User Account Changes|Logs|Windows 2012+ (JSON)/User Activity/All User Account Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("13824" or "4720" or "4722" or "4723" or "4724" or "4725" or "4726" or "4738" or "4740" or "4767" or "4780" or "4781" or "4794" or "5376" or "5377") \_sourceName=Security<br />\| json "EventID", "Computer", "Level", "Message", "Keywords", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel", "Task" as event\_id, host, event\_type, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, channel, task nodrop<br />\| parse regex field=msg\_summary "Changed Attributes:\\s+(?\<changedAttributes\>[\\s\\S]\*?)Additional Information:" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4720", "4722", "4723", "4724", "4725", "4726", "4738", "4740", "4767", "4780", "4781", "4794", "5376", "5377") and channel = "Security" or task = "13824"<br />\| fields host, task, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, changedAttributes|
|Windows 2012+ (JSON)/Security Status|Audit Log Cleared|Logs|Installed Apps/Windows 2012+ (JSON)/Security Status/Audit Log Cleared|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"1102\\"" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "UserData.LogFileCleared.SubjectUserName", "UserData.LogFileCleared.SubjectDomainName", "Channel", "Keywords" as event\_id, host, msg\_summary, src\_user, src\_domain, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("1102") and channel = "Security"<br />\| fields event\_id, host, msg\_summary, src\_user, src\_domain, channel, Keywords|
|Windows 2012+ (JSON)|Audit Log Cleared|Logs|Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"1102\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "UserData.LogFileCleared.SubjectUserName", "UserData.LogFileCleared.SubjectDomainName", "Channel", "Keywords" as event\_id, host, msg\_summary, src\_user, src\_domain, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("1102") and channel = "Security" and host matches "{{host}}"<br />\| timeslice 1s<br />\| count by \_timeslice, msg\_summary, src\_user, host|
|Windows 2012+ (JSON)|Audit Log Cleared|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"1102\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "UserData.LogFileCleared.SubjectUserName", "UserData.LogFileCleared.SubjectDomainName", "Channel", "Keywords" as event\_id, host, msg\_summary, src\_user, src\_domain, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("1102") and channel = "Security" and host matches "{{host}}"<br />\| timeslice 1s<br />\| count by \_timeslice, msg\_summary, src\_user, host|
|Windows 2012+ (JSON)/Security Status|Audit Log Cleared|Logs|Windows 2012+ (JSON)/Security Status/Audit Log Cleared|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"1102\\"" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "UserData.LogFileCleared.SubjectUserName", "UserData.LogFileCleared.SubjectDomainName", "Channel", "Keywords" as event\_id, host, msg\_summary, src\_user, src\_domain, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("1102") and channel = "Security"<br />\| fields event\_id, host, msg\_summary, src\_user, src\_domain, channel, Keywords|
|Windows 2012+ (JSON)/Security Status|Audit Policy Changes|Logs|Installed Apps/Windows 2012+ (JSON)/Security Status/Audit Policy Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4719\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Level", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "Channel", "Keywords" as event\_id, host, event\_type, msg\_summary, src\_user, src\_domain, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "Audit Policy Change:\\s+(?\<audit\_policy\_change\>[\\s\\S]\*)" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4719" and channel = "Security"|
|Windows 2012+ (JSON)/Security Status|Audit Policy Changes|Logs|Windows 2012+ (JSON)/Security Status/Audit Policy Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4719\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Level", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "Channel", "Keywords" as event\_id, host, event\_type, msg\_summary, src\_user, src\_domain, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "Audit Policy Change:\\s+(?\<audit\_policy\_change\>[\\s\\S]\*)" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4719" and channel = "Security"|
|Windows 2012+ (JSON)|Breakdown by Keyword Tag|Logs|Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| count by keyword\_tag \| sort by \_count, keyword\_tag asc|
|Windows 2012+ (JSON)|Breakdown by Keyword Tag|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| count by keyword\_tag \| sort by \_count, keyword\_tag asc|
|Windows 2012+ (JSON)|Changes to Administrative Groups|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("13826" or "4727" or "4728" or "4729" or "4730" or "4731" or "4732" or "4733" or "4734" or "4735" or "4737" or "4754" or "4755" or "4756" or "4757" or "4758" or "4764" or "4799") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.GroupName", "EventData.GroupDomain", "Channel", "EventData.MemberName", "Task" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, group\_name, group\_domain, channel, MemberName, task nodrop<br />\| parse regex field=msg\_summary "(?:New\|Deleted) Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop <br />\| parse regex field=msg\_summary "Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where (event\_id in ("4727", "4728", "4729", "4730", "4731", "4732", "4733", "4734", "4735", "4737", "4754", "4755", "4756", "4757", "4758", "4764", "4799") or task = "13826") and host matches "{{host}}"<br />\| where group\_name in ("Administrators", "Domain Admins", "Schema Admins", "Server Operators", "Account Operators", "Backup Operators") // Update the list if you have any custom Administrative group name<br />\| count as count|
|Windows 2012+ (JSON)/User Activity|Changes to Administrative Groups|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/Changes to Administrative Groups|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("13826" or "4727" or "4728" or "4729" or "4730" or "4731" or "4732" or "4733" or "4734" or "4735" or "4737" or "4754" or "4755" or "4756" or "4757" or "4758" or "4764" or "4799") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.GroupName", "EventData.GroupDomain", "Channel", "EventData.MemberName", "Task" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, group\_name, group\_domain, channel, MemberName, task nodrop<br />\| parse regex field=msg\_summary "(?:New\|Deleted) Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop <br />\| parse regex field=msg\_summary "Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4727", "4728", "4729", "4730", "4731", "4732", "4733", "4734", "4735", "4737", "4754", "4755", "4756", "4757", "4758", "4764", "4799") or task = "13826"<br />\| where group\_name in ("Administrators", "Domain Admins", "Schema Admins", "Server Operators", "Account Operators", "Backup Operators") // Update the list if you have any custom Administrative group name|
|Windows 2012+ (JSON)/User Activity|Changes to Administrative Groups|Logs|Windows 2012+ (JSON)/User Activity/Changes to Administrative Groups|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("13826" or "4727" or "4728" or "4729" or "4730" or "4731" or "4732" or "4733" or "4734" or "4735" or "4737" or "4754" or "4755" or "4756" or "4757" or "4758" or "4764" or "4799") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.GroupName", "EventData.GroupDomain", "Channel", "EventData.MemberName", "Task" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, group\_name, group\_domain, channel, MemberName, task nodrop<br />\| parse regex field=msg\_summary "(?:New\|Deleted) Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop <br />\| parse regex field=msg\_summary "Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4727", "4728", "4729", "4730", "4731", "4732", "4733", "4734", "4735", "4737", "4754", "4755", "4756", "4757", "4758", "4764", "4799") or task = "13826"<br />\| where group\_name in ("Administrators", "Domain Admins", "Schema Admins", "Server Operators", "Account Operators", "Backup Operators") // Update the list if you have any custom Administrative group name|
|Windows 2012+ (JSON)|Changes to Administrative Groups|Logs|Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("13826" or "4727" or "4728" or "4729" or "4730" or "4731" or "4732" or "4733" or "4734" or "4735" or "4737" or "4754" or "4755" or "4756" or "4757" or "4758" or "4764" or "4799") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.GroupName", "EventData.GroupDomain", "Channel", "EventData.MemberName", "Task" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, group\_name, group\_domain, channel, MemberName, task nodrop<br />\| parse regex field=msg\_summary "(?:New\|Deleted) Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop <br />\| parse regex field=msg\_summary "Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where (event\_id in ("4727", "4728", "4729", "4730", "4731", "4732", "4733", "4734", "4735", "4737", "4754", "4755", "4756", "4757", "4758", "4764", "4799") or task = "13826") and host matches "{{host}}"<br />\| where group\_name in ("Administrators", "Domain Admins", "Schema Admins", "Server Operators", "Account Operators", "Backup Operators") // Update the list if you have any custom Administrative group name<br />\| count as count|
|Windows 2012+ (JSON)/Security Status|Closed RDP Sessions Tracking|Logs|Installed Apps/Windows 2012+ (JSON)/Security Status/Closed RDP Sessions Tracking|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("\\"EventID\\":\\"4778\\"" or "\\"EventID\\":\\"4779\\"") \_sourceName=Security<br />\| join <br />( json "EventID", "Computer", "EventData.ClientName",  "EventData.ClientAddress", "EventData.AccountName", "EventData.AccountDomain", "EventData.SessionName", "EventData.LogonID" as event\_id, host, src\_user, src\_ipaddress, dest\_user, dest\_domain, SessionName, logonID nodrop \| where event\_id = "4778") as q1,<br />( json "EventID", "Computer", "EventData.ClientName",  "EventData.ClientAddress", "EventData.AccountName", "EventData.AccountDomain", "EventData.SessionName", "EventData.LogonID" as event\_id, host, src\_user, src\_ipaddress, dest\_user, dest\_domain, SessionName, logonID nodrop \| where event\_id = "4779") as q2<br />on q1.host = q2.host <br />and q1.dest\_user = q2.dest\_user<br />and q1.dest\_domain = q2.dest\_domain<br />and q1.SessionName = q2.SessionName<br />and q1.logonID = q2.logonID<br />\| fields q1\_src\_user, q1\_src\_ipaddress, q1\_host, q1\_dest\_user, q1\_dest\_domain, q1\_SessionName, q1\_logonID|
|Windows 2012+ (JSON)/Security Status|Closed RDP Sessions Tracking|Logs|Windows 2012+ (JSON)/Security Status/Closed RDP Sessions Tracking|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("\\"EventID\\":\\"4778\\"" or "\\"EventID\\":\\"4779\\"") \_sourceName=Security<br />\| join <br />( json "EventID", "Computer", "EventData.ClientName",  "EventData.ClientAddress", "EventData.AccountName", "EventData.AccountDomain", "EventData.SessionName", "EventData.LogonID" as event\_id, host, src\_user, src\_ipaddress, dest\_user, dest\_domain, SessionName, logonID nodrop \| where event\_id = "4778") as q1,<br />( json "EventID", "Computer", "EventData.ClientName",  "EventData.ClientAddress", "EventData.AccountName", "EventData.AccountDomain", "EventData.SessionName", "EventData.LogonID" as event\_id, host, src\_user, src\_ipaddress, dest\_user, dest\_domain, SessionName, logonID nodrop \| where event\_id = "4779") as q2<br />on q1.host = q2.host <br />and q1.dest\_user = q2.dest\_user<br />and q1.dest\_domain = q2.dest\_domain<br />and q1.SessionName = q2.SessionName<br />and q1.logonID = q2.logonID<br />\| fields q1\_src\_user, q1\_src\_ipaddress, q1\_host, q1\_dest\_user, q1\_dest\_domain, q1\_SessionName, q1\_logonID|
|Windows 2012+ (JSON)/Security Status|Closed Sessions Tracking|Logs|Installed Apps/Windows 2012+ (JSON)/Security Status/Closed Sessions Tracking|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("\\"EventID\\":\\"4624\\"" or "\\"EventID\\":\\"4634\\"") \_sourceName=Security<br />\| join <br />(json "EventID", "Computer", "EventData.SubjectUserName",  "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.LogonType", "EventData.LogonGuid", "EventData.SubjectLogonId", "EventData.TargetLogonId"  as event\_id, host, src\_user, src\_domain, dest\_user, dest\_domain, LogonType, LogonGuid, SubjectLogonId, TargetLogonId nodrop \| where event\_id = "4624") as q1,<br />( json "EventID", "Computer", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.LogonType", "EventData.TargetLogonId"  as event\_id, host, dest\_user, dest\_domain, LogonType, TargetLogonId nodrop \| where event\_id = "4634") as q2<br />on q1.host = q2.host <br />and q1.LogonType = q2.LogonType<br />and q1.dest\_user = q2.dest\_user<br />and q1.dest\_domain = q2.dest\_domain<br />and q1.LogonType = q2.LogonType<br />and q1.TargetLogonId = q2.TargetLogonId<br />\| fields q1\_src\_user, q1\_src\_domain, q1\_host, q1\_dest\_user, q1\_dest\_domain, q1\_LogonType, q1\_TargetLogonId, q1\_LogonGuid, q1\_SubjectLogonId|
|Windows 2012+ (JSON)/Security Status|Closed Sessions Tracking|Logs|Windows 2012+ (JSON)/Security Status/Closed Sessions Tracking|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("\\"EventID\\":\\"4624\\"" or "\\"EventID\\":\\"4634\\"") \_sourceName=Security<br />\| join <br />(json "EventID", "Computer", "EventData.SubjectUserName",  "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.LogonType", "EventData.LogonGuid", "EventData.SubjectLogonId", "EventData.TargetLogonId"  as event\_id, host, src\_user, src\_domain, dest\_user, dest\_domain, LogonType, LogonGuid, SubjectLogonId, TargetLogonId nodrop \| where event\_id = "4624") as q1,<br />( json "EventID", "Computer", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.LogonType", "EventData.TargetLogonId"  as event\_id, host, dest\_user, dest\_domain, LogonType, TargetLogonId nodrop \| where event\_id = "4634") as q2<br />on q1.host = q2.host <br />and q1.LogonType = q2.LogonType<br />and q1.dest\_user = q2.dest\_user<br />and q1.dest\_domain = q2.dest\_domain<br />and q1.LogonType = q2.LogonType<br />and q1.TargetLogonId = q2.TargetLogonId<br />\| fields q1\_src\_user, q1\_src\_domain, q1\_host, q1\_dest\_user, q1\_dest\_domain, q1\_LogonType, q1\_TargetLogonId, q1\_LogonGuid, q1\_SubjectLogonId|
|Windows 2012+ (JSON)|Error Keyword - LogReduce|Logs|Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| timeslice 24h<br />\| logreduce by \_timeslice<br />\| sort by \_count|
|Windows 2012+ (JSON)|Error Keyword - LogReduce|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| timeslice 24h<br />\| logreduce by \_timeslice<br />\| sort by \_count|
|Windows 2012+ (JSON)|Error Keyword - One Day Time Comparison|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| count by keyword\_tag <br />\| compare with timeshift 1d<br />\| sort by \_count|
|Windows 2012+ (JSON)|Error Keyword - One Day Time Comparison|Logs|Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| count by keyword\_tag <br />\| compare with timeshift 1d<br />\| sort by \_count|
|Windows 2012+ (JSON)|Error Keyword - Outlier|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| timeslice 15m<br />\| count by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier \_count|
|Windows 2012+ (JSON)|Error Keyword - Outlier|Logs|Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| timeslice 15m<br />\| count by \_timeslice<br />\| fillmissing timeslice(15m)<br />\| outlier \_count|
|Windows 2012+ (JSON)|Error Keyword by Computer and Message|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| count by keyword\_tag, host, msg\_summary<br />\| sort by \_count, keyword\_tag, host, msg\_summary|
|Windows 2012+ (JSON)|Error Keyword by Computer and Message|Logs|Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| count by keyword\_tag, host, msg\_summary<br />\| sort by \_count, keyword\_tag, host, msg\_summary|
|Windows 2012+ (JSON)|Error Keyword Trend|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| timeslice 15m<br />\| count by keyword\_tag, \_timeslice<br />\| transpose row \_timeslice column keyword\_tag<br />\| fillmissing timeslice(15m)|
|Windows 2012+ (JSON)|Error Keyword Trend|Logs|Windows 2012+ (JSON)/Windows - Event Errors|\_sourceCategory={{Logsdatasource}}   "\\"Level\\":\\"Error\\""<br />\| json "EventID", "Computer", "Level", "Message" as event\_id, host, level, msg\_summary nodrop<br />\| where level = "Error" and host matches "{{host}}"<br />\| if (msg\_summary matches "\*error\*", "error\_keyword", if (msg\_summary matches "\*Error\*", "error\_keyword", if (msg\_summary matches "\*exception\*", "exception\_keyword", if (msg\_summary matches "\*Exception\*", "exception\_keyword", if (msg\_summary matches "\*timeout\*", "timeout\_keyword", if (msg\_summary matches "\*Timeout\*", "timeout\_keyword", if (msg\_summary matches "\*fail\*", "fail\_keyword", if (msg\_summary matches "\*Fail\*", "fail\_keyword", "no\_error\_keywords")))))))) as keyword\_tag<br />\| timeslice 15m<br />\| count by keyword\_tag, \_timeslice<br />\| transpose row \_timeslice column keyword\_tag<br />\| fillmissing timeslice(15m)|
|Windows 2012+ (JSON)|Errors and Warnings Over Time|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Default|\_sourceCategory={{Logsdatasource}}   ("\\"Level\\":\\"Warning\\"" or "\\"Level\\":\\"Error\\"")<br />\| json "EventID", "Computer", "Level" as event\_id, host, level nodrop<br />\| where level in ("Error", "Warning") and host matches "{{host}}"<br />\| timeslice 1h<br />\| count by \_timeslice, level<br />\| transpose row \_timeslice column level<br />\| fillmissing timeslice(1h)|
|Windows 2012+ (JSON)|Errors and Warnings Over Time|Logs|Windows 2012+ (JSON)/Windows - Default|\_sourceCategory={{Logsdatasource}}   ("\\"Level\\":\\"Warning\\"" or "\\"Level\\":\\"Error\\"")<br />\| json "EventID", "Computer", "Level" as event\_id, host, level nodrop<br />\| where level in ("Error", "Warning") and host matches "{{host}}"<br />\| timeslice 1h<br />\| count by \_timeslice, level<br />\| transpose row \_timeslice column level<br />\| fillmissing timeslice(1h)|
|Windows 2012+ (JSON)|Event Distribution Over Time|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Default|\_sourceCategory={{Logsdatasource}}  <br />\| json "EventID", "Computer", "Channel" as event\_id, host, channel nodrop<br />\| where !isEmpty(channel) and host matches "{{host}}"<br />\| timeslice 1h <br />\| count by \_timeslice, channel<br />\| transpose row \_timeslice column channel<br />\| fillmissing timeslice(1h)|
|Windows 2012+ (JSON)|Event Distribution Over Time|Logs|Windows 2012+ (JSON)/Windows - Default|\_sourceCategory={{Logsdatasource}}  <br />\| json "EventID", "Computer", "Channel" as event\_id, host, channel nodrop<br />\| where !isEmpty(channel) and host matches "{{host}}"<br />\| timeslice 1h <br />\| count by \_timeslice, channel<br />\| transpose row \_timeslice column channel<br />\| fillmissing timeslice(1h)|
|Windows 2012+ (JSON)|Events by Level|Logs|Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\""  \_sourceName=Application<br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where host matches "{{host}}" and level matches "{{level}}" and channel = "Application"<br />\| timeslice 1h<br />\| count by \_timeslice, level<br />\| transpose row \_timeslice column level|
|Windows 2012+ (JSON)|Events by Level|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\""  \_sourceName=Application<br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where host matches "{{host}}" and level matches "{{level}}" and channel = "Application"<br />\| timeslice 1h<br />\| count by \_timeslice, level<br />\| transpose row \_timeslice column level|
|Windows 2012+ (JSON)|Events Trend|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\""  \_sourceName=Application <br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where host matches "{{host}}" and level matches "{{level}}" and channel = "Application"<br />\| timeslice 15m<br />\| count by \_timeslice, event\_id<br />\| transpose row \_timeslice column event\_id|
|Windows 2012+ (JSON)|Events Trend|Logs|Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\""  \_sourceName=Application <br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where host matches "{{host}}" and level matches "{{level}}" and channel = "Application"<br />\| timeslice 15m<br />\| count by \_timeslice, event\_id<br />\| transpose row \_timeslice column event\_id|
|Windows 2012+ (JSON)|Failed Logins by Hour|Logs|Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where (event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")) and host matches "{{host}}"<br />\| timeslice 1h <br />\| count as attempts by \_timeslice, host<br />\| transpose row \_timeslice column host|
|Windows 2012+ (JSON)|Failed Logins by Hour|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where (event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")) and host matches "{{host}}"<br />\| timeslice 1h <br />\| count as attempts by \_timeslice, host<br />\| transpose row \_timeslice column host|
|Windows 2012+ (JSON)|Failed Logins Outlier|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where (event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")) and host matches "{{host}}"<br />\| timeslice 15m<br />\| count as failed\_logins by \_timeslice<br />\| outlier failed\_logins|
|Windows 2012+ (JSON)|Failed Logins Outlier|Logs|Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where (event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")) and host matches "{{host}}"<br />\| timeslice 15m<br />\| count as failed\_logins by \_timeslice<br />\| outlier failed\_logins|
|Windows 2012+ (JSON)/User Activity|Failed Logins Over time|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/Failed Logins Over time|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")<br />\| timeslice by 1h<br />\| count by \_timeslice|
|Windows 2012+ (JSON)/User Activity|Failed Logins Over time|Logs|Windows 2012+ (JSON)/User Activity/Failed Logins Over time|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")<br />\| timeslice by 1h<br />\| count by \_timeslice|
|Windows 2012+ (JSON)|Failed Logins Source Location|Logs|Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where (event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")) and host matches "{{host}}"<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| where !isnull(latitude)|
|Windows 2012+ (JSON)|Failed Logins Source Location|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where (event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")) and host matches "{{host}}"<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| where !isnull(latitude)|
|Windows 2012+ (JSON)/Updates|Failed Updates by Host|Logs|Windows 2012+ (JSON)/Updates/Failed Updates by Host|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"20\\""  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where !isEmpty(update\_title) and event\_id = "20" and !isEmpty(error\_code)<br />\| count by host|
|Windows 2012+ (JSON)/Updates|Failed Updates by Host|Logs|Installed Apps/Windows 2012+ (JSON)/Updates/Failed Updates by Host|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"20\\""  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where !isEmpty(update\_title) and event\_id = "20" and !isEmpty(error\_code)<br />\| count by host|
|Windows 2012+ (JSON)/Updates|Failed Updates by KB Number|Logs|Installed Apps/Windows 2012+ (JSON)/Updates/Failed Updates by KB Number|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"20\\""  \_sourceName=System <br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where !isEmpty(update\_title) and event\_id = "20" and !isEmpty(error\_code) and !isEmpty(kbnum)<br />\| count by kbnum|
|Windows 2012+ (JSON)/Updates|Failed Updates by KB Number|Logs|Windows 2012+ (JSON)/Updates/Failed Updates by KB Number|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"20\\""  \_sourceName=System <br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where !isEmpty(update\_title) and event\_id = "20" and !isEmpty(error\_code) and !isEmpty(kbnum)<br />\| count by kbnum|
|Windows 2012+ (JSON)/Security Status|Firewall Changes|Logs|Installed Apps/Windows 2012+ (JSON)/Security Status/Firewall Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("4946" or "4947" or "4948" or "4949" or "4950" or "4954" or "5025") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel", "Keywords" as event\_id, host, msg\_summary, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4946", "4947", "4948", "4949", "4950", "4954", "5025") and channel = "Security"|
|Windows 2012+ (JSON)/Security Status|Firewall Changes|Logs|Windows 2012+ (JSON)/Security Status/Firewall Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("4946" or "4947" or "4948" or "4949" or "4950" or "4954" or "5025") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel", "Keywords" as event\_id, host, msg\_summary, channel, Keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4946", "4947", "4948", "4949", "4950", "4954", "5025") and channel = "Security"|
|Windows 2012+ (JSON)|Installations and UnInstallations|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\"" (1033 or 1034 or 11707 or 11724)  \_sourceName=Application<br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where event\_id in ("1033", "1034", "11707", "11724") and channel = "Application" and host matches "{{host}}" and level matches "{{level}}"<br />\| count by event\_id, host, activity, product\_name, product\_version, manufacturer, status, level<br />\| topk(10,\_count) by host, activity \| fields -\_rank|
|Windows 2012+ (JSON)|Installations and UnInstallations|Logs|Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\"" (1033 or 1034 or 11707 or 11724)  \_sourceName=Application<br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where event\_id in ("1033", "1034", "11707", "11724") and channel = "Application" and host matches "{{host}}" and level matches "{{level}}"<br />\| count by event\_id, host, activity, product\_name, product\_version, manufacturer, status, level<br />\| topk(10,\_count) by host, activity \| fields -\_rank|
|Windows 2012+ (JSON)|Level Breakdown|Logs|Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\""  \_sourceName=Application<br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where host matches "{{host}}" and level matches "{{level}}" and channel = "Application"<br />\| count by Level \| sort by \_count, level asc|
|Windows 2012+ (JSON)|Level Breakdown|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\""  \_sourceName=Application<br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where host matches "{{host}}" and level matches "{{level}}" and channel = "Application"<br />\| count by Level \| sort by \_count, level asc|
|Windows 2012+ (JSON)|Logins by Hour|Logs|Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4624 or 4625 or 4771 or 4776 or 4768 or 4769) \_sourceName=Security<br />// 4624 - Login Success, 4625 or 4771 - Login Failures, 4776 - Domain Controller - Credential validation, 4768 - A Kerberos authentication ticket (TGT) was requested, 4769 - A Kerberos service ticket was requested<br />\| json "EventID", "Computer", "Level", "Message", "Keywords", "Channel" as event\_id, host, event\_type, msg\_summary, Keywords, channel nodrop<br />\| where event\_id in ("4624", "4625", "4771", "4776", "4768", "4769") and channel = "Security" and host matches "{{host}}"<br />\| if (Keywords matches "Audit Success", "Success", "Failure") as outcome <br />\| timeslice 1h <br />\| count as attempts by \_timeslice, outcome<br />\| transpose row \_timeslice column outcome|
|Windows 2012+ (JSON)|Logins by Hour|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4624 or 4625 or 4771 or 4776 or 4768 or 4769) \_sourceName=Security<br />// 4624 - Login Success, 4625 or 4771 - Login Failures, 4776 - Domain Controller - Credential validation, 4768 - A Kerberos authentication ticket (TGT) was requested, 4769 - A Kerberos service ticket was requested<br />\| json "EventID", "Computer", "Level", "Message", "Keywords", "Channel" as event\_id, host, event\_type, msg\_summary, Keywords, channel nodrop<br />\| where event\_id in ("4624", "4625", "4771", "4776", "4768", "4769") and channel = "Security" and host matches "{{host}}"<br />\| if (Keywords matches "Audit Success", "Success", "Failure") as outcome <br />\| timeslice 1h <br />\| count as attempts by \_timeslice, outcome<br />\| transpose row \_timeslice column outcome|
|Windows 2012+ (JSON)/User Activity|Multiple Failed Logins by Same User|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/Multiple Failed Logins by Same User|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, workstation, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")<br />\| fields host, event\_id, msg\_summary, src\_user, src\_ip, src\_port, src\_domain, dest\_user, dest\_domain, fail\_reason, logon\_type, result\_code, failure\_code, status, sub\_status, failure\_reason, src\_host, Keywords<br />\| count by host, src\_user, dest\_user <br />\| where \_count \> 3 \| sort by \_count|
|Windows 2012+ (JSON)/User Activity|Multiple Failed Logins by Same User|Logs|Windows 2012+ (JSON)/User Activity/Multiple Failed Logins by Same User|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, workstation, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")<br />\| fields host, event\_id, msg\_summary, src\_user, src\_ip, src\_port, src\_domain, dest\_user, dest\_domain, fail\_reason, logon\_type, result\_code, failure\_code, status, sub\_status, failure\_reason, src\_host, Keywords<br />\| count by host, src\_user, dest\_user <br />\| where \_count \> 3 \| sort by \_count|
|Windows 2012+ (JSON)/User Activity|Multiple Failed Logins on Local Machine|Logs|Windows 2012+ (JSON)/User Activity/Multiple Failed Logins on Local Machine|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4625\\"" "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| where event\_id = "4625" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_ip, src\_port, src\_domain, dest\_user, dest\_domain, fail\_reason, logon\_type, status, sub\_status, failure\_reason, src\_host, Keywords<br />\| count by dest\_user \| where \_count \> 3|
|Windows 2012+ (JSON)/User Activity|Multiple Failed Logins on Local Machine|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/Multiple Failed Logins on Local Machine|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4625\\"" "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| where event\_id = "4625" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_ip, src\_port, src\_domain, dest\_user, dest\_domain, fail\_reason, logon\_type, status, sub\_status, failure\_reason, src\_host, Keywords<br />\| count by dest\_user \| where \_count \> 3|
|Windows 2012+ (JSON)/User Activity|New Accounts Created|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/New Accounts Created|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4720\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4720" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain|
|Windows 2012+ (JSON)/User Activity|New Accounts Created|Logs|Windows 2012+ (JSON)/User Activity/New Accounts Created|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4720\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4720" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain|
|Windows 2012+ (JSON)|Recent Policy Changes|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   ( "Audit Policy Change" or "System audit policy was changed" or \*policy\*change\* or "Policy Change" or 4902 or 4904 or 4905 or 4906 or 4907 or 4912 or 4715 or 4719 or 4739)<br />\| json "EventID", "Computer", "Message" as event\_id, host, msg\_summary nodrop<br />\| parse regex field = msg\_summary "(?\<msg\_summary\>.\*\\.\*)" <br />\| where (event\_id in ("4902", "4904", "4905", "4906", "4907", "4912", "4715", "4719", "4739") or msg\_summary matches "System audit policy was changed\*") and host matches "{{host}}"<br />\| count by msg\_summary \| sort by \_count, msg\_summary asc|
|Windows 2012+ (JSON)|Recent Policy Changes|Logs|Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   ( "Audit Policy Change" or "System audit policy was changed" or \*policy\*change\* or "Policy Change" or 4902 or 4904 or 4905 or 4906 or 4907 or 4912 or 4715 or 4719 or 4739)<br />\| json "EventID", "Computer", "Message" as event\_id, host, msg\_summary nodrop<br />\| parse regex field = msg\_summary "(?\<msg\_summary\>.\*\\.\*)" <br />\| where (event\_id in ("4902", "4904", "4905", "4906", "4907", "4912", "4715", "4719", "4739") or msg\_summary matches "System audit policy was changed\*") and host matches "{{host}}"<br />\| count by msg\_summary \| sort by \_count, msg\_summary asc|
|Windows 2012+ (JSON)/Security Status|Recent Policy Changes|Logs|Windows 2012+ (JSON)/Security Status/Recent Policy Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4902 or 4904 or 4905 or 4906 or 4907 or 4912 or 4715 or 4719 or 4739 or "Audit Policy Change" or "System audit policy was changed" or \*policy\*change\* or "Policy Change") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel" as event\_id, host, msg\_summary, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" <br />\| where event\_id in ("4902", "4904", "4905", "4906", "4907", "4912", "4715", "4719", "4739") or msg\_summary matches "System audit policy was changed" or msg\_summary matches "\*policy\*change\*"|
|Windows 2012+ (JSON)/Security Status|Recent Policy Changes|Logs|Installed Apps/Windows 2012+ (JSON)/Security Status/Recent Policy Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4902 or 4904 or 4905 or 4906 or 4907 or 4912 or 4715 or 4719 or 4739 or "Audit Policy Change" or "System audit policy was changed" or \*policy\*change\* or "Policy Change") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel" as event\_id, host, msg\_summary, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" <br />\| where event\_id in ("4902", "4904", "4905", "4906", "4907", "4912", "4715", "4719", "4739") or msg\_summary matches "System audit policy was changed" or msg\_summary matches "\*policy\*change\*"|
|Windows 2012+ (JSON)/Updates|Report Messages|Logs|Installed Apps/Windows 2012+ (JSON)/Updates/Report Messages|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" ("\\"EventID\\":\\"19\\"" or "\\"EventID\\":\\"20\\"" or "\\"EventID\\":\\"43\\"")  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where event\_id in ("19", "20", "43") and !isEmpty(update\_title)|
|Windows 2012+ (JSON)/Updates|Report Messages|Logs|Windows 2012+ (JSON)/Updates/Report Messages|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" ("\\"EventID\\":\\"19\\"" or "\\"EventID\\":\\"20\\"" or "\\"EventID\\":\\"43\\"")  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where event\_id in ("19", "20", "43") and !isEmpty(update\_title)|
|Windows 2012+ (JSON)/System Activity|Service Events by Type|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/Service Events by Type|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "Service Control Manager"  \_sourceName=System<br />\| json "Provider.EventSourceName", "Keywords" as event\_source\_name, Keywords nodrop<br />\| where event\_source\_name = "Service Control Manager"<br />\| count by Keywords|
|Windows 2012+ (JSON)/System Activity|Service Events by Type|Logs|Windows 2012+ (JSON)/System Activity/Service Events by Type|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "Service Control Manager"  \_sourceName=System<br />\| json "Provider.EventSourceName", "Keywords" as event\_source\_name, Keywords nodrop<br />\| where event\_source\_name = "Service Control Manager"<br />\| count by Keywords|
|Windows 2012+ (JSON)/System Activity|Service Installed|Logs|Windows 2012+ (JSON)/System Activity/Service Installed|\_sourceCategory={{Logsdatasource}}  (("\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7045\\"") or ("\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4697\\""))<br />\| json "EventID", "Computer", "Message", "EventData.AccountName", "EventData.ServiceName", "EventData.ServiceType", "EventData.StartType", "EventData.ImagePath", "Provider.EventSourceName"  as event\_id, host, msg\_summary, account\_name, service\_name, service\_type, service\_start\_type, service\_image\_path, event\_source\_name nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4697", "7045")<br />\| fields event\_id, host, msg\_summary, account\_name, service\_name, service\_type, service\_start\_type, service\_image\_path, event\_source\_name|
|Windows 2012+ (JSON)/System Activity|Service Installed|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/Service Installed|\_sourceCategory={{Logsdatasource}}  (("\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7045\\"") or ("\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4697\\""))<br />\| json "EventID", "Computer", "Message", "EventData.AccountName", "EventData.ServiceName", "EventData.ServiceType", "EventData.StartType", "EventData.ImagePath", "Provider.EventSourceName"  as event\_id, host, msg\_summary, account\_name, service\_name, service\_type, service\_start\_type, service\_image\_path, event\_source\_name nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4697", "7045")<br />\| fields event\_id, host, msg\_summary, account\_name, service\_name, service\_type, service\_start\_type, service\_image\_path, event\_source\_name|
|Windows 2012+ (JSON)/System Activity|Service Starts|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/Service Starts|//https://social.technet.microsoft.com/Forums/ie/en-US/017cf738-d29b-4b77-aa3d-756fcdbb3a5f/event-id-7036?forum=w7itproperf<br />\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7036\\"" "running"  \_sourceName=System <br />\| json "EventID", "Computer", "Message", "EventData.param1", "EventData.param2", "Channel", "Provider.EventSourceName" as event\_id, host, msg\_summary, service\_name, service\_state, channel, event\_source\_name nodrop <br />\| where event\_id = "7036" and channel = "System" and service\_state="running"<br />\| fields host, event\_id, service\_name, service\_state, event\_source\_name|
|Windows 2012+ (JSON)/System Activity|Service Starts|Logs|Windows 2012+ (JSON)/System Activity/Service Starts|//https://social.technet.microsoft.com/Forums/ie/en-US/017cf738-d29b-4b77-aa3d-756fcdbb3a5f/event-id-7036?forum=w7itproperf<br />\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7036\\"" "running"  \_sourceName=System <br />\| json "EventID", "Computer", "Message", "EventData.param1", "EventData.param2", "Channel", "Provider.EventSourceName" as event\_id, host, msg\_summary, service\_name, service\_state, channel, event\_source\_name nodrop <br />\| where event\_id = "7036" and channel = "System" and service\_state="running"<br />\| fields host, event\_id, service\_name, service\_state, event\_source\_name|
|Windows 2012+ (JSON)/System Activity|Service Stops|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/Service Stops|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7036\\"" stopped  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "EventData.param1", "EventData.param2", "Channel", "Provider.EventSourceName" as event\_id, host, msg\_summary, service\_name, service\_state, channel, event\_source\_name nodrop <br />\| where event\_id = "7036" and channel = "System" and service\_state="stopped"<br />\| fields host, event\_id, service\_name, service\_state, event\_source\_name|
|Windows 2012+ (JSON)/System Activity|Service Stops|Logs|Windows 2012+ (JSON)/System Activity/Service Stops|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7036\\"" stopped  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "EventData.param1", "EventData.param2", "Channel", "Provider.EventSourceName" as event\_id, host, msg\_summary, service\_name, service\_state, channel, event\_source\_name nodrop <br />\| where event\_id = "7036" and channel = "System" and service\_state="stopped"<br />\| fields host, event\_id, service\_name, service\_state, event\_source\_name|
|Windows 2012+ (JSON)/User Activity|Successful Group Creations|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/Successful Group Creations|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("\\"EventID\\":\\"4727\\"" or "\\"EventID\\":\\"4731\\"" or "\\"EventID\\":\\"4754\\"") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4727", "4731", "4754")<br />\| dest\_user as group\_name \| dest\_domain as group\_domain<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, group\_name, group\_domain|
|Windows 2012+ (JSON)/User Activity|Successful Group Creations|Logs|Windows 2012+ (JSON)/User Activity/Successful Group Creations|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" ("\\"EventID\\":\\"4727\\"" or "\\"EventID\\":\\"4731\\"" or "\\"EventID\\":\\"4754\\"") \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4727", "4731", "4754")<br />\| dest\_user as group\_name \| dest\_domain as group\_domain<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, group\_name, group\_domain|
|Windows 2012+ (JSON)|Successful Login Source Location|Logs|Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4624\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Level", "Message", "Keywords", "EventData.SubjectUserName",  "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.IpAddress", "EventData.IpPort", "Channel" as event\_id, host, event\_type, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, src\_ip, src\_port, channel nodrop<br />\| where event\_id = "4624" and !(src\_user = "-" and dest\_user = "-") and channel = "Security" and host matches "{{host}}"<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| where !isnull(latitude)|
|Windows 2012+ (JSON)|Successful Login Source Location|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4624\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Level", "Message", "Keywords", "EventData.SubjectUserName",  "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.IpAddress", "EventData.IpPort", "Channel" as event\_id, host, event\_type, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, src\_ip, src\_port, channel nodrop<br />\| where event\_id = "4624" and !(src\_user = "-" and dest\_user = "-") and channel = "Security" and host matches "{{host}}"<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| where !isnull(latitude)|
|Windows 2012+ (JSON)|Successful Logins|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4624\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Keywords", "EventData.SubjectUserName",  "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.IpAddress", "EventData.IpPort", "Channel", "Level" as event\_id, host, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, src\_ip, src\_port, channel, level nodrop<br />\| where event\_id = "4624" and (src\_user!="" or dest\_user!="") and channel = "Security" and host matches "{{host}}"<br />\| count as attempts by host, src\_user, dest\_user, src\_ip, src\_port, src\_domain, dest\_domain<br />\| sort - attempts|
|Windows 2012+ (JSON)|Successful Logins|Logs|Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4624\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Keywords", "EventData.SubjectUserName",  "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.IpAddress", "EventData.IpPort", "Channel", "Level" as event\_id, host, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, src\_ip, src\_port, channel, level nodrop<br />\| where event\_id = "4624" and (src\_user!="" or dest\_user!="") and channel = "Security" and host matches "{{host}}"<br />\| count as attempts by host, src\_user, dest\_user, src\_ip, src\_port, src\_domain, dest\_domain<br />\| sort - attempts|
|Windows 2012+ (JSON)/User Activity|Successful Logons Over time|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/Successful Logons Over time|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4624\\"" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "Keywords", "EventData.SubjectUserName",  "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.IpAddress", "EventData.IpPort", "Channel", "Level" as event\_id, host, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, src\_ip, src\_port, channel, level nodrop<br />\| where event\_id = "4624" and (src\_user !="" or dest\_user !="") and channel = "Security"<br />\| timeslice by 1h<br />\| count by \_timeslice|
|Windows 2012+ (JSON)/User Activity|Successful Logons Over time|Logs|Windows 2012+ (JSON)/User Activity/Successful Logons Over time|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4624\\"" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "Keywords", "EventData.SubjectUserName",  "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.IpAddress", "EventData.IpPort", "Channel", "Level" as event\_id, host, msg\_summary, Keywords, src\_user, src\_domain, dest\_user, dest\_domain, src\_ip, src\_port, channel, level nodrop<br />\| where event\_id = "4624" and (src\_user !="" or dest\_user !="") and channel = "Security"<br />\| timeslice by 1h<br />\| count by \_timeslice|
|Windows 2012+ (JSON)|Successful RDP Reconnects|Logs|Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4778\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "EventData.AccountName", "EventData.AccountDomain", "EventData.SessionName", "EventData.ClientName", "EventData.ClientAddress", "Channel", "EventData.LogonID" as event\_id, host, dest\_user, dest\_domain, session\_name, src\_host, src\_ip, channel, LogonID nodrop<br />\| where event\_id = "4778" and channel = "Security" and host matches "{{host}}"<br />\| timeslice 1s<br />\| count as attempts by \_timeslice, host, dest\_user, dest\_domain, session\_name, src\_host, src\_ip, LogonID<br />\| sort by \_timeslice|
|Windows 2012+ (JSON)|Successful RDP Reconnects|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Login Status|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4778\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "EventData.AccountName", "EventData.AccountDomain", "EventData.SessionName", "EventData.ClientName", "EventData.ClientAddress", "Channel", "EventData.LogonID" as event\_id, host, dest\_user, dest\_domain, session\_name, src\_host, src\_ip, channel, LogonID nodrop<br />\| where event\_id = "4778" and channel = "Security" and host matches "{{host}}"<br />\| timeslice 1s<br />\| count as attempts by \_timeslice, host, dest\_user, dest\_domain, session\_name, src\_host, src\_ip, LogonID<br />\| sort by \_timeslice|
|Windows 2012+ (JSON)/Updates|Successful Updates by Host|Logs|Windows 2012+ (JSON)/Updates/Successful Updates by Host|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"19\\"" "Installation Successful"  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where event\_id = "19"<br />\| count by \_sourceHost|
|Windows 2012+ (JSON)/Updates|Successful Updates by Host|Logs|Installed Apps/Windows 2012+ (JSON)/Updates/Successful Updates by Host|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"19\\"" "Installation Successful"  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where event\_id = "19"<br />\| count by \_sourceHost|
|Windows 2012+ (JSON)/Updates|Successful Updates by KB number|Logs|Installed Apps/Windows 2012+ (JSON)/Updates/Successful Updates by KB number|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"19\\"" "Installation Successful"  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where !isEmpty(kbnum) and event\_id = "19"<br />\| count by kbnum|
|Windows 2012+ (JSON)/Updates|Successful Updates by KB number|Logs|Windows 2012+ (JSON)/Updates/Successful Updates by KB number|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"19\\"" "Installation Successful"  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where !isEmpty(kbnum) and event\_id = "19"<br />\| count by kbnum|
|Windows 2012+ (JSON)|System Operations|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Default|\_sourceCategory={{Logsdatasource}}   (4608 or 4946 or 4947 or 4948 or 4949 or 4950 or 4954 or 5025 or 4727 or 4731 or 4754 or 4720)<br />\| json "EventID", "Computer" as event\_id, host nodrop<br />\| "" as operation <br />\| if (event\_id = "4608", "Restarts", operation) as operation  <br />\| if (event\_id in ("4946", "4947", "4948", "4949", "4950", "4954", "5025"), "Firewall Changes", operation) as operation <br />\| if (event\_id in ("4727", "4731", "4754"), "Groups Created", operation) as operation<br />\| if (event\_id = "4720", "Users Created", operation) as operation<br />\| where operation != "" and host matches "{{host}}"<br />\| count as count by operation, host <br />\| transpose row host column operation|
|Windows 2012+ (JSON)|System Operations|Logs|Windows 2012+ (JSON)/Windows - Default|\_sourceCategory={{Logsdatasource}}   (4608 or 4946 or 4947 or 4948 or 4949 or 4950 or 4954 or 5025 or 4727 or 4731 or 4754 or 4720)<br />\| json "EventID", "Computer" as event\_id, host nodrop<br />\| "" as operation <br />\| if (event\_id = "4608", "Restarts", operation) as operation  <br />\| if (event\_id in ("4946", "4947", "4948", "4949", "4950", "4954", "5025"), "Firewall Changes", operation) as operation <br />\| if (event\_id in ("4727", "4731", "4754"), "Groups Created", operation) as operation<br />\| if (event\_id = "4720", "Users Created", operation) as operation<br />\| where operation != "" and host matches "{{host}}"<br />\| count as count by operation, host <br />\| transpose row host column operation|
|Windows 2012+ (JSON)/System Activity|System Restarted|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/System Restarted|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4608\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel" as event\_id, host, msg\_summary, channel nodrop <br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4608" and channel = "Security"<br />\| fields event\_id, host, msg\_summary, channel|
|Windows 2012+ (JSON)/System Activity|System Restarted|Logs|Windows 2012+ (JSON)/System Activity/System Restarted|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4608\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel" as event\_id, host, msg\_summary, channel nodrop <br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4608" and channel = "Security"<br />\| fields event\_id, host, msg\_summary, channel|
|Windows 2012+ (JSON)|System Restarts|Logs|Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4608\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel" as event\_id, host, msg\_summary, channel nodrop <br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4608" and channel = "Security" and host matches "{{host}}"<br />\| count as Restarts|
|Windows 2012+ (JSON)|System Restarts|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4608\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel" as event\_id, host, msg\_summary, channel nodrop <br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4608" and channel = "Security" and host matches "{{host}}"<br />\| count as Restarts|
|Windows 2012+ (JSON)|Top 10 Service Operations|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Default|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7036\\"" (running or stopped)  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "EventData.param1", "EventData.param2", "Channel", "Provider.EventSourceName" as event\_id, host, msg\_summary, service\_name, service\_state, channel, event\_source\_name nodrop <br />\| where event\_id = "7036" and service\_state in ("running", "stopped") and channel = "System" and host matches "{{host}}"<br />\| if (service\_state = "running", 1, 0) as starts<br />\| if (service\_state = "stopped", 1, 0) as stops <br />\| sum(starts) as starts, sum(stops) as stops by service\_name, host<br />\| sort by stops, starts<br />\| limit 10<br />\| fields -host|
|Windows 2012+ (JSON)|Top 10 Service Operations|Logs|Windows 2012+ (JSON)/Windows - Default|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7036\\"" (running or stopped)  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "EventData.param1", "EventData.param2", "Channel", "Provider.EventSourceName" as event\_id, host, msg\_summary, service\_name, service\_state, channel, event\_source\_name nodrop <br />\| where event\_id = "7036" and service\_state in ("running", "stopped") and channel = "System" and host matches "{{host}}"<br />\| if (service\_state = "running", 1, 0) as starts<br />\| if (service\_state = "stopped", 1, 0) as stops <br />\| sum(starts) as starts, sum(stops) as stops by service\_name, host<br />\| sort by stops, starts<br />\| limit 10<br />\| fields -host|
|Windows 2012+ (JSON)/Updates|Top Error Codes|Logs|Windows 2012+ (JSON)/Updates/Top Error Codes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"20\\""  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where !isEmpty(update\_title) and event\_id = "20" and !isEmpty(error\_code) <br />\| count by error\_code <br />\| top 10 error\_code by \_count, error\_code|
|Windows 2012+ (JSON)/Updates|Top Error Codes|Logs|Installed Apps/Windows 2012+ (JSON)/Updates/Top Error Codes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"20\\""  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| where !isEmpty(update\_title) and event\_id = "20" and !isEmpty(error\_code) <br />\| count by error\_code <br />\| top 10 error\_code by \_count, error\_code|
|Windows 2012+ (JSON)|Top Messages|Logs|Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\""  \_sourceName=Application <br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where host matches "{{host}}" and level matches "{{level}}" and channel = "Application"<br />\| count by msg\_summary, level<br />\| topk(10,\_count) by level \| fields -\_rank|
|Windows 2012+ (JSON)|Top Messages|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Application|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Application\\""  \_sourceName=Application <br />\| json "EventID", "Computer", "Channel", "Message", "Level" as event\_id, host, channel, msg\_summary, level nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| parse field=msg\_summary "Windows Installer \* the product. Product Name: \*. Product Version: \*. Product Language: \*. Manufacturer: \*. \* success or error status: \*." as action, product\_name, product\_version, product\_language, manufacturer, activity, status nodrop \| parse field=msg\_summary "Product: \* -- \* completed \*." as product\_name, activity, status nodrop<br />\| where host matches "{{host}}" and level matches "{{level}}" and channel = "Application"<br />\| count by msg\_summary, level<br />\| topk(10,\_count) by level \| fields -\_rank|
|Windows 2012+ (JSON)/System Activity|Top Reasons for Failed Logins|Logs|Windows 2012+ (JSON)/System Activity/Top Reasons for Failed Logins|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")<br />\| count by host, fail\_reason, failure\_reason, status, sub\_status, Keywords<br />\| top 20 fail\_reason, failure\_reason, status, sub\_status, host, Keywords by \_count|
|Windows 2012+ (JSON)/System Activity|Top Reasons for Failed Logins|Logs|Installed Apps/Windows 2012+ (JSON)/System Activity/Top Reasons for Failed Logins|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4771 or 4776 or 4768 or 4769 or 4625) "Audit Failure" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.LogonType", "EventData.FailureReason", "EventData.IpAddress", "EventData.IpPort", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.WorkstationName", "Channel", "EventData.Status", "EventData.SubStatus", "EventData.Workstation", "Keywords" as event\_id, host, msg\_summary, logon\_type, fail\_reason, src\_ip, src\_port, src\_user, src\_domain, dest\_user, dest\_domain, src\_host, channel, status, sub\_status, work\_station, Keywords nodrop<br />\| parse regex field=msg\_summary "Failure Information:\\s+Failure Reason:\\s+(?\<failure\_reason\>[^.\\r]+?)[.\\r]" nodrop<br />\| parse regex field=msg\_summary "Result Code:\\s+(?\<result\_code\>[^\\r]+)\\r" nodrop<br />\| parse regex field=msg\_summary "Failure Code:\\s+(?\<failure\_code\>[^\\r]+)\\r" nodrop<br />\| where event\_id in ("4625", "4771") or (event\_id = "4768" and result\_code != "0x0") or (event\_id = "4769" and failure\_code != "0x0") or (event\_id = "4776" and status != "0x0")<br />\| count by host, fail\_reason, failure\_reason, status, sub\_status, Keywords<br />\| top 20 fail\_reason, failure\_reason, status, sub\_status, host, Keywords by \_count|
|Windows 2012+ (JSON)/Security Status|Top Security Events|Logs|Installed Apps/Windows 2012+ (JSON)/Security Status/Top Security Events|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel" as event\_id, host, msg\_summary, channel nodrop <br />\| where channel = "Security"<br />\| count by event\_id<br />\| sort by \_count|
|Windows 2012+ (JSON)/Security Status|Top Security Events|Logs|Windows 2012+ (JSON)/Security Status/Top Security Events|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "Channel" as event\_id, host, msg\_summary, channel nodrop <br />\| where channel = "Security"<br />\| count by event\_id<br />\| sort by \_count|
|Windows 2012+ (JSON)|Top Services Installed|Logs|Installed Apps/Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   (("\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7045\\"") or ("\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4697\\""))<br />\| json "EventID", "Computer", "Message", "EventData.AccountName", "EventData.ServiceName", "EventData.ServiceType", "EventData.StartType", "EventData.ImagePath", "Provider.EventSourceName"  as event\_id, host, msg\_summary, account\_name, service\_name, service\_type, service\_start\_type, service\_image\_path, event\_source\_name nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4697", "7045") and host matches "{{host}}"<br />\| count by service\_name <br />\| top 10 service\_name by \_count|
|Windows 2012+ (JSON)|Top Services Installed|Logs|Windows 2012+ (JSON)/Windows - Overview|\_sourceCategory={{Logsdatasource}}   (("\\"Channel\\":\\"System\\"" "\\"EventID\\":\\"7045\\"") or ("\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4697\\""))<br />\| json "EventID", "Computer", "Message", "EventData.AccountName", "EventData.ServiceName", "EventData.ServiceType", "EventData.StartType", "EventData.ImagePath", "Provider.EventSourceName"  as event\_id, host, msg\_summary, account\_name, service\_name, service\_type, service\_start\_type, service\_image\_path, event\_source\_name nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4697", "7045") and host matches "{{host}}"<br />\| count by service\_name <br />\| top 10 service\_name by \_count|
|Windows 2012+ (JSON)/User Activity|Unauthorized Account Creations|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/Unauthorized Account Creations|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4720\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| where event\_id = "4720" and channel = "Security"<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where src\_user not in ("Admin1", "Admin2") // Provide custom input in the list. Only users mentioned in the list will be able to create new users and no one else will be allowed new user creation.<br />\| fields host, event\_id, msg\_summary, src\_user, dest\_user, src\_domain, dest\_domain|
|Windows 2012+ (JSON)/User Activity|Unauthorized Account Creations|Logs|Windows 2012+ (JSON)/User Activity/Unauthorized Account Creations|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4720\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| where event\_id = "4720" and channel = "Security"<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where src\_user not in ("Admin1", "Admin2") // Provide custom input in the list. Only users mentioned in the list will be able to create new users and no one else will be allowed new user creation.<br />\| fields host, event\_id, msg\_summary, src\_user, dest\_user, src\_domain, dest\_domain|
|Windows 2012+ (JSON)/Updates|Update Results by KB number|Logs|Windows 2012+ (JSON)/Updates/Update Results by KB number|\_sourceCategory={{Logsdatasource}}   ("\\"EventID\\":\\"19\\"" or "\\"EventID\\":\\"20\\"")  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| if (isEmpty(error\_code), "Success", "Failure") as result\_status<br />\| where !isEmpty(kbnum) and event\_id in ("19", "20")<br />\| count by kbnum, result\_status|
|Windows 2012+ (JSON)/Updates|Update Results by KB number|Logs|Installed Apps/Windows 2012+ (JSON)/Updates/Update Results by KB number|\_sourceCategory={{Logsdatasource}}   ("\\"EventID\\":\\"19\\"" or "\\"EventID\\":\\"20\\"")  \_sourceName=System<br />\| json "EventID", "Computer", "Message", "Execution.ThreadID", "Execution.ProcessID", "Channel", "EventData.updateTitle", "EventData.updateRevisionNumber", "EventData.errorCode" as event\_id, host, msg\_summary, thread\_id, process\_id, channel, update\_title, update\_revision\_number, error\_code nodrop<br />\| parse regex field=update\_title "(?\<kbnum\>(?:kb\|KB)\\d+)\\D" nodrop<br />\| if (isEmpty(error\_code), "Success", "Failure") as result\_status<br />\| where !isEmpty(kbnum) and event\_id in ("19", "20")<br />\| count by kbnum, result\_status|
|Windows 2012+ (JSON)/User Activity|User Account Changed|Logs|Windows 2012+ (JSON)/User Activity/User Account Changed|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventId\\":\\"4738\\"" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel"  as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "Changed Attributes:\\s+(?\<changed\_attributes\>[\\s\\S]\*?)Additional Information:"<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4738" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, changed\_attributes|
|Windows 2012+ (JSON)/User Activity|User Account Changed|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/User Account Changed|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventId\\":\\"4738\\"" \_sourceName=Security <br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel"  as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "Changed Attributes:\\s+(?\<changed\_attributes\>[\\s\\S]\*?)Additional Information:"<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4738" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, changed\_attributes|
|Windows 2012+ (JSON)/User Activity|User Account Deleted|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/User Account Deleted|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4726\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4726" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain|
|Windows 2012+ (JSON)/User Activity|User Account Deleted|Logs|Windows 2012+ (JSON)/User Activity/User Account Deleted|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4726\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4726" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain|
|Windows 2012+ (JSON)/User Activity|User Added to Administrative Groups|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/User Added to Administrative Groups|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4728 or 4732 or 4746 or 4751 or 4756 or 4761) \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.GroupName", "EventData.GroupDomain", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, group\_name, group\_domain, channel nodrop<br />\| parse regex field=msg\_summary "Subject:[\\s\\S]+?Account Name:\\s+(?\<src\_user\>[^\\r]+?)\\r[\\s\\S]+?Member:[\\s\\S]+?Security ID:\\s+(?\<member\_user\_name\>[^\\r\\"]+?)\\r[\\s\\S]+?Account Name:\\s+(?\<dest\_user\>[^\\r\\"]+?)\\r[\\s\\S]+?Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop <br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4728", "4732", "4746", "4751", "4756", "4761") and channel = "Security"<br />\| where group\_name in ("Administrators", "Domain Admins", "Schema Admins", "Server Operators", "Account Operators", "Backup Operators")<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, group\_name, group\_domain, member\_user\_name|
|Windows 2012+ (JSON)/User Activity|User Added to Administrative Groups|Logs|Windows 2012+ (JSON)/User Activity/User Added to Administrative Groups|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4728 or 4732 or 4746 or 4751 or 4756 or 4761) \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.GroupName", "EventData.GroupDomain", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, group\_name, group\_domain, channel nodrop<br />\| parse regex field=msg\_summary "Subject:[\\s\\S]+?Account Name:\\s+(?\<src\_user\>[^\\r]+?)\\r[\\s\\S]+?Member:[\\s\\S]+?Security ID:\\s+(?\<member\_user\_name\>[^\\r\\"]+?)\\r[\\s\\S]+?Account Name:\\s+(?\<dest\_user\>[^\\r\\"]+?)\\r[\\s\\S]+?Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop <br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4728", "4732", "4746", "4751", "4756", "4761") and channel = "Security"<br />\| where group\_name in ("Administrators", "Domain Admins", "Schema Admins", "Server Operators", "Account Operators", "Backup Operators")<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, group\_name, group\_domain, member\_user\_name|
|Windows 2012+ (JSON)/User Activity|User Added to Group|Logs|Windows 2012+ (JSON)/User Activity/User Added to Group|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4728 or 4732 or 4746 or 4751 or 4756 or 4761) \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.GroupName", "EventData.GroupDomain", "Channel", "EventData.MemberName" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, group\_name, group\_domain, channel, MemberName nodrop<br />\| parse regex field=msg\_summary "Subject:[\\s\\S]+?Account Name:[\\s\\S]+?Member:[\\s\\S]+?Security ID:\\s+(?\<member\_user\_name\>[^\\r\\"]+?)\\r[\\s\\S]+?Account Name:[\\s\\S]+?Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop <br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4728", "4732", "4746", "4751", "4756", "4761") and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, group\_name, group\_domain, member\_user\_name|
|Windows 2012+ (JSON)/User Activity|User Added to Group|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/User Added to Group|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" (4728 or 4732 or 4746 or 4751 or 4756 or 4761) \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "EventData.GroupName", "EventData.GroupDomain", "Channel", "EventData.MemberName" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, group\_name, group\_domain, channel, MemberName nodrop<br />\| parse regex field=msg\_summary "Subject:[\\s\\S]+?Account Name:[\\s\\S]+?Member:[\\s\\S]+?Security ID:\\s+(?\<member\_user\_name\>[^\\r\\"]+?)\\r[\\s\\S]+?Account Name:[\\s\\S]+?Group:[\\s\\S]+?(?:Account\|Group) Name:\\s+(?\<group\_name\>[^\\r\\"]+?)\\r\\s+?(?:Account\|Group) Domain:\\s+(?\<group\_domain\>[^\\r\\"]+?)(?:\\r\|\\")" nodrop <br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id in ("4728", "4732", "4746", "4751", "4756", "4761") and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, group\_name, group\_domain, member\_user\_name|
|Windows 2012+ (JSON)/User Activity|User Locked-out|Logs|Windows 2012+ (JSON)/User Activity/User Locked-out|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4740\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel", "keywords" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel, keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4740" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain|
|Windows 2012+ (JSON)/User Activity|User Locked-out|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/User Locked-out|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4740\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel", "keywords" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel, keywords nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4740" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain|
|Windows 2012+ (JSON)/User Activity|User Password Changes|Logs|Windows 2012+ (JSON)/User Activity/User Password Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4723\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4723" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, dest\_user, src\_domain, dest\_domain, channel<br />\| timeslice 1d<br />\| count by \_timeslice<br />\| sort by \_timeslice|
|Windows 2012+ (JSON)/User Activity|User Password Changes|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/User Password Changes|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4723\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4723" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, dest\_user, src\_domain, dest\_domain, channel<br />\| timeslice 1d<br />\| count by \_timeslice<br />\| sort by \_timeslice|
|Windows 2012+ (JSON)/User Activity|User Password Reset Attempts|Logs|Windows 2012+ (JSON)/User Activity/User Password Reset Attempts|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4724\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4724" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain|
|Windows 2012+ (JSON)/User Activity|User Password Reset Attempts|Logs|Installed Apps/Windows 2012+ (JSON)/User Activity/User Password Reset Attempts|\_sourceCategory={{Logsdatasource}}   "\\"Channel\\":\\"Security\\"" "\\"EventID\\":\\"4724\\"" \_sourceName=Security<br />\| json "EventID", "Computer", "Message", "EventData.SubjectUserName", "EventData.SubjectDomainName", "EventData.TargetUserName", "EventData.TargetDomainName", "Channel" as event\_id, host, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain, channel nodrop<br />\| parse regex field=msg\_summary "(?\<msg\_summary\>.\*\\.\*)" nodrop<br />\| where event\_id = "4724" and channel = "Security"<br />\| fields host, event\_id, msg\_summary, src\_user, src\_domain, dest\_user, dest\_domain|

