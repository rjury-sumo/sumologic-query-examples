# Druva
## Sumo Logic App For: Druva
The Druva App for Sumo Logic empowers you to monitor and fortify your Druva account by delivering real-time insights into critical events and alerts. With the Druva App, you can gain visibility into user activities, device and app usage, alerts, and backup and restore events, enabling security teams to promptly detect potential security incidents. The App utilizes Sumo Logicâ€™s cloud-to-cloud Druva source  to gather and analyze data from your Druva account and provides granular information about user activity, alerts, and backup status. With this information, organizations can swiftly detect and respond to potential security incidents.
Docs Link: [Druva](https://help.sumologic.com/?cid=1119)

## Searches

### Log Searches

- **Alerts by Severity Over Time**: from Dashboard: Installed Apps/Druva/Druva - Alerts Overview 
- **Alerts from High Risk Countries**: from Dashboard: Installed Apps/Druva/Druva - Alerts Overview 
- **Backup Events by State**: from Dashboard: Installed Apps/Druva/Druva - Backup And Restore Overview 
- **Cloud App Devices**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Devices and Apps Added Over Time**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Devices by OS**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Download Events by State**: from Dashboard: Installed Apps/Druva/Druva - Backup And Restore Overview 
- **Events by Type**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Failed Events by Type Over Time**: from Dashboard: Installed Apps/Druva/Druva - Backup And Restore Overview 
- **Failed Events Over Time**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Geo-Location of Backup/Restore Events**: from Dashboard: Installed Apps/Druva/Druva - Backup And Restore Overview 
- **Number of Backup and Restore Events**: from Dashboard: Installed Apps/Druva/Druva - Backup And Restore Overview 
- **Number of Users**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Recent Alerts**: from Dashboard: Installed Apps/Druva/Druva - Alerts Overview 
- **Recent Event Details**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Restore Events by State**: from Dashboard: Installed Apps/Druva/Druva - Backup And Restore Overview 
- **Top 10 Administrators by Event Count**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Top 10 Users by Backup/Restore Activity**: from Dashboard: Installed Apps/Druva/Druva - Backup And Restore Overview 
- **Top 10 Users by Cloud App Device Count**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Top 10 Users by Device Count**: from Dashboard: Installed Apps/Druva/Druva - Overview 
- **Top 10 Users Generating Alerts**: from Dashboard: Installed Apps/Druva/Druva - Alerts Overview 
- **Unusual Data Activity**: from Dashboard: Installed Apps/Druva/Druva - Alerts Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Druva|Alerts by Severity Over Time|Logs|Installed Apps/Druva/Druva - Alerts Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type matches "Alert\*"<br />\| timeslice 1d<br />\| count by \_timeslice, event\_state<br />\| fillmissing timeslice, values all in event\_state<br />\| transpose row \_timeslice column event\_state|
|Druva|Alerts from High Risk Countries|Logs|Installed Apps/Druva/Druva - Alerts Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| where event\_type matches "Alert\*"<br />\| count as frequency by ip<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isEmpty(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| lookup latitude, longitude, country\_code from geo://location on ip = ip <br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code <br />\| where !isBlank(country\_code)|
|Druva|Backup Events by State|Logs|Installed Apps/Druva/Druva - Backup And Restore Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type matches "Backup"<br />\| count\_distinct(event\_id) by event\_state<br />\| sort by \_count\_distinct|
|Druva|Cloud App Devices|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where !(isNull(client\_os)) AND (client\_os IN ("G Suite Gmail","G Suite Google Drive","G Suite Team Drive","Office 365 SharePoint","Office 365 Exchange Online","Office 365 OneDrive","Box Box"))<br />\| count\_distinct(device\_id) by client\_os<br />\| sort by \_count\_distinct|
|Druva|Devices and Apps Added Over Time|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where !(isNull(client\_os))<br />\| last(\_messageTime) as \_messageTime by device\_id,client\_os<br />\| timeslice 1d<br />\| count by \_timeslice, client\_os<br />\| fillmissing timeslice, values all in client\_os<br />\| transpose row \_timeslice column client\_os|
|Druva|Devices by OS|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where !(isNull(client\_os)) AND !(client\_os IN ("G Suite Gmail","G Suite Google Drive","G Suite Team Drive","Office 365 SharePoint","Office 365 Exchange Online","Office 365 OneDrive","Box Box"))<br />\| count\_distinct(device\_id) by client\_os<br />\| sort by \_count\_distinct|
|Druva|Download Events by State|Logs|Installed Apps/Druva/Druva - Backup And Restore Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type matches "Download"<br />\| count\_distinct(event\_id) by event\_state<br />\| sort by \_count\_distinct|
|Druva|Events by Type|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where !(isNull(event\_type)) <br />\| count\_distinct(event\_id) as frequency by event\_type<br />\| sort by frequency|
|Druva|Failed Events by Type Over Time|Logs|Installed Apps/Druva/Druva - Backup And Restore Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type IN ("Backup", "Restore","Download")<br />\| where event\_state IN ("Failed")<br />\| timeslice 1d<br />\| count by \_timeslice,event\_type<br />\| fillmissing timeslice, values all in event\_type<br />\| transpose row \_timeslice column event\_type|
|Druva|Failed Events Over Time|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where !(event\_type IN ("Backup", "Restore","Download"))<br />\| where event\_state IN ("Failed")<br />\| timeslice 1d<br />\| count by \_timeslice,event\_type<br />\| fillmissing timeslice, values all in event\_type<br />\| transpose row \_timeslice column event\_type |
|Druva|Geo-Location of Backup/Restore Events|Logs|Installed Apps/Druva/Druva - Backup And Restore Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| where event\_type in ("Backup","Restore","Download")<br />\| count as frequency by ip<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isEmpty(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip<br />|
|Druva|Number of Backup and Restore Events|Logs|Installed Apps/Druva/Druva - Backup And Restore Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type in ("Backup","Restore","Download")<br />\| count\_distinct(event\_id)|
|Druva|Number of Users|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| count\_distinct(user\_id)|
|Druva|Recent Alerts|Logs|Installed Apps/Druva/Druva - Alerts Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type matches "Alert\*"<br />\| count\_distinct(event\_id) by \_messageTime,event\_id,event\_type,event\_state,event\_details,user\_id,user\_name,user\_email,client\_os<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time<br />\| fields event\_details,event\_type,event\_state,event\_id,user\_id,user\_name,user\_email,client\_os,time<br />\| fields -\_messageTime<br />\| sort by time<br />\| limit 100|
|Druva|Recent Event Details|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| count\_distinct(event\_id) by \_messageTime,event\_id,event\_type,event\_state,event\_details,user\_id,user\_name,user\_email,client\_os,severity<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time<br />\| fields event\_type,event\_state,event\_details,event\_id,user\_id,user\_name,user\_email,client\_os,severity,time<br />\| fields -\_messageTime<br />\| sort by time<br />\| limit 100|
|Druva|Restore Events by State|Logs|Installed Apps/Druva/Druva - Backup And Restore Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type matches "Restore"<br />\| count\_distinct(event\_id) by event\_state<br />\| sort by \_count\_distinct|
|Druva|Top 10 Administrators by Event Count|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type matches "Admin\*" or event\_type matches "Client Upgrade"<br />\| where !(isNull(initiator))<br />\| count\_distinct(event\_id) as event\_count by initiator<br />\| sort by event\_count<br />\| limit 10|
|Druva|Top 10 Users by Backup/Restore Activity|Logs|Installed Apps/Druva/Druva - Backup And Restore Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type in ("Backup","Restore","Download")<br />\| where !(isNull(user\_id)) and !(isNull(user\_email))<br />\| count\_distinct(event\_id) as event\_count by user\_email,user\_name,user\_id<br />\| sort by event\_count<br />\| limit 10|
|Druva|Top 10 Users by Cloud App Device Count|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where !(isNull(client\_os)) AND (client\_os IN ("G Suite Gmail","G Suite Google Drive","G Suite Team Drive","Office 365 SharePoint","Office 365 Exchange Online","Office 365 OneDrive","Box Box"))<br />\| where !(isNull(user\_id)) and !(isNull(user\_email)) and !isNull(user\_name)<br />\| count\_distinct(device\_id) as device\_count by user\_email,user\_name,user\_id<br />\| sort by device\_count<br />\| limit 10|
|Druva|Top 10 Users by Device Count|Logs|Installed Apps/Druva/Druva - Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_type matches "{{event\_type}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where !(isNull(client\_os)) AND !(client\_os IN ("G Suite Gmail","G Suite Google Drive","G Suite Team Drive","Office 365 SharePoint","Office 365 Exchange Online","Office 365 OneDrive","Box Box"))<br />\| where !(isNull(user\_id)) and !(isNull(user\_email)) and !(isNull(user\_name))<br />\| count\_distinct(device\_id) as device\_count by user\_email,user\_name,user\_id<br />\| sort by device\_count<br />\| limit 10|
|Druva|Top 10 Users Generating Alerts|Logs|Installed Apps/Druva/Druva - Alerts Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_type matches "Alert\*"<br />\| where !(isNull(user\_id)) and !(isNull(user\_email))<br />\| count\_distinct(event\_id) as alert\_count by user\_email,user\_name,user\_id<br />\| sort by alert\_count<br />\| limit 10|
|Druva|Unusual Data Activity|Logs|Installed Apps/Druva/Druva - Alerts Overview|\_sourceCategory={{Logsdatasource}}  <br />\|json"eventID","eventType","eventState","eventDetails","initiator","inSyncUserID","inSyncUserName","inSyncUserEmail","inSyncDataSourceID","clientOS","ip","timestamp","severity" as event\_id,event\_type,event\_state,event\_details,initiator,user\_id,user\_name,user\_email,device\_id,client\_os,ip,time\_stamp,severity nodrop<br />\| where severity matches "{{severity}}"<br />\| where client\_os matches "{{client\_os}}"<br />\| where event\_state matches "{{event\_state}}"<br />\| if(isNull(user\_id),"-",user\_id) as user\_id<br />\| if(isNull(user\_email),"-",user\_email) as user\_email<br />\| if(isNull(client\_os),"-",client\_os) as client\_os<br />\| if(isNull(user\_name),"-",user\_name) as user\_name<br />\| if(isNull(device\_id),"-",device\_id) as device\_id<br />\| if(isNull(initiator),"-",initiator) as initiator<br />\| if(isEmpty(ip),"-",ip) as ip<br />\| where event\_details matches "\*Alert:Unusual Data Activity\*"<br />\| extract field=event\_details "Anomaly\\sdetected:(?\<activity\_details\>[\\S\\s]+?),\\sAffected"<br />\| timeslice 1d<br />\| count\_distinct(event\_id) by \_timeslice,activity\_details<br />\| fillmissing timeslice, values all in activity\_details<br />\| transpose row \_timeslice column activity\_details|

