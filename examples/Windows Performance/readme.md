# Windows Performance
## Sumo Logic App For: Windows Performance
The Sumo Logic application for Windows Performance provides insight into your system's operation and events so that you can better manage and maintain your Windows systems. The app uses predefined Dashboards and Searches that provide visibility into your environment for real time analysis of overall usage: CPU Performance, Disk Performance, Memory Performance, Network Performance, and Generic IO Performance.
Docs Link: [Windows Performance](https://help.sumologic.com/?cid=1059)

## Searches

### Log Searches

- **Alert - Hosts with High CPU during Last 15 mins**: from Search: Windows Performance/Alert - Hosts with High CPU during Last 15 mins 
- **Alert - Hosts with High CPU during Last 15 mins**: from Search: Installed Apps/Windows Performance/Alert - Hosts with High CPU during Last 15 mins 
- **Alert - Hosts with Low Available Memory in Last 15 Minutes**: from Search: Windows Performance/Alert - Hosts with Low Available Memory in Last 15 Minutes 
- **Alert - Hosts with Low Available Memory in Last 15 Minutes**: from Search: Installed Apps/Windows Performance/Alert - Hosts with Low Available Memory in Last 15 Minutes 
- **Available Memory (MB) by Host**: from Dashboard: Installed Apps/Windows Performance/Memory Performance 
- **Avg Bytes Read and Written per Host**: from Dashboard: Installed Apps/Windows Performance/Disk Performance 
- **Avg Bytes Received per Second per Host**: from Dashboard: Installed Apps/Windows Performance/Network Performance 
- **Avg Bytes Sent per Second per Host**: from Dashboard: Installed Apps/Windows Performance/Network Performance 
- **Avg CPU Usage (%) by Host**: from Dashboard: Installed Apps/Windows Performance/Windows Performance Overview 
- **Avg CPU Usage (%) by Host**: from Dashboard: Installed Apps/Windows Performance/CPU Performance 
- **Avg Current Bandwidth by Interface per Host**: from Dashboard: Installed Apps/Windows Performance/Network Performance 
- **Avg Disk Queue Length per Physical Disk per Host**: from Dashboard: Installed Apps/Windows Performance/Disk Performance 
- **Avg Disk Time (%) by Host**: from Dashboard: Installed Apps/Windows Performance/Windows Performance Overview 
- **Avg Disk Time (%) by Host**: from Dashboard: Installed Apps/Windows Performance/Disk Performance 
- **Avg Inbound Packets per Second**: from Dashboard: Installed Apps/Windows Performance/Network Performance 
- **Avg IO Reads (per Second) per Host**: from Search: Windows Performance/Avg IO Reads (per Second) per Host 
- **Avg IO Reads (per Second) per Host**: from Search: Installed Apps/Windows Performance/Avg IO Reads (per Second) per Host 
- **Avg IO Reads (per Second) per Process and Host**: from Search: Windows Performance/Avg IO Reads (per Second) per Process and Host 
- **Avg IO Reads (per Second) per Process and Host**: from Search: Installed Apps/Windows Performance/Avg IO Reads (per Second) per Process and Host 
- **Avg IO Writes (per Second) per Host**: from Search: Windows Performance/Avg IO Writes (per Second) per Host 
- **Avg IO Writes (per Second) per Host**: from Search: Installed Apps/Windows Performance/Avg IO Writes (per Second) per Host 
- **Avg IO Writes (per Second) per Process and Host**: from Search: Installed Apps/Windows Performance/Avg IO Writes (per Second) per Process and Host 
- **Avg IO Writes (per Second) per Process and Host**: from Search: Windows Performance/Avg IO Writes (per Second) per Process and Host 
- **Avg MBytes Read by Host**: from Search: Installed Apps/Windows Performance/Avg MBytes Read by Host 
- **Avg MBytes Read by Host**: from Search: Windows Performance/Avg MBytes Read by Host 
- **Avg MBytes Written by Host**: from Search: Installed Apps/Windows Performance/Avg MBytes Written by Host 
- **Avg MBytes Written by Host**: from Search: Windows Performance/Avg MBytes Written by Host 
- **Avg Other IO Operations (per Second) per Process and Host**: from Search: Installed Apps/Windows Performance/Avg Other IO Operations (per Second) per Process and Host 
- **Avg Other IO Operations (per Second) per Process and Host**: from Search: Windows Performance/Avg Other IO Operations (per Second) per Process and Host 
- **Avg Other IO Operations per Host**: from Search: Windows Performance/Avg Other IO Operations per Host 
- **Avg Other IO Operations per Host**: from Search: Installed Apps/Windows Performance/Avg Other IO Operations per Host 
- **Avg Outbound Packets per Second**: from Dashboard: Installed Apps/Windows Performance/Network Performance 
- **Avg Output Queue Length**: from Dashboard: Installed Apps/Windows Performance/Network Performance 
- **Avg PageFaults per Second by Host**: from Dashboard: Installed Apps/Windows Performance/Memory Performance 
- **Avg Privileged and User CPU Time (%) per Host**: from Dashboard: Installed Apps/Windows Performance/CPU Performance 
- **Avg Read and Write Counts per Host**: from Dashboard: Installed Apps/Windows Performance/Disk Performance 
- **Avg Total Bytes (per Second) by Physical Disk per Host**: from Dashboard: Installed Apps/Windows Performance/Disk Performance 
- **Avg Total RW Operations (per Second) by Physical Disk per Host**: from Dashboard: Installed Apps/Windows Performance/Disk Performance 
- **Avg Virtual Memory (MB) per Large Process by Host**: from Dashboard: Installed Apps/Windows Performance/Memory Performance 
- **Top 10 Processes by Avg Privileged Time (%) per Host**: from Dashboard: Installed Apps/Windows Performance/CPU Performance 
- **Top 10 Processes by Avg Processor Time (%) per Host**: from Dashboard: Installed Apps/Windows Performance/CPU Performance 
- **Top 10 Processes by Avg Processor Time (%) per Host**: from Dashboard: Installed Apps/Windows Performance/Windows Performance Overview 
- **Top 10 Processes by Avg User Time (%) per Host**: from Dashboard: Installed Apps/Windows Performance/CPU Performance 
- **Top 10 Processes with Largest Resident Memory**: from Dashboard: Installed Apps/Windows Performance/Memory Performance 
- **Top 10 Virtual Memory Consumers per Host**: from Dashboard: Installed Apps/Windows Performance/Memory Performance 
- **Top 10 Virtual Memory Consumers per Host**: from Dashboard: Installed Apps/Windows Performance/Windows Performance Overview 
- **Total Bandwidth (Bytes) by Host**: from Dashboard: Installed Apps/Windows Performance/Windows Performance Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Windows Performance|Alert - Hosts with High CPU during Last 15 mins|Logs|Windows Performance/Alert - Hosts with High CPU during Last 15 mins|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfOS\_Processor" "\_Total"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentProcessorTime" as procTime<br />\| timeslice 1m <br />\| avg(procTime) as AvgProcTime by host,\_timeslice <br />// High CPU Threshold: 80%<br />\| where AvgProcTime\>= 80<br />\| count as DataPoints by host <br />// Second threshold: The cpu is high for at least 10 minutes within the last 15mins<br />\| where DataPoints \>= 10|
|Windows Performance|Alert - Hosts with High CPU during Last 15 mins|Logs|Installed Apps/Windows Performance/Alert - Hosts with High CPU during Last 15 mins|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfOS\_Processor" "\_Total"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentProcessorTime" as procTime<br />\| timeslice 1m <br />\| avg(procTime) as AvgProcTime by host,\_timeslice <br />// High CPU Threshold: 80%<br />\| where AvgProcTime\>= 80<br />\| count as DataPoints by host <br />// Second threshold: The cpu is high for at least 10 minutes within the last 15mins<br />\| where DataPoints \>= 10|
|Windows Performance|Alert - Hosts with Low Available Memory in Last 15 Minutes|Logs|Windows Performance/Alert - Hosts with Low Available Memory in Last 15 Minutes|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfOS\_Memory" "AvailableBytes"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "AvailableBytes" as aBytes<br />\| timeslice 1m<br />\| avg(aBytes) as AvgAvailableBytes by host,\_timeslice <br />\| int(AvgAvailableBytes/(1024\*1024)) as AvgAvailMBytes <br />// 100MB is the threshold for this alert<br />\| where AvgAvailMBytes \< 100 <br />\| count as DataPoints by host <br />// another threshold: more than 10 minutes where the limit drops under the above threshold<br />\| where DataPoints \>10|
|Windows Performance|Alert - Hosts with Low Available Memory in Last 15 Minutes|Logs|Installed Apps/Windows Performance/Alert - Hosts with Low Available Memory in Last 15 Minutes|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfOS\_Memory" "AvailableBytes"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "AvailableBytes" as aBytes<br />\| timeslice 1m<br />\| avg(aBytes) as AvgAvailableBytes by host,\_timeslice <br />\| int(AvgAvailableBytes/(1024\*1024)) as AvgAvailMBytes <br />// 100MB is the threshold for this alert<br />\| where AvgAvailMBytes \< 100 <br />\| count as DataPoints by host <br />// another threshold: more than 10 minutes where the limit drops under the above threshold<br />\| where DataPoints \>10|
|Windows Performance|Available Memory (MB) by Host|Logs|Installed Apps/Windows Performance/Memory Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfOS\_Memory" "AvailableBytes"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "AvailableBytes" as aBytes<br />\| timeslice 1m<br />\| avg(aBytes) as AvgAvailableBytes by host,\_timeslice <br />\| int(AvgAvailableBytes/(1024\*1024)) as AvgAvailMBytes \| fields - AvgAvailableBytes \| sort - \_timeslice \| transpose row \_timeslice column host |
|Windows Performance|Avg Bytes Read and Written per Host|Logs|Installed Apps/Windows Performance/Disk Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfDisk\_PhysicalDisk" "\_Total"  <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "DiskWriteBytesPersec","DiskReadBytesPersec" as diskWriteBytes,diskReadBytes <br />\| avg(diskWriteBytes) as AvgDiskWriteBytes,avg(diskReadBytes) as AvgDiskReadBytes by host<br />\| int(AvgDiskWriteBytes) as AvgDiskWriteBytes \| int(AvgDiskReadBytes) as AvgDiskReadBytes |
|Windows Performance|Avg Bytes Received per Second per Host|Logs|Installed Apps/Windows Performance/Network Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_Tcpip\_NetworkInterface" "BytesReceivedPersec"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "BytesReceivedPersec","Name" as bytesReceivedPersec,interface <br />\| timeslice 1m <br />\| avg(bytesReceivedPersec) as AvgBytesRcvPersec by host, interface, \_timeslice \| sum(AvgBytesRcvPersec) as AvgBytesRcvPersec by host,\_timeslice<br />\| sort - \_timeslice<br />// this is a comment<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg Bytes Sent per Second per Host|Logs|Installed Apps/Windows Performance/Network Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_Tcpip\_NetworkInterface" "BytesSentPersec"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "BytesSentPersec","Name" as bytesSentPersec,interface <br />\| timeslice 1m <br />\| avg(bytesSentPersec) as AvgBytesSndPersec by host,interface, \_timeslice\| sum(AvgBytesSndPersec) as AvgBytesSndPersec by host, \_timeslice \| sort - \_timeslice<br />// this is a comment<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg CPU Usage (%) by Host|Logs|Installed Apps/Windows Performance/Windows Performance Overview|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfOS\_Processor" "\_Total"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentProcessorTime" as procTime<br />\| timeslice 1m<br />\| avg(procTime) as AvgProcTime by host,\_timeslice \| sort - \_timeslice \| transpose row \_timeslice column host |
|Windows Performance|Avg CPU Usage (%) by Host|Logs|Installed Apps/Windows Performance/CPU Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfOS\_Processor" "\_Total"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentProcessorTime" as procTime<br />\| timeslice 1m<br />\| avg(procTime) as AvgProcTime by host,\_timeslice \| sort - \_timeslice \| transpose row \_timeslice column host |
|Windows Performance|Avg Current Bandwidth by Interface per Host|Logs|Installed Apps/Windows Performance/Network Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_Tcpip\_NetworkInterface" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "CurrentBandwidth","Name" as currentBW,interface<br />\| avg(currentBW) as AvgCurrentBandwidth by host, interface \| transpose row host column interface<br />|
|Windows Performance|Avg Disk Queue Length per Physical Disk per Host|Logs|Installed Apps/Windows Performance/Disk Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfDisk\_PhysicalDisk" "\_Total"  <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "CurrentDiskQueueLength" as diskQueueLength<br />\| timeslice 1m <br />\| avg(diskQueueLength) as AvgDiskQueueLength by host,\_timeslice<br />\| int(AvgDiskQueueLength) as AvgDiskQueueLength <br />\| transpose row \_timeslice column host |
|Windows Performance|Avg Disk Time (%) by Host|Logs|Installed Apps/Windows Performance/Windows Performance Overview|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfDisk\_PhysicalDisk" "\_Total"  <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentIdleTime","PercentDiskReadTime","PercentDiskWriteTime","Name" as pctDiskIdleTime,pctDiskReadTime,pctDiskWriteTime,procName \| where procName = "\_Total" <br />\| avg(pctDiskIdleTime) as AvgPctDiskIdleTime, avg(pctDiskReadTime) as AvgPctDiskReadTime, avg(pctDiskWriteTime) as AvgPctDiskWriteTime by host<br />\| int(AvgPctDiskIdleTime) as IdleTime \|  int(AvgPctDiskReadTime) as ReadTime \| int(AvgPctDiskWriteTime) as WriteTime \| fields - AvgPctDiskIdleTime,AvgPctDiskReadTime,AvgPctDiskWriteTime|
|Windows Performance|Avg Disk Time (%) by Host|Logs|Installed Apps/Windows Performance/Disk Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfDisk\_PhysicalDisk" "\_Total"  <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentIdleTime","PercentDiskReadTime","PercentDiskWriteTime","Name" as pctDiskIdleTime,pctDiskReadTime,pctDiskWriteTime,procName \| where procName = "\_Total" <br />\| avg(pctDiskIdleTime) as AvgPctDiskIdleTime, avg(pctDiskReadTime) as AvgPctDiskReadTime, avg(pctDiskWriteTime) as AvgPctDiskWriteTime by host<br />\| int(AvgPctDiskIdleTime) as IdleTime \|  int(AvgPctDiskReadTime) as ReadTime \| int(AvgPctDiskWriteTime) as WriteTime \| fields - AvgPctDiskIdleTime,AvgPctDiskReadTime,AvgPctDiskWriteTime|
|Windows Performance|Avg Inbound Packets per Second|Logs|Installed Apps/Windows Performance/Network Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_Tcpip\_NetworkInterface" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "Name", "PacketsReceivedDiscarded","PacketsReceivedErrors","PacketsReceivedPersec" as interface, pktRcvDiscarded,pktRcvError,pktRcv<br />\| timeslice 1m<br />\| avg(pktRcvDiscarded) as AvgPacketReceiveDiscarded, avg(pktRcvError) as AvgReceiveError, avg(pktRcv) as AvgReceived by host,interface,\_timeslice<br />\| sum(AvgPacketReceiveDiscarded) as PktRcvDiscarded, sum(AvgReceiveError) as PktRcvError, sum(AvgReceived) as PktReceived by host,\_timeslice <br />\| sort - \_timeslice<br />\| transpose row \_timeslice column host<br />|
|Windows Performance|Avg IO Reads (per Second) per Host|Logs|Windows Performance/Avg IO Reads (per Second) per Host|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOReadOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOReadOperationsPersec","Name" as ioReads,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioReads) as AvgIOReads by host, \_timeslice \| sort - \_timeslice<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg IO Reads (per Second) per Host|Logs|Installed Apps/Windows Performance/Avg IO Reads (per Second) per Host|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOReadOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOReadOperationsPersec","Name" as ioReads,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioReads) as AvgIOReads by host, \_timeslice \| sort - \_timeslice<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg IO Reads (per Second) per Process and Host|Logs|Windows Performance/Avg IO Reads (per Second) per Process and Host|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "IOReadOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOReadOperationsPersec","Name" as ioReads,procName \| where procName != "\_Total"<br />\| avg(ioReads) as AvgIOReads by host, procName<br />\| transpose row host column procName|
|Windows Performance|Avg IO Reads (per Second) per Process and Host|Logs|Installed Apps/Windows Performance/Avg IO Reads (per Second) per Process and Host|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "IOReadOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOReadOperationsPersec","Name" as ioReads,procName \| where procName != "\_Total"<br />\| avg(ioReads) as AvgIOReads by host, procName<br />\| transpose row host column procName|
|Windows Performance|Avg IO Writes (per Second) per Host|Logs|Windows Performance/Avg IO Writes (per Second) per Host|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOWriteOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOWriteOperationsPersec","Name" as ioWrites,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioWrites) as AvgIOWrites by host, \_timeslice \| sort - \_timeslice<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg IO Writes (per Second) per Host|Logs|Installed Apps/Windows Performance/Avg IO Writes (per Second) per Host|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOWriteOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOWriteOperationsPersec","Name" as ioWrites,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioWrites) as AvgIOWrites by host, \_timeslice \| sort - \_timeslice<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg IO Writes (per Second) per Process and Host|Logs|Installed Apps/Windows Performance/Avg IO Writes (per Second) per Process and Host|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "IOWriteOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOWriteOperationsPersec","Name" as ioWrites,procName \| where procName != "\_Total"<br />\| avg(ioWrites) as AvgIOWrites by host, procName<br />\| transpose row host column procName|
|Windows Performance|Avg IO Writes (per Second) per Process and Host|Logs|Windows Performance/Avg IO Writes (per Second) per Process and Host|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "IOWriteOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOWriteOperationsPersec","Name" as ioWrites,procName \| where procName != "\_Total"<br />\| avg(ioWrites) as AvgIOWrites by host, procName<br />\| transpose row host column procName|
|Windows Performance|Avg MBytes Read by Host|Logs|Installed Apps/Windows Performance/Avg MBytes Read by Host|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOReadBytesPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOReadBytesPersec","Name" as ioReadBytes,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioReadBytes) as AvgIOReadBytes by host, \_timeslice \| sort - \_timeslice \| int(AvgIOReadBytes/(1025\*1024)) as AvgIOReadMBytes \| fields - AvgIOReadBytes<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg MBytes Read by Host|Logs|Windows Performance/Avg MBytes Read by Host|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOReadBytesPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOReadBytesPersec","Name" as ioReadBytes,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioReadBytes) as AvgIOReadBytes by host, \_timeslice \| sort - \_timeslice \| int(AvgIOReadBytes/(1025\*1024)) as AvgIOReadMBytes \| fields - AvgIOReadBytes<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg MBytes Written by Host|Logs|Installed Apps/Windows Performance/Avg MBytes Written by Host|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOWriteBytesPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOWriteBytesPersec","Name" as ioWriteBytes,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioWriteBytes) as AvgIOWriteBytes by host, \_timeslice \| sort - \_timeslice \| int(AvgIOWriteBytes/(1025\*1024)) as AvgIOWriteMBytes \| fields - AvgIOWriteBytes<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg MBytes Written by Host|Logs|Windows Performance/Avg MBytes Written by Host|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOWriteBytesPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOWriteBytesPersec","Name" as ioWriteBytes,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioWriteBytes) as AvgIOWriteBytes by host, \_timeslice \| sort - \_timeslice \| int(AvgIOWriteBytes/(1025\*1024)) as AvgIOWriteMBytes \| fields - AvgIOWriteBytes<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg Other IO Operations (per Second) per Process and Host|Logs|Installed Apps/Windows Performance/Avg Other IO Operations (per Second) per Process and Host|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "IOOtherOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOOtherOperationsPersec","Name" as ioOthers,procName \| where procName != "\_Total"<br />\| avg(ioOthers) as AvgIOOther by host, procName<br />\| transpose row host column procName|
|Windows Performance|Avg Other IO Operations (per Second) per Process and Host|Logs|Windows Performance/Avg Other IO Operations (per Second) per Process and Host|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "IOOtherOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOOtherOperationsPersec","Name" as ioOthers,procName \| where procName != "\_Total"<br />\| avg(ioOthers) as AvgIOOther by host, procName<br />\| transpose row host column procName|
|Windows Performance|Avg Other IO Operations per Host|Logs|Windows Performance/Avg Other IO Operations per Host|\_sourceCategory = Labs/Windows/OS/Windows "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOOtherOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOOtherOperationsPersec","Name" as ioOthers,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioOthers) as AvgIOOthers by host, \_timeslice \| sort - \_timeslice<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg Other IO Operations per Host|Logs|Installed Apps/Windows Performance/Avg Other IO Operations per Host|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" "\_Total" "IOOtherOperationsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "IOOtherOperationsPersec","Name" as ioOthers,procName \| where procName = "\_Total"<br />\| timeslice 1m <br />\| avg(ioOthers) as AvgIOOthers by host, \_timeslice \| sort - \_timeslice<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg Outbound Packets per Second|Logs|Installed Apps/Windows Performance/Network Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_Tcpip\_NetworkInterface" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "Name","PacketsOutboundDiscarded","PacketsOutboundErrors","PacketsSentPersec" as interface, pktSndDiscarded,pktSndError, pktSnd<br />\| timeslice 1m<br />\| avg(pktSndDiscarded) as AvgPacketSendDiscarded, avg(pktSndError) as AvgPacketSendError, avg(pktSnd) as AvgSend by host,interface, \_timeslice<br />\| sum(AvgPacketSendDiscarded) as PktSendDiscarded, sum(AvgPacketSendError) as PktSendError, sum(AvgSend) as PktSent by host, \_timeslice<br />\| sort - \_timeslice<br />\| transpose  row \_timeslice column host<br />|
|Windows Performance|Avg Output Queue Length|Logs|Installed Apps/Windows Performance/Network Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_Tcpip\_NetworkInterface" "OutputQueueLength"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "OutputQueueLength","Name" as outputQueueLength,interface <br />\| timeslice 1m <br />\| avg(outputQueueLength) as AvgOutQueueLen by host, \_timeslice \| sort - \_timeslice<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg PageFaults per Second by Host|Logs|Installed Apps/Windows Performance/Memory Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfOS\_Memory" "PageFaultsPersec" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PageFaultsPersec" as pageFaultsPerSec<br />\| timeslice 1m <br />\| avg(pageFaultsPersec) as AvgPageFaults by host, \_timeslice<br />\| transpose row \_timeslice column host|
|Windows Performance|Avg Privileged and User CPU Time (%) per Host|Logs|Installed Apps/Windows Performance/CPU Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfOS\_Processor" "\_Total"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop<br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentPrivilegedTime","PercentUserTime" as privTime,userTime<br />\| avg(userTime) as AvgUserTime, avg(privTime) as AvgPrivTime by host |
|Windows Performance|Avg Read and Write Counts per Host|Logs|Installed Apps/Windows Performance/Disk Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfDisk\_PhysicalDisk" "\_Total"  <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "DiskReadsPersec","DiskWritesPersec" as diskReads,diskWrites <br />\| avg(diskReads) as AvgDiskReads, avg(diskWrites) as AvgDiskWrites by host<br />\| int(AvgDiskReads) as AvgDiskReads \| int(AvgDiskWrites) as AvgDiskWrites |
|Windows Performance|Avg Total Bytes (per Second) by Physical Disk per Host|Logs|Installed Apps/Windows Performance/Disk Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfDisk\_PhysicalDisk" !"\_Total"  <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "DiskBytesPersec","Name" as diskBytes,hddName \| where hddName != "\_Total" <br />\| avg(diskBytes) as AvgDiskBytes by host,hddName<br />\| int(AvgDiskBytes) as AvgDiskBytes \| transpose row host column hddname|
|Windows Performance|Avg Total RW Operations (per Second) by Physical Disk per Host|Logs|Installed Apps/Windows Performance/Disk Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfDisk\_PhysicalDisk" !"\_Total"  <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "DiskReadsPersec","DiskWritesPersec","Name" as diskReadsPersec,diskWritesPersec,hddName \| where hddName != "\_Total" <br />\| (diskReadsPersec+diskWritesPersec) as diskReadsWritesPersec<br />\| avg(diskReadsWritesPersec) as AvgDiskReadsWrites by host,hddName<br />\| int(AvgDiskReadsWrites) as AvgDiskReadsWrites  \| transpose row host column hddname|
|Windows Performance|Avg Virtual Memory (MB) per Large Process by Host|Logs|Installed Apps/Windows Performance/Memory Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "VirtualBytes" "Name"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "VirtualBytes","Name" as vBytes, procName<br />\| avg(vBytes) as AvgVirtualBytes by host,procName <br />\| int(AvgVirtualBytes/(1024\*1024)) as AvgVirtualMBytes<br />\| if (AvgVirtualMBytes\>100, procName,"Others") as procName<br />\| fields - AvgVirtualBytes <br />\| avg(AvgVirtualMBytes) as AvgVirtualMBytes by host,procName<br />\| transpose row host column procName|
|Windows Performance|Top 10 Processes by Avg Privileged Time (%) per Host|Logs|Installed Apps/Windows Performance/CPU Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "PercentPrivilegedTime"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentPrivilegedTime","CreatingProcessID", "Name" as procUserTime,procID,procName<br />\| avg(procUserTime) as AvgProcUserTime by host,procID,procName \| sort by -AvgProcUserTime<br />\| 1 as dummy \| accum dummy by host<br />\| where \_accum\<11 <br />\| fields - procID, dummy, \_accum \| transpose row host column procname |
|Windows Performance|Top 10 Processes by Avg Processor Time (%) per Host|Logs|Installed Apps/Windows Performance/CPU Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "PercentProcessorTime"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentProcessorTime","CreatingProcessID","Name" as procTime,procID,procName<br />\| avg(procTime) as AvgProcTime by host,procName,procID \| sort by -AvgProcTime <br />\| 1 as dummy \| accum dummy by host<br />\| where \_accum\<11 <br />\| fields - procID, dummy, \_accum \| transpose row host column procName|
|Windows Performance|Top 10 Processes by Avg Processor Time (%) per Host|Logs|Installed Apps/Windows Performance/Windows Performance Overview|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "PercentProcessorTime"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentProcessorTime","CreatingProcessID","Name" as procTime,procID,procName<br />\| avg(procTime) as AvgProcTime by host,procName,procID \| sort by -AvgProcTime <br />\| 1 as dummy \| accum dummy by host<br />\| where \_accum\<11 <br />\| fields - procID, dummy, \_accum \| transpose row host column procName|
|Windows Performance|Top 10 Processes by Avg User Time (%) per Host|Logs|Installed Apps/Windows Performance/CPU Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "PercentUserTime"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PercentUserTime","CreatingProcessID", "Name" as procUserTime,procID,procName<br />\| avg(procUserTime) as AvgProcUserTime by host,procID,procName \| sort by -AvgProcUserTime<br />\| 1 as dummy \| accum dummy by host<br />\| where \_accum\<11 <br />\| fields - procID, dummy, \_accum \| transpose row host column procname |
|Windows Performance|Top 10 Processes with Largest Resident Memory|Logs|Installed Apps/Windows Performance/Memory Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "PrivateBytes","Name" as residentBytes,procName<br />\| avg(residentBytes) as AvgResidentBytes by host,procName<br />\| int(AvgResidentBytes/1048576) as AvgResidentMBytes \| sort -AvgResidentMBytes <br />\| 1 as dummy \| accum dummy by host \| where \_accum\<11<br />\| fields - AvgResidentBytes,dummy,\_accum <br />\| transpose row host column procName|
|Windows Performance|Top 10 Virtual Memory Consumers per Host|Logs|Installed Apps/Windows Performance/Memory Performance|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "VirtualBytes"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "VirtualBytes","Name" as vBytes,procName<br />\| avg(vBytes) as AvgVirtualBytes by host,procName <br />\| int(AvgVirtualBytes/(1024\*1024)) as AvgVirtualMBytes<br />\| sort -AvgVirtualMBytes \| 1 as dummy \| accum dummy by host \| where \_accum\<11<br />\| fields - dummy,\_accum,avgvirtualbytes<br />\| transpose row host column procname <br />|
|Windows Performance|Top 10 Virtual Memory Consumers per Host|Logs|Installed Apps/Windows Performance/Windows Performance Overview|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_PerfProc\_Process" !"\_Total" "VirtualBytes"<br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "VirtualBytes","Name" as vBytes,procName<br />\| avg(vBytes) as AvgVirtualBytes by host,procName <br />\| int(AvgVirtualBytes/(1024\*1024)) as AvgVirtualMBytes<br />\| sort -AvgVirtualMBytes \| 1 as dummy \| accum dummy by host \| where \_accum\<11<br />\| fields - dummy,\_accum,avgvirtualbytes<br />\| transpose row host column procname <br />|
|Windows Performance|Total Bandwidth (Bytes) by Host|Logs|Installed Apps/Windows Performance/Windows Performance Overview|\_sourceCategory={{Logsdatasource}} "Win32\_PerfFormattedData\_Tcpip\_NetworkInterface" <br />\| parse regex "winbox = (?\<dest\_host\>\\S+)" nodrop  <br />\| if (isNull(dest\_host) or dest\_host="",\_sourceHost,dest\_host) as host<br />\| kv regex "= (?:\\"\|)(.\*?)(?:\\"\|);" keys "BytesReceivedPersec","BytesSentPersec","Name" as bytesReceived, bytesSent,interface<br />\| sum(bytesReceived) as bytesReceived , sum(bytesSent) as bytesSent group by host<br />\| (bytesSent + bytesReceived) as total\_Bandwidth //\| transpose row host column interface<br />\| fields host,total\_Bandwidth<br />|

