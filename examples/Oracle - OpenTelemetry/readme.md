# Oracle - OpenTelemetry

## Searches

### Log Searches

- **% Datafile Space Utilization Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **% Datafile Space Utilization Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **% Tablespace Utilization Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **% Tablespace Utilization Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Admin Restricted Command Executions**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Admin Restricted Command Executions**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Archival Errors by Instance**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Archival Errors by Instance**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Archival Log Creation Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Archival Log Creation Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Avg Datafile Space Utilization**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Avg Datafile Space Utilization**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Avg Tablespace Utilization**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Avg Tablespace Utilization**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Block Corruption Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Block Corruption Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Brute Force Login Success**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Brute Force Login Success**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Brute Force Logon Success**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Brute Force Logon Success**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Buffer Cache Hit Ratio**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Buffer Cache Hit Ratio**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Command Execution Status**: from Dashboard: Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Command Execution Status**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Command Execution Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Command Execution Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Connections By Privileged Users**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Connections By Privileged Users**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Connections By Privileged Users - Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Connections By Privileged Users - Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Count Connection Status by Privileged Users**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Count Connection Status by Privileged Users**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Database Crash Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Database Crash Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **DB Connections**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **DB Connections**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **DB Connections by Applications**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **DB Connections by Applications**: from Dashboard: Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **DB Connections By Host**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **DB Connections By Host**: from Dashboard: Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **DDL Activity Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **DDL Activity Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Deadlock Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Deadlock Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **DML Activity Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **DML Activity Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Excessive Failed Logons**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Excessive Failed Logons**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Excessive Failed Logons**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Excessive Failed Logons**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Failed Logons**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Failed Logons**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Failed Logons**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Failed Logons**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Failed to Success Connection Ratio - Outlier**: from Dashboard: Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Failed to Success Connection Ratio - Outlier**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Failure Status Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Failure Status Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Failures, Warnings and Errors by Instance Source**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Failures, Warnings and Errors by Instance Source**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Fatal NI Connect Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Fatal NI Connect Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Hosts Reporting ORA Messages**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Hosts Reporting ORA Messages**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Instance Shutdown Complete**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Instance Shutdown Complete**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Instance Shutdown Initiated**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Instance Shutdown Initiated**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Instance Started**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Instance Started**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Internal Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Internal Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Last 10 Failed Connection Attempts**: from Dashboard: Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Last 10 Failed Connection Attempts**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Last 10 Failed DB Connections by Privileged Users**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Last 10 Failed DB Connections by Privileged Users**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Last 10 Listener Stopped Events**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Last 10 Listener Stopped Events**: from Dashboard: Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Last 10 Recent DDL Activities**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent DDL Activities**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent DML Activities**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent DML Activities**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent Jobs in the Database**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Last 10 Recent Jobs in the Database**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Last 10 Recent Role Management Activities**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent Role Management Activities**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent Successful DB Connections by Privileged Users**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Last 10 Recent Successful DB Connections by Privileged Users**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Last 10 Recent TCL Activities**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent TCL Activities**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent User Management Activities**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 10 Recent User Management Activities**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Last 20 Recent Failure Activities**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Last 20 Recent Failure Activities**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Last 20 Recent Successful Activities**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Last 20 Recent Successful Activities**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Location of Failed Connection Attempts From Public IPs**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Location of Failed Connection Attempts From Public IPs**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Location of Successful Connection Attempts From Public IPs**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Location of Successful Connection Attempts From Public IPs**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Log Switch Activity By Hosts**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Log Switch Activity By Hosts**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Logon Activities Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Logon Activities Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Logon Status Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Logon Status Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Maximum Wait Time (sec) by User**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Maximum Wait Time (sec) by User**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Multiple Client User Logons From Same UserHost**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Multiple Client User Logons From Same UserHost**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Multiple Client User Logons From Same UserHost**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Multiple Client User Logons From Same UserHost**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Multiple Database User Logons From Same UserHost**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Multiple Database User Logons From Same UserHost**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Multiple Database User Logons From Same UserHost**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Multiple Database User Logons From Same UserHost**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Multiple UserHosts Logons with Same Database User**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Multiple UserHosts Logons with Same Database User**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Multiple UserHosts Logons with Same Database User**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Multiple UserHosts Logons with Same Database User**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **ORA Messages Over Time**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **ORA Messages Over Time**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Possible Inappropriate Activity Events**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Possible Inappropriate Activity Events**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Recent Active Connections**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Recent Active Connections**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Role Management Activity Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Role Management Activity Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **Service Name**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **Service Name**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **Service Name Vs SID Adoption**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **Service Name Vs SID Adoption**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **SID**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **SID**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **SID or Service Name Connections**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **SID or Service Name Connections**: from Dashboard: Oracle - OpenTelemetry/Oracle - Listener Troubleshooting 
- **Status Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Status Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Successful Logoffs**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Successful Logoffs**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Successful Logons**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **Successful Logons**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Successful Logons**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis 
- **Successful Logons**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis 
- **TCL Activity Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **TCL Activity Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **TNS Command Execution Status**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Command Execution Status**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Commands Executed**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Commands Executed**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Error Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Error Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Most Active User Hosts**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Most Active User Hosts**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Protocol Used**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Protocol Used**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Top Client Hosts for __jdbc__**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Top Client Hosts for __jdbc__**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Top Database Users**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Top Database Users**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Top Ports Used by Client**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Top Ports Used by Client**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Top User Program Name**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **TNS Top User Program Name**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **Top 10 TNS Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Top 10 TNS Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Top Client Users**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Top Client Users**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Top Database Users**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Top Database Users**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Top ORA Messages**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Top ORA Messages**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Top Privileges Used**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Top Privileges Used**: from Dashboard: Oracle - OpenTelemetry/Oracle - Sys Audit Log 
- **Top Session Wait Time Events**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Top Session Wait Time Events**: from Dashboard: Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script 
- **Top TNS Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Overview 
- **Top TNS Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Overview 
- **Unable To Extend Tablespace Errors**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Unable To Extend Tablespace Errors**: from Dashboard: Oracle - OpenTelemetry/Oracle - Alert Analysis 
- **Unauthorized Command Executions**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **Unauthorized Command Executions**: from Dashboard: Oracle - OpenTelemetry/Oracle - Security Monitoring 
- **User Management Activity Trend**: from Dashboard: Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis 
- **User Management Activity Trend**: from Dashboard: Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Oracle - OpenTelemetry|% Datafile Space Utilization Trend|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "datafile status" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message <br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","FILE\_NAME","FREE\_SPACE\_MB","ALLOCATED\_MB","USED\_MB" as monitorType, filename, freespace, allocated, usedSpace<br />\| where monitorType="datafile status"<br />\| (usedSpace/allocated\*100) as Percent\_datafilespace\_Utilization<br />\| timeslice 5m<br />\| max(Percent\_datafilespace\_Utilization) as Percent\_datafilespace\_Utilization by filename, \_timeslice<br />\| sort by Percent\_datafilespace\_Utilization desc <br />\| transpose row \_timeslice column filename|
|Oracle - OpenTelemetry|% Datafile Space Utilization Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "datafile status" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message <br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","FILE\_NAME","FREE\_SPACE\_MB","ALLOCATED\_MB","USED\_MB" as monitorType, filename, freespace, allocated, usedSpace<br />\| where monitorType="datafile status"<br />\| (usedSpace/allocated\*100) as Percent\_datafilespace\_Utilization<br />\| timeslice 5m<br />\| max(Percent\_datafilespace\_Utilization) as Percent\_datafilespace\_Utilization by filename, \_timeslice<br />\| sort by Percent\_datafilespace\_Utilization desc <br />\| transpose row \_timeslice column filename|
|Oracle - OpenTelemetry|% Tablespace Utilization Trend|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "tablespace status"  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "Tablespace Name", "USED\_SPACE", "MONITOR\_TYPE","TOTAL\_SPACE","FREE\_SPACE" as tablespace\_name, usedSpace, monitorType, totalSpace, freeSpace<br />\| where monitorType="tablespace status"<br />\| (usedSpace/totalSpace\*100) as Percent\_Tablespace\_Utilization<br />\| timeslice 5m<br />\| max(Percent\_Tablespace\_Utilization) as Percent\_Tablespace\_Utilization by tablespace\_name, \_timeslice<br />\| sort by Percent\_Tablespace\_Utilization desc <br />\| transpose row \_timeslice column tablespace\_name|
|Oracle - OpenTelemetry|% Tablespace Utilization Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "tablespace status"  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "Tablespace Name", "USED\_SPACE", "MONITOR\_TYPE","TOTAL\_SPACE","FREE\_SPACE" as tablespace\_name, usedSpace, monitorType, totalSpace, freeSpace<br />\| where monitorType="tablespace status"<br />\| (usedSpace/totalSpace\*100) as Percent\_Tablespace\_Utilization<br />\| timeslice 5m<br />\| max(Percent\_Tablespace\_Utilization) as Percent\_Tablespace\_Utilization by tablespace\_name, \_timeslice<br />\| sort by Percent\_Tablespace\_Utilization desc <br />\| transpose row \_timeslice column tablespace\_name|
|Oracle - OpenTelemetry|Admin Restricted Command Executions|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ("TNS:listener could not resolve the COMMAND given" or "TNS-12508") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| count as eventCount|
|Oracle - OpenTelemetry|Admin Restricted Command Executions|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ("TNS:listener could not resolve the COMMAND given" or "TNS-12508") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| count as eventCount|
|Oracle - OpenTelemetry|Archival Errors by Instance|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Archival Error"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message  "ORACLE Instance \* - Archival Error" as instance <br />\| timeslice by 1h<br />\| count as eventCount by instance, \_timeslice<br />\| transpose row \_timeslice column instance|
|Oracle - OpenTelemetry|Archival Errors by Instance|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Archival Error"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message  "ORACLE Instance \* - Archival Error" as instance <br />\| timeslice by 1h<br />\| count as eventCount by instance, \_timeslice<br />\| transpose row \_timeslice column instance|
|Oracle - OpenTelemetry|Archival Log Creation Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle Thread cannot allocate new log sequence Checkpoint "not" complete \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr = "ORA-00270"<br />\| count as eventCount|
|Oracle - OpenTelemetry|Archival Log Creation Errors|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle Thread cannot allocate new log sequence Checkpoint "not" complete \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr = "ORA-00270"<br />\| count as eventCount|
|Oracle - OpenTelemetry|Avg Datafile Space Utilization|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "datafile status" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","FILE\_NAME","FREE\_SPACE\_MB","ALLOCATED\_MB","USED\_MB" as monitorType, filename, freespace, allocated, usedSpace<br />\| where monitorType="datafile status"<br />\| (usedSpace/allocated\*100) as Percent\_Datafilespace\_Utilization<br />\| format( "%.2f",Percent\_Datafilespace\_Utilization) as Percent\_Datafilespace\_Utilization<br />\| avg (Percent\_Datafilespace\_Utilization) as avg\_percent\_Datafilespace\_Utilization|
|Oracle - OpenTelemetry|Avg Datafile Space Utilization|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "datafile status" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","FILE\_NAME","FREE\_SPACE\_MB","ALLOCATED\_MB","USED\_MB" as monitorType, filename, freespace, allocated, usedSpace<br />\| where monitorType="datafile status"<br />\| (usedSpace/allocated\*100) as Percent\_Datafilespace\_Utilization<br />\| format( "%.2f",Percent\_Datafilespace\_Utilization) as Percent\_Datafilespace\_Utilization<br />\| avg (Percent\_Datafilespace\_Utilization) as avg\_percent\_Datafilespace\_Utilization|
|Oracle - OpenTelemetry|Avg Tablespace Utilization|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "tablespace status" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse  field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "Tablespace Name", "USED\_SPACE", "MONITOR\_TYPE","TOTAL\_SPACE","FREE\_SPACE" as tablespace\_name, usedSpace, monitorType, totalSpace, freeSpace<br />\| where monitorType="tablespace status"<br />\| (usedSpace/totalSpace\*100) as Percent\_Tablespace\_Utilization<br />\| format( "%.2f",Percent\_Tablespace\_Utilization) as Percent\_Tablespace\_Utilization<br />\| avg (Percent\_Tablespace\_Utilization) as avg\_percent\_Tablespace\_Utilization|
|Oracle - OpenTelemetry|Avg Tablespace Utilization|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "tablespace status" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse  field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "Tablespace Name", "USED\_SPACE", "MONITOR\_TYPE","TOTAL\_SPACE","FREE\_SPACE" as tablespace\_name, usedSpace, monitorType, totalSpace, freeSpace<br />\| where monitorType="tablespace status"<br />\| (usedSpace/totalSpace\*100) as Percent\_Tablespace\_Utilization<br />\| format( "%.2f",Percent\_Tablespace\_Utilization) as Percent\_Tablespace\_Utilization<br />\| avg (Percent\_Tablespace\_Utilization) as avg\_percent\_Tablespace\_Utilization|
|Oracle - OpenTelemetry|Block Corruption Errors|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ORA-01578" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr = "ORA-01578"<br />\| count as eventCount|
|Oracle - OpenTelemetry|Block Corruption Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ORA-01578" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr = "ORA-01578"<br />\| count as eventCount|
|Oracle - OpenTelemetry|Brute Force Login Success|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| where Action = "100" // Logon<br />\| join ( where status="0") as t1,<br />(where status!="0") as t2<br />on t1.databaseUser=t2.databaseUser timewindow 30m <br />\| (t1\_\_messagetime-t2\_\_messagetime) as timeGap \| where (timeGap \< 300000) and (timeGap\>0)<br />\| formatDate(fromMillis(t1\_\_messagetime),"MM/dd/yyyy HH:mm:ss.SSS Z") as LoginTime<br />\| t1\_databaseUser as databaseUser \| t1\_clientHost as clientHost<br />\| count as Attempts, max(t2\_\_messagetime) as LastFailedEpoc by databaseUser, clientHost, LoginTime, t1\_\_messagetime <br />\| where Attempts \> 2 <br />\| sort by t1\_\_messagetime \| formatDate(fromMillis(long(LastFailedEpoc)),"MM/dd/yyyy HH:mm:ss.SSS Z") as LastFailedTime \| fields -lastfailedepoc,t1\_\_messagetime|
|Oracle - OpenTelemetry|Brute Force Login Success|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| where Action = "100" // Logon<br />\| join ( where status="0") as t1,<br />(where status!="0") as t2<br />on t1.databaseUser=t2.databaseUser timewindow 30m <br />\| (t1\_\_messagetime-t2\_\_messagetime) as timeGap \| where (timeGap \< 300000) and (timeGap\>0)<br />\| formatDate(fromMillis(t1\_\_messagetime),"MM/dd/yyyy HH:mm:ss.SSS Z") as LoginTime<br />\| t1\_databaseUser as databaseUser \| t1\_clientHost as clientHost<br />\| count as Attempts, max(t2\_\_messagetime) as LastFailedEpoc by databaseUser, clientHost, LoginTime, t1\_\_messagetime <br />\| where Attempts \> 2 <br />\| sort by t1\_\_messagetime \| formatDate(fromMillis(long(LastFailedEpoc)),"MM/dd/yyyy HH:mm:ss.SSS Z") as LastFailedTime \| fields -lastfailedepoc,t1\_\_messagetime|
|Oracle - OpenTelemetry|Brute Force Logon Success|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'\\nSESSIONID:[\*] '\*'\\nUSERHOST:[\*] '\*'\\nCLIENT ADDRESS:[\*] '\*'\\nACTION NUMBER:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid, sessionlength, sessionid, userhostlength, userHost, clientaddresslength, clientAddress, actionnumberlength, actionNumber<br />\| where Action="CONNECT" // Logon<br />\| fields userHost, clientAddress, Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| join ( where status="0") as t1,<br />(where status!="0") as t2<br />on t1.databaseUser=t2.databaseUser timewindow 30m<br />\| (t1\_\_messagetime-t2\_\_messagetime) as timeGap \| where (timeGap \< 300000) and (timeGap\>0)<br />\| formatDate(fromMillis(t1\_\_messagetime),"MM/dd/yyyy HH:mm:ss.SSS Z") as LoginTime<br />\| t1\_databaseUser as databaseUser <br />\| t1\_clientAddress as clientAddress <br />\| t1\_userHost as userHost<br />\| count as Attempts, max(t2\_\_messagetime) as LastFailedEpoc by databaseUser, userHost, LoginTime, t1\_\_messagetime <br />\| where Attempts \> 2<br />\| sort by t1\_\_messagetime \| formatDate(fromMillis(long(LastFailedEpoc)),"MM/dd/yyyy HH:mm:ss.SSS Z") as LastFailedTime <br />\| fields -lastfailedepoc,t1\_\_messagetime|
|Oracle - OpenTelemetry|Brute Force Logon Success|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'\\nSESSIONID:[\*] '\*'\\nUSERHOST:[\*] '\*'\\nCLIENT ADDRESS:[\*] '\*'\\nACTION NUMBER:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid, sessionlength, sessionid, userhostlength, userHost, clientaddresslength, clientAddress, actionnumberlength, actionNumber<br />\| where Action="CONNECT" // Logon<br />\| fields userHost, clientAddress, Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| join ( where status="0") as t1,<br />(where status!="0") as t2<br />on t1.databaseUser=t2.databaseUser timewindow 30m<br />\| (t1\_\_messagetime-t2\_\_messagetime) as timeGap \| where (timeGap \< 300000) and (timeGap\>0)<br />\| formatDate(fromMillis(t1\_\_messagetime),"MM/dd/yyyy HH:mm:ss.SSS Z") as LoginTime<br />\| t1\_databaseUser as databaseUser <br />\| t1\_clientAddress as clientAddress <br />\| t1\_userHost as userHost<br />\| count as Attempts, max(t2\_\_messagetime) as LastFailedEpoc by databaseUser, userHost, LoginTime, t1\_\_messagetime <br />\| where Attempts \> 2<br />\| sort by t1\_\_messagetime \| formatDate(fromMillis(long(LastFailedEpoc)),"MM/dd/yyyy HH:mm:ss.SSS Z") as LastFailedTime <br />\| fields -lastfailedepoc,t1\_\_messagetime|
|Oracle - OpenTelemetry|Buffer Cache Hit Ratio|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "buffer cache hit ratio" <br />\| json "log" as \_rawlog nodrop<br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonout "Cache Hit Ratio", "MONITOR\_TYPE" as cachehitratio, monitorType<br />\| where monitorType="buffer cache hit ratio"<br />\| timeslice by 5m <br />\| max(cachehitratio) as %"CacheHitRatio" by \_timeslice|
|Oracle - OpenTelemetry|Buffer Cache Hit Ratio|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "buffer cache hit ratio" <br />\| json "log" as \_rawlog nodrop<br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonout "Cache Hit Ratio", "MONITOR\_TYPE" as cachehitratio, monitorType<br />\| where monitorType="buffer cache hit ratio"<br />\| timeslice by 5m <br />\| max(cachehitratio) as %"CacheHitRatio" by \_timeslice|
|Oracle - OpenTelemetry|Command Execution Status|Logs|Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "COMMAND=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| tolowercase(connect\_data\_command) as connect\_data\_command<br />\| if (status="0", "Success", "Failure") as CommandExecutionStatus<br />\| count as eventCount by connect\_data\_command, CommandExecutionStatus<br />\| transpose row connect\_data\_command column CommandExecutionStatus|
|Oracle - OpenTelemetry|Command Execution Status|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "COMMAND=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| tolowercase(connect\_data\_command) as connect\_data\_command<br />\| if (status="0", "Success", "Failure") as CommandExecutionStatus<br />\| count as eventCount by connect\_data\_command, CommandExecutionStatus<br />\| transpose row connect\_data\_command column CommandExecutionStatus|
|Oracle - OpenTelemetry|Command Execution Trend|Logs|Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "COMMAND=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| tolowercase(connect\_data\_command) as connect\_data\_command<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, connect\_data\_command<br />\| transpose row \_timeslice column connect\_data\_command|
|Oracle - OpenTelemetry|Command Execution Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "COMMAND=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| tolowercase(connect\_data\_command) as connect\_data\_command<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, connect\_data\_command<br />\| transpose row \_timeslice column connect\_data\_command|
|Oracle - OpenTelemetry|Connections By Privileged Users|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "USER=" (root or Administrator) \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| where databaseUser in ("root", "Administrator")<br />\| count as eventCount by databaseUser<br />\| top 20 databaseUser by eventCount, databaseUser asc|
|Oracle - OpenTelemetry|Connections By Privileged Users|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "USER=" (root or Administrator) \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| where databaseUser in ("root", "Administrator")<br />\| count as eventCount by databaseUser<br />\| top 20 databaseUser by eventCount, databaseUser asc|
|Oracle - OpenTelemetry|Connections By Privileged Users - Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "USER=" (root or Administrator) \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| where databaseUser in ("root", "Administrator")<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, databaseUser<br />\| transpose row \_timeslice column databaseUser<br />\| fillmissing timeslice(1h)|
|Oracle - OpenTelemetry|Connections By Privileged Users - Trend|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "USER=" (root or Administrator) \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| where databaseUser in ("root", "Administrator")<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, databaseUser<br />\| transpose row \_timeslice column databaseUser<br />\| fillmissing timeslice(1h)|
|Oracle - OpenTelemetry|Count Connection Status by Privileged Users|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "USER=" ("SID=" or "SERVICE\_NAME=") (root or Administrator)  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramname\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| "Unknown" as %"ConnectionStatus"<br />\| if (status=0, "Connected", %"ConnectionStatus") as  %"ConnectionStatus"<br />\| if (status!=0,"NotConnected", %"ConnectionStatus") as %"ConnectionStatus"<br />\| where databaseUser in ("root", "Administrator")<br />\| count as eventCount by databaseUser, %"ConnectionStatus"<br />\| transpose row databaseUser column %"ConnectionStatus"|
|Oracle - OpenTelemetry|Count Connection Status by Privileged Users|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "USER=" ("SID=" or "SERVICE\_NAME=") (root or Administrator)  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramname\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| "Unknown" as %"ConnectionStatus"<br />\| if (status=0, "Connected", %"ConnectionStatus") as  %"ConnectionStatus"<br />\| if (status!=0,"NotConnected", %"ConnectionStatus") as %"ConnectionStatus"<br />\| where databaseUser in ("root", "Administrator")<br />\| count as eventCount by databaseUser, %"ConnectionStatus"<br />\| transpose row databaseUser column %"ConnectionStatus"|
|Oracle - OpenTelemetry|Database Crash Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ("ORA-00603" or "ORA-00449" or "ORA-00471" or "ORA-01092") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr in ("ORA-00603", "ORA-00449", "ORA-00471", "ORA-01092")<br />\| count as eventCount|
|Oracle - OpenTelemetry|Database Crash Errors|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ("ORA-00603" or "ORA-00449" or "ORA-00471" or "ORA-01092") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr in ("ORA-00603", "ORA-00449", "ORA-00471", "ORA-01092")<br />\| count as eventCount|
|Oracle - OpenTelemetry|DB Connections|Logs|Oracle - OpenTelemetry/Oracle - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish ("SID=" or "SERVICE\_NAME=")  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message <br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| count as %"ConnectionCount"|
|Oracle - OpenTelemetry|DB Connections|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish ("SID=" or "SERVICE\_NAME=")  \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message <br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| count as %"ConnectionCount"|
|Oracle - OpenTelemetry|DB Connections by Applications|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| timeslice 1d<br />\| count as %"ConnectionCount" by \_timeslice, userProgramName<br />\| transpose row \_timeslice column userProgramName|
|Oracle - OpenTelemetry|DB Connections by Applications|Logs|Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| timeslice 1d<br />\| count as %"ConnectionCount" by \_timeslice, userProgramName<br />\| transpose row \_timeslice column userProgramName|
|Oracle - OpenTelemetry|DB Connections By Host|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message <br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort  nodrop<br />\| timeslice 5m<br />\| count as %"ConnectionCount" by \_timeslice, clientHost<br />\| transpose row \_timeslice column clientHost|
|Oracle - OpenTelemetry|DB Connections By Host|Logs|Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message <br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort  nodrop<br />\| timeslice 5m<br />\| count as %"ConnectionCount" by \_timeslice, clientHost<br />\| transpose row \_timeslice column clientHost|
|Oracle - OpenTelemetry|DDL Activity Trend|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>1\</Action\>" or "\<Action\>12\</Action\>" or "\<Action\>15\</Action\>" or "\<Action\>62\</Action\>" or "\<Action\>85\</Action\>" or "\<Action\>21\</Action\>" or "\<Action\>22\</Action\>" or "\<Action\>9\</Action\>" or "\<Action\>10\</Action\>" or "\<Action\>11\</Action\>" or "\<Action\>13\</Action\>" or "\<Action\>14\</Action\>" or "\<Action\>16\</Action\>" or "\<Action\>19\</Action\>" or "\<Action\>20\</Action\>" or "\<Action\>18\</Action\>" or "\<Action\>109\</Action\>" or "\<Action\>115\</Action\>" or "\<Action\>17\</Action\>" or "\<Action\>108\</Action\>" or "\<Action\>114\</Action\>" or "\<Action\>28\</Action\>" or "\<Action\>29\</Action\>" or "\<Action\>117\</Action\>" or "\<Action\>63\</Action\>" or "\<Action\>64\</Action\>" or "\<Action\>5\</Action\>" or "\<Action\>30\</Action\>" or "\<Action\>104\</Action\>" or "\<Action\>106\</Action\>" or "\<Action\>31\</Action\>" or "\<Action\>105\</Action\>" or "\<Action\>107\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("1", "12", "15", "62", "85", "21", "22", "9", "10", "11", "13", "14", "16", "19", "20", "18", "109", "115", "17", "108", "114", "28", "29", "117", "63", "64", "5", "30", "104", "106", "31", "105", "107") // 1 CREATE TABLE, 12 DROP TABLE, 15 ALTER TABLE, 62 ANALYZE TABLE and 85 TRUNCATE TABLE, 21 CREATE View, 22 Drop VIEW, 9 CREATE INDEX, 10 DROP INDEX, 11 ALTER INDEX, 13 CREATE SEQUENCE, 14 DROP SEQUENCE, 16 ALTER SEQUENCE, 19 CREATE SYNONYM, 20 DROP SYNONYM, 18 REVOKE OBJECT, 109 SYSTEM REVOKE, 115 REVOKE ROLE,17 GRANT OBJECT, 108 SYSTEM GRANT, 114 GRANT ROLE, 28 RENAME, 29 COMMENT, 117 USER COMMENT, 63 ANALYZE INDEX, 64 ANALYZE CLUSTER, 5 ALTER CLUSTER, 30 AUDIT OBJECT, 104 SYSTEM AUDIT, 106 AUDIT DEFAULT, 31 NOAUDIT OBJECT, 105 SYSTEM NOAUDIT, 107 NOAUDIT DEFAULT<br />\| if (Action="1", "CREATE TABLE", if (Action="12", "DROP TABLE", if (Action="15", "ALTER TABLE", if (Action="62", "ANALYZE TABLE", if (Action="85", "TRUNCATE TABLE", if (Action="21", "CREATE VIEW", if (Action="22", "DROP VIEW", if (Action="9", "CREATE INDEX",if (Action="10", "DROP INDEX", if (Action="11", "ALTER INDEX", if (Action="13", "CREATE SEQUENCE", if (Action="14", "DROP SEQUENCE", if (Action="16", "ALTER SEQUENCE", if (Action="19", "CREATE SYNONYM", if (Action="20", "DROP SYNONYM", if (Action="18", "REVOKE OBJECT", if (Action="109", "SYSTEM REVOKE", if (Action="115", "REVOKE ROLE", if (Action="17", "GRANT OBJECT", if (Action="108", "SYSTEM GRANT", if (Action="114", "GRANT ROLE", if (Action="28", "RENAME", if (Action="29", "COMMENT", if (Action="117", "USER COMMENT", if (Action="63", "ANALYZE INDEX", if (Action="64", "ANALYZE CLUSTER", if (Action="5", "ALTER CLUSTER", if (Action="30", "AUDIT OBJECT", if (Action="104", "SYSTEM AUDIT", if (Action="106", "AUDIT DEFAULT", if (Action="31", "NOAUDIT OBJECT", if (Action="105", "SYSTEM NOAUDIT", "NOAUDIT DEFAULT")))))))))))))))))))))))))))))))) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|DDL Activity Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>1\</Action\>" or "\<Action\>12\</Action\>" or "\<Action\>15\</Action\>" or "\<Action\>62\</Action\>" or "\<Action\>85\</Action\>" or "\<Action\>21\</Action\>" or "\<Action\>22\</Action\>" or "\<Action\>9\</Action\>" or "\<Action\>10\</Action\>" or "\<Action\>11\</Action\>" or "\<Action\>13\</Action\>" or "\<Action\>14\</Action\>" or "\<Action\>16\</Action\>" or "\<Action\>19\</Action\>" or "\<Action\>20\</Action\>" or "\<Action\>18\</Action\>" or "\<Action\>109\</Action\>" or "\<Action\>115\</Action\>" or "\<Action\>17\</Action\>" or "\<Action\>108\</Action\>" or "\<Action\>114\</Action\>" or "\<Action\>28\</Action\>" or "\<Action\>29\</Action\>" or "\<Action\>117\</Action\>" or "\<Action\>63\</Action\>" or "\<Action\>64\</Action\>" or "\<Action\>5\</Action\>" or "\<Action\>30\</Action\>" or "\<Action\>104\</Action\>" or "\<Action\>106\</Action\>" or "\<Action\>31\</Action\>" or "\<Action\>105\</Action\>" or "\<Action\>107\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("1", "12", "15", "62", "85", "21", "22", "9", "10", "11", "13", "14", "16", "19", "20", "18", "109", "115", "17", "108", "114", "28", "29", "117", "63", "64", "5", "30", "104", "106", "31", "105", "107") // 1 CREATE TABLE, 12 DROP TABLE, 15 ALTER TABLE, 62 ANALYZE TABLE and 85 TRUNCATE TABLE, 21 CREATE View, 22 Drop VIEW, 9 CREATE INDEX, 10 DROP INDEX, 11 ALTER INDEX, 13 CREATE SEQUENCE, 14 DROP SEQUENCE, 16 ALTER SEQUENCE, 19 CREATE SYNONYM, 20 DROP SYNONYM, 18 REVOKE OBJECT, 109 SYSTEM REVOKE, 115 REVOKE ROLE,17 GRANT OBJECT, 108 SYSTEM GRANT, 114 GRANT ROLE, 28 RENAME, 29 COMMENT, 117 USER COMMENT, 63 ANALYZE INDEX, 64 ANALYZE CLUSTER, 5 ALTER CLUSTER, 30 AUDIT OBJECT, 104 SYSTEM AUDIT, 106 AUDIT DEFAULT, 31 NOAUDIT OBJECT, 105 SYSTEM NOAUDIT, 107 NOAUDIT DEFAULT<br />\| if (Action="1", "CREATE TABLE", if (Action="12", "DROP TABLE", if (Action="15", "ALTER TABLE", if (Action="62", "ANALYZE TABLE", if (Action="85", "TRUNCATE TABLE", if (Action="21", "CREATE VIEW", if (Action="22", "DROP VIEW", if (Action="9", "CREATE INDEX",if (Action="10", "DROP INDEX", if (Action="11", "ALTER INDEX", if (Action="13", "CREATE SEQUENCE", if (Action="14", "DROP SEQUENCE", if (Action="16", "ALTER SEQUENCE", if (Action="19", "CREATE SYNONYM", if (Action="20", "DROP SYNONYM", if (Action="18", "REVOKE OBJECT", if (Action="109", "SYSTEM REVOKE", if (Action="115", "REVOKE ROLE", if (Action="17", "GRANT OBJECT", if (Action="108", "SYSTEM GRANT", if (Action="114", "GRANT ROLE", if (Action="28", "RENAME", if (Action="29", "COMMENT", if (Action="117", "USER COMMENT", if (Action="63", "ANALYZE INDEX", if (Action="64", "ANALYZE CLUSTER", if (Action="5", "ALTER CLUSTER", if (Action="30", "AUDIT OBJECT", if (Action="104", "SYSTEM AUDIT", if (Action="106", "AUDIT DEFAULT", if (Action="31", "NOAUDIT OBJECT", if (Action="105", "SYSTEM NOAUDIT", "NOAUDIT DEFAULT")))))))))))))))))))))))))))))))) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|Deadlock Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ORA-00060" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr = "ORA-00060"<br />\| count as eventCount|
|Oracle - OpenTelemetry|Deadlock Errors|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ORA-00060" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr = "ORA-00060"<br />\| count as eventCount|
|Oracle - OpenTelemetry|DML Activity Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>2\</Action\>" or "\<Action\>3\</Action\>" or "\<Action\>6\</Action\>" or "\<Action\>7\</Action\>" or "\<Action\>50\</Action\>" or "\<Action\>170\</Action\>" or "\<Action\>26\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("2", "3", "6", "7", "50", "170", "26") // 2 INSERT, 3 SELECT, 6 UPDATE, 7 DELETE, 50 EXPLAIN, 170 CALL METHOD, 26 LOCK<br />\| if (Action="2", "INSERT", if (Action="3", "SELECT", if (Action="6", "UPDATE", if (Action="7", "DELETE", if (Action="50", "EXPLAIN", if (action="170", "CALL METHOD", "LOCK" )))))) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|DML Activity Trend|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>2\</Action\>" or "\<Action\>3\</Action\>" or "\<Action\>6\</Action\>" or "\<Action\>7\</Action\>" or "\<Action\>50\</Action\>" or "\<Action\>170\</Action\>" or "\<Action\>26\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("2", "3", "6", "7", "50", "170", "26") // 2 INSERT, 3 SELECT, 6 UPDATE, 7 DELETE, 50 EXPLAIN, 170 CALL METHOD, 26 LOCK<br />\| if (Action="2", "INSERT", if (Action="3", "SELECT", if (Action="6", "UPDATE", if (Action="7", "DELETE", if (Action="50", "EXPLAIN", if (action="170", "CALL METHOD", "LOCK" )))))) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|Excessive Failed Logons|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle !"STATUS:[1] '0'" "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| where status!="0" and Action="CONNECT" // Failed Connection<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| timeslice 5m<br />\| count as eventCount by \_timeslice, Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| 5 as FailThreshold<br />\| where eventCount \> FailThreshold<br />\| sort by \_timeslice|
|Oracle - OpenTelemetry|Excessive Failed Logons|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" !"\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status!="0" and Action="100" // Failed Logon<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| timeslice 5m<br />\| count as eventCount by \_timeslice, databaseUser, clientUser, userHost, clientHost, status<br />\| 0 as FailThreshold<br />\| where eventCount \> FailThreshold<br />\| sort by \_timeslice|
|Oracle - OpenTelemetry|Excessive Failed Logons|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" !"\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status!="0" and Action="100" // Failed Logon<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| timeslice 5m<br />\| count as eventCount by \_timeslice, databaseUser, clientUser, userHost, clientHost, status<br />\| 0 as FailThreshold<br />\| where eventCount \> FailThreshold<br />\| sort by \_timeslice|
|Oracle - OpenTelemetry|Excessive Failed Logons|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle !"STATUS:[1] '0'" "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| where status!="0" and Action="CONNECT" // Failed Connection<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| timeslice 5m<br />\| count as eventCount by \_timeslice, Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| 5 as FailThreshold<br />\| where eventCount \> FailThreshold<br />\| sort by \_timeslice|
|Oracle - OpenTelemetry|Failed Logons|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid nodrop<br />\| where status!="0" and Action="CONNECT" // Failed Connection<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| count as eventCount|
|Oracle - OpenTelemetry|Failed Logons|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" !"\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status!="0" and Action="100" // Failed Logon<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count as eventCount|
|Oracle - OpenTelemetry|Failed Logons|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" !"\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status!="0" and Action="100" // Failed Logon<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count as eventCount|
|Oracle - OpenTelemetry|Failed Logons|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid nodrop<br />\| where status!="0" and Action="CONNECT" // Failed Connection<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| count as eventCount|
|Oracle - OpenTelemetry|Failed to Success Connection Ratio - Outlier|Logs|Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| if (status="0", 1, 0) as Connected<br />\| if (status!="0",1, 0) as NotConnected<br />\| timeslice 1d<br />\| sum(Connected) as Connected, sum(NotConnected) as NotConnected by \_timeslice<br />\| (NotConnected/Connected)\*100 as ratio<br />\| outlier ratio|
|Oracle - OpenTelemetry|Failed to Success Connection Ratio - Outlier|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| if (status="0", 1, 0) as Connected<br />\| if (status!="0",1, 0) as NotConnected<br />\| timeslice 1d<br />\| sum(Connected) as Connected, sum(NotConnected) as NotConnected by \_timeslice<br />\| (NotConnected/Connected)\*100 as ratio<br />\| outlier ratio|
|Oracle - OpenTelemetry|Failure Status Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle !"STATUS:[1] '0'" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| where status!="0"<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, status<br />\| transpose row \_timeslice column status|
|Oracle - OpenTelemetry|Failure Status Trend|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle !"STATUS:[1] '0'" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| where status!="0"<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, status<br />\| transpose row \_timeslice column status|
|Oracle - OpenTelemetry|Failures, Warnings and Errors by Instance Source|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle (fail\* or warn\* or error\*)\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message <br />\| timeslice by 1h<br />\| count as eventCount by \_source, \_timeslice <br />\| transpose row \_timeslice column \_source|
|Oracle - OpenTelemetry|Failures, Warnings and Errors by Instance Source|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle (fail\* or warn\* or error\*)\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message <br />\| timeslice by 1h<br />\| count as eventCount by \_source, \_timeslice <br />\| transpose row \_timeslice column \_source|
|Oracle - OpenTelemetry|Fatal NI Connect Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Fatal NI connect error" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "Fatal NI connect error (?\<oraerr\>\\d+?)(?:,\|\\.)"<br />\| count as eventCount|
|Oracle - OpenTelemetry|Fatal NI Connect Errors|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Fatal NI connect error" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "Fatal NI connect error (?\<oraerr\>\\d+?)(?:,\|\\.)"<br />\| count as eventCount|
|Oracle - OpenTelemetry|Hosts Reporting ORA Messages|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ORA-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1h<br />\| count as eventCount by host.name,\_timeslice <br />\| transpose row \_timeslice column host.name|
|Oracle - OpenTelemetry|Hosts Reporting ORA Messages|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ORA-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1h<br />\| count as eventCount by host.name,\_timeslice <br />\| transpose row \_timeslice column host.name|
|Oracle - OpenTelemetry|Instance Shutdown Complete|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Instance shutdown complete" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, host.name<br />\| sort by \_timeslice, host.name|
|Oracle - OpenTelemetry|Instance Shutdown Complete|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Instance shutdown complete" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, host.name<br />\| sort by \_timeslice, host.name|
|Oracle - OpenTelemetry|Instance Shutdown Initiated|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Shutting down instance" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, host.name<br />\| sort by \_timeslice, host.name|
|Oracle - OpenTelemetry|Instance Shutdown Initiated|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Shutting down instance" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, host.name<br />\| sort by \_timeslice, host.name|
|Oracle - OpenTelemetry|Instance Started|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Starting ORACLE instance" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, host.name<br />\| sort by \_timeslice, host.name|
|Oracle - OpenTelemetry|Instance Started|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "Starting ORACLE instance" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, host.name<br />\| sort by \_timeslice, host.name|
|Oracle - OpenTelemetry|Internal Errors|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ("ORA-00600" or "ORA-07445") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr in ("ORA-00600", "ORA-07445")<br />\| count as eventCount|
|Oracle - OpenTelemetry|Internal Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ("ORA-00600" or "ORA-07445") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| where oraerr in ("ORA-00600", "ORA-07445")<br />\| count as eventCount|
|Oracle - OpenTelemetry|Last 10 Failed Connection Attempts|Logs|Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") TNS-\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where status != "0"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, SID, serviceName, status, userProgramName, userHost, databaseUser, clientProtocol, clientHost, clientPort, TNSerr, tnsmsg<br />\| sort by \_timeslice<br />\| limit 10<br />\| fields -eventCount|
|Oracle - OpenTelemetry|Last 10 Failed Connection Attempts|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") TNS-\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where status != "0"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, SID, serviceName, status, userProgramName, userHost, databaseUser, clientProtocol, clientHost, clientPort, TNSerr, tnsmsg<br />\| sort by \_timeslice<br />\| limit 10<br />\| fields -eventCount|
|Oracle - OpenTelemetry|Last 10 Failed DB Connections by Privileged Users|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "USER=" ("SID=" or "SERVICE\_NAME=") (root or Administrator) TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse  field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex  field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where databaseUser in ("root", "Administrator") and status != "0"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice,  SID, serviceName, userProgramName, userHost, databaseUser, clientProtocol, clientHost, clientPort, TNSerr, tnsmsg<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Failed DB Connections by Privileged Users|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "USER=" ("SID=" or "SERVICE\_NAME=") (root or Administrator) TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse  field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex  field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where databaseUser in ("root", "Administrator") and status != "0"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice,  SID, serviceName, userProgramName, userHost, databaseUser, clientProtocol, clientHost, clientPort, TNSerr, tnsmsg<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Listener Stopped Events|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle COMMAND stop "COMMAND=stop" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "(CONNECT\_DATA=(CID=(PROGRAM=)(HOST=\*)(USER=\*))(COMMAND=\*)(ARGUMENTS=\*)(SERVICE=\*)(VERSION=\*))" as userHost, databaseUser, connect\_data\_command, connect\_data\_arguments, connect\_data\_service, connect\_data\_version nodrop<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| where connect\_data\_command="stop"<br />\| if (status="0", "Success", "Failure") as %"CommandExecutionStatus"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, userHost, databaseUser, connect\_data\_service, %"CommandExecutionStatus", status<br />\| sort by \_timeslice \| limit 10\| fields -eventCount|
|Oracle - OpenTelemetry|Last 10 Listener Stopped Events|Logs|Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle COMMAND stop "COMMAND=stop" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "(CONNECT\_DATA=(CID=(PROGRAM=)(HOST=\*)(USER=\*))(COMMAND=\*)(ARGUMENTS=\*)(SERVICE=\*)(VERSION=\*))" as userHost, databaseUser, connect\_data\_command, connect\_data\_arguments, connect\_data\_service, connect\_data\_version nodrop<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| where connect\_data\_command="stop"<br />\| if (status="0", "Success", "Failure") as %"CommandExecutionStatus"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, userHost, databaseUser, connect\_data\_service, %"CommandExecutionStatus", status<br />\| sort by \_timeslice \| limit 10\| fields -eventCount|
|Oracle - OpenTelemetry|Last 10 Recent DDL Activities|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>1\</Action\>" or "\<Action\>12\</Action\>" or "\<Action\>15\</Action\>" or "\<Action\>62\</Action\>" or "\<Action\>85\</Action\>" or "\<Action\>21\</Action\>" or "\<Action\>22\</Action\>" or "\<Action\>9\</Action\>" or "\<Action\>10\</Action\>" or "\<Action\>11\</Action\>" or "\<Action\>13\</Action\>" or "\<Action\>14\</Action\>" or "\<Action\>16\</Action\>" or "\<Action\>19\</Action\>" or "\<Action\>20\</Action\>" or "\<Action\>18\</Action\>" or "\<Action\>109\</Action\>" or "\<Action\>115\</Action\>" or "\<Action\>17\</Action\>" or "\<Action\>108\</Action\>" or "\<Action\>114\</Action\>" or "\<Action\>28\</Action\>" or "\<Action\>29\</Action\>" or "\<Action\>117\</Action\>" or "\<Action\>63\</Action\>" or "\<Action\>64\</Action\>" or "\<Action\>5\</Action\>" or "\<Action\>30\</Action\>" or "\<Action\>104\</Action\>" or "\<Action\>106\</Action\>" or "\<Action\>31\</Action\>" or "\<Action\>105\</Action\>" or "\<Action\>107\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("1", "12", "15", "62", "85", "21", "22", "9", "10", "11", "13", "14", "16", "19", "20", "18", "109", "115", "17", "108", "114", "28", "29", "117", "63", "64", "5", "30", "104", "106", "31", "105", "107") // 1 CREATE TABLE, 12 DROP TABLE, 15 ALTER TABLE, 62 ANALYZE TABLE and 85 TRUNCATE TABLE, 21 CREATE View, 22 Drop VIEW, 9 CREATE INDEX, 10 DROP INDEX, 11 ALTER INDEX, 13 CREATE SEQUENCE, 14 DROP SEQUENCE, 16 ALTER SEQUENCE, 19 CREATE SYNONYM, 20 DROP SYNONYM, 18 REVOKE OBJECT, 109 SYSTEM REVOKE, 115 REVOKE ROLE,17 GRANT OBJECT, 108 SYSTEM GRANT, 114 GRANT ROLE, 28 RENAME, 29 COMMENT, 117 USER COMMENT, 63 ANALYZE INDEX, 64 ANALYZE CLUSTER, 5 ALTER CLUSTER, 30 AUDIT OBJECT, 104 SYSTEM AUDIT, 106 AUDIT DEFAULT, 31 NOAUDIT OBJECT, 105 SYSTEM NOAUDIT, 107 NOAUDIT DEFAULT<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (Action="1", "CREATE TABLE", if (Action="12", "DROP TABLE", if (Action="15", "ALTER TABLE", if (Action="62", "ANALYZE TABLE", if (Action="85", "TRUNCATE TABLE", if (Action="21", "CREATE VIEW", if (Action="22", "DROP VIEW", if (Action="9", "CREATE INDEX",if (Action="10", "DROP INDEX", if (Action="11", "ALTER INDEX", if (Action="13", "CREATE SEQUENCE", if (Action="14", "DROP SEQUENCE", if (Action="16", "ALTER SEQUENCE", if (Action="19", "CREATE SYNONYM", if (Action="20", "DROP SYNONYM", if (Action="18", "REVOKE OBJECT", if (Action="109", "SYSTEM REVOKE", if (Action="115", "REVOKE ROLE", if (Action="17", "GRANT OBJECT", if (Action="108", "SYSTEM GRANT", if (Action="114", "GRANT ROLE", if (Action="28", "RENAME", if (Action="29", "COMMENT", if (Action="117", "USER COMMENT", if (Action="63", "ANALYZE INDEX", if (Action="64", "ANALYZE CLUSTER", if (Action="5", "ALTER CLUSTER", if (Action="30", "AUDIT OBJECT", if (Action="104", "SYSTEM AUDIT", if (Action="106", "AUDIT DEFAULT", if (Action="31", "NOAUDIT OBJECT", if (Action="105", "SYSTEM NOAUDIT", "NOAUDIT DEFAULT")))))))))))))))))))))))))))))))) as Action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent DDL Activities|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>1\</Action\>" or "\<Action\>12\</Action\>" or "\<Action\>15\</Action\>" or "\<Action\>62\</Action\>" or "\<Action\>85\</Action\>" or "\<Action\>21\</Action\>" or "\<Action\>22\</Action\>" or "\<Action\>9\</Action\>" or "\<Action\>10\</Action\>" or "\<Action\>11\</Action\>" or "\<Action\>13\</Action\>" or "\<Action\>14\</Action\>" or "\<Action\>16\</Action\>" or "\<Action\>19\</Action\>" or "\<Action\>20\</Action\>" or "\<Action\>18\</Action\>" or "\<Action\>109\</Action\>" or "\<Action\>115\</Action\>" or "\<Action\>17\</Action\>" or "\<Action\>108\</Action\>" or "\<Action\>114\</Action\>" or "\<Action\>28\</Action\>" or "\<Action\>29\</Action\>" or "\<Action\>117\</Action\>" or "\<Action\>63\</Action\>" or "\<Action\>64\</Action\>" or "\<Action\>5\</Action\>" or "\<Action\>30\</Action\>" or "\<Action\>104\</Action\>" or "\<Action\>106\</Action\>" or "\<Action\>31\</Action\>" or "\<Action\>105\</Action\>" or "\<Action\>107\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("1", "12", "15", "62", "85", "21", "22", "9", "10", "11", "13", "14", "16", "19", "20", "18", "109", "115", "17", "108", "114", "28", "29", "117", "63", "64", "5", "30", "104", "106", "31", "105", "107") // 1 CREATE TABLE, 12 DROP TABLE, 15 ALTER TABLE, 62 ANALYZE TABLE and 85 TRUNCATE TABLE, 21 CREATE View, 22 Drop VIEW, 9 CREATE INDEX, 10 DROP INDEX, 11 ALTER INDEX, 13 CREATE SEQUENCE, 14 DROP SEQUENCE, 16 ALTER SEQUENCE, 19 CREATE SYNONYM, 20 DROP SYNONYM, 18 REVOKE OBJECT, 109 SYSTEM REVOKE, 115 REVOKE ROLE,17 GRANT OBJECT, 108 SYSTEM GRANT, 114 GRANT ROLE, 28 RENAME, 29 COMMENT, 117 USER COMMENT, 63 ANALYZE INDEX, 64 ANALYZE CLUSTER, 5 ALTER CLUSTER, 30 AUDIT OBJECT, 104 SYSTEM AUDIT, 106 AUDIT DEFAULT, 31 NOAUDIT OBJECT, 105 SYSTEM NOAUDIT, 107 NOAUDIT DEFAULT<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (Action="1", "CREATE TABLE", if (Action="12", "DROP TABLE", if (Action="15", "ALTER TABLE", if (Action="62", "ANALYZE TABLE", if (Action="85", "TRUNCATE TABLE", if (Action="21", "CREATE VIEW", if (Action="22", "DROP VIEW", if (Action="9", "CREATE INDEX",if (Action="10", "DROP INDEX", if (Action="11", "ALTER INDEX", if (Action="13", "CREATE SEQUENCE", if (Action="14", "DROP SEQUENCE", if (Action="16", "ALTER SEQUENCE", if (Action="19", "CREATE SYNONYM", if (Action="20", "DROP SYNONYM", if (Action="18", "REVOKE OBJECT", if (Action="109", "SYSTEM REVOKE", if (Action="115", "REVOKE ROLE", if (Action="17", "GRANT OBJECT", if (Action="108", "SYSTEM GRANT", if (Action="114", "GRANT ROLE", if (Action="28", "RENAME", if (Action="29", "COMMENT", if (Action="117", "USER COMMENT", if (Action="63", "ANALYZE INDEX", if (Action="64", "ANALYZE CLUSTER", if (Action="5", "ALTER CLUSTER", if (Action="30", "AUDIT OBJECT", if (Action="104", "SYSTEM AUDIT", if (Action="106", "AUDIT DEFAULT", if (Action="31", "NOAUDIT OBJECT", if (Action="105", "SYSTEM NOAUDIT", "NOAUDIT DEFAULT")))))))))))))))))))))))))))))))) as Action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent DML Activities|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>2\</Action\>" or "\<Action\>3\</Action\>" or "\<Action\>6\</Action\>" or "\<Action\>7\</Action\>" or "\<Action\>50\</Action\>" or "\<Action\>170\</Action\>" or "\<Action\>26\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("2", "3", "6", "7", "50", "170", "26") // 2 INSERT, 3 SELECT, 6 UPDATE, 7 DELETE, 50 EXPLAIN, 170 CALL METHOD, 26 LOCK<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (Action="2", "INSERT", if (Action="3", "SELECT", if (Action="6", "UPDATE", if (Action="7", "DELETE", if (Action="50", "EXPLAIN", if (Action="170", "CALL METHOD", "LOCK" )))))) as Action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent DML Activities|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>2\</Action\>" or "\<Action\>3\</Action\>" or "\<Action\>6\</Action\>" or "\<Action\>7\</Action\>" or "\<Action\>50\</Action\>" or "\<Action\>170\</Action\>" or "\<Action\>26\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("2", "3", "6", "7", "50", "170", "26") // 2 INSERT, 3 SELECT, 6 UPDATE, 7 DELETE, 50 EXPLAIN, 170 CALL METHOD, 26 LOCK<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (Action="2", "INSERT", if (Action="3", "SELECT", if (Action="6", "UPDATE", if (Action="7", "DELETE", if (Action="50", "EXPLAIN", if (Action="170", "CALL METHOD", "LOCK" )))))) as Action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent Jobs in the Database|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "job status" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonout "TOTAL\_TIME", "WHAT", "NEXT\_DATE", "LOG\_USER", "NLS\_ENV", "INTERVAL", "LAST\_DATE", "SCHEMA\_USER", "MISC\_ENV", "BROKEN", "JOB", "PRIV\_USER", "MONITOR\_TYPE", "FAILURES" as TOTALTIME, WHAT, NEXT\_DATE, LOG\_USER, NLS\_ENV, INTERVAL, LAST\_DATE, SCHEMA\_USER, MISC\_ENV, BROKEN, JOB, PRIV\_USER, MONITORTYPE, FAILURES<br />\| parse field=jsonout "\\"MISC\_ENV\\": \\"\*\\"" as MISC\_ENV nodrop<br />\| where monitorType="job status"<br />\| timeslice 1s<br />\| count by \_timeslice, TOTALTIME, WHAT, NEXT\_DATE, LOG\_USER, NLS\_ENV, INTERVAL, LAST\_DATE, SCHEMA\_USER, MISC\_ENV, BROKEN, JOB, PRIV\_USER, MONITORTYPE, FAILURES <br />\| fields -\_count<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent Jobs in the Database|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "job status" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonout "TOTAL\_TIME", "WHAT", "NEXT\_DATE", "LOG\_USER", "NLS\_ENV", "INTERVAL", "LAST\_DATE", "SCHEMA\_USER", "MISC\_ENV", "BROKEN", "JOB", "PRIV\_USER", "MONITOR\_TYPE", "FAILURES" as TOTALTIME, WHAT, NEXT\_DATE, LOG\_USER, NLS\_ENV, INTERVAL, LAST\_DATE, SCHEMA\_USER, MISC\_ENV, BROKEN, JOB, PRIV\_USER, MONITORTYPE, FAILURES<br />\| parse field=jsonout "\\"MISC\_ENV\\": \\"\*\\"" as MISC\_ENV nodrop<br />\| where monitorType="job status"<br />\| timeslice 1s<br />\| count by \_timeslice, TOTALTIME, WHAT, NEXT\_DATE, LOG\_USER, NLS\_ENV, INTERVAL, LAST\_DATE, SCHEMA\_USER, MISC\_ENV, BROKEN, JOB, PRIV\_USER, MONITORTYPE, FAILURES <br />\| fields -\_count<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent Role Management Activities|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>52\</Action\>" or "\<Action\>54\</Action\>" or "\<Action\>55\</Action\>" or "\<Action\>79\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("52", "54", "55", "79") // 52 CREATE ROLE, 54 DROP ROLE, 55 SET ROLE, 79 ALTER ROLE<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (Action="52", "CREATE ROLE", if (Action="54", "DROP ROLE", if (Action="55", "SET ROLE", "ALTER ROLE" ))) as Action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent Role Management Activities|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>52\</Action\>" or "\<Action\>54\</Action\>" or "\<Action\>55\</Action\>" or "\<Action\>79\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("52", "54", "55", "79") // 52 CREATE ROLE, 54 DROP ROLE, 55 SET ROLE, 79 ALTER ROLE<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (Action="52", "CREATE ROLE", if (Action="54", "DROP ROLE", if (Action="55", "SET ROLE", "ALTER ROLE" ))) as Action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent Successful DB Connections by Privileged Users|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "USER=" ("SID=" or "SERVICE\_NAME=") (root or Administrator) !TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where databaseUser in ("root", "Administrator") and status = 0<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, SID, serviceName, userProgramName, userHost, databaseUser, clientProtocol, clientHost, clientPort<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent Successful DB Connections by Privileged Users|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "USER=" ("SID=" or "SERVICE\_NAME=") (root or Administrator) !TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where databaseUser in ("root", "Administrator") and status = 0<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, SID, serviceName, userProgramName, userHost, databaseUser, clientProtocol, clientHost, clientPort<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent TCL Activities|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>44\</Action\>" or "\<Action\>45\</Action\>" or "\<Action\>46\</Action\>" or "\<Action\>48\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("44", "45", "46", "48") // 44 COMMIT, 45 ROLLBACK, 46 SAVEPOINT, 48 SET TRANSACTION<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (Action="44", "COMMIT", if (Action="45", "ROLLBACK", if (Action="46", "SAVEPOINT", "SET TRANSACTION" ))) as Action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent TCL Activities|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>44\</Action\>" or "\<Action\>45\</Action\>" or "\<Action\>46\</Action\>" or "\<Action\>48\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("44", "45", "46", "48") // 44 COMMIT, 45 ROLLBACK, 46 SAVEPOINT, 48 SET TRANSACTION<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (Action="44", "COMMIT", if (Action="45", "ROLLBACK", if (Action="46", "SAVEPOINT", "SET TRANSACTION" ))) as Action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent User Management Activities|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>43\</Action\>" or "\<Action\>51\</Action\>" or "\<Action\>53\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("43", "51", "53") // 43 Alter User, 51 Create User and 53 Drop user<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (action="43", "ALTER USER", if (action="51", "CREATE USER", "DROP USER")) as action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 10 Recent User Management Activities|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>43\</Action\>" or "\<Action\>51\</Action\>" or "\<Action\>53\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("43", "51", "53") // 43 Alter User, 51 Create User and 53 Drop user<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, Sql\_Text, Object\_Name, Object\_Schema, clientTerminal, privilege<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| fields -eventCount<br />\| if (action="43", "ALTER USER", if (action="51", "CREATE USER", "DROP USER")) as action<br />\| sort by \_timeslice<br />\| limit 10|
|Oracle - OpenTelemetry|Last 20 Recent Failure Activities|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle !"STATUS:[1] '0'" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| where status!="0"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| sort by \_timeslice \| fields -eventCount<br />\| limit 20|
|Oracle - OpenTelemetry|Last 20 Recent Failure Activities|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle !"STATUS:[1] '0'" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| where status!="0"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| sort by \_timeslice \| fields -eventCount<br />\| limit 20|
|Oracle - OpenTelemetry|Last 20 Recent Successful Activities|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| where status="0"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| sort by \_timeslice \| fields -eventCount<br />\| limit 20|
|Oracle - OpenTelemetry|Last 20 Recent Successful Activities|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| where status="0"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| sort by \_timeslice \| fields -eventCount<br />\| limit 20|
|Oracle - OpenTelemetry|Location of Failed Connection Attempts From Public IPs|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse  field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex  field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where status != "0"<br />\| count by clientHost<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip=clientHost<br />\| where !isNull(latitude)|
|Oracle - OpenTelemetry|Location of Failed Connection Attempts From Public IPs|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse  field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex  field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where status != "0"<br />\| count by clientHost<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip=clientHost<br />\| where !isNull(latitude)|
|Oracle - OpenTelemetry|Location of Successful Connection Attempts From Public IPs|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse  field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex  field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where status = "0"<br />\| count by clientHost<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip=clientHost<br />\| where !isNull(latitude)|
|Oracle - OpenTelemetry|Location of Successful Connection Attempts From Public IPs|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex  field=oracle\_log\_message "\\\* \\(CONNECT\_DATA[\\s\\S]+?\\\* establish \\\* \\S+ \\\* (?\<status\>\\d+)" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex  field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse  field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse regex  field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| where status = "0"<br />\| count by clientHost<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip=clientHost<br />\| where !isNull(latitude)|
|Oracle - OpenTelemetry|Log Switch Activity By Hosts|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "LGWR switch"\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, host.name<br />\| transpose row \_timeslice column host.name|
|Oracle - OpenTelemetry|Log Switch Activity By Hosts|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "LGWR switch"\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| if (isEmpty(pod),host.name,pod) as host.name<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, host.name<br />\| transpose row \_timeslice column host.name|
|Oracle - OpenTelemetry|Logon Activities Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>100\</Action\>" or "\<Action\>101\</Action\>" or "\<Action\>102\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse field=Comment\_Text "DBLINK\_INFO: (SOURCE\_GLOBAL\_NAME=\*, DBLINK\_NAME=\*, SOURCE\_AUDIT\_SESSIONID=\*" as SOURCE\_GLOBAL\_NAME, DBLINK\_NAME, SOURCE\_AUDIT\_SESSIONID nodrop<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege, SOURCE\_GLOBAL\_NAME, DBLINK\_NAME, SOURCE\_AUDIT\_SESSIONID<br />\| where status="0" and Action in ("100", "101", "102") // Successful - 100 Logon and 101 and 102 logoffs<br />\| if (status="0" and Action="100", "Logon", "Logoff") as LogOnActivities<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, LogOnActivities<br />\| transpose row \_timeslice column LogOnActivities|
|Oracle - OpenTelemetry|Logon Activities Trend|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>100\</Action\>" or "\<Action\>101\</Action\>" or "\<Action\>102\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse field=Comment\_Text "DBLINK\_INFO: (SOURCE\_GLOBAL\_NAME=\*, DBLINK\_NAME=\*, SOURCE\_AUDIT\_SESSIONID=\*" as SOURCE\_GLOBAL\_NAME, DBLINK\_NAME, SOURCE\_AUDIT\_SESSIONID nodrop<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege, SOURCE\_GLOBAL\_NAME, DBLINK\_NAME, SOURCE\_AUDIT\_SESSIONID<br />\| where status="0" and Action in ("100", "101", "102") // Successful - 100 Logon and 101 and 102 logoffs<br />\| if (status="0" and Action="100", "Logon", "Logoff") as LogOnActivities<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, LogOnActivities<br />\| transpose row \_timeslice column LogOnActivities|
|Oracle - OpenTelemetry|Logon Status Trend|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| if (status="0", "Success", "Failure") as LogonStatus<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, LogonStatus<br />\| transpose row \_timeslice column LogonStatus|
|Oracle - OpenTelemetry|Logon Status Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| if (status="0", "Success", "Failure") as LogonStatus<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, LogonStatus<br />\| transpose row \_timeslice column LogonStatus|
|Oracle - OpenTelemetry|Maximum Wait Time (sec) by User|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "session waits" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","SECONDS\_IN\_WAIT","USERNAME","STATE","EVENT" as monitorType, secondsinwait, username, state, event<br />\| where monitorType="session waits"<br />\| timeslice by 5m <br />\| max(secondsinwait) group username, \_timeslice <br />\| transpose row \_timeslice column username|
|Oracle - OpenTelemetry|Maximum Wait Time (sec) by User|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "session waits" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","SECONDS\_IN\_WAIT","USERNAME","STATE","EVENT" as monitorType, secondsinwait, username, state, event<br />\| where monitorType="session waits"<br />\| timeslice by 5m <br />\| max(secondsinwait) group username, \_timeslice <br />\| transpose row \_timeslice column username|
|Oracle - OpenTelemetry|Multiple Client User Logons From Same UserHost|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" "\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as userHost nodrop \| parse field=userHost "\<Userhost\>\*\</Userhost\>" as userHost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status="0" and Action="100" // Successful Logon<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count\_distinct (clientUser) as %"UniqueClientUsers" by userHost, clientHost<br />\| 1 as threshold <br />\| where %"UniqueClientUsers" \> threshold<br />\| sort by userHost, clientHost, %"UniqueClientUsers"<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple Client User Logons From Same UserHost|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'\\nSESSIONID:[\*] '\*'\\nUSERHOST:[\*] '\*'\\nCLIENT ADDRESS:[\*] '\*'\\nACTION NUMBER:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid, sessionlength, sessionid, userhostlength, userHost, clientaddresslength, clientAddress, actionnumberlength, actionNumber<br />\| where status="0" and Action="CONNECT" // Successful Connection<br />\| fields clientAddress , Action, databaseUser, privilege, clientUser, userHost, clientTerminal, status, dbid<br />\| count\_distinct (clientUser) as %"UniqueClientUsers" by userHost<br />\| 0 as threshold <br />\| where %"UniqueClientUsers" \> threshold<br />\| sort by userHost, %"UniqueClientUsers"<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple Client User Logons From Same UserHost|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'\\nSESSIONID:[\*] '\*'\\nUSERHOST:[\*] '\*'\\nCLIENT ADDRESS:[\*] '\*'\\nACTION NUMBER:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid, sessionlength, sessionid, userhostlength, userHost, clientaddresslength, clientAddress, actionnumberlength, actionNumber<br />\| where status="0" and Action="CONNECT" // Successful Connection<br />\| fields clientAddress , Action, databaseUser, privilege, clientUser, userHost, clientTerminal, status, dbid<br />\| count\_distinct (clientUser) as %"UniqueClientUsers" by userHost<br />\| 0 as threshold <br />\| where %"UniqueClientUsers" \> threshold<br />\| sort by userHost, %"UniqueClientUsers"<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple Client User Logons From Same UserHost|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" "\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as userHost nodrop \| parse field=userHost "\<Userhost\>\*\</Userhost\>" as userHost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status="0" and Action="100" // Successful Logon<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count\_distinct (clientUser) as %"UniqueClientUsers" by userHost, clientHost<br />\| 1 as threshold <br />\| where %"UniqueClientUsers" \> threshold<br />\| sort by userHost, clientHost, %"UniqueClientUsers"<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple Database User Logons From Same UserHost|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'\\nSESSIONID:[\*] '\*'\\nUSERHOST:[\*] '\*'\\nCLIENT ADDRESS:[\*] '\*'\\nACTION NUMBER:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid, sessionlength, sessionid, userhostlength, userHost, clientaddresslength, clientAddress, actionnumberlength, actionNumber<br />\| where status="0" and Action="CONNECT" // Successful Connection<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, userHost, status, dbid<br />\| count\_distinct (databaseUser) as %"UniqueDatabaseUsers" by userHost<br />\| 1 as threshold <br />\| where %"UniqueDatabaseUsers" \> threshold<br />\| sort by %"UniqueDatabaseUsers", userHost asc<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple Database User Logons From Same UserHost|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'\\nSESSIONID:[\*] '\*'\\nUSERHOST:[\*] '\*'\\nCLIENT ADDRESS:[\*] '\*'\\nACTION NUMBER:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid, sessionlength, sessionid, userhostlength, userHost, clientaddresslength, clientAddress, actionnumberlength, actionNumber<br />\| where status="0" and Action="CONNECT" // Successful Connection<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, userHost, status, dbid<br />\| count\_distinct (databaseUser) as %"UniqueDatabaseUsers" by userHost<br />\| 1 as threshold <br />\| where %"UniqueDatabaseUsers" \> threshold<br />\| sort by %"UniqueDatabaseUsers", userHost asc<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple Database User Logons From Same UserHost|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" "\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as userHost nodrop \| parse field=userHost "\<Userhost\>\*\</Userhost\>" as userHost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status="0" and Action="100" // Successful Logon<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count\_distinct (databaseUser) as %"UniqueDatabaseUsers" by userHost, clientHost<br />\| 1 as threshold <br />\| where %"UniqueDatabaseUsers" \> threshold<br />\| sort by %"UniqueDatabaseUsers", userHost asc, clientHost<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple Database User Logons From Same UserHost|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" "\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as userHost nodrop \| parse field=userHost "\<Userhost\>\*\</Userhost\>" as userHost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status="0" and Action="100" // Successful Logon<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count\_distinct (databaseUser) as %"UniqueDatabaseUsers" by userHost, clientHost<br />\| 1 as threshold <br />\| where %"UniqueDatabaseUsers" \> threshold<br />\| sort by %"UniqueDatabaseUsers", userHost asc, clientHost<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple UserHosts Logons with Same Database User|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'\\nSESSIONID:[\*] '\*'\\nUSERHOST:[\*] '\*'\\nCLIENT ADDRESS:[\*] '\*'\\nACTION NUMBER:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid, sessionlength, sessionid, userhostlength, userHost, clientaddresslength, clientAddress, actionnumberlength, actionNumber<br />\| where status="0" and Action="CONNECT" // Successful Connection<br />\| fields clientAddress , Action, databaseUser, privilege, clientUser, userHost, clientTerminal, status, dbid<br />\| count\_distinct (userHost) as %"UniqueUserHosts" by databaseUser<br />\| 0 as threshold <br />\| where %"UniqueUserHosts" \> threshold<br />\| sort by  %"UniqueUserHosts", databaseUser asc<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple UserHosts Logons with Same Database User|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" "\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as userHost nodrop \| parse field=userHost "\<Userhost\>\*\</Userhost\>" as userHost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status="0" and Action="100" // Successful Logon<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count\_distinct (userHost) as %"UniqueUserHosts" by databaseUser<br />\| 1 as threshold <br />\| where %"UniqueUserHosts" \> threshold<br />\| sort %"UniqueUserHosts", databaseUser asc<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple UserHosts Logons with Same Database User|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" "\<Returncode\>0\</Returncode\>"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as userHost nodrop \| parse field=userHost "\<Userhost\>\*\</Userhost\>" as userHost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status="0" and Action="100" // Successful Logon<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count\_distinct (userHost) as %"UniqueUserHosts" by databaseUser<br />\| 1 as threshold <br />\| where %"UniqueUserHosts" \> threshold<br />\| sort %"UniqueUserHosts", databaseUser asc<br />\| fields -threshold|
|Oracle - OpenTelemetry|Multiple UserHosts Logons with Same Database User|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" "ACTION :[7] 'CONNECT'"<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'\\nSESSIONID:[\*] '\*'\\nUSERHOST:[\*] '\*'\\nCLIENT ADDRESS:[\*] '\*'\\nACTION NUMBER:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid, sessionlength, sessionid, userhostlength, userHost, clientaddresslength, clientAddress, actionnumberlength, actionNumber<br />\| where status="0" and Action="CONNECT" // Successful Connection<br />\| fields clientAddress , Action, databaseUser, privilege, clientUser, userHost, clientTerminal, status, dbid<br />\| count\_distinct (userHost) as %"UniqueUserHosts" by databaseUser<br />\| 0 as threshold <br />\| where %"UniqueUserHosts" \> threshold<br />\| sort by  %"UniqueUserHosts", databaseUser asc<br />\| fields -threshold|
|Oracle - OpenTelemetry|ORA Messages Over Time|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ORA-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| timeslice 1h <br />\| count as eventCount by oraerr,\_timeslice <br />\| transpose row \_timeslice column oraerr|
|Oracle - OpenTelemetry|ORA Messages Over Time|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ORA-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| timeslice 1h <br />\| count as eventCount by oraerr,\_timeslice <br />\| transpose row \_timeslice column oraerr|
|Oracle - OpenTelemetry|Possible Inappropriate Activity Events|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ("TNS-01169" or "TNS-01189" or "TNS-01190" or "TNS-12508") or ("ORA-12525" or "ORA-28040" or "ORA-12170") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi nodrop<br />\| where (TNSerr in ("TNS-01169", "TNS-01189", "TNS-01190", "TNS-12508")) or (oraerr in ("ORA-12525", "ORA-28040", "ORA-12170"))<br />\| count as eventCount|
|Oracle - OpenTelemetry|Possible Inappropriate Activity Events|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ("TNS-01169" or "TNS-01189" or "TNS-01190" or "TNS-12508") or ("ORA-12525" or "ORA-28040" or "ORA-12170") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi nodrop<br />\| where (TNSerr in ("TNS-01169", "TNS-01189", "TNS-01190", "TNS-12508")) or (oraerr in ("ORA-12525", "ORA-28040", "ORA-12170"))<br />\| count as eventCount|
|Oracle - OpenTelemetry|Recent Active Connections|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "active sessions" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","USERNAME","STATUS","MACHINE","PROGRAM","SERIAL#" as monitorType, USERNAME, STATUS, MACHINE, PROGRAM, serial <br />\| where monitorType="active sessions" and STATUS = "ACTIVE" <br />\| count\_distinct(serial) as numConnects by username, machine<br />\| sort by numConnects|
|Oracle - OpenTelemetry|Recent Active Connections|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "active sessions" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","USERNAME","STATUS","MACHINE","PROGRAM","SERIAL#" as monitorType, USERNAME, STATUS, MACHINE, PROGRAM, serial <br />\| where monitorType="active sessions" and STATUS = "ACTIVE" <br />\| count\_distinct(serial) as numConnects by username, machine<br />\| sort by numConnects|
|Oracle - OpenTelemetry|Role Management Activity Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>52\</Action\>" or "\<Action\>54\</Action\>" or "\<Action\>55\</Action\>" or "\<Action\>79\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("52", "54", "55", "79") // 52 CREATE ROLE, 54 DROP ROLE, 55 SET ROLE, 79 ALTER ROLE<br />\| if (Action="52", "CREATE ROLE", if (Action="54", "DROP ROLE", if (Action="55", "SET ROLE", "ALTER ROLE" ))) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|Role Management Activity Trend|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>52\</Action\>" or "\<Action\>54\</Action\>" or "\<Action\>55\</Action\>" or "\<Action\>79\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("52", "54", "55", "79") // 52 CREATE ROLE, 54 DROP ROLE, 55 SET ROLE, 79 ALTER ROLE<br />\| if (Action="52", "CREATE ROLE", if (Action="54", "DROP ROLE", if (Action="55", "SET ROLE", "ALTER ROLE" ))) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|Service Name|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}}  db.cluster.name={{db.cluster.name}} establish "SERVICE\_NAME=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| where !isEmpty(serviceName)<br />\| count as eventCount by serviceName<br />\| sort by eventCount, serviceName|
|Oracle - OpenTelemetry|Service Name|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}}  db.cluster.name={{db.cluster.name}} establish "SERVICE\_NAME=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| where !isEmpty(serviceName)<br />\| count as eventCount by serviceName<br />\| sort by eventCount, serviceName|
|Oracle - OpenTelemetry|Service Name Vs SID Adoption|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}}  db.cluster.name={{db.cluster.name}} establish ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| "Unknown" as Adoption<br />\| if (!isEmpty(serviceName),"serviceNameUsage", Adoption) as Adoption<br />\| if (!isEmpty(SID),"SIDUsage",Adoption) as Adoption<br />\| count by Adoption|
|Oracle - OpenTelemetry|Service Name Vs SID Adoption|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}}  db.cluster.name={{db.cluster.name}} establish ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| "Unknown" as Adoption<br />\| if (!isEmpty(serviceName),"serviceNameUsage", Adoption) as Adoption<br />\| if (!isEmpty(SID),"SIDUsage",Adoption) as Adoption<br />\| count by Adoption|
|Oracle - OpenTelemetry|SID|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}}  db.cluster.name={{db.cluster.name}} establish "SID=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| where !isEmpty(SID)<br />\| count as eventCount by SID<br />\| sort by eventCount, SID|
|Oracle - OpenTelemetry|SID|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}}  db.cluster.name={{db.cluster.name}} establish "SID=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| where !isEmpty(SID)<br />\| count as eventCount by SID<br />\| sort by eventCount, SID|
|Oracle - OpenTelemetry|SID or Service Name Connections|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| count as %"ConnectionCount" by SID, serviceName, userHost, clientHost, databaseUser<br />\| sort by SID, serviceName, userHost, clientHost, databaseUser, %"ConnectionCount"|
|Oracle - OpenTelemetry|SID or Service Name Connections|Logs|Oracle - OpenTelemetry/Oracle - Listener Troubleshooting| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle establish "PROGRAM=" ("SID=" or "SERVICE\_NAME=") \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SERVICE\_NAME=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?service\_name=(?\<serviceName\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?SID=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?sid=(?\<SID\>[^)]\*)\\)[\\s\\S]+establish" nodrop<br />\| parse regex field=oracle\_log\_message "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<databaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| count as %"ConnectionCount" by SID, serviceName, userHost, clientHost, databaseUser<br />\| sort by SID, serviceName, userHost, clientHost, databaseUser, %"ConnectionCount"|
|Oracle - OpenTelemetry|Status Trend|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| if (status="0", "Sucess", "Failure") as ActivityStatus<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, ActivityStatus<br />\| transpose row \_timeslice column ActivityStatus|
|Oracle - OpenTelemetry|Status Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| if (status="0", "Sucess", "Failure") as ActivityStatus<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, ActivityStatus<br />\| transpose row \_timeslice column ActivityStatus|
|Oracle - OpenTelemetry|Successful Logoffs|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>101\</Action\>" or "\<Action\>102\</Action\>") "\<Returncode\>0\</Returncode\>" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse field=Comment\_Text "DBLINK\_INFO: (SOURCE\_GLOBAL\_NAME=\*, DBLINK\_NAME=\*, SOURCE\_AUDIT\_SESSIONID=\*" as SOURCE\_GLOBAL\_NAME, DBLINK\_NAME, SOURCE\_AUDIT\_SESSIONID nodrop<br />\| where status="0" and Action in ("101", "102") // Logoff<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientTerminal, SOURCE\_GLOBAL\_NAME, DBLINK\_NAME, SOURCE\_AUDIT\_SESSIONID<br />\| count as eventCount|
|Oracle - OpenTelemetry|Successful Logoffs|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>101\</Action\>" or "\<Action\>102\</Action\>") "\<Returncode\>0\</Returncode\>" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse field=Comment\_Text "DBLINK\_INFO: (SOURCE\_GLOBAL\_NAME=\*, DBLINK\_NAME=\*, SOURCE\_AUDIT\_SESSIONID=\*" as SOURCE\_GLOBAL\_NAME, DBLINK\_NAME, SOURCE\_AUDIT\_SESSIONID nodrop<br />\| where status="0" and Action in ("101", "102") // Logoff<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientTerminal, SOURCE\_GLOBAL\_NAME, DBLINK\_NAME, SOURCE\_AUDIT\_SESSIONID<br />\| count as eventCount|
|Oracle - OpenTelemetry|Successful Logons|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" "\<Returncode\>0\</Returncode\>" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status="0" and Action="100" // Successful Logon<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count as eventCount|
|Oracle - OpenTelemetry|Successful Logons|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" "ACTION :[7] 'CONNECT'" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid nodrop<br />\| where status="0" and Action="CONNECT" // Successful Connection<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| count as eventCount|
|Oracle - OpenTelemetry|Successful Logons|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "STATUS:[1] '0'" "ACTION :[7] 'CONNECT'" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid nodrop<br />\| where status="0" and Action="CONNECT" // Successful Connection<br />\| fields Action, databaseUser, privilege, clientUser, clientTerminal, status, dbid<br />\| count as eventCount|
|Oracle - OpenTelemetry|Successful Logons|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - Logon Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" "\<Action\>100\</Action\>" "\<Returncode\>0\</Returncode\>" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| where status="0" and Action="100" // Successful Logon<br />\| fields Session\_Id, databaseUser, clientUser, Userhost, Action, status, clientProtocol, clientHost, clientPort, clientTerminal, privilege<br />\| count as eventCount|
|Oracle - OpenTelemetry|TCL Activity Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>44\</Action\>" or "\<Action\>45\</Action\>" or "\<Action\>46\</Action\>" or "\<Action\>48\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("44", "45", "46", "48") // 44 COMMIT, 45 ROLLBACK, 46 SAVEPOINT, 48 SET TRANSACTION<br />\| if (Action="44", "COMMIT", if (Action="45", "ROLLBACK", if (Action="46", "SAVEPOINT", "SET TRANSACTION" ))) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|TCL Activity Trend|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>44\</Action\>" or "\<Action\>45\</Action\>" or "\<Action\>46\</Action\>" or "\<Action\>48\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("44", "45", "46", "48") // 44 COMMIT, 45 ROLLBACK, 46 SAVEPOINT, 48 SET TRANSACTION<br />\| if (Action="44", "COMMIT", if (Action="45", "ROLLBACK", if (Action="46", "SAVEPOINT", "SET TRANSACTION" ))) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|TNS Command Execution Status|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "COMMAND=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| tolowercase(connect\_data\_command) as connect\_data\_command<br />\| if (status="0", "Success", "Failure") as CommandExecutionStatus<br />\| count as eventCount by CommandExecutionStatus|
|Oracle - OpenTelemetry|TNS Command Execution Status|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "COMMAND=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| tolowercase(connect\_data\_command) as connect\_data\_command<br />\| if (status="0", "Success", "Failure") as CommandExecutionStatus<br />\| count as eventCount by CommandExecutionStatus|
|Oracle - OpenTelemetry|TNS Commands Executed|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "COMMAND=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| tolowercase(connect\_data\_command) as connect\_data\_command<br />\| count as eventCount by connect\_data\_command<br />\| sort by eventCount, connect\_data\_command asc|
|Oracle - OpenTelemetry|TNS Commands Executed|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "COMMAND=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "\\\* \\(CONNECT\_DATA[\\s\\S]+?COMMAND=(?\<connect\_data\_command\>[^)]\*)\\)[\\s\\S]+?\\\* (?\<command\>[^\\s]+)\\s+\\\*\\s+(?\<status\>\\d+)"<br />\| tolowercase(connect\_data\_command) as connect\_data\_command<br />\| count as eventCount by connect\_data\_command<br />\| sort by eventCount, connect\_data\_command asc|
|Oracle - OpenTelemetry|TNS Error Trend|Logs|Oracle - OpenTelemetry/Oracle - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" multi<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, tnserr<br />\| transpose row \_timeslice column tnserr|
|Oracle - OpenTelemetry|TNS Error Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" multi<br />\| timeslice 1h<br />\| count as eventCount by \_timeslice, tnserr<br />\| transpose row \_timeslice column tnserr|
|Oracle - OpenTelemetry|TNS Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" multi<br />\| count as eventCount|
|Oracle - OpenTelemetry|TNS Errors|Logs|Oracle - OpenTelemetry/Oracle - Overview| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" multi<br />\| count as eventCount|
|Oracle - OpenTelemetry|TNS Most Active User Hosts|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "HOST=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<UserProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<UserHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<DatabaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as ClientProtocol, ClientHost, ClientPort nodrop<br />\| count as EventCount by UserHost, ClientHost<br />\| top 20 UserHost, ClientHost by EventCount, UserHost, ClientHost|
|Oracle - OpenTelemetry|TNS Most Active User Hosts|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "HOST=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<UserProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<UserHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<DatabaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as ClientProtocol, ClientHost, ClientPort nodrop<br />\| count as EventCount by UserHost, ClientHost<br />\| top 20 UserHost, ClientHost by EventCount, UserHost, ClientHost|
|Oracle - OpenTelemetry|TNS Protocol Used|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}}  db.cluster.name={{db.cluster.name}} "ADDRESS=" "PROTOCOL=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(KEY=LISTENER)" as clientProtocol nodrop<br />\| toUppercase(clientProtocol) as clientProtocol<br />\| count as eventCount by clientProtocol<br />\| top 20 clientProtocol by eventCount, clientProtocol|
|Oracle - OpenTelemetry|TNS Protocol Used|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}}  db.cluster.name={{db.cluster.name}} "ADDRESS=" "PROTOCOL=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(KEY=LISTENER)" as clientProtocol nodrop<br />\| toUppercase(clientProtocol) as clientProtocol<br />\| count as eventCount by clientProtocol<br />\| top 20 clientProtocol by eventCount, clientProtocol|
|Oracle - OpenTelemetry|TNS Top Client Hosts for \_\_jdbc\_\_|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "ADDRESS=" "HOST=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<UserProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<UserHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<DatabaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as ClientProtocol, ClientHost, ClientPort nodrop<br />\| count as EventCount by ClientHost, UserHost<br />\| where UserHost="\_\_jdbc\_\_"<br />\| top 20 ClientHost by EventCount, ClientHost|
|Oracle - OpenTelemetry|TNS Top Client Hosts for \_\_jdbc\_\_|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "ADDRESS=" "HOST=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<UserProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<UserHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<DatabaseUser\>[^)]\*)\\)" nodrop<br />\| parse field=oracle\_log\_message "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as ClientProtocol, ClientHost, ClientPort nodrop<br />\| count as EventCount by ClientHost, UserHost<br />\| where UserHost="\_\_jdbc\_\_"<br />\| top 20 ClientHost by EventCount, ClientHost|
|Oracle - OpenTelemetry|TNS Top Database Users|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "USER=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<DatabaseUser\>[^)]\*)\\)" nodrop<br />\| count as EventCount by DatabaseUser<br />\| top 20 DatabaseUser by EventCount, DatabaseUser asc|
|Oracle - OpenTelemetry|TNS Top Database Users|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "USER=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<userProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<userHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<DatabaseUser\>[^)]\*)\\)" nodrop<br />\| count as EventCount by DatabaseUser<br />\| top 20 DatabaseUser by EventCount, DatabaseUser asc|
|Oracle - OpenTelemetry|TNS Top Ports Used by Client|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "ADDRESS=" "PORT=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message  "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as ClientProtocol, ClientHost, ClientPort nodrop<br />\| count as EventCount by ClientPort<br />\| top 20 ClientPort by EventCount, ClientPort|
|Oracle - OpenTelemetry|TNS Top Ports Used by Client|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "ADDRESS=" "PORT=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message  "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as ClientProtocol, ClientHost, ClientPort nodrop<br />\| count as EventCount by ClientPort<br />\| top 20 ClientPort by EventCount, ClientPort|
|Oracle - OpenTelemetry|TNS Top User Program Name|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "PROGRAM=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<UserProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<UserHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<DatabaseUser\>[^)]\*)\\)" nodrop<br />\| count as EventCount by UserProgramName<br />\| top 20 UserProgramName by EventCount, UserProgramName asc|
|Oracle - OpenTelemetry|TNS Top User Program Name|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} "PROGRAM=" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "CONNECT\_DATA[\\s\\S]+?PROGRAM=(?\<UserProgramName\>[^)]\*)\\)[\\s\\S]+?HOST=(?\<UserHost\>[^)]\*)\\)[\\s\\S]+?USER=(?\<DatabaseUser\>[^)]\*)\\)" nodrop<br />\| count as EventCount by UserProgramName<br />\| top 20 UserProgramName by EventCount, UserProgramName asc|
|Oracle - OpenTelemetry|Top 10 TNS Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" multi<br />\| count as eventCount by tnserr, tnsmsg <br />\| sort by eventCount, tnserr asc<br />\| limit 10|
|Oracle - OpenTelemetry|Top 10 TNS Errors|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" multi<br />\| count as eventCount by tnserr, tnsmsg <br />\| sort by eventCount, tnserr asc<br />\| limit 10|
|Oracle - OpenTelemetry|Top Client Users|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| count as eventCount by clientUser<br />\| top 10 clientUser by eventCount, clientUser asc|
|Oracle - OpenTelemetry|Top Client Users|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| count as eventCount by clientUser<br />\| top 10 clientUser by eventCount, clientUser asc|
|Oracle - OpenTelemetry|Top Database Users|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| count as eventCount by databaseUser<br />\| top 10 databaseUser by eventCount, databaseUser asc|
|Oracle - OpenTelemetry|Top Database Users|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| count as eventCount by databaseUser<br />\| top 10 databaseUser by eventCount, databaseUser asc|
|Oracle - OpenTelemetry|Top ORA Messages|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ORA-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| count as eventCount by oraerr \| sort by eventCount|
|Oracle - OpenTelemetry|Top ORA Messages|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle ORA-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{5}): (?\<oramsg\>.\*)" multi<br />\| count as eventCount by oraerr \| sort by eventCount|
|Oracle - OpenTelemetry|Top Privileges Used|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| count as eventCount by privilege<br />\| top 10 privilege by eventCount, privilege asc|
|Oracle - OpenTelemetry|Top Privileges Used|Logs|Oracle - OpenTelemetry/Oracle - Sys Audit Log| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message "\\nLENGTH : '\*'\\nACTION :[\*] '\*'\\nDATABASE USER:[\*] '\*'\\nPRIVILEGE :[\*] '\*'\\nCLIENT USER:[\*] '\*'\\nCLIENT TERMINAL:[\*] '\*'\\nSTATUS:[\*] '\*'\\nDBID:[\*] '\*'" as totallength, actionlength, Action, databaseuserlength, databaseUser, privilegelength, privilege, clientuserlength, clientUser, clientterminallength, clientTerminal, statuslength, status, dbidlength, dbid<br />\| count as eventCount by privilege<br />\| top 10 privilege by eventCount, privilege asc|
|Oracle - OpenTelemetry|Top Session Wait Time Events|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "session waits" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","SECONDS\_IN\_WAIT","USERNAME","STATE","EVENT" as monitorType, secondsinwait, username, state, event<br />\| where monitorType="session waits"<br />\| count as eventCount by event <br />\| top 10 event by eventCount, event asc|
|Oracle - OpenTelemetry|Top Session Wait Time Events|Logs|Oracle - OpenTelemetry/Oracle - Monitor Performance by DB Script| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "session waits" \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse field=oracle\_log\_message " queryoutput=\*" as jsonOUT <br />\| json field=jsonOUT "MONITOR\_TYPE","SECONDS\_IN\_WAIT","USERNAME","STATE","EVENT" as monitorType, secondsinwait, username, state, event<br />\| where monitorType="session waits"<br />\| count as eventCount by event <br />\| top 10 event by eventCount, event asc|
|Oracle - OpenTelemetry|Top TNS Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" multi<br />\| count as EventCount by tnserr, tnsmsg <br />\| top 10 tnserr, tnsmsg by EventCount, tnserr asc|
|Oracle - OpenTelemetry|Top TNS Errors|Logs|Oracle - OpenTelemetry/Oracle - Overview| sumo.datasource=oracle deployment.environment={{deployment.environment}} db.cluster.name={{db.cluster.name}} TNS-\* \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message  "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" multi<br />\| count as EventCount by tnserr, tnsmsg <br />\| top 10 tnserr, tnsmsg by EventCount, tnserr asc|
|Oracle - OpenTelemetry|Unable To Extend Tablespace Errors|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle unable to extend by tablespace<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{4,5}): (?\<oramsg\>.\*)" multi<br />\| parse regex field=oramsg "unable to extend (?\<object\>[\\S\\s]+?)\\s+by \\d+ in tablespace\\s+(?\<tablespace\>\\S+)"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, oraerr, oramsg, object, tablespace<br />\| sort by \_timeslice|
|Oracle - OpenTelemetry|Unable To Extend Tablespace Errors|Logs|Oracle - OpenTelemetry/Oracle - Alert Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle unable to extend by tablespace<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<oraerr\>ORA-\\d{4,5}): (?\<oramsg\>.\*)" multi<br />\| parse regex field=oramsg "unable to extend (?\<object\>[\\S\\s]+?)\\s+by \\d+ in tablespace\\s+(?\<tablespace\>\\S+)"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, oraerr, oramsg, object, tablespace<br />\| sort by \_timeslice|
|Oracle - OpenTelemetry|Unauthorized Command Executions|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "TNS-01190" or "The user is not authorized to execute the requested listener command" \| json "log" as \_rawlog nodrop <br /> \| where environment matches "{{deployment.environment}}"<br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| count as eventCount|
|Oracle - OpenTelemetry|Unauthorized Command Executions|Logs|Oracle - OpenTelemetry/Oracle - Security Monitoring| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "TNS-01190" or "The user is not authorized to execute the requested listener command" \| json "log" as \_rawlog nodrop <br /> \| where environment matches "{{deployment.environment}}"<br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<TNSerr\>TNS-\\d{5}): (?\<tnsmsg\>.\*)" nodrop<br />\| count as eventCount|
|Oracle - OpenTelemetry|User Management Activity Trend|Logs|Installed Apps/Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>43\</Action\>" or "\<Action\>51\</Action\>" or "\<Action\>53\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("43", "51", "53") // 43 ALTER USER, 51 Create USER and 53 DROP USER<br />\| if (Action="43", "ALTER USER", if (Action="51", "CREATE USER", "DROP USER")) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|
|Oracle - OpenTelemetry|User Management Activity Trend|Logs|Oracle - OpenTelemetry/Oracle - XML Audit Log - SQL Statement Analysis| db.cluster.name={{db.cluster.name}} deployment.environment={{deployment.environment}} sumo.datasource=oracle "\<AuditRecord\>" ("\<Action\>43\</Action\>" or "\<Action\>51\</Action\>" or "\<Action\>53\</Action\>")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as oracle\_log\_message<br />\| parse regex field=oracle\_log\_message "(?\<auditrecord\>\\\<AuditRecord\\\>[\\s\\S]+?\</AuditRecord\>)"<br />\| parse XML field=auditrecord "/AuditRecord/Audit\_Type" as Audit\_Type nodrop \| parse field=Audit\_Type "\<Audit\_Type\>\*\</Audit\_Type\>" as Audit\_Type nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Session\_Id" as Session\_Id nodrop \| parse field=Session\_Id "\<Session\_Id\>\*\</Session\_Id\>" as Session\_Id nodrop<br />\| parse XML field=auditrecord "/AuditRecord/DB\_User" as databaseUser nodrop \| parse field=databaseUser "\<DB\_User\>\*\</DB\_User\>" as databaseUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/OS\_User" as clientUser nodrop \| parse field=clientUser "\<OS\_User\>\*\</OS\_User\>" as clientUser nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Userhost" as Userhost nodrop \| parse field=Userhost "\<Userhost\>\*\</Userhost\>" as Userhost nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Sql\_Text" as Sql\_Text nodrop \| parse field=Sql\_Text "\<Sql\_Text\>\*\</Sql\_Text\>" as Sql\_Text nodrop \| parse regex field=Sql\_Text "\\s+(?\<Sql\_Text\>.\*)" nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Action" as Action nodrop \| parse field=Action "\<Action\>\*\</Action\>" as Action nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Returncode" as status nodrop \| parse field=status "\<Returncode\>\*\</Returncode\>" as status nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Comment\_Text" as Comment\_Text nodrop \| parse field=Comment\_Text "\<Comment\_Text\>\*\</Comment\_Text\>" as Comment\_Text nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Priv\_Used" as privilege nodrop \| parse field=privilege "\<Priv\_Used\>\*\</Priv\_Used\>" as privilege nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Terminal" as clientTerminal nodrop \| parse field=clientTerminal "\<Terminal\>\*\</Terminal\>" as clientTerminal nodrop<br />\| parse field=Comment\_Text "(ADDRESS=(PROTOCOL=\*)(HOST=\*)(PORT=\*))" as clientProtocol, clientHost, clientPort nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Name" as Object\_Name nodrop \| parse field=Object\_Name "\<Object\_Name\>\*\</Object\_Name\>" as Object\_Name nodrop<br />\| parse XML field=auditrecord "/AuditRecord/Object\_Schema" as Object\_Schema nodrop \| parse field=Object\_Schema "\<Object\_Schema\>\*\</Object\_Schema\>" as Object\_Schema nodrop<br />\| where Action in ("43", "51", "53") // 43 ALTER USER, 51 Create USER and 53 DROP USER<br />\| if (Action="43", "ALTER USER", if (Action="51", "CREATE USER", "DROP USER")) as Action<br />\| fields Session\_Id, databaseUser, clientUser, userHost, Action, Object\_Name, Object\_Schema, Sql\_Text, status, clientTerminal, privilege<br />\| timeslice 1d<br />\| count as eventCount by \_timeslice, Action<br />\| transpose row \_timeslice column Action|

