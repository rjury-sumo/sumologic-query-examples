# Imperva - Incapsula Web Application Firewall

## Searches

### Log Searches

- **Blocked Countries Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries 
- **browser_type Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries 
- **browser_type Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control 
- **browser_type Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview 
- **City Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control 
- **client_app Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview 
- **Country Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control 
- **Country Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview 
- **Geo Lookup**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control 
- **policy_type**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview 
- **Source IP Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries 
- **Source IP Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview 
- **Source IP Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control 
- **Threat Table based on Client IP**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries 
- **Top Applied ADR Rules**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview 
- **URL Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview 
- **User Agents Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control 
- **user_agent Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries 
- **user_agent Top Values**: from Dashboard: Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Imperva - Incapsula Web Application Firewall|Blocked Countries Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries|\_sourceCategory={{Logsdatasource}} <br />AND "Blocked Country" <br />\| parse "sourceServiceName=\* " as site\_name <br />\| parse "requestClientApplication=\* cs2" as user\_agent <br />\| parse "src=\* " as source\_ip <br />\| parse "dproc=\* cs6" as browser\_type <br />\| parse "ccode=\* " as Country <br />\| parse "cicode=\* " as City<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count Country <br />\| top 10 Country by \_count|
|Imperva - Incapsula Web Application Firewall|browser\_type Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries|\_sourceCategory={{Logsdatasource}} <br />AND "Blocked Country"  <br />\| parse "sourceServiceName=\* " as site\_name <br />\| parse "requestClientApplication=\* cs2" as user\_agent <br />\| parse "src=\* " as source\_ip <br />\| parse "dproc=\* cs6" as browser\_type<br />\| parse "ccode=\* " as Country<br />\| parse "cicode=\* " as City<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count browser\_type <br />\| top 10 browser\_type by \_count|
|Imperva - Incapsula Web Application Firewall|browser\_type Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control|\_sourceCategory={{Logsdatasource}}  AND "Bot Access Control"<br />\| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\|count browser\_type<br />\| top 10 browser\_type by \_count|
|Imperva - Incapsula Web Application Firewall|browser\_type Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview|\_sourceCategory={{Logsdatasource}}  \| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count browser\_type<br />\| top 10 browser\_type by \_count|
|Imperva - Incapsula Web Application Firewall|City Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control|\_sourceCategory={{Logsdatasource}}  AND "Bot Access Control"<br />\|parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count City <br />\| top 10 City by \_count|
|Imperva - Incapsula Web Application Firewall|client\_app Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count client\_app<br />\| top 10 client\_app by \_count|
|Imperva - Incapsula Web Application Firewall|Country Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control|\_sourceCategory={{Logsdatasource}}  AND "Bot Access Control"<br />\| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as Country nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count Country <br />\| top 10 Country by \_count|
|Imperva - Incapsula Web Application Firewall|Country Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\|count country\_code<br />\| top 10 country\_code by \_count|
|Imperva - Incapsula Web Application Firewall|Geo Lookup|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control|\_sourceCategory={{Logsdatasource}}  AND "Bot Access Control"<br />\|parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop <br />\| count by main\_client\_ip<br />\| lookup latitude, longitude from geo://location on ip = main\_client\_ip|
|Imperva - Incapsula Web Application Firewall|policy\_type|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse "SIEMintegration\|1\|1\|\*\|" as policy\_type <br />\| parse "sourceServiceName=\* " as site\_name<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count by policy\_type <br />\| top 10 policy\_type by \_count|
|Imperva - Incapsula Web Application Firewall|Source IP Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries|\_sourceCategory={{Logsdatasource}}  AND "Blocked Country" <br />\| parse "sourceServiceName=\* " as site\_name <br />\| parse "requestClientApplication=\* cs2" as user\_agent <br />\| parse "src=\* " as source\_ip <br />\| parse "dproc=\* cs6" as browser\_type<br />\| parse "ccode=\* " as Country<br />\| parse "cicode=\* " as City<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count source\_ip <br />\| top 10 source\_ip by \_count|
|Imperva - Incapsula Web Application Firewall|Source IP Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview|\_sourceCategory={{Logsdatasource}}  \| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count main\_client\_ip<br />\| top 10 main\_client\_ip by \_count|
|Imperva - Incapsula Web Application Firewall|Source IP Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control|\_sourceCategory={{Logsdatasource}}  AND "Bot Access Control"<br />\| parse "fileId=\* " as ID nodrop <br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count main\_client\_ip<br />\| top 10 main\_client\_ip by \_count|
|Imperva - Incapsula Web Application Firewall|Threat Table based on Client IP|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries|\_sourceCategory={{Logsdatasource}} <br />\| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop <br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=main\_client\_ip<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by main\_client\_ip, malicious\_confidence, Actor, \_source, label\_name, browser\_type, attack\_type, rule\_name, Country\_code, server\_ip, server\_port, client\_app, Method, post\_body, URL, user\_agent<br />|
|Imperva - Incapsula Web Application Firewall|Top Applied ADR Rules|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview|\_sourceCategory={{Logsdatasource}}  AND cs10<br />\| parse "cs10=[\*] cs10Label" as adr\_rule<br />\| parse "sourceServiceName=\* " as site\_name<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count  adr\_rule <br />\| top 10 adr\_rule by \_count|
|Imperva - Incapsula Web Application Firewall|URL Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count url <br />\| top 10 url by \_count|
|Imperva - Incapsula Web Application Firewall|User Agents Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF BOT - Access Control|\_sourceCategory={{Logsdatasource}}  AND "Bot Access Control"<br />\| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count user\_agent <br />\| top 10 user\_agent by \_count|
|Imperva - Incapsula Web Application Firewall|user\_agent Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Blocked Countries|\_sourceCategory={{Logsdatasource}}  AND "Blocked Country" <br />\| parse "sourceServiceName=\* " as site\_name <br />\| parse "requestClientApplication=\* cs2" as user\_agent <br />\| parse "src=\* " as source\_ip <br />\| parse "dproc=\* cs6" as browser\_type<br />\| parse "ccode=\* " as Country<br />\| parse "cicode=\* " as City<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count user\_agent<br />\| top 10 user\_agent by \_count|
|Imperva - Incapsula Web Application Firewall|user\_agent Top Values|Logs|Installed Apps/Imperva - Incapsula Web Application Firewall/Imperva - Incapsula WAF - Overview|\_sourceCategory={{Logsdatasource}} <br />\| parse "fileId=\* " as ID nodrop<br />\| parse "src=\* " as main\_client\_ip nodrop<br />\| parse "caIP=\* " as additional\_client\_ip nodrop<br />\| parse "requestClientApplication=\* cs2" as user\_agent nodrop<br />\| parse "request=\* " as URL nodrop<br />\| parse "tag=\* " as ref\_id nodrop<br />\| parse "ccode=\* " as country\_code nodrop<br />\| parse "cicode=\* " as City nodrop<br />\| parse "ccode=[\*] " as country\_code nodrop<br />\| parse "app=\* " as Protocol nodrop<br />\| parse "deviceExternalId=\* " as request\_id nodrop<br />\| parse "ref=\* " as Referrer nodrop<br />\| parse "requestMethod=\* " as Method nodrop<br />\| parse "cn1=\* " as http\_status\_code nodrop<br />\| parse "xff=\* " as X\_Forwarded\_For nodrop<br />\| parse "in=\* " as content\_length nodrop<br />\| parse "suid=\* " as account\_id nodrop<br />\| parse "Customer=\* " as account\_name nodrop<br />\| parse "siteid=\* " as site\_id nodrop<br />\| parse "sourceServiceName=\* " as site\_name nodrop<br />\| parse "act=\* " as request\_result nodrop<br />\| parse "postbody=\* " as post\_body nodrop<br />\| parse "start=\* " as request\_start\_time nodrop<br />\| parse "sip=\* " as server\_ip nodrop<br />\| parse "spt=\* " as server\_port nodrop<br />\| parse "qstr=\* " as query\_string nodrop<br />\| parse "cs1=\* " as captcha\_support nodrop<br />\| parse "cs2=\* cs2" as js\_support nodrop<br />\| parse "cs3=\* cs3" as cookies\_support nodrop<br />\| parse "cs4=\* cs4" as visitor\_id nodrop<br />\| parse "cs5=\* cs5" as Debug nodrop<br />\| parse "cs6=\* cs6" as client\_app<br />\| parse "cs7=\* cs7" as Latitude nodrop<br />\| parse "cs8=\* cs8" as Longitude nodrop<br />\| parse "cs9=\* cs9" as rule\_name nodrop<br />\| parse "filePermission=\* " as attack\_id nodrop<br />\| parse "fileType=\* " as attack\_type nodrop<br />\| parse "dproc=\* cs6" as browser\_type nodrop<br />\| where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\| count user\_agent <br />\| top 10 user\_agent by \_count|

