# CrowdStrike - Falcon Endpoint Protection

## Searches

### Log Searches

- **Active Sensors**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **API Client Events**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Authentication Operations**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Authentication Operations - One Day Time Comparison**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Authentication Operations Over Time**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Blocked Detections**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Breakdown by Operation Name**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Closed Incidents**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events 
- **Create User Event**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Date of Last Incident**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events 
- **Detection Based on Command Line Execution**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Detection by Host**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Detection by Severity**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Detection by Tactic**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Detection by User**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Detection Count**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Detection Distribution by Tactic**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Detection Summary**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Detection Summary by Severity and Tactic**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Detection Update Events - Outlier**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Detections by Objective**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Detections for the Past 7 Days**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Distribution of Detections by Technique**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Event Type Distribution**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Events - One Day Time Comparison**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Events Over Time**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Failed Events**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Failed User Login Events**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **FER Crowdstrike Falcon - ActivityAuditEvent**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - ActivityAuditEvent 
- **FER Crowdstrike Falcon - DetectionSummaryEvent**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - DetectionSummaryEvent 
- **FER Crowdstrike Falcon - IncidentSummaryEvent**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - IncidentSummaryEvent 
- **FER Crowdstrike Falcon - IncidentSummaryEvent timestamp conversions**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - IncidentSummaryEvent timestamp conversions 
- **FER Crowdstrike Falcon - RemoteResponseSession**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - RemoteResponseSession 
- **File Based Detections**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Geo Location of Authentication Events**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Geo Location of Detection Status Update Events**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update 
- **Grant User Role Events**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **High Severity Detections**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/High Severity Detections 
- **High Severity Detections by Host**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/High Severity Detections by Host 
- **High Severity Detections by User**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/High Severity Detections by User 
- **High Severity Trending IOCs**: from Search: Installed Apps/CrowdStrike - Falcon Endpoint Protection/High Severity Trending IOCs 
- **Incident Average Duration**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events 
- **Incident Start, End, Duration**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events 
- **Login Events - Outlier**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Open Incidents**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events 
- **Operation Name**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update 
- **Operation Name - OneDay TimeComparison**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Parent Incident Count by Day**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events 
- **Quarantined Files**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update 
- **Quarantined Files Count**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update 
- **Requested Auth Secret Reset Event**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Severity**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **SHA and MD5 Based Detections**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Success 2FA Authenticate Events**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication 
- **Successful User Login Events**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview 
- **Top Incident FineScore by Parent Incident**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events 
- **Trending IOCs**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections 
- **Update Group**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update 
- **Update Policy**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update 
- **User Auth Without 2FA**: from Dashboard: Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|CrowdStrike - Falcon Endpoint Protection|Active Sensors|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.SensorId" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, sensor\_id nodrop<br />\| timeslice 1d<br />\| count\_distinct (sensor\_id) by \_timeslice<br />\| fillmissing timeslice(1d)|
|CrowdStrike - Falcon Endpoint Protection|API Client Events|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent 	CreateAPIClient<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| parse regex "name\\",\\s\*\\"ValueString\\":\\s\*\\"(?\<name\>.+?)\\""<br />\| parse regex "scope\\(s\\)\\",\\s\*\\"ValueString\\":\\s\*\\"(?\<scope\>.+?)\\""<br />\| count as count by operation\_time, operation\_name, src\_user, name,scope, success|
|CrowdStrike - Falcon Endpoint Protection|Authentication Operations|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| count by operation\_name <br />\| sort by \_count |
|CrowdStrike - Falcon Endpoint Protection|Authentication Operations - One Day Time Comparison|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}  AuthActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| count as count by operation\_name   <br />\| compare with timeshift 1d as vs\_yesterday<br />|
|CrowdStrike - Falcon Endpoint Protection|Authentication Operations Over Time|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| timeslice 3h<br />\| count by \_timeslice, operation\_name<br />\| transpose row \_timeslice column operation\_name|
|CrowdStrike - Falcon Endpoint Protection|Blocked Detections|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\| json "event.PatternDispositionFlags.ProcessBlocked" as isProcessBlocked<br />\| where isProcessBlocked="true" <br />\| count as count by detection\_URL, severity\_name, tactic, technique, objective, detect\_desc, IOC\_value, file\_name, computer\_name, user\_name<br />\| sort by detection\_URL|
|CrowdStrike - Falcon Endpoint Protection|Breakdown by Operation Name|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   UserActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\| count by operation\_name<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|Closed Incidents|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","metadata.eventCreationTime","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, eventCreationTime, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop<br />\| parse "/inc:\*:" as incID nodrop<br />\| where eventtype matches "IncidentSummaryEvent"<br />\| where state matches "closed"<br />\| count|
|CrowdStrike - Falcon Endpoint Protection|Create User Event|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent 	createUser<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| where success="true"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| json "event.AuditKeyValues[0].ValueString" as target\_user<br />\| count as count by operation\_time, operation\_name, src\_user, target\_user, user\_ip|
|CrowdStrike - Falcon Endpoint Protection|Date of Last Incident|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","metadata.eventCreationTime","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, eventCreationTime, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop<br />\| parse "/inc:\*\\"," as incidentID nodrop<br />\| IncidentEndTime\*1000 as IncidentEndTime\_ms<br />\| toLong(IncidentEndTime\_ms) as IncidentEndTime\_long<br />\| formatDate(IncidentEndTime\_long, "MM-dd-yyyy HH:mm") as endtime<br />\| withtime endtime <br />\| most\_recent(endtime\_withtime)|
|CrowdStrike - Falcon Endpoint Protection|Detection Based on Command Line Execution|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\| json   "event.ParentImageFileName", "event.ParentCommandLine", "event.GrandparentImageFileName", "event.GrandparentCommandLine" as  ParentImageFileName, ParentCommandLine, GrandparentImageFileName, GrandparentCommandLine<br />\| count by detection\_URL, severity\_name, cmd\_line, ParentImageFileName, ParentCommandLine, GrandparentImageFileName, GrandparentCommandLine|
|CrowdStrike - Falcon Endpoint Protection|Detection by Host|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"<br />\| count as count by computer\_name<br />\| sort by count |
|CrowdStrike - Falcon Endpoint Protection|Detection by Severity|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}" <br />\| timeslice 1d<br />\| count by \_timeslice, severity\_name<br />\| sort by \_count<br />\| transpose row \_timeslice column severity\_name|
|CrowdStrike - Falcon Endpoint Protection|Detection by Tactic|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"  <br />\| timeslice 1d<br />\| count by \_timeslice, tactic<br />\| transpose row \_timeslice column tactic|
|CrowdStrike - Falcon Endpoint Protection|Detection by User|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"  <br />\| count by user\_name<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|Detection Count|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"  <br />\| count\_distinct (detect\_id)|
|CrowdStrike - Falcon Endpoint Protection|Detection Distribution by Tactic|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| count by tactic<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|Detection Summary|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIm nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\| count by detection\_URL, severity\_name, tactic, technique, objective, detect\_desc, IOC\_value, file\_name, computer\_name, user\_name<br />\| sort by detection\_URL|
|CrowdStrike - Falcon Endpoint Protection|Detection Summary by Severity and Tactic|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}  detectionsummaryevent<br />\| json field=\_raw "event.SeverityName", "event.Tactic", "event.Technique" as severity, tactic, technique<br />\| count as count by severity, tactic, technique<br />\| if (severity matches "Critical","1",severity) as severity\_rank<br />\| if (severity matches "High","2",severity\_rank) as severity\_rank<br />\| if (severity matches "Medium","3",severity\_rank) as severity\_rank<br />\| if (severity matches "Low","4",severity\_rank) as severity\_rank<br />\| sort by severity\_rank asc<br />\| fields severity, tactic, technique, count|
|CrowdStrike - Falcon Endpoint Protection|Detection Update Events - Outlier|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   UserActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\| timeslice 1h <br />\| count by \_timeslice <br />\| fillmissing timeslice(1h)<br />\| outlier \_count|
|CrowdStrike - Falcon Endpoint Protection|Detections by Objective|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| count by objective<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|Detections for the Past 7 Days|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess nodrop<br />\| timeslice 1d<br />\| count\_distinct (detect\_id) by \_timeslice, severity\_name<br />\| fillmissing timeslice(1d)<br />\| transpose row \_timeslice column severity\_name|
|CrowdStrike - Falcon Endpoint Protection|Distribution of Detections by Technique|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| count by technique<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|Event Type Distribution|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| count by event\_type<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|Events - One Day Time Comparison|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| count by event\_type<br />\| compare with timeshift 1d|
|CrowdStrike - Falcon Endpoint Protection|Events Over Time|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| timeslice 1h<br />\| count by \_timeslice, event\_type<br />\| transpose row \_timeslice column event\_type|
|CrowdStrike - Falcon Endpoint Protection|Failed Events|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent 	<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="false"<br />\| count as count by operation\_time, operation\_name, src\_user, user\_ip|
|CrowdStrike - Falcon Endpoint Protection|Failed User Login Events|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent (userAuthenticate or twoFactorAuthenticate)<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="false"<br />\| count by operation\_time, operation\_name, src\_user, user\_ip|
|CrowdStrike - Falcon Endpoint Protection/Parsers/FERs|FER Crowdstrike Falcon - ActivityAuditEvent|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - ActivityAuditEvent|\_sourceCategory={{Logsdatasource}}  \*ActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time nodrop<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time nodrop|
|CrowdStrike - Falcon Endpoint Protection/Parsers/FERs|FER Crowdstrike Falcon - DetectionSummaryEvent|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - DetectionSummaryEvent|\_sourceCategory={{Logsdatasource}}  DetectionSummaryEvent<br />\| json field=\_raw "metadata.eventType" as event\_type<br />\| where event\_type = "DetectionSummaryEvent"<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess nodrop|
|CrowdStrike - Falcon Endpoint Protection/Parsers/FERs|FER Crowdstrike Falcon - IncidentSummaryEvent|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - IncidentSummaryEvent|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop|
|CrowdStrike - Falcon Endpoint Protection/Parsers/FERs|FER Crowdstrike Falcon - IncidentSummaryEvent timestamp conversions|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - IncidentSummaryEvent timestamp conversions|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","metadata.eventCreationTime","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, eventCreationTime, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop<br />\| parse "/inc:\*:" as incID nodrop<br />\| where eventtype matches "IncidentSummaryEvent"<br />\| IncidentStartTime\*1000 as IncidentStartTime\_ms<br />\| IncidentEndTime\*1000 as IncidentEndTime\_ms<br />\| eventCreationTime\*1000 as eventCreationTime\_ms<br />\| toLong(IncidentStartTime\_ms) as IncidentStartTime\_long<br />\| toLong(IncidentEndTime\_ms) as IncidentEndTime\_long<br />\| toLong(eventCreationTime\_ms) as eventCreationTime\_long<br />\| formatDate(IncidentStartTime\_long, "MM-dd-yyyy HH:mm:ss") as starttime<br />\| formatDate(IncidentEndTime\_long, "MM-dd-yyyy HH:mm:ss") as endtime<br />\| formatDate(eventCreationTime\_long,"MM-dd-yyyy HH:mm:ss") as creationtime<br />\| now() as currentTime\_epoch<br />//\| formatDate(currentTime\_epoch, "MM-dd-yyyy HH:mm:ss") as currenttime<br />|
|CrowdStrike - Falcon Endpoint Protection/Parsers/FERs|FER Crowdstrike Falcon - RemoteResponseSession|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/Parsers/FERs/FER Crowdstrike Falcon - RemoteResponseSession|\_sourceCategory={{Logsdatasource}}   RemoteResponseSession\*<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| json field=\_raw "event.SessionId","event.HostnameField", "event.UserName", "event.Commands", "event.StartTimestamp", "event.EndTimestamp" as sessionID, hosname, user\_name, command, starttime1, endtime1 nodrop|
|CrowdStrike - Falcon Endpoint Protection|File Based Detections|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\| where  !isNull(file\_name)<br />\| count as count by detection\_URL, file\_name, file\_path<br />\| sort by detection\_URL|
|CrowdStrike - Falcon Endpoint Protection|Geo Location of Authentication Events|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}  AuthActivityAuditEvent <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = user\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|CrowdStrike - Falcon Endpoint Protection|Geo Location of Detection Status Update Events|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update|\_sourceCategory={{Logsdatasource}}   UserActivityAuditEvent <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, audit\_values<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and event\_type matches "{{event\_type}}" and event\_time matches "{{event\_time}}" and service\_name matches "{{service\_name}}" and customer\_id matches "{{customer\_id}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = user\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|CrowdStrike - Falcon Endpoint Protection|Grant User Role Events|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent grantUserRoles<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\| parse regex "roles\\",\\s\*\\"ValueString\\":\\s\*\\"(?\<updated\_roles\>.+?)\\""<br />\| parse regex "target\_name\\",\\s\*\\"ValueString\\":\\s\*\\"(?\<target\_user\>.+?)\\""<br />\| count as count by operation\_time, operation\_name, src\_user, target\_user, updated\_roles|
|CrowdStrike - Falcon Endpoint Protection|High Severity Detections|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/High Severity Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\|where severity\_name = "High"<br />\|count by detection\_URL, severity\_name, tactic, technique, objective, detect\_desc, IOC\_value, file\_name, computer\_name, user\_name<br />\| sort by detection\_URL|
|CrowdStrike - Falcon Endpoint Protection|High Severity Detections by Host|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/High Severity Detections by Host|\_sourceCategory={{Logsdatasource}}  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\|where severity\_name = "High"<br />\|count by computer\_name<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|High Severity Detections by User|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/High Severity Detections by User|\_sourceCategory={{Logsdatasource}}  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\|where severity\_name = "High"<br />\|count by user\_name<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|High Severity Trending IOCs|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/High Severity Trending IOCs|\_sourceCategory={{Logsdatasource}}  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\|where severity\_name = "High"<br />\|count by IOC\_Ttype, IOC\_value<br />\| topk(5,\_count) by IOC\_Ttype|
|CrowdStrike - Falcon Endpoint Protection|Incident Average Duration|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","metadata.eventCreationTime","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, eventCreationTime, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop<br />\| parse "/inc:\*\\"," as incidentID nodrop<br />\| where eventtype matches "IncidentSummaryEvent"<br />\| IncidentStartTime\*1000 as IncidentStartTime\_ms<br />\| IncidentEndTime\*1000 as IncidentEndTime\_ms<br />\| eventCreationTime\*1000 as eventCreationTime\_ms<br />\| toLong(IncidentStartTime\_ms) as IncidentStartTime\_long<br />\| toLong(IncidentEndTime\_ms) as IncidentEndTime\_long<br />\| toLong(eventCreationTime\_ms) as eventCreationTime\_long<br />\| formatDate(IncidentStartTime\_long, "MM-dd-yyyy HH:mm:ss") as starttime<br />\| formatDate(IncidentEndTime\_long, "MM-dd-yyyy HH:mm:ss") as endtime<br />\| formatDate(eventCreationTime\_long,"MM-dd-yyyy HH:mm:ss") as creationtime<br />\| IncidentEndTime\_ms-IncidentStartTime\_ms as duration\_ms<br />\| duration\_ms/1000 as duration\_sec<br />\| avg(duration\_sec)|
|CrowdStrike - Falcon Endpoint Protection|Incident Start, End, Duration|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","metadata.eventCreationTime","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, eventCreationTime, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop<br />\| parse "/inc:\*\\"," as incidentID nodrop<br />\| where eventtype matches "IncidentSummaryEvent"<br />\| IncidentStartTime\*1000 as IncidentStartTime\_ms<br />\| IncidentEndTime\*1000 as IncidentEndTime\_ms<br />\| eventCreationTime\*1000 as eventCreationTime\_ms<br />\| toLong(IncidentStartTime\_ms) as IncidentStartTime\_long<br />\| toLong(IncidentEndTime\_ms) as IncidentEndTime\_long<br />\| toLong(eventCreationTime\_ms) as eventCreationTime\_long<br />\| formatDate(IncidentStartTime\_long, "MM-dd-yyyy HH:mm:ss") as starttime<br />\| formatDate(IncidentEndTime\_long, "MM-dd-yyyy HH:mm:ss") as endtime<br />\| formatDate(eventCreationTime\_long,"MM-dd-yyyy HH:mm:ss") as creationtime<br />\| IncidentEndTime\_ms-IncidentStartTime\_ms as duration\_ms<br />\| duration\_ms/1000 as duration\_sec<br />\| tourl(FalconHostLink, incidentID, "Falcon Incident ", "") as url<br />\| count by state, duration\_sec, lateralmovement, finescore, url, starttime, endtime<br />\| fields state, duration\_sec, lateralmovement, finescore, url, starttime, endtime<br />\| sort by starttime asc|
|CrowdStrike - Falcon Endpoint Protection|Login Events - Outlier|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent (userAuthenticate or twoFactorAuthenticate)<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| timeslice 1h <br />\| count by \_timeslice <br />\| fillmissing timeslice(1h)<br />\| outlier \_count|
|CrowdStrike - Falcon Endpoint Protection|Open Incidents|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","metadata.eventCreationTime","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, eventCreationTime, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop<br />\| parse "/inc:\*:" as incID nodrop<br />\| where eventtype matches "IncidentSummaryEvent"<br />\| where state matches "open"<br />\| count|
|CrowdStrike - Falcon Endpoint Protection|Operation Name|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update|\_sourceCategory={{Logsdatasource}}  UserActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, audit\_values<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and event\_type matches "{{event\_type}}" and event\_time matches "{{event\_time}}" and service\_name matches "{{service\_name}}" and customer\_id matches "{{customer\_id}}"<br />\| count by operation\_name<br />\| sort by \_count|
|CrowdStrike - Falcon Endpoint Protection|Operation Name - OneDay TimeComparison|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   UserActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\| count by operation\_name<br />\| compare with timeshift 1d|
|CrowdStrike - Falcon Endpoint Protection|Parent Incident Count by Day|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","metadata.eventCreationTime","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, eventCreationTime, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop<br />\| parse "/inc:\*:\*\\"," as parent\_incident,incident\_update<br />\| parse "/inc:\*\\"," as incidentID nodrop<br />\| where eventtype matches "IncidentSummaryEvent"<br />\| timeslice 1d<br />\| count by \_timeslice, parent\_incident<br />\| transpose row \_timeslice column parent\_incident|
|CrowdStrike - Falcon Endpoint Protection|Quarantined Files|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update|\_sourceCategory={{Logsdatasource}}   UserActivityAuditEvent quarantined action\_taken<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, audit\_values<br />\| where operation\_name="quarantined\_file\_update"  <br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and event\_type matches "{{event\_type}}" and event\_time matches "{{event\_time}}" and service\_name matches "{{service\_name}}" and customer\_id matches "{{customer\_id}}"<br />\| parse regex field=audit\_values "\\"ValueString\\":\\"(?\<file\_id\>.+)\\",\\"Key\\":\\"quarantined\_file\_id\\"" <br />\| count as count by file\_id<br />\| sort by count |
|CrowdStrike - Falcon Endpoint Protection|Quarantined Files Count|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update|\_sourceCategory={{Logsdatasource}}   UserActivityAuditEvent quarantined action\_taken<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, audit\_values<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and event\_type matches "{{event\_type}}" and event\_time matches "{{event\_time}}" and service\_name matches "{{service\_name}}" and customer\_id matches "{{customer\_id}}"<br />\| where operation\_name="quarantined\_file\_update"  <br />\| count  |
|CrowdStrike - Falcon Endpoint Protection|Requested Auth Secret Reset Event|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent 	resetAuthSecret<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\| json "event.AuditKeyValues[0].ValueString" as target\_user<br />\| count as count by operation\_time, operation\_name, src\_user, target\_user, user\_ip|
|CrowdStrike - Falcon Endpoint Protection|Severity|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"  <br />\| count by severity\_name|
|CrowdStrike - Falcon Endpoint Protection|SHA and MD5 Based Detections|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.SHA256String", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, sha256string, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\| count as count by detection\_URL, sha256string, md5\_string<br />\| sort by detection\_URL|
|CrowdStrike - Falcon Endpoint Protection|Success 2FA Authenticate Events|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent 	twoFactorAuthenticate<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| where success="true"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| count as count by operation\_time, operation\_name, src\_user, user\_ip|
|CrowdStrike - Falcon Endpoint Protection|Successful User Login Events|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Overview|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent (userAuthenticate or twoFactorAuthenticate)<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| where event\_type matches "{{event\_type}}" and customer\_id matches "{{customer\_id}}"<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\| count by operation\_time, operation\_name, src\_user, user\_ip|
|CrowdStrike - Falcon Endpoint Protection|Top Incident FineScore by Parent Incident|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Incident Summary Events|\_sourceCategory={{Logsdatasource}}  IncidentSummaryEvent<br />\| json field=\_raw "metadata.eventType","metadata.eventCreationTime","event.FineScore","event.LateralMovement", "event.IncidentStartTime", "event.IncidentEndTime", "event.FalconHostLink", "event.State" as eventType, eventCreationTime, FineScore, LateralMovement, IncidentStartTime, IncidentEndTime, FalconHostLink, State nodrop<br />\| parse "/inc:\*:\*\\"," as parent\_incident,incident\_update<br />\| parse "/inc:\*\\"," as incidentID nodrop<br />\| where eventtype matches "IncidentSummaryEvent"<br />\| max(FineScore) as max by parent\_incident|
|CrowdStrike - Falcon Endpoint Protection|Trending IOCs|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detections|\_sourceCategory={{Logsdatasource}}   DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme nodrop<br />\| where tactic matches "{{tactic}}" and technique matches "{{technique}}" and objective matches "{{objective}}" and computer\_name matches "{{computer\_name}}" and user\_name matches "{{user\_name}}" and customer\_id matches "{{customer\_id}}" and machine\_domain matches "{{machine\_domain}}"  and detect\_desc matches "{{detect\_desc}}" and severity\_name matches "{{severity\_name}}"<br />\| count as count by IOC\_Ttype, IOC\_value<br />\| topk(5,count) by IOC\_Ttype<br />\| \_rank as rank|
|CrowdStrike - Falcon Endpoint Protection|Update Group|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update|\_sourceCategory={{Logsdatasource}}   UserActivityAuditEvent <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, changed\_values<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and event\_type matches "{{event\_type}}" and event\_time matches "{{event\_time}}" and service\_name matches "{{service\_name}}" and customer\_id matches "{{customer\_id}}"<br />\| where operation\_name="update\_group"  <br />\| count as count by event\_time, operation\_name, src\_user, changed\_values|
|CrowdStrike - Falcon Endpoint Protection|Update Policy|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Detection Status Update|\_sourceCategory={{Logsdatasource}}   UserActivityAuditEvent <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, changed\_values<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and event\_type matches "{{event\_type}}" and event\_time matches "{{event\_time}}" and service\_name matches "{{service\_name}}" and customer\_id matches "{{customer\_id}}"<br />\| where operation\_name="update\_policy"  <br />\| count as count by event\_time, operation\_name, src\_user|
|CrowdStrike - Falcon Endpoint Protection|User Auth Without 2FA|Logs|Installed Apps/CrowdStrike - Falcon Endpoint Protection/CrowdStrike Falcon - Authentication|\_sourceCategory={{Logsdatasource}}   AuthActivityAuditEvent userAuthenticate<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| where src\_user matches "{{src\_user}}" and operation\_name matches "{{operation\_name}}" and success matches "{{success}}"<br />\| where success="true"<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| count by operation\_time, operation\_name, src\_user, user\_ip|

