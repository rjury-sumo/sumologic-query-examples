# Azure Database for MySQL

## Searches

### Log Searches

- **Connections  by Loction**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections 
- **Crash Recovery Attempts Over Time**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs 
- **Disconnection Events**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Distribution  by Operation Type (Read, Write and Delete)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations 
- **Distribution by Operations**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations 
- **Distribution by Status**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations 
- **Drop Database Statements**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Drop Table Statements**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Error Details**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Error Log Type Over Time**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs 
- **Errors by DB Instance**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Errors Count**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs 
- **Excessive  Slow Queries Over Time**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries 
- **Excessive Slow Queries by Host**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries 
- **Failed Policy Events**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations 
- **Log Reduce**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs 
- **Queries by IP**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Recent Delete Operations**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations 
- **Recent Disconnect Logs**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections 
- **Recent Recommendation Events**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations 
- **Recent Write Operations**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations 
- **Requests by DB Instance**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Requests by Error Code**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Requests by Event Type**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Server Start and Shutdown Events Over Time**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs 
- **Slow Queries Over Time**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries 
- **Stopped Servers**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs 
- **Top 10 Excessive Slow Queries by Frequency**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries 
- **Top 10 Hosts Firing Slow Queries**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries 
- **Top 10 IPs**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Top 10 IPs Firing Slow Queries**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries 
- **Top 10 operations that caused the most errors**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations 
- **Top 10 Slow Queries by Average Execution Time**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries 
- **Top 10 Users Firing Slow Queries**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries 
- **Top Errors**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs 
- **Top Users with Excuted Queries**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Top Warnings**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs 
- **Total Failed Policy Events**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations 
- **Total Recommendation Events**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations 
- **Total Success Policy Events**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations 
- **Total Success Policy Events**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations 
- **Users / Applications by Operation type**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations

### Metric Searches

- **Aborted Connections**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections 
- **Active Connections**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections 
- **Average HA Replication Lag (Seconds)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Replication 
- **Average HA Replication Lag (Seconds)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Replication 
- **Average Replication Lag (Seconds)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Replication 
- **Average Replication Lag (Seconds)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Replication 
- **Connections**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections 
- **Create Database Count by Instance**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Create Statements**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Create Table Count by Instance**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Drop Database Count by Instance**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Drop Statements**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Drop Table Count by Instance**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Executed SQL Statements**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Max Backup Storage Used (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Backup Storage Used (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Binlog Storage (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Binlog Storage (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max CPU (%)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance 
- **Max CPU (%)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance 
- **Max Data File Size (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Data File Size (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max IO Consumption  (%)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance 
- **Max IO Consumption (%)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance 
- **Max Memory (%)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance 
- **Max Memory (%)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance 
- **Max Other Storage (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Other Storage (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Storage (%)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Storage (%)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Storage Limit (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Storage Used vs Limit (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Storage utilization  (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max Storage utilization  (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max System Tablespace Size (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Max System Tablespace Size (MB)**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview 
- **Performance Overview**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Queries**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections 
- **Queries Executed**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview 
- **Queries executed vs Slow Queries**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries 
- **Slow Queries**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance 
- **Slow Queries Count**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance 
- **Total Connections**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections 
- **Total Queries**: from Dashboard: Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Azure Database for MySQL|Aborted Connections|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=aborted\_connections  statistic=total \| quantize using sum \| sum by resource\_group , resource\_name |
|Azure Database for MySQL|Active Connections|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=active\_connections  statistic=maximum \| quantize using max \| max by resource\_group, resource\_name |
|Azure Database for MySQL|Average HA Replication Lag (Seconds)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Replication|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=HA\_replication\_lag statistic=maximum \| quantize using avg \| avg by resource\_name|
|Azure Database for MySQL|Average HA Replication Lag (Seconds)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Replication|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=HA\_replication\_lag statistic=maximum \| quantize using avg \| avg by resource\_group, resource\_name|
|Azure Database for MySQL|Average Replication Lag (Seconds)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Replication|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=replication\_lag  statistic=maximum \| quantize using avg \| avg by resource\_group, resource\_name|
|Azure Database for MySQL|Average Replication Lag (Seconds)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Replication|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=replication\_lag  statistic=maximum \| quantize using avg \| avg by resource\_name|
|Azure Database for MySQL|Connections|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=total\_connections  statistic=total \| quantize using sum \| sum|
|Azure Database for MySQL|Connections  by Loction|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "category", "properties.ip", "properties.event\_class" as category, request\_ip, event\_class<br />\| where category="MySqlAuditLogs" and event\_class="connection\_log"<br />\| count by request\_ip<br />\| lookup latitude, longitude from geo://location on ip = request\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) as count by latitude, longitude|
|Azure Database for MySQL|Crash Recovery Attempts Over Time|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "Starting crash recovery"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| \_sourceHost as Host<br />\| timeslice 1h<br />\| count as recovery\_attempts by \_timeslice|
|Azure Database for MySQL|Create Database Count by Instance|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Com\_create\_db statistic=total \| quantize using sum \| sum by resource\_group, resource\_name|
|Azure Database for MySQL|Create Statements|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Com\_create\_\* statistic=total \| quantize using sum \| sum by metric, resource\_group, resource\_name|
|Azure Database for MySQL|Create Table Count by Instance|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Com\_create\_table statistic=total \| quantize using sum \| sum by resource\_group, resource\_name|
|Azure Database for MySQL|Disconnection Events|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "time", "category", "properties.event\_class", "properties.replication\_set\_role", "properties.event\_subclass", "properties.user", "properties.db", "properties.is\_aad\_auth", "properties.error\_code" as time, category,<br />event\_class, replication\_set\_role, event\_subclass, user, db, is\_aad\_auth, error\_code nodrop<br />\| where category="MySqlAuditLogs" and event\_subclass="DISCONNECT"<br />\| count as Count by time, resource\_name, db, error\_code, replication\_set\_role, user, is\_aad\_auth, event\_class|
|Azure Database for MySQL|Distribution  by Operation Type (Read, Write and Delete)|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative"<br />\| "OTHERS" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by operationType<br />\| sort by \_count, operationType asc|
|Azure Database for MySQL|Distribution by Operations|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative" <br />\| parse field=operationName "\*/\*/\*" as provider\_name, resource\_type, operation\_name<br />\| count by operation\_name<br />\| order by \_count, operation\_name asc|
|Azure Database for MySQL|Distribution by Status|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category" as resultType, category<br />\| where category="Administrative" <br />\| count by resultType<br />\| order by \_count, resultType asc|
|Azure Database for MySQL|Drop Database Count by Instance|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Com\_drop\_db statistic=total \| quantize using sum \| sum by resource\_group, resource\_name|
|Azure Database for MySQL|Drop Database Statements|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "DROP DATABASE"<br />\| JSON "category", "properties.event\_time", "properties.error\_code", "properties.ip", "properties.user", "properties.sql\_text" as category, event\_time, error\_code, request\_ip, user, sql\_text<br />\| where category="MySqlAuditLogs"<br />\| count by event\_time, resource\_group, resource\_name, error\_code, request\_ip, user, sql\_text|
|Azure Database for MySQL|Drop Statements|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Com\_drop\_\* statistic=total \| quantize using sum \| sum by metric, resource\_group, resource\_name|
|Azure Database for MySQL|Drop Table Count by Instance|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Com\_create\_table statistic=total \| quantize using sum \| sum by resource\_group, resource\_name|
|Azure Database for MySQL|Drop Table Statements|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "DROP TABLE"<br />\| JSON "category", "properties.event\_time", "properties.error\_code", "properties.ip", "properties.user", "properties.sql\_text" as category, event\_time, error\_code, request\_ip, user, sql\_text<br />\| where category="MySqlAuditLogs"<br />\| count by event\_time, resource\_group, resource\_name, error\_code, request\_ip, user, sql\_text|
|Azure Database for MySQL|Error Details|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "time", "category", "properties.event\_class", "properties.replication\_set\_role", "properties.event\_subclass", "properties.user", "properties.db", "properties.is\_aad\_auth", "properties.error\_code" as time, category,<br />event\_class, replication\_set\_role, event\_subclass, user, db, is\_aad\_auth, error\_code nodrop<br />\| where category="MySqlAuditLogs" and event\_subclass="ERROR"<br />\| count as Count by time, resource\_name, db, error\_code, replication\_set\_role, user, is\_aad\_auth, event\_class|
|Azure Database for MySQL|Error Log Type Over Time|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} (Error or Warning or Note or Info or Information or DEBUG or CRITICAL)<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| where touppercase(ErrorLogtype) in ("ERROR", "WARNING", "NOTE", "INFO", "INFORMATION", "DEBUG", "CRITICAL")<br />\| timeslice 1h<br />\| count by \_timeslice, ErrorLogtype<br />\| transpose row \_timeslice column ErrorLogType|
|Azure Database for MySQL|Errors by DB Instance|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "category", "properties.db", "properties.event\_subclass" as category, db, event\_subclass<br />\| where category="MySqlAuditLogs" and event\_subclass="ERROR" and !isEmpty(db)<br />\| count by db|
|Azure Database for MySQL|Errors Count|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs|tenant\_name=\* subscription\_id=\* resource\_group=\* resource\_name=\* resource\_type=FLEXIBLESERVERS provider\_name=MICROSOFT.DBFORMYSQL location=\* "[ERROR]"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)"<br />\| where ErrorLogtype="ERROR"<br />\| count by resource\_group, resource\_name|
|Azure Database for MySQL|Excessive  Slow Queries Over Time|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "MySqlSlowLogs"<br />\| json "category", "properties.query\_time" as category, query\_time<br />\| where category="MySqlSlowLogs" and query\_time \> {{avg\_query\_time\_config}}<br />\| timeslice 1h<br />\| count as Count by \_timeslice|
|Azure Database for MySQL|Excessive Slow Queries by Host|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "MySqlSlowLogs"<br />\| json "category", "properties.host", "properties.query\_time" as category, host, query\_time<br />\| where category="MySqlSlowLogs" and !(host matches "\*localhost\*") and query\_time \> 15<br />\| count by host<br />\| order by \_count, host<br />\| limit 10|
|Azure Database for MySQL|Executed SQL Statements|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Com\_select statistic=total \| quantize using sum \| sum by metric|
|Azure Database for MySQL|Failed Policy Events|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} location={{location}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} resource\_name={{resource\_name}} Policy Failure<br />\| JSON "category", "resultType", "properties.message", "properties.resourceLocation", "properties.entity", "properties.policies" as category, resultType, message, resourceLocation, entity, policies<br />\| where category="Policy" and resultType="Failure"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count as Count by time, level, resultType, providers, resource\_group, resource\_name, location, policies|
|Azure Database for MySQL|Log Reduce|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} ("ERROR" or "CRITICAL") <br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| logreduce(mesg) by resource\_name limit=20<br />\| \_count as count \| fields -\_count \| sort by count, signature asc|
|Azure Database for MySQL|Max Backup Storage Used (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=backup\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Backup Storage Used (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=backup\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Binlog Storage (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=binlog\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Binlog Storage (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=binlog\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max CPU (%)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=cpu\_percent  statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max CPU (%)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=cpu\_percent statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Data File Size (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=data\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Data File Size (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=data\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max IO Consumption  (%)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=io\_consumption\_percent statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max IO Consumption (%)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=io\_consumption\_percent statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Memory (%)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=memory\_percent statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Memory (%)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=memory\_percent statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Other Storage (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=others\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Other Storage (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=others\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Storage (%)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=storage\_percent statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Storage (%)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=storage\_percent statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Storage Limit (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=storage\_limit statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Storage Used vs Limit (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=storage\_used statistic=maximum \| quantize using max \| max|
|Azure Database for MySQL|Max Storage utilization  (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=storage\_used  statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max Storage utilization  (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=storage\_used  statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max System Tablespace Size (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=ibdata1\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Max System Tablespace Size (MB)|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Storage Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=ibdata1\_storage\_used statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Performance Overview|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=cpu\_percent  statistic=maximum \| quantize using max \| max by resource\_group, resource\_name|
|Azure Database for MySQL|Queries|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Queries  statistic=total \| quantize using sum \| sum by resource\_group, resource\_name |
|Azure Database for MySQL|Queries by IP|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "category", "properties.ip", "properties.sql\_text", "properties.event\_class" as category, request\_ip, sql\_text, event\_class<br />\| where category="MySqlAuditLogs" and event\_class="table\_access\_log"<br />\| count by sql\_text, request\_ip<br />\| lookup latitude, longitude from geo://location on ip = request\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) as count by sql\_text, latitude, longitude|
|Azure Database for MySQL|Queries Executed|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Queries  statistic=total \| quantize using sum \| sum by resource\_group, resource\_name|
|Azure Database for MySQL|Queries executed vs Slow Queries|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=queries statistic=total \| quantize using sum \| sum by metric|
|Azure Database for MySQL|Recent Delete Operations|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}} provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "properties.entity", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, entity, identity\_claims\_name, authmethods nodrop<br />\| where resultType in ("Accept", "Success") and category="Administrative" and toUppercase(operationName) matches /DELETE/ <br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message, entity<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure Database for MySQL|Recent Disconnect Logs|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "category", "properties.ip", "properties.user", "properties.db", "properties.host", "properties.event\_subclass" as category, request\_ip, request\_user, request\_db, host, event\_subclass<br />\| where category="MySqlAuditLogs" and event\_subclass="DISCONNECT" and !isEmpty(request\_ip) and !isEmpty(request\_user) and !isEmpty(request\_db)<br />\| count by resource\_grpup, resource\_name, request\_ip, request\_user, request\_db, host|
|Azure Database for MySQL|Recent Recommendation Events|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} resource\_name={{resource\_name}} "Recommendation"<br />\| JSON "category", "operationName", "resultType", "properties.recommendationName", "properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationResourceLink" as category, operationName, resultType, recommendationName, recommendationCategory, recommendationImpact, recommendationResourceLink <br />\| where category="Recommendation"<br />\| parse field=operationName "\*/\*/\*/\*" as provider, category, operation\_name, action nodrop<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count as Count by time, operation\_name, resource\_name, resultType, recommendationName, recommendationCategory, recommendationImpact, recommendationResourceLink|
|Azure Database for MySQL|Recent Write Operations|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}} provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']"  as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, identity\_claims\_name, authmethods nodrop<br />\| where category="Administrative" and resultType in ("Accept", "Success") and toUppercase(operationName) matches /WRITE/<br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure Database for MySQL|Requests by DB Instance|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "category", "properties.db" as category, db<br />\| where category="MySqlAuditLogs" and !isEmpty(db)<br />\| count by db|
|Azure Database for MySQL|Requests by Error Code|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "category", "properties.error\_code", "properties.event\_subclass" as category, error\_code, event\_subclass<br />\| where category="MySqlAuditLogs" and event\_subclass="ERROR"<br />\| count by error\_code<br />\| sort by \_count, error\_code|
|Azure Database for MySQL|Requests by Event Type|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "category", "properties.event\_subclass" as category, event\_subclass<br />\| where category="MySqlAuditLogs"<br />\| count by event\_subclass<br />\| sort by \_count, event\_subclass|
|Azure Database for MySQL|Server Start and Shutdown Events Over Time|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} mysqld ("ready for connections." or "Shutdown complete" or "Terminated." or "Normal shutdown" or "Shutting down" or "starting as process")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| if (ErrorMsg matches "\*ready for connections.\*", "Up","Unknown") as server\_status<br />\| if (ErrorMsg matches "\*Terminated.\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Normal shutdown\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutting down\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutdown complete\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*starting as process\*", "Starting",server\_status) as server\_status<br />\| timeslice 15m<br />\| count by \_timeslice, server\_status<br />\| transpose row \_timeslice column server\_status|
|Azure Database for MySQL|Slow Queries|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=slow\_queries statistic=total \| quantize using sum \| sum by resource\_group, resource\_name|
|Azure Database for MySQL|Slow Queries Count|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Performance|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=slow\_queries statistic=total \| quantize using sum \| sum by resource\_group, resource\_name|
|Azure Database for MySQL|Slow Queries Over Time|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "MySqlSlowLogs"<br />\| json "category" as category<br />\| where category="MySqlSlowLogs"<br />\| timeslice 1h<br />\| count as Count by \_timeslice|
|Azure Database for MySQL|Stopped Servers|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} mysqld ("ready for connections."  or "Terminated." or "Shutdown complete" or "Normal shutdown")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| if (ErrorMsg matches "\*ready for connections.\*", "Up","Unknown") as server\_status<br />\| if (ErrorMsg matches "\*Terminated.\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Normal shutdown\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutdown complete\*", "Down", server\_status) as server\_status<br />\| \_sourceHost as Host<br />\| timeslice 100s<br />\| withtime server\_status \| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by Host, db\_cluster<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS Z") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60)) as since\_mins \| format("%.2f", since\_mins) as since\_minutes<br />\| concat ("Since ", since\_minutes, " minutes") as remark<br />//\| where server\_status != "Up"<br />\| fields - m\_time, since\_mins, since\_minutes <br />\| fields Host, event\_time, server\_status, remark|
|Azure Database for MySQL|Top 10 Excessive Slow Queries by Frequency|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "MySqlSlowLogs"<br />\| json "category", "properties.query\_time", "properties.sql\_text" as category, query\_time, sql\_text<br />\| where category="MySqlSlowLogs"<br />\| fields sql\_text, query\_time, resource\_group, resource\_name<br />\| count as Count, avg(query\_time) as avg\_query\_time group by resource\_group, resource\_name, sql\_text<br />\| where avg\_query\_time \> {{avg\_query\_time\_config}}<br />\| order by Count desc<br />\| limit 10|
|Azure Database for MySQL|Top 10 Hosts Firing Slow Queries|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "MySqlSlowLogs"<br />\| json "category", "properties.host" as category, host<br />\| where category="MySqlSlowLogs" and !(host matches "\*localhost\*")<br />\| count by host<br />\| order by \_count, host<br />\| limit 10|
|Azure Database for MySQL|Top 10 IPs|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} MySqlAuditLogs<br />\| json "category", "properties.ip" as category, IP<br />\| where category="MySqlAuditLogs" and !isEmpty(IP)<br />\| replace(IP, "::ffff:", "") as IP<br />\| count as Count by IP<br />\| sort by count desc<br />\| limit 10|
|Azure Database for MySQL|Top 10 IPs Firing Slow Queries|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "MySqlSlowLogs"<br />\| json "category", "properties.host" as category, host<br />\| where category="MySqlSlowLogs" and !(host matches "\*localhost\*")<br />\| parse field=host "\*[\*] @  [\*]" as db\_user1, db\_user2, request\_ip<br />\| count by request\_ip<br />\| order by \_count, request\_ip<br />\| limit 10|
|Azure Database for MySQL|Top 10 operations that caused the most errors|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}} provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative<br />\| json "resultType", "operationName", "properties.statusMessage", "category"  as resultType, operationName, failureMessage, category nodrop<br />\| parse field=operationname "\*/\*/\*" as provider\_name, resource\_type, operation nodrop<br />\| where category="Administrative" and (resultType="Failure" or resultType="Unknown")<br />\| if (isBlank(failureMessage), "Unknown Error", failureMessage) as failureMessage<br />\| count as Count by resource\_name, operation, failureMessage<br />\| order by Count <br />\| limit 10|
|Azure Database for MySQL|Top 10 Slow Queries by Average Execution Time|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "MySqlSlowLogs"<br />\| json "category", "properties.query\_time", "properties.sql\_text" as category, query\_time, sql\_text<br />\| where category="MySqlSlowLogs"<br />\| fields sql\_text, query\_time, resource\_group, resource\_name<br />\| avg(query\_time) as avg\_query\_time group by resource\_group, resource\_name, sql\_text<br />\| where avg\_query\_time \> 2<br />\| order by avg\_query\_time desc<br />\| limit 10|
|Azure Database for MySQL|Top 10 Users Firing Slow Queries|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Slow Queries|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "MySqlSlowLogs"<br />\| json "category", "properties.host" as category, host<br />\| where category="MySqlSlowLogs" and !(host matches "\*localhost\*")<br />\| parse field=host "\*[\*] @  [\*]" as db\_user1, db\_user2, request\_ip<br />\| count by db\_user1<br />\| order by \_count, db\_user1<br />\| limit 10|
|Azure Database for MySQL|Top Errors|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "[ERROR]"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)"<br />\| where ErrorLogtype="ERROR"<br />\| parse field=ErrorMsg "[\*] [\*] \*" as err\_code, subsystem, error\_message nodrop<br />\| if (!isEmpty(error\_message), error\_message, ErrorMsg) as error\_message<br />\| count as frequency by error\_message, err\_code, subsystem<br />\| sort by frequency, error\_message asc<br />\| limit 30|
|Azure Database for MySQL|Top Users with Excuted Queries|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}}<br />MySqlAuditLogs<br />\| json "category", "properties.user", "properties.sql\_text" as category, request\_user, sql\_text<br />\| where category="MySqlAuditLogs" and !isEmpty(sql\_text)<br />\| count by request\_user|
|Azure Database for MySQL|Top Warnings|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL -  Error Logs|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} "[Warning]"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)"<br />\| where ErrorLogtype="Warning" <br />\| parse field=ErrorMsg "[\*] [\*] \*" as err\_code, subsystem, ErrorMessage nodrop<br />\| if (!isEmpty(ErrorMessage), ErrorMessage, ErrorMsg) as warning\_message<br />\| count as frequency by warning\_message, err\_code, subsystem<br />\| sort by frequency, warning\_message asc<br />\| limit 30|
|Azure Database for MySQL|Total Connections|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=total\_connections  statistic=total \| quantize using sum \| sum by resource\_name |
|Azure Database for MySQL|Total Failed Policy Events|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} resource\_name={{resource\_name}} Policy Failure<br />\| JSON "category", "resultType" as category, resultType<br />\| where category="Policy" and resultType="Failure"<br />\| count as Count|
|Azure Database for MySQL|Total Queries|Metrics|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Connections|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_name={{resource\_name}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} location={{location}} metric=Queries  statistic=total \| quantize using sum \| sum by resource\_group, resource\_name |
|Azure Database for MySQL|Total Recommendation Events|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} resource\_name={{resource\_name}} "Recommendation"<br />\| JSON "category"<br />\| where category="Recommendation"<br />\| count |
|Azure Database for MySQL|Total Success Policy Events|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} resource\_name={{resource\_name}} Policy <br />\| JSON "category", "resultType" as category, resultType<br />\| where category="Policy" and (resultType="Success" or resultType="Accept")<br />\| count as Count|
|Azure Database for MySQL|Total Success Policy Events|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} location={{location}} resource\_type={{resource\_type}} provider\_name={{provider\_name}} resource\_name={{resource\_name}} Policy Success<br />\| JSON "category", "resultType", "properties.message", "properties.resourceLocation", "properties.entity", "properties.policies" as category, resultType, message, resourceLocation, entity, policies<br />\| where category="Policy" and (resultType="Success" or resultType="Accept")<br />\| parse field=entity "/subscriptions/\*/resourceGroups/\*/providers/\*/\*/\*" as subscription\_id, resource\_group, providers, virtualMachineScaleSets, aks nodrop<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count as Count by time, level, resultType, resource\_group, resource\_name, location, policies|
|Azure Database for MySQL|Users / Applications by Operation type|Logs|Installed Apps/Azure Database for MySQL/Azure Database for MySQL - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid nodrop<br />\| where resultType in ("Accept", "Success") and category="Administrative" <br />\| if (idtyp =="user", name, appid) as name<br />\| "Others" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by name, operationType<br />\| transpose row name column operationType|

