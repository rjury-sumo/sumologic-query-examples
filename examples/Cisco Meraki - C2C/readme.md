# Cisco Meraki - C2C

## Searches

### Log Searches

- **Air Marshal Overview**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **API Enabled Organizations**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Blocked Connections**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Blocked Events**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Clients Summary**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Configuration Change Frequency**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Configuration Change Summary**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Event Types Breakdown**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Events by Activity**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Events by SSID**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Events by Type**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Files Scanned**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Geo Locations of Attack Origins**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Geo Locations of Attack Targets**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Geo Locations of Clients**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Geo Locations of Top Threats**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Infected Hosts**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Malicious Files**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Network Activity**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Network Summary**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Networks by Product Type**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Networks by Time Zone**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Organizations by Cloud Region**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Organizations Summary**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Recent Events**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Risky Geo Locations**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Threat Severity**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Threats Trend Analysis**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Top 10 Active Admins**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Top 10 Network Activity Channels**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Top Clients by Events**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Total Activities**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal 
- **Total Admin Logs**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Total Events**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events 
- **Total Network Logs**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview 
- **Total Organizations**: from Dashboard: Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Cisco Meraki - C2C/Networks|Air Marshal Overview|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   wiredMacs<br />\| json "ssid", "channels", "firstSeen", "lastSeen", "wiredMacs", "wiredVlans", "wiredLastSeen","bssids[\*].bssid","bssids[\*].detectedBy[\*].device","bssids[\*].detectedBy[\*].rssi" as ssid, channels, first\_seen, last\_seen, wired\_macs, wired\_vlans, wired\_last\_seen,bssids,devices,rssi\_values nodrop<br /><br />\| where !isNull(ssid)<br />\| count by ssid, channels,bssids,devices,rssi\_values,first\_seen, last\_seen, wired\_macs, wired\_vlans, wired\_last\_seen<br />\| limit 100<br />\| fields -\_count|
|Cisco Meraki - C2C/Organizations|API Enabled Organizations|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   licensing<br />\| json "id", "name", "url", "api.enabled", "licensing.model", "cloud.region.name", "management.details.[\*].name", "management.details.[\*].value" as id, name, url, enabled, model, region, management\_name, management\_value nodrop<br /><br />\| if(isnull(url) or url == "","",tourl(url, name)) as name<br />\| where enabled == "true"<br />\| count\_distinct(id) as counts by id, name<br />\| fields -counts|
|Cisco Meraki - C2C/Organizations|Blocked Connections|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| where action  matches "Blocked"<br />\| where isValidIPv4(src\_ip) or isValidIPv6(src\_ip)<br />\| where !isNull(src\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip \| count as frequency by src\_ip, dest\_ip, dest\_port, country\_code, country\_name, region, city<br />\| sort by frequency<br />\| limit 100|
|Cisco Meraki - C2C/Organizations|Blocked Events|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| where action == "Blocked"<br />\| count|
|Cisco Meraki - C2C/Networks|Clients Summary|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   networkId<br />\| json "occurredAt", "networkId", "type", "description", "category", "clientId", "clientDescription", "clientMac", "deviceSerial", "deviceName", "ssidNumber", "eventData.radio", "eventData.vap", "eventData.client\_mac", "eventData.client\_ip", "eventData.channel", "eventData.rssi", "eventData.aid" as occurred\_at, network\_id, type, description, category, client\_id, client\_description, clientMac, deviceSerial, deviceName, ssidNumber, radio, vap, client\_mac, client\_ip, channel, rssi, aid nodrop<br /><br />// filters<br />\| where type matches "{{event\_type}}"<br /><br />\| count as frequency by client\_id, client\_description, client\_mac, client\_ip<br />\| sort by frequency<br />\| limit 100<br />\| fields - frequency|
|Cisco Meraki - C2C/Organizations|Configuration Change Frequency|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   adminId<br />\| json "ts", "adminName", "adminEmail", "adminId", "page", "label" as date\_time, adminName, adminEmail, adminId, page, label nodrop<br /><br />//filters<br />\| parse "\\"label\\": \\"\*/" as activity<br />\| if(activity matches "\*PUT\*","Update", if(activity matches "\*DELETE\*","Delete", if(activity matches "\*POST\*","Add","-"))) as activity<br /><br />\| timeslice 1d<br />\| count(adminId) by \_timeslice, activity<br />\| fillmissing timeslice, values all in activity<br />\| transpose row \_timeslice column activity|
|Cisco Meraki - C2C/Organizations|Configuration Change Summary|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   adminId<br />\| json "ts", "adminName", "adminEmail", "adminId", "page", "label" as date\_time, admin\_name, admin\_email, admin\_id, page, label nodrop<br /><br />//filters<br />\| parse "\\"label\\": \\"\*/" as activity<br />\| if(activity matches "\*PUT\*","Update", if(activity matches "\*DELETE\*","Delete", if(activity matches "\*POST\*","Add","-"))) as activity<br /><br />\| formatDate(toLong(\_messageTime), "yyyy-MM-dd HH:mm:ss") as date\_time<br />\| count by date\_time, activity, label, admin\_name, admin\_email, admin\_id<br />\| sort by date\_time<br />\| fields -\_count|
|Cisco Meraki - C2C/Networks|Event Types Breakdown|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   networkId<br />\| json "occurredAt", "networkId", "type", "description", "category", "clientId", "clientDescription", "clientMac", "deviceSerial", "deviceName", "ssidNumber", "eventData.radio", "eventData.vap", "eventData.client\_mac", "eventData.client\_ip", "eventData.channel", "eventData.rssi", "eventData.aid" as occurredAt, networkId, type, description, category, clientId, clientDescription, clientMac, deviceSerial, deviceName, ssidNumber, radio, vap, client\_mac, client\_ip, channel, rssi, aid nodrop<br /><br />// filters<br />\| where type matches "{{event\_type}}"<br /><br />\| count as frequency by type<br />\| sort by frequency|
|Cisco Meraki - C2C/Organizations|Events by Activity|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   adminId<br />\| json "ts", "adminName", "adminEmail", "adminId", "page", "label" as ts, admin\_name, admin\_email, admin\_id, page, label nodrop<br /><br />\| parse "\\"label\\": \\"\*/" as activity<br />\| if(activity matches "\*PUT\*","Update", if(activity matches "\*DELETE\*","Delete", if(activity matches "\*POST\*","Add","-"))) as activity<br /><br /><br />\| count as frequency by activity<br />\| sort by frequency|
|Cisco Meraki - C2C/Networks|Events by SSID|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal| \_sourceCategory={{Logsdatasource}}   networkId<br />\| json "occurredAt", "networkId", "type", "description", "category", "clientId", "clientDescription", "clientMac", "deviceSerial", "deviceName", "ssidNumber", "eventData.radio", "eventData.vap", "eventData.client\_mac", "eventData.client\_ip", "eventData.channel", "eventData.rssi", "eventData.aid" as occurredAt, networkId, type, description, category, client\_id, client\_description, clientMac, deviceSerial, deviceName, ssid, radio, vap, client\_mac, client\_ip, channel, rssi, aid nodrop<br /><br />// filters<br />\| where type matches "{{event\_type}}"<br /><br />\| count as frequency by client\_id, client\_description, ssid<br />\| sort by frequency<br />\| limit 10|
|Cisco Meraki - C2C/Organizations|Events by Type|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| count as frequency by event\_type<br />\| sort by frequency|
|Cisco Meraki - C2C/Organizations|Files Scanned|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| count as frequency by file\_type<br />\| sort by frequency<br />\| limit 10|
|Cisco Meraki - C2C/Organizations|Geo Locations of Attack Origins|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| where action  matches "Blocked"<br /><br />\| count as frequency by event\_type, src\_ip<br />\| where isValidIPv4(src\_ip) or isValidIPv6(src\_ip)<br />\| where !isNull(src\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip|
|Cisco Meraki - C2C/Organizations|Geo Locations of Attack Targets|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| where action  matches "Blocked"<br />\| count as frequency by event\_type, dest\_ip<br />\| where isValidIPv4(dest\_ip) or isValidIPv6(dest\_ip)<br />\| where !isNull(dest\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = dest\_ip|
|Cisco Meraki - C2C/Networks|Geo Locations of Clients|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   networkId<br />\| json "occurredAt", "networkId", "type", "description", "category", "clientId", "clientDescription", "clientMac", "deviceSerial", "deviceName", "ssidNumber", "eventData.radio", "eventData.vap", "eventData.client\_mac", "eventData.client\_ip", "eventData.channel", "eventData.rssi", "eventData.aid" as occurred\_at, network\_id, type, description, category, client\_id, client\_description, clientMac, deviceSerial, deviceName, ssidNumber, radio, vap, client\_mac, client\_ip, channel, rssi, aid nodrop<br /><br />// filters<br />\| where type matches "{{event\_type}}"<br /><br />\| count as frequency by network\_id, client\_ip<br />\| where isValidIPv4(client\_ip) or isValidIPv6(client\_ip)<br />\| where !isNull(client\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip|
|Cisco Meraki - C2C/Organizations|Geo Locations of Top Threats|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   <br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as ts, eventType, clientName, clientMac, clientIp, srcIp, destIp, protocol, uri, canonicalName, destinationPort, fileType, fileSizeBytes, disposition, action, deviceMac, priority, classification, message, signature, ruleId nodrop<br /><br />\| where action == "Blocked"<br /><br />\| count as frequency by eventType,srcIp<br />\| where isValidIPv4(srcIp) or isValidIPv6(srcIp)<br />\| where !isNull(srcIp)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = srcIp|
|Cisco Meraki - C2C/Organizations|Infected Hosts|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| where action == "Blocked"<br /><br />\| if (!isEmpty(dest\_ip), dest\_ip, src\_ip) as ip<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip \| count by date\_time, ip, country\_code, country\_name, event\_type, message \| fields -\_count \| limit 100|
|Cisco Meraki - C2C/Organizations|Malicious Files|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| where action  matches "Blocked"<br /><br />\| count as frequency by file\_type, disposition, event\_type<br />\| sort by frequency<br />\| limit 100|
|Cisco Meraki - C2C/Networks|Network Activity|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   networkId<br />\| json "occurredAt", "networkId", "type", "description", "category", "clientId", "clientDescription", "clientMac", "deviceSerial", "deviceName", "ssidNumber", "eventData.radio", "eventData.vap", "eventData.client\_mac", "eventData.client\_ip", "eventData.channel", "eventData.rssi", "eventData.aid" as occurredAt, networkId, type, description, category, clientId, clientDescription, clientMac, deviceSerial, deviceName, ssidNumber, radio, vap, client\_mac, client\_ip, channel, rssi, aid nodrop<br /><br />// filters<br />\| where type matches "{{event\_type}}"<br /><br />\| count\_distinct(networkId)|
|Cisco Meraki - C2C/Organizations|Network Summary|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   organizationId<br />\| json "id", "organizationId", "name", "productTypes", "timeZone", "tags", "enrollmentString", "url", "notes", "isBoundToConfigTemplate" as id, organization\_id, name, product\_types, time\_zone, tags, enrollment\_string, url, notes, is\_bound\_to\_config\_template nodrop<br /><br />\| if(isnull(url) or url == "","",tourl(url, name)) as name<br />\| count\_distinct(id) as counts by id, organization\_id, name, product\_types, time\_zone, tags, enrollment\_string, notes, is\_bound\_to\_config\_template<br />\| fields -counts<br />\| limit 100|
|Cisco Meraki - C2C/Organizations|Networks by Product Type|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   organizationId<br />\| json "id", "organizationId", "name", "productTypes", "timeZone", "tags", "enrollmentString", "url", "notes", "isBoundToConfigTemplate" as id, organization\_id, name, product\_types, time\_zone, tags, enrollment\_string, url, notes, is\_bound\_to\_config\_template nodrop<br /><br />\| extract field=product\_types "\\"?(?\<product\_types\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| count\_distinct(id) as frequency by product\_types<br />\| sort by frequency<br />\| limit 10|
|Cisco Meraki - C2C/Organizations|Networks by Time Zone|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   organizationId<br />\| json "id", "organizationId", "name", "productTypes", "timeZone", "tags", "enrollmentString", "url", "notes", "isBoundToConfigTemplate" as id, organization\_id, name, product\_types, time\_zone, tags, enrollment\_string, url, notes, is\_bound\_to\_config\_template nodrop<br /><br />\| count\_distinct(id) as frequency by time\_zone<br />\| sort by frequency<br />\| limit 10|
|Cisco Meraki - C2C/Organizations|Organizations by Cloud Region|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   licensing<br />\| json "id", "name", "url", "api.enabled", "licensing.model", "cloud.region.name", "management.details.[\*].name", "management.details.[\*].value" as id, name, url, enabled, model, region, management\_name, management\_value nodrop<br /><br />\| count\_distinct(id) as frequency by region<br />\| sort by frequency<br />\| limit 10|
|Cisco Meraki - C2C/Organizations|Organizations Summary|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   licensing<br />\| json "id", "name", "url", "api.enabled", "licensing.model", "cloud.region.name", "management.details.[\*].name", "management.details.[\*].value" as id, name, url, enabled, model, region, management\_name, management\_value nodrop<br /><br />\| if(isnull(url) or url == "","",tourl(url, name)) as name<br />\| count\_distinct(id) as counts by id, name, enabled, model, region, management\_name, management\_value<br />\| fields -counts|
|Cisco Meraki - C2C/Networks|Recent Events|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   networkId<br />\| json "occurredAt", "networkId", "type", "description", "category", "clientId", "clientDescription", "clientMac", "deviceSerial", "deviceName", "ssidNumber", "eventData.radio", "eventData.vap", "eventData.client\_mac", "eventData.client\_ip", "eventData.channel", "eventData.rssi", "eventData.aid" as occurred\_at, network\_id, type, description, category, client\_id, client\_description, clientMac, deviceSerial, deviceName, ssidNumber, radio, vap, client\_mac, client\_ip, channel, rssi, aid nodrop<br /><br />// filters<br />\| where type matches "{{event\_type}}"<br /><br />\| formatDate(toLong(\_messageTime), "yyyy-MM-dd HH:mm:ss") as occurred\_at<br />\| count by occurred\_at, client\_id, client\_description, client\_mac, network\_id, radio, vap, aid<br />\| fields -\_count<br />\| limit 100|
|Cisco Meraki - C2C/Networks|Risky Geo Locations|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   networkId<br />\| json "occurredAt", "networkId", "type", "description", "category", "clientId", "clientDescription", "clientMac", "deviceSerial", "deviceName", "ssidNumber", "eventData.radio", "eventData.vap", "eventData.client\_mac", "eventData.client\_ip", "eventData.channel", "eventData.rssi", "eventData.aid" as occurred\_at, network\_id, type, description, category, client\_id, client\_description, clientMac, deviceSerial, deviceName, ssidNumber, radio, vap, client\_mac, client\_ip, channel, rssi, aid nodrop<br /><br />//filters<br />\| where type matches "{{event\_type}}"<br /><br />\| count as frequency by network\_id, client\_ip<br />\| where isValidIPv4(client\_ip) or isValidIPv6(client\_ip)<br />\| where !isNull(client\_ip)<br />\| lookup latitude, longitude, country\_code from geo://location on ip = client\_ip<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isEmpty(country\_code)|
|Cisco Meraki - C2C/Organizations|Threat Severity|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| count as frequency by severity<br />\| sort by frequency|
|Cisco Meraki - C2C/Organizations|Threats Trend Analysis|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| where action  matches "Blocked"<br /><br />\| timeslice 1d<br />\| count by \_timeslice, event\_type<br />\| fillmissing timeslice, values all in event\_type<br />\| transpose row \_timeslice column event\_type|
|Cisco Meraki - C2C/Organizations|Top 10 Active Admins|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   adminId<br />\| json "ts", "adminName", "adminEmail", "adminId", "page", "label" as ts, admin\_name, admin\_email, admin\_id, page, label nodrop<br /><br />//filters<br /><br />\| count as frequency by admin\_id, admin\_name, admin\_email<br />\| sort by frequency<br />\| limit 10|
|Cisco Meraki - C2C/Networks|Top 10 Network Activity Channels|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   wiredMacs<br />\| json "ssid", "channels", "firstSeen", "lastSeen", "wiredMacs", "wiredVlans", "wiredLastSeen","bssids[\*].bssid","bssids[\*].detectedBy[\*].device","bssids[\*].detectedBy[\*].rssi" as ssid, channels, first\_seen, last\_seen, wired\_macs, wired\_vlans, wired\_last\_seen,bssids,devices,rssi\_values nodrop<br />\| extract field=channels "\\"?(?\<channel\>[\\d+]\*?)\\"?[,\\n\\]]" multi<br /><br />\| count as frequency by channel<br />\| sort by frequency<br />\| limit 10|
|Cisco Meraki - C2C/Organizations|Top Clients by Events|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| where isValidIPv4(client\_ip) or isValidIPv6(client\_ip)<br />\| where !isNull(client\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip \| count as frequency by client\_name, client\_ip, client\_mac,country\_code, country\_name, event\_type<br />\| sort by frequency<br />\| limit 100|
|Cisco Meraki - C2C/Networks|Total Activities|Logs|Installed Apps/Cisco Meraki - C2C/Networks/Cisco Meraki - Network Events and Air Marshal|\_sourceCategory={{Logsdatasource}}   wiredMacs<br />\| json "ssid", "channels", "firstSeen", "lastSeen", "wiredMacs", "wiredVlans", "wiredLastSeen","bssids[\*].bssid","bssids[\*].detectedBy[\*].device","bssids[\*].detectedBy[\*].rssi" as ssid, channels, first\_seen, last\_seen, wired\_macs, wired\_vlans, wired\_last\_seen,bssids,devices,rssi\_values nodrop<br />\| count|
|Cisco Meraki - C2C/Organizations|Total Admin Logs|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   adminId<br />\| json "ts", "adminName", "adminEmail", "adminId", "page", "label" as ts, admin\_name, admin\_email, admin\_id, page, label nodrop<br />\| count(admin\_id)|
|Cisco Meraki - C2C/Organizations|Total Events|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Appliance Security Events|\_sourceCategory={{Logsdatasource}}   eventType<br />\| json "ts", "eventType", "clientName", "clientMac", "clientIp", "srcIp", "destIp", "protocol", "uri", "canonicalName", "destinationPort", "fileType", "fileSizeBytes", "disposition", "action", "deviceMac", "priority", "classification", "message", "signature", "ruleId"  as date\_time, event\_type, client\_name, client\_mac, client\_ip, src\_ip, dest\_ip, protocol, uri, canonical\_name, dest\_port, file\_type, file\_size\_bytes, disposition, action, device\_mac, priority, classification, message, signature, rule\_id nodrop<br /><br />\| if(priority matches "1", "High", if(priority matches "2", "Medium", if(priority matches "3", "Low", if (priority matches "4", "Very Low", "-")))) as severity<br /><br />//filters<br />\| where event\_type matches "{{event\_type}}"<br />\| where client\_name matches "{{client\_name}}"<br />\| where severity matches "{{severity}}"<br /><br />\| count(event\_type)|
|Cisco Meraki - C2C/Organizations|Total Network Logs|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   organizationId<br />\| json "id", "organizationId", "name", "productTypes", "timeZone", "tags", "enrollmentString", "url", "notes", "isBoundToConfigTemplate" as id, organization\_id, name, product\_types, time\_zone, tags, enrollment\_string, url, notes, is\_bound\_to\_config\_template nodrop<br /><br />\| count\_distinct(id)|
|Cisco Meraki - C2C/Organizations|Total Organizations|Logs|Installed Apps/Cisco Meraki - C2C/Organizations/Cisco Meraki - Organization Overview|\_sourceCategory={{Logsdatasource}}   licensing<br />\| json "id", "name", "url", "api.enabled", "licensing.model", "cloud.region.name", "management.details.[\*].name", "management.details.[\*].value" as id, name, url, enabled, model, region, management\_name, management\_value nodrop<br /><br />\| count\_distinct(id)|

