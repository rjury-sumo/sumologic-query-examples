# Druva Cyber Resilience
## Sumo Logic App For: Druva Cyber Resilience
The Druva Cyber Resilience App for Sumo Logic is a comprehensive and powerful solution designed to enhance an organization's cybersecurity posture by providing real-time insights and actionable information through a set of intuitive and informative dashboards. Each dashboard within the app focuses on a specific aspect of cybersecurity and resilience, offering valuable insights into potential threats, as well as strategies to mitigate them effectively.
Docs Link: [Druva Cyber Resilience](https://help.sumologic.com/?cid=21234)

## Searches

### Log Searches

- **Admin Events by Type Over Time**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Admin Events Count**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Admin Events from High Risk Countries**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Admin Logins Success Ratio**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Alert Events**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Critical Events**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Curated Snapshots by Operations**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Curated Snapshots by Resource Type**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Curated Snapshots Count**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Data Access Events by Status**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events 
- **Data Access Events by Syslog Severity**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events 
- **Data Access Events by Type Over Time**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events 
- **Data Access Events Count**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events 
- **Data Access Events from High Risk Countries**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events 
- **Emergency Events**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Events by Area**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Events by Category Over Time**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Events by Syslog Severity**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Events Count**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Geo Locations of Admin Events**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Geo Locations of Data Access Events**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events 
- **Geo Locations of Ransomware Recoveries**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events 
- **Quarantined Events by Resource Type**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events 
- **Ransomware Recoveries by Syslog Severity**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events 
- **Ransomware Recoveries by Type Over Time**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events 
- **Ransomware Recoveries Count**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events 
- **Ransomware Recoveries from High Risk Countries**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events 
- **Recent Admin Events**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Recent Data Access Events**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events 
- **Recent Events**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Recent Ransomware Recoveries**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events 
- **Recent Unsual Data Activities**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities 
- **Top 10 Admins**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events 
- **Top 10 Event Types**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview 
- **Top 10 Resource Owners**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events 
- **Top 10 Resource Owners**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities 
- **Top 10 Resources**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events 
- **Top 10 Resources**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities 
- **Unusual Data Activities by Resource Type**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities 
- **Unusual Data Activities by Syslog Severity**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities 
- **Unusual Data Activities by Type Over Time**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities 
- **Unusual Data Activities Count**: from Dashboard: Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Druva Cyber Resilience|Admin Events by Type Over Time|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br />\| timeslice 1d<br />\| count by id,\_timeslice,type<br />\| count(id) as frequency by \_timeslice,type<br />\| fillmissing timeslice, values all in type<br />\| transpose row \_timeslice column type|
|Druva Cyber Resilience|Admin Events Count|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br />\| count by id<br />\| count|
|Druva Cyber Resilience|Admin Events from High Risk Countries|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br />\| where isValidIPv4(admin\_ip\_address) or isValidIPv6(admin\_ip\_address)<br />\| where !isNull(admin\_ip\_address)<br />\| if(isValidIPv4(admin\_ip\_address), if(!isPrivateIP(admin\_ip\_address),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by admin\_ip\_address<br />\| lookup latitude, longitude, country\_code from geo://location on ip = admin\_ip\_address<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isEmpty(country\_code)|
|Druva Cyber Resilience|Admin Logins Success Ratio|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br /><br />\| where !isEmpty(login\_result)<br />\| count by id,login\_result<br />\| count(id) as frequency by login\_result<br />\| sort by frequency|
|Druva Cyber Resilience|Alert Events|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where syslog\_severity matches("\*Alert\*")<br />\| count by id<br />\| count|
|Druva Cyber Resilience|Critical Events|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where syslog\_severity matches("\*Critical\*")<br />\| count by id<br />\| count|
|Druva Cyber Resilience|Curated Snapshots by Operations|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br />\| where type matches("\*Curated Snapshot\*")<br />\| parse "\\\\\\"Activity\\\\\\": \\\\\\"\*\\\\\\"" as activity nodrop<br /><br />\| count by id,activity<br />\| count(id) as frequency by activity<br />\| sort by frequency|
|Druva Cyber Resilience|Curated Snapshots by Resource Type|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br />\| where type matches("\*Curated Snapshot\*")<br />\| parse "\\\\\\"ResourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| count by id,resource\_type<br />\| count(id) as frequency by resource\_type<br />\| sort by frequency|
|Druva Cyber Resilience|Curated Snapshots Count|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br />\| where type matches ("\*Curated Snapshot\*")<br />\| count by id<br />\| count|
|Druva Cyber Resilience|Data Access Events by Status|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"status\\\\\\": \\\\\\"\*\\\\\\"" as status nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"targetLocation\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br />\| parse "\\\\\\"initiatorName\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_name nodrop<br /><br />\| where type matches "{{type}}"<br />\| where area matches "{{area}}"<br />\| where status matches "{{status}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br /><br />\| where category matches("\*Data Access\*")<br />\| count by id,status<br />\| count(id) as frequency by status<br />\| sort by frequency|
|Druva Cyber Resilience|Data Access Events by Syslog Severity|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"status\\\\\\": \\\\\\"\*\\\\\\"" as status nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"targetLocation\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br />\| parse "\\\\\\"initiatorName\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_name nodrop<br /><br />\| where type matches "{{type}}"<br />\| where area matches "{{area}}"<br />\| where status matches "{{status}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br /><br />\| where category matches("\*Data Access\*")<br />\| count by id,syslog\_severity<br />\| count(id) as frequency by syslog\_severity<br />\| sort by frequency|
|Druva Cyber Resilience|Data Access Events by Type Over Time|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"status\\\\\\": \\\\\\"\*\\\\\\"" as status nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"targetLocation\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br />\| parse "\\\\\\"initiatorName\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_name nodrop<br /><br />\| where type matches "{{type}}"<br />\| where area matches "{{area}}"<br />\| where status matches "{{status}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br /><br />\| where category matches("\*Data Access\*")<br />\| timeslice 1d<br />\| count by id,\_timeslice,type<br />\| count(id) as frequency by \_timeslice,type<br />\| fillmissing timeslice, values all in type<br />\| transpose row \_timeslice column type|
|Druva Cyber Resilience|Data Access Events Count|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"status\\\\\\": \\\\\\"\*\\\\\\"" as status nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"targetLocation\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br />\| parse "\\\\\\"initiatorName\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_name nodrop<br /><br />\| where type matches "{{type}}"<br />\| where area matches "{{area}}"<br />\| where status matches "{{status}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br /><br />\| where category matches("\*Data Access\*")<br />\| count by id<br />\| count|
|Druva Cyber Resilience|Data Access Events from High Risk Countries|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"status\\\\\\": \\\\\\"\*\\\\\\"" as status nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"targetLocation\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br />\| parse "\\\\\\"initiatorName\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_name nodrop<br />\| parse "\\\\\\"targetIP\\\\\\": \\\\\\"\*\\\\\\"" as target\_ip nodrop<br /><br />\| where type matches "{{type}}"<br />\| where area matches "{{area}}"<br />\| where status matches "{{status}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br /><br />\| where category matches("\*Data Access\*")<br />\| where isValidIPv4(target\_ip) or isValidIPv6(target\_ip)<br />\| where !isNull(target\_ip)<br />\| if(isValidIPv4(target\_ip), if(!isPrivateIP(target\_ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count by id,target\_ip<br />\| count(id) as frequency by target\_ip<br />\| lookup latitude,longitude,country\_code from geo://location on ip = target\_ip<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isEmpty(country\_code)|
|Druva Cyber Resilience|Emergency Events|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where syslog\_severity matches("\*Emergency\*")<br />\| count by id<br />\| count|
|Druva Cyber Resilience|Events by Area|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| count by id,area<br />\| count(id) as frequency by area<br />\| sort by frequency|
|Druva Cyber Resilience|Events by Category Over Time|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| timeslice 1d<br />\| count by id,\_timeslice,category<br />\| count(id) as frequency by \_timeslice,category<br />\| fillmissing timeslice, values all in category<br />\| transpose row \_timeslice column category<br />|
|Druva Cyber Resilience|Events by Syslog Severity|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| count by id,syslog\_severity<br />\| count(id) as frequency by syslog\_severity<br />\| sort by frequency|
|Druva Cyber Resilience|Events Count|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| count by id<br />\| count|
|Druva Cyber Resilience|Geo Locations of Admin Events|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br /><br />\| where isValidIPv4(admin\_ip\_address) or isValidIPv6(admin\_ip\_address)<br />\| where !isNull(admin\_ip\_address)<br />\| if(isValidIPv4(admin\_ip\_address), if(!isPrivateIP(admin\_ip\_address),true,false),true) as is\_public<br />\| where is\_public<br />\| count by id,admin\_ip\_address<br />\| count(id) as frequency by admin\_ip\_address<br />\| lookup latitude, longitude, country\_code from geo://location on ip = admin\_ip\_address|
|Druva Cyber Resilience|Geo Locations of Data Access Events|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"status\\\\\\": \\\\\\"\*\\\\\\"" as status nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"targetLocation\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br />\| parse "\\\\\\"initiatorName\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_name nodrop<br />\| parse "\\\\\\"targetIP\\\\\\": \\\\\\"\*\\\\\\"" as target\_ip nodrop<br /><br />\| where type matches "{{type}}"<br />\| where area matches "{{area}}"<br />\| where status matches "{{status}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br /><br />\| where category matches("\*Data Access\*")<br />\| where isValidIPv4(target\_ip) or isValidIPv6(target\_ip)<br />\| where !isNull(target\_ip)<br />\| if(isValidIPv4(target\_ip), if(!isPrivateIP(target\_ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count by id,target\_ip<br />\| count(id) as frequency by target\_ip<br />\| lookup latitude,longitude,country\_code from geo://location on ip = target\_ip|
|Druva Cyber Resilience|Geo Locations of Ransomware Recoveries|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceParent\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"mode\\\\\\": \\\\\\"\*\\\\\\"" as mode nodrop<br />\| parse "\\\\\\"state\\\\\\": \\\\\\"\*\\\\\\"" as state nodrop<br />\| parse "\\\\\\"action\\\\\\": \\\\\\"\*\\\\\\"" as action nodrop<br />\| parse "\\\\\\"ipAddress\\\\\\": \\\\\\"\*\\\\\\"" as ip\_address nodrop<br />\| parse "\\\\\\"initiatorID\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_id nodrop<br />\| parse "\\\\\\"resourcePlatform\\\\\\": \\\\\\"\*\\\\\\"" as resource\_platform nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Ransomware Recovery\*")<br /><br />\| where isValidIPv4(ip\_address) or isValidIPv6(ip\_address)<br />\| where !isNull(ip\_address)<br />\| if(isValidIPv4(ip\_address), if(!isPrivateIP(ip\_address),true,false),true) as is\_public<br />\| where is\_public<br />\| count by id,ip\_address<br />\| count(id) as frequency by ip\_address<br />\| lookup latitude,longitude,country\_code from geo://location on ip = ip\_address|
|Druva Cyber Resilience|Quarantined Events by Resource Type|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceParent\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"mode\\\\\\": \\\\\\"\*\\\\\\"" as mode nodrop<br />\| parse "\\\\\\"state\\\\\\": \\\\\\"\*\\\\\\"" as state nodrop<br />\| parse "\\\\\\"action\\\\\\": \\\\\\"\*\\\\\\"" as action nodrop<br />\| parse "\\\\\\"ipAddress\\\\\\": \\\\\\"\*\\\\\\"" as ip\_address nodrop<br />\| parse "\\\\\\"initiatorID\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_id nodrop<br />\| parse "\\\\\\"resourcePlatform\\\\\\": \\\\\\"\*\\\\\\"" as resource\_platform nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Ransomware Recovery\*")<br />\| count by id,resource\_type<br />\| count(id) as frequency by resource\_type<br />\| sort by frequency<br />|
|Druva Cyber Resilience|Ransomware Recoveries by Syslog Severity|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceParent\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"mode\\\\\\": \\\\\\"\*\\\\\\"" as mode nodrop<br />\| parse "\\\\\\"state\\\\\\": \\\\\\"\*\\\\\\"" as state nodrop<br />\| parse "\\\\\\"action\\\\\\": \\\\\\"\*\\\\\\"" as action nodrop<br />\| parse "\\\\\\"ipAddress\\\\\\": \\\\\\"\*\\\\\\"" as ip\_address nodrop<br />\| parse "\\\\\\"initiatorID\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_id nodrop<br />\| parse "\\\\\\"resourcePlatform\\\\\\": \\\\\\"\*\\\\\\"" as resource\_platform nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Ransomware Recovery\*")<br />\| count by id,syslog\_severity<br />\| count(id) as frequency by syslog\_severity<br />\| sort by frequency<br />|
|Druva Cyber Resilience|Ransomware Recoveries by Type Over Time|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceParent\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"mode\\\\\\": \\\\\\"\*\\\\\\"" as mode nodrop<br />\| parse "\\\\\\"state\\\\\\": \\\\\\"\*\\\\\\"" as state nodrop<br />\| parse "\\\\\\"action\\\\\\": \\\\\\"\*\\\\\\"" as action nodrop<br />\| parse "\\\\\\"ipAddress\\\\\\": \\\\\\"\*\\\\\\"" as ip\_address nodrop<br />\| parse "\\\\\\"initiatorID\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_id nodrop<br />\| parse "\\\\\\"resourcePlatform\\\\\\": \\\\\\"\*\\\\\\"" as resource\_platform nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Ransomware Recovery\*")<br /><br />\| timeslice 1d<br />\| count by id,\_timeslice,type<br />\| count(id) as frequency by \_timeslice,type<br />\| fillmissing timeslice, values all in type<br />\| transpose row \_timeslice column type|
|Druva Cyber Resilience|Ransomware Recoveries Count|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceParent\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"mode\\\\\\": \\\\\\"\*\\\\\\"" as mode nodrop<br />\| parse "\\\\\\"state\\\\\\": \\\\\\"\*\\\\\\"" as state nodrop<br />\| parse "\\\\\\"action\\\\\\": \\\\\\"\*\\\\\\"" as action nodrop<br />\| parse "\\\\\\"ipAddress\\\\\\": \\\\\\"\*\\\\\\"" as ip\_address nodrop<br />\| parse "\\\\\\"initiatorID\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_id nodrop<br />\| parse "\\\\\\"resourcePlatform\\\\\\": \\\\\\"\*\\\\\\"" as resource\_platform nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Ransomware Recovery\*")<br /><br />\| count by id<br />\| count|
|Druva Cyber Resilience|Ransomware Recoveries from High Risk Countries|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceParent\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"mode\\\\\\": \\\\\\"\*\\\\\\"" as mode nodrop<br />\| parse "\\\\\\"state\\\\\\": \\\\\\"\*\\\\\\"" as state nodrop<br />\| parse "\\\\\\"action\\\\\\": \\\\\\"\*\\\\\\"" as action nodrop<br />\| parse "\\\\\\"ipAddress\\\\\\": \\\\\\"\*\\\\\\"" as ip\_address nodrop<br />\| parse "\\\\\\"initiatorID\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_id nodrop<br />\| parse "\\\\\\"resourcePlatform\\\\\\": \\\\\\"\*\\\\\\"" as resource\_platform nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Ransomware Recovery\*")<br /><br />\| where isValidIPv4(ip\_address) or isValidIPv6(ip\_address)<br />\| where !isNull(ip\_address)<br />\| if(isValidIPv4(ip\_address), if(!isPrivateIP(ip\_address),true,false),true) as is\_public<br />\| where is\_public<br />\| count by id,ip\_address<br />\| count(id) as frequency by ip\_address<br />\| lookup latitude,longitude,country\_code from geo://location on ip = ip\_address<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isEmpty(country\_code)|
|Druva Cyber Resilience|Recent Admin Events|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br />\| formatDate(toLong(\_messageTime), "MM-dd-yyyy HH:mm:ss") as event\_time<br />\| count by id,event\_time,area,type,syslog\_severity,location,admin\_name,admin\_email,admin\_activity<br /><br />\| top 100 id,admin\_name,admin\_email,type,admin\_activity,syslog\_severity,location,area,event\_time by event\_time|
|Druva Cyber Resilience|Recent Data Access Events|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"status\\\\\\": \\\\\\"\*\\\\\\"" as status nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"files\\\\\\": \*," as affected\_files nodrop<br />\| parse "\\\\\\"targetLocation\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br />\| parse "\\\\\\"initiatorName\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_name nodrop<br /><br />\| where type matches "{{type}}"<br />\| where area matches "{{area}}"<br />\| where status matches "{{status}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br /><br />\| where category matches("\*Data Access\*")<br />\| formatDate(toLong(\_messageTime), "MM-dd-yyyy HH:mm:ss") as event\_time<br />\| count by id,event\_time,area,type,syslog\_severity,status,resource\_name,resource\_id,affected\_files,location,initiator\_name<br />\| top 100 id,initiator\_name,resource\_id,resource\_name,affected\_files,type,status,location,area,syslog\_severity,event\_time by event\_time|
|Druva Cyber Resilience|Recent Events|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| formatDate(toLong(\_messageTime), "MM-dd-yyyy HH:mm:ss") as event\_time<br />\| count by id,event\_time,area,category,type,syslog\_severity<br /><br />\| top 100 type,category,area,syslog\_severity,id,event\_time by event\_time|
|Druva Cyber Resilience|Recent Ransomware Recoveries|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceParent\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"mode\\\\\\": \\\\\\"\*\\\\\\"" as mode nodrop<br />\| parse "\\\\\\"state\\\\\\": \\\\\\"\*\\\\\\"" as state nodrop<br />\| parse "\\\\\\"action\\\\\\": \\\\\\"\*\\\\\\"" as action nodrop<br />\| parse "\\\\\\"ipAddress\\\\\\": \\\\\\"\*\\\\\\"" as ip\_address nodrop<br />\| parse "\\\\\\"initiatorID\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_id nodrop<br />\| parse "\\\\\\"resourcePlatform\\\\\\": \\\\\\"\*\\\\\\"" as resource\_platform nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Ransomware Recovery\*")<br /><br />\| formatDate(toLong(\_messageTime), "MM-dd-yyyy HH:mm:ss") as event\_time<br />\| count by id,event\_time,area,type,syslog\_severity,resource\_type,resource\_name,resource\_owner,mode,state,action,ip\_address,initiator\_id,resource\_platform<br />\| top 100 id,resource\_name,resource\_type,resource\_owner,mode,state,action,ip\_address,initiator\_id,resource\_platform,type,syslog\_severity,area,event\_time by event\_time<br />|
|Druva Cyber Resilience|Recent Unsual Data Activities|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"affectedSnapshot\\\\\\": \\\\\\"\*\\\\\\"" as affected\_snapshot nodrop<br />\| parse "\\\\\\"resourceParentName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"encryptedFiles\\\\\\": \*}" as encrypted\_files<br />\| parse "\\\\\\"updatedFiles\\\\\\": \*," as updated\_files<br />\| parse "\\\\\\"deletedFiles\\\\\\": \*," as deleted\_files<br />\| parse "\\\\\\"newFiles\\\\\\": \*," as new\_files<br />\| extract field=encrypted\_files "(?\<encrypted\_files\>\\d+.\*?)"<br />\| extract field=updated\_files "(?\<updated\_files\>\\d+.\*?)"<br />\| extract field=deleted\_files "(?\<deleted\_files\>\\d+.\*?)"<br />\| extract field=new\_files "(?\<new\_files\>\\d+.\*?)"<br />\| new\_files+updated\_files+deleted\_files+encrypted\_files as affected\_files<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Unusual Data Activity\*") or (category matches("\*Alerts & Notification\*"))<br />\| parse "\\\\\\"alertName\\\\\\": \\\\\\"\*\\\\\\"" as alert\_name nodrop<br />\| where isEmpty(alert\_name) or alert\_name matches("\*Unusual Data Activity\*")<br /><br />\| formatDate(toLong(\_messageTime), "MM-dd-yyyy HH:mm:ss") as event\_time<br />\| count by id,event\_time,area,type,category,syslog\_severity,resource\_type,resource\_name,resource\_id,resource\_owner,affected\_snapshot,affected\_files<br />\| top 100 id,resource\_id,resource\_name,resource\_owner,resource\_type,affected\_files,type,category,syslog\_severity,affected\_snapshot,area,event\_time by event\_time|
|Druva Cyber Resilience|Top 10 Admins|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Admin Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"adminName\\\\\\": \\\\\\"\*\\\\\\"" as admin\_name nodrop<br />\| parse "\\\\\\"adminEmail\\\\\\": \\\\\\"\*\\\\\\"" as admin\_email nodrop<br />\| parse "\\\\\\"adminIPAddress\\\\\\": \\\\\\"\*\\\\\\"" as admin\_ip\_address nodrop<br />\| parse "\\\\\\"adminActivity\\\\\\": \\\\\\"\*\\\\\\"" as admin\_activity nodrop<br />\| parse "\\\\\\"loginResult\\\\\\": \\\\\\"\*\\\\\\"" as login\_result nodrop<br />\| parse "\\\\\\"location\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where admin\_activity matches "{{admin\_activity}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Admin Event\*")<br />\| where !isEmpty(admin\_name)<br />\| where !isEmpty(admin\_email)<br />\| count by id,admin\_name,admin\_email<br />\| count(id) as frequency by admin\_name,admin\_email<br />\| sort by frequency<br />\| limit 10|
|Druva Cyber Resilience|Top 10 Event Types|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","None")))))))) as syslog\_severity<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where category matches "{{category}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| count by id,area,category,type<br />\| count as frequency by type,category,area<br />\| sort by frequency<br />\| limit 10|
|Druva Cyber Resilience|Top 10 Resource Owners|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Ransomware Recovery Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceParent\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"mode\\\\\\": \\\\\\"\*\\\\\\"" as mode nodrop<br />\| parse "\\\\\\"state\\\\\\": \\\\\\"\*\\\\\\"" as state nodrop<br />\| parse "\\\\\\"action\\\\\\": \\\\\\"\*\\\\\\"" as action nodrop<br />\| parse "\\\\\\"ipAddress\\\\\\": \\\\\\"\*\\\\\\"" as ip\_address nodrop<br />\| parse "\\\\\\"initiatorID\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_id nodrop<br />\| parse "\\\\\\"resourcePlatform\\\\\\": \\\\\\"\*\\\\\\"" as resource\_platform nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Ransomware Recovery\*")<br /><br />\| count by id,resource\_owner<br />\| count(id) as frequency by resource\_owner<br />\| sort by frequency<br />|
|Druva Cyber Resilience|Top 10 Resource Owners|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"affectedSnapshot\\\\\\": \\\\\\"\*\\\\\\"" as affected\_snapshot nodrop<br />\| parse "\\\\\\"resourceParentName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Unusual Data Activity\*") or (category matches("\*Alerts & Notification\*"))<br />\| parse "\\\\\\"alertName\\\\\\": \\\\\\"\*\\\\\\"" as alert\_name nodrop<br />\| where isEmpty(alert\_name) or alert\_name matches("\*Unusual Data Activity\*")<br /><br />\| count by id,resource\_owner<br />\| count(id) as frequency by resource\_owner<br />\| sort by frequency|
|Druva Cyber Resilience|Top 10 Resources|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Data Access Events|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"status\\\\\\": \\\\\\"\*\\\\\\"" as status nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"targetLocation\\\\\\": \\\\\\"\*\\\\\\"" as location nodrop<br />\| parse "\\\\\\"initiatorName\\\\\\": \\\\\\"\*\\\\\\"" as initiator\_name nodrop<br /><br />\| where type matches "{{type}}"<br />\| where area matches "{{area}}"<br />\| where status matches "{{status}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br /><br />\| where category matches("\*Data Access\*")<br />\| count by id,resource\_name,resource\_id<br />\| count(id) as frequency by resource\_id,resource\_name<br />\| sort by frequency<br />\| limit 10|
|Druva Cyber Resilience|Top 10 Resources|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"affectedSnapshot\\\\\\": \\\\\\"\*\\\\\\"" as affected\_snapshot nodrop<br />\| parse "\\\\\\"resourceParentName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Unusual Data Activity\*") or (category matches("\*Alerts & Notification\*"))<br />\| parse "\\\\\\"alertName\\\\\\": \\\\\\"\*\\\\\\"" as alert\_name nodrop<br />\| where isEmpty(alert\_name) or alert\_name matches("\*Unusual Data Activity\*")<br /><br />\| count by id,resource\_name<br />\| count(id) as frequency by resource\_name<br />\| sort by frequency|
|Druva Cyber Resilience|Unusual Data Activities by Resource Type|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"affectedSnapshot\\\\\\": \\\\\\"\*\\\\\\"" as affected\_snapshot nodrop<br />\| parse "\\\\\\"resourceParentName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Unusual Data Activity\*") or (category matches("\*Alerts & Notification\*"))<br />\| parse "\\\\\\"alertName\\\\\\": \\\\\\"\*\\\\\\"" as alert\_name nodrop<br />\| where isEmpty(alert\_name) or alert\_name matches("\*Unusual Data Activity\*")<br /><br />\| count by id,resource\_type<br />\| count(id) as frequency by resource\_type<br />\| sort by frequency|
|Druva Cyber Resilience|Unusual Data Activities by Syslog Severity|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"affectedSnapshot\\\\\\": \\\\\\"\*\\\\\\"" as affected\_snapshot nodrop<br />\| parse "\\\\\\"resourceParentName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Unusual Data Activity\*") or (category matches("\*Alerts & Notification\*"))<br />\| parse "\\\\\\"alertName\\\\\\": \\\\\\"\*\\\\\\"" as alert\_name nodrop<br />\| where isEmpty(alert\_name) or alert\_name matches("\*Unusual Data Activity\*")<br /><br />\| count by id,syslog\_severity<br />\| count(id) as frequency by syslog\_severity<br />\| sort by frequency|
|Druva Cyber Resilience|Unusual Data Activities by Type Over Time|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"affectedSnapshot\\\\\\": \\\\\\"\*\\\\\\"" as affected\_snapshot nodrop<br />\| parse "\\\\\\"resourceParentName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br />\| parse "\\\\\\"udaType\\\\\\": [\*]" as uda\_type<br />\| extract field=uda\_type "\\\\\\"(?\<uda\_type\>.\*?)\\\\\\"" multi<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Unusual Data Activity\*") or (category matches("\*Alerts & Notification\*"))<br />\| parse "\\\\\\"alertName\\\\\\": \\\\\\"\*\\\\\\"" as alert\_name nodrop<br />\| where isEmpty(alert\_name) or alert\_name matches("\*Unusual Data Activity\*")<br /><br />\| timeslice 1d<br />\| count by id,\_timeslice,uda\_type<br />\| count(id) as frequency by \_timeslice,uda\_type<br />\| fillmissing timeslice, values all in uda\_type<br />\| transpose row \_timeslice column uda\_type|
|Druva Cyber Resilience|Unusual Data Activities Count|Logs|Installed Apps/Druva Cyber Resilience/Druva Cyber Resilience - Unusual Data Activities|\_sourceCategory={{Logsdatasource}} <br />\| json "id","area","category","type","syslogSeverity","syslogFacility" as id,area,category,type,syslog\_severity,syslog\_facility nodrop<br /><br />\| if (syslog\_severity=0,"Emergency",if(syslog\_severity = 1,"Alert",if(syslog\_severity = 2,"Critical",if(syslog\_severity=3,"Error",if(syslog\_severity = 4,"Warning",if(syslog\_severity=5,"Notice",if(syslog\_severity=6,"Informational",if(syslog\_severity=7,"Debug","Nil")))))))) as syslog\_severity<br /><br />\| parse "\\\\\\"resourceType\\\\\\": \\\\\\"\*\\\\\\"" as resource\_type nodrop<br />\| parse "\\\\\\"resourceID\\\\\\": \*," as resource\_id nodrop<br />\| parse "\\\\\\"resourceName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_name nodrop<br />\| parse "\\\\\\"affectedSnapshot\\\\\\": \\\\\\"\*\\\\\\"" as affected\_snapshot nodrop<br />\| parse "\\\\\\"resourceParentName\\\\\\": \\\\\\"\*\\\\\\"" as resource\_owner nodrop<br /><br />// global filters<br />\| where type matches "{{type}}"<br />\| where resource\_type matches "{{resource\_type}}"<br />\| where syslog\_severity matches "{{syslog\_severity}}"<br />\| where area matches "{{area}}"<br /><br />\| where category matches("\*Unusual Data Activity\*") or (category matches("\*Alerts & Notification\*"))<br />\| parse "\\\\\\"alertName\\\\\\": \\\\\\"\*\\\\\\"" as alert\_name nodrop<br />\| where isEmpty(alert\_name) or alert\_name matches("\*Unusual Data Activity\*")<br /><br />\| count by id<br />\| count|

