# Cloudflare
## Sumo Logic App For: Cloudflare
The Sumo Logic App for Cloudflare provides a set of dashboards to make analyzing Cloudflare logs easy and help you understand events and trends from your websites and applications on the Cloudflare network. Logs are gathered from all 155+ Cloudflare data centers in near real-time and can be combined with other data sources, such as your origin data, to get unique insights and help you improve the performance and security of your websites and applications.
Docs Link: [Cloudflare](https://developers.cloudflare.com/fundamentals/data-products/analytics-integrations/sumo-logic)

## Searches

### Log Searches

- **3xx Errors (Edge)**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **3xx Errors (Edge)**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **4xx Errors (Edge)**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **4xx Errors (Edge)**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **5xx Errors (Edge)**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **5xx Errors (Edge)**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Average rps**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Average rps**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Average rps**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Bad Bots**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Bad Bots**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Bad Bots vs HumansAndGoodBots**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Bad Bots vs HumansAndGoodBots**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Cache Status Over Time (in Requests)**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cache Status Over Time (in Requests)**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cache Status Over Time (in Requests)**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Cache Status Ratio**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Cache Status Ratio**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cache Status Ratio**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cached Bandwidth**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Cached Bandwidth**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cached Bandwidth**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Cached Bandwidth**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cached Bandwidth**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Cached Requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cached Requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cached Requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Cached vs Uncached Bandwidth Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Cached vs Uncached Bandwidth Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Cached vs Uncached Bandwidth Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Client Requests by Connection**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests by Connection**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests by Connection**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New 
- **Client Requests by Connection Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests by Connection Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests by Connection Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New 
- **Client Requests by Content Type**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests by Content Type**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New 
- **Client Requests by Content Type**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests by Hostname Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New 
- **Client Requests by Hostname Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests by Hostname Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests Methods in rps**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests Methods in rps**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests Methods in rps**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New 
- **Client Requests Methods Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests Methods Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Client Requests Methods Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New 
- **Content Type**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Content Type**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Edge Response Error Ratio**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Edge Response Error Ratio**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Edge Response Status in rps**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Edge Response Status in rps**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Edge Response Status Over Time**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Edge Response Status Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **False Detected Bots**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **False Detected Bots**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **HTTP Protocols**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **HTTP Protocols**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Origin Requests by Content Type in rps**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Origin Requests by Content Type in rps**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New 
- **Origin Requests by Content Type in rps**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Origin Requests by Hostname in rps**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Origin Requests by Hostname in rps**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New 
- **Origin Requests by Hostname in rps**: from Dashboard: Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) 
- **Origin Response Error Ratio**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Origin Response Error Ratio**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Origin Response Status Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Origin Response Status Over Time**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Origin time to first byte dynamic requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content) 
- **Origin time to first byte dynamic requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content) 
- **Origin time to first byte static requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content) 
- **Origin time to first byte static requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content) 
- **Rate Limit Over Time**: from Dashboard: Cloudflare/Cloudflare - Security (Rate Limiting) 
- **Request Methods**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Request Methods**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Saved Bandwidth %**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Saved Bandwidth %**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Saved Bandwidth %**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Saved Bandwidth in %**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Saved Bandwidth in %**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Slowest URIs by cumulative time to first byte for dynamic requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content) 
- **Slowest URIs by cumulative time to first byte for dynamic requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content) 
- **Slowest URIs by cumulative time to first byte for static requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content) 
- **Slowest URIs by cumulative time to first byte for static requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content) 
- **Threats Over Time**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Threats Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Threats Over Time**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Threats Stopped**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Threats Stopped**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Threats Stopped**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Threats Stopped**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Threats Stopped**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Threats vs Requests**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Threats vs Requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Threats vs Requests**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Top AS Numbers**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Top AS Numbers**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Top Bad Bots IPs - AS Number - Country**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Bad Bots IPs - AS Number - Country**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Bad Bots Referer**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Bad Bots Referer**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Bad Bots Requested URIs**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Bad Bots Requested URIs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Bad Bots Requested User Agents**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Bad Bots Requested User Agents**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Banned Client IPs**: from Dashboard: Cloudflare/Cloudflare - Security (Rate Limiting) 
- **Top Banned URIs**: from Dashboard: Cloudflare/Cloudflare - Security (Rate Limiting) 
- **Top Client IPs and AS Number**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Top Client IPs and AS Number**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Top Countries**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Top Countries**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Top False Detected Bots IPs - AS Number - Country**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top False Detected Bots IPs - AS Number - Country**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top False Detected Bots Referer**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top False Detected Bots Referer**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top False Detected Bots Requested URIs**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top False Detected Bots Requested URIs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top False Detected Bots Requested User Agents**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top False Detected Bots Requested User Agents**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Hostnames**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Top Hostnames**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Top IPs - AS Number - Country**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top IPs - AS Number - Country**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Pathing Statuses**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Top Pathing Statuses**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Top Pathing Statuses**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Top Rate Limit Actions**: from Dashboard: Cloudflare/Cloudflare - Security (Rate Limiting) 
- **Top Rate Limit Countries**: from Dashboard: Cloudflare/Cloudflare - Security (Rate Limiting) 
- **Top Referer**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Referer**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Top Referer**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Top Referer**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Requested URIs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Top Requested URIs**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Requested URIs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Top Requested URIs**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Top Requested URIs**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Top Requested URIs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Requested User Agents**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Requested User Agents**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Top Threat Client IPs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat Client IPs**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat Client IPs**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Top Threat Countries**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat Countries**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Top Threat Countries**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat Countries**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Top Threat Countries**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Top Threat Countries Map**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Top Threat Countries Map**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat Countries Map**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat Target URIs**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat Target URIs**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Top Threat Target URIs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat User Agents**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat User Agents**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Top Threat User Agents**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Top Threats Stopped**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Top Threats Stopped**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Top Threats Stopped**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Top Traffic Countries**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Top Traffic Countries**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Top Traffic Countries Map**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Top Traffic Countries Map**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Top Traffic IPs**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Top Traffic IPs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Top Traffic Type**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Top Traffic Type**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Top URIs with Cache Status Miss**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Top URIs with Cache Status Miss**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Top URIs with Cache Status Miss**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Top User Agents**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Top User Agents**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Reliability 
- **Top User Agents**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Top User Agents**: from Dashboard: Cloudflare/Cloudflare - Reliability 
- **Top WAF Rules Triggered**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (WAF) 
- **Top WAF Rules Triggered**: from Dashboard: Cloudflare/Cloudflare - Security (WAF) 
- **Total Bandwidth**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Bandwidth**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Total Bandwidth**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Bandwidth**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Total Bandwidth**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Total Bandwidth vs Origin Bandwidth in bps Last 24 Hours**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Bandwidth vs Origin Bandwidth in bps Last 24 Hours**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Bandwidth vs Origin Bandwidth in bps Last 24 Hours**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Total Number of Requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Total Number of Requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Number of Requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Overview) 
- **Total Number of Requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Number of Requests**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) - New 
- **Total Number of Requests**: from Dashboard: Cloudflare/Cloudflare - Security (Overview) 
- **Total Number of Requests**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Total Number of Requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Total Number of Requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Total Number of Requests**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Total Number of Requests vs Cached vs Uncached Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Total Number of Requests vs Cached vs Uncached Over Time**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Number of Requests vs Cached vs Uncached Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Requests vs Bad Bots Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (Bot Management) 
- **Total Requests vs Bad Bots Over Time**: from Dashboard: Cloudflare/Cloudflare - Security (Bot Management) 
- **Total Requests vs. Origin Requests in rps Last 24 Hours**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Requests vs. Origin Requests in rps Last 24 Hours**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Total Requests vs. Origin Requests in rps Last 24 Hours**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Traffic Type**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Snapshot 
- **Traffic Type**: from Dashboard: Cloudflare/Cloudflare - Snapshot 
- **Uncached Bandwidth**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Uncached Bandwidth**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Uncached Bandwidth**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Uncached Requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New 
- **Uncached Requests**: from Dashboard: Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **Uncached Requests**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) 
- **WAF Events Over Time**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (WAF) 
- **WAF Events Over Time**: from Dashboard: Cloudflare/Cloudflare - Security (WAF) 
- **WAF: Top Client IPs**: from Dashboard: Cloudflare/Cloudflare - Security (WAF) 
- **WAF: Top Client IPs**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (WAF) 
- **WAF: Top Countries**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (WAF) 
- **WAF: Top Countries**: from Dashboard: Cloudflare/Cloudflare - Security (WAF) 
- **WAF: Top Hosts**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (WAF) 
- **WAF: Top Hosts**: from Dashboard: Cloudflare/Cloudflare - Security (WAF) 
- **WAF: Top User Agents**: from Dashboard: Installed Apps/Cloudflare/Cloudflare - Security (WAF) 
- **WAF: Top User Agents**: from Dashboard: Cloudflare/Cloudflare - Security (WAF)

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Cloudflare|3xx Errors (Edge)|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus" as  edge\_response\_status nodrop  <br />\|where edge\_response\_status matches "3\*"<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count|
|Cloudflare|3xx Errors (Edge)|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus" as  edge\_response\_status nodrop  <br /> \| if (edge\_response\_status matches "3\*", "3xx", "") as edge\_status\_code\_3xx<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by edge\_status\_code\_3xx|
|Cloudflare|4xx Errors (Edge)|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json  "EdgeResponseStatus" as  edge\_response\_status nodrop  <br />\| if (edge\_response\_status matches "4\*", "4xx", "") as edge\_status\_code\_4xx<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by edge\_status\_code\_4xx|
|Cloudflare|4xx Errors (Edge)|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus" as  edge\_response\_status nodrop  <br />\|where edge\_response\_status matches "4\*"<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count|
|Cloudflare|5xx Errors (Edge)|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus" as  edge\_response\_status nodrop  <br />\| if (edge\_response\_status matches "5\*", "5xx", "") as edge\_status\_code\_5xx<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by edge\_status\_code\_5xx|
|Cloudflare|5xx Errors (Edge)|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus" as  edge\_response\_status nodrop  <br />\|where edge\_response\_status matches "5\*"<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count|
|Cloudflare|Average rps|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| timeslice 1s<br />\| count by  \_timeslice <br />\| avg (\_count)<br />\| int (\_avg)  <br />|
|Cloudflare|Average rps|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| timeslice 1s<br />\| count by  \_timeslice <br />\| avg (\_count)<br />\| int (\_avg)  <br />|
|Cloudflare|Average rps|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New| \_sourceCategory = Labs/Cloudflare CacheCacheStatus\*<br />\| timeslice 1s<br />\| count by  \_timeslice <br />\| avg (\_count)<br />\| int (\_avg)  <br />|
|Cloudflare|Bad Bots|Logs|Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json "EdgePathingSrc", "EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count<br />|
|Cloudflare|Bad Bots|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json "EdgePathingSrc", "EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count<br />|
|Cloudflare|Bad Bots vs HumansAndGoodBots|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json "EdgePathingSrc","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_status nodrop<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew", "BadBots","Humans-GoodBots") as BotType<br />\| count by BotType<br />|
|Cloudflare|Bad Bots vs HumansAndGoodBots|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json "EdgePathingSrc","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_status nodrop<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew", "BadBots","Humans-GoodBots") as BotType<br />\| count by BotType<br />|
|Cloudflare|Cache Status Over Time (in Requests)|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as  cache\_cache\_status nodrop  <br /> \| timeslice 1h  <br />\| count by \_timeslice, cache\_cache\_status<br />\| transpose row \_timeslice column cache\_cache\_status<br />|
|Cloudflare|Cache Status Over Time (in Requests)|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as  cache\_cache\_status nodrop  <br /> \| timeslice 1h  <br />\| count by \_timeslice, cache\_cache\_status<br />\| transpose row \_timeslice column cache\_cache\_status<br />|
|Cloudflare|Cache Status Over Time (in Requests)|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New|\_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as  cache\_cache\_status nodrop  <br /> \| timeslice 1h  <br />\| count by \_timeslice, cache\_cache\_status<br />\| transpose row \_timeslice column cache\_cache\_status<br />|
|Cloudflare|Cache Status Ratio|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New|\_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop <br />\| count by cache\_cache\_status<br />|
|Cloudflare|Cache Status Ratio|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop <br />\| count by cache\_cache\_status<br />|
|Cloudflare|Cache Status Ratio|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop <br />\| count by cache\_cache\_status<br />|
|Cloudflare|Cached Bandwidth|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New|\_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as  edge\_response\_bytes, cache\_cache\_status nodrop <br /> \| where cache\_cache\_status in ("hit", "stale", "updating", "ignored", "revalidated")<br />\| sum(edge\_response\_bytes) as cached\_bandwidth  <br />\| format("%.2f KB",cached\_bandwidth/1Ki) as cached\_bandwidth\_final<br />\| if (cached\_bandwidth \> 1Mi, format("%.2f MB",cached\_bandwidth / 1Mi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Gi, format("%.2f GB",cached\_bandwidth / 1Gi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Ti, format("%.2f TB",cached\_bandwidth / 1Ti),cached\_bandwidth\_final) as cached\_bandwidth\_final    <br />\| fields - cached\_bandwidth<br />|
|Cloudflare|Cached Bandwidth|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as  edge\_response\_bytes, cache\_cache\_status nodrop <br /> \| where cache\_cache\_status in ("hit", "stale", "updating", "ignored", "revalidated")<br />\| sum(edge\_response\_bytes) as cached\_bandwidth  <br />\| format("%.2f KB",cached\_bandwidth/1Ki) as cached\_bandwidth\_final<br />\| if (cached\_bandwidth \> 1Mi, format("%.2f MB",cached\_bandwidth / 1Mi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Gi, format("%.2f GB",cached\_bandwidth / 1Gi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Ti, format("%.2f TB",cached\_bandwidth / 1Ti),cached\_bandwidth\_final) as cached\_bandwidth\_final    <br />\| fields - cached\_bandwidth<br />|
|Cloudflare|Cached Bandwidth|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as  edge\_response\_bytes, cache\_cache\_status nodrop <br />\| where cache\_cache\_status in ("hit", "stale", "updating", "ignored", "revalidated")<br />\| sum(edge\_response\_bytes) as cached\_bandwidth  <br />\| format("%.2f KB",cached\_bandwidth/1Ki) as cached\_bandwidth\_final<br />\| if (cached\_bandwidth \> 1Mi, format("%.2f MB",cached\_bandwidth / 1Mi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Gi, format("%.2f GB",cached\_bandwidth / 1Gi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Ti, format("%.2f TB",cached\_bandwidth / 1Ti),cached\_bandwidth\_final) as cached\_bandwidth\_final    <br />\| fields - cached\_bandwidth<br />|
|Cloudflare|Cached Bandwidth|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as  edge\_response\_bytes, cache\_cache\_status nodrop <br /> \| where cache\_cache\_status in ("hit", "stale", "updating", "ignored", "revalidated")<br />\| sum(edge\_response\_bytes) as cached\_bandwidth  <br />\| format("%.2f KB",cached\_bandwidth/1Ki) as cached\_bandwidth\_final<br />\| if (cached\_bandwidth \> 1Mi, format("%.2f MB",cached\_bandwidth / 1Mi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Gi, format("%.2f GB",cached\_bandwidth / 1Gi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Ti, format("%.2f TB",cached\_bandwidth / 1Ti),cached\_bandwidth\_final) as cached\_bandwidth\_final    <br />\| fields - cached\_bandwidth<br />|
|Cloudflare|Cached Bandwidth|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as  edge\_response\_bytes, cache\_cache\_status nodrop <br />\| where cache\_cache\_status in ("hit", "stale", "updating", "ignored", "revalidated")<br />\| sum(edge\_response\_bytes) as cached\_bandwidth  <br />\| format("%.2f KB",cached\_bandwidth/1Ki) as cached\_bandwidth\_final<br />\| if (cached\_bandwidth \> 1Mi, format("%.2f MB",cached\_bandwidth / 1Mi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Gi, format("%.2f GB",cached\_bandwidth / 1Gi),cached\_bandwidth\_final) as cached\_bandwidth\_final  <br />\| if (cached\_bandwidth \> 1Ti, format("%.2f TB",cached\_bandwidth / 1Ti),cached\_bandwidth\_final) as cached\_bandwidth\_final    <br />\| fields - cached\_bandwidth<br />|
|Cloudflare|Cached Requests|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as  cache\_cache\_status nodrop  <br /> \| where cache\_cache\_status in ("hit", "stale", "updating", "ignored")<br />\| count<br />\| sum(\_count) as cached\_requests<br /> <br /><br /><br />|
|Cloudflare|Cached Requests|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as  cache\_cache\_status nodrop  <br /> \| where cache\_cache\_status in ("hit", "stale", "updating", "ignored")<br />\| count<br />\| sum(\_count) as cached\_requests<br /> <br /><br /><br />|
|Cloudflare|Cached Requests|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New| \_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as  cache\_cache\_status nodrop  <br /> \| where cache\_cache\_status in ("hit", "stale", "updating", "ignored")<br />\| count<br />\| sum(\_count) as cached\_requests<br /> <br /><br /><br />|
|Cloudflare|Cached vs Uncached Bandwidth Over Time|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New| \_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as edge\_response\_bytes, cache\_cache\_status nodrop  <br /> \| timeslice 1h<br />\| if (cache\_cache\_status in ("hit","stale","updating","ignored","revalidated"),edge\_response\_bytes,0) as cached\_bandwidth <br />\| if (cache\_cache\_status not in("hit", "stale", "updating", "ignored","revalidated"), edge\_response\_bytes,0) as uncached\_bandwidth<br />\| sum(cached\_bandwidth) as cached\_bandwidth, sum(uncached\_bandwidth) as uncached\_bandwidth by \_timeslice<br />|
|Cloudflare|Cached vs Uncached Bandwidth Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as edge\_response\_bytes, cache\_cache\_status nodrop  <br /> \| timeslice 1h<br />\| if (cache\_cache\_status in ("hit","stale","updating","ignored","revalidated"),edge\_response\_bytes,0) as cached\_bandwidth <br />\| if (cache\_cache\_status not in("hit", "stale", "updating", "ignored","revalidated"), edge\_response\_bytes,0) as uncached\_bandwidth<br />\| sum(cached\_bandwidth) as cached\_bandwidth, sum(uncached\_bandwidth) as uncached\_bandwidth by \_timeslice<br />|
|Cloudflare|Cached vs Uncached Bandwidth Over Time|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as edge\_response\_bytes, cache\_cache\_status nodrop  <br /> \| timeslice 1h<br />\| if (cache\_cache\_status in ("hit","stale","updating","ignored","revalidated"),edge\_response\_bytes,0) as cached\_bandwidth <br />\| if (cache\_cache\_status not in("hit", "stale", "updating", "ignored","revalidated"), edge\_response\_bytes,0) as uncached\_bandwidth<br />\| sum(cached\_bandwidth) as cached\_bandwidth, sum(uncached\_bandwidth) as uncached\_bandwidth by \_timeslice<br />|
|Cloudflare|Client Requests by Connection|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)| \_sourceCategory={{\_sourceCategory}} ClientSSLProtocol\*<br />\| json "ClientSSLProtocol" as client\_ssl\_protocol nodrop <br />\| timeslice 1s<br />\| count by  \_timeslice, client\_ssl\_protocol <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_ssl\_protocol <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg<br />|
|Cloudflare|Client Requests by Connection|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)| \_sourceCategory={{\_sourceCategory}} ClientSSLProtocol\*<br />\| json "ClientSSLProtocol" as client\_ssl\_protocol nodrop <br />\| timeslice 1s<br />\| count by  \_timeslice, client\_ssl\_protocol <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_ssl\_protocol <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg<br />|
|Cloudflare|Client Requests by Connection|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New| \_sourceCategory = Labs/Cloudflare ClientSSLProtocol\*<br />\| json "ClientSSLProtocol" as client\_ssl\_protocol nodrop <br />\| timeslice 1s<br />\| count by  \_timeslice, client\_ssl\_protocol <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_ssl\_protocol <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg<br />|
|Cloudflare|Client Requests by Connection Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)|\_sourceCategory={{\_sourceCategory}} ClientSSLProtocol\*<br />\| json "ClientSSLProtocol" as  client\_ssl\_protocol nodrop <br />\| timeslice 1h  <br />\| count by \_timeslice, client\_ssl\_protocol<br />\| transpose row \_timeslice column client\_ssl\_protocol<br />|
|Cloudflare|Client Requests by Connection Over Time|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)|\_sourceCategory={{\_sourceCategory}} ClientSSLProtocol\*<br />\| json "ClientSSLProtocol" as  client\_ssl\_protocol nodrop <br />\| timeslice 1h  <br />\| count by \_timeslice, client\_ssl\_protocol<br />\| transpose row \_timeslice column client\_ssl\_protocol<br />|
|Cloudflare|Client Requests by Connection Over Time|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New|\_sourceCategory = Labs/Cloudflare ClientSSLProtocol\*<br />\| json "ClientSSLProtocol" as  client\_ssl\_protocol nodrop <br />\| timeslice 1h  <br />\| count by \_timeslice, client\_ssl\_protocol<br />\| transpose row \_timeslice column client\_ssl\_protocol<br />|
|Cloudflare|Client Requests by Content Type|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)|\_sourceCategory={{\_sourceCategory}} EdgeResponseContentType\*<br />\| json "EdgeResponseContentType" as  edge\_response\_content\_type nodrop <br /> \| timeslice 1h  <br />\| count by \_timeslice, edge\_response\_content\_type<br />\| transpose row \_timeslice column edge\_response\_content\_type<br />|
|Cloudflare|Client Requests by Content Type|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New|\_sourceCategory = Labs/Cloudflare EdgeResponseContentType\*<br />\| json "EdgeResponseContentType" as  edge\_response\_content\_type nodrop <br /> \| timeslice 1h  <br />\| count by \_timeslice, edge\_response\_content\_type<br />\| transpose row \_timeslice column edge\_response\_content\_type<br />|
|Cloudflare|Client Requests by Content Type|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)|\_sourceCategory={{\_sourceCategory}} EdgeResponseContentType\*<br />\| json "EdgeResponseContentType" as  edge\_response\_content\_type nodrop <br /> \| timeslice 1h  <br />\| count by \_timeslice, edge\_response\_content\_type<br />\| transpose row \_timeslice column edge\_response\_content\_type<br />|
|Cloudflare|Client Requests by Hostname Over Time|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New| \_sourceCategory = Labs/Cloudflare <br />\| json "ClientRequestHost" as client\_request\_host nodrop <br /> \| timeslice 1h<br />\|where if ("{{client\_request\_host}}" = "\*", true, client\_request\_host matches "{{client\_request\_host}}")<br />\|count by \_timeslice, client\_request\_host<br />\| transpose row \_timeslice column client\_request\_host|
|Cloudflare|Client Requests by Hostname Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)| \_sourceCategory={{\_sourceCategory}} <br />\| json "ClientRequestHost" as client\_request\_host nodrop <br /> \| timeslice 1h<br />\|where client\_request\_host matches "{{client\_request\_host}}"<br />\|count by \_timeslice, client\_request\_host<br />\| transpose row \_timeslice column client\_request\_host|
|Cloudflare|Client Requests by Hostname Over Time|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)| \_sourceCategory={{\_sourceCategory}} <br />\| json "ClientRequestHost" as client\_request\_host nodrop <br /> \| timeslice 1h<br />\|where client\_request\_host matches "{{client\_request\_host}}"<br />\|count by \_timeslice, client\_request\_host<br />\| transpose row \_timeslice column client\_request\_host|
|Cloudflare|Client Requests Methods in rps|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)| \_sourceCategory={{\_sourceCategory}} ClientRequestMethod\*<br />\| json "ClientCountry", "ClientIP", "ClientDeviceType", "ClientRequestHost", "ClientRequestUserAgent", "ClientRequestURI", "OriginResponseStatus", "EdgeResponseStatus", "OriginIP", "ClientIPClass", "EdgeResponseBytes", "CacheCacheStatus", "ClientRequestMethod", "RayID", "WorkerSubrequest" as client\_country, client\_ip, client\_device\_type, client\_request\_host, client\_request\_user\_agent, client\_request\_uri, origin\_response\_status, edge\_response\_status, origin\_ip, client\_ip\_class, edge\_response\_bytes, cache\_cache\_status, client\_request\_method, ray\_id, worker\_subrequest<br />\| timeslice 1s<br />\|where client\_request\_method matches "{{client\_request\_method}}"<br />\|count by  \_timeslice, client\_request\_method <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_request\_method <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg|
|Cloudflare|Client Requests Methods in rps|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)| \_sourceCategory={{\_sourceCategory}} ClientRequestMethod\*<br />\| json "ClientCountry", "ClientIP", "ClientDeviceType", "ClientRequestHost", "ClientRequestUserAgent", "ClientRequestURI", "OriginResponseStatus", "EdgeResponseStatus", "OriginIP", "ClientIPClass", "EdgeResponseBytes", "CacheCacheStatus", "ClientRequestMethod", "RayID", "WorkerSubrequest" as client\_country, client\_ip, client\_device\_type, client\_request\_host, client\_request\_user\_agent, client\_request\_uri, origin\_response\_status, edge\_response\_status, origin\_ip, client\_ip\_class, edge\_response\_bytes, cache\_cache\_status, client\_request\_method, ray\_id, worker\_subrequest<br />\| timeslice 1s<br />\|where client\_request\_method matches "{{client\_request\_method}}"<br />\|count by  \_timeslice, client\_request\_method <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_request\_method <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg|
|Cloudflare|Client Requests Methods in rps|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New| \_sourceCategory = Labs/Cloudflare ClientRequestMethod\*<br />\| json "ClientCountry", "ClientIP", "ClientDeviceType", "ClientRequestHost", "ClientRequestUserAgent", "ClientRequestURI", "OriginResponseStatus", "EdgeResponseStatus", "OriginIP", "ClientIPClass", "EdgeResponseBytes", "CacheCacheStatus", "ClientRequestMethod", "RayID", "WorkerSubrequest" as client\_country, client\_ip, client\_device\_type, client\_request\_host, client\_request\_user\_agent, client\_request\_uri, origin\_response\_status, edge\_response\_status, origin\_ip, client\_ip\_class, edge\_response\_bytes, cache\_cache\_status, client\_request\_method, ray\_id, worker\_subrequest<br />\| timeslice 1s<br />\|where if ("{{worker\_subrequest}}" = "\*", true, worker\_subrequest matches "{{worker\_subrequest}}") AND if ("{{client\_device\_type}}" = "\*", true, client\_device\_type matches "{{client\_device\_type}}") AND if ("{{client\_country}}" = "\*", true, client\_country matches "{{client\_country}}") AND if ("{{origin\_response\_status}}" = "\*", true, origin\_response\_status matches "{{origin\_response\_status}}") AND if ("{{client\_request\_user\_agent}}" = "\*", true, client\_request\_user\_agent matches "{{client\_request\_user\_agent}}") AND if ("{{client\_request\_uri}}" = "\*", true, client\_request\_uri matches "{{client\_request\_uri}}") AND if ("{{edge\_response\_status}}" = "\*", true, edge\_response\_status matches "{{edge\_response\_status}}") AND if ("{{origin\_ip}}" = "\*", true, origin\_ip matches "{{origin\_ip}}") AND if ("{{ray\_id}}" = "\*", true, ray\_id matches "{{ray\_id}}") AND if ("{{client\_request\_method}}" = "\*", true, client\_request\_method matches "{{client\_request\_method}}") AND if ("{{client\_request\_host}}" = "\*", true, client\_request\_host matches "{{client\_request\_host}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\|count by  \_timeslice, client\_request\_method <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_request\_method <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg|
|Cloudflare|Client Requests Methods Over Time|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)| \_sourceCategory={{\_sourceCategory}} ClientRequestMethod\*<br />\| json "ClientRequestMethod" as  client\_request\_method nodrop <br /> \| timeslice 1h<br />\|where client\_request\_method matches "{{client\_request\_method}}"<br />\|count by \_timeslice, client\_request\_method<br />\| transpose row \_timeslice column client\_request\_method|
|Cloudflare|Client Requests Methods Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)| \_sourceCategory={{\_sourceCategory}} ClientRequestMethod\*<br />\| json "ClientRequestMethod" as  client\_request\_method nodrop <br /> \| timeslice 1h<br />\|where client\_request\_method matches "{{client\_request\_method}}"<br />\|count by \_timeslice, client\_request\_method<br />\| transpose row \_timeslice column client\_request\_method|
|Cloudflare|Client Requests Methods Over Time|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New| \_sourceCategory = Labs/Cloudflare ClientRequestMethod\*<br />\| json "ClientRequestMethod" as  client\_request\_method nodrop <br /> \| timeslice 1h<br />\|where if ("{{client\_request\_method}}" = "\*", true, client\_request\_method matches "{{client\_request\_method}}")<br />\|count by \_timeslice, client\_request\_method<br />\| transpose row \_timeslice column client\_request\_method|
|Cloudflare|Content Type|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "EdgeResponseContentType" as  edge\_response\_content\_type nodrop <br /> \| count by edge\_response\_content\_type<br /><br />|
|Cloudflare|Content Type|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "EdgeResponseContentType" as  edge\_response\_content\_type nodrop <br /> \| count by edge\_response\_content\_type<br /><br />|
|Cloudflare|Edge Response Error Ratio|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability|\_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus"as edge\_response\_status nodrop  <br /> \| if (edge\_response\_status matches "2\*", "2xx", "") as edge\_status\_code <br />\| if (edge\_response\_status matches "3\*", "3xx", edge\_status\_code) as edge\_status\_code  <br />\| if (edge\_response\_status matches "4\*", "4xx", edge\_status\_code) as edge\_status\_code <br />\| if (edge\_response\_status matches "5\*", "5xx", edge\_status\_code) as edge\_status\_code <br />\| where edge\_status\_code != ""<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by edge\_status\_code|
|Cloudflare|Edge Response Error Ratio|Logs|Cloudflare/Cloudflare - Reliability|\_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus"as edge\_response\_status nodrop  <br /> \| if (edge\_response\_status matches "2\*", "2xx", "") as edge\_status\_code <br />\| if (edge\_response\_status matches "3\*", "3xx", edge\_status\_code) as edge\_status\_code  <br />\| if (edge\_response\_status matches "4\*", "4xx", edge\_status\_code) as edge\_status\_code <br />\| if (edge\_response\_status matches "5\*", "5xx", edge\_status\_code) as edge\_status\_code <br />\| where edge\_status\_code != ""<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by edge\_status\_code|
|Cloudflare|Edge Response Status in rps|Logs|Cloudflare/Cloudflare - Reliability|\_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json  "EdgeResponseStatus" as edge\_response\_status nodrop  <br /> \| timeslice 1s<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by  \_timeslice, edge\_response\_status<br />\| fields -\_timeslice|
|Cloudflare|Edge Response Status in rps|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability|\_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json  "EdgeResponseStatus" as edge\_response\_status nodrop  <br /> \| timeslice 1s<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by  \_timeslice, edge\_response\_status<br />\| fields -\_timeslice|
|Cloudflare|Edge Response Status Over Time|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus" as edge\_response\_status nodrop  <br /> \| timeslice 1h<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by \_timeslice, edge\_response\_status<br />\| transpose row \_timeslice column edge\_response\_status|
|Cloudflare|Edge Response Status Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} EdgeResponseStatus\*<br />\| json "EdgeResponseStatus" as edge\_response\_status nodrop  <br /> \| timeslice 1h<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by \_timeslice, edge\_response\_status<br />\| transpose row \_timeslice column edge\_response\_status|
|Cloudflare|False Detected Bots|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json "EdgePathingSrc","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| sum(false\_detected\_bots) as false\_dected\_bots\_count<br />|
|Cloudflare|False Detected Bots|Logs|Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json "EdgePathingSrc","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| sum(false\_detected\_bots) as false\_dected\_bots\_count<br />|
|Cloudflare|HTTP Protocols|Logs|Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientRequestProtocol" as  client\_request\_protocol nodrop <br /> \| count by client\_request\_protocol<br /><br />|
|Cloudflare|HTTP Protocols|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientRequestProtocol" as  client\_request\_protocol nodrop <br /> \| count by client\_request\_protocol<br /><br />|
|Cloudflare|Origin Requests by Content Type in rps|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)|\_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json "EdgeResponseContentType" as edge\_response\_content\_type nodrop <br />\| timeslice 1s<br />\| count by  \_timeslice, edge\_response\_content\_type <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by edge\_response\_content\_type <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg<br />|
|Cloudflare|Origin Requests by Content Type in rps|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New|\_sourceCategory = Labs/Cloudflare CacheCacheStatus\*<br />\| json "EdgeResponseContentType" as edge\_response\_content\_type nodrop <br />\| timeslice 1s<br />\| count by  \_timeslice, edge\_response\_content\_type <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by edge\_response\_content\_type <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg<br />|
|Cloudflare|Origin Requests by Content Type in rps|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)|\_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json "EdgeResponseContentType" as edge\_response\_content\_type nodrop <br />\| timeslice 1s<br />\| count by  \_timeslice, edge\_response\_content\_type <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by edge\_response\_content\_type <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg<br />|
|Cloudflare|Origin Requests by Hostname in rps|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)|\_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json "ClientRequestHost" as client\_request\_host nodrop <br /> \| timeslice 1s<br />\|where client\_request\_host matches "{{client\_request\_host}}"<br />\|count by  \_timeslice, client\_request\_host <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_request\_host <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg|
|Cloudflare|Origin Requests by Hostname in rps|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type) - New|\_sourceCategory = Labs/Cloudflare CacheCacheStatus\*<br />\| json "ClientRequestHost" as client\_request\_host nodrop <br /> \| timeslice 1s<br />\|where if ("{{client\_request\_host}}" = "\*", true, client\_request\_host matches "{{client\_request\_host}}")<br />\|count by  \_timeslice, client\_request\_host <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_request\_host <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg|
|Cloudflare|Origin Requests by Hostname in rps|Logs|Cloudflare/Cloudflare - Performance (Hostname, Content Type, Request Methods, Connection Type)|\_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json "ClientRequestHost" as client\_request\_host nodrop <br /> \| timeslice 1s<br />\|where client\_request\_host matches "{{client\_request\_host}}"<br />\|count by  \_timeslice, client\_request\_host <br />\| sum (\_count) as total\_requests, avg (\_count), max (\_count) as max\_rps by client\_request\_host <br />\| int (\_avg) as avg\_rps<br />\| order by avg\_rps<br />\| fields -\_avg|
|Cloudflare|Origin Response Error Ratio|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} OriginResponseStatus\*<br />\| json "OriginResponseStatus" as  origin\_response\_status nodrop  <br /> \| if (origin\_response\_status matches "2\*", "2xx", "") as origin\_status\_code <br />\| if (origin\_response\_status matches "3\*", "3xx", origin\_status\_code) as origin\_status\_code  <br />\| if (origin\_response\_status matches "4\*", "4xx", origin\_status\_code) as origin\_status\_code <br />\| if (origin\_response\_status matches "5\*", "5xx", origin\_status\_code) as origin\_status\_code <br />\| if (origin\_response\_status matches "0\*", "0 - Served from Cloudflare", origin\_status\_code) as origin\_status\_code<br />\| where origin\_status\_code != ""<br />\|where origin\_response\_status matches "{{origin\_response\_status}}"<br />\|count by origin\_status\_code|
|Cloudflare|Origin Response Error Ratio|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} OriginResponseStatus\*<br />\| json "OriginResponseStatus" as  origin\_response\_status nodrop  <br /> \| if (origin\_response\_status matches "2\*", "2xx", "") as origin\_status\_code <br />\| if (origin\_response\_status matches "3\*", "3xx", origin\_status\_code) as origin\_status\_code  <br />\| if (origin\_response\_status matches "4\*", "4xx", origin\_status\_code) as origin\_status\_code <br />\| if (origin\_response\_status matches "5\*", "5xx", origin\_status\_code) as origin\_status\_code <br />\| if (origin\_response\_status matches "0\*", "0 - Served from Cloudflare", origin\_status\_code) as origin\_status\_code<br />\| where origin\_status\_code != ""<br />\|where origin\_response\_status matches "{{origin\_response\_status}}"<br />\|count by origin\_status\_code|
|Cloudflare|Origin Response Status Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} OriginResponseStatus\*<br />\| json  "OriginResponseStatus" as origin\_response\_status nodrop  <br />\| timeslice 1h<br />\|where origin\_response\_status matches "{{origin\_response\_status}}"<br />\|count by \_timeslice, origin\_response\_status<br />\| transpose row \_timeslice column origin\_response\_status|
|Cloudflare|Origin Response Status Over Time|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} OriginResponseStatus\*<br />\| json  "OriginResponseStatus" as origin\_response\_status nodrop  <br />\| timeslice 1h<br />\|where origin\_response\_status matches "{{origin\_response\_status}}"<br />\|count by \_timeslice, origin\_response\_status<br />\| transpose row \_timeslice column origin\_response\_status|
|Cloudflare|Origin time to first byte dynamic requests|Logs|Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content)|\_sourceCategory={{\_sourceCategory}} OriginResponseTime\*<br />\| json "CacheCacheStatus", "OriginResponseTime" as cache\_cache\_status, origin\_response\_time nodrop  <br /> \| timeslice 1h<br />\| where cache\_cache\_status in ("bypass","unknown")<br />\| origin\_response\_time/1000000 as origin\_response\_time\_dynamic<br />\| pct(origin\_response\_time\_dynamic, 95, 75, 50) by \_timeslice<br />|
|Cloudflare|Origin time to first byte dynamic requests|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content)|\_sourceCategory={{\_sourceCategory}} OriginResponseTime\*<br />\| json "CacheCacheStatus", "OriginResponseTime" as cache\_cache\_status, origin\_response\_time nodrop  <br /> \| timeslice 1h<br />\| where cache\_cache\_status in ("bypass","unknown")<br />\| origin\_response\_time/1000000 as origin\_response\_time\_dynamic<br />\| pct(origin\_response\_time\_dynamic, 95, 75, 50) by \_timeslice<br />|
|Cloudflare|Origin time to first byte static requests|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content)|\_sourceCategory={{\_sourceCategory}} OriginResponseTime\*<br />\| json "CacheCacheStatus", "OriginResponseTime" as cache\_cache\_status, origin\_response\_time nodrop  <br />\| timeslice 1h<br />\| where cache\_cache\_status not in ("bypass","unknown")<br />\| origin\_response\_time/1000000 as origin\_response\_time\_static<br />\| pct(origin\_response\_time\_static, 95, 75, 50) by \_timeslice<br />|
|Cloudflare|Origin time to first byte static requests|Logs|Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content)|\_sourceCategory={{\_sourceCategory}} OriginResponseTime\*<br />\| json "CacheCacheStatus", "OriginResponseTime" as cache\_cache\_status, origin\_response\_time nodrop  <br />\| timeslice 1h<br />\| where cache\_cache\_status not in ("bypass","unknown")<br />\| origin\_response\_time/1000000 as origin\_response\_time\_static<br />\| pct(origin\_response\_time\_static, 95, 75, 50) by \_timeslice<br />|
|Cloudflare|Rate Limit Over Time|Logs|Cloudflare/Cloudflare - Security (Rate Limiting)| \_sourceCategory={{\_sourceCategory}} EdgeRateLimitAction\* <br />\| json  "EdgeRateLimitAction" as  edge\_rate\_limit\_action nodrop <br /> \| timeslice 1h  <br />\| count by \_timeslice, edge\_rate\_limit\_action<br />\| where !isblank(edge\_rate\_limit\_action)<br />\| transpose row \_timeslice column edge\_rate\_limit\_action<br />|
|Cloudflare|Request Methods|Logs|Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "ClientRequestMethod" as  client\_request\_method nodrop<br />\|where client\_request\_method matches "{{client\_request\_method}}"<br />\|count by client\_request\_method|
|Cloudflare|Request Methods|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "ClientRequestMethod" as  client\_request\_method nodrop<br />\|where client\_request\_method matches "{{client\_request\_method}}"<br />\|count by client\_request\_method|
|Cloudflare|Saved Bandwidth %|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json  "EdgeResponseBytes", "CacheCacheStatus"  as edge\_response\_bytes, cache\_cache\_status nodrop <br /><br />\| if( cache\_cache\_status in ("hit","stale","updating","ignored","revalidated"),edge\_response\_bytes,0) as cached\_bandwidth<br />\| sum(cached\_bandwidth) as cached\_bandwidth, sum(edge\_response\_bytes) as total\_bandwidth <br />\| (cached\_bandwidth/total\_bandwidth)\*100 as saved\_bandwidth\_pct<br />\| fields -cached\_bandwidth,total\_bandwidth<br />|
|Cloudflare|Saved Bandwidth %|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New|\_sourceCategory = Labs/Cloudflare CacheCacheStatus\*<br />\| json  "EdgeResponseBytes", "CacheCacheStatus"  as edge\_response\_bytes, cache\_cache\_status nodrop <br /><br />\| if( cache\_cache\_status in ("hit","stale","updating","ignored","revalidated"),edge\_response\_bytes,0) as cached\_bandwidth<br />\| sum(cached\_bandwidth) as cached\_bandwidth, sum(edge\_response\_bytes) as total\_bandwidth <br />\| (cached\_bandwidth/total\_bandwidth)\*100 as saved\_bandwidth\_pct<br />\| fields -cached\_bandwidth,total\_bandwidth<br />|
|Cloudflare|Saved Bandwidth %|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json  "EdgeResponseBytes", "CacheCacheStatus"  as edge\_response\_bytes, cache\_cache\_status nodrop <br /><br />\| if( cache\_cache\_status in ("hit","stale","updating","ignored","revalidated"),edge\_response\_bytes,0) as cached\_bandwidth<br />\| sum(cached\_bandwidth) as cached\_bandwidth, sum(edge\_response\_bytes) as total\_bandwidth <br />\| (cached\_bandwidth/total\_bandwidth)\*100 as saved\_bandwidth\_pct<br />\| fields -cached\_bandwidth,total\_bandwidth<br />|
|Cloudflare|Saved Bandwidth in %|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json  "EdgeResponseBytes", "CacheCacheStatus" as  edge\_response\_bytes, cache\_cache\_status nodrop <br />\| if( cache\_cache\_status in ("hit","stale","updating","ignored","revalidated"),edge\_response\_bytes,0) as cached\_bandwidth<br />\| sum(cached\_bandwidth) as cached\_bandwidth, sum(edge\_response\_bytes) as total\_bandwidth <br />\| (cached\_bandwidth/total\_bandwidth)\*100 as saved\_bandwidth\_pct<br />\| fields -cached\_bandwidth,total\_bandwidth<br />|
|Cloudflare|Saved Bandwidth in %|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} CacheCacheStatus\*<br />\| json  "EdgeResponseBytes", "CacheCacheStatus" as  edge\_response\_bytes, cache\_cache\_status nodrop <br />\| if( cache\_cache\_status in ("hit","stale","updating","ignored","revalidated"),edge\_response\_bytes,0) as cached\_bandwidth<br />\| sum(cached\_bandwidth) as cached\_bandwidth, sum(edge\_response\_bytes) as total\_bandwidth <br />\| (cached\_bandwidth/total\_bandwidth)\*100 as saved\_bandwidth\_pct<br />\| fields -cached\_bandwidth,total\_bandwidth<br />|
|Cloudflare|Slowest URIs by cumulative time to first byte for dynamic requests|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content)|\_sourceCategory={{\_sourceCategory}} OriginResponseTime\*<br />\| json "ClientRequestURI", "CacheCacheStatus", "OriginResponseTime" as client\_request\_uri,cache\_cache\_status, origin\_response\_time nodrop  <br /> \| where cache\_cache\_status in ("bypass","unknown")<br />\| origin\_response\_time/1000000 as origin\_response\_time\_dynamic<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|avg(origin\_response\_time\_dynamic) as origin\_response\_time\_dynamic\_avg, sum(origin\_response\_time\_dynamic) as wait\_time, pct(origin\_response\_time\_dynamic, 99, 99.9), count by client\_request\_uri<br />\| sort by \_count|
|Cloudflare|Slowest URIs by cumulative time to first byte for dynamic requests|Logs|Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content)|\_sourceCategory={{\_sourceCategory}} OriginResponseTime\*<br />\| json "ClientRequestURI", "CacheCacheStatus", "OriginResponseTime" as client\_request\_uri,cache\_cache\_status, origin\_response\_time nodrop  <br /> \| where cache\_cache\_status in ("bypass","unknown")<br />\| origin\_response\_time/1000000 as origin\_response\_time\_dynamic<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|avg(origin\_response\_time\_dynamic) as origin\_response\_time\_dynamic\_avg, sum(origin\_response\_time\_dynamic) as wait\_time, pct(origin\_response\_time\_dynamic, 99, 99.9), count by client\_request\_uri<br />\| sort by \_count|
|Cloudflare|Slowest URIs by cumulative time to first byte for static requests|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content)| \_sourceCategory={{\_sourceCategory}} OriginResponseTime\*<br />\| json "ClientRequestURI", "CacheCacheStatus", "OriginResponseTime" as client\_request\_uri, cache\_cache\_status, origin\_response\_time nodrop  <br /> \| where cache\_cache\_status not in ("bypass","unknown")<br />\| origin\_response\_time/1000000 as origin\_response\_time\_static<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|avg(origin\_response\_time\_static) as origin\_response\_time\_static\_avg, sum(origin\_response\_time\_static) as wait\_time, pct(origin\_response\_time\_static, 99, 99.9), count by client\_request\_uri<br />\| sort by \_count|
|Cloudflare|Slowest URIs by cumulative time to first byte for static requests|Logs|Cloudflare/Cloudflare - Performance (Static vs. Dynamic Content)| \_sourceCategory={{\_sourceCategory}} OriginResponseTime\*<br />\| json "ClientRequestURI", "CacheCacheStatus", "OriginResponseTime" as client\_request\_uri, cache\_cache\_status, origin\_response\_time nodrop  <br /> \| where cache\_cache\_status not in ("bypass","unknown")<br />\| origin\_response\_time/1000000 as origin\_response\_time\_static<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|avg(origin\_response\_time\_static) as origin\_response\_time\_static\_avg, sum(origin\_response\_time\_static) as wait\_time, pct(origin\_response\_time\_static, 99, 99.9), count by client\_request\_uri<br />\| sort by \_count|
|Cloudflare|Threats Over Time|Logs|Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != "" <br />\| timeslice 1h   <br />\| count by \_timeslice, threat<br />\| transpose row \_timeslice column threat<br />|
|Cloudflare|Threats Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != "" <br />\| timeslice 1h   <br />\| count by \_timeslice, threat<br />\| transpose row \_timeslice column threat<br />|
|Cloudflare|Threats Over Time|Logs|Cloudflare/Cloudflare - Security (Overview) - New|\_sourceCategory = Labs/Cloudflare ClientCountry\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != "" <br />\| timeslice 1h   <br />\| count by \_timeslice, threat<br />\| transpose row \_timeslice column threat<br />|
|Cloudflare|Threats Stopped|Logs|Cloudflare/Cloudflare - Security (Overview) - New|\_sourceCategory = Labs/Cloudflare EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| count  |
|Cloudflare|Threats Stopped|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| count  |
|Cloudflare|Threats Stopped|Logs|Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| count  |
|Cloudflare|Threats Stopped|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| count  <br />|
|Cloudflare|Threats Stopped|Logs|Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| count  <br />|
|Cloudflare|Threats vs Requests|Logs|Cloudflare/Cloudflare - Security (Overview) - New|\_sourceCategory = Labs/Cloudflare ClientDevice\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\|"Requests" as message\_type <br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "Threats", message\_type) as message\_type<br />\| count by message\_type|
|Cloudflare|Threats vs Requests|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\|"Requests" as message\_type <br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "Threats", message\_type) as message\_type<br />\| count by message\_type|
|Cloudflare|Threats vs Requests|Logs|Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\|"Requests" as message\_type <br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "Threats", message\_type) as message\_type<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "Threats", message\_type) as message\_type<br />\| count by message\_type|
|Cloudflare|Top AS Numbers|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "EdgeResponseStatus", "ClientASN" as edge\_response\_status, client\_asn nodrop<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by client\_asn, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top AS Numbers|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "EdgeResponseStatus", "ClientASN" as edge\_response\_status, client\_asn nodrop<br />\|where edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by client\_asn, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top Bad Bots IPs - AS Number - Country|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientIP", "ClientASN" as edge\_pathing\_src, edge\_pathing\_status, client\_ip, client\_asn nodrop <br /> \| lookup country\_name from geo://location on ip = client\_ip<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_ip matches "{{client\_ip}}"<br />\|sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_ip, client\_asn, country\_name<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| sort by bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count, \_count|
|Cloudflare|Top Bad Bots IPs - AS Number - Country|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientIP", "ClientASN" as edge\_pathing\_src, edge\_pathing\_status, client\_ip, client\_asn nodrop <br /> \| lookup country\_name from geo://location on ip = client\_ip<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_ip matches "{{client\_ip}}"<br />\|sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_ip, client\_asn, country\_name<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| sort by bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count, \_count|
|Cloudflare|Top Bad Bots Referer|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestReferer" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_referer nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_referer<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| sort by bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count, \_count<br />|
|Cloudflare|Top Bad Bots Referer|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestReferer" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_referer nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_referer<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| sort by bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count, \_count<br />|
|Cloudflare|Top Bad Bots Requested URIs|Logs|Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestURI" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_uri nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_uri<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| sort by bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count, \_count|
|Cloudflare|Top Bad Bots Requested URIs|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestURI" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_uri nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_uri<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| sort by bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count, \_count|
|Cloudflare|Top Bad Bots Requested User Agents|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestUserAgent" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_user\_agent nodrop <br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_user\_agent<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| sort by bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count, \_count|
|Cloudflare|Top Bad Bots Requested User Agents|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestUserAgent" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_user\_agent nodrop <br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_user\_agent<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots<br />\| sort by bad\_bots<br />\| fields -bots\_count, false\_detected\_bots\_count, \_count|
|Cloudflare|Top Banned Client IPs|Logs|Cloudflare/Cloudflare - Security (Rate Limiting)|\_sourceCategory={{\_sourceCategory}} EdgeRateLimitAction\* <br />\| json "ClientIP","ClientRequestHost", "EdgeRateLimitAction" as  client\_ip, client\_request\_host, edge\_rate\_limit\_action nodrop<br />\|where client\_ip matches "{{client\_ip}}" AND client\_request\_host matches "{{client\_request\_host}}"<br />\|count by client\_ip, client\_request\_host, edge\_rate\_limit\_action<br />\| where edge\_rate\_limit\_action="ban"<br />\| sort by \_count<br />\| fields -edge\_rate\_limit\_action|
|Cloudflare|Top Banned URIs|Logs|Cloudflare/Cloudflare - Security (Rate Limiting)| \_sourceCategory={{\_sourceCategory}} EdgeRateLimitAction\* <br />\| json "ClientRequestHost", "ClientRequestURI", "EdgeRateLimitAction" as  client\_request\_host, client\_request\_uri, edge\_rate\_limit\_action nodrop <br />\| where edge\_rate\_limit\_action="ban"<br />\|where client\_request\_uri matches "{{client\_request\_uri}}" AND client\_request\_host matches "{{client\_request\_host}}"<br />\|count by client\_request\_uri, client\_request\_host, edge\_rate\_limit\_action<br />\| sort by \_count<br />\| fields -edge\_rate\_limit\_action|
|Cloudflare|Top Client IPs and AS Number|Logs|Cloudflare/Cloudflare - Reliability|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientIP", "EdgeResponseStatus", "ClientASN" as client\_ip, edge\_response\_status, client\_asn nodrop<br />\|where client\_ip matches "{{client\_ip}}" AND edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by client\_ip, client\_asn, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top Client IPs and AS Number|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientIP", "EdgeResponseStatus", "ClientASN" as client\_ip, edge\_response\_status, client\_asn nodrop<br />\|where client\_ip matches "{{client\_ip}}" AND edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by client\_ip, client\_asn, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top Countries|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientCountry", "EdgeResponseStatus" as client\_country, edge\_response\_status nodrop<br />\|where edge\_response\_status matches "{{edge\_response\_status}}" AND client\_country matches "{{client\_country}}"<br />\|count by client\_country, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top Countries|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientCountry", "EdgeResponseStatus" as client\_country, edge\_response\_status nodrop<br />\|where edge\_response\_status matches "{{edge\_response\_status}}" AND client\_country matches "{{client\_country}}"<br />\|count by client\_country, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top False Detected Bots IPs - AS Number - Country|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientIP", "ClientASN" as edge\_pathing\_src, edge\_pathing\_status, client\_ip, client\_asn nodrop <br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_ip matches "{{client\_ip}}"<br />\|sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_ip, client\_asn<br />\| where false\_detected\_bots\_count \> 0<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\| sort by false\_detected\_bots\_count|
|Cloudflare|Top False Detected Bots IPs - AS Number - Country|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientIP", "ClientASN" as edge\_pathing\_src, edge\_pathing\_status, client\_ip, client\_asn nodrop <br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_ip matches "{{client\_ip}}"<br />\|sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_ip, client\_asn<br />\| where false\_detected\_bots\_count \> 0<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\| sort by false\_detected\_bots\_count|
|Cloudflare|Top False Detected Bots Referer|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestReferer" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_referer nodrop <br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_referer<br />\| where false\_detected\_bots\_count \> 0<br />\| sort by false\_detected\_bots\_count<br />\| fields -\_count<br />|
|Cloudflare|Top False Detected Bots Referer|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestReferer" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_referer nodrop <br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_referer<br />\| where false\_detected\_bots\_count \> 0<br />\| sort by false\_detected\_bots\_count<br />\| fields -\_count<br />|
|Cloudflare|Top False Detected Bots Requested URIs|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestURI" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_uri nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_uri<br />\| where false\_detected\_bots\_count \> 0<br />\| sort by false\_detected\_bots\_count<br />\| fields -\_count|
|Cloudflare|Top False Detected Bots Requested URIs|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestURI" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_uri nodrop <br /> \| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_uri<br />\| where false\_detected\_bots\_count \> 0<br />\| sort by false\_detected\_bots\_count<br />\| fields -\_count|
|Cloudflare|Top False Detected Bots Requested User Agents|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestUserAgent" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_user\_agent nodrop <br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_user\_agent<br />\| where false\_detected\_bots\_count \> 0<br />\| sort by false\_detected\_bots\_count<br />\| fields -\_count|
|Cloudflare|Top False Detected Bots Requested User Agents|Logs|Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus", "ClientRequestUserAgent" as edge\_pathing\_src, edge\_pathing\_status, client\_request\_user\_agent nodrop <br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|sum(false\_detected\_bots) as false\_detected\_bots\_count, count by client\_request\_user\_agent<br />\| where false\_detected\_bots\_count \> 0<br />\| sort by false\_detected\_bots\_count<br />\| fields -\_count|
|Cloudflare|Top Hostnames|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "ClientRequestHost", "EdgeResponseStatus" as  client\_request\_host, edge\_response\_status nodrop<br />\|where edge\_response\_status matches "{{edge\_response\_status}}" AND client\_request\_host matches "{{client\_request\_host}}"<br />\|count by client\_request\_host, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top Hostnames|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "ClientRequestHost", "EdgeResponseStatus" as  client\_request\_host, edge\_response\_status nodrop<br />\|where edge\_response\_status matches "{{edge\_response\_status}}" AND client\_request\_host matches "{{client\_request\_host}}"<br />\|count by client\_request\_host, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top IPs - AS Number - Country|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json  "ClientIP", "ClientASN" as client\_ip, client\_asn nodrop<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip, client\_asn<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\| sort \_count|
|Cloudflare|Top IPs - AS Number - Country|Logs|Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json  "ClientIP", "ClientASN" as client\_ip, client\_asn nodrop<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip, client\_asn<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\| sort \_count|
|Cloudflare|Top Pathing Statuses|Logs|Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} EdgePathingStatus\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\| count by edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status<br />\| sort by \_count<br />|
|Cloudflare|Top Pathing Statuses|Logs|Cloudflare/Cloudflare - Security (Overview) - New| \_sourceCategory = Labs/Cloudflare EdgePathingStatus\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\| count by edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status<br />\| sort by \_count<br />|
|Cloudflare|Top Pathing Statuses|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} EdgePathingStatus\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\| count by edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status<br />\| sort by \_count<br />|
|Cloudflare|Top Rate Limit Actions|Logs|Cloudflare/Cloudflare - Security (Rate Limiting)|\_sourceCategory={{\_sourceCategory}} EdgeRateLimitAction\* <br />\| json "EdgeRateLimitAction", "EdgeRateLimitID" as  edge\_rate\_limit\_action, edge\_rate\_limit\_id nodrop <br /> \| count by edge\_rate\_limit\_action, edge\_rate\_limit\_id<br />\| where !isblank(edge\_rate\_limit\_action)<br />\| sort by \_count<br />|
|Cloudflare|Top Rate Limit Countries|Logs|Cloudflare/Cloudflare - Security (Rate Limiting)|\_sourceCategory={{\_sourceCategory}} EdgeRateLimitAction\* <br />\| json "ClientCountry", "EdgeRateLimitAction", "EdgeRateLimitID" as client\_country, edge\_rate\_limit\_action, edge\_rate\_limit\_id nodrop<br />\|where client\_country matches "{{client\_country}}"<br />\|count by client\_country, edge\_rate\_limit\_action, edge\_rate\_limit\_id<br />\| where !isblank(edge\_rate\_limit\_action)<br />\| sort by \_count|
|Cloudflare|Top Referer|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "ClientRequestReferer" as client\_request\_referer nodrop <br />\| count by client\_request\_referer<br />\| sort \_count<br />|
|Cloudflare|Top Referer|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientRequestReferer\*<br />\| json "ClientRequestReferer" as  client\_request\_referer nodrop <br />\| count by client\_request\_referer<br />\| sort by \_count<br />|
|Cloudflare|Top Referer|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientRequestReferer\*<br />\| json "ClientRequestReferer" as  client\_request\_referer nodrop <br />\| count by client\_request\_referer<br />\| sort by \_count<br />|
|Cloudflare|Top Referer|Logs|Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "ClientRequestReferer" as client\_request\_referer nodrop <br />\| count by client\_request\_referer<br />\| sort \_count<br />|
|Cloudflare|Top Requested URIs|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientRequestURI" as  client\_request\_uri nodrop<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|count by client\_request\_uri<br />\| sort by \_count|
|Cloudflare|Top Requested URIs|Logs|Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "ClientRequestURI" as client\_request\_uri nodrop<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|count by client\_request\_uri<br />\| sort \_count|
|Cloudflare|Top Requested URIs|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientRequestURI","EdgeResponseStatus" as client\_request\_uri, edge\_response\_status nodrop<br />\|where client\_request\_uri matches "{{client\_request\_uri}}" AND edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by client\_request\_uri, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top Requested URIs|Logs|Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientRequestURI" as  client\_request\_uri nodrop<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|count by client\_request\_uri<br />\| sort by \_count|
|Cloudflare|Top Requested URIs|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientRequestURI","EdgeResponseStatus" as client\_request\_uri, edge\_response\_status nodrop<br />\|where client\_request\_uri matches "{{client\_request\_uri}}" AND edge\_response\_status matches "{{edge\_response\_status}}"<br />\|count by client\_request\_uri, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top Requested URIs|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "ClientRequestURI" as client\_request\_uri nodrop<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|count by client\_request\_uri<br />\| sort \_count|
|Cloudflare|Top Requested User Agents|Logs|Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "ClientRequestUserAgent" as client\_request\_user\_agent nodrop<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by client\_request\_user\_agent<br />\| sort \_count|
|Cloudflare|Top Requested User Agents|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "ClientRequestUserAgent" as client\_request\_user\_agent nodrop<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by client\_request\_user\_agent<br />\| sort \_count|
|Cloudflare|Top Threat Client IPs|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus","ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip <br />\| sort by \_count|
|Cloudflare|Top Threat Client IPs|Logs|Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus","ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip <br />\| sort by \_count|
|Cloudflare|Top Threat Client IPs|Logs|Cloudflare/Cloudflare - Security (Overview) - New| \_sourceCategory = Labs/Cloudflare EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus","ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\|count by client\_ip <br />\| sort by \_count|
|Cloudflare|Top Threat Countries|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by country\_name<br />\| sort \_count|
|Cloudflare|Top Threat Countries|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by country\_name<br />\| sort \_count|
|Cloudflare|Top Threat Countries|Logs|Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by country\_name<br />\| sort \_count|
|Cloudflare|Top Threat Countries|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by country\_name<br />\| sort \_count|
|Cloudflare|Top Threat Countries|Logs|Cloudflare/Cloudflare - Security (Overview) - New| \_sourceCategory = Labs/Cloudflare ClientIP\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\|count by country\_name<br />\| sort \_count|
|Cloudflare|Top Threat Countries Map|Logs|Cloudflare/Cloudflare - Security (Overview) - New|\_sourceCategory = Labs/Cloudflare ClientIP\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\|count by client\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city<br />\| sort \_count|
|Cloudflare|Top Threat Countries Map|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city<br />\| sort \_count|
|Cloudflare|Top Threat Countries Map|Logs|Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientIP" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_ip nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city<br />\| sort \_count|
|Cloudflare|Top Threat Target URIs|Logs|Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientRequestURI" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status,  client\_request\_uri nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|count by client\_request\_uri <br />\| sort by \_count|
|Cloudflare|Top Threat Target URIs|Logs|Cloudflare/Cloudflare - Security (Overview) - New| \_sourceCategory = Labs/Cloudflare EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientRequestURI" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status,  client\_request\_uri nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where if ("{{client\_request\_uri}}" = "\*", true, client\_request\_uri matches "{{client\_request\_uri}}")<br />\|count by client\_request\_uri <br />\| sort by \_count|
|Cloudflare|Top Threat Target URIs|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientRequestURI" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status,  client\_request\_uri nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|count by client\_request\_uri <br />\| sort by \_count|
|Cloudflare|Top Threat User Agents|Logs|Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientRequestUserAgent" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_request\_user\_agent nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by client\_request\_user\_agent <br />\| sort by \_count|
|Cloudflare|Top Threat User Agents|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientRequestUserAgent" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_request\_user\_agent nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by client\_request\_user\_agent <br />\| sort by \_count|
|Cloudflare|Top Threat User Agents|Logs|Cloudflare/Cloudflare - Security (Overview) - New|\_sourceCategory = Labs/Cloudflare EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus", "ClientRequestUserAgent" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status, client\_request\_user\_agent nodrop <br /> \| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\|where if ("{{client\_request\_user\_agent}}" = "\*", true, client\_request\_user\_agent matches "{{client\_request\_user\_agent}}")<br />\|count by client\_request\_user\_agent <br />\| sort by \_count|
|Cloudflare|Top Threats Stopped|Logs|Cloudflare/Cloudflare - Security (Overview) - New|\_sourceCategory = Labs/Cloudflare EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| count by threat |
|Cloudflare|Top Threats Stopped|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| count by threat |
|Cloudflare|Top Threats Stopped|Logs|Cloudflare/Cloudflare - Security (Overview)|\_sourceCategory={{\_sourceCategory}} EdgePathingSrc <br />\| json "EdgePathingSrc", "EdgePathingOp","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_op, edge\_pathing\_status nodrop <br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip\*", "IP Block", "") as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ctry", "Country Block", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="zl", "Routed by Zone Lockdown", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ua", "Blocked User Agent", threat) as threat<br />\| if (edge\_pathing\_src="user" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="rateLimit", "Blocked by Rate Limiting", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_op="chl", "Challenged by Filter Based Firewall", threat) as threat<br />\| if (edge\_pathing\_src="bic" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Browser Integrity Check", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="hot" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="ip", "Blocked Hotlink", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="unknown", "Bad IP", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaErr", "CAPTCHA Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaFail", "CAPTCHA challenge failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="captchaNew", "New CAPTCHA", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlErr", "Java Script Challenge Error", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlFail", "Java Script Challenge Failed", threat) as threat<br />\| if (edge\_pathing\_src="macro" AND edge\_pathing\_op="chl" AND edge\_pathing\_status="jschlNew", "New Java Script Challenge", threat) as threat<br />\| if (edge\_pathing\_src="protect" AND edge\_pathing\_op="ban" AND edge\_pathing\_status="l7ddos", "L7 DDoS Mitigation", threat) as threat<br />\| where threat != ""<br />\| count by threat |
|Cloudflare|Top Traffic Countries|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "ClientIP" as client\_ip nodrop <br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by country\_name<br />\| sort \_count|
|Cloudflare|Top Traffic Countries|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "ClientIP" as client\_ip nodrop <br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by country\_name<br />\| sort \_count|
|Cloudflare|Top Traffic Countries Map|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json  "ClientIP" as  client\_ip nodrop <br />\| lookup latitude, longitude, country\_code, country\_name, region, city from geo://location on ip = client\_ip<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city <br />\| sort \_count|
|Cloudflare|Top Traffic Countries Map|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json  "ClientIP" as  client\_ip nodrop <br />\| lookup latitude, longitude, country\_code, country\_name, region, city from geo://location on ip = client\_ip<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city <br />\| sort \_count|
|Cloudflare|Top Traffic IPs|Logs|Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientIP" as  client\_ip nodrop<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip<br />\| sort by \_count|
|Cloudflare|Top Traffic IPs|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientIP" as  client\_ip nodrop<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip<br />\| sort by \_count|
|Cloudflare|Top Traffic Type|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientIPClass" as  client\_ip\_class nodrop <br />\| count by client\_ip\_class<br />\| sort by \_count<br /><br /><br />|
|Cloudflare|Top Traffic Type|Logs|Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json "ClientIPClass" as  client\_ip\_class nodrop <br />\| count by client\_ip\_class<br />\| sort by \_count<br /><br /><br />|
|Cloudflare|Top URIs with Cache Status Miss|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "ClientRequestURI","CacheCacheStatus" as client\_request\_uri, cache\_cache\_status nodrop<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|count by cache\_cache\_status, client\_request\_uri<br />\| where cache\_cache\_status="miss" <br />\| order by \_count, client\_request\_uri<br />\| fields -cache\_cache\_status|
|Cloudflare|Top URIs with Cache Status Miss|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "ClientRequestURI","CacheCacheStatus" as client\_request\_uri, cache\_cache\_status nodrop<br />\|where client\_request\_uri matches "{{client\_request\_uri}}"<br />\|count by cache\_cache\_status, client\_request\_uri<br />\| where cache\_cache\_status="miss" <br />\| order by \_count, client\_request\_uri<br />\| fields -cache\_cache\_status|
|Cloudflare|Top URIs with Cache Status Miss|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New| \_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "ClientRequestURI","CacheCacheStatus" as client\_request\_uri, cache\_cache\_status nodrop<br />\|where if ("{{client\_request\_uri}}" = "\*", true, client\_request\_uri matches "{{client\_request\_uri}}")<br />\|count by cache\_cache\_status, client\_request\_uri<br />\| where cache\_cache\_status="miss" <br />\| order by \_count, client\_request\_uri<br />\| fields -cache\_cache\_status|
|Cloudflare|Top User Agents|Logs|Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "ClientRequestUserAgent" as  client\_request\_user\_agent nodrop<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by client\_request\_user\_agent<br />\| sort by \_count|
|Cloudflare|Top User Agents|Logs|Installed Apps/Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "ClientRequestUserAgent","EdgeResponseStatus" as client\_request\_user\_agent, edge\_response\_status nodrop<br />\|where edge\_response\_status matches "{{edge\_response\_status}}" AND client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by client\_request\_user\_agent, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top User Agents|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot|\_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "ClientRequestUserAgent" as  client\_request\_user\_agent nodrop<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by client\_request\_user\_agent<br />\| sort by \_count|
|Cloudflare|Top User Agents|Logs|Cloudflare/Cloudflare - Reliability| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br />\| json  "ClientRequestUserAgent","EdgeResponseStatus" as client\_request\_user\_agent, edge\_response\_status nodrop<br />\|where edge\_response\_status matches "{{edge\_response\_status}}" AND client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by client\_request\_user\_agent, edge\_response\_status<br />\| sort by \_count|
|Cloudflare|Top WAF Rules Triggered|Logs|Installed Apps/Cloudflare/Cloudflare - Security (WAF)| \_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json  "SecurityRuleID", "SecurityRuleDescription" as  waf\_rule\_id, waf\_rule\_message nodrop <br />\| where !isblank(waf\_rule\_id)<br />\| count by waf\_rule\_id, waf\_rule\_message<br />\| sort by \_count|
|Cloudflare|Top WAF Rules Triggered|Logs|Cloudflare/Cloudflare - Security (WAF)| \_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json  "SecurityRuleID", "SecurityRuleDescription" as  waf\_rule\_id, waf\_rule\_message nodrop <br />\| where !isblank(waf\_rule\_id)<br />\| count by waf\_rule\_id, waf\_rule\_message<br />\| sort by \_count|
|Cloudflare|Total Bandwidth|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes" as  edge\_response\_bytes nodrop <br /> \| sum(edge\_response\_bytes) as total\_bandwidth <br />\| format("%.2f KB",total\_bandwidth/1Ki) as total\_bandwidth\_final<br />\| if (total\_bandwidth \> 1Mi, format("%.2f MB",total\_bandwidth / 1Mi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Gi, format("%.2f GB",total\_bandwidth / 1Gi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Ti, format("%.2f TB",total\_bandwidth / 1Ti),total\_bandwidth\_final) as total\_bandwidth\_final    <br />\| fields - total\_bandwidth <br />|
|Cloudflare|Total Bandwidth|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json  "EdgeResponseBytes" as  edge\_response\_bytes nodrop <br />\| sum(edge\_response\_bytes) as total\_bandwidth <br />\| format("%.2f KB",total\_bandwidth/1Ki) as total\_bandwidth\_final<br />\| if (total\_bandwidth \> 1Mi, format("%.2f MB",total\_bandwidth / 1Mi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Gi, format("%.2f GB",total\_bandwidth / 1Gi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Ti, format("%.2f TB",total\_bandwidth / 1Ti),total\_bandwidth\_final) as total\_bandwidth\_final    <br />\| fields - total\_bandwidth <br />|
|Cloudflare|Total Bandwidth|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes" as  edge\_response\_bytes nodrop <br /> \| sum(edge\_response\_bytes) as total\_bandwidth <br />\| format("%.2f KB",total\_bandwidth/1Ki) as total\_bandwidth\_final<br />\| if (total\_bandwidth \> 1Mi, format("%.2f MB",total\_bandwidth / 1Mi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Gi, format("%.2f GB",total\_bandwidth / 1Gi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Ti, format("%.2f TB",total\_bandwidth / 1Ti),total\_bandwidth\_final) as total\_bandwidth\_final    <br />\| fields - total\_bandwidth <br />|
|Cloudflare|Total Bandwidth|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New| \_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "EdgeResponseBytes" as  edge\_response\_bytes nodrop <br /> \| sum(edge\_response\_bytes) as total\_bandwidth <br />\| format("%.2f KB",total\_bandwidth/1Ki) as total\_bandwidth\_final<br />\| if (total\_bandwidth \> 1Mi, format("%.2f MB",total\_bandwidth / 1Mi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Gi, format("%.2f GB",total\_bandwidth / 1Gi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Ti, format("%.2f TB",total\_bandwidth / 1Ti),total\_bandwidth\_final) as total\_bandwidth\_final    <br />\| fields - total\_bandwidth <br />|
|Cloudflare|Total Bandwidth|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json  "EdgeResponseBytes" as  edge\_response\_bytes nodrop <br />\| sum(edge\_response\_bytes) as total\_bandwidth <br />\| format("%.2f KB",total\_bandwidth/1Ki) as total\_bandwidth\_final<br />\| if (total\_bandwidth \> 1Mi, format("%.2f MB",total\_bandwidth / 1Mi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Gi, format("%.2f GB",total\_bandwidth / 1Gi),total\_bandwidth\_final) as total\_bandwidth\_final  <br />\| if (total\_bandwidth \> 1Ti, format("%.2f TB",total\_bandwidth / 1Ti),total\_bandwidth\_final) as total\_bandwidth\_final    <br />\| fields - total\_bandwidth <br />|
|Cloudflare|Total Bandwidth vs Origin Bandwidth in bps Last 24 Hours|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json  "OriginResponseStatus", "EdgeResponseBytes" as origin\_response\_status, edge\_response\_bytes nodrop <br />\| timeslice 1s<br />\| if (origin\_response\_status!=0, edge\_response\_bytes,0) as origin\_bandwidth<br />\|where origin\_response\_status matches "{{origin\_response\_status}}"<br />\|sum(origin\_bandwidth) as origin\_bandwidth, sum(edge\_response\_bytes) as total\_bandwidth by \_timeslice|
|Cloudflare|Total Bandwidth vs Origin Bandwidth in bps Last 24 Hours|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json  "OriginResponseStatus", "EdgeResponseBytes" as origin\_response\_status, edge\_response\_bytes nodrop <br />\| timeslice 1s<br />\| if (origin\_response\_status!=0, edge\_response\_bytes,0) as origin\_bandwidth<br />\|where origin\_response\_status matches "{{origin\_response\_status}}"<br />\|sum(origin\_bandwidth) as origin\_bandwidth, sum(edge\_response\_bytes) as total\_bandwidth by \_timeslice|
|Cloudflare|Total Bandwidth vs Origin Bandwidth in bps Last 24 Hours|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New|\_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json  "OriginResponseStatus", "EdgeResponseBytes" as origin\_response\_status, edge\_response\_bytes nodrop <br />\| timeslice 1s<br />\| if (origin\_response\_status!=0, edge\_response\_bytes,0) as origin\_bandwidth<br />\|where if ("{{origin\_response\_status}}" = "\*", true, origin\_response\_status matches "{{origin\_response\_status}}")<br />\|sum(origin\_bandwidth) as origin\_bandwidth, sum(edge\_response\_bytes) as total\_bandwidth by \_timeslice|
|Cloudflare|Total Number of Requests|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br /> \| count <br />|
|Cloudflare|Total Number of Requests|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br /> \| count <br />|
|Cloudflare|Total Number of Requests|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br /> \| count <br />|
|Cloudflare|Total Number of Requests|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br /> \| count <br />|
|Cloudflare|Total Number of Requests|Logs|Cloudflare/Cloudflare - Security (Overview) - New| \_sourceCategory = Labs/Cloudflare ClientCountry\*<br /> \| count <br />|
|Cloudflare|Total Number of Requests|Logs|Cloudflare/Cloudflare - Security (Overview)| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br /> \| count <br />|
|Cloudflare|Total Number of Requests|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br /> \| count |
|Cloudflare|Total Number of Requests|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br /> \| count |
|Cloudflare|Total Number of Requests|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New| \_sourceCategory = Labs/Cloudflare ClientCountry\*<br /> \| count <br />|
|Cloudflare|Total Number of Requests|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientCountry\*<br /> \| count <br />|
|Cloudflare|Total Number of Requests vs Cached vs Uncached Over Time|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New|  \_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop  <br />\| timeslice 30m<br />\| if (cache\_cache\_status="hit" or cache\_cache\_status="stale" or cache\_cache\_status="updating"or cache\_cache\_status="ignored", 1, 0) as cached\_requests<br />\| if (cache\_cache\_status not in("hit", "stale", "updating", "ignored"), 1, 0) as uncached\_requests<br />\| if (cache\_cache\_status matches "\*", 1,0) as total\_requests<br />\| sum(cached\_requests) as cached\_requests\_count, sum(uncached\_requests) as uncachedRequests\_count, sum(total\_requests) as total\_requests\_count by \_timeslice<br />|
|Cloudflare|Total Number of Requests vs Cached vs Uncached Over Time|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|  \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop  <br />\| timeslice 30m<br />\| if (cache\_cache\_status="hit" or cache\_cache\_status="stale" or cache\_cache\_status="updating"or cache\_cache\_status="ignored", 1, 0) as cached\_requests<br />\| if (cache\_cache\_status not in("hit", "stale", "updating", "ignored"), 1, 0) as uncached\_requests<br />\| if (cache\_cache\_status matches "\*", 1,0) as total\_requests<br />\| sum(cached\_requests) as cached\_requests\_count, sum(uncached\_requests) as uncachedRequests\_count, sum(total\_requests) as total\_requests\_count by \_timeslice<br />|
|Cloudflare|Total Number of Requests vs Cached vs Uncached Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|  \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop  <br />\| timeslice 30m<br />\| if (cache\_cache\_status="hit" or cache\_cache\_status="stale" or cache\_cache\_status="updating"or cache\_cache\_status="ignored", 1, 0) as cached\_requests<br />\| if (cache\_cache\_status not in("hit", "stale", "updating", "ignored"), 1, 0) as uncached\_requests<br />\| if (cache\_cache\_status matches "\*", 1,0) as total\_requests<br />\| sum(cached\_requests) as cached\_requests\_count, sum(uncached\_requests) as uncachedRequests\_count, sum(total\_requests) as total\_requests\_count by \_timeslice<br />|
|Cloudflare|Total Requests vs Bad Bots Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_status nodrop <br /> \| timeslice 1h<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| count(\*) as total\_requests, sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count by \_timeslice<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots <br />\| fields -bots\_count, false\_detected\_bots\_count<br />|
|Cloudflare|Total Requests vs Bad Bots Over Time|Logs|Cloudflare/Cloudflare - Security (Bot Management)| \_sourceCategory={{\_sourceCategory}} ClientIP\*<br />\| json "EdgePathingSrc","EdgePathingStatus" as edge\_pathing\_src, edge\_pathing\_status nodrop <br /> \| timeslice 1h<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaNew",1,0) as bots<br />\| if (edge\_pathing\_src="filterBasedFirewall" AND edge\_pathing\_status="captchaSucc",1,0) as false\_detected\_bots<br />\| count(\*) as total\_requests, sum(bots) as bots\_count, sum(false\_detected\_bots) as false\_detected\_bots\_count by \_timeslice<br />\| (bots\_count-false\_detected\_bots\_count) as bad\_bots <br />\| fields -bots\_count, false\_detected\_bots\_count<br />|
|Cloudflare|Total Requests vs. Origin Requests in rps Last 24 Hours|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "OriginResponseStatus" as  origin\_response\_status nodrop <br />\| timeslice 1s <br />\| if (origin\_response\_status!=0, 1, 0) as origin\_requests<br />\|where origin\_response\_status matches "{{origin\_response\_status}}"<br />\|sum(origin\_requests) as origin\_requests\_count, count as total\_requests\_count by \_timeslice|
|Cloudflare|Total Requests vs. Origin Requests in rps Last 24 Hours|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "OriginResponseStatus" as  origin\_response\_status nodrop <br />\| timeslice 1s <br />\| if (origin\_response\_status!=0, 1, 0) as origin\_requests<br />\|where origin\_response\_status matches "{{origin\_response\_status}}"<br />\|sum(origin\_requests) as origin\_requests\_count, count as total\_requests\_count by \_timeslice|
|Cloudflare|Total Requests vs. Origin Requests in rps Last 24 Hours|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New|\_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "OriginResponseStatus" as  origin\_response\_status nodrop <br />\| timeslice 1s <br />\| if (origin\_response\_status!=0, 1, 0) as origin\_requests<br />\|where if ("{{origin\_response\_status}}" = "\*", true, origin\_response\_status matches "{{origin\_response\_status}}")<br />\|sum(origin\_requests) as origin\_requests\_count, count as total\_requests\_count by \_timeslice|
|Cloudflare|Traffic Type|Logs|Installed Apps/Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json  "ClientDeviceType" as  client\_device\_type nodrop<br />\|where client\_device\_type matches "{{client\_device\_type}}"<br />\|count by client\_device\_type|
|Cloudflare|Traffic Type|Logs|Cloudflare/Cloudflare - Snapshot| \_sourceCategory={{\_sourceCategory}} ClientDevice\*<br />\| json  "ClientDeviceType" as  client\_device\_type nodrop<br />\|where client\_device\_type matches "{{client\_device\_type}}"<br />\|count by client\_device\_type|
|Cloudflare|Uncached Bandwidth|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as edge\_response\_bytes, cache\_cache\_status nodrop  <br /> \| where cache\_cache\_status not in ("hit", "stale", "updating", "ignored", "revalidated")<br />\| sum(edge\_response\_bytes) as uncached\_bandwidth <br />\| format("%.2f KB",uncached\_bandwidth/1Ki) as uncached\_bandwidth\_final<br />\| if (uncached\_bandwidth \> 1Mi, format("%.2f MB",uncached\_bandwidth / 1Mi),uncached\_bandwidth\_final) as uncached\_bandwidth\_final  <br />\| if (uncached\_bandwidth \> 1Gi, format("%.2f GB",uncached\_bandwidth / 1Gi),uncached\_bandwidth\_final) as uncached\_bandwidth\_final  <br />\| if (uncached\_bandwidth \> 1Ti, format("%.2f TB",uncached\_bandwidth / 1Ti),uncached\_bandwidth\_final) as uncached\_bandwidth\_final    <br />\| fields - uncached\_bandwidth<br />|
|Cloudflare|Uncached Bandwidth|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New|\_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as edge\_response\_bytes, cache\_cache\_status nodrop  <br /> \| where cache\_cache\_status not in ("hit", "stale", "updating", "ignored", "revalidated")<br />\| sum(edge\_response\_bytes) as uncached\_bandwidth <br />\| format("%.2f KB",uncached\_bandwidth/1Ki) as uncached\_bandwidth\_final<br />\| if (uncached\_bandwidth \> 1Mi, format("%.2f MB",uncached\_bandwidth / 1Mi),uncached\_bandwidth\_final) as uncached\_bandwidth\_final  <br />\| if (uncached\_bandwidth \> 1Gi, format("%.2f GB",uncached\_bandwidth / 1Gi),uncached\_bandwidth\_final) as uncached\_bandwidth\_final  <br />\| if (uncached\_bandwidth \> 1Ti, format("%.2f TB",uncached\_bandwidth / 1Ti),uncached\_bandwidth\_final) as uncached\_bandwidth\_final    <br />\| fields - uncached\_bandwidth<br />|
|Cloudflare|Uncached Bandwidth|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)|\_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "EdgeResponseBytes", "CacheCacheStatus" as edge\_response\_bytes, cache\_cache\_status nodrop  <br /> \| where cache\_cache\_status not in ("hit", "stale", "updating", "ignored", "revalidated")<br />\| sum(edge\_response\_bytes) as uncached\_bandwidth <br />\| format("%.2f KB",uncached\_bandwidth/1Ki) as uncached\_bandwidth\_final<br />\| if (uncached\_bandwidth \> 1Mi, format("%.2f MB",uncached\_bandwidth / 1Mi),uncached\_bandwidth\_final) as uncached\_bandwidth\_final  <br />\| if (uncached\_bandwidth \> 1Gi, format("%.2f GB",uncached\_bandwidth / 1Gi),uncached\_bandwidth\_final) as uncached\_bandwidth\_final  <br />\| if (uncached\_bandwidth \> 1Ti, format("%.2f TB",uncached\_bandwidth / 1Ti),uncached\_bandwidth\_final) as uncached\_bandwidth\_final    <br />\| fields - uncached\_bandwidth<br />|
|Cloudflare|Uncached Requests|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache) - New| \_sourceCategory = Labs/Cloudflare EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop <br />\| where cache\_cache\_status not in ("hit", "stale", "updating", "ignored")<br />\| count<br />\| sum(\_count) as uncached\_requests<br />|
|Cloudflare|Uncached Requests|Logs|Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop <br />\| where cache\_cache\_status not in ("hit", "stale", "updating", "ignored")<br />\| count<br />\| sum(\_count) as uncached\_requests<br />|
|Cloudflare|Uncached Requests|Logs|Installed Apps/Cloudflare/Cloudflare - Performance (Requests, Bandwidth, Cache)| \_sourceCategory={{\_sourceCategory}} EdgeResponseBytes\*<br />\| json "CacheCacheStatus" as cache\_cache\_status nodrop <br />\| where cache\_cache\_status not in ("hit", "stale", "updating", "ignored")<br />\| count<br />\| sum(\_count) as uncached\_requests<br />|
|Cloudflare|WAF Events Over Time|Logs|Installed Apps/Cloudflare/Cloudflare - Security (WAF)| \_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json "SecurityRuleID" as  waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br /> \| count by waf\_rule\_id<br />\| sort by \_count<br />|
|Cloudflare|WAF Events Over Time|Logs|Cloudflare/Cloudflare - Security (WAF)| \_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json "SecurityRuleID" as  waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br /> \| count by waf\_rule\_id<br />\| sort by \_count<br />|
|Cloudflare|WAF: Top Client IPs|Logs|Cloudflare/Cloudflare - Security (WAF)|\_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json "ClientIP", "SecurityRuleID" as client\_ip, waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip, waf\_rule\_id<br />\| sort by \_count<br />\| fields -waf\_rule\_id|
|Cloudflare|WAF: Top Client IPs|Logs|Installed Apps/Cloudflare/Cloudflare - Security (WAF)|\_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json "ClientIP", "SecurityRuleID" as client\_ip, waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br />\|where client\_ip matches "{{client\_ip}}"<br />\|count by client\_ip, waf\_rule\_id<br />\| sort by \_count<br />\| fields -waf\_rule\_id|
|Cloudflare|WAF: Top Countries|Logs|Installed Apps/Cloudflare/Cloudflare - Security (WAF)| \_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json "ClientCountry", "SecurityRuleID"as  client\_country, waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br />\|where client\_country matches "{{client\_country}}"<br />\|count by client\_country, waf\_rule\_id<br />\| sort by \_count<br />\| fields -waf\_rule\_id|
|Cloudflare|WAF: Top Countries|Logs|Cloudflare/Cloudflare - Security (WAF)| \_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json "ClientCountry", "SecurityRuleID"as  client\_country, waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br />\|where client\_country matches "{{client\_country}}"<br />\|count by client\_country, waf\_rule\_id<br />\| sort by \_count<br />\| fields -waf\_rule\_id|
|Cloudflare|WAF: Top Hosts|Logs|Installed Apps/Cloudflare/Cloudflare - Security (WAF)|\_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json "ClientRequestHost","SecurityRuleID" as  client\_request\_host, waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br />\|where client\_request\_host matches "{{client\_request\_host}}"<br />\|count by client\_request\_host, waf\_rule\_id<br />\| sort by \_count|
|Cloudflare|WAF: Top Hosts|Logs|Cloudflare/Cloudflare - Security (WAF)|\_sourceCategory={{\_sourceCategory}} SecurityRuleID\*<br />\| json "ClientRequestHost","SecurityRuleID" as  client\_request\_host, waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br />\|where client\_request\_host matches "{{client\_request\_host}}"<br />\|count by client\_request\_host, waf\_rule\_id<br />\| sort by \_count|
|Cloudflare|WAF: Top User Agents|Logs|Installed Apps/Cloudflare/Cloudflare - Security (WAF)| \_sourceCategory={{\_sourceCategory}}  SecurityRuleID\*<br />\| json "ClientRequestUserAgent", "SecurityRuleID" as  client\_request\_user\_agent, waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by waf\_rule\_id, client\_request\_user\_agent<br />\| sort by \_count|
|Cloudflare|WAF: Top User Agents|Logs|Cloudflare/Cloudflare - Security (WAF)| \_sourceCategory={{\_sourceCategory}}  SecurityRuleID\*<br />\| json "ClientRequestUserAgent", "SecurityRuleID" as  client\_request\_user\_agent, waf\_rule\_id nodrop <br />\| where !isblank(waf\_rule\_id)<br />\|where client\_request\_user\_agent matches "{{client\_request\_user\_agent}}"<br />\|count by waf\_rule\_id, client\_request\_user\_agent<br />\| sort by \_count|

