# IIS 10 (Legacy)

## Searches

### Log Searches

- **Counters_HTTPServiceRequestQueues Log Parser**: from Search: IIS 10 (Legacy)/Performance/Counters_HTTPServiceRequestQueues Log Parser 
- **IIS 10 - All HTTP Response Codes with their Count**: from Search: IIS 10 (Legacy)/Server Operations/IIS 10 - All HTTP Response Codes with their Count 
- **IIS 10 - Client Errors (4xx response codes) per Day**: from Search: IIS 10 (Legacy)/Server Operations/IIS 10 - Client Errors (4xx response codes) per Day 
- **IIS 10 - HTTP Status Code Summary over time**: from Search: IIS 10 (Legacy)/Server Operations/IIS 10 - HTTP Status Code Summary over time 
- **IIS 10 - Malicious URL Requests**: from Search: IIS 10 (Legacy)/Traffic Insights/IIS 10 - Malicious URL Requests 
- **IIS 10 - Robots**: from Search: IIS 10 (Legacy)/Traffic Insights/IIS 10 - Robots 
- **IIS 10 - Slowest URLs by Average Time**: from Search: IIS 10 (Legacy)/Server Operations/IIS 10 - Slowest URLs by Average Time 
- **IIS 10 - Time Taken to Serve Requests**: from Search: IIS 10 (Legacy)/Server Operations/IIS 10 - Time Taken to Serve Requests 
- **IIS 10 - Top 404 URLs**: from Search: IIS 10 (Legacy)/Server Operations/IIS 10 - Top 404 URLs 
- **IIS 10 - Top Browsers**: from Search: IIS 10 (Legacy)/Traffic Insights/IIS 10 - Top Browsers 
- **IIS 10 - Top Clients**: from Search: IIS 10 (Legacy)/Traffic Insights/IIS 10 - Top Clients 
- **IIS 10 - Top Clients Causing Errors**: from Search: IIS 10 (Legacy)/Server Operations/IIS 10 - Top Clients Causing Errors 
- **IIS 10 - Top URLs by Count**: from Search: IIS 10 (Legacy)/Traffic Insights/IIS 10 - Top URLs by Count 
- **IIS 10 - Traffic Volume Served per Day**: from Search: IIS 10 (Legacy)/Traffic Insights/IIS 10 - Traffic Volume Served per Day 
- **W3SVC_WebService Log Parser**: from Search: IIS 10 (Legacy)/Performance/W3SVC_WebService Log Parser

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|IIS 10 (Legacy)/Performance|Counters\_HTTPServiceRequestQueues Log Parser|Logs|IIS 10 (Legacy)/Performance/Counters\_HTTPServiceRequestQueues Log Parser|\_sourceCategory = Labs/Webserver/IIS/PerfCounter Win32\_PerfFormattedData\_Counters\_HTTPServiceRequestQueues <br />\| parse "Name = \\"\*\\";" as Name nodrop<br />\| parse "ArrivalRate = \\"\*\\";" as ArrivalRate nodrop<br />\| parse "CacheHitRate = \\"\*\\";" as CacheHitRate nodrop<br />\|	parse "CurrentQueueSize = \*;" as CurrentQueueSize nodrop<br />\|	parse "MaxQueueItemAge = \\"\*\\";" as MaxQueueItemAge nodrop<br />\|	parse "RejectionRate = \\"\*\\";" as RejectionRate nodrop|
|IIS 10 (Legacy)/Server Operations|IIS 10 - All HTTP Response Codes with their Count|Logs|IIS 10 (Legacy)/Server Operations/IIS 10 - All HTTP Response Codes with their Count|\_sourceCategory = Labs/Webserver/IIS/Access <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by sc\_status <br />\| sort by \_count|
|IIS 10 (Legacy)/Server Operations|IIS 10 - Client Errors (4xx response codes) per Day|Logs|IIS 10 (Legacy)/Server Operations/IIS 10 - Client Errors (4xx response codes) per Day|\_sourceCategory = Labs/Webserver/IIS/Access 4\*<br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "4\*" <br />\| timeslice by 1d <br />\| count by \_timeslice<br />\| sort by \_timeslice|
|IIS 10 (Legacy)/Server Operations|IIS 10 - HTTP Status Code Summary over time|Logs|IIS 10 (Legacy)/Server Operations/IIS 10 - HTTP Status Code Summary over time|\_sourceCategory = Labs/Webserver/IIS/Access <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors <br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1d <br />\| sum(successes) as successes, sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by \_timeslice|
|IIS 10 (Legacy)/Traffic Insights|IIS 10 - Malicious URL Requests|Logs|IIS 10 (Legacy)/Traffic Insights/IIS 10 - Malicious URL Requests|\_sourceCategory = Labs/Webserver/IIS/Access ("jsessionid" or "old" or "bak") <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where cs\_uri\_stem matches "\*.old" or cs\_uri\_stem matches "\*.bak" or cs\_uri\_query matches "\*jsessionid=\*"|
|IIS 10 (Legacy)/Traffic Insights|IIS 10 - Robots|Logs|IIS 10 (Legacy)/Traffic Insights/IIS 10 - Robots|\_sourceCategory = Labs/Webserver/IIS/Access "/robots.txt" <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where cs\_uri\_stem = "/robots.txt"<br />\| count\_frequent cs\_User\_Agent|
|IIS 10 (Legacy)/Server Operations|IIS 10 - Slowest URLs by Average Time|Logs|IIS 10 (Legacy)/Server Operations/IIS 10 - Slowest URLs by Average Time|\_sourceCategory = Labs/Webserver/IIS/Access <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| (time\_taken/1000) as seconds <br />\| avg(seconds) as avgtimeinseconds by cs\_uri\_stem <br />\| sort by avgtimeinseconds <br />\| limit 100|
|IIS 10 (Legacy)/Server Operations|IIS 10 - Time Taken to Serve Requests|Logs|IIS 10 (Legacy)/Server Operations/IIS 10 - Time Taken to Serve Requests|\_sourceCategory = Labs/Webserver/IIS/Access <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"  <br />\| (time\_taken/1000) as seconds <br />\| seconds/60 as minutes |
|IIS 10 (Legacy)/Server Operations|IIS 10 - Top 404 URLs|Logs|IIS 10 (Legacy)/Server Operations/IIS 10 - Top 404 URLs|\_sourceCategory = Labs/Webserver/IIS/Access 404 <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "404" <br />\| count\_frequent cs\_uri\_stem <br />\| limit 100|
|IIS 10 (Legacy)/Traffic Insights|IIS 10 - Top Browsers|Logs|IIS 10 (Legacy)/Traffic Insights/IIS 10 - Top Browsers|\_sourceCategory = Labs/Webserver/IIS/Access <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count\_frequent cs\_user\_agent <br />\| limit 100|
|IIS 10 (Legacy)/Traffic Insights|IIS 10 - Top Clients|Logs|IIS 10 (Legacy)/Traffic Insights/IIS 10 - Top Clients|\_sourceCategory = Labs/Webserver/IIS/Access <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count\_frequent c\_ip <br />\| limit 100|
|IIS 10 (Legacy)/Server Operations|IIS 10 - Top Clients Causing Errors|Logs|IIS 10 (Legacy)/Server Operations/IIS 10 - Top Clients Causing Errors|\_sourceCategory = Labs/Webserver/IIS/Access 4\*<br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "4\*" <br />\| count\_frequent c\_ip <br />\| limit 100|
|IIS 10 (Legacy)/Traffic Insights|IIS 10 - Top URLs by Count|Logs|IIS 10 (Legacy)/Traffic Insights/IIS 10 - Top URLs by Count|\_sourceCategory = Labs/Webserver/IIS/Access <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count\_frequent cs\_uri\_stem <br />\| limit 100|
|IIS 10 (Legacy)/Traffic Insights|IIS 10 - Traffic Volume Served per Day|Logs|IIS 10 (Legacy)/Traffic Insights/IIS 10 - Traffic Volume Served per Day|\_sourceCategory = Labs/Webserver/IIS/Access <br />// #Fields: date time s-ip cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Referer) sc-status sc-substatus sc-win32-status time-taken // Default Log format for IIS V8.5 and IIS V10.0<br />\| parse regex "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| timeslice by 1d <br />\| count as hits by \_timeslice<br />\| sort by \_timeslice|
|IIS 10 (Legacy)/Performance|W3SVC\_WebService Log Parser|Logs|IIS 10 (Legacy)/Performance/W3SVC\_WebService Log Parser|\_sourceCategory = Labs/Webserver/IIS/PerfCounter Win32\_PerfFormattedData\_W3SVC\_WebService<br />\| parse "Name = \\"\*\\";" as Name nodrop<br />\| parse "BytesReceivedPersec = \\"\*\\";" as BytesReceivedPersec nodrop<br />\| parse	"BytesSentPersec = \\"\*\\";" as BytesSentPersec nodrop<br />\| parse	"BytesTotalPersec = \\"\*\\";" as BytesTotalPersec nodrop<br />\| parse	"CGIRequestsPersec = \*;" as CGIRequestsPersec nodrop<br />\| parse	"CurrentAnonymousUsers = \*;" as CurrentAnonymousUsers nodrop<br />\| parse	"CurrentConnections = \*;" as CurrentConnections nodrop<br />\| parse	"CurrentNonAnonymousUsers = \*;" as CurrentNonAnonymousUsers nodrop<br />\| parse	"FilesReceivedPersec = \*;" as FilesReceivedPersec nodrop<br />\| parse	"FilesSentPersec = \*;" as FilesSentPersec nodrop<br />\| parse	"GetRequestsPersec = \*;" as GetRequestsPersec nodrop<br />\| parse	"ISAPIExtensionRequestsPersec = \*;" as GetRequestsPersec nodrop<br />\| parse	"PostRequestsPersec = \*;" as PostRequestsPersec nodrop<br />\| parse	"ServiceUptime = \*;" as ServiceUptime nodrop<br />\| parse "TotalMethodRequestsPersec = \*;" as TotalMethodRequestsPersec nodrop<br />|

