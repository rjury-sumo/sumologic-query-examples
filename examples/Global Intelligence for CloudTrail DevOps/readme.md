# Global Intelligence for CloudTrail DevOps
## Sumo Logic App For: Global Intelligence for CloudTrail DevOps
Global Intelligence for AWS CloudTrail - DevOps helps infrastructure engineers configure managed AWS services for outage-resistance and on-call staff to accelerate root cause analysis for incidents by providing insights sourced from error rates and configuration practices baselined across Sumo Logic and AWS customers.
Docs Link: [Global Intelligence for CloudTrail DevOps](https://help.sumologic.com/?cid=6067)

## Searches

### Log Searches

- **Autoscaling Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Autoscaling Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Autoscaling Users Experiencing Throttling Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **DynamoDB Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **DynamoDB Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **DynamoDB Users Experiencing Throttling Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **EC2 Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **EC2 Users Experiencing Insufficient Capacity  Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **EC2 Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **EC2 Users Experiencing Throttling Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **ElastiCache Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **ElastiCache Users Experiencing Insufficient Capacity  Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **ElastiCache Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **ElastiCache Users Experiencing Throttling Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **ELB Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **ELB Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **ELB Users Experiencing Throttling Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Lambda Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Lambda Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Lambda Users Experiencing Throttling  Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **RDS Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **RDS Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **RDS Users Experiencing Throttling Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Redshift Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Redshift Users Experiencing Insufficient Capacity  Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Redshift Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **Redshift Users Experiencing Throttling Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **S3 Users Experiencing Account Quota Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **S3 Users Experiencing Service Availability Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New 
- **S3 Users Experiencing Throttling Errors**: from Dashboard: Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Global Intelligence for CloudTrail DevOps|Autoscaling Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_autoscaling<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall autoscaling errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "autoscaling" and errorCode matches "\*LimitExceeded\*"<br />\| parse "\\"autoScalingGroupName\\":\\"\*\\"" as autoScalingGroupName nodrop<br />\| parse "\\"serviceNamespace\\":\\"\*\\"" as serviceNamespace nodrop<br />\| if(!isBlank(autoScalingGroupName), "ec2", "unknown") as ec2GroupName<br />\| if(!isBlank(serviceNamespace), serviceNamespace, if(ec2GroupName != "unknown", "ec2-autoscaling", "unknown")) as serviceNamespace<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, ec2GroupName, serviceNamespace, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, ec2GroupName, serviceNamespace, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, ec2GroupName, serviceNamespace, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Autoscaling Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_autoscaling<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall autoscaling errorCode (InternalServiceException OR InternalFailure OR ServiceUnavailable) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "autoscaling" and errorCode in ("InternalServiceException", "InternalFailure", "ServiceUnavailable")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Autoscaling Users Experiencing Throttling Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_autoscaling<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall autoscaling errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "autoscaling" and errorCode = "ThrottlingException"<br />\| parse "\\"autoScalingGroupName\\":\\"\*\\"" as autoScalingGroupName nodrop<br />\| parse "\\"serviceNamespace\\":\\"\*\\"" as serviceNamespace nodrop<br />\| if(!isBlank(autoScalingGroupName), "ec2", "unknown") as ec2GroupName<br />\| if(!isBlank(serviceNamespace), serviceNamespace, if(ec2GroupName != "unknown", "ec2-autoscaling", "unknown")) as serviceNamespace<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, ec2GroupName, serviceNamespace, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, ec2GroupName, serviceNamespace, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, ec2GroupName, serviceNamespace, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|DynamoDB Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_dynamodb<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall dynamodb errorCode (\*LimitExceeded\*) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"tableName\\":\\"\*\\"" as tableName nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "dynamodb" and errorCode matches "\*LimitExceeded\*"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, tableName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, tableName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, tableName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|DynamoDB Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_dynamodb<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall dynamodb errorCode (InternalServerError OR InternalFailure OR ServiceUnavailable) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "dynamodb" and errorCode in ("InternalServerError", "InternalFailure", "ServiceUnavailable")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|DynamoDB Users Experiencing Throttling Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_dynamodb<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall dynamodb errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"tableName\\":\\"\*\\"" as tableName nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "dynamodb" and errorCode in ("ProvisionedThroughputExceededException", "ThrottlingException")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, tableName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, tableName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, tableName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|EC2 Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_ec2<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall ec2 errorCode (\*LimitExceeded\* AND !\*RequestLimitExceeded) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"instanceType\\":\\"\*\\"" as instanceType nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "ec2" and errorCode matches "\*LimitExceeded\*" and !(errorCode matches "\*RequestLimitExceeded")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|EC2 Users Experiencing Insufficient Capacity  Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_insufficientCapacity\_ec2\_resource<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall ec2 errorCode (RunInstances OR CreateFleet OR RequestSpotInstances) (\*Insufficient\*) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"instanceType\\":\\"\*\\"" as instanceType<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "ec2" and eventName in ("RunInstances", "CreateFleet", "RequestSpotInstances") and errorCode matches "\*Insufficient\*"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|EC2 Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_ec2<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall ec2 errorCode (Server.Unavailable OR Server.InternalFailure OR Server.ServiceUnavailable OR Server.InternalError) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "ec2" and errorCode in ("Server.Unavailable", "Server.InternalFailure", "Server.ServiceUnavailable", "Server.InternalError")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|EC2 Users Experiencing Throttling Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_ec2<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall ec2 errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"instanceType\\":\\"\*\\"" as instanceType nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "ec2" and errorCode matches "\*RequestLimitExceeded"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, instanceType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|ElastiCache Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_elasticache<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall elasticache errorCode (\*Exceeded\*) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"cacheNodeType\\":\\"\*\\"" as cacheNodeType nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "elasticache" and errorCode matches "\*Exceeded\*"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|ElastiCache Users Experiencing Insufficient Capacity  Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_insufficientCapacity\_elasticache\_resource<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall elasticache errorCode (CreateCacheCluster OR ModifyCacheCluster) (\*Insufficient\*) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"cacheNodeType\\":\\"\*\\"" as cacheNodeType<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "elasticache" and eventName in ("CreateCacheCluster", "ModifyCacheCluster") and errorCode matches "\*Insufficient\*"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|ElastiCache Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_elasticache<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall elasticache errorCode (InternalFailure OR ServiceUnavailable) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "elasticache" and errorCode in ("InternalFailure", "ServiceUnavailable")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|ElastiCache Users Experiencing Throttling Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_elasticache<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall elasticache errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"cacheNodeType\\":\\"\*\\"" as cacheNodeType nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "elasticache" and errorCode = "ThrottlingException"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, cacheNodeType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|ELB Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_elb<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall elasticloadbalancing errorCode (TooManyTargetGroups OR TooManyLoadBalancers OR TooManyActions OR TooManyRegistrationsForTargetId OR TargetGroupAssociationLimit OR TooManyTargets OR TooManyListeners OR TooManyUniqueTargetGroupsPerLoadBalancer OR TooManyTags) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"loadBalancerArn\\":\\"\*\\"" as loadBalancerArn nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "elasticloadbalancing" and errorCode in ("TooManyTargetGroups", "TooManyLoadBalancers", "TooManyActions", "TooManyRegistrationsForTargetId", "TargetGroupAssociationLimit", "TooManyTargets", "TooManyListeners", "TooManyUniqueTargetGroupsPerLoadBalancer", "TooManyTags")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, loadBalancerArn, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, loadBalancerArn, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, loadBalancerArn, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|ELB Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_elb<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall elasticloadbalancing errorCode (InternalFailure OR ServiceUnavailable) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "elasticloadbalancing" and errorCode in ("InternalFailure", "ServiceUnavailable")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|ELB Users Experiencing Throttling Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_elb<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall elasticloadbalancing errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"loadBalancerArn\\":\\"\*\\"" as loadBalancerArn nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "elasticloadbalancing" and errorCode = "ThrottlingException"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, loadBalancerArn, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, loadBalancerArn, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, loadBalancerArn, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Lambda Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_lambda<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall lambda errorCode (ENILimitReachedException OR CodeStorageExceededException) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"functionName\\":\\"\*\\"" as functionName nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "lambda" and errorCode in ("ENILimitReachedException", "CodeStorageExceededException")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, functionName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, functionName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, functionName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Lambda Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_lambda<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall lambda errorCode (ServiceException OR EC2UnexpectedException) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "lambda" and errorCode in ("ServiceException", "EC2UnexpectedException")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Lambda Users Experiencing Throttling  Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_lambda<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall lambda errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"functionName\\":\\"\*\\"" as functionName nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "lambda" and errorCode in ("EC2ThrottledException", "TooManyRequestsException")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, functionName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, functionName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, functionName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|RDS Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_RDS<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall rds errorCode (\*QuotaExceeded\*) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"resourceName\\":\\"\*\\"" as resourceName nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "rds" and errorCode matches "\*QuotaExceeded\*"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, resourceName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, resourceName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, resourceName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|RDS Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_rds<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall rds errorCode (InternalServerError OR InternalFailure OR ServiceUnavailable) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "rds" and errorCode in ("InternalServerError", "InternalFailure", "ServiceUnavailable")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|RDS Users Experiencing Throttling Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_rds<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall rds errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"resourceName\\":\\"\*\\"" as resourceName nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "rds" and errorCode = "ThrottlingException"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, resourceName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, resourceName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, resourceName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Redshift Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_redshift<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall redshift errorCode (\*Exceeded\*) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"nodeType\\":\\"\*\\"" as nodeType nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "redshift" and errorCode matches "\*Exceeded\*"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Redshift Users Experiencing Insufficient Capacity  Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_insufficientCapacity\_redshift\_resource<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall redshift errorCode (CreateCluster OR ResizeCluster OR ModifyCluster) (\*Insufficient\*) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"nodeType\\":\\"\*\\"" as nodeType<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "redshift" and eventName in ("CreateCluster", "ResizeCluster", "ModifyCluster") and errorCode matches "\*Insufficient\*"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Redshift Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_redshift<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall redshift errorCode (InternalFailure OR ServiceUnavailable) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "redshift" and errorCode in ("InternalFailure", "ServiceUnavailable")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|Redshift Users Experiencing Throttling Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_redshift<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall redshift errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"nodeType\\":\\"\*\\"" as nodeType nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "redshift" and errorCode = "ThrottlingException"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, nodeType, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|S3 Users Experiencing Account Quota Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_accountQuotaErrors\_s3<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall s3 errorCode (TooManyBuckets) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"bucketName\\":\\"\*\\"" as bucketName nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "s3" and errorCode = "TooManyBuckets"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, bucketName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, bucketName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, bucketName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|S3 Users Experiencing Service Availability Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_serviceAvailability\_s3<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall s3 errorCode (InternalError) userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| where eventType = "AwsApiCall" and resourceType = "s3" and errorCode = "InternalError"<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|
|Global Intelligence for CloudTrail DevOps|S3 Users Experiencing Throttling Errors|Logs|Global Intelligence for CloudTrail DevOps/GI CloudTrail DevOps - 06. Action Plan - New|// id=@action\_plan\_throttling\_s3<br />\_sourceCategory = Labs/AWS/CloudTrail<br />AwsApiCall s3 errorCode userName<br />\| parse "\\"awsRegion\\":\\"\*\\"" as awsRegion<br />\| parse "\\"eventSource\\":\\"\*\\"" as eventSource<br />\| parse "\\"eventName\\":\\"\*\\"" as eventName<br />\| parse "\\"eventType\\":\\"\*\\"" as eventType<br />\| parse "\\"recipientAccountId\\":\\"\*\\"" as accountId<br />\| parse field=eventSource "\*.amazonaws.com" as resourceType<br />\| parse "\\"errorCode\\":\\"\*\\"" as errorCode<br />\| parse "\\"userName\\":\\"\*\\"" as userName<br />\| parse "\\"bucketName\\":\\"\*\\"" as bucketName nodrop<br />\| where eventType = "AwsApiCall" and resourceType = "s3" and errorCode in ("ServiceUnavailable", "SlowDown")<br />\| timeslice 1m<br />\|where if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{awsRegion}}" = "\*", true, awsRegion matches "{{awsRegion}}")<br />\|count by userName, awsRegion, accountId, resourceType, eventName, bucketName, errorCode, \_timeslice<br />\| max(\_count) as my\_company\_errorsPerMin by userName, awsRegion, accountId, resourceType, eventName, bucketName, errorCode<br />\| fields userName, awsRegion, accountId, resourceType, eventName, bucketName, errorCode, my\_company\_errorsPerMin<br />\| topk (3, my\_company\_errorsPerMin)<br />\| fields -\_rank|

