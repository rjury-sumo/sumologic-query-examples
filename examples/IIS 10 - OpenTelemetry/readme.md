# IIS 10 - OpenTelemetry

## Searches

### Log Searches

- **4xx Errors - Client Locations**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **4xx Status Codes by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **5xx Status Codes by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Average Redirection Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Average Response Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Avg. Response Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Browsers and Operating Systems**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Client and Server Errors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Client Error Outliers**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Client Errors (4xx) by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Client OS Platforms**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Cumulative Client Request Percentiles**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Cumulative Response Time Percentiles**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Cumulative User Request Percentiles**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Delete Requests**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Desktop OS Version**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Error Events**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Get Requests**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Highly Malicious Threat Table**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis 
- **HTTP Methods**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights 
- **Media Types Served**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights 
- **Method**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Non 200 Response Status Codes**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Number of Requests - Time Compare**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Popular Mobile Device Versions**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Post Requests**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Put Requests**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Reason Phrase - Time Compare**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Redirections (3xx) by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Request Outlier**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Requests**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Requests**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Requests by App Over Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Requests Stats by Client IP**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Requests Stats by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **Response Codes Over Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Response Time (Avg) by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Response Time (Avg) Outlier**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Response Time Histogram**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Response Time Histogram**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Server Error Outliers**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Server Errors (5xx) by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Server Errors Over Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Threat Breakdown by Sources**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis 
- **Threat by Actors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis 
- **Threat Count**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis 
- **Threat Count**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Threat Location**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis 
- **Threat Table**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis 
- **Top 10 Bots Observed**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Top 10 Queries**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights 
- **Top 10 URLs Facing 404 Errors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Top 10 URLs with 4xx Errors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Top 10 URLs with 5xx Errors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Top 20 Slowest Pages**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Top 5 Highly Malicious URLs**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis 
- **Top 5 Referrers**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights 
- **Top 5 URLs**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights 
- **Top Apps by Request**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Top Apps by Request**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Top Client IPs**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Top Cooked URL and Query**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Top Protocol Status**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Top Protocol Versions**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Top Reason Phrase**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Top Request Details by Reason**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Top Requests by Users**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Top Server Errors by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations 
- **Top Server IPs**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Top Slowest Get Requests**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Top Slowest Post Requests**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Top Verbs**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error 
- **Traffic Distribution by Server**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency 
- **Unique Visitors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Unique Visitors Outlier**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats 
- **US Visitors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Locations 
- **Visitor Location**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview 
- **Visitor Platforms**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Visitors by US Region Over Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Locations 
- **Visitors Platforms Over Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types 
- **Visits by Country Over Time**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Locations 
- **Worldwide Visitors**: from Dashboard: Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Locations

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|IIS 10 - OpenTelemetry/Server Operations|4xx Errors - Client Locations|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 4\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|IIS 10 - OpenTelemetry|4xx Status Codes by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count as count by  webengine.cluster.name|
|IIS 10 - OpenTelemetry|5xx Status Codes by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "5\*"<br />\| count as count by webengine.cluster.name|
|IIS 10 - OpenTelemetry/Server Operations|Average Redirection Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 3\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "3\*"<br />\| avg(time\_taken) as AvgResponseTime|
|IIS 10 - OpenTelemetry/Server Operations|Average Response Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| avg(time\_taken) as AvgResponseTime|
|IIS 10 - OpenTelemetry|Avg. Response Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| sum(time\_taken) as sum\_time\_taken, count as count\_request<br />\| sum\_time\_taken/count\_request as avg\_time\_taken<br />\| fields avg\_time\_taken|
|IIS 10 - OpenTelemetry/Traffic Insights|Browsers and Operating Systems|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if (cs\_User\_Agent matches "\*Windows \*" OR cs\_User\_Agent matches "\*Win32\*" OR cs\_User\_Agent matches "\*Win64\*","Windows","") as OS <br />\| if (cs\_User\_Agent matches "\*Macintosh\*" OR cs\_User\_Agent matches "\*Darwin/\*" OR cs\_User\_Agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (cs\_User\_Agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (cs\_User\_Agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (cs\_User\_Agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (cs\_User\_Agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Android\*","Android",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (cs\_User\_Agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (cs\_User\_Agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (cs\_User\_Agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (cs\_User\_Agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND cs\_User\_Agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (cs\_User\_Agent matches "\*Mobile/\*" OR cs\_User\_Agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND cs\_User\_Agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (cs\_User\_Agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (cs\_User\_Agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (cs\_User\_Agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (cs\_User\_Agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser  <br />\| count by OS,browser<br />\| transpose row Browser column OS|
|IIS 10 - OpenTelemetry|Client and Server Errors|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where (sc\_status matches "5\*" or sc\_status matches "4\*")<br />\| count as ErrorCount|
|IIS 10 - OpenTelemetry/Server Operations|Client Error Outliers|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 4\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "4\*"<br />\| timeslice 1m<br />\| count as Requests by \_timeslice<br />\| outlier Requests window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10 - OpenTelemetry/Server Operations|Client Errors (4xx) by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 4\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count as count by server\_ip, sc\_status<br />\| transpose row server\_ip column sc\_status as \* |
|IIS 10 - OpenTelemetry|Client OS Platforms|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by cs\_User\_Agent<br />\| if (cs\_User\_Agent matches "\*iPad\*" or cs\_User\_Agent matches "\*iPhone\*" or cs\_User\_Agent matches "\*BlackBerry\*" or cs\_User\_Agent matches "\*SAMSUNG\*" or cs\_User\_Agent matches "\*Galaxy\*" or cs\_User\_Agent matches "\*Windows Phone\*" or cs\_User\_Agent matches "\*Android\*","Mobile","PC") as type<br />\| if (cs\_User\_Agent matches "\*Macintosh\*" or (cs\_User\_Agent matches "\*iMac\*"),"Mac",type) as type<br />\| count type<br />\| sort by type,\_count  asc|
|IIS 10 - OpenTelemetry/Traffic Insights|Cumulative Client Request Percentiles|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count as Requests by c\_ip \| sort -Requests <br />\| pct(requests,50) as Pct50, pct(requests,55) as Pct55, pct(requests,60) as Pct60, pct(requests,65) as Pct65, pct(requests,70) as Pct70, pct(requests,75) as Pct75, pct(requests,80) as Pct80, pct(requests,85) as Pct85, pct(requests,90) as Pct90, pct(requests,95) as Pct95, pct(requests,98) as Pct98, pct(requests,100) as Pct100|
|IIS 10 - OpenTelemetry/Server Operations|Cumulative Response Time Percentiles|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| avg(time\_taken) as time\_taken by cs\_uri\_stem \| fields time\_taken<br />\| pct(time\_taken,50) as Pct50, pct(time\_taken,55) as Pct55, pct(time\_taken,60) as Pct60, pct(time\_taken,65) as Pct65, pct(time\_taken,70) as Pct70, pct(time\_taken,75) as Pct75, pct(time\_taken,80) as Pct80, pct(time\_taken,85) as Pct85, pct(time\_taken,90) as Pct90, pct(time\_taken,95) as Pct95, pct(time\_taken,98) as Pct98, pct(time\_taken,100) as Pct100|
|IIS 10 - OpenTelemetry/Traffic Insights|Cumulative User Request Percentiles|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as Requests by cs\_username \| where cs\_username != "-" \| sort -Requests <br />\| pct(requests,50) as Pct50, pct(requests,55) as Pct55, pct(requests,60) as Pct60, pct(requests,65) as Pct65, pct(requests,70) as Pct70, pct(requests,75) as Pct75, pct(requests,80) as Pct80, pct(requests,85) as Pct85, pct(requests,90) as Pct90, pct(requests,95) as Pct95, pct(requests,98) as Pct98, pct(requests,100) as Pct100|
|IIS 10 - OpenTelemetry/Server Operations|Delete Requests|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} DELETE<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method = "DELETE"<br />\| timeslice 1m<br />\| count by \_timeslice|
|IIS 10 - OpenTelemetry/Traffic Insights|Desktop OS Version|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} ("macintosh" OR "mac os" OR "windows" OR "i686" or "PC" or ("Linux" AND !android))<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if (cs\_User\_Agent matches "\*Windows NT\*" or cs\_User\_Agent matches "\*Windows+NT\*" or cs\_User\_Agent matches "\*Windows \*" or cs\_User\_Agent matches "\*Win32\*" or cs\_User\_Agent matches "\*Win64\*", "Windows", "Other") as OS <br />\| if (cs\_User\_Agent matches "\*Macintosh\*","MacOS",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Windows Phone\*" or cs\_User\_Agent matches "\*Windows+Phone\*","Windows Phone",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (cs\_User\_Agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (cs\_User\_Agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Android\*","Android",OS) as OS <br />\| if (cs\_User\_Agent matches "\*Darwin\*","Darwin",OS) as OS <br />\| if (cs\_User\_Agent matches "\*CrOS\*","Google Chrome",OS) as OS <br />\| where OS \<\> "Other"<br />\| parse regex field=cs\_User\_Agent "(?\<os\>Windows)\\+NT\\+(?\<version\>[\\d.]+?)(?:;\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<os\>Mac OS)\\+(?\<version\>[X\\+\\d.\\\_]+?)(?:;\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<os\>Linux)\\+(?\<version\>[x\\d.\\\_]+?)(?:;\|\\))" nodrop <br />\| where os != ""<br />\| count as count by os, version<br />\| transpose row Version column Os|
|IIS 10 - OpenTelemetry/Server Operations|Error Events|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count|
|IIS 10 - OpenTelemetry/Server Operations|Get Requests|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method = "GET"<br />\| timeslice 1m<br />\| count by \_timeslice|
|IIS 10 - OpenTelemetry/Traffic Insights|Highly Malicious Threat Table|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count c\_ip, sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| where malicious\_confidence matches "high"<br />\| count by malicious\_confidence, Actor,c\_ip, sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />\| sort by \_count<br />\| \_count as count<br />\| limit 20<br />\| fields malicious\_confidence, Actor, c\_ip,sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />|
|IIS 10 - OpenTelemetry/Traffic Insights|HTTP Methods|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by method|
|IIS 10 - OpenTelemetry/Traffic Insights|Media Types Served|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_uri\_stem "\\.(?\<media\_type\>[A-Za-z]+)\$" <br />\| count as count by media\_type<br />\| sort by count, media\_type asc|
|IIS 10 - OpenTelemetry/Server Operations|Method|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as Requests by method \| sort by Requests, method asc|
|IIS 10 - OpenTelemetry/Server Operations|Non 200 Response Status Codes|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where !(sc\_status matches "2\*")<br />\| count as count by sc\_status <br />\| sort by count, sc\_status asc|
|IIS 10 - OpenTelemetry/Server Operations|Number of Requests - Time Compare|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 5m<br />\| count as Requests by \_timeslice  <br />\| compare with timeshift 1d 7|
|IIS 10 - OpenTelemetry/Traffic Insights|Popular Mobile Device Versions|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}  (iphone or ipad or android or samsung) <br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_User\_Agent "(?\<device\>iPad);\\+CPU\\+OS\\+(?\<version\>[\\d\_]+?)(?:\\+\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<device\>iPhone);\\+CPU\\+iPhone\\+OS\\+(?\<version\>[\\d\_]+?)(?:\\+\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<device\>Android)\\+(?\<version\>[\\d.]+?)(?:;\|\\))" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<device\>SAMSUNG).+?(?\<version\>(?:GT-\\w+\|SGH-\\w+\|SPH-\\w+\|SCH-\\w+))" <br />\| where device != ""<br />\| count as count by device, version <br />\| transpose row version column device|
|IIS 10 - OpenTelemetry/Server Operations|Post Requests|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} POST<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method = "POST"<br />\| timeslice 1m<br />\| count by \_timeslice|
|IIS 10 - OpenTelemetry/Server Operations|Put Requests|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} PUT<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method = "PUT"<br />\| timeslice 1m<br />\| count by \_timeslice|
|IIS 10 - OpenTelemetry/Server Operations|Reason Phrase - Time Compare|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by Reason\_Phrase<br />\| compare timeshift -1h as HourBefore, timeshift -1d as Yesterday<br />\| \_count as Current \| \_count\_HourBefore as HourBefore \| \_count\_Yesterday as Yesterday<br />\| fields - \_count, \_count\_HourBefore, \_count\_Yesterday|
|IIS 10 - OpenTelemetry/Server Operations|Redirections (3xx) by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 3\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "3\*"<br />\| count as count by server\_ip, sc\_status<br />\| transpose row server\_ip column sc\_status as \* |
|IIS 10 - OpenTelemetry/Server Operations|Request Outlier|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 1m<br />\| count as Requests by \_timeslice<br />\| outlier Requests window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10 - OpenTelemetry|Requests|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count as Requests|
|IIS 10 - OpenTelemetry/Server Operations|Requests|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as Requests|
|IIS 10 - OpenTelemetry/Traffic Insights|Requests by App Over Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+?)(?:/\|\$)" nodrop<br />\| if (isEmpty(app), cs\_uri\_stem, app) as app<br />\| timeslice 1m <br />\| count by \_timeslice, app <br />\| transpose row \_timeslice column app|
|IIS 10 - OpenTelemetry/Traffic Insights|Requests Stats by Client IP|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors<br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| withtime \_messagetime<br />\| count as Requests, most\_recent(\_messagetime\_withtime), least\_recent(\_messagetime\_withtime), count\_distinct(cs\_uri\_stem) as UniquePagesVisited, sum(successes) as successes, sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by c\_ip<br />\| formatDate(fromMillis(\_mostrecent), "MM/dd/yyyy HH:mm:ss:SSS Z") as LatestRequest<br />\| formatDate(fromMillis(\_leastrecent), "MM/dd/yyyy HH:mm:ss:SSS Z") as EarliestRequest<br />\| top 20 c\_ip, LatestRequest, EarliestRequest, Requests, UniquePagesVisited, successes, redirects, client\_errors, server\_errors by Requests, UniquePagesVisited|
|IIS 10 - OpenTelemetry/Server Operations|Requests Stats by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors <br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| count as Requests, count\_distinct(cs\_uri\_stem) as UniquePagesServed, max(time\_taken) as MaxResponseTime, min(time\_taken) as MinResponseTime, avg(time\_taken) as AvgResponseTime, sum(successes) as successes, sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by server\_ip  <br />\| top 10 server\_ip by Requests, UniquePagesServed, AvgResponseTime, MaxResponseTime, MinResponseTime, successes, redirects, client\_errors, server\_errors|
|IIS 10 - OpenTelemetry/Server Operations|Response Codes Over Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| if(sc\_status matches "2\*", 1, 0) as successes \| if(sc\_status matches "3\*", 1, 0) as redirects \| if(sc\_status matches "4\*", 1, 0) as client\_errors \| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1m <br />\| sum(successes) as successes, sum(redirects) as redirects, sum(client\_errors) as client\_errors, sum(server\_errors) as server\_errors by \_timeslice<br />\| sort by \_timeslice asc|
|IIS 10 - OpenTelemetry/Server Operations|Response Time (Avg) by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where server\_ip matches "{{server\_ip}}"<br />\| timeslice 5m<br />\| avg(time\_taken) as AvgResTime by \_timeslice, server\_ip<br />\| transpose row \_timeslice column server\_ip|
|IIS 10 - OpenTelemetry/Server Operations|Response Time (Avg) Outlier|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 5m<br />\| avg(time\_taken) as AvgResTime by \_timeslice<br />\| outlier AvgResTime window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10 - OpenTelemetry|Response Time Histogram|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| avg(time\_taken) as avg\_time\_taken by cs\_uri\_stem<br />\| fields avg\_time\_taken<br />\| (floor(avg\_time\_taken/50)+1)\*50 as avg\_time\_taken\_bucket<br />\| if (avg\_time\_taken \> 1000, 1001, avg\_time\_taken\_bucket) as avg\_time\_taken\_bucket<br />\| count as Frequency by avg\_time\_taken\_bucket<br />\| sort by + avg\_time\_taken\_bucket<br />\| if (avg\_time\_taken\_bucket = 1001, "\>1000", toString(avg\_time\_taken\_bucket)) as avg\_time\_taken\_bucket|
|IIS 10 - OpenTelemetry/Server Operations|Response Time Histogram|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| avg(time\_taken) as time\_taken by cs\_uri\_stem<br />\| fields time\_taken<br />\| int(time\_taken/50) as bucket \| (bucket+1)\*50 as bucketMax <br />\| count as Requests by bucketMax \| sort by bucketMax asc|
|IIS 10 - OpenTelemetry/Server Operations|Server Error Outliers|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 5\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "5\*"<br />\| timeslice 1m<br />\| count as Requests by \_timeslice<br />\| outlier Requests window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10 - OpenTelemetry/Server Operations|Server Errors (5xx) by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 5\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "5\*"<br />\| count as count by server\_ip, sc\_status<br />\| transpose row server\_ip column sc\_status as \* |
|IIS 10 - OpenTelemetry/Server Operations|Server Errors Over Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 5\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where sc\_status matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, sc\_status<br />\| transpose row \_timeslice column sc\_status as \*|
|IIS 10 - OpenTelemetry/Traffic Insights|Threat Breakdown by Sources|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as ip\_count by c\_ip, \_source<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum (ip\_count) as threat\_count by \_source|
|IIS 10 - OpenTelemetry/Traffic Insights|Threat by Actors|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|IIS 10 - OpenTelemetry/Traffic Insights|Threat by Malicious Confidence|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by malicious\_confidence<br />\| sort by malicious\_confidence,threatCount  asc|
|IIS 10 - OpenTelemetry/Traffic Insights|Threat Count|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|IIS 10 - OpenTelemetry|Threat Count|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor\| sum(\_count) as threatCount|
|IIS 10 - OpenTelemetry/Traffic Insights|Threat Location|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count by c\_ip<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = c\_ip|
|IIS 10 - OpenTelemetry/Traffic Insights|Threat Table|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count c\_ip, sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />\| where !isPrivateIP(c\_ip)<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by malicious\_confidence, Actor,c\_ip, sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent<br />\| sort by \_count<br />\| \_count as count<br />\| limit 50<br />\| fields malicious\_confidence, Actor, c\_ip,sc\_status, cs\_uri\_stem, cs\_referer, cs\_User\_Agent|
|IIS 10 - OpenTelemetry/Server Operations|Top 10 Bots Observed|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=cs\_User\_Agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=cs\_User\_Agent "(?\<bot\_name\>Exabot?)\\W"<br />\| where bot\_name != ""<br />\| if (bot\_name="bing","Bing",bot\_name) as bot\_name<br />\| count as count by bot\_name<br />\| sort by count<br />\| limit 10|
|IIS 10 - OpenTelemetry/Traffic Insights|Top 10 Queries|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where cs\_uri\_query != "-"<br />\| count by cs\_uri\_query<br />\| top 10 cs\_uri\_query by \_count, cs\_uri\_query asc<br />\| \_count as count<br />\| fields cs\_uri\_query, count|
|IIS 10 - OpenTelemetry/Traffic Insights|Top 10 Search Terms from Popular Search Engines|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} (google OR bing OR aol OR ask OR yahoo) ("p=" OR "q=" OR "wd=" OR "searchfor=")<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_referer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where search\_term != ""<br />\| urldecode(search\_term)<br />\| if(cs\_referer matches "\*google.\*", "Google", "") as engine<br />\| if(cs\_referer matches "\*bing.\*", "Bing", engine) as engine<br />\| if(cs\_referer matches "\*ask.com\*", "Ask.com", engine) as engine<br />\| if(cs\_referer matches "\*aol.\*", "AOL", engine) as engine<br />\| if(cs\_referer matches "\*yahoo.\*", "Yahoo", engine) as engine<br />\| where engine !="" <br />\| count as count by search\_term<br />\| sort count<br />\| limit 10|
|IIS 10 - OpenTelemetry/Server Operations|Top 10 URLs Facing 404 Errors|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 404<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status="404" <br />\| count by cs\_uri\_stem<br />\| top 10 cs\_uri\_stem by \_count, cs\_uri\_stem asc<br />\| \_count as count<br />\| fields cs\_uri\_stem,count|
|IIS 10 - OpenTelemetry|Top 10 URLs with 4xx Errors|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count as count by cs\_uri\_stem, sc\_status<br />\| sort by count, cs\_uri\_stem asc \| limit 10|
|IIS 10 - OpenTelemetry|Top 10 URLs with 5xx Errors|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "5\*"<br />\| count as count by cs\_uri\_stem, sc\_status<br />\| sort by count, cs\_uri\_stem asc \| limit 10|
|IIS 10 - OpenTelemetry/Server Operations|Top 20 Slowest Pages|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| avg(time\_taken) as AvgResTime by cs\_uri\_stem <br />\| top 20 cs\_uri\_stem by AvgResTime, cs\_uri\_stem asc<br />\| AvgResTime/1000 as AvgResTimeInSec <br />\| format( "%.2f",AvgResTimeInSec) as AvgResTimeInSec<br />\| fields -AvgResTime|
|IIS 10 - OpenTelemetry/Server Operations|Top 5 Clients Causing 4xx Errors|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message  "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "4\*"<br />\| count as count by c\_ip<br />\| sort count <br />\| limit 5 |
|IIS 10 - OpenTelemetry/Traffic Insights|Top 5 Highly Malicious URLs|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Threat Analysis| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as ip\_count by c\_ip, cs\_uri\_stem<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=c\_ip <br />\| where malicious\_confidence matches "high"<br />\| count by cs\_uri\_stem|
|IIS 10 - OpenTelemetry/Traffic Insights|Top 5 Referrers|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where cs\_referer != "-"<br />\| count as count by cs\_referer<br />\| sort by count<br />\| limit 5 |
|IIS 10 - OpenTelemetry/Traffic Insights|Top 5 URLs|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Traffic Insights| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count as count by cs\_uri\_stem<br />\| sort by count<br />\| limit 5|
|IIS 10 - OpenTelemetry|Top Apps by Request|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+?)(?:/\|\$)" nodrop<br />\| if (isEmpty(app), cs\_uri\_stem, app) as app<br />\| count as Requests by app <br />\| top 20 app by Requests, app asc|
|IIS 10 - OpenTelemetry/Traffic Insights|Top Apps by Request|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+?)(?:/\|\$)" nodrop<br />\| if (isEmpty(app), cs\_uri\_stem, app) as app<br />\| count as Requests by app <br />\| top 20 app by Requests, app asc|
|IIS 10 - OpenTelemetry/Server Operations|Top Client IPs|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)"<br />\| count by c\_ip<br />\| top 10 c\_ip by \_count, c\_ip asc<br />\| \_count as count<br />\| fields c\_ip, count|
|IIS 10 - OpenTelemetry/Server Operations|Top Cooked URL and Query|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by cookedurl\_query<br />\| top 25 cookedurl\_query by \_count, cookedurl\_query asc<br />\| \_count as count<br />\| fields cookedurl\_query,count|
|IIS 10 - OpenTelemetry/Server Operations|Top Protocol Status|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by Protocol\_Status<br />\| top 10 Protocol\_Status by \_count, Protocol\_Status asc<br />\| \_count as count<br />\| fields Protocol\_Status, count|
|IIS 10 - OpenTelemetry/Server Operations|Top Protocol Versions|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by protocol\_version<br />\| top 10 protocol\_version by \_count, protocol\_version asc<br />\| \_count as count<br />\| fields protocol\_version, count|
|IIS 10 - OpenTelemetry/Server Operations|Top Reason Phrase|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by Reason\_Phrase<br />\| top 10 Reason\_Phrase by \_count, Reason\_Phrase<br />\| \_count as count<br />\| fields Reason\_Phrase,count|
|IIS 10 - OpenTelemetry/Server Operations|Top Request Details by Reason|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by c\_ip, server\_ip, s\_port, verb, cookedurl\_query, protocol\_version, Protocol\_Status, SiteId, Reason\_Phrase, Queue\_Name<br />\| top 25 c\_ip, server\_ip, s\_port, verb, cookedurl\_query, protocol\_version, Protocol\_Status, Reason\_Phrase, SiteId, Queue\_Name by \_count, c\_ip, server\_ip, s\_port<br />\| \_count as count<br />\| fields c\_ip, server\_ip, s\_port, verb, cookedurl\_query, protocol\_version, Protocol\_Status, Reason\_Phrase, SiteId, Queue\_Name, count|
|IIS 10 - OpenTelemetry/Traffic Insights|Top Requests by Users|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where cs\_username != "-" <br />\| count as Requests by cs\_username <br />\| top 20 cs\_username by Requests, cs\_username asc|
|IIS 10 - OpenTelemetry/Server Operations|Top Server Errors by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Web Server Operations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} 5\*<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| where sc\_status matches "5\*" <br />\| count by server\_ip, cs\_uri\_stem, sc\_status, sc\_substatus, sc\_win32\_status \| sort - \_count<br />\| \_count as count<br />\| fields server\_ip, cs\_uri\_stem, sc\_status, sc\_substatus, sc\_win32\_status, count|
|IIS 10 - OpenTelemetry/Server Operations|Top Server IPs|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by server\_ip, s\_port<br />\| top 10 server\_ip, s\_port by \_count, server\_ip asc, s\_port asc<br />\| \_count as count<br />\| fields server\_ip,s\_port,count|
|IIS 10 - OpenTelemetry/Server Operations|Top Slowest Get Requests|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method="GET"<br />\| avg(time\_taken) as AvgResTime by cs\_uri\_stem, method<br />\| top 20 cs\_uri\_stem by AvgResTime, cs\_uri\_stem asc<br />\| AvgResTime/1000 as AvgResTimeInSec <br />\| format( "%.2f",AvgResTimeInSec) as AvgResTimeInSec<br />\| fields -AvgResTime|
|IIS 10 - OpenTelemetry/Server Operations|Top Slowest Post Requests|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| where method="POST"<br />\| avg(time\_taken) as AvgResTime by cs\_uri\_stem, method<br />\| top 20 cs\_uri\_stem by AvgResTime, cs\_uri\_stem asc<br />\| AvgResTime/1000 as AvgResTimeInSec <br />\| format( "%.2f",AvgResTimeInSec) as AvgResTimeInSec<br />\| fields -AvgResTime|
|IIS 10 - OpenTelemetry/Server Operations|Top Verbs|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - HTTP Error| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<c\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<c\_port\>\\S+?) (?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<s\_port\>\\S+?) (?\<protocol\_version\>\\S+?) (?\<verb\>\\S+?) (?\<cookedurl\_query\>\\S+?) (?\<streamid\>\\S+?) (?\<Protocol\_Status\>\\S+?) (?\<SiteId\>\\S+?) (?\<Reason\_Phrase\>\\S+?) (?\<Queue\_Name\>\\S+?)" <br />\| count by verb<br />\| top 10 verb by \_count, verb asc<br />\| \_count as count<br />\| fields verb,count|
|IIS 10 - OpenTelemetry/Server Operations|Traffic Distribution by Server|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Latency| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| count as Requests by server\_ip  <br />\| top 10 server\_ip by Requests, server\_ip asc|
|IIS 10 - OpenTelemetry/Traffic Insights|Unique Visitors|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| Count by c\_ip<br />\| Count|
|IIS 10 - OpenTelemetry/Server Operations|Unique Visitors Outlier|Logs|Installed Apps/IIS 10 - OpenTelemetry/Server Operations/IIS - Requests Stats| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}}<br />\| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$" <br />\| timeslice 1m<br />\| count\_distinct(c\_ip) as UniqueVisitors by \_timeslice<br />\| outlier UniqueVisitors window=10,threshold=3,consecutive=2,direction=+-|
|IIS 10 - OpenTelemetry/Traffic Insights|US Visitors|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Locations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_name, region, city from geo://location on ip=c\_ip<br />\| where !isNull(latitude)<br />\| where country\_name = "United States"|
|IIS 10 - OpenTelemetry|Visitor Location|Logs|Installed Apps/IIS 10 - OpenTelemetry/IIS - Overview| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip=c\_ip<br />\| where !isNull(latitude)|
|IIS 10 - OpenTelemetry/Traffic Insights|Visitor Platforms|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if (cs\_User\_Agent matches "\*iPad\*" OR cs\_User\_Agent matches "\*iPhone\*" OR cs\_User\_Agent matches "\*Android\*" OR cs\_User\_Agent matches "\*BlackBerry\*" OR cs\_User\_Agent matches "\*Galaxy\*" OR cs\_User\_Agent matches "LGE-\*" OR cs\_User\_Agent matches "SCH-\*" OR cs\_User\_Agent matches "\*HUAWEI-\*" OR cs\_User\_Agent matches "\*SAMSUNG\*" OR cs\_User\_Agent matches "\*samsung\*" OR cs\_User\_Agent matches "Dalvik/\*" OR cs\_User\_Agent matches "Nokia\*" OR cs\_User\_Agent matches "LG-\*" OR cs\_User\_Agent matches "\*CFNetwork\*"  OR cs\_User\_Agent matches "\*UP.Browser/\*" OR cs\_User\_Agent matches "\*QQ\*rowser\*" OR cs\_User\_Agent matches "\*NetFront/\*" OR cs\_User\_Agent matches "\*Windows Phone\*" OR cs\_User\_Agent matches "\*Mobile Safari\*" OR cs\_User\_Agent matches "\*iemobile\*","Mobile","") as type<br />\| if (cs\_User\_Agent matches "\*Windows\*" OR cs\_User\_Agent matches "\*Win64\*" OR cs\_User\_Agent matches "\*Win32\*" OR cs\_User\_Agent matches "\*i686\*" OR cs\_User\_Agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count type<br />\| sort by \_count|
|IIS 10 - OpenTelemetry/Traffic Insights|Visitors by US Region Over Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Locations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| timeslice 30m<br />\| count by \_timeslice, c\_ip<br />\| lookup latitude, longitude, country\_name, region, city, state, postal\_code from geo://location on ip = c\_ip<br />\| where !isNull(latitude) and country\_name = "United States"<br />\| sum(\_count) by \_timeslice, region<br />\| transpose row \_timeslice column region|
|IIS 10 - OpenTelemetry/Traffic Insights|Visitors Platforms Over Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Access Types| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| if (cs\_User\_Agent matches "\*iPad\*" OR cs\_User\_Agent matches "\*iPhone\*" OR cs\_User\_Agent matches "\*Android\*" OR cs\_User\_Agent matches "\*BlackBerry\*" OR cs\_User\_Agent matches "\*Galaxy\*" OR cs\_User\_Agent matches "LGE-\*" OR cs\_User\_Agent matches "SCH-\*" OR cs\_User\_Agent matches "\*HUAWEI-\*" OR cs\_User\_Agent matches "\*SAMSUNG\*" OR cs\_User\_Agent matches "\*samsung\*" OR cs\_User\_Agent matches "Dalvik/\*" OR cs\_User\_Agent matches "Nokia\*" OR cs\_User\_Agent matches "LG-\*" OR cs\_User\_Agent matches "\*CFNetwork\*"  OR cs\_User\_Agent matches "\*UP.Browser/\*" OR cs\_User\_Agent matches "\*QQ\*rowser\*" OR cs\_User\_Agent matches "\*NetFront/\*" OR cs\_User\_Agent matches "\*Windows Phone\*" OR cs\_User\_Agent matches "\*Mobile Safari\*" OR cs\_User\_Agent matches "\*iemobile\*","Mobile","") as type<br />\| if (cs\_User\_Agent matches "\*Windows\*" OR cs\_User\_Agent matches "\*Win64\*" OR cs\_User\_Agent matches "\*Win32\*" OR cs\_User\_Agent matches "\*i686\*" OR cs\_User\_Agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| timeslice 5m<br />\| count by \_timeslice, type<br />\| transpose row \_timeslice column type|
|IIS 10 - OpenTelemetry/Traffic Insights|Visits by Country Over Time|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Locations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| timeslice 30m<br />\| count by \_timeslice, c\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip = c\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name|
|IIS 10 - OpenTelemetry/Traffic Insights|Worldwide Visitors|Logs|Installed Apps/IIS 10 - OpenTelemetry/Traffic Insights/IIS - Visitor Locations| sumo.datasource=iis webengine.cluster.name={{webengine.cluster.name}} \| json "log" as \_rawlog nodrop <br />\| if (isEmpty(\_rawlog), \_raw, \_rawlog) as iis\_log\_message<br />\| parse regex field=iis\_log\_message "(?\<server\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}) (?\<method\>\\S+?) (?\<cs\_uri\_stem\>\\S+?) (?\<cs\_uri\_query\>\\S+?) (?\<s\_port\>\\S+?) (?\<cs\_username\>\\S+?) (?\<c\_ip\>\\S+?) (?\<cs\_User\_Agent\>\\S+?) (?\<cs\_referer\>\\S+?) (?\<sc\_status\>\\S+?) (?\<sc\_substatus\>\\S+?) (?\<sc\_win32\_status\>\\S+?) (?\<time\_taken\>\\S+?)\$"<br />\| count by c\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip=c\_ip<br />\| where !isNull(latitude)|

