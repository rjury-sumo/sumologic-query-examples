# Cisco Meraki
## Sumo Logic App For: Cisco Meraki
The Cisco Meraki app provides a single-pane-of-glass for monitoring and troubleshooting network security, end-to-end performance, switch port management, and device management of your Cisco Meraki wireless infrastructure management platform.
Docs Link: [Cisco Meraki](https://help.sumologic.com/?cid=10209)

## Searches

### Log Searches

- **Actions**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Actions**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Air Marshal Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Air Marshal Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Air Marshal Events**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **Allowed Destination IPs Locations**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Destination IPs Locations**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Destination Locations**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **Allowed Destination Locations**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **Allowed Destination Locations**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **Allowed Insecure  Traffic by Protocol**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Insecure  Traffic by Protocol**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Insecure Traffic by Application and Involved Host**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Insecure Traffic by Application and Involved Host**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Network Activity On Unencrypted Default Ports**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Network Activity On Unencrypted Default Ports**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Traffic Outlier**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Allowed Traffic Outlier**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **AP Air Marshal Events**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **AP Air Marshal Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **AP Air Marshal Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **Client DHCP Lease Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Client DHCP Lease Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Client DHCP Lease Events**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **Denied Destination IPs Locations**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Destination IPs Locations**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Insecure Traffic by Application and Involved Host**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Insecure Traffic by Application and Involved Host**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Insecure Traffic by Protocol**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Insecure Traffic by Protocol**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Network Activity On Unencrypted Default Ports**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Network Activity On Unencrypted Default Ports**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Traffic Outlier**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Denied Traffic Outlier**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Destination IP Threat Details**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Destination IP Threat Details**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Destination Locations**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Destination Locations**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Destination Locations By Country**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Destination Locations By Country**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Destinations**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Destinations**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Event Priority**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **Event Priority**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **Event Type**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **Event Type**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **Event Types**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Event Types**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Event Types**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **Event Types Over Time**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **Event Types Over Time**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Event Types Over Time**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Events**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Events**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **Events**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **Events Over Time**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **Events Over Time**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Events Over Time**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Events Over Time**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Events Over Time**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Events Over Time**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **File Issued Retrospective Malicious Disposition**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **File Issued Retrospective Malicious Disposition**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **Flows By Pattern**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **Flows By Pattern**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected 
- **High Severity Threats**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **High Severity Threats**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **High Severity Threats**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **Host Impacted**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **Host Impacted**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **HTTP Requests**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **HTTP Requests**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **HTTP Requests**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **IDS Signature Matched**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **IDS Signature Matched**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **Mac Addresses**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Mac Addresses**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Malicious File Blocked by AMP**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **Malicious File Blocked by AMP**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **Media Types Requested Over Time**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Media Types Requested Over Time**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Message Types**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **Message Types**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **Message Types**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **Message Types Trend**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **Message Types Trend**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **Message Types Trend**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **Methods**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Methods**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Most Prevalent Threat**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **Most Prevalent Threat**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **Names**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **Names**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **Names**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **Names Trend**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **Names Trend**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **Names Trend**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **Number of Requests - Time Compare**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Number of Requests - Time Compare**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Operating Systems and Browsers**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Operating Systems and Browsers**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **OS Platform**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **OS Platform**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **OS Platform**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **OS Platform**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Platform Versions**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Platform Versions**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Possible Horizontal Port Scan Attack - Allowed**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Possible Horizontal Port Scan Attack - Allowed**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Possible Horizontal Port Scan Attack - Rejected**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Possible Horizontal Port Scan Attack - Rejected**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Possible Port Scan Attack**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview 
- **Possible Port Scan Attack**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Overview 
- **Possible Port Scan Attack**: from Dashboard: Cisco Meraki/Cisco Meraki - Overview - New 
- **Possible Vertical Port Scan Attack - Allowed**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Possible Vertical Port Scan Attack - Allowed**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Possible Vertical Port Scan Attack - Rejected**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Possible Vertical Port Scan Attack - Rejected**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Protocols**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Protocols**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Requests**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Requests**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Requests Outlier**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Requests Outlier**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Requests Per Minute**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Requests Per Minute**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Security Threat Events Over Time**: from Dashboard: Cisco Meraki/Cisco Meraki - Security Threats 
- **Security Threat Events Over Time**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats 
- **Sources**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Sources**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Threat By Actor**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat By Actor**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat By Actor**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat By Actor**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat Count**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat Count**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat Count**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat Count**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat Location**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat Location**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat Location**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threat Location**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **Threats By URLs**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Threats By URLs**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Top 10 Destination IP**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 Destination IP**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 Destination IP**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 Destination IP**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 Destination Ports**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Top 10 Destination Ports**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Top 10 Media Types Requested**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Top 10 Media Types Requested**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Top 10 Requested URLs**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Top 10 Requested URLs**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform 
- **Top 10 Requested URLs**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Top 10 Requested URLs**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Top 10 Source IP**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 Source IP**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 Source IP**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 Source IP**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 TCP Destination Ports**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 TCP Destination Ports**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 TCP Destination Ports**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 TCP Destination Ports**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 UDP Destination Ports**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 UDP Destination Ports**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 UDP Destination Ports**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Top 10 UDP Destination Ports**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Traffic Action - Time Compare**: from Dashboard: Cisco Meraki/Cisco Meraki - Flows Overview 
- **Traffic Action - Time Compare**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview 
- **Unique Destination IPs Outlier**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Unique Destination IPs Outlier**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Unique MAC Address Outlier**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Unique MAC Address Outlier**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Unique Source IPs Outlier**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Overview 
- **Unique Source IPs Outlier**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview 
- **Uplink Connectivity Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events 
- **Uplink Connectivity Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **Uplink Connectivity Events**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **URL Threat Details**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **URL Threat Details**: from Dashboard: Cisco Meraki/Cisco Meraki - URLs Threat Intel 
- **VPN Events**: from Dashboard: Installed Apps/Cisco Meraki/Cisco Meraki - Events 
- **VPN Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events - New 
- **VPN Events**: from Dashboard: Cisco Meraki/Cisco Meraki - Events

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Cisco Meraki|Actions|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\|  where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by action<br />\| sort by eventCount, action asc|
|Cisco Meraki|Actions|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\|  where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by action<br />\| sort by eventCount, action asc|
|Cisco Meraki|Air Marshal Events|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki airmarshal\_events type (rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "ssid", "bssid", "src", "dst", "wired\_mac", "vlan\_id", "channel", "rssi", "fc\_type", "fc\_subtype", "vap" as ssid, bssid, src\_ip, dest\_ip, wired\_mac, vlan\_id, channel, rssi, fc\_type, fc\_subtype, vap nodrop<br />\| where msg\_type matches "airmarshal\_events" and type in ("rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount by type<br />\| compare with timeshift 1d<br />\| sort by eventCount, eventCount\_1d, type asc|
|Cisco Meraki|Air Marshal Events|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  airmarshal\_events type (rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "ssid", "bssid", "src", "dst", "wired\_mac", "vlan\_id", "channel", "rssi", "fc\_type", "fc\_subtype", "vap" as ssid, bssid, src\_ip, dest\_ip, wired\_mac, vlan\_id, channel, rssi, fc\_type, fc\_subtype, vap nodrop<br />\| where msg\_type matches "airmarshal\_events" and type in ("rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\| where if ("{{bssid}}" = "\*", true, bssid matches "{{bssid}}") AND if ("{{channel}}" = "\*", true, channel matches "{{channel}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{ssid}}" = "\*", true, ssid matches "{{ssid}}")<br />\| count as eventCount by type<br />\| compare with timeshift 1d<br />\| sort by eventCount, eventCount\_1d, type asc|
|Cisco Meraki|Air Marshal Events|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  airmarshal\_events type (rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "ssid", "bssid", "src", "dst", "wired\_mac", "vlan\_id", "channel", "rssi", "fc\_type", "fc\_subtype", "vap" as ssid, bssid, src\_ip, dest\_ip, wired\_mac, vlan\_id, channel, rssi, fc\_type, fc\_subtype, vap nodrop<br />\| where msg\_type matches "airmarshal\_events" and type in ("rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\| where if ("{{bssid}}" = "\*", true, bssid matches "{{bssid}}") AND if ("{{channel}}" = "\*", true, channel matches "{{channel}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{ssid}}" = "\*", true, ssid matches "{{ssid}}")<br />\| count as eventCount by type<br />\| compare with timeshift 1d<br />\| sort by eventCount, eventCount\_1d, type asc|
|Cisco Meraki|Allowed Destination IPs Locations|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by dest\_ip<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Allowed Destination IPs Locations|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by dest\_ip<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Allowed Destination Locations|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count by dest\_ip<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Allowed Destination Locations|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki flows (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " flows\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="flows" and action = "allow"<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count by dest\_ip<br />\| lookup latitude, longitude, country\_name, region, city from geo://location on ip=dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Allowed Destination Locations|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count by dest\_ip<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Allowed Insecure  Traffic by Protocol|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />// Note - Its assumed that the CDE comprise of private IP address from 172.16.0.0/12, 192.168.0.0/16 and 10.0.0.0/8. User can configure specific IP addresses based on org CDE IP address range(s)<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| if (direction="inbound", dest\_ip, src\_ip) as %"Host"<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\| count as Incidents by \_timeslice, Protocol \| protocol as Protocol\_Val<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/protocol-numbers.csv on Decimal=Protocol\_val <br />\| if (isNull(keyword), Protocol\_val, Keyword) as Protocol<br />\| fields -keyword, protocol\_val <br />\| transpose row \_timeslice column Protocol|
|Cisco Meraki|Allowed Insecure  Traffic by Protocol|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />// Note - Its assumed that the CDE comprise of private IP address from 172.16.0.0/12, 192.168.0.0/16 and 10.0.0.0/8. User can configure specific IP addresses based on org CDE IP address range(s)<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| if (direction="inbound", dest\_ip, src\_ip) as %"Host"<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\| count as Incidents by \_timeslice, Protocol \| protocol as Protocol\_Val<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/protocol-numbers.csv on Decimal=Protocol\_val <br />\| if (isNull(keyword), Protocol\_val, Keyword) as Protocol<br />\| fields -keyword, protocol\_val <br />\| transpose row \_timeslice column Protocol|
|Cisco Meraki|Allowed Insecure Traffic by Application and Involved Host|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) dport (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| if (direction="inbound", dest\_ip, src\_ip) as %"Host"<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/port-numbers.csv on Decimal=dest\_port<br />\| if (isNull(keyword), dest\_port, Keyword) as Application<br />\| transactionize application (merge %"Host", Application takeFirst)<br />\| where if ("{{Application}}" = "\*", true, Application matches "{{Application}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\| count Application, %"Host"<br />\| sort by Application asc<br />\| fields - \_count|
|Cisco Meraki|Allowed Insecure Traffic by Application and Involved Host|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) dport (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| if (direction="inbound", dest\_ip, src\_ip) as %"Host"<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/port-numbers.csv on Decimal=dest\_port<br />\| if (isNull(keyword), dest\_port, Keyword) as Application<br />\| transactionize application (merge %"Host", Application takeFirst)<br />\| where if ("{{Application}}" = "\*", true, Application matches "{{Application}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\| count Application, %"Host"<br />\| sort by Application asc<br />\| fields - \_count|
|Cisco Meraki|Allowed Network Activity On Unencrypted Default Ports|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />// Note - Its assumed that the CDE comprise of private IP address from 172.16.0.0/12, 192.168.0.0/16 and 10.0.0.0/8. User can configure specific IP addresses based on org CDE IP address range(s)<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by \_timeslice, dest\_port <br />\| transpose row \_timeslice column dest\_port|
|Cisco Meraki|Allowed Network Activity On Unencrypted Default Ports|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />// Note - Its assumed that the CDE comprise of private IP address from 172.16.0.0/12, 192.168.0.0/16 and 10.0.0.0/8. User can configure specific IP addresses based on org CDE IP address range(s)<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by \_timeslice, dest\_port <br />\| transpose row \_timeslice column dest\_port|
|Cisco Meraki|Allowed Traffic Outlier|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by \_timeslice<br />\| outlier eventCount window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Allowed Traffic Outlier|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by \_timeslice<br />\| outlier eventCount window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|AP Air Marshal Events|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  airmarshal\_events type (rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "ssid", "bssid", "src", "dst", "wired\_mac", "vlan\_id", "channel", "rssi", "fc\_type", "fc\_subtype", "vap" as ssid, bssid, src\_ip, dest\_ip, wired\_mac, vlan\_id, channel, rssi, fc\_type, fc\_subtype, vap nodrop<br />\| where msg\_type matches "airmarshal\_events" and type in ("rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by type<br />\| sort by eventCount, type asc|
|Cisco Meraki|AP Air Marshal Events|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  airmarshal\_events type (rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "ssid", "bssid", "src", "dst", "wired\_mac", "vlan\_id", "channel", "rssi", "fc\_type", "fc\_subtype", "vap" as ssid, bssid, src\_ip, dest\_ip, wired\_mac, vlan\_id, channel, rssi, fc\_type, fc\_subtype, vap nodrop<br />\| where msg\_type matches "airmarshal\_events" and type in ("rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by type<br />\| sort by eventCount, type asc|
|Cisco Meraki|AP Air Marshal Events|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki airmarshal\_events type (rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "ssid", "bssid", "src", "dst", "wired\_mac", "vlan\_id", "channel", "rssi", "fc\_type", "fc\_subtype", "vap" as ssid, bssid, src\_ip, dest\_ip, wired\_mac, vlan\_id, channel, rssi, fc\_type, fc\_subtype, vap nodrop<br />\| where msg\_type matches "airmarshal\_events" and type in ("rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count as eventCount by type<br />\| sort by eventCount, type asc|
|Cisco Meraki|Client DHCP Lease Events|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki events "dhcp lease of"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events \* of ip \* from server mac \* for client mac \* from router \* on subnet \* with dns \*" as type, client\_ip, dhcp\_server, client\_mac, router, subnet, dns nodrop<br />\| where msg\_type="events" and \_raw matches "\* dhcp lease \*" and type="dhcp lease"<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount|
|Cisco Meraki|Client DHCP Lease Events|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events "dhcp lease of"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events \* of ip \* from server mac \* for client mac \* from router \* on subnet \* with dns \*" as type, client\_ip, dhcp\_server, client\_mac, router, subnet, dns nodrop<br />\| where msg\_type="events" and \_raw matches "\* dhcp lease \*" and type="dhcp lease"<br />\| where if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount|
|Cisco Meraki|Client DHCP Lease Events|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events "dhcp lease of"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events \* of ip \* from server mac \* for client mac \* from router \* on subnet \* with dns \*" as type, client\_ip, dhcp\_server, client\_mac, router, subnet, dns nodrop<br />\| where msg\_type="events" and \_raw matches "\* dhcp lease \*" and type="dhcp lease"<br />\| where if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount|
|Cisco Meraki|Denied Destination IPs Locations|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by dest\_ip<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Denied Destination IPs Locations|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by dest\_ip<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Denied Insecure Traffic by Application and Involved Host|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) dport (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| if (direction="inbound", dest\_ip, src\_ip) as %"Host"<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/port-numbers.csv on Decimal=dest\_port<br />\| if (isNull(keyword), dest\_port, Keyword) as Application<br />\| transactionize application (merge %"Host", Application takeFirst)<br />\| where if ("{{Application}}" = "\*", true, Application matches "{{Application}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\| count Application, %"Host"<br />\| sort by Application asc<br />\| fields - \_count|
|Cisco Meraki|Denied Insecure Traffic by Application and Involved Host|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) dport (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| if (direction="inbound", dest\_ip, src\_ip) as %"Host"<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/port-numbers.csv on Decimal=dest\_port<br />\| if (isNull(keyword), dest\_port, Keyword) as Application<br />\| transactionize application (merge %"Host", Application takeFirst)<br />\| where if ("{{Application}}" = "\*", true, Application matches "{{Application}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\| count Application, %"Host"<br />\| sort by Application asc<br />\| fields - \_count|
|Cisco Meraki|Denied Insecure Traffic by Protocol|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) dport (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />// Note - Its assumed that the CDE comprise of private IP address from 172.16.0.0/12, 192.168.0.0/16 and 10.0.0.0/8. User can configure specific IP addresses based on org CDE IP address range(s)<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| if (direction="inbound", dest\_ip, src\_ip) as %"Host"<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\| count as Incidents by \_timeslice, Protocol \| protocol as Protocol\_Val<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/protocol-numbers.csv on Decimal=Protocol\_val <br />\| if (isNull(keyword), Protocol\_val, Keyword) as Protocol<br />\| fields -keyword, protocol\_val<br />\| transpose row \_timeslice column Protocol|
|Cisco Meraki|Denied Insecure Traffic by Protocol|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) dport (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />// Note - Its assumed that the CDE comprise of private IP address from 172.16.0.0/12, 192.168.0.0/16 and 10.0.0.0/8. User can configure specific IP addresses based on org CDE IP address range(s)<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| if (direction="inbound", dest\_ip, src\_ip) as %"Host"<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}") AND if ("{{Host}}" = "\*", true, Host matches "{{Host}}")<br />\| count as Incidents by \_timeslice, Protocol \| protocol as Protocol\_Val<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/protocol-numbers.csv on Decimal=Protocol\_val <br />\| if (isNull(keyword), Protocol\_val, Keyword) as Protocol<br />\| fields -keyword, protocol\_val<br />\| transpose row \_timeslice column Protocol|
|Cisco Meraki|Denied Network Activity On Unencrypted Default Ports|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />// Note - Its assumed that the CDE comprise of private IP address from 172.16.0.0/12, 192.168.0.0/16 and 10.0.0.0/8. User can configure specific IP addresses based on org CDE IP address range(s)<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by \_timeslice, dest\_port <br />\| transpose row \_timeslice column dest\_port|
|Cisco Meraki|Denied Network Activity On Unencrypted Default Ports|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) (21 or 23 or 80 or 8008 or 8080 or 513 or 69) // 21 - FTP, 23 - Telnet, 513 - rlogin, 80, 8008, 8080 - HTTP, 69 - TFTP<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and dest\_port in ("21", "23", "80", "8008", "8080", "513", "69")<br />// Note - Its assumed that the CDE comprise of private IP address from 172.16.0.0/12, 192.168.0.0/16 and 10.0.0.0/8. User can configure specific IP addresses based on org CDE IP address range(s)<br />\| if (isPrivateIP(src\_ip) and isPrivateIP(dest\_ip), "internal", if (isPrivateIP(src\_ip) and !isPrivateIP(dest\_ip), "outbound","inbound")) as direction<br />\| where direction in ("inbound", "outbound")<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by \_timeslice, dest\_port <br />\| transpose row \_timeslice column dest\_port|
|Cisco Meraki|Denied Traffic Outlier|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by \_timeslice<br />\| outlier eventCount window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Denied Traffic Outlier|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| timeslice 1m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by \_timeslice<br />\| outlier eventCount window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Destination IP Threat Details|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by src\_ip, dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| fields src\_ip, dest\_ip, actor, malicious\_confidence, label\_name|
|Cisco Meraki|Destination IP Threat Details|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by src\_ip, dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| fields src\_ip, dest\_ip, actor, malicious\_confidence, label\_name|
|Cisco Meraki|Destination Locations|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup latitude, longitude from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Destination Locations|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup latitude, longitude from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Destination Locations By Country|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 15m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by \_timeslice, dest\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name|
|Cisco Meraki|Destination Locations By Country|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 15m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by \_timeslice, dest\_ip<br />\| lookup latitude, longitude, country\_name from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name|
|Cisco Meraki|Destinations|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by dest\_ip<br />\| count|
|Cisco Meraki|Destinations|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by dest\_ip<br />\| count|
|Cisco Meraki|Event Priority|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| where msg\_type="security\_event" and !isEmpty(priority)<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by priority<br />\| sort by eventCount, priority asc|
|Cisco Meraki|Event Priority|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| where msg\_type="security\_event" and !isEmpty(priority)<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by priority<br />\| sort by eventCount, priority asc|
|Cisco Meraki|Event Type|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by type<br />\| top 10 type by eventCount, type asc|
|Cisco Meraki|Event Type|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by type<br />\| top 10 type by eventCount, type asc|
|Cisco Meraki|Event Types|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected")<br />\| where if ("{{bssid}}" = "\*", true, bssid matches "{{bssid}}") AND if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{channel}}" = "\*", true, channel matches "{{channel}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{dhcp\_ip}}" = "\*", true, dhcp\_ip matches "{{dhcp\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{ssid}}" = "\*", true, ssid matches "{{ssid}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount by type<br />\| compare with timeshift 1d<br />\| sort by eventCount, eventCount\_1d, type asc|
|Cisco Meraki|Event Types|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected")<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount by type<br />\| compare with timeshift 1d<br />\| sort by eventCount, eventCount\_1d, type asc|
|Cisco Meraki|Event Types|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected")<br />\| where if ("{{bssid}}" = "\*", true, bssid matches "{{bssid}}") AND if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{channel}}" = "\*", true, channel matches "{{channel}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{dhcp\_ip}}" = "\*", true, dhcp\_ip matches "{{dhcp\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{ssid}}" = "\*", true, ssid matches "{{ssid}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount by type<br />\| compare with timeshift 1d<br />\| sort by eventCount, eventCount\_1d, type asc|
|Cisco Meraki|Event Types Over Time|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  \*events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "\*events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\| timeslice 1h<br />\| where if ("{{bssid}}" = "\*", true, bssid matches "{{bssid}}") AND if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{channel}}" = "\*", true, channel matches "{{channel}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{dhcp\_ip}}" = "\*", true, dhcp\_ip matches "{{dhcp\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{ssid}}" = "\*", true, ssid matches "{{ssid}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount by \_timeslice, type<br />\| transpose row \_timeslice column type|
|Cisco Meraki|Event Types Over Time|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki \*events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "\*events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\| timeslice 1h<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount by \_timeslice, type<br />\| transpose row \_timeslice column type|
|Cisco Meraki|Event Types Over Time|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  \*events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected or containing\_device or device\_alerting)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "\*events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected", "containing\_device", "device\_alerting")<br />\| timeslice 1h<br />\| where if ("{{bssid}}" = "\*", true, bssid matches "{{bssid}}") AND if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{channel}}" = "\*", true, channel matches "{{channel}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{dhcp\_ip}}" = "\*", true, dhcp\_ip matches "{{dhcp\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{ssid}}" = "\*", true, ssid matches "{{ssid}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount by \_timeslice, type<br />\| transpose row \_timeslice column type|
|Cisco Meraki|Events|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events ("status changed from 100fdx to down" or "status changed from down to 100fdx" or "so the port was blocked" or "changed STP role from designated to alternate" or "changed STP role from root to designated" or "changed STP role from alternate to root" or "changed STP role from disabled to designated" or "Blocked DHCP server response from" or "Received VRRP packet for virtual router" or "changed from VRRP backup to VRRP master" or "Power supply" or "future enhancement" or "8021x\_deauth" or "8021x\_eap\_success" or "8021x\_auth" or "8021x\_client\_deauth" or " received a BPDU from " or bounce or "cable test")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events port \* status changed from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events Power supply \* was \* into slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Power supply \* was \* from slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Port \* received an STP BPDU from \* so the port was blocked" as receiver, sender nodrop<br />\| parse "events Port \* received a BPDU from \*, expected \*" as receiver\_port, actual, expected nodrop // STP BPDU sender conflict<br />\| parse "events \* run on port \*" as type, port nodrop // Indicates that the cable test live tool was run on the specified port.<br />\| parse "events \* requested: Ports \* will be \* for \* seconds" as type, port, state, duration nodrop // Cycle port live tool is run to bounce a port.<br />\| where msg\_type="events"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount|
|Cisco Meraki|Events|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount|
|Cisco Meraki|Events|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  \*events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "\*events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected")<br />\| where if ("{{bssid}}" = "\*", true, bssid matches "{{bssid}}") AND if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{channel}}" = "\*", true, channel matches "{{channel}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{dhcp\_ip}}" = "\*", true, dhcp\_ip matches "{{dhcp\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{ssid}}" = "\*", true, ssid matches "{{ssid}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount|
|Cisco Meraki|Events|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events ("status changed from 100fdx to down" or "status changed from down to 100fdx" or "so the port was blocked" or "changed STP role from designated to alternate" or "changed STP role from root to designated" or "changed STP role from alternate to root" or "changed STP role from disabled to designated" or "Blocked DHCP server response from" or "Received VRRP packet for virtual router" or "changed from VRRP backup to VRRP master" or "Power supply" or "future enhancement" or "8021x\_deauth" or "8021x\_eap\_success" or "8021x\_auth" or "8021x\_client\_deauth" or " received a BPDU from " or bounce or "cable test")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events port \* status changed from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events Power supply \* was \* into slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Power supply \* was \* from slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Port \* received an STP BPDU from \* so the port was blocked" as receiver, sender nodrop<br />\| parse "events Port \* received a BPDU from \*, expected \*" as receiver\_port, actual, expected nodrop // STP BPDU sender conflict<br />\| parse "events \* run on port \*" as type, port nodrop // Indicates that the cable test live tool was run on the specified port.<br />\| parse "events \* requested: Ports \* will be \* for \* seconds" as type, port, state, duration nodrop // Cycle port live tool is run to bounce a port.<br />\| where msg\_type="events"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount|
|Cisco Meraki|Events|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki events ("status changed from 100fdx to down" or "status changed from down to 100fdx" or "so the port was blocked" or "changed STP role from designated to alternate" or "changed STP role from root to designated" or "changed STP role from alternate to root" or "changed STP role from disabled to designated" or "Blocked DHCP server response from" or "Received VRRP packet for virtual router" or "changed from VRRP backup to VRRP master" or "Power supply" or "future enhancement" or "8021x\_deauth" or "8021x\_eap\_success" or "8021x\_auth" or "8021x\_client\_deauth" or " received a BPDU from " or bounce or "cable test")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events port \* status changed from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events Power supply \* was \* into slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Power supply \* was \* from slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Port \* received an STP BPDU from \* so the port was blocked" as receiver, sender nodrop<br />\| parse "events Port \* received a BPDU from \*, expected \*" as receiver\_port, actual, expected nodrop // STP BPDU sender conflict<br />\| parse "events \* run on port \*" as type, port nodrop // Indicates that the cable test live tool was run on the specified port.<br />\| parse "events \* requested: Ports \* will be \* for \* seconds" as type, port, state, duration nodrop // Cycle port live tool is run to bounce a port.<br />\| where msg\_type="events"<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount|
|Cisco Meraki|Events|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki \*events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "\*events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected")<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount|
|Cisco Meraki|Events|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount|
|Cisco Meraki|Events|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  \*events type (association or disassociation or wpa\_auth or wpa\_deauth or disassociation or 8021x\_eap\_failure or 8021x\_deauth or 8021x\_eap\_success or splash\_auth or device\_packet\_flood or rogue\_ssid\_detected or ssid\_spoofing\_detected)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "radio", "state", "alarm\_id", "reason", "packet", "device", "bssid", "dst", "channel", "dos\_count", "inter\_arrival", "vpn\_type", "connectivity", "vap", "client\_mac", "client\_ip", "aid", "rssi", "ssid", "src", "wired\_mac", "vlan\_id", "fc\_type", "fc\_subtype" as radio, state, alarm\_id, reason, packet, device, bssid, dst, channel, dos\_count, inter\_arrival, vpn\_type, connectivity, vap, client\_mac, client\_ip, aid, rssi, ssid, src, wired\_mac, vlan\_id, fc\_type, fc\_subtype  nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "instigator", "duration", "auth\_neg\_dur", "last\_auth\_ago", "is\_wpa", "full\_conn", "ip\_resp", "ip\_src", "http\_resp", "arp\_resp", "arp\_src", "dns\_server", "dns\_req\_rtt", "dns\_resp", "dhcp\_lease\_completed", "dhcp\_ip", "dhcp\_server", "dhcp\_server\_mac", "dhcp\_resp" as instigator, duration, auth\_neg\_dur, last\_auth\_ago, is\_wpa, full\_conn, ip\_resp, ip\_src, http\_resp, arp\_resp, arp\_src, dns\_server, dns\_req\_rtt, dns\_resp, dhcp\_lease\_completed, dhcp\_ip, dhcp\_server, dhcp\_server\_mac, dhcp\_resp nodrop<br />\| where msg\_type matches "\*events" and type in ("association", "disassociation", "wpa\_auth", "wpa\_deauth", "disassociation", "8021x\_eap\_failure", "8021x\_deauth", "8021x\_eap\_success", "splash\_auth", "device\_packet\_flood", "rogue\_ssid\_detected", "ssid\_spoofing\_detected")<br />\| where if ("{{bssid}}" = "\*", true, bssid matches "{{bssid}}") AND if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{channel}}" = "\*", true, channel matches "{{channel}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{dhcp\_ip}}" = "\*", true, dhcp\_ip matches "{{dhcp\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{ssid}}" = "\*", true, ssid matches "{{ssid}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount|
|Cisco Meraki|Events Over Time|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events ("vpn\_connectivity\_change" or "Cellular connection down" or "failover to " or "failover to cellular" or "Cellular connection up" or "dhcp lease of")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "vpn\_type", "connectivity", "peer\_contact", "peer\_ident" as vpn\_type, connectivity, peer\_contact, peer\_iden nodrop<br />\| parse "events failover to \*" as target nodrop<br />\| parse "Cellular connection \*" as connection\_status nodrop<br />\| parse "events \* of ip \* from server mac \* for client mac \* from router \* on subnet \* with dns \*" as type, client\_ip, dhcp\_server, client\_mac, router, subnet, dns nodrop<br />\| where msg\_type="events" and (type in ("vpn\_connectivity\_change") or (\_raw matches "\* Cellular connection down\*" or \_raw matches "\* failover to \*" or \_raw matches "\* failover to cellular\*" or \_raw matches "\* Cellular connection up\*") or (\_raw matches "\* dhcp lease \*" and type="dhcp lease"))<br />\| timeslice 1h<br />\| where if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{connection\_status}}" = "\*", true, connection\_status matches "{{connection\_status}}") AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1h)|
|Cisco Meraki|Events Over Time|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events ("vpn\_connectivity\_change" or "Cellular connection down" or "failover to " or "failover to cellular" or "Cellular connection up" or "dhcp lease of")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "vpn\_type", "connectivity", "peer\_contact", "peer\_ident" as vpn\_type, connectivity, peer\_contact, peer\_iden nodrop<br />\| parse "events failover to \*" as target nodrop<br />\| parse "Cellular connection \*" as connection\_status nodrop<br />\| parse "events \* of ip \* from server mac \* for client mac \* from router \* on subnet \* with dns \*" as type, client\_ip, dhcp\_server, client\_mac, router, subnet, dns nodrop<br />\| where msg\_type="events" and (type in ("vpn\_connectivity\_change") or (\_raw matches "\* Cellular connection down\*" or \_raw matches "\* failover to \*" or \_raw matches "\* failover to cellular\*" or \_raw matches "\* Cellular connection up\*") or (\_raw matches "\* dhcp lease \*" and type="dhcp lease"))<br />\| timeslice 1h<br />\| where if ("{{client\_mac}}" = "\*", true, client\_mac matches "{{client\_mac}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{connection\_status}}" = "\*", true, connection\_status matches "{{connection\_status}}") AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{client\_ip}}" = "\*", true, client\_ip matches "{{client\_ip}}")<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1h)|
|Cisco Meraki|Events Over Time|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki events ("status changed from 100fdx to down" or "status changed from down to 100fdx" or "so the port was blocked" or "changed STP role from designated to alternate" or "changed STP role from root to designated" or "changed STP role from alternate to root" or "changed STP role from disabled to designated" or "Blocked DHCP server response from" or "Received VRRP packet for virtual router" or "changed from VRRP backup to VRRP master" or "Power supply" or "future enhancement" or "8021x\_deauth" or "8021x\_eap\_success" or "8021x\_auth" or "8021x\_client\_deauth" or " received a BPDU from " or bounce or "cable test")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events Port \* changed STP role from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events port \* status changed from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events Power supply \* was \* into slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Power supply \* was \* from slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Port \* received an STP BPDU from \* so the port was blocked" as receiver, sender nodrop<br />\| parse "events Port \* received a BPDU from \*, expected \*" as receiver\_port, actual, expected nodrop // STP BPDU sender conflict<br />\| parse "events \* run on port \*" as type, port nodrop // Indicates that the cable test live tool was run on the specified port.<br />\| parse "events \* requested: Ports \* will be \* for \* seconds" as type, port, state, duration nodrop // Cycle port live tool is run to bounce a port.<br />\| where msg\_type="events"<br />\| timeslice 1h<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount by \_timeslice<br />\| fillmissing timeslice(1h)|
|Cisco Meraki|Events Over Time|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events ("status changed from 100fdx to down" or "status changed from down to 100fdx" or "so the port was blocked" or "changed STP role from designated to alternate" or "changed STP role from root to designated" or "changed STP role from alternate to root" or "changed STP role from disabled to designated" or "Blocked DHCP server response from" or "Received VRRP packet for virtual router" or "changed from VRRP backup to VRRP master" or "Power supply" or "future enhancement" or "8021x\_deauth" or "8021x\_eap\_success" or "8021x\_auth" or "8021x\_client\_deauth" or " received a BPDU from " or bounce or "cable test")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events Port \* changed STP role from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events port \* status changed from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events Power supply \* was \* into slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Power supply \* was \* from slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Port \* received an STP BPDU from \* so the port was blocked" as receiver, sender nodrop<br />\| parse "events Port \* received a BPDU from \*, expected \*" as receiver\_port, actual, expected nodrop // STP BPDU sender conflict<br />\| parse "events \* run on port \*" as type, port nodrop // Indicates that the cable test live tool was run on the specified port.<br />\| parse "events \* requested: Ports \* will be \* for \* seconds" as type, port, state, duration nodrop // Cycle port live tool is run to bounce a port.<br />\| where msg\_type="events"<br />\| timeslice 1h<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1h)|
|Cisco Meraki|Events Over Time|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki events ("vpn\_connectivity\_change" or "Cellular connection down" or "failover to " or "failover to cellular" or "Cellular connection up" or "dhcp lease of")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "vpn\_type", "connectivity", "peer\_contact", "peer\_ident" as vpn\_type, connectivity, peer\_contact, peer\_iden nodrop<br />\| parse "events failover to \*" as target nodrop<br />\| parse "Cellular connection \*" as connection\_status nodrop<br />\| parse "events \* of ip \* from server mac \* for client mac \* from router \* on subnet \* with dns \*" as type, client\_ip, dhcp\_server, client\_mac, router, subnet, dns nodrop<br />\| where msg\_type="events" and (type in ("vpn\_connectivity\_change") or (\_raw matches "\* Cellular connection down\*" or \_raw matches "\* failover to \*" or \_raw matches "\* failover to cellular\*" or \_raw matches "\* Cellular connection up\*") or (\_raw matches "\* dhcp lease \*" and type="dhcp lease"))<br />\| timeslice 1h<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount by \_timeslice<br />\| fillmissing timeslice(1h)|
|Cisco Meraki|Events Over Time|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events ("status changed from 100fdx to down" or "status changed from down to 100fdx" or "so the port was blocked" or "changed STP role from designated to alternate" or "changed STP role from root to designated" or "changed STP role from alternate to root" or "changed STP role from disabled to designated" or "Blocked DHCP server response from" or "Received VRRP packet for virtual router" or "changed from VRRP backup to VRRP master" or "Power supply" or "future enhancement" or "8021x\_deauth" or "8021x\_eap\_success" or "8021x\_auth" or "8021x\_client\_deauth" or " received a BPDU from " or bounce or "cable test")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events Port \* changed STP role from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events port \* status changed from \* to \*" as port, initial\_state, end\_state nodrop<br />\| parse "events Power supply \* was \* into slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Power supply \* was \* from slot \*" as serial\_no, action, slot nodrop<br />\| parse "events Port \* received an STP BPDU from \* so the port was blocked" as receiver, sender nodrop<br />\| parse "events Port \* received a BPDU from \*, expected \*" as receiver\_port, actual, expected nodrop // STP BPDU sender conflict<br />\| parse "events \* run on port \*" as type, port nodrop // Indicates that the cable test live tool was run on the specified port.<br />\| parse "events \* requested: Ports \* will be \* for \* seconds" as type, port, state, duration nodrop // Cycle port live tool is run to bounce a port.<br />\| where msg\_type="events"<br />\| timeslice 1h<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by \_timeslice<br />\| fillmissing timeslice(1h)|
|Cisco Meraki|File Issued Retrospective Malicious Disposition|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" "security\_filtering\_disposition\_change"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" and type="security\_filtering\_disposition\_change"<br />\| timeslice 1s<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by \_timeslice, name, type, filename, sha256, disposition, action<br />\| sort by \_timeslice, name, type, filename, sha256, disposition, action|
|Cisco Meraki|File Issued Retrospective Malicious Disposition|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" "security\_filtering\_disposition\_change"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" and type="security\_filtering\_disposition\_change"<br />\| timeslice 1s<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by \_timeslice, name, type, filename, sha256, disposition, action<br />\| sort by \_timeslice, name, type, filename, sha256, disposition, action|
|Cisco Meraki|Flows By Pattern|Logs|Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall pattern<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall" and isEmpty(action) and !isEmpty(pattern)<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| timeslice 5m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count pattern, \_timeslice <br />\| transpose row \_timeslice column pattern|
|Cisco Meraki|Flows By Pattern|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Allowed and Rejected|\_sourceCategory={{Metricsdatasource}}  firewall pattern<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall" and isEmpty(action) and !isEmpty(pattern)<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| timeslice 5m<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count pattern, \_timeslice <br />\| transpose row \_timeslice column pattern|
|Cisco Meraki|High Severity Threats|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| where priority="1" and msg\_type="security\_event"<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as threatCount|
|Cisco Meraki|High Severity Threats|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| where priority="1" and msg\_type="security\_event"<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as threatCount|
|Cisco Meraki|High Severity Threats|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| where priority="1" and msg\_type="security\_event"<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count as threatCount|
|Cisco Meraki|Host Impacted|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" ids\_alerted<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" and type="ids\_alerted"<br />\| if (!isEmpty(dhost), dhost, shost) as host<br />\| where if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by host<br />\| top 20 host by eventCount, host asc|
|Cisco Meraki|Host Impacted|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" ids\_alerted<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" and type="ids\_alerted"<br />\| if (!isEmpty(dhost), dhost, shost) as host<br />\| where if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by host<br />\| top 20 host by eventCount, host asc|
|Cisco Meraki|HTTP Requests|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count as Requests|
|Cisco Meraki|HTTP Requests|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as Requests|
|Cisco Meraki|HTTP Requests|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as Requests|
|Cisco Meraki|IDS Signature Matched|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" ids\_alerted<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| if (!isEmpty(dhost), dhost, shost) as host<br />\| where msg\_type="security\_event" and type="ids\_alerted"<br />\| timeslice 1s<br />\| where if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by \_timeslice, name, signature, priority, host, direction, protocol, src\_ip, src\_port, dest\_ip, dest\_port, msg<br />\| sort by \_timeslice, name, signature, priority, host, direction, protocol, src\_ip, src\_port, dest\_ip, dest\_port, msg|
|Cisco Meraki|IDS Signature Matched|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" ids\_alerted<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| if (!isEmpty(dhost), dhost, shost) as host<br />\| where msg\_type="security\_event" and type="ids\_alerted"<br />\| timeslice 1s<br />\| where if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by \_timeslice, name, signature, priority, host, direction, protocol, src\_ip, src\_port, dest\_ip, dest\_port, msg<br />\| sort by \_timeslice, name, signature, priority, host, direction, protocol, src\_ip, src\_port, dest\_ip, dest\_port, msg|
|Cisco Meraki|Mac Addresses|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count\_distinct(mac\_address) as Unique\_mac\_addresses|
|Cisco Meraki|Mac Addresses|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count\_distinct(mac\_address) as Unique\_mac\_addresses|
|Cisco Meraki|Malicious File Blocked by AMP|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" "security\_filtering\_file\_scanned"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" and type="security\_filtering\_file\_scanned"<br />\| timeslice 1s<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by \_timeslice, name, url, src\_ip, src\_port, dest\_ip, dest\_port, mac, sha256, disposition, action<br />\| sort by \_timeslice, name, url, src\_ip, src\_port, dest\_ip, dest\_port, mac, sha256, disposition, action|
|Cisco Meraki|Malicious File Blocked by AMP|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" "security\_filtering\_file\_scanned"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" and type="security\_filtering\_file\_scanned"<br />\| timeslice 1s<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by \_timeslice, name, url, src\_ip, src\_port, dest\_ip, dest\_port, mac, sha256, disposition, action<br />\| sort by \_timeslice, name, url, src\_ip, src\_port, dest\_ip, dest\_port, mac, sha256, disposition, action|
|Cisco Meraki|Media Types Requested Over Time|Logs|Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| parse regex field=url "\\.(?\<media\_type\>[A-Za-z]+)\$" <br />\| where !isEmpty(media\_type)<br />\| timeslice 5m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{media\_type}}" = "\*", true, media\_type matches "{{media\_type}}")<br />\| count by \_timeslice, media\_type<br />\| transpose row \_timeslice column media\_type|
|Cisco Meraki|Media Types Requested Over Time|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| parse regex field=url "\\.(?\<media\_type\>[A-Za-z]+)\$" <br />\| where !isEmpty(media\_type)<br />\| timeslice 5m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{media\_type}}" = "\*", true, media\_type matches "{{media\_type}}")<br />\| count by \_timeslice, media\_type<br />\| transpose row \_timeslice column media\_type|
|Cisco Meraki|Message Types|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}} <br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by msg\_type<br />\| sort by eventCount, msg\_type asc|
|Cisco Meraki|Message Types|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}} <br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by msg\_type<br />\| sort by eventCount, msg\_type asc|
|Cisco Meraki|Message Types|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count as eventCount by msg\_type<br />\| sort by eventCount, msg\_type asc|
|Cisco Meraki|Message Types Trend|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}} <br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| timeslice 1h<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount1 by \_timeslice, msg\_type<br />\| transpose row \_timeslice column msg\_type|
|Cisco Meraki|Message Types Trend|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| timeslice 1h<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count as eventCount1 by \_timeslice, msg\_type<br />\| transpose row \_timeslice column msg\_type|
|Cisco Meraki|Message Types Trend|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}} <br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| timeslice 1h<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount1 by \_timeslice, msg\_type<br />\| transpose row \_timeslice column msg\_type|
|Cisco Meraki|Methods|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by method \| sort by Requests, method asc|
|Cisco Meraki|Methods|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by method \| sort by Requests, method asc|
|Cisco Meraki|Most Prevalent Threat|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" ids\_alerted<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" and type="ids\_alerted"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by msg<br />\| top 10 msg by eventCount, msg asc|
|Cisco Meraki|Most Prevalent Threat|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event" ids\_alerted<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" and type="ids\_alerted"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\| count as eventCount by msg<br />\| top 10 msg by eventCount, msg asc|
|Cisco Meraki|Names|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count as eventCount by name<br />\| sort by eventCount, name asc|
|Cisco Meraki|Names|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}} <br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by name<br />\| sort by eventCount, name asc|
|Cisco Meraki|Names|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}} <br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by name<br />\| sort by eventCount, name asc|
|Cisco Meraki|Names Trend|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}} <br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| timeslice 1h<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by \_timeslice, name<br />\| transpose row \_timeslice column name|
|Cisco Meraki|Names Trend|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}} <br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| timeslice 1h<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount by \_timeslice, name<br />\| transpose row \_timeslice column name|
|Cisco Meraki|Names Trend|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+"<br />\| timeslice 1h<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count as eventCount by \_timeslice, name<br />\| transpose row \_timeslice column name|
|Cisco Meraki|Number of Requests - Time Compare|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by \_timeslice  <br />\| compare with timeshift 1d 2|
|Cisco Meraki|Number of Requests - Time Compare|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by \_timeslice  <br />\| compare with timeshift 1d 2|
|Cisco Meraki|Operating Systems and Browsers|Logs|Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls agent<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| if (user\_agent matches "\*Windows NT\*" or user\_agent matches "\*Windows+NT\*" or user\_agent matches "\*Windows \*" or user\_agent matches "\*Win32\*" or user\_agent matches "\*Win64\*", "Windows", "Other") as OS <br />\| if (user\_agent matches "\*Macintosh\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*MacBook\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*Mac\*OS\*X\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*" or user\_agent matches "\*Windows+Phone\*","Windows Phone",OS) as OS <br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Darwin\*","Darwin",OS) as OS <br />\| if (user\_agent matches "\*CrOS\*","Google Chrome",OS) as OS <br />\| if (user\_agent matches "\*MSIE\*","Internet Explorer","Other") as Browser <br />\| if (user\_agent matches "Internet Explorer","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Trident\*","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (user\_agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (user\_agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (user\_agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (user\_agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (OS == "Android" AND user\_agent matches "\*WebKit\*","WebKit", Browser) as Browser<br />\| if (user\_agent matches "\*Googlebot\*","Googlebot","") as Bot <br />\| if (user\_agent matches "\*proximic\*Web-Crawler\*","Proximic",Bot) as Bot <br />\| if (user\_agent matches "\*proximic\*spider\*","Proximic",Bot) as Bot <br />\| if (user\_agent matches "\*IAS\*crawler\*","IAS",Bot) as Bot <br />\| if (user\_agent matches "\*bingbot\*","Bing",Bot) as Bot <br />\| if (user\_agent matches "\*Nimbostratus-Bot\*","Nimbostratus",Bot) as Bot<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{OS}}" = "\*", true, OS matches "{{OS}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{Browser}}" = "\*", true, Browser matches "{{Browser}}")<br />\| count(user\_agent) by OS, Browser <br />\| transpose row os column browser as \*|
|Cisco Meraki|Operating Systems and Browsers|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls agent<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| if (user\_agent matches "\*Windows NT\*" or user\_agent matches "\*Windows+NT\*" or user\_agent matches "\*Windows \*" or user\_agent matches "\*Win32\*" or user\_agent matches "\*Win64\*", "Windows", "Other") as OS <br />\| if (user\_agent matches "\*Macintosh\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*MacBook\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*Mac\*OS\*X\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*" or user\_agent matches "\*Windows+Phone\*","Windows Phone",OS) as OS <br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Darwin\*","Darwin",OS) as OS <br />\| if (user\_agent matches "\*CrOS\*","Google Chrome",OS) as OS <br />\| if (user\_agent matches "\*MSIE\*","Internet Explorer","Other") as Browser <br />\| if (user\_agent matches "Internet Explorer","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Trident\*","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (user\_agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (user\_agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (user\_agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (user\_agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (OS == "Android" AND user\_agent matches "\*WebKit\*","WebKit", Browser) as Browser<br />\| if (user\_agent matches "\*Googlebot\*","Googlebot","") as Bot <br />\| if (user\_agent matches "\*proximic\*Web-Crawler\*","Proximic",Bot) as Bot <br />\| if (user\_agent matches "\*proximic\*spider\*","Proximic",Bot) as Bot <br />\| if (user\_agent matches "\*IAS\*crawler\*","IAS",Bot) as Bot <br />\| if (user\_agent matches "\*bingbot\*","Bing",Bot) as Bot <br />\| if (user\_agent matches "\*Nimbostratus-Bot\*","Nimbostratus",Bot) as Bot<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{OS}}" = "\*", true, OS matches "{{OS}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{Browser}}" = "\*", true, Browser matches "{{Browser}}")<br />\| count(user\_agent) by OS, Browser <br />\| transpose row os column browser as \*|
|Cisco Meraki|OS Platform|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls agent<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*Galaxy\*" or user\_agent matches "\*Windows Phone\*" or user\_agent matches "\*Android\*" or user\_agent matches "LGE-\*" or user\_agent matches "SCH-\*" or user\_agent matches "\*HUAWEI-\*" or user\_agent matches "\*samsung\*" or user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" or user\_agent matches "\*CFNetwork\*" or user\_agent matches "\*UP.Browser/\*" or user\_agent matches "\*QQ\*rowser\*" or user\_agent matches "\*NetFront/\*" or user\_agent matches "\*Mobile Safari\*" or user\_agent matches "\*iemobile\*","Mobile","PC") as OS\_Platform<br />\| if (user\_agent matches "\*Macintosh\*" or user\_agent matches "\*Mac OS\*" or user\_agent matches "\*iMac\*", "Mac", OS\_Platform) as OS\_Platform<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{OS\_Platform}}" = "\*", true, OS\_Platform matches "{{OS\_Platform}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count OS\_Platform  \| sort by \_count, OS\_Platform asc|
|Cisco Meraki|OS Platform|Logs|Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls agent<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*Galaxy\*" or user\_agent matches "\*Windows Phone\*" or user\_agent matches "\*Android\*" or user\_agent matches "LGE-\*" or user\_agent matches "SCH-\*" or user\_agent matches "\*HUAWEI-\*" or user\_agent matches "\*samsung\*" or user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" or user\_agent matches "\*CFNetwork\*" or user\_agent matches "\*UP.Browser/\*" or user\_agent matches "\*QQ\*rowser\*" or user\_agent matches "\*NetFront/\*" or user\_agent matches "\*Mobile Safari\*" or user\_agent matches "\*iemobile\*","Mobile","PC") as OS\_Platform<br />\| if (user\_agent matches "\*Macintosh\*" or user\_agent matches "\*Mac OS\*" or user\_agent matches "\*iMac\*", "Mac", OS\_Platform) as OS\_Platform<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{OS\_Platform}}" = "\*", true, OS\_Platform matches "{{OS\_Platform}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count OS\_Platform  \| sort by \_count, OS\_Platform asc|
|Cisco Meraki|OS Platform|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls agent<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*Galaxy\*" or user\_agent matches "\*Windows Phone\*" or user\_agent matches "\*Android\*" or user\_agent matches "LGE-\*" or user\_agent matches "SCH-\*" or user\_agent matches "\*HUAWEI-\*" or user\_agent matches "\*samsung\*" or user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" or user\_agent matches "\*CFNetwork\*" or user\_agent matches "\*UP.Browser/\*" or user\_agent matches "\*QQ\*rowser\*" or user\_agent matches "\*NetFront/\*" or user\_agent matches "\*Mobile Safari\*" or user\_agent matches "\*iemobile\*","Mobile","PC") as OS\_Platform<br />\| if (user\_agent matches "\*Macintosh\*" or user\_agent matches "\*Mac OS\*" or user\_agent matches "\*iMac\*","Mac",OS\_Platform) as OS\_Platform<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{OS\_Platform}}" = "\*", true, OS\_Platform matches "{{OS\_Platform}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count OS\_Platform \| sort by \_count, OS\_Platform asc|
|Cisco Meraki|OS Platform|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls agent<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*Galaxy\*" or user\_agent matches "\*Windows Phone\*" or user\_agent matches "\*Android\*" or user\_agent matches "LGE-\*" or user\_agent matches "SCH-\*" or user\_agent matches "\*HUAWEI-\*" or user\_agent matches "\*samsung\*" or user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" or user\_agent matches "\*CFNetwork\*" or user\_agent matches "\*UP.Browser/\*" or user\_agent matches "\*QQ\*rowser\*" or user\_agent matches "\*NetFront/\*" or user\_agent matches "\*Mobile Safari\*" or user\_agent matches "\*iemobile\*","Mobile","PC") as OS\_Platform<br />\| if (user\_agent matches "\*Macintosh\*" or user\_agent matches "\*Mac OS\*" or user\_agent matches "\*iMac\*","Mac",OS\_Platform) as OS\_Platform<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{OS\_Platform}}" = "\*", true, OS\_Platform matches "{{OS\_Platform}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count OS\_Platform \| sort by \_count, OS\_Platform asc|
|Cisco Meraki|Platform Versions|Logs|Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls agent<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| if (user\_agent matches "\*Windows NT\*" or user\_agent matches "\*Windows+NT\*" or user\_agent matches "\*Windows \*" or user\_agent matches "\*Win32\*" or user\_agent matches "\*Win64\*", "Windows", "Other") as OS <br />\| if (user\_agent matches "\*Macintosh\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*MacBook\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*Mac\*OS\*X\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*" or user\_agent matches "\*Windows+Phone\*","Windows Phone",OS) as OS <br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Darwin\*","Darwin",OS) as OS <br />\| if (user\_agent matches "\*CrOS\*","Google Chrome",OS) as OS <br />\| where OS \<\> "Other"<br />\| parse regex field=user\_agent "Windows[\\+\\s]NT[\\+\\s](?\<version\>[\\d.]+?)(?:;\|\\)\|\\s\|\$)" nodrop <br />\| parse regex field=user\_agent "Windows[\\+\\s](?\<version\>[\\d.]+?)(?:;\|\\)\|\\s\|/)" nodrop <br />\| parse regex field=user\_agent "[Mac\|Macintosh;][\\s\\+]OS[\\s\\+](?\<version\>X[,\\s]\*[\\d\\\_.\\/]+?)(?:;\|\\)\|,\|\\s)" nodrop <br />\| parse regex field=user\_agent "MacBookAir[\\d,]\*;\\s+(?\<version\>[\\d\\\_\\.\\/]+?)(?:;\|\\)\|,\|\\s)" nodrop <br />\| parse regex field=user\_agent "Mac\\sOS\\s(?\<version\>X\\sVersion\\s[\\d\\\_.\\/]+?)(?:;\|\\)\|,\|\\s)" nodrop  <br />\| parse regex field=user\_agent "Linux[/\\s](?\<version\>[xi\\d.\\\_]+?)(?:;\|\\)\|\\s)" nodrop <br />\| parse regex field=user\_agent "Linux;\\s.\*?(?\<version\>Tizen\\s[\\d.]+?)(?:;\|\\)\|\\s)" nodrop  <br />\| parse regex field=user\_agent "iPad;[\\+\\s]CPU[\\+\\s]OS[\\+\\s](?\<version\>[\\d\_]+?)\\s+" nodrop <br />\| parse regex field=user\_agent "iPad[\\d,]+[/]+(?\<version\>[\\d\_/.]+?)\\s+" nodrop <br />\| parse regex field=user\_agent "iPad; U; CPU OS (?\<version\>[\\d\_/.]+?)\\s+" nodrop <br />\| parse regex field=user\_agent "iOS[/\\s](?\<version\>[\\d\_/.]+?)\\s+.\*iPad[\\d,]\*" nodrop <br />\| parse regex field=user\_agent "iPad; iOS (?\<version\>[\\d\_/.]+?)(?:;\|\\)\|\\s)" nodrop <br />\| parse regex field=user\_agent "iPhone;[\\+\\s]CPU[\\+\\s]iPhone[\\+\\s]OS[\\+\\s](?\<version\>[\\d\_]+?)(?:\\+\|\\)\|\\s)" nodrop<br />\| parse regex field=user\_agent "iPhone OS[,\\s](?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,)" nodrop<br />\| parse regex field=user\_agent "iPhone; CPU OS[,\\s](?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,\|\\s)" nodrop<br />\| parse regex field=user\_agent "iPhone;\\sU;\\sCPU\\sOS[,\\s](?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,\|\\s)" nodrop<br />\| parse regex field=user\_agent "iPhone;\\sU;\\sCPU\\siPhone OS[,\\s](?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,\|\\s)" nodrop<br />\| parse regex field=user\_agent "iPhone[\\d,]\*[;/]\\s\*(?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,\|\\s\|;\|\$\|\\s)" nodrop<br />\| parse regex field=user\_agent "iOS[/\\s](?\<version\>[\\d\_/.]+?)\\s+.\*iPhone[\\d,]\*" nodrop <br />\| parse regex field=user\_agent "Android[\\+\\s/,]\\s\*(?\<version\>[\\d.]+?)(?:;\|\\)\|/\|\\s\|,\|\$)" nodrop <br />\| parse regex field=user\_agent "Android OS version:\\s+(?\<version\>[\\d.]+?)(?:;\|\\)\|/\|\\s\|,\|\$\|\\-)" nodrop <br />\| parse regex field=user\_agent "Darwin[/\\s](?\<version\>[\\d.]+?)(?:\\+\|\$\|\\s\|;)" nodrop <br />\| parse regex field=user\_agent "CrOS\\s+(?\<version\>[x\\d.\\\_\\+\\s]+?)(?:;\|\\))" nodrop<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{OS}}" = "\*", true, OS matches "{{OS}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{version}}" = "\*", true, version matches "{{version}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by OS, version <br />\| top 50 OS, version by \_count, OS asc, version asc|
|Cisco Meraki|Platform Versions|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls agent<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| if (user\_agent matches "\*Windows NT\*" or user\_agent matches "\*Windows+NT\*" or user\_agent matches "\*Windows \*" or user\_agent matches "\*Win32\*" or user\_agent matches "\*Win64\*", "Windows", "Other") as OS <br />\| if (user\_agent matches "\*Macintosh\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*MacBook\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*Mac\*OS\*X\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*" or user\_agent matches "\*Windows+Phone\*","Windows Phone",OS) as OS <br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Darwin\*","Darwin",OS) as OS <br />\| if (user\_agent matches "\*CrOS\*","Google Chrome",OS) as OS <br />\| where OS \<\> "Other"<br />\| parse regex field=user\_agent "Windows[\\+\\s]NT[\\+\\s](?\<version\>[\\d.]+?)(?:;\|\\)\|\\s\|\$)" nodrop <br />\| parse regex field=user\_agent "Windows[\\+\\s](?\<version\>[\\d.]+?)(?:;\|\\)\|\\s\|/)" nodrop <br />\| parse regex field=user\_agent "[Mac\|Macintosh;][\\s\\+]OS[\\s\\+](?\<version\>X[,\\s]\*[\\d\\\_.\\/]+?)(?:;\|\\)\|,\|\\s)" nodrop <br />\| parse regex field=user\_agent "MacBookAir[\\d,]\*;\\s+(?\<version\>[\\d\\\_\\.\\/]+?)(?:;\|\\)\|,\|\\s)" nodrop <br />\| parse regex field=user\_agent "Mac\\sOS\\s(?\<version\>X\\sVersion\\s[\\d\\\_.\\/]+?)(?:;\|\\)\|,\|\\s)" nodrop  <br />\| parse regex field=user\_agent "Linux[/\\s](?\<version\>[xi\\d.\\\_]+?)(?:;\|\\)\|\\s)" nodrop <br />\| parse regex field=user\_agent "Linux;\\s.\*?(?\<version\>Tizen\\s[\\d.]+?)(?:;\|\\)\|\\s)" nodrop  <br />\| parse regex field=user\_agent "iPad;[\\+\\s]CPU[\\+\\s]OS[\\+\\s](?\<version\>[\\d\_]+?)\\s+" nodrop <br />\| parse regex field=user\_agent "iPad[\\d,]+[/]+(?\<version\>[\\d\_/.]+?)\\s+" nodrop <br />\| parse regex field=user\_agent "iPad; U; CPU OS (?\<version\>[\\d\_/.]+?)\\s+" nodrop <br />\| parse regex field=user\_agent "iOS[/\\s](?\<version\>[\\d\_/.]+?)\\s+.\*iPad[\\d,]\*" nodrop <br />\| parse regex field=user\_agent "iPad; iOS (?\<version\>[\\d\_/.]+?)(?:;\|\\)\|\\s)" nodrop <br />\| parse regex field=user\_agent "iPhone;[\\+\\s]CPU[\\+\\s]iPhone[\\+\\s]OS[\\+\\s](?\<version\>[\\d\_]+?)(?:\\+\|\\)\|\\s)" nodrop<br />\| parse regex field=user\_agent "iPhone OS[,\\s](?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,)" nodrop<br />\| parse regex field=user\_agent "iPhone; CPU OS[,\\s](?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,\|\\s)" nodrop<br />\| parse regex field=user\_agent "iPhone;\\sU;\\sCPU\\sOS[,\\s](?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,\|\\s)" nodrop<br />\| parse regex field=user\_agent "iPhone;\\sU;\\sCPU\\siPhone OS[,\\s](?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,\|\\s)" nodrop<br />\| parse regex field=user\_agent "iPhone[\\d,]\*[;/]\\s\*(?\<version\>[\\d\_.]+?)(?:\\+\|\\)\|,\|\\s\|;\|\$\|\\s)" nodrop<br />\| parse regex field=user\_agent "iOS[/\\s](?\<version\>[\\d\_/.]+?)\\s+.\*iPhone[\\d,]\*" nodrop <br />\| parse regex field=user\_agent "Android[\\+\\s/,]\\s\*(?\<version\>[\\d.]+?)(?:;\|\\)\|/\|\\s\|,\|\$)" nodrop <br />\| parse regex field=user\_agent "Android OS version:\\s+(?\<version\>[\\d.]+?)(?:;\|\\)\|/\|\\s\|,\|\$\|\\-)" nodrop <br />\| parse regex field=user\_agent "Darwin[/\\s](?\<version\>[\\d.]+?)(?:\\+\|\$\|\\s\|;)" nodrop <br />\| parse regex field=user\_agent "CrOS\\s+(?\<version\>[x\\d.\\\_\\+\\s]+?)(?:;\|\\))" nodrop<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{OS}}" = "\*", true, OS matches "{{OS}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{version}}" = "\*", true, version matches "{{version}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by OS, version <br />\| top 50 OS, version by \_count, OS asc, version asc|
|Cisco Meraki|Possible Horizontal Port Scan Attack - Allowed|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and !isEmpty(dest\_port)<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"DestinationHosts" by dest\_port<br />\| where %"DestinationHosts" \> {{threshold}}<br />\| top 20 dest\_port by %"DestinationHosts", dest\_port asc |
|Cisco Meraki|Possible Horizontal Port Scan Attack - Allowed|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and !isEmpty(dest\_port)<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"DestinationHosts" by dest\_port<br />\| where %"DestinationHosts" \> {{threshold}}<br />\| top 20 dest\_port by %"DestinationHosts", dest\_port asc |
|Cisco Meraki|Possible Horizontal Port Scan Attack - Rejected|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and !isEmpty(dest\_port)<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"DestinationHosts" by dest\_port<br />\| where %"DestinationHosts" \> {{threshold}}<br />\| top 20 dest\_port by %"DestinationHosts", dest\_port asc|
|Cisco Meraki|Possible Horizontal Port Scan Attack - Rejected|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and !isEmpty(dest\_port)<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"DestinationHosts" by dest\_port<br />\| where %"DestinationHosts" \> {{threshold}}<br />\| top 20 dest\_port by %"DestinationHosts", dest\_port asc|
|Cisco Meraki|Possible Port Scan Attack|Logs|Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) dport<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and !isEmpty(dest\_port)<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"UniqueDestPorts" by dest\_ip<br />\| where %"UniqueDestPorts" \> 10<br />\| top 100 dest\_ip by %"UniqueDestPorts", dest\_ip asc<br /><br />|
|Cisco Meraki|Possible Port Scan Attack|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) dport<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and !isEmpty(dest\_port)<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"UniqueDestPorts" by dest\_ip<br />\| where %"UniqueDestPorts" \> 10<br />\| top 100 dest\_ip by %"UniqueDestPorts", dest\_ip asc<br /><br />|
|Cisco Meraki|Possible Port Scan Attack|Logs|Cisco Meraki/Cisco Meraki - Overview - New|\_sourceCategory = Labs/CiscoMeraki flows (allow or "Group Policy Allow" or 0) dport<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " flows\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="flows" and action = "allow" and !isEmpty(dest\_port)<br />\|where if ("{{method}}" = "\*", true, method matches "{{method}}")<br />\|count\_distinct(dest\_port) as %"UniqueDestPorts" by dest\_ip<br />\| where %"UniqueDestPorts" \> 10<br />\| top 100 dest\_ip by %"UniqueDestPorts", dest\_ip asc|
|Cisco Meraki|Possible Vertical Port Scan Attack - Allowed|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"DestinationPorts" by dest\_ip<br />\| where %"DestinationPorts" \> {{threshold}}<br />\| top 20 dest\_ip by %"DestinationPorts", dest\_ip asc|
|Cisco Meraki|Possible Vertical Port Scan Attack - Allowed|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"DestinationPorts" by dest\_ip<br />\| where %"DestinationPorts" \> {{threshold}}<br />\| top 20 dest\_ip by %"DestinationPorts", dest\_ip asc|
|Cisco Meraki|Possible Vertical Port Scan Attack - Rejected|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"DestinationPorts" by dest\_ip<br />\| where %"DestinationPorts" \> {{threshold}}<br />\| top 20 dest\_ip by %"DestinationPorts", dest\_ip asc|
|Cisco Meraki|Possible Vertical Port Scan Attack - Rejected|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br /><br />\| count by dest\_port , dest\_ip<br />\| count as %"DestinationPorts" by dest\_ip<br />\| where %"DestinationPorts" \> {{threshold}}<br />\| top 20 dest\_ip by %"DestinationPorts", dest\_ip asc|
|Cisco Meraki|Protocols|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by protocol<br />\| sort by eventCount, protocol asc<br />\| protocol as Protocol\_Val<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/protocol-numbers.csv on Decimal=Protocol\_val <br />\| if (isNull(keyword), Protocol\_val, Keyword) as Protocol<br />\| fields -keyword, protocol\_val|
|Cisco Meraki|Protocols|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by protocol<br />\| sort by eventCount, protocol asc<br />\| protocol as Protocol\_Val<br />\| lookup Keyword from https://s3.amazonaws.com/sumologic-app-data/protocol-numbers.csv on Decimal=Protocol\_val <br />\| if (isNull(keyword), Protocol\_val, Keyword) as Protocol<br />\| fields -keyword, protocol\_val|
|Cisco Meraki|Requests|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as requests|
|Cisco Meraki|Requests|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as requests|
|Cisco Meraki|Requests Outlier|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by \_timeslice<br />\| outlier Requests window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Requests Outlier|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by \_timeslice<br />\| outlier Requests window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Requests Per Minute|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as request by \_timeslice, method<br />\| transpose row \_timeslice column method|
|Cisco Meraki|Requests Per Minute|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as request by \_timeslice, method<br />\| transpose row \_timeslice column method|
|Cisco Meraki|Security Threat Events Over Time|Logs|Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" <br />\| timeslice 1h<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\|count as threat\_events by \_timeslice<br />\| fillmissing timeslice(1h)|
|Cisco Meraki|Security Threat Events Over Time|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Security Threats|\_sourceCategory={{Metricsdatasource}}  "security\_event"<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse regex "security\_event\\s+(?\<type\>\\S+)\\s" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "signature", "priority", "dhost", "shost", "direction", "protocol", "src", "dst", "name", "sha256", "disposition", "action", "url", "mac" as signature, priority, dhost, shost, direction, protocol, src, dst, filename, sha256, disposition, action, url, mac nodrop<br />\| parse regex " message:\\s\*(?\<msg\>.\*)" nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop \| parse field=filename "\\'\*\\'" as filename nodrop \| parse field=disposition "\\'\*\\'" as disposition nodrop<br />\| if (priority="1", "High", if (priority="2", "Medium", if (priority="3", "Low", if (priority="4", "Very Low", priority)))) as priority<br />\| where msg\_type="security\_event" <br />\| timeslice 1h<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{filename}}" = "\*", true, filename matches "{{filename}}") AND if ("{{signature}}" = "\*", true, signature matches "{{signature}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{mac}}" = "\*", true, mac matches "{{mac}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{direction}}" = "\*", true, direction matches "{{direction}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{sha256}}" = "\*", true, sha256 matches "{{sha256}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{shost}}" = "\*", true, shost matches "{{shost}}") AND if ("{{priority}}" = "\*", true, priority matches "{{priority}}") AND if ("{{dhost}}" = "\*", true, dhost matches "{{dhost}}") AND if ("{{disposition}}" = "\*", true, disposition matches "{{disposition}}")<br />\|count as threat\_events by \_timeslice<br />\| fillmissing timeslice(1h)|
|Cisco Meraki|Sources|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by src\_ip<br />\| count|
|Cisco Meraki|Sources|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count by src\_ip<br />\| count|
|Cisco Meraki|Threat By Actor|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|Cisco Meraki|Threat By Actor|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|Cisco Meraki|Threat By Actor|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|Cisco Meraki|Threat By Actor|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by Actor<br />\| sort by threatCount, Actor asc|
|Cisco Meraki|Threat by Malicious Confidence|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|Cisco Meraki|Threat by Malicious Confidence|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|Cisco Meraki|Threat by Malicious Confidence|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|Cisco Meraki|Threat by Malicious Confidence|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount by malicious\_confidence<br />\| sort by threatCount, malicious\_confidence asc|
|Cisco Meraki|Threat Count|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|Cisco Meraki|Threat Count|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|Cisco Meraki|Threat Count|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|Cisco Meraki|Threat Count|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|Cisco Meraki|Threat Location|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip, url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| lookup latitude, longitude from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Threat Location|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| lookup latitude, longitude from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Threat Location|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip, url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| lookup latitude, longitude from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Threat Location|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=dest\_ip <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| lookup latitude, longitude from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)|
|Cisco Meraki|Threats By URLs|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|Cisco Meraki|Threats By URLs|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| sum(\_count) as threatCount|
|Cisco Meraki|Top 10 Destination IP|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_ip \| dest\_ip as %"Destination IP"<br />\| top 10 %"Destination IP" by eventCount, %"Destination IP" asc|
|Cisco Meraki|Top 10 Destination IP|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_ip \| dest\_ip as %"Destination IP"<br />\| top 10 %"Destination IP" by eventCount, %"Destination IP" asc|
|Cisco Meraki|Top 10 Destination IP|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_ip \| dest\_ip as %"Destination IP"<br />\| top 10 %"Destination IP" by eventCount, %"Destination IP" asc|
|Cisco Meraki|Top 10 Destination IP|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_ip \| dest\_ip as %"Destination IP"<br />\| top 10 %"Destination IP" by eventCount, %"Destination IP" asc|
|Cisco Meraki|Top 10 Destination Ports|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_port<br />\| top 10 dest\_port by \_count, dest\_port asc|
|Cisco Meraki|Top 10 Destination Ports|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by dest\_port<br />\| top 10 dest\_port by \_count, dest\_port asc|
|Cisco Meraki|Top 10 Media Types Requested|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| parse regex field=url "\\.(?\<media\_type\>[A-Za-z]+)\$"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{media\_type}}" = "\*", true, media\_type matches "{{media\_type}}")<br />\| count by media\_type<br />\| where !isEmpty(media\_type)<br />\| top 10 media\_type by \_count, media\_type asc|
|Cisco Meraki|Top 10 Media Types Requested|Logs|Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| parse regex field=url "\\.(?\<media\_type\>[A-Za-z]+)\$"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{media\_type}}" = "\*", true, media\_type matches "{{media\_type}}")<br />\| count by media\_type<br />\| where !isEmpty(media\_type)<br />\| top 10 media\_type by \_count, media\_type asc|
|Cisco Meraki|Top 10 Requested URLs|Logs|Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by url <br />\| top 10 url by Requests, url asc|
|Cisco Meraki|Top 10 Requested URLs|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Content and Client Platform|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by url <br />\| top 10 url by Requests, url asc|
|Cisco Meraki|Top 10 Requested URLs|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by url <br />\| top 10 url by Requests, url asc|
|Cisco Meraki|Top 10 Requested URLs|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count as Requests by url <br />\| top 10 url by Requests, url asc|
|Cisco Meraki|Top 10 Source IP|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by src\_ip \| src\_ip as %"Source IP"<br />\| top 10 %"Source IP" by eventCount, %"Source IP" asc|
|Cisco Meraki|Top 10 Source IP|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by src\_ip \| src\_ip as %"Source IP"<br />\| top 10 %"Source IP" by eventCount, %"Source IP" asc|
|Cisco Meraki|Top 10 Source IP|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by src\_ip \| src\_ip as %"Source IP"<br />\| top 10 %"Source IP" by eventCount, %"Source IP" asc|
|Cisco Meraki|Top 10 Source IP|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow"<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by src\_ip \| src\_ip as %"Source IP"<br />\| top 10 %"Source IP" by eventCount, %"Source IP" asc|
|Cisco Meraki|Top 10 TCP Destination Ports|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) (6 or tcp)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and (protocol="6" or protocol="tcp")<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_port <br />\| top 10 dest\_port by eventCount, dest\_port asc|
|Cisco Meraki|Top 10 TCP Destination Ports|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) (6 or tcp)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and (protocol="6" or protocol="tcp")<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_port <br />\| top 10 dest\_port by eventCount, dest\_port asc|
|Cisco Meraki|Top 10 TCP Destination Ports|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) (6 or tcp)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and (protocol="6" or protocol="tcp")<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_port <br />\| top 10 dest\_port by eventCount, dest\_port asc|
|Cisco Meraki|Top 10 TCP Destination Ports|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) (6 or tcp)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and (protocol="6" or protocol="tcp")<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_port <br />\| top 10 dest\_port by eventCount, dest\_port asc|
|Cisco Meraki|Top 10 UDP Destination Ports|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) (17 or udp)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and (protocol="17" or protocol="udp")<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_port <br />\| top 10 dest\_port by eventCount, dest\_port asc|
|Cisco Meraki|Top 10 UDP Destination Ports|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (deny or "Group Policy Deny" or 1) (17 or udp)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "deny" and (protocol="17" or protocol="udp")<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_port <br />\| top 10 dest\_port by eventCount, dest\_port asc|
|Cisco Meraki|Top 10 UDP Destination Ports|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) (17 or udp)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and (protocol="17" or protocol="udp")<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_port <br />\| top 10 dest\_port by eventCount, dest\_port asc|
|Cisco Meraki|Top 10 UDP Destination Ports|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall (allow or "Group Policy Allow" or 0) (17 or udp)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where msg\_type="firewall" and action = "allow" and (protocol="17" or protocol="udp")<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by dest\_port <br />\| top 10 dest\_port by eventCount, dest\_port asc|
|Cisco Meraki|Traffic Action - Time Compare|Logs|Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by action<br />\| compare with timeshift 1d<br />\| sort by eventCount, eventCount\_1d|
|Cisco Meraki|Traffic Action - Time Compare|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Flows Overview|\_sourceCategory={{Metricsdatasource}}  firewall<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|firewall\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac", "protocol", "sport", "dport", "type" as src\_ip, dest\_ip, mac\_address, protocol, src\_port, dest\_port, type  nodrop<br />\| parse "pattern: \*" as pattern nodrop<br />\|	parse regex " firewall\\s(?\<action\>allow\|deny?)(?:\\s+\|\$)" nodrop<br />\| where msg\_type="firewall"<br />\| if (action="" and (pattern="Group Policy Allow" or pattern matches "0 \*" or pattern matches "allow \*"), "allow", if (action="" and (pattern="Group Policy Deny" or pattern matches "1 \*" or pattern matches "deny \*" ), "deny", action)) as action<br />\| where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{pattern}}" = "\*", true, pattern matches "{{pattern}}")<br />\| count as eventCount by action<br />\| compare with timeshift 1d<br />\| sort by eventCount, eventCount\_1d|
|Cisco Meraki|Unique Destination IPs Outlier|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count\_distinct(dest\_ip) as Unique\_dest\_ips by \_timeslice<br />\| outlier Unique\_dest\_ips window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Unique Destination IPs Outlier|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count\_distinct(dest\_ip) as Unique\_dest\_ips by \_timeslice<br />\| outlier Unique\_dest\_ips window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Unique MAC Address Outlier|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count\_distinct(mac\_address) as Unique\_mac\_addresses by \_timeslice<br />\| outlier Unique\_mac\_addresses window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Unique MAC Address Outlier|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count\_distinct(mac\_address) as Unique\_mac\_addresses by \_timeslice<br />\| outlier Unique\_mac\_addresses window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Unique Source IPs Outlier|Logs|Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count\_distinct(src\_ip) as Unique\_src\_ips by \_timeslice<br />\| outlier Unique\_src\_ips window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Unique Source IPs Outlier|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Overview|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| timeslice 1m<br />\| where if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_port}}" = "\*", true, dest\_port matches "{{dest\_port}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{method}}" = "\*", true, method matches "{{method}}") AND if ("{{mac\_address}}" = "\*", true, mac\_address matches "{{mac\_address}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count\_distinct(src\_ip) as Unique\_src\_ips by \_timeslice<br />\| outlier Unique\_src\_ips window=10, threshold=3, consecutive=2, direction=+-|
|Cisco Meraki|Uplink Connectivity Events|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events ("Cellular connection down" or "failover to " or "failover to cellular" or "Cellular connection up")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events failover to \*" as target nodrop<br />\| parse "Cellular connection \*" as connection\_status nodrop<br />\| where msg\_type="events" and (\_raw matches "\* Cellular connection down\*" or \_raw matches "\* failover to \*" or \_raw matches "\* failover to cellular\*" or \_raw matches "\* Cellular connection up\*")<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{connection\_status}}" = "\*", true, connection\_status matches "{{connection\_status}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount|
|Cisco Meraki|Uplink Connectivity Events|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki events ("Cellular connection down" or "failover to " or "failover to cellular" or "Cellular connection up")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events failover to \*" as target nodrop<br />\| parse "Cellular connection \*" as connection\_status nodrop<br />\| where msg\_type="events" and (\_raw matches "\* Cellular connection down\*" or \_raw matches "\* failover to \*" or \_raw matches "\* failover to cellular\*" or \_raw matches "\* Cellular connection up\*")<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount|
|Cisco Meraki|Uplink Connectivity Events|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events ("Cellular connection down" or "failover to " or "failover to cellular" or "Cellular connection up")<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| parse "events failover to \*" as target nodrop<br />\| parse "Cellular connection \*" as connection\_status nodrop<br />\| where msg\_type="events" and (\_raw matches "\* Cellular connection down\*" or \_raw matches "\* failover to \*" or \_raw matches "\* failover to cellular\*" or \_raw matches "\* Cellular connection up\*")<br />\| where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}") AND if ("{{connection\_status}}" = "\*", true, connection\_status matches "{{connection\_status}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount|
|Cisco Meraki|URL Threat Details|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| fields url, actor, malicious\_confidence, label\_name|
|Cisco Meraki|URL Threat Details|Logs|Cisco Meraki/Cisco Meraki - URLs Threat Intel|\_sourceCategory={{Metricsdatasource}}  urls<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "src", "dst", "mac" as src, dst, mac\_address nodrop<br />\| kv "agent" as user\_agent nodrop<br />\| parse "request: \* \*" as method, url nodrop<br />\| parse field=src "\*:\*" as src\_ip, src\_port nodrop \| parse field=dst "\*:\*" as dest\_ip, dest\_port nodrop<br />\| where msg\_type="urls"<br />\| where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{url}}" = "\*", true, url matches "{{url}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}")<br />\| count by url<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=url <br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="url" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as actor<br />\| fields url, actor, malicious\_confidence, label\_name|
|Cisco Meraki|VPN Events|Logs|Installed Apps/Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events type (vpn\_connectivity\_change or vpn\_registry\_change)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "vpn\_type", "connectivity", "peer\_contact", "peer\_ident" as vpn\_type, connectivity, peer\_contact, peer\_iden nodrop<br />\| where msg\_type="events" and type in ("vpn\_connectivity\_change", "vpn\_registry\_change")<br />\|where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}")  AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount|
|Cisco Meraki|VPN Events|Logs|Cisco Meraki/Cisco Meraki - Events - New|\_sourceCategory = Labs/CiscoMeraki events type (vpn\_connectivity\_change or vpn\_registry\_change)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "vpn\_type", "connectivity", "peer\_contact", "peer\_ident" as vpn\_type, connectivity, peer\_contact, peer\_iden nodrop<br />\| where msg\_type="events" and type in ("vpn\_connectivity\_change", "vpn\_registry\_change")<br />\|where if ("{{\_sourcecategory}}" = "\*", true, \_sourcecategory matches "{{\_sourcecategory}}")<br />\|count as eventCount|
|Cisco Meraki|VPN Events|Logs|Cisco Meraki/Cisco Meraki - Events|\_sourceCategory={{Metricsdatasource}}  events type (vpn\_connectivity\_change or vpn\_registry\_change)<br />\|	parse regex " (?\<name\>\\S\*?)\\s(?\<msg\_type\>urls\|flows\|events\|ids-alerts\|security\_event\|airmarshal\_events?)\\s+" nodrop<br />\| kv regex "=(.\*?)(?:\\s\|\$)" "type" nodrop<br />\| kv regex "=\\'(.\*?)(?:\\')" "vpn\_type", "connectivity", "peer\_contact", "peer\_ident" as vpn\_type, connectivity, peer\_contact, peer\_iden nodrop<br />\| where msg\_type="events" and type in ("vpn\_connectivity\_change", "vpn\_registry\_change")<br />\|where if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{msg\_type}}" = "\*", true, msg\_type matches "{{msg\_type}}")  AND if ("{{vpn\_type}}" = "\*", true, vpn\_type matches "{{vpn\_type}}") AND if ("{{connectivity}}" = "\*", true, connectivity matches "{{connectivity}}") AND if ("{{name}}" = "\*", true, name matches "{{name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}")<br />\| count as eventCount|

