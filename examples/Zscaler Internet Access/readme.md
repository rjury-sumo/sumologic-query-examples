# Zscaler Internet Access
## Sumo Logic App For: Zscaler Internet Access
The Sumo Logic App for Zscaler Internet Access collects logs from ZIA via Cloud Nanolog Streaming Service (NSS) to populate pre-configured searches and Dashboards in order to visualize and provide insight into threats, DNS, web traffic behaviors, security, user browsing activities, and risk.
Docs Link: [Zscaler Internet Access](https://help.sumologic.com/?cid=210621)

## Searches

### Log Searches

- **Advanced Security Risk Categories**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Advanced Security Risk Categories**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Advanced Security Risks by Category and Location**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Advanced Security Risks by Category and Location**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Advanced Security Risks by Category and Users**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Advanced Security Risks by Category and Users**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Allowed Requests**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - DNS 
- **Allowed Requests**: from Dashboard: Zscaler Internet Access/ZIA - DNS 
- **Allowed Response**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - DNS 
- **Allowed Response**: from Dashboard: Zscaler Internet Access/ZIA - DNS 
- **Authenticated Users Blocked**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Authenticated Users Blocked**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Authenticated Users Blocked Over Time**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Authenticated Users Blocked Over Time**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Blocked Events Outliers**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic 
- **Blocked Events Outliers**: from Dashboard: Zscaler Internet Access/ZIA - Blocked Traffic 
- **Blocked Traffic**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Blocked Traffic**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Denied Events**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Denied Events**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Denied Requests**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - DNS 
- **Denied Requests**: from Dashboard: Zscaler Internet Access/ZIA - DNS 
- **Denied Response**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - DNS 
- **Denied Response**: from Dashboard: Zscaler Internet Access/ZIA - DNS 
- **Denied to Allowed Ratio**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Denied to Allowed Ratio**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Denied to Allowed Ratio - Outlier**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Denied to Allowed Ratio - Outlier**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Destination vs Source Volume by Category**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **Destination vs Source Volume by Category**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **DNS Logs**: from Dashboard: Zscaler Internet Access/ZIA - Logs 
- **DNS Logs**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Logs 
- **File Based Threats Outlier**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity 
- **File Based Threats Outlier**: from Dashboard: Zscaler Internet Access/ZIA - File Classification Activity 
- **File Classification Threats**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **File Classification Threats**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **File Threats by Risk Score**: from Dashboard: Zscaler Internet Access/ZIA - File Classification Activity 
- **File Threats by Risk Score**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity 
- **File Threats By User**: from Dashboard: Zscaler Internet Access/ZIA - File Classification Activity 
- **File Threats By User**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity 
- **Firewall Logs**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Logs 
- **Firewall Logs**: from Dashboard: Zscaler Internet Access/ZIA - Logs 
- **General Activity by Super Category and Sub Category**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **General Activity by Super Category and Sub Category**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **General Browsing by Location**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **General Browsing by Location**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **Location of Allowed Activities**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Location of Allowed Activities**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Location of Denied Activites**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Location of Denied Activites**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Locations Blocked**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Locations Blocked**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Locations Blocked Over Time**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Locations Blocked Over Time**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Logs by Category**: from Dashboard: Zscaler Internet Access/ZIA - DNS 
- **Logs by Category**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - DNS 
- **Logs by Source**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Logs by Source**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Logs 
- **Logs by Source**: from Dashboard: Zscaler Internet Access/ZIA - Logs 
- **Logs by Source**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **MB In by Top 5 Countries**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **MB In by Top 5 Countries**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **MB Out by Top 5 Countries**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **MB Out by Top 5 Countries**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **Non-General Activity by App Class**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **Non-General Activity by App Class**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **Non-General Activity by App Name**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **Non-General Activity by App Name**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **Non-General Activity Top Named Users**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **Non-General Activity Top Named Users**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **Outliers by Blocked Users**: from Dashboard: Zscaler Internet Access/ZIA - Blocked Traffic 
- **Outliers by Blocked Users**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic 
- **Protocol Transports Over Time**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Protocol Transports Over Time**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Server Locations**: from Dashboard: Zscaler Internet Access/ZIA - DNS 
- **Server Locations**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - DNS 
- **Threat Categories**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Threat Categories**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Threats by App**: from Dashboard: Zscaler Internet Access/ZIA - File Classification Activity 
- **Threats by App**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity 
- **Threats by File Class**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity 
- **Threats by File Class**: from Dashboard: Zscaler Internet Access/ZIA - File Classification Activity 
- **Threats by File Types**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity 
- **Threats by File Types**: from Dashboard: Zscaler Internet Access/ZIA - File Classification Activity 
- **Threats by Location and Category**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Threats by Location and Category**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Threats by User and Category**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Threats by User and Category**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Threats Submitted to Sandbox**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Threats Submitted to Sandbox**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Top 10 Blocked Base URLs**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Blocked Base URLs**: from Dashboard: Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Blocked Locations**: from Dashboard: Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Blocked Locations**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Blocked URL Categories**: from Dashboard: Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Blocked URL Categories**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Blocked Users**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Blocked Users**: from Dashboard: Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Reasons**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Reasons**: from Dashboard: Zscaler Internet Access/ZIA - Blocked Traffic 
- **Top 10 Requested URLs**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - DNS 
- **Top 10 Requested URLs**: from Dashboard: Zscaler Internet Access/ZIA - DNS 
- **Top 10 Slowest URLs**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - DNS 
- **Top 10 Slowest URLs**: from Dashboard: Zscaler Internet Access/ZIA - DNS 
- **Top General Browsing by Named Users**: from Dashboard: Zscaler Internet Access/ZIA - Behavior 
- **Top General Browsing by Named Users**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Behavior 
- **Transactions**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Transactions**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Transactions Allowed**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Transactions Allowed**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Transactions Blocked**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Transactions Blocked**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Transactions Over Time**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Threats 
- **Transactions Over Time**: from Dashboard: Zscaler Internet Access/ZIA - Threats 
- **Tunnel Events**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Tunnel Events**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Tunnel Logs**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Logs 
- **Tunnel Logs**: from Dashboard: Zscaler Internet Access/ZIA - Logs 
- **Users Over Time**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Overview 
- **Users Over Time**: from Dashboard: Zscaler Internet Access/ZIA - Overview 
- **Web Logs**: from Dashboard: Installed Apps/Zscaler Internet Access/ZIA - Logs 
- **Web Logs**: from Dashboard: Zscaler Internet Access/ZIA - Logs

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Zscaler Internet Access|Advanced Security Risk Categories|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory<br />\| where urlclass = "Advanced Security Risk" and src\_user matches "{{user}}"<br />\| count by category|
|Zscaler Internet Access|Advanced Security Risk Categories|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory<br />\| where urlclass = "Advanced Security Risk" and src\_user matches "{{user}}"<br />\| count by category|
|Zscaler Internet Access|Advanced Security Risks by Category and Location|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where urlclass = "Advanced Security Risk" and src\_user matches "{{user}}"<br />\| count by location,category|
|Zscaler Internet Access|Advanced Security Risks by Category and Location|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where urlclass = "Advanced Security Risk" and src\_user matches "{{user}}"<br />\| count by location,category|
|Zscaler Internet Access|Advanced Security Risks by Category and Users|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where urlclass = "Advanced Security Risk" and src\_user matches "{{user}}"<br />\| count by src\_user,category|
|Zscaler Internet Access|Advanced Security Risks by Category and Users|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where urlclass = "Advanced Security Risk" and src\_user matches "{{user}}"<br />\| count by src\_user,category|
|Zscaler Internet Access|Allowed Requests|Logs|Installed Apps/Zscaler Internet Access/ZIA - DNS|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and reqaction = "Allow" and user matches "{{user}}"<br />\| count by reqaction|
|Zscaler Internet Access|Allowed Requests|Logs|Zscaler Internet Access/ZIA - DNS|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and reqaction = "Allow" and user matches "{{user}}"<br />\| count by reqaction|
|Zscaler Internet Access|Allowed Response|Logs|Installed Apps/Zscaler Internet Access/ZIA - DNS|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and resaction = "Allow" and user matches "{{user}}"<br />\| count by resaction|
|Zscaler Internet Access|Allowed Response|Logs|Zscaler Internet Access/ZIA - DNS|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and resaction = "Allow" and user matches "{{user}}"<br />\| count by resaction|
|Zscaler Internet Access|Authenticated Users Blocked|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user != location and src\_user matches "{{user}}"<br />\| count\_distinct(src\_user)|
|Zscaler Internet Access|Authenticated Users Blocked|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user != location and src\_user matches "{{user}}"<br />\| count\_distinct(src\_user)|
|Zscaler Internet Access|Authenticated Users Blocked Over Time|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user != location and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, src\_user<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Authenticated Users Blocked Over Time|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user != location and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, src\_user<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Blocked Events Outliers|Logs|Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.action" as src\_ip, src\_user, category, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice<br />\| outlier \_count threshold=5, direction=+|
|Zscaler Internet Access|Blocked Events Outliers|Logs|Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.action" as src\_ip, src\_user, category, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice<br />\| outlier \_count threshold=5, direction=+|
|Zscaler Internet Access|Blocked Traffic|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.urlcategory", "event.action", "event.user" as category, action, user<br />\| where action != "Allowed" and user matches "{{user}}"<br />\| count|
|Zscaler Internet Access|Blocked Traffic|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.urlcategory", "event.action", "event.user" as category, action, user<br />\| where action != "Allowed" and user matches "{{user}}"<br />\| count|
|Zscaler Internet Access|Denied Events|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice,action<br />\| transpose row \_timeslice column action<br /><br />|
|Zscaler Internet Access|Denied Events|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice,action<br />\| transpose row \_timeslice column action<br /><br />|
|Zscaler Internet Access|Denied Requests|Logs|Installed Apps/Zscaler Internet Access/ZIA - DNS|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and reqaction != "Allow" and user matches "{{user}}"<br />\| count by reqaction|
|Zscaler Internet Access|Denied Requests|Logs|Zscaler Internet Access/ZIA - DNS|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and reqaction != "Allow" and user matches "{{user}}"<br />\| count by reqaction|
|Zscaler Internet Access|Denied Response|Logs|Installed Apps/Zscaler Internet Access/ZIA - DNS|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and resaction != "Allow" and user matches "{{user}}"<br />\| count by resaction|
|Zscaler Internet Access|Denied Response|Logs|Zscaler Internet Access/ZIA - DNS|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and resaction != "Allow" and user matches "{{user}}"<br />\| count by resaction|
|Zscaler Internet Access|Denied to Allowed Ratio|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where  src\_user matches "{{user}}"<br />\| if(action="Allowed",1,0) as allowed \| if(allowed=1,0,1) as denied<br />\| timeslice 5m<br />\| count,sum(allowed) as allowed, sum(denied) as denied by \_timeslice<br />\| (denied/allowed)\*100 as ratio <br />\| fields \_timeslice,ratio<br /><br />|
|Zscaler Internet Access|Denied to Allowed Ratio|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where  src\_user matches "{{user}}"<br />\| if(action="Allowed",1,0) as allowed \| if(allowed=1,0,1) as denied<br />\| timeslice 5m<br />\| count,sum(allowed) as allowed, sum(denied) as denied by \_timeslice<br />\| (denied/allowed)\*100 as ratio <br />\| fields \_timeslice,ratio<br /><br />|
|Zscaler Internet Access|Denied to Allowed Ratio - Outlier|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where  src\_user matches "{{user}}"<br />\| if(action="Allowed",1,0) as allowed \| if(allowed=1,0,1) as denied<br />\| timeslice 5m<br />\| count,sum(allowed) as allowed, sum(denied) as denied by \_timeslice<br />\| (denied/allowed)\*100 as ratio <br />\| fields \_timeslice,ratio<br />\| outlier ratio<br /><br />|
|Zscaler Internet Access|Denied to Allowed Ratio - Outlier|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where  src\_user matches "{{user}}"<br />\| if(action="Allowed",1,0) as allowed \| if(allowed=1,0,1) as denied<br />\| timeslice 5m<br />\| count,sum(allowed) as allowed, sum(denied) as denied by \_timeslice<br />\| (denied/allowed)\*100 as ratio <br />\| fields \_timeslice,ratio<br />\| outlier ratio<br /><br />|
|Zscaler Internet Access|Destination vs Source Volume by Category|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* "Allowed" <br />\| json field=\_raw "event.user" ,"event.requestsize", "event.responsesize", "event.urlcategory", "event.action" as src\_user, src\_bytes, dest\_bytes, category, action<br />\| where action = "Allowed" and src\_user matches "{{user}}"<br />\| src\_bytes/1024/1024 as src\_bytes <br />\| dest\_bytes/1024/1024 as dest\_bytes <br />\| timeslice 5m<br />\| sum(src\_bytes) as src\_mb, sum(dest\_bytes) as dest\_mb by \_timeslice, category<br />\| transpose row \_timeslice column category<br />|
|Zscaler Internet Access|Destination vs Source Volume by Category|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  "Allowed" <br />\| json field=\_raw "event.user" ,"event.requestsize", "event.responsesize", "event.urlcategory", "event.action" as src\_user, src\_bytes, dest\_bytes, category, action<br />\| where action = "Allowed" and src\_user matches "{{user}}"<br />\| src\_bytes/1024/1024 as src\_bytes <br />\| dest\_bytes/1024/1024 as dest\_bytes <br />\| timeslice 5m<br />\| sum(src\_bytes) as src\_mb, sum(dest\_bytes) as dest\_mb by \_timeslice, category<br />\| transpose row \_timeslice column category<br />|
|Zscaler Internet Access|DNS Logs|Logs|Zscaler Internet Access/ZIA - Logs|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "sourcetype", "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as sourcetype, user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category nodrop<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| count by user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| fields user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| limit 1000|
|Zscaler Internet Access|DNS Logs|Logs|Installed Apps/Zscaler Internet Access/ZIA - Logs|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "sourcetype", "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as sourcetype, user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category nodrop<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| count by user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| fields user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| limit 1000|
|Zscaler Internet Access|File Based Threats Outlier|Logs|Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory={{Logsdatasource}}   filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.threatname", "event.filetype" as src\_ip, src\_user, threat, filetype<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice<br />\| fillmissing timeslice(5m)<br />\| outlier \_count<br /><br />|
|Zscaler Internet Access|File Based Threats Outlier|Logs|Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory = Labs/ZIA\*  filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.threatname", "event.filetype" as src\_ip, src\_user, threat, filetype<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice<br />\| fillmissing timeslice(5m)<br />\| outlier \_count<br /><br />|
|Zscaler Internet Access|File Classification Threats|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*  filetype<br />\| json field=\_raw "event.filetype", "event.threatname", "event.user" as filetype, threatname, user<br />\| where threatname != "None" and filetype != "None" and user matches "{{user}}"<br />\| count|
|Zscaler Internet Access|File Classification Threats|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}}   filetype<br />\| json field=\_raw "event.filetype", "event.threatname", "event.user" as filetype, threatname, user<br />\| where threatname != "None" and filetype != "None" and user matches "{{user}}"<br />\| count|
|Zscaler Internet Access|File Threats by Risk Score|Logs|Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory = Labs/ZIA\*  filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname", "event.pagerisk" as src\_ip, src\_user, filetype, threat, pagerisk<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, pagerisk<br />\| transpose row \_timeslice column pagerisk<br />|
|Zscaler Internet Access|File Threats by Risk Score|Logs|Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory={{Logsdatasource}}   filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname", "event.pagerisk" as src\_ip, src\_user, filetype, threat, pagerisk<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, pagerisk<br />\| transpose row \_timeslice column pagerisk<br />|
|Zscaler Internet Access|File Threats By User|Logs|Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory = Labs/ZIA\*  filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname" as src\_ip, src\_user, filetype, threatname<br />\| where threatname != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by src\_user, \_timeslice<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|File Threats By User|Logs|Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory={{Logsdatasource}}   filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname" as src\_ip, src\_user, filetype, threatname<br />\| where threatname != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by src\_user, \_timeslice<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Firewall Logs|Logs|Installed Apps/Zscaler Internet Access/ZIA - Logs|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "sourcetype", "event.user", "event.locationname", "event.action", "event.tuntype", "event.protocol", "event.destcountry", "event.rulelable", "event.threatcat", "event.threatname" as sourcetype, user, location, action, tuntype, protocol, destcountry, rulelable, threat\_category, threat\_name nodrop<br />\| where sourcetype = "zscalernss-fw" and user matches "{{user}}"<br />\| count by sourcetype, user, location, action, tuntype, protocol, destcountry, rulelable, threat\_category, threat\_name<br />\| fields sourcetype, user, location, action, tuntype, protocol, destcountry, rulelable, threat\_category, threat\_name<br />\| limit 1000|
|Zscaler Internet Access|Firewall Logs|Logs|Zscaler Internet Access/ZIA - Logs|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "sourcetype", "event.user", "event.locationname", "event.action", "event.tuntype", "event.protocol", "event.destcountry", "event.rulelable", "event.threatcat", "event.threatname" as sourcetype, user, location, action, tuntype, protocol, destcountry, rulelable, threat\_category, threat\_name nodrop<br />\| where sourcetype = "zscalernss-fw" and user matches "{{user}}"<br />\| count by sourcetype, user, location, action, tuntype, protocol, destcountry, rulelable, threat\_category, threat\_name<br />\| fields sourcetype, user, location, action, tuntype, protocol, destcountry, rulelable, threat\_category, threat\_name<br />\| limit 1000|
|Zscaler Internet Access|General Activity by Super Category and Sub Category|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* "general browsing" "Allowed"<br />\| json field=\_raw "event.clientpublicIP", "event.user" as src\_ip, src\_user<br />\| json field=\_raw "event.urlcategory", "event.urlsupercategory" as category, supercategory<br />\| where  src\_user matches "{{user}}"<br />\| count by category, supercategory<br />\| transpose row supercategory column category<br />|
|Zscaler Internet Access|General Activity by Super Category and Sub Category|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  "general browsing" "Allowed"<br />\| json field=\_raw "event.clientpublicIP", "event.user" as src\_ip, src\_user<br />\| json field=\_raw "event.urlcategory", "event.urlsupercategory" as category, supercategory<br />\| where  src\_user matches "{{user}}"<br />\| count by category, supercategory<br />\| transpose row supercategory column category<br />|
|Zscaler Internet Access|General Browsing by Location|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  "general browsing" "Allowed"<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.location" as src\_ip, src\_user, location<br />\| where  src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, location<br />\| transpose row \_timeslice column location|
|Zscaler Internet Access|General Browsing by Location|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* "general browsing" "Allowed"<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.location" as src\_ip, src\_user, location<br />\| where  src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, location<br />\| transpose row \_timeslice column location|
|Zscaler Internet Access|Location of Allowed Activities|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where action = "Allowed" and src\_user matches "{{user}}"<br />\| count by src\_ip<br />\| lookup latitude, longitude  from geo://location on ip=src\_ip<br /><br /><br />|
|Zscaler Internet Access|Location of Allowed Activities|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where action = "Allowed" and src\_user matches "{{user}}"<br />\| count by src\_ip<br />\| lookup latitude, longitude  from geo://location on ip=src\_ip<br /><br /><br />|
|Zscaler Internet Access|Location of Denied Activites|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by src\_ip<br />\| lookup latitude, longitude  from geo://location on ip=src\_ip<br /><br /><br /><br /><br />|
|Zscaler Internet Access|Location of Denied Activites|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by src\_ip<br />\| lookup latitude, longitude  from geo://location on ip=src\_ip<br /><br /><br /><br /><br />|
|Zscaler Internet Access|Locations Blocked|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, location<br />\| transpose row \_timeslice column location|
|Zscaler Internet Access|Locations Blocked|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, location<br />\| transpose row \_timeslice column location|
|Zscaler Internet Access|Locations Blocked Over Time|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, location<br />\| transpose row \_timeslice column location|
|Zscaler Internet Access|Locations Blocked Over Time|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, location<br />\| transpose row \_timeslice column location|
|Zscaler Internet Access|Logs by Category|Logs|Zscaler Internet Access/ZIA - DNS|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| count by category<br />|
|Zscaler Internet Access|Logs by Category|Logs|Installed Apps/Zscaler Internet Access/ZIA - DNS|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| count by category<br />|
|Zscaler Internet Access|Logs by Source|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "sourcetype", "event.user" as sourcetype, user<br />\| where  user matches "{{user}}"<br />\| count by sourcetype|
|Zscaler Internet Access|Logs by Source|Logs|Installed Apps/Zscaler Internet Access/ZIA - Logs|\_sourceCategory={{Logsdatasource}} <br />\| json "sourcetype", "event.user" as sourcetype, user<br />\| where user matches "{{user}}"<br />\| count by sourcetype|
|Zscaler Internet Access|Logs by Source|Logs|Zscaler Internet Access/ZIA - Logs|\_sourceCategory = Labs/ZIA\*<br />\| json "sourcetype", "event.user" as sourcetype, user<br />\| where user matches "{{user}}"<br />\| count by sourcetype|
|Zscaler Internet Access|Logs by Source|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json "sourcetype", "event.user" as sourcetype, user<br />\| where  user matches "{{user}}"<br />\| count by sourcetype|
|Zscaler Internet Access|MB In by Top 5 Countries|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  "Allowed" <br />\| json field=\_raw "event.user", "event.requestsize", "event.serverip", "event.threatname", "event.action" as src\_user,src\_bytes, dest\_ip, threatname, action<br />\| where action = "Allowed" and threatname = "None" and src\_user matches "{{user}}"<br />\| lookup latitude, longitude, country\_name from geo://location on dest\_ip=ip<br />\| sum(src\_bytes) as mb by country\_name <br />\| mb/1024/1024 as mb<br />\| total mb as total\_mb<br />\| (mb/total\_mb)\*100 as percent<br />\| format("%.2f",percent) as percent<br />\| fields -total\_mb<br />\| sort mb<br />\| Limit 5<br />\| format("%.1f",mb) as mb|
|Zscaler Internet Access|MB In by Top 5 Countries|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* "Allowed" <br />\| json field=\_raw "event.user", "event.requestsize", "event.serverip", "event.threatname", "event.action" as src\_user,src\_bytes, dest\_ip, threatname, action<br />\| where action = "Allowed" and threatname = "None" and src\_user matches "{{user}}"<br />\| lookup latitude, longitude, country\_name from geo://location on dest\_ip=ip<br />\| sum(src\_bytes) as mb by country\_name <br />\| mb/1024/1024 as mb<br />\| total mb as total\_mb<br />\| (mb/total\_mb)\*100 as percent<br />\| format("%.2f",percent) as percent<br />\| fields -total\_mb<br />\| sort mb<br />\| Limit 5<br />\| format("%.1f",mb) as mb|
|Zscaler Internet Access|MB Out by Top 5 Countries|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  "Allowed" <br />\| json field=\_raw "event.user", "event.responsesize", "event.serverip", "event.threatname", "event.action" as src\_user,dest\_bytes, dest\_ip, threatname, action<br />\| where action = "Allowed" and threatname = "None" and src\_user matches "{{user}}"<br />\| lookup latitude, longitude, country\_name from geo://location on dest\_ip=ip<br />\| sum(dest\_bytes) as mb by country\_name <br />\| mb/1024/1024 as mb<br />\| total mb as total\_mb<br />\| (mb/total\_mb)\*100 as percent<br />\| format("%.2f",percent) as percent<br />\| fields -total\_mb<br />\| sort mb<br />\| Limit 5<br />\| format("%.1f",mb) as mb|
|Zscaler Internet Access|MB Out by Top 5 Countries|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* "Allowed" <br />\| json field=\_raw "event.user", "event.responsesize", "event.serverip", "event.threatname", "event.action" as src\_user,dest\_bytes, dest\_ip, threatname, action<br />\| where action = "Allowed" and threatname = "None" and src\_user matches "{{user}}"<br />\| lookup latitude, longitude, country\_name from geo://location on dest\_ip=ip<br />\| sum(dest\_bytes) as mb by country\_name <br />\| mb/1024/1024 as mb<br />\| total mb as total\_mb<br />\| (mb/total\_mb)\*100 as percent<br />\| format("%.2f",percent) as percent<br />\| fields -total\_mb<br />\| sort mb<br />\| Limit 5<br />\| format("%.1f",mb) as mb|
|Zscaler Internet Access|Non-General Activity by App Class|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* !"general browsing" //ensure no nones and nulls<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.appclass" as src\_ip, src\_user, appclass<br />\| where  src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, appclass<br />\| transpose row \_timeslice column appclass|
|Zscaler Internet Access|Non-General Activity by App Class|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  !"general browsing" //ensure no nones and nulls<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.appclass" as src\_ip, src\_user, appclass<br />\| where  src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, appclass<br />\| transpose row \_timeslice column appclass|
|Zscaler Internet Access|Non-General Activity by App Name|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* !"general browsing" //ensure no nones and nulls<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.appname" as src\_ip, src\_user, application<br />\| where  src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, application<br />\| transpose row \_timeslice column application<br />|
|Zscaler Internet Access|Non-General Activity by App Name|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  !"general browsing" //ensure no nones and nulls<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.appname" as src\_ip, src\_user, application<br />\| where  src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, application<br />\| transpose row \_timeslice column application<br />|
|Zscaler Internet Access|Non-General Activity Top Named Users|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* !"general browsing" //ensure no nones and nulls<br />\| json field=\_raw "event.clientpublicIP", "event.user" as src\_ip, src\_user<br />\| where src\_user matches "\*@\*"  and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, src\_user<br />\| sort by \_timeslice, \_count<br />\| 1 as rownum<br />\| accum rownum as index by \_timeslice<br />\| if(index=1, 1,0) as isFirst<br />\| accum isFirst as rankOrder<br />\| where index \<= 10<br />\| fields \_timeslice, src\_user, \_count<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Non-General Activity Top Named Users|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  !"general browsing" //ensure no nones and nulls<br />\| json field=\_raw "event.clientpublicIP", "event.user" as src\_ip, src\_user<br />\| where src\_user matches "\*@\*"  and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, src\_user<br />\| sort by \_timeslice, \_count<br />\| 1 as rownum<br />\| accum rownum as index by \_timeslice<br />\| if(index=1, 1,0) as isFirst<br />\| accum isFirst as rankOrder<br />\| where index \<= 10<br />\| fields \_timeslice, src\_user, \_count<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Outliers by Blocked Users|Logs|Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| timeslice 10m<br />\| count by \_timeslice, src\_user<br />\| outlier \_count by src\_user direction=+<br />\| where \_count\_violation=1<br />\| count by \_timeslice, src\_user<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Outliers by Blocked Users|Logs|Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.action" as src\_ip, src\_user, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| timeslice 10m<br />\| count by \_timeslice, src\_user<br />\| outlier \_count by src\_user direction=+<br />\| where \_count\_violation=1<br />\| count by \_timeslice, src\_user<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Protocol Transports Over Time|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.protocol", "event.user" as protocol, src\_user<br />\| where src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, protocol<br />\| transpose row \_timeslice column protocol|
|Zscaler Internet Access|Protocol Transports Over Time|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.protocol", "event.user" as protocol, src\_user<br />\| where src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, protocol<br />\| transpose row \_timeslice column protocol|
|Zscaler Internet Access|Server Locations|Logs|Zscaler Internet Access/ZIA - DNS|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| count by srv\_dip<br />\| lookup latitude, longitude  from geo://location on ip=srv\_dip<br />|
|Zscaler Internet Access|Server Locations|Logs|Installed Apps/Zscaler Internet Access/ZIA - DNS|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| count by srv\_dip<br />\| lookup latitude, longitude  from geo://location on ip=srv\_dip<br />|
|Zscaler Internet Access|Threat Categories|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory<br />\| where threatcategory!="Sandbox Benign" and threatcategory!="Submitted to Sandbox" and src\_user matches "{{user}}"<br />//\| where threatname != "None" and reason != "Allowed"<br />\| count by threatcategory|
|Zscaler Internet Access|Threat Categories|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory<br />\| where threatcategory!="Sandbox Benign" and threatcategory!="Submitted to Sandbox" and src\_user matches "{{user}}"<br />//\| where threatname != "None" and reason != "Allowed"<br />\| count by threatcategory|
|Zscaler Internet Access|Threats by App|Logs|Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory = Labs/ZIA\*  filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname", "event.appname" as src\_ip, src\_user, filetype, threat, application<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| if(isnull(application),"Unclassified",application) as application<br />\| count by application,threat<br />\| transpose row application column threat|
|Zscaler Internet Access|Threats by App|Logs|Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory={{Logsdatasource}}   filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname", "event.appname" as src\_ip, src\_user, filetype, threat, application<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| if(isnull(application),"Unclassified",application) as application<br />\| count by application,threat<br />\| transpose row application column threat|
|Zscaler Internet Access|Threats by File Class|Logs|Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory={{Logsdatasource}}   filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname", "event.fileclass" as src\_ip, src\_user, filetype, threat, fileclass<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| count by fileclass,threat<br />\| transpose row fileclass column threat|
|Zscaler Internet Access|Threats by File Class|Logs|Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory = Labs/ZIA\*  filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname", "event.fileclass" as src\_ip, src\_user, filetype, threat, fileclass<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| count by fileclass,threat<br />\| transpose row fileclass column threat|
|Zscaler Internet Access|Threats by File Types|Logs|Installed Apps/Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory={{Logsdatasource}}   filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname", "event.fileclass" as src\_ip, src\_user, filetype, threat, fileclass<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| count by fileclass, filetype<br />\| transpose row fileclass column filetype|
|Zscaler Internet Access|Threats by File Types|Logs|Zscaler Internet Access/ZIA - File Classification Activity|\_sourceCategory = Labs/ZIA\*  filetype<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.filetype", "event.threatname", "event.fileclass" as src\_ip, src\_user, filetype, threat, fileclass<br />\| where threat != "None" and filetype != "None" and src\_user matches "{{user}}"<br />\| count by fileclass, filetype<br />\| transpose row fileclass column filetype|
|Zscaler Internet Access|Threats by Location and Category|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory, location<br />\| where threatcategory!="Sandbox Benign" and threatcategory!="Submitted to Sandbox" and src\_user matches "{{user}}"<br />//\| where threatname != "None" and reason != "Allowed"<br />\| count by threatcategory, location|
|Zscaler Internet Access|Threats by Location and Category|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory, location<br />\| where threatcategory!="Sandbox Benign" and threatcategory!="Submitted to Sandbox" and src\_user matches "{{user}}"<br />//\| where threatname != "None" and reason != "Allowed"<br />\| count by threatcategory, location|
|Zscaler Internet Access|Threats by User and Category|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory, location<br />\| where threatcategory!="Sandbox Benign" and threatcategory!="Submitted to Sandbox" and src\_user matches "{{user}}"<br />//\| where threatname != "None" and reason != "Allowed"<br />\| count by threatcategory, src\_user|
|Zscaler Internet Access|Threats by User and Category|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory, location<br />\| where threatcategory!="Sandbox Benign" and threatcategory!="Submitted to Sandbox" and src\_user matches "{{user}}"<br />//\| where threatname != "None" and reason != "Allowed"<br />\| count by threatcategory, src\_user|
|Zscaler Internet Access|Threats Submitted to Sandbox|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory, location<br />\| where (threatcategory="Sandbox Benign" or threatcategory="Submitted to Sandbox") and src\_user matches "{{user}}"<br />//\| where threatname != "None" and reason != "Allowed"<br />\| count by src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory, location|
|Zscaler Internet Access|Threats Submitted to Sandbox|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.threatcategory", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory, location<br />\| where (threatcategory="Sandbox Benign" or threatcategory="Submitted to Sandbox") and src\_user matches "{{user}}"<br />//\| where threatname != "None" and reason != "Allowed"<br />\| count by src\_ip, src\_user, category, reason, urlclass, threatname, threatcategory, location|
|Zscaler Internet Access|Top 10 Blocked Base URLs|Logs|Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.url", "event.action" as src\_ip, src\_user, url, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| parse regex field=url "(?\<baseurl\>.+?)[:/]" nodrop<br />\| count by baseurl<br />\| sort \_count<br />\| top 10 baseurl by \_count|
|Zscaler Internet Access|Top 10 Blocked Base URLs|Logs|Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.url", "event.action" as src\_ip, src\_user, url, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| parse regex field=url "(?\<baseurl\>.+?)[:/]" nodrop<br />\| count by baseurl<br />\| sort \_count<br />\| top 10 baseurl by \_count|
|Zscaler Internet Access|Top 10 Blocked Locations|Logs|Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.location", "event.action" as src\_ip, src\_user, location, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by location<br />\| top 10 location by \_count|
|Zscaler Internet Access|Top 10 Blocked Locations|Logs|Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.location", "event.action" as src\_ip, src\_user, location, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by location<br />\| top 10 location by \_count|
|Zscaler Internet Access|Top 10 Blocked URL Categories|Logs|Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.location", "event.action", "event.reason", "event.urlcategory" as src\_ip, src\_user, location, action, reason, urlcategory<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by urlcategory<br />\| top 10 urlcategory by \_count|
|Zscaler Internet Access|Top 10 Blocked URL Categories|Logs|Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.location", "event.action", "event.reason", "event.urlcategory" as src\_ip, src\_user, location, action, reason, urlcategory<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by urlcategory<br />\| top 10 urlcategory by \_count|
|Zscaler Internet Access|Top 10 Blocked Users|Logs|Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.action" as src\_ip, src\_user, category, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by src\_user<br />\| top 10 src\_user by \_count |
|Zscaler Internet Access|Top 10 Blocked Users|Logs|Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.action" as src\_ip, src\_user, category, action<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by src\_user<br />\| top 10 src\_user by \_count |
|Zscaler Internet Access|Top 10 Reasons|Logs|Installed Apps/Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.location", "event.action", "event.reason" as src\_ip, src\_user, location, action, reason<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by reason<br />\| top 10 reason by \_count|
|Zscaler Internet Access|Top 10 Reasons|Logs|Zscaler Internet Access/ZIA - Blocked Traffic|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.location", "event.action", "event.reason" as src\_ip, src\_user, location, action, reason<br />\| where action != "Allowed" and src\_user matches "{{user}}"<br />\| count by reason<br />\| top 10 reason by \_count|
|Zscaler Internet Access|Top 10 Requested URLs|Logs|Installed Apps/Zscaler Internet Access/ZIA - DNS|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| count by dns\_req<br />\| top 10 dns\_req by \_count|
|Zscaler Internet Access|Top 10 Requested URLs|Logs|Zscaler Internet Access/ZIA - DNS|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| count by dns\_req<br />\| top 10 dns\_req by \_count|
|Zscaler Internet Access|Top 10 Slowest URLs|Logs|Installed Apps/Zscaler Internet Access/ZIA - DNS|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| num(durationms)<br />\| count by dns\_req, durationms, user<br />\| sort by durationms desc<br />\| top 10 dns\_req by durationms|
|Zscaler Internet Access|Top 10 Slowest URLs|Logs|Zscaler Internet Access/ZIA - DNS|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.department", "event.location", "event.reqaction", "event.resaction", "event.reqrulelabel", "event.resrulelabel", "event.dns\_req", "event.dns\_reqtype" , "event.dns\_resp", "event.durationms", "event.srv\_dip", "event.clt\_sip", "event.category"  as user, department, location, reqaction, resaction, reqrulelabel, resrulelabel, dns\_req, dns\_reqtype, dns\_resp, durationms, srv\_dip, clt\_sip, category<br />\| where sourcetype = "zscalernss-dns" and user matches "{{user}}"<br />\| num(durationms)<br />\| count by dns\_req, durationms, user<br />\| sort by durationms desc<br />\| top 10 dns\_req by durationms|
|Zscaler Internet Access|Top General Browsing by Named Users|Logs|Zscaler Internet Access/ZIA - Behavior|\_sourceCategory = Labs/ZIA\* "general browsing" //ensure no nones and nulls<br />\| json field=\_raw "event.clientpublicIP", "event.user" as src\_ip, src\_user<br />\| where src\_user matches "\*@\*" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, src\_user<br />\| sort by \_timeslice, \_count<br />\| 1 as rownum<br />\| accum rownum as index by \_timeslice<br />\| if(index=1, 1,0) as isFirst<br />\| accum isFirst as rankOrder<br />\| where index \<= 10<br />\| fields \_timeslice, src\_user, \_count<br />\| transpose row \_timeslice column src\_user<br />|
|Zscaler Internet Access|Top General Browsing by Named Users|Logs|Installed Apps/Zscaler Internet Access/ZIA - Behavior|\_sourceCategory={{Logsdatasource}}  "general browsing" //ensure no nones and nulls<br />\| json field=\_raw "event.clientpublicIP", "event.user" as src\_ip, src\_user<br />\| where src\_user matches "\*@\*" and src\_user matches "{{user}}"<br />\| timeslice 5m<br />\| count by \_timeslice, src\_user<br />\| sort by \_timeslice, \_count<br />\| 1 as rownum<br />\| accum rownum as index by \_timeslice<br />\| if(index=1, 1,0) as isFirst<br />\| accum isFirst as rankOrder<br />\| where index \<= 10<br />\| fields \_timeslice, src\_user, \_count<br />\| transpose row \_timeslice column src\_user<br />|
|Zscaler Internet Access|Transactions|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location", "event.action" as src\_ip, src\_user, category, reason, urlclass, threatname, location,action<br />\| where  src\_user matches "{{user}}"<br />//\| where threatname != "None" or urlclass="Advanced Security Risk"<br />\| count by action, src\_user, src\_ip, category, urlclass, threatname, location<br />\| \_count as count<br />\| fields action, src\_user, src\_ip, category, urlclass, threatname, location, count|
|Zscaler Internet Access|Transactions|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location", "event.action" as src\_ip, src\_user, category, reason, urlclass, threatname, location,action<br />\| where  src\_user matches "{{user}}"<br />//\| where threatname != "None" or urlclass="Advanced Security Risk"<br />\| count by action, src\_user, src\_ip, category, urlclass, threatname, location<br />\| \_count as count<br />\| fields action, src\_user, src\_ip, category, urlclass, threatname, location, count|
|Zscaler Internet Access|Transactions Allowed|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where reason = "Allowed" and src\_user matches "{{user}}"<br />\| count|
|Zscaler Internet Access|Transactions Allowed|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where reason = "Allowed" and src\_user matches "{{user}}"<br />\| count|
|Zscaler Internet Access|Transactions Blocked|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user matches "{{user}}"<br />\| count|
|Zscaler Internet Access|Transactions Blocked|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location" as src\_ip, src\_user, category, reason, urlclass, threatname, location<br />\| where threatname != "None" and reason != "Allowed" and urlclass="Advanced Security Risk" and src\_user matches "{{user}}"<br />\| count|
|Zscaler Internet Access|Transactions Over Time|Logs|Installed Apps/Zscaler Internet Access/ZIA - Threats|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location", "event.action" as src\_ip, src\_user, category, reason, urlclass, threatname, location,action<br />\| where  src\_user matches "{{user}}"<br />//\| where threatname != "None" or urlclass="Advanced Security Risk"<br />\| timeslice 1m<br />\| count by \_timeslice, action<br />\| transpose row \_timeslice column action|
|Zscaler Internet Access|Transactions Over Time|Logs|Zscaler Internet Access/ZIA - Threats|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.clientpublicIP", "event.user", "event.urlcategory", "event.reason", "event.urlclass", "event.threatname", "event.location", "event.action" as src\_ip, src\_user, category, reason, urlclass, threatname, location,action<br />\| where  src\_user matches "{{user}}"<br />//\| where threatname != "None" or urlclass="Advanced Security Risk"<br />\| timeslice 1m<br />\| count by \_timeslice, action<br />\| transpose row \_timeslice column action|
|Zscaler Internet Access|Tunnel Events|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.Recordtype", "event.tunneltype", "event.user", "event.sourceip", "event.destinationip", "event.event", "event.location" as Recordtype, tunneltype, user, sourceip, destinationip, event, location<br />\| where sourcetype = "zscalernss-tunnel" and (Recordtype="Tunnel Event" OR Recordtype="IPSec Phase2" OR Recordtype="IPSec Phase1") and user matches "{{user}}"<br />\| if (Recordtype="Tunnel Event", event, Recordtype) as event<br />\| timeslice 1m<br />\| count by \_timeslice, event, location<br />\| transpose row \_timeslice column event,location<br />|
|Zscaler Internet Access|Tunnel Events|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.Recordtype", "event.tunneltype", "event.user", "event.sourceip", "event.destinationip", "event.event", "event.location" as Recordtype, tunneltype, user, sourceip, destinationip, event, location<br />\| where sourcetype = "zscalernss-tunnel" and (Recordtype="Tunnel Event" OR Recordtype="IPSec Phase2" OR Recordtype="IPSec Phase1") and user matches "{{user}}"<br />\| if (Recordtype="Tunnel Event", event, Recordtype) as event<br />\| timeslice 1m<br />\| count by \_timeslice, event, location<br />\| transpose row \_timeslice column event,location<br />|
|Zscaler Internet Access|Tunnel Logs|Logs|Installed Apps/Zscaler Internet Access/ZIA - Logs|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "sourcetype", "event.Recordtype", "event.tunneltype", "event.user", "event.sourceip", "event.destinationip", "event.event", "event.location" as sourcetype,Recordtype, tunneltype, user, sourceip, destinationip, event, location nodrop<br />\| where sourcetype = "zscalernss-tunnel" and user matches "{{user}}"<br />\| count by Recordtype, tunneltype, user, sourceip, destinationip, event, location<br />\| fields Recordtype, tunneltype, user, sourceip, destinationip, event, location<br />\| limit 1000|
|Zscaler Internet Access|Tunnel Logs|Logs|Zscaler Internet Access/ZIA - Logs|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "sourcetype", "event.Recordtype", "event.tunneltype", "event.user", "event.sourceip", "event.destinationip", "event.event", "event.location" as sourcetype,Recordtype, tunneltype, user, sourceip, destinationip, event, location nodrop<br />\| where sourcetype = "zscalernss-tunnel" and user matches "{{user}}"<br />\| count by Recordtype, tunneltype, user, sourceip, destinationip, event, location<br />\| fields Recordtype, tunneltype, user, sourceip, destinationip, event, location<br />\| limit 1000|
|Zscaler Internet Access|Users Over Time|Logs|Installed Apps/Zscaler Internet Access/ZIA - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json field=\_raw "event.user", "event.location" as src\_user, location<br />\| where location!=src\_user and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, src\_user<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Users Over Time|Logs|Zscaler Internet Access/ZIA - Overview|\_sourceCategory = Labs/ZIA\*<br />\| json field=\_raw "event.user", "event.location" as src\_user, location<br />\| where location!=src\_user and src\_user matches "{{user}}"<br />\| timeslice 1m<br />\| count by \_timeslice, src\_user<br />\| transpose row \_timeslice column src\_user|
|Zscaler Internet Access|Web Logs|Logs|Installed Apps/Zscaler Internet Access/ZIA - Logs|\_sourceCategory={{Logsdatasource}} <br />\| json "sourcetype", "event.event\_id", "event.protocol", "event.action", "event.urlcategory", "event.serverip", "event.location", "event.ClientIP", "event.user", "event.hostname", "event.clientpublicIP", "event.threatname", "event.threatcategory", "event.appname", "event.threatclass", "event.urlclass" as sourcetype,event\_id,protocol,action,urlcategory,serverip,location,ClientIP,user,hostname,clientpublicIP,threatname,threatcategory, appname,threatclass,urlclass nodrop<br />\| where sourcetype = "zscalernss-web" and user matches "{{user}}"<br />\| count by sourcetype,event\_id,protocol,action,urlcategory,serverip,location,ClientIP,user,hostname,clientpublicIP,threatname,threatcategory, appname,threatclass,urlclass<br />\| fields sourcetype,event\_id,protocol,action,urlcategory,serverip,location,ClientIP,user,hostname,clientpublicIP,threatname,threatcategory, appname,threatclass,urlclass<br />\| limit 1000|
|Zscaler Internet Access|Web Logs|Logs|Zscaler Internet Access/ZIA - Logs|\_sourceCategory = Labs/ZIA\*<br />\| json "sourcetype", "event.event\_id", "event.protocol", "event.action", "event.urlcategory", "event.serverip", "event.location", "event.ClientIP", "event.user", "event.hostname", "event.clientpublicIP", "event.threatname", "event.threatcategory", "event.appname", "event.threatclass", "event.urlclass" as sourcetype,event\_id,protocol,action,urlcategory,serverip,location,ClientIP,user,hostname,clientpublicIP,threatname,threatcategory, appname,threatclass,urlclass nodrop<br />\| where sourcetype = "zscalernss-web" and user matches "{{user}}"<br />\| count by sourcetype,event\_id,protocol,action,urlcategory,serverip,location,ClientIP,user,hostname,clientpublicIP,threatname,threatcategory, appname,threatclass,urlclass<br />\| fields sourcetype,event\_id,protocol,action,urlcategory,serverip,location,ClientIP,user,hostname,clientpublicIP,threatname,threatcategory, appname,threatclass,urlclass<br />\| limit 1000|

