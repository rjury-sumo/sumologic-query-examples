# AWS VPC Flow Logs

## Searches

### Log Searches

- **Actions**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **Actions by Destination Address Over Time**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New 
- **Actions by InterfaceID**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New 
- **Actions by Minute - Outlier**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Actions by Minute - Outlier**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New 
- **Actions by Minute - Trend**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Actions by Minute - Trend**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New 
- **Actions by Source Address Over Time**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New 
- **Bytes by Minute - Outlier**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Bytes by Minute - Outlier**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New 
- **Bytes by Minute - Trend**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Bytes by Minute - Trend**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New 
- **Flow Durations**: from Search: AWS VPC Flow Logs/Flow Durations 
- **Flow Record Count by Destination Address**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New 
- **Flow Record Count by Source Address**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New 
- **Flow Records by InterfaceID**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **Flow Records per Protocol by Hour**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **Log Status**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **Max Flow Time**: from Search: AWS VPC Flow Logs/Max Flow Time 
- **Packets Box Plot**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Packets by Minute - Outlier**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New 
- **Packets by Minute - Outlier**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Packets by Minute - Trend**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Packets by Minute - Trend**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New 
- **Rejections per Minute**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **REJECTs by InterfaceID, Destination Address**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **REJECTs by Minute - Outlier**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **REJECTs by Minute - Trend**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **REJECTs by Source Address**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **Source Address Locations**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **Source Address Locations**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New 
- **Source Address Locations - REJECTs**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **Top 10 Actions by Protocol**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Top 10 Destination Addresses by MB**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **Top 10 Destination Ports by Flow Record**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **Top 10 Ports by Action**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New 
- **Top 10 REJECT Destination Addresses**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **Top 10 REJECT Destination Addresses, Ports**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **Top 10 REJECT Source Addresses**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **Top 10 REJECT Source Addresses, Ports**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **Top 10 REJECTs by interfaceID**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **Top 10 REJECTs by Protocol**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New 
- **Top 10 Source Addresses by MB**: from Dashboard: AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New 
- **Top 10 Source IPs by Flow Time**: from Search: AWS VPC Flow Logs/Top 10 Source IPs by Flow Time

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|AWS VPC Flow Logs|Actions|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where !(Action= "-")<br />\| count by Action|
|AWS VPC Flow Logs|Actions by Destination Address Over Time|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| count(Action) as ACTIONS by dest\_ip, \_timeslice<br />\| sort by \_timeslice <br />\| transpose row \_timeslice column dest\_ip |
|AWS VPC Flow Logs|Actions by InterfaceID|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| count by interfaceID|
|AWS VPC Flow Logs|Actions by Minute - Outlier|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| count as action by \_timeslice <br />\| outlier action |
|AWS VPC Flow Logs|Actions by Minute - Outlier|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| count as action by \_timeslice <br />\| outlier action |
|AWS VPC Flow Logs|Actions by Minute - Trend|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| count as action by \_timeslice <br />\| predict action by 1m forecast=5|
|AWS VPC Flow Logs|Actions by Minute - Trend|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| count as action by \_timeslice <br />\| predict action by 1m forecast=5|
|AWS VPC Flow Logs|Actions by Source Address Over Time|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| count(Action) as ACTIONS by src\_ip, \_timeslice<br />\| sort by \_timeslice <br />\| transpose row \_timeslice column src\_ip |
|AWS VPC Flow Logs|Bytes by Minute - Outlier|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| sum(bytes) as bytes by \_timeslice<br />\| outlier bytes<br />|
|AWS VPC Flow Logs|Bytes by Minute - Outlier|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| sum(bytes) as bytes by \_timeslice<br />\| outlier bytes|
|AWS VPC Flow Logs|Bytes by Minute - Trend|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| sum(bytes) as bytes by \_timeslice<br />\| predict bytes by 1m forecast=5|
|AWS VPC Flow Logs|Bytes by Minute - Trend|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| sum(bytes) as bytes by \_timeslice<br />\| predict bytes by 1m forecast=5|
|AWS VPC Flow Logs|Flow Durations|Logs|AWS VPC Flow Logs/Flow Durations|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| endsample - startsample as flow\_time<br />\| formatDate(fromSeconds(StartSample), "MM-dd-yyyy hh:mm") as StartSample<br />\| formatDate(fromSeconds(EndSample), "MM/dd/yy HH:mm") as EndSample<br />\| count by src\_ip, startsample, endsample, flow\_time<br />\| sort by flow\_time desc<br />//\| fields -\_count|
|AWS VPC Flow Logs|Flow Record Count by Destination Address|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| count by dest\_ip|
|AWS VPC Flow Logs|Flow Record Count by Source Address|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status <br />\| count by src\_ip|
|AWS VPC Flow Logs|Flow Records by InterfaceID|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| count as Records by interfaceID|
|AWS VPC Flow Logs|Flow Records per Protocol by Hour|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,protocol,Packets,bytes,StartSample,EndSample,Action,status <br />\| if(protocol="1","ICMP", protocol) as protocol <br />\| if(protocol="6","TCP", protocol) as protocol <br />\| if(protocol="17","UDP", protocol) as protocol<br />\| if(protocol="4","IPv4", protocol) as protocol<br />\| if(protocol="41","IPv6",protocol) as protocol<br />\| timeslice 1h<br />\| count by Protocol,\_timeslice<br />\| transpose row \_timeslice column protocol |
|AWS VPC Flow Logs|Log Status|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| count by status|
|AWS VPC Flow Logs|Max Flow Time|Logs|AWS VPC Flow Logs/Max Flow Time|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| endsample - startsample as flow\_time<br />\| formatDate(fromSeconds(StartSample), "MM-dd-yyyy hh:mm") as StartSample<br />\| formatDate(fromSeconds(EndSample), "MM/dd/yy HH:mm") as EndSample<br />\| max(flow\_time)|
|AWS VPC Flow Logs|Packets Box Plot|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| min(Packets), pct(Packets,25), pct(Packets,50), pct(Packets,75), max(Packets) by \_timeslice|
|AWS VPC Flow Logs|Packets by Minute - Outlier|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New|\_sourceCategory = Labs/AWS/VPC message<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| sum(packets) as packets by \_timeslice <br />\| outlier packets |
|AWS VPC Flow Logs|Packets by Minute - Outlier|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| sum(packets) as packets by \_timeslice <br />\| outlier packets |
|AWS VPC Flow Logs|Packets by Minute - Trend|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| count as packets by \_timeslice <br />\| predict packets by 1m forecast=5|
|AWS VPC Flow Logs|Packets by Minute - Trend|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Traffic - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| sum(packets) as packets by \_timeslice <br />\| predict packets by 1m forecast=5|
|AWS VPC Flow Logs|Rejections per Minute|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC  REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| where action="REJECT"<br />\| count by \_timeslice<br />|
|AWS VPC Flow Logs|REJECTs by InterfaceID, Destination Address|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where Action="REJECT"<br />\| count by interfaceID, dest\_ip<br />\| sort by \_count|
|AWS VPC Flow Logs|REJECTs by Minute - Outlier|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| where action="REJECT"<br />\| count as drops by \_timeslice <br />\| outlier drops window=10, threshold=3|
|AWS VPC Flow Logs|REJECTs by Minute - Trend|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| timeslice 1m<br />\| where action="REJECT"<br />\| count as drops by \_timeslice <br />\| predict drops by 1m forecast=5|
|AWS VPC Flow Logs|REJECTs by Source Address|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where Action="REJECT"<br />\| timeslice 1m<br />\| count(Action) as REJECTS by src\_ip, \_timeslice<br />\| sort by \_timeslice <br />\| transpose row \_timeslice column src\_ip |
|AWS VPC Flow Logs|Source Address Locations|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code|
|AWS VPC Flow Logs|Source Address Locations|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Interactive - Activity - New|\_sourceCategory = Labs/AWS/VPC<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code|
|AWS VPC Flow Logs|Source Address Locations - REJECTs|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where Action="REJECT"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code|
|AWS VPC Flow Logs|Top 10 Actions by Protocol|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where action!="-" and action!=""<br />\| if(protocol="1","ICMP", protocol) as protocol <br />\| if(protocol="6","TCP", protocol) as protocol <br />\| if(protocol="17","UDP", protocol) as protocol<br />\| if(protocol="4","IPv4", protocol) as protocol<br />\| if(protocol="41","IPv6",protocol) as protocol<br />\| count by Action, Protocol<br />\| top 10  Action, Protocol  by \_count<br />\| transpose row protocol column action|
|AWS VPC Flow Logs|Top 10 Destination Addresses by MB|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| sum(bytes) as bytes by dest\_ip \| bytes/(1024\*1024) as MB<br />\| top 10 dest\_ip by MB|
|AWS VPC Flow Logs|Top 10 Destination Ports by Flow Record|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| count as Records by dest\_port \| top 10 dest\_port by Records|
|AWS VPC Flow Logs|Top 10 Ports by Action|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Traffic - New|\_sourceCategory = Labs/AWS/VPC  <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where dest\_port!="-" and dest\_port!=""<br />\| count by Action, dest\_port<br />\| top 10  Action, dest\_port  by \_count<br />\| transpose row action column dest\_port|
|AWS VPC Flow Logs|Top 10 REJECT Destination Addresses|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where ACTION="REJECT"<br />\| count by dest\_ip<br />\| top 10 dest\_ip by \_count|
|AWS VPC Flow Logs|Top 10 REJECT Destination Addresses, Ports|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where ACTION="REJECT"<br />\| count by dest\_ip, dest\_port<br />\| top 10  dest\_ip, dest\_port  by \_count|
|AWS VPC Flow Logs|Top 10 REJECT Source Addresses|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where ACTION="REJECT"<br />\| count by src\_ip<br />\| top 10 src\_ip by \_count|
|AWS VPC Flow Logs|Top 10 REJECT Source Addresses, Ports|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where ACTION="REJECT"<br />\| count by src\_ip, src\_port<br />\| top 10  src\_ip, src\_port  by \_count|
|AWS VPC Flow Logs|Top 10 REJECTs by interfaceID|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where ACTION="REJECT"<br />\| count by interfaceID<br />\| top 10 interfaceID by \_count|
|AWS VPC Flow Logs|Top 10 REJECTs by Protocol|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Rejections - New|\_sourceCategory = Labs/AWS/VPC   REJECT<br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| where ACTION="REJECT"<br />\| if(protocol="1","ICMP", protocol) as protocol <br />\| if(protocol="6","TCP", protocol) as protocol <br />\| if(protocol="17","UDP", protocol) as protocol<br />\| if(protocol="4","IPv4", protocol) as protocol<br />\| if(protocol="41","IPv6",protocol) as protocol<br />\| count by Protocol<br />\| top 10  Protocol  by \_count|
|AWS VPC Flow Logs|Top 10 Source Addresses by MB|Logs|AWS VPC Flow Logs/Amazon VPC Flow Logs - Live - Overview - New|\_sourceCategory = Labs/AWS/VPC <br />\| json "message"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| sum(bytes) as bytes by src\_ip \| bytes/(1024\*1024) as MB<br />\| top 10 src\_ip by MB|
|AWS VPC Flow Logs|Top 10 Source IPs by Flow Time|Logs|AWS VPC Flow Logs/Top 10 Source IPs by Flow Time|\_sourceCategory = Labs/AWS/VPC <br />\| json "message","logStream","logGroup"<br />\| parse field=message "\* \* \* \* \* \* \* \* \* \* \* \* \* \*" as version,accountID,interfaceID,src\_ip,dest\_ip,src\_port,dest\_port,Protocol,Packets,bytes,StartSample,EndSample,Action,status<br />\| endsample - startsample as flow\_time<br />\| formatDate(fromSeconds(StartSample), "MM-dd-yyyy hh:mm") as StartSample<br />\| formatDate(fromSeconds(EndSample), "MM/dd/yy HH:mm") as EndSample<br />\| count by src\_ip, flow\_time<br />\| top 10 src\_ip by flow\_time|

