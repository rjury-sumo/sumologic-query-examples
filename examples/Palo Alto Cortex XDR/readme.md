# Palo Alto Cortex XDR
## Sumo Logic App For: Palo Alto Cortex XDR
The Palo Alto Cortex XDR App for Sumo Logic is designed to provide comprehensive visibility and analysis of alerts and incidents from Palo Alto Networks Cortex XDR platform. This app leverages the Sumo Logic Cloud-to-Cloud Palo Alto Cortex XDR source to collect and ingest data from Palo Alto Cortex XDR, enabling security teams to gain valuable insights and take proactive measures to protect their organization's infrastructure.
Docs Link: [Palo Alto Cortex XDR](https://help.sumologic.com/?cid=10200)

## Searches

### Log Searches

- **Alerts by IP**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Alerts by Severity Over Time**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Alerts from Risky Countries**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Alerts Triggered**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Disabled Incidents**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview 
- **Geo Location of Alerts**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Incidents by Severity Over Time**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview 
- **Incidents by Status**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview 
- **Incidents Created**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview 
- **Recent Alerts**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Recent Incidents**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview 
- **Top 10 Actions on Alerts**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Top 10 Alerts Triggered**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Top 10 Assigned Users**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview 
- **Top 10 Categories**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **Top 10 MITRE Tactics Used**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview 
- **Top 10 MITRE Techniques Used**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview 
- **Top 10 Sources**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview 
- **White Listed Alerts**: from Dashboard: Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Palo Alto Cortex XDR|Alerts by IP|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| extract field=host\_ip "\\"?(?\<ip\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| lookup country\_code, country\_name, region, city from geo://location on ip = ip<br />\| if (isNull(region),"-",region) as region<br />\| if (isNull(country\_name),"-",country\_name) as country\_name<br />\| if (isNull(city),"-",city) as city<br />\| if (isNull(country\_code),"-",country\_code) as country\_code<br />\| count\_distinct(alert\_id) as frequency by ip,city,region,country\_name,country\_code<br />\| sort by frequency<br />\| limit 50|
|Palo Alto Cortex XDR|Alerts by Severity Over Time|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| timeslice 1d<br />\| count\_distinct(alert\_id) as frequency by \_timeslice,severity<br />\| fillmissing timeslice, values all in severity<br />\| transpose row \_timeslice column severity|
|Palo Alto Cortex XDR|Alerts from Risky Countries|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| extract field=host\_ip "\\"?(?\<ip\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(alert\_id) as frequency by ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = ip<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isBlank(country\_code)|
|Palo Alto Cortex XDR|Alerts Triggered|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| count\_distinct(alert\_id)|
|Palo Alto Cortex XDR|Disabled Incidents|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview|\_sourceCategory={{Logsdatasource}}   "incident\_id" "incident\_name"<br />\| json "incident\_id","incident\_name","creation\_time","modification\_time","status","severity","assigned\_user\_mail","alert\_count","high\_severity\_alert\_count","critical\_severity\_alert\_count","user\_count","xdr\_url","wildfire\_hits","alerts\_grouping\_status","mitre\_tactics\_ids\_and\_names","mitre\_techniques\_ids\_and\_names" as incident\_id,incident\_name,creation\_time,modification\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names nodrop<br /><br />\| where severity matches "{{severity}}"<br />\| where status matches "{{status}}"<br /><br />\| where alerts\_grouping\_status matches("\*Disabled\*")<br />\| count\_distinct(incident\_id)|
|Palo Alto Cortex XDR|Geo Location of Alerts|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| extract field=host\_ip "\\"?(?\<ip\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(alert\_id) as frequency by ip<br />\| lookup latitude, longitude from geo://location on ip = ip|
|Palo Alto Cortex XDR|Incidents by Severity Over Time|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview|\_sourceCategory={{Logsdatasource}}   "incident\_id" "incident\_name"<br />\| json "incident\_id","incident\_name","creation\_time","modification\_time","status","severity","assigned\_user\_mail","alert\_count","high\_severity\_alert\_count","critical\_severity\_alert\_count","user\_count","xdr\_url","wildfire\_hits","alerts\_grouping\_status","mitre\_tactics\_ids\_and\_names","mitre\_techniques\_ids\_and\_names" as incident\_id,incident\_name,creation\_time,modification\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names nodrop<br />\| where alerts\_grouping\_status matches"{{alerts\_grouping\_status}}"<br />\| where severity matches "{{severity}}"<br />\| where status matches "{{status}}"<br /><br />\| timeslice 1d<br />\| count\_distinct(incident\_id) as frequency by \_timeslice,severity<br />\| fillmissing timeslice, values all in severity<br />\| transpose row \_timeslice column severity|
|Palo Alto Cortex XDR|Incidents by Status|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview|\_sourceCategory={{Logsdatasource}}   "incident\_id" "incident\_name"<br />\| json "incident\_id","incident\_name","creation\_time","modification\_time","status","severity","assigned\_user\_mail","alert\_count","high\_severity\_alert\_count","critical\_severity\_alert\_count","user\_count","xdr\_url","wildfire\_hits","alerts\_grouping\_status","mitre\_tactics\_ids\_and\_names","mitre\_techniques\_ids\_and\_names" as incident\_id,incident\_name,creation\_time,modification\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names nodrop<br />\| where alerts\_grouping\_status matches"{{alerts\_grouping\_status}}"<br />\| where severity matches "{{severity}}"<br />\| where status matches "{{status}}"<br />\| topk(1,modification\_time) by incident\_id<br />\| count\_distinct(incident\_id) as frequency by status<br />\| sort by frequency|
|Palo Alto Cortex XDR|Incidents Created|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview|\_sourceCategory={{Logsdatasource}}   "incident\_id" "incident\_name"<br />\| json "incident\_id","incident\_name","creation\_time","modification\_time","status","severity","assigned\_user\_mail","alert\_count","high\_severity\_alert\_count","critical\_severity\_alert\_count","user\_count","xdr\_url","wildfire\_hits","alerts\_grouping\_status","mitre\_tactics\_ids\_and\_names","mitre\_techniques\_ids\_and\_names" as incident\_id,incident\_name,creation\_time,modification\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names nodrop<br />\| where alerts\_grouping\_status matches"{{alerts\_grouping\_status}}"<br />\| where severity matches "{{severity}}"<br />\| where status matches "{{status}}"<br />\| count\_distinct(incident\_id)|
|Palo Alto Cortex XDR|Recent Alerts|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| count\_distinct(alert\_id) by \_messageTime,alert\_id,name,severity,source,alert\_type,action,agent\_os\_type,category,is\_whitelisted,resolution\_status<br />\| formatDate(toLong(\_messageTime),"dd-MM-yyyy HH:mm:ss") as time\_stamp<br />\| top 100 name,source,category,severity,action,is\_whitelisted,alert\_type,agent\_os\_type,resolution\_status,time\_stamp by time\_stamp|
|Palo Alto Cortex XDR|Recent Incidents|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview|\_sourceCategory={{Logsdatasource}}   "incident\_id" "incident\_name"<br />\| json "incident\_id","incident\_name","creation\_time","modification\_time","status","severity","assigned\_user\_mail","alert\_count","high\_severity\_alert\_count","critical\_severity\_alert\_count","user\_count","xdr\_url","wildfire\_hits","alerts\_grouping\_status","mitre\_tactics\_ids\_and\_names","mitre\_techniques\_ids\_and\_names" as incident\_id,incident\_name,creation\_time,modification\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names nodrop<br />\| where alerts\_grouping\_status matches"{{alerts\_grouping\_status}}"<br />\| where severity matches "{{severity}}"<br />\| where status matches "{{status}}"<br /><br />\| topk(1,modification\_time) by incident\_id<br />\| count\_distinct(incident\_id) by \_messageTime,incident\_id,incident\_name,creation\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names<br /><br /><br />\| if(isNull(incident\_name),"-",incident\_name) as incident\_name<br />\| if(isNull(assigned\_user\_mail),"-",assigned\_user\_mail) as assigned\_user\_mail<br />\| if(isNull(mitre\_techniques\_ids\_and\_names),"-",mitre\_techniques\_ids\_and\_names) as mitre\_techniques\_ids\_and\_names<br />\| if(isNull(mitre\_tactics\_ids\_and\_names),"-",mitre\_tactics\_ids\_and\_names) as mitre\_tactics\_ids\_and\_names<br /><br />\| replace(mitre\_tactics\_ids\_and\_names, /".\*?\\s-\\s(.\*?)"/, "\\"\$1\\"") as mitre\_tactics<br />\| replace(mitre\_techniques\_ids\_and\_names, /".\*?\\s-\\s(.\*?)"/, "\\"\$1\\"") as mitre\_techniques<br /><br /><br />\| formatDate(toLong(\_messageTime),"dd-MM-yyyy HH:mm:ss") as latest\_updated\_time<br />\| formatDate(toLong(creation\_time),"dd-MM-yyyy HH:mm:ss") as creation\_time<br />\| tourl(xdr\_url, creation\_time,"Detected at: ","") as detection\_url<br />\| top 100 incident\_id,incident\_name,detection\_url,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,wildfire\_hits,mitre\_tactics,mitre\_techniques,alerts\_grouping\_status,latest\_updated\_time by latest\_updated\_time|
|Palo Alto Cortex XDR|Top 10 Actions on Alerts|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| count\_distinct(alert\_id) as frequency by action<br />\| sort by frequency<br />\| limit 10|
|Palo Alto Cortex XDR|Top 10 Alerts Triggered|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| count\_distinct(alert\_id) as frequency by name<br />\| sort by frequency<br />\| limit 10|
|Palo Alto Cortex XDR|Top 10 Assigned Users|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview|\_sourceCategory={{Logsdatasource}}   "incident\_id" "incident\_name"<br />\| json "incident\_id","incident\_name","creation\_time","modification\_time","status","severity","assigned\_user\_mail","alert\_count","high\_severity\_alert\_count","critical\_severity\_alert\_count","user\_count","xdr\_url","wildfire\_hits","alerts\_grouping\_status","mitre\_tactics\_ids\_and\_names","mitre\_techniques\_ids\_and\_names" as incident\_id,incident\_name,creation\_time,modification\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names nodrop<br />\| where alerts\_grouping\_status matches"{{alerts\_grouping\_status}}"<br />\| where severity matches "{{severity}}"<br />\| where status matches "{{status}}"<br /><br />\| where !isNull(assigned\_user\_mail)<br />\| where !isNull(assigned\_user\_pretty\_name)<br />\| assigned\_user\_pretty\_name as user\_name<br />\| assigned\_user\_mail as user\_mail<br />\| count\_distinct(incident\_id) as frequency by user\_mail,user\_name<br />\| sort by frequency<br />\| limit 10|
|Palo Alto Cortex XDR|Top 10 Categories|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| count\_distinct(alert\_id) as frequency by category<br />\| sort by frequency<br />\| limit 10|
|Palo Alto Cortex XDR|Top 10 MITRE Tactics Used|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview|\_sourceCategory={{Logsdatasource}}   "incident\_id" "incident\_name"<br />\| json "incident\_id","incident\_name","creation\_time","modification\_time","status","severity","assigned\_user\_mail","alert\_count","high\_severity\_alert\_count","critical\_severity\_alert\_count","user\_count","xdr\_url","wildfire\_hits","alerts\_grouping\_status","mitre\_tactics\_ids\_and\_names","mitre\_techniques\_ids\_and\_names" as incident\_id,incident\_name,creation\_time,modification\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names nodrop<br />\| where alerts\_grouping\_status matches"{{alerts\_grouping\_status}}"<br />\| where severity matches "{{severity}}"<br />\| where status matches "{{status}}"<br />\| where !isNull(mitre\_tactics\_ids\_and\_names)<br /><br />\| extract field=mitre\_tactics\_ids\_and\_names "\\".\*?\\s-\\s(?\<mitre\_tactic\>.\*?)\\"" multi<br />\| count\_distinct(incident\_id) as frequency by mitre\_tactic<br />\| sort by frequency<br />\| limit 10|
|Palo Alto Cortex XDR|Top 10 MITRE Techniques Used|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Incidents Overview|\_sourceCategory={{Logsdatasource}}   "incident\_id" "incident\_name"<br />\| json "incident\_id","incident\_name","creation\_time","modification\_time","status","severity","assigned\_user\_mail","alert\_count","high\_severity\_alert\_count","critical\_severity\_alert\_count","user\_count","xdr\_url","wildfire\_hits","alerts\_grouping\_status","mitre\_tactics\_ids\_and\_names","mitre\_techniques\_ids\_and\_names" as incident\_id,incident\_name,creation\_time,modification\_time,status,severity,assigned\_user\_mail,alert\_count,high\_severity\_alert\_count,critical\_severity\_alert\_count,user\_count,xdr\_url,wildfire\_hits,alerts\_grouping\_status,mitre\_tactics\_ids\_and\_names,mitre\_techniques\_ids\_and\_names nodrop<br />\| where alerts\_grouping\_status matches"{{alerts\_grouping\_status}}"<br />\| where severity matches "{{severity}}"<br />\| where status matches "{{status}}"<br />\| where !isNull(mitre\_techniques\_ids\_and\_names)<br /><br />\| extract field=mitre\_techniques\_ids\_and\_names "\\".\*?\\s-\\s(?\<mitre\_technique\>.\*?)\\"" multi<br />\| count\_distinct(incident\_id) as frequency by mitre\_technique<br />\| sort by frequency<br />\| limit 10|
|Palo Alto Cortex XDR|Top 10 Sources|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| count\_distinct(alert\_id) as frequency by source<br />\| sort by frequency<br />\| limit 10|
|Palo Alto Cortex XDR|White Listed Alerts|Logs|Installed Apps/Palo Alto Cortex XDR/Palo Alto Cortex XDR - Alerts Overview|\_sourceCategory={{Logsdatasource}}   "alert\_id" "is\_whitelisted"<br />\| json "alert\_id","name","severity","source","host\_ip","alert\_type","action\_pretty","agent\_os\_type","category","detection\_timestamp","is\_whitelisted","resolution\_status" as alert\_id,name,severity,source,host\_ip,alert\_type,action\_pretty,agent\_os\_type,category,detection\_timestamp,is\_whitelisted,resolution\_status nodrop<br /><br />\| action\_pretty as action<br /><br />\| where severity matches "{{severity}}"<br />\| where category matches "{{category}}"<br />\| where source matches "{{source}}"<br />\| where action matches "{{action}}"<br />\| where agent\_os\_type matches "{{agent\_os}}"<br />\| where alert\_type matches "{{alert\_type}}"<br />\| where is\_whitelisted matches "{{is\_whitelisted}}"<br /><br />\| where is\_whitelisted matches("true")<br />\| count\_distinct(alert\_id)|

