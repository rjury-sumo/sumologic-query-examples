# Google Cloud Firewall
## Sumo Logic App For: Google Cloud Firewall
Google Cloud Platform (GCP) firewall rules let you allow or deny traffic to and from VMs in a Google VPC network. The Sumo Logic app for Google Cloud Firewall helps you monitor request activity and the effect of your firewall rules. The preconfigured dashboards provide insight into ingress and egress request traffic, including the location of allowed and denied requests, allowed and denied requests over time, and the top networks, subnetworks, and VMs by allowed and denied ingress requests.
Docs Link: [Google Cloud Firewall](https://help.sumologic.com/?cid=87345)

## Searches

### Log Searches

- **Allowed Destination Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Allowed Egress Traffic - Outlier**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Allowed Egress Traffic by Network Over Time**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Allowed Ingress Traffic - Outlier**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Allowed Ingress Traffic by Network Over Time**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Allowed Request Remote Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Allowed Source Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Allowed Traffic by Network Over Time**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Denied Destination Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Denied Egress Traffic - Outlier**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Denied Egress Traffic by Network Over Time**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Denied Ingress Traffic - Outlier**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Denied Ingress Traffic by Network Over Time**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Denied Request Remote Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Denied Source Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Denied Traffic by Network Over Time**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Egress Destination Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Google Cloud Firewall - Denied Request Remote Locations**: from Search: Google Cloud Firewall/Google Cloud Firewall - Denied Request Remote Locations 
- **Google Cloud Firewall - Denied Request Remote Locations**: from Search: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Denied Request Remote Locations 
- **Google Cloud Firewall - Request Remote Locations**: from Search: Google Cloud Firewall/Google Cloud Firewall - Request Remote Locations 
- **Google Cloud Firewall - Request Remote Locations**: from Search: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Request Remote Locations 
- **Google Cloud Firewall - Rules**: from Search: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Rules 
- **Google Cloud Firewall - Rules**: from Search: Google Cloud Firewall/Google Cloud Firewall - Rules 
- **Ingress Source Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Requests Denied (%)**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Top Allowed Egress Rules**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Top Allowed Ingress Rules**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Top Denied Destination IPs**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Top Denied Egress Rules**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Top Denied Ingress Rules**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Top Denied Source IPs**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Top Destination Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Top Networks by Egress Requests**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Top Networks by Ingress Requests**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Top Remote Request Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Top Requested Networks**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Top Requested Subnetworks**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Top Requested VMs**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Top Rules Used**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Top Source Locations**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Top Subnetworks by Egress Requests**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Top Subnetworks by Ingress Requests**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Top VMs by Egress Requests**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress 
- **Top VMs by Ingress Requests**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress 
- **Traffic Disposition Over Time**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview 
- **Traffic Over Time**: from Dashboard: Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Google Cloud Firewall|Allowed Destination Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count by latitude, longitude|
|Google Cloud Firewall|Allowed Egress Traffic - Outlier|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 20m<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as allowed by \_timeslice<br />\| fillmissing timeslice(20m)<br />\| outlier allowed|
|Google Cloud Firewall|Allowed Egress Traffic by Network Over Time|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as allowed by \_timeslice, network, project<br />\| transpose row \_timeslice column network, project|
|Google Cloud Firewall|Allowed Ingress Traffic - Outlier|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 20m<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as allowed by \_timeslice<br />\| fillmissing timeslice(20m)<br />\| outlier allowed|
|Google Cloud Firewall|Allowed Ingress Traffic by Network Over Time|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as allowed by \_timeslice, network, project<br />\| transpose row \_timeslice column network, project|
|Google Cloud Firewall|Allowed Request Remote Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(direction="INGRESS", src\_ip, dest\_ip) as remote\_ip<br />\| lookup latitude, longitude from geo://location on ip=remote\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count by latitude, longitude|
|Google Cloud Firewall|Allowed Source Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup latitude, longitude from geo://location on ip=src\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count by latitude, longitude|
|Google Cloud Firewall|Allowed Traffic by Network Over Time|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests by \_timeslice, network, project<br />\| transpose row \_timeslice column network, project|
|Google Cloud Firewall|Denied Destination Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count by latitude, longitude|
|Google Cloud Firewall|Denied Egress Traffic - Outlier|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 20m<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as denied by \_timeslice<br />\| fillmissing timeslice(20m)<br />\| outlier denied|
|Google Cloud Firewall|Denied Egress Traffic by Network Over Time|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as denied by \_timeslice, network, project<br />\| transpose row \_timeslice column network, project|
|Google Cloud Firewall|Denied Ingress Traffic - Outlier|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 20m<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as denied by \_timeslice<br />\| fillmissing timeslice(20m)<br />\| outlier denied|
|Google Cloud Firewall|Denied Ingress Traffic by Network Over Time|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as denied by \_timeslice, network, project<br />\| transpose row \_timeslice column network, project|
|Google Cloud Firewall|Denied Request Remote Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(direction="INGRESS", src\_ip, dest\_ip) as remote\_ip<br />\| lookup latitude, longitude from geo://location on ip=remote\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count by latitude, longitude|
|Google Cloud Firewall|Denied Source Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup latitude, longitude from geo://location on ip=src\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count by latitude, longitude|
|Google Cloud Firewall|Denied Traffic by Network Over Time|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests by \_timeslice, network, project<br />\| transpose row \_timeslice column network, project|
|Google Cloud Firewall|Egress Destination Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count by latitude, longitude|
|Google Cloud Firewall|Google Cloud Firewall - Denied Request Remote Locations|Logs|Google Cloud Firewall/Google Cloud Firewall - Denied Request Remote Locations|\_sourceCategory = Labs/GCP/firewall  logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(direction="INGRESS", src\_ip, dest\_ip) as remote\_ip<br />\| lookup latitude, longitude, country\_name, region, city from geo://location on ip=remote\_ip<br />\| count by latitude, longitude|
|Google Cloud Firewall|Google Cloud Firewall - Denied Request Remote Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Denied Request Remote Locations|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(direction="INGRESS", src\_ip, dest\_ip) as remote\_ip<br />\| lookup latitude, longitude, country\_name, region, city from geo://location on ip=remote\_ip<br />\| count by latitude, longitude|
|Google Cloud Firewall|Google Cloud Firewall - Request Remote Locations|Logs|Google Cloud Firewall/Google Cloud Firewall - Request Remote Locations|\_sourceCategory = Labs/GCP/firewall  logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(direction="INGRESS", src\_ip, dest\_ip) as remote\_ip<br />\| lookup country\_name, region, city from geo://location on ip=remote\_ip<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\| count as requests, sum(deny) as denies, sum(allow) as allowed by city, region, country\_name<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests, denies, allowed, deny\_pct|
|Google Cloud Firewall|Google Cloud Firewall - Request Remote Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Request Remote Locations|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(direction="INGRESS", src\_ip, dest\_ip) as remote\_ip<br />\| lookup country\_name, region, city from geo://location on ip=remote\_ip<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\| count as requests, sum(deny) as denies, sum(allow) as allowed by city, region, country\_name<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests, denies, allowed, deny\_pct|
|Google Cloud Firewall|Google Cloud Firewall - Rules|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Rules|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| count as occurences by rule, project, network, direction, action, priority<br />\| sort by occurences|
|Google Cloud Firewall|Google Cloud Firewall - Rules|Logs|Google Cloud Firewall/Google Cloud Firewall - Rules|\_sourceCategory = Labs/GCP/firewall  logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| count as occurences by rule, project, network, direction, action, priority<br />\| sort by occurences|
|Google Cloud Firewall|Ingress Source Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup latitude, longitude from geo://location on ip=src\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count by latitude, longitude|
|Google Cloud Firewall|Requests Denied (%)|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as total, sum(deny) as denies<br />\| denies \* 100.0 / total as denied\_percent<br />\| fields denied\_percent|
|Google Cloud Firewall|Top Allowed Egress Rules|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| concat("https://console.cloud.google.com/networking/firewalls/details/", rule\_name, "?project=", project) as rule\_url<br />\| tourl(rule\_url, rule\_name) as rule<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as occurences by project, network, rule, priority<br />\| sort by occurences|
|Google Cloud Firewall|Top Allowed Ingress Rules|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"ALLOWED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| concat("https://console.cloud.google.com/networking/firewalls/details/", rule\_name, "?project=", project) as rule\_url<br />\| tourl(rule\_url, rule\_name) as rule<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as occurences by project, network, rule, priority<br />\| sort by occurences|
|Google Cloud Firewall|Top Denied Destination IPs|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup city, region, country\_name from geo://location on ip=dest\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as denies by dest\_ip, city, region, country\_name<br />\| sort by denies|
|Google Cloud Firewall|Top Denied Egress Rules|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| concat("https://console.cloud.google.com/networking/firewalls/details/", rule\_name, "?project=", project) as rule\_url<br />\| tourl(rule\_url, rule\_name) as rule<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as occurences by project, network, rule, priority<br />\| sort by occurences|
|Google Cloud Firewall|Top Denied Ingress Rules|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| concat("https://console.cloud.google.com/networking/firewalls/details/", rule\_name, "?project=", project) as rule\_url<br />\| tourl(rule\_url, rule\_name) as rule<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as occurences by project, network, rule, priority<br />\| sort by occurences|
|Google Cloud Firewall|Top Denied Source IPs|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\"" "\\"disposition\\":\\"DENIED\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup city, region, country\_name from geo://location on ip=src\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as denies by src\_ip, city, region, country\_name<br />\| sort by denies|
|Google Cloud Firewall|Top Destination Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup country\_name, region, city from geo://location on ip=dest\_ip<br />\| where !isNull(country\_name)<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by city, region, country\_name<br />\| denies \* 100.0 / requests as deny\_pct<br />\| top 25 city, region, country\_name by requests, denies, allowed, deny\_pct|
|Google Cloud Firewall|Top Networks by Egress Requests|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, network<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Top Networks by Ingress Requests|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, network<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Top Remote Request Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip", "connection.dest\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip, dest\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(direction="INGRESS", src\_ip, dest\_ip) as remote\_ip<br />\| lookup country\_name, region, city from geo://location on ip=remote\_ip<br />\| where !isNull(country\_name)<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by city, region, country\_name<br />\| denies \* 100.0 / requests as deny\_pct<br />\| top 25 city, region, country\_name by requests, denies, allowed, deny\_pct|
|Google Cloud Firewall|Top Requested Networks|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, network<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Top Requested Subnetworks|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, network, subnetwork\_name<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Top Requested VMs|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, zone, network, vm\_instance<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Top Rules Used|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| concat("https://console.cloud.google.com/networking/firewalls/details/", rule\_name, "?project=", project) as rule\_url<br />\| tourl(rule\_url, rule\_name) as rule<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as occurences by project, network, rule, direction, action, priority<br />\| sort by occurences|
|Google Cloud Firewall|Top Source Locations|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details", "connection.src\_ip" as disposition, vm\_instance, network, rule\_details, src\_ip<br />\| json field=rule\_details "action", "priority", "direction"<br />\| lookup country\_name, region, city from geo://location on ip=src\_ip<br />\| where !isNull(country\_name)<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by city, region, country\_name<br />\| denies \* 100.0 / requests as deny\_pct<br />\| top 25 city, region, country\_name by requests, denies, allowed, deny\_pct|
|Google Cloud Firewall|Top Subnetworks by Egress Requests|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, network, subnetwork\_name<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Top Subnetworks by Ingress Requests|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, network, subnetwork\_name<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Top VMs by Egress Requests|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Egress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"EGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, zone, network, vm\_instance<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Top VMs by Ingress Requests|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Ingress|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\"" "\\"direction\\":\\"INGRESS\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| if(disposition="DENIED", 1, 0) as deny<br />\| if(disposition="ALLOWED", 1, 0) as allow<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests, sum(deny) as denies, sum(allow) as allowed by project, zone, network, vm\_instance<br />\| denies \* 100.0 / requests as deny\_pct<br />\| sort by requests|
|Google Cloud Firewall|Traffic Disposition Over Time|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests by \_timeslice, disposition<br />\| transpose row \_timeslice column disposition|
|Google Cloud Firewall|Traffic Over Time|Logs|Installed Apps/Google Cloud Firewall/Google Cloud Firewall - Overview|\_sourceCategory={{Logsdatasource}}   logName reference resource "\\"type\\":\\"gce\_subnetwork\\""<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| parse regex "\\"reference\\":\\"network:[^\\"/]+/firewall:(?\<rule\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/compute.googleapis.com%2Ffirewall"<br />\| json "message.data.resource.labels", "message.data.jsonPayload" as labels, payload <br />\| json field=labels "location","project\_id","subnetwork\_id","subnetwork\_name" as zone,project,subnetwork\_id,subnetwork\_name nodrop<br />\| json field=payload "disposition", "instance.vm\_name", "vpc.vpc\_name", "rule\_details" as disposition, vm\_instance, network, rule\_details<br />\| json field=rule\_details "action", "priority", "direction"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{Network}}" = "\*", true, network matches "{{Network}}") AND if ("{{Subnetwork}}" = "\*", true, subnetwork\_name matches "{{Subnetwork}}") AND if ("{{Rule}}" = "\*", true, rule\_name matches "{{Rule}}")<br />\|count as requests by \_timeslice, direction<br />\| transpose row \_timeslice column direction|

