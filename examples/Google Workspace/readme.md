# Google Workspace
## Sumo Logic App For: Google Workspace
The Google Workspace App allows you to monitor and analyze activities across all Google Workspace applications from a single location. Comprehensive dashboards display information on administrative and user activities, Google Drive usage, and logins. Dashboards also provide full visibility into alerts from Google Workspace Alert Center, allowing you to investigate and correlate alerts and monitor potential threats across all Google Workspace apps.
Docs Link: [Google Workspace](https://help.sumologic.com/?cid=6005)

## Searches

### Log Searches

- **ACL Changes**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **ACL Changes**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **ACL Changes**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **ACL Changes**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Action by Admin - Distribution**: from Dashboard: Google Workspace/Google Workspace - Admin 
- **Action by Admin - Distribution**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **Affected Users**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Affected Users**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Affected Users by Alert Types**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Affected Users by Alert Types**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Alert Count by Source**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Alert Count by Source**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Alert Count by Source and Type**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Alert Count by Source and Type**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Alert Types by Attacker**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Alert Types by Attacker**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Alerts by Administrators**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **Alerts by Administrators**: from Dashboard: Google Workspace/Google Workspace - Admin 
- **Alerts by Source IP**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Alerts by Source IP**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Alerts by User**: from Dashboard: Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Alerts by User**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Alerts Outlier Over Time**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Alerts Outlier Over Time**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Alerts Over Time**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Alerts Over Time**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **App Token Actions**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **App Token Actions**: from Dashboard: Google Workspace/Google Workspace - Admin 
- **App Token Count**: from Dashboard: Google Workspace/Google Workspace - Admin 
- **App Token Count**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **Compromised Credentials**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Compromised Credentials**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Compromised Credentials**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Compromised Credentials**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Compromised Devices**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Compromised Devices**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Compromised Devices**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Compromised Devices**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Configuration Alerts**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Configuration Alerts**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Content sharing by Compromised Users**: from Dashboard: Google Workspace/Google Workspace - Drive - User Activity 
- **Content sharing by Compromised Users**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive - User Activity 
- **Count by Login State**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Count by Login State**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Document Downloads by Title**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Document Downloads by Title**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Document Types**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Document Types**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Documents Being Shared**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Documents Being Shared**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Documents Shared Outside of Organization**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Documents Shared Outside of Organization**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Documents Viewed - Top 10**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Documents Viewed - Top 10**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Drive Activity by Country Over Time**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Drive Activity by Country Over Time**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Drive Activity by Location**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Drive Activity by Location**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Gmail Phishing by Alert Types**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Gmail Phishing by Alert Types**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Gmail Phishing Time Compare**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Gmail Phishing Time Compare**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Google Activity by Source Location**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Google Activity by Source Location**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Google Workspace - Document Flow Diagram**: from Search: Installed Apps/Google Workspace/Google Workspace - Document Flow Diagram 
- **Google Workspace - Document Flow Diagram**: from Search: Google Workspace/Google Workspace - Document Flow Diagram 
- **Google Workspace - Excessive Login Failures by User**: from Search: Google Workspace/Google Workspace - Excessive Login Failures by User 
- **Google Workspace - Excessive Login Failures by User**: from Search: Installed Apps/Google Workspace/Google Workspace - Excessive Login Failures by User 
- **Google Workspace - Login Challenge for Suspicious Sign-ins**: from Search: Google Workspace/Google Workspace - Login Challenge for Suspicious Sign-ins 
- **Google Workspace - Login Challenge for Suspicious Sign-ins**: from Search: Installed Apps/Google Workspace/Google Workspace - Login Challenge for Suspicious Sign-ins 
- **Google Workspace - Password Changes Count**: from Search: Google Workspace/Google Workspace - Password Changes Count 
- **Google Workspace - Password Changes Count**: from Search: Installed Apps/Google Workspace/Google Workspace - Password Changes Count 
- **Google Workspace Activity by Users with Compromised Credentials**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations 
- **Google Workspace Activity by Users with Compromised Credentials**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Investigations 
- **Google Workspace Activity from Compromised Devices**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations 
- **Google Workspace Activity from Compromised Devices**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Investigations 
- **Google Workspace Apps Accessed by Compromised Users**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Investigations 
- **Google Workspace Apps Accessed by Compromised Users**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations 
- **Google Workspace Apps Accessed from Compromised Devices**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations 
- **Google Workspace Apps Accessed from Compromised Devices**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Investigations 
- **Groups - Users Added or Removed**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **Groups - Users Added or Removed**: from Dashboard: Google Workspace/Google Workspace - Admin 
- **Identity Alerts by User**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Identity Alerts by User**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Identity Alerts by User**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Identity Alerts by User**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Login Activity by Location**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Login Activity by Location**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Login Activity Over Time**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Login Activity Over Time**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Login Failures - Outlier**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Login Failures - Outlier**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Login Failures by Type**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Login Failures by Type**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Login Failures by User**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Login Failures by User**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Login Failures by User, IP Address**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Login Failures by User, IP Address**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Logins from Multiple IPs**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Logins from Multiple IPs**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Logins from Multiple IPs**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Logins from Multiple IPs**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Logins from Multiple IPs**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Logins from Multiple IPs**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Malicious Email from Whitelisted Domain/IP**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Malicious Email from Whitelisted Domain/IP**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Most Active IPs**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive - User Activity 
- **Most Active IPs**: from Dashboard: Google Workspace/Google Workspace - Drive - User Activity 
- **Most Active Users**: from Dashboard: Google Workspace/Google Workspace - Drive - User Activity 
- **Most Active Users**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive - User Activity 
- **Primary Action Count**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Primary Action Count**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Recent Alerts**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Recent Alerts**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Recent Attacks by Message Date**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Recent Attacks by Message Date**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Recent Customer Takeout Initiated**: from Dashboard: Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Customer Takeout Initiated**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Devices Compromised**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Devices Compromised**: from Dashboard: Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Google Operations Alerts**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Google Operations Alerts**: from Dashboard: Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Government-Backed Attack Warnings**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Government-Backed Attack Warnings**: from Dashboard: Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Suspicious Activity**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Suspicious Activity**: from Dashboard: Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Recent Uploads by Title**: from Dashboard: Google Workspace/Google Workspace - Drive 
- **Recent Uploads by Title**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive 
- **Serious Alerts**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Serious Alerts**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Successful Logins**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Successful Logins**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Successful Logins by Compromised Users**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Login 
- **Successful Logins by Compromised Users**: from Dashboard: Google Workspace/Google Workspace - Login 
- **Suspended Users**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Suspended Users**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Suspicious Activity by Device Type**: from Dashboard: Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Suspicious Activity by Device Type**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Suspicious Emails**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Suspicious Emails**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Suspicious IP Addresses**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Suspicious IP Addresses**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Suspicious Logins**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Suspicious Logins**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Threat Intel by Attachments**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Investigations 
- **Threat Intel by Attachments**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations 
- **Threat Intel by Domain**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Investigations 
- **Threat Intel by Domain**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations 
- **Threat Intel by sender email**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Investigations 
- **Threat Intel by sender email**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations 
- **Top 10 Attackers by Distinct Victims**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 Attackers by Distinct Victims**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 Attackers by Message Count**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 Attackers by Message Count**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 Suspicious Messages Reported**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 Suspicious Messages Reported**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 User Reported Phishing Messages**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 User Reported Phishing Messages**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 User Reported Spam Spike Messages**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top 10 User Reported Spam Spike Messages**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing 
- **Top Admin Action**: from Dashboard: Google Workspace/Google Workspace - Admin 
- **Top Admin Action**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **Top Apps**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Top Apps**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Top Event Name by Event Type**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Top Event Name by Event Type**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Top Login Failure Reasons**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Top Login Failure Reasons**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Top Users Creating Contents**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive - User Activity 
- **Top Users Creating Contents**: from Dashboard: Google Workspace/Google Workspace - Drive - User Activity 
- **Top Users Downloading Contents**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive - User Activity 
- **Top Users Downloading Contents**: from Dashboard: Google Workspace/Google Workspace - Drive - User Activity 
- **Top Users Sharing Contents Outside of Organization**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive - User Activity 
- **Top Users Sharing Contents Outside of Organization**: from Dashboard: Google Workspace/Google Workspace - Drive - User Activity 
- **Top Users Uploading Contents**: from Dashboard: Google Workspace/Google Workspace - Drive - User Activity 
- **Top Users Uploading Contents**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Drive - User Activity 
- **Total Admins**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Total Admins**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Total Alerts**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Overview 
- **Total Alerts**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview 
- **Total Alerts**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Total Alerts**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Total Devices Compromised**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Total Devices Compromised**: from Dashboard: Google Workspace/Google Workspace - Alert Center -  Other Alerts 
- **Total Login Failures**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **Total Login Failures**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Total Suspended Users**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Total Suspended Users**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Total Suspicious Logins**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Total Suspicious Logins**: from Dashboard: Google Workspace/Google Workspace - Alert Center - Google Identity 
- **Total Users Sharing Contents Outside of Organization**: from Dashboard: Google Workspace/Google Workspace - Overview 
- **Total Users Sharing Contents Outside of Organization**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Overview 
- **User Actions Details**: from Dashboard: Google Workspace/Google Workspace - Admin 
- **User Actions Details**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **User Content Transfered**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **User Content Transfered**: from Dashboard: Google Workspace/Google Workspace - Admin 
- **Users - Created or Deleted**: from Dashboard: Installed Apps/Google Workspace/Google Workspace - Admin 
- **Users - Created or Deleted**: from Dashboard: Google Workspace/Google Workspace - Admin

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Google Workspace|ACL Changes|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"old\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<old\_value\>[^\\]]\*)\\]\\n" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| replace (old\_value, "\\"", "") as old\_value<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventName, doc\_title, old\_value, new\_value, target\_user, email<br />\| fields -\_count|
|Google Workspace|ACL Changes|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  acl\_change "\\"applicationName\\": \\"drive\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| parse regex field=events "\\"type\\":\\"(?\<eventType\>[^\\"]+)\\",\\"name\\":\\"(?\<eventName\>[^\\"]+)\\"" multi<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventName, \_timeslice<br />\| transpose row \_timeslice column eventName|
|Google Workspace|ACL Changes|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  acl\_change "\\"applicationName\\": \\"drive\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| parse regex field=events "\\"type\\":\\"(?\<eventType\>[^\\"]+)\\",\\"name\\":\\"(?\<eventName\>[^\\"]+)\\"" multi<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventName, \_timeslice<br />\| transpose row \_timeslice column eventName|
|Google Workspace|ACL Changes|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"old\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<old\_value\>[^\\]]\*)\\]\\n" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| replace (old\_value, "\\"", "") as old\_value<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventName, doc\_title, old\_value, new\_value, target\_user, email<br />\| fields -\_count|
|Google Workspace|Action by Admin - Distribution|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count as eventCount by admin\_email<br />\| sort by eventCount, admin\_email asc|
|Google Workspace|Action by Admin - Distribution|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count as eventCount by admin\_email<br />\| sort by eventCount, admin\_email asc|
|Google Workspace|Affected Users|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by victim,type <br />\| total \_count as message\_count by victim<br />\| transpose row victim, message\_count column type<br />\| sort by message\_count|
|Google Workspace|Affected Users|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by victim,type <br />\| total \_count as message\_count by victim<br />\| transpose row victim, message\_count column type<br />\| sort by message\_count|
|Google Workspace|Affected Users by Alert Types|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by type,victim<br />\| transpose row type column victim|
|Google Workspace|Affected Users by Alert Types|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by type,victim<br />\| transpose row type column victim|
|Google Workspace|Alert Count by Source|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by source<br />\| sort by \_count|
|Google Workspace|Alert Count by Source|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by source<br />\| sort by \_count|
|Google Workspace|Alert Count by Source and Type|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" AND type matches "{{type}}"<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by source,type<br />\| transpose row source column type|
|Google Workspace|Alert Count by Source and Type|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" AND type matches "{{type}}"<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by source,type<br />\| transpose row source column type|
|Google Workspace|Alert Types by Attacker|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker,type<br />\| transpose row attacker column type|
|Google Workspace|Alert Types by Attacker|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker,type<br />\| transpose row attacker column type|
|Google Workspace|Alerts by Administrators|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}} <br />\| json "alertId","customerId","source","type","data", "securityInvestigationToolLink" as alert\_id, customer\_id, source, type, data, investigation\_url nodrop<br />\| json field=data "email" as admin\_email<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by admin\_email, alert\_id, customer\_id, source, type, data, investigation\_url, \_messageTime<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "admin"<br /> \| json "actor", "id" nodrop<br /> \| json field=id "applicationName"   <br /> \| where applicationName="admin"<br /> \| json field=actor "email" as admin\_email<br /> \| count by admin\_email<br /> \| compose admin\_email  <br />]<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| if(isNull(investigation\_url), "https://admin.google.com/ac/ic/investigate", concat("https://",investigation\_url)) as investigation\_url<br />\| sort by \_messageTime<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields -\_messageTime, \_count<br />\| fields create\_time, customer\_id, alert\_id, admin\_email, source, type, investigation\_url, data|
|Google Workspace|Alerts by Administrators|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}} <br />\| json "alertId","customerId","source","type","data", "securityInvestigationToolLink" as alert\_id, customer\_id, source, type, data, investigation\_url nodrop<br />\| json field=data "email" as admin\_email<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by admin\_email, alert\_id, customer\_id, source, type, data, investigation\_url, \_messageTime<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "admin"<br /> \| json "actor", "id" nodrop<br /> \| json field=id "applicationName"   <br /> \| where applicationName="admin"<br /> \| json field=actor "email" as admin\_email<br /> \| count by admin\_email<br /> \| compose admin\_email  <br />]<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| if(isNull(investigation\_url), "https://admin.google.com/ac/ic/investigate", concat("https://",investigation\_url)) as investigation\_url<br />\| sort by \_messageTime<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields -\_messageTime, \_count<br />\| fields create\_time, customer\_id, alert\_id, admin\_email, source, type, investigation\_url, data|
|Google Workspace|Alerts by Source IP|Logs|Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  email AccountWarning<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\|where if ("{{email}}" = "\*", true, user matches "{{email}}")<br />\| lookup latitude, longitude, city,country\_name, region<br />  from geo://location on ip=src\_ip <br />\| count by latitude,longitude, city, country\_name, region|
|Google Workspace|Alerts by Source IP|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  email AccountWarning<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\|where if ("{{email}}" = "\*", true, user matches "{{email}}")<br />\| lookup latitude, longitude, city,country\_name, region<br />  from geo://location on ip=src\_ip <br />\| count by latitude,longitude, city, country\_name, region|
|Google Workspace|Alerts by User|Logs|Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Mobile device management"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]" as alert\_id, customer\_id, source, type, email, events<br />\| where source = "Mobile device management"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType"as device\_id, serial\_number, device\_type<br />\|count by email, type<br />\| transpose row email column type <br />\| order by email|
|Google Workspace|Alerts by User|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Mobile device management"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]" as alert\_id, customer\_id, source, type, email, events<br />\| where source = "Mobile device management"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType"as device\_id, serial\_number, device\_type<br />\|count by email, type<br />\| transpose row email column type <br />\| order by email|
|Google Workspace|Alerts Outlier Over Time|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| timeslice 1h<br />\| fillmissing timeslice(1h)<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count(alert\_id) as todays\_alerts by \_timeslice<br />\| compare with timeshift 1d as vs\_yesterday\| (todays\_alerts - todays\_alerts\_vs\_yesterday) as delta<br />\| outlier delta threshold = 2, window = 5, consecutive=2|
|Google Workspace|Alerts Outlier Over Time|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| timeslice 1h<br />\| fillmissing timeslice(1h)<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count(alert\_id) as todays\_alerts by \_timeslice<br />\| compare with timeshift 1d as vs\_yesterday\| (todays\_alerts - todays\_alerts\_vs\_yesterday) as delta<br />\| outlier delta threshold = 2, window = 5, consecutive=2|
|Google Workspace|Alerts Over Time|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| timeslice 1h<br />\| fillmissing timeslice(1h)<br />\| where source matches "{{source}}" AND type matches "{{type}}"<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by type,\_timeslice<br />\| transpose row \_timeslice column type|
|Google Workspace|Alerts Over Time|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| timeslice 1h<br />\| fillmissing timeslice(1h)<br />\| where source matches "{{source}}" AND type matches "{{type}}"<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by type,\_timeslice<br />\| transpose row \_timeslice column type|
|Google Workspace|App Token Actions|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"token\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<token\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*)\\"\\}" nodrop<br />\| where applicationName="token"<br />\|where if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{token\_action}}" = "\*", true, token\_action matches "{{token\_action}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count as eventCount by token\_action<br />\| sort by eventCount, token\_action|
|Google Workspace|App Token Actions|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"token\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<token\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*)\\"\\}" nodrop<br />\| where applicationName="token"<br />\|where if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{token\_action}}" = "\*", true, token\_action matches "{{token\_action}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count as eventCount by token\_action<br />\| sort by eventCount, token\_action|
|Google Workspace|App Token Count|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"token\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<token\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*?)\\"\\}" nodrop<br />\| where applicationName="token"<br />\|where if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{token\_action}}" = "\*", true, token\_action matches "{{token\_action}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count as eventCount by app\_name<br />\| sort by eventCount|
|Google Workspace|App Token Count|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"token\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<token\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*?)\\"\\}" nodrop<br />\| where applicationName="token"<br />\|where if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{token\_action}}" = "\*", true, token\_action matches "{{token\_action}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count as eventCount by app\_name<br />\| sort by eventCount|
|Google Workspace|Compromised Credentials|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br />\| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br />\| where type="Leaked password"<br />\|count by email<br />\| count|
|Google Workspace|Compromised Credentials|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br />\| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br />\| where type="Leaked password"<br />\|count by email<br />\| count|
|Google Workspace|Compromised Credentials|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br />\| json "alertId","customerId","source","type","data", "data.email", "createTime" as alert\_id, customer\_id, source, type, data, email, breach\_time<br />\| where type="Leaked password"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by breach\_time, email, source, type<br />\| fields -\_count|
|Google Workspace|Compromised Credentials|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br />\| json "alertId","customerId","source","type","data", "data.email", "createTime" as alert\_id, customer\_id, source, type, data, email, breach\_time<br />\| where type="Leaked password"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by breach\_time, email, source, type<br />\| fields -\_count|
|Google Workspace|Compromised Devices|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType", "resourceId", "iosVendorId", "deviceCompromisedState"as device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state nodrop<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\| count by serial\_number<br />\| count|
|Google Workspace|Compromised Devices|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType", "resourceId", "iosVendorId", "deviceCompromisedState"as device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state nodrop<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\| count by serial\_number<br />\| count|
|Google Workspace|Compromised Devices|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by alert\_id, create\_time, customer\_id, source, type, email, events<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceType", "deviceId", "deviceCompromisedState" as device\_type, device\_id, compromised\_state<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\| count by device\_id, device\_type, compromised\_state, email, customer\_id<br />\| fields -\_count|
|Google Workspace|Compromised Devices|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by alert\_id, create\_time, customer\_id, source, type, email, events<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceType", "deviceId", "deviceCompromisedState" as device\_type, device\_id, compromised\_state<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\| count by device\_id, device\_type, compromised\_state, email, customer\_id<br />\| fields -\_count|
|Google Workspace|Configuration Alerts|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| where type in ("Google Operations","Customer takeout initiated")<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id<br />\| count|
|Google Workspace|Configuration Alerts|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| where type in ("Google Operations","Customer takeout initiated")<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id<br />\| count|
|Google Workspace|Content sharing by Compromised Users|Logs|Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email"<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"  <br /> \| count by email<br /> \| compose email  <br />]<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}")<br />\|count by eventName, doc\_title, new\_value, target\_user, email<br />\| fields -\_count|
|Google Workspace|Content sharing by Compromised Users|Logs|Installed Apps/Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email"<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"  <br /> \| count by email<br /> \| compose email  <br />]<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}")<br />\|count by eventName, doc\_title, new\_value, target\_user, email<br />\| fields -\_count|
|Google Workspace|Count by Login State|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{loginType}}" = "\*", true, loginType matches "{{loginType}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventName<br />\| sort by eventCount, eventName asc|
|Google Workspace|Count by Login State|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{loginType}}" = "\*", true, loginType matches "{{loginType}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventName<br />\| sort by eventCount, eventName asc|
|Google Workspace|Document Downloads by Title|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"download\\""<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]+)\\"" nodrop // short cut here since doc\_title is the same for all event objects<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName="drive" and eventName="download"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title<br />\| sort  by \_count desc|
|Google Workspace|Document Downloads by Title|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"download\\""<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]+)\\"" nodrop // short cut here since doc\_title is the same for all event objects<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName="drive" and eventName="download"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title<br />\| sort  by \_count desc|
|Google Workspace|Document Types|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_type\\",\\n\\s+\\"value\\": \\"(?\<doc\_type\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=doc\_title "[^\\?]+?\\.(?\<doc\_ext\>[a-zA-Z0-9]{2,4})\$"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title,doc\_type,doc\_ext<br />\| if(doc\_type="unknown",doc\_ext,doc\_type) as doc\_type<br />\| count\_distinct(doc\_title) by doc\_type<br />\| sort by \_count\_distinct desc|
|Google Workspace|Document Types|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_type\\",\\n\\s+\\"value\\": \\"(?\<doc\_type\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=doc\_title "[^\\?]+?\\.(?\<doc\_ext\>[a-zA-Z0-9]{2,4})\$"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title,doc\_type,doc\_ext<br />\| if(doc\_type="unknown",doc\_ext,doc\_type) as doc\_type<br />\| count\_distinct(doc\_title) by doc\_type<br />\| sort by \_count\_distinct desc|
|Google Workspace|Documents Being Shared|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people?with\* OR public\*) <br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop <br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\*" or new\_value matches "public\_\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title, new\_value<br />\| sort by doc\_title asc<br />\| fields -\_count|
|Google Workspace|Documents Being Shared|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people?with\* OR public\*) <br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop <br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\*" or new\_value matches "public\_\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title, new\_value<br />\| sort by doc\_title asc<br />\| fields -\_count|
|Google Workspace|Documents Shared Outside of Organization|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where !(target\_user matches "\*acme.com\*") and !isEmpty(target\_user)<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventName, doc\_title, new\_value, target\_user, email<br />\| fields -\_count|
|Google Workspace|Documents Shared Outside of Organization|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where !(target\_user matches "\*acme.com\*") and !isEmpty(target\_user)<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventName, doc\_title, new\_value, target\_user, email<br />\| fields -\_count|
|Google Workspace|Documents Viewed - Top 10|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"access\\"" "\\"applicationName\\": \\"drive\\""<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="view"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title, eventName<br />\| Top 10 doc\_title by \_count|
|Google Workspace|Documents Viewed - Top 10|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"access\\"" "\\"applicationName\\": \\"drive\\""<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="view"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title, eventName<br />\| Top 10 doc\_title by \_count|
|Google Workspace|Drive Activity by Country Over Time|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where applicationName="drive" <br />\| timeslice 1h<br />\| count by \_timeslice, ipAddress<br />\| lookup latitude, longitude, country\_name from geo://location on ip = ipAddress<br />\| where !isEmpty(country\_name)<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \* |
|Google Workspace|Drive Activity by Country Over Time|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where applicationName="drive" <br />\| timeslice 1h<br />\| count by \_timeslice, ipAddress<br />\| lookup latitude, longitude, country\_name from geo://location on ip = ipAddress<br />\| where !isEmpty(country\_name)<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \* |
|Google Workspace|Drive Activity by Location|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\| count by ipAddress<br />\| lookup latitude, longitude from geo://location on ip = ipAddress<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude<br />\| sort by \_count|
|Google Workspace|Drive Activity by Location|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\| count by ipAddress<br />\| lookup latitude, longitude from geo://location on ip = ipAddress<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude<br />\| sort by \_count|
|Google Workspace|Gmail Phishing by Alert Types|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by type<br />\| sort by \_count|
|Google Workspace|Gmail Phishing by Alert Types|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by type<br />\| sort by \_count|
|Google Workspace|Gmail Phishing Time Compare|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\| timeslice 1h<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count(victim) as num\_victims by \_timeslice<br />\| compare with timeshift -1d as yesterday|
|Google Workspace|Gmail Phishing Time Compare|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\| timeslice 1h<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count(victim) as num\_victims by \_timeslice<br />\| compare with timeshift -1d as yesterday|
|Google Workspace|Google Activity by Source Location|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress<br />\| json "actor", "ipAddress", "events", "id" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| count by ipAddress<br />\| lookup latitude, longitude from geo://location on ip = ipAddress<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude<br />\| sort by \_count|
|Google Workspace|Google Activity by Source Location|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress<br />\| json "actor", "ipAddress", "events", "id" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| count by ipAddress<br />\| lookup latitude, longitude from geo://location on ip = ipAddress<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude<br />\| sort by \_count|
|Google Workspace|Google Workspace - Document Flow Diagram|Logs|Installed Apps/Google Workspace/Google Workspace - Document Flow Diagram|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"access\\"" "\\"applicationName\\": \\"drive\\""<br />// Add doc\_id, doc\_title, or email to first line to focus the search<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as drive\_action\_type,drive\_action\_name<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_id\\",\\n\\s+\\"value\\": \\"(?\<doc\_id\>[^\\"]\*)\\"" nodrop<br />\| where drive\_action\_type="access"<br />\| "" as \_raw<br />\| transaction on doc\_id with states create, upload, edit, view, rename, move, add\_to\_folder, remove\_from\_folder, trash, delete, untrash, download, preview, print in drive\_action\_name<br />results by flow<br />\| fromstate == "create" ? 1 : fromstate == "upload" ? 2 : fromstate == "edit" ? 3 : fromstate == "view" ? 4 : fromstate == "rename" ? 5 :  fromstate == "move" ? 6 : fromstate == "add\_to\_folder" ? 7 : fromstate == "remove\_from\_folder," ? 8 : fromstate == "trash" ? 9 : fromstate == "delete" ? 10 : fromstate == "untrash" ? 11 : fromstate == "download" ? 12 : fromstate == "preview" ? 13 :  fromstate == "print" ? 14 : 100 as order<br />\| count,  max(latency) by fromstate, tostate, order|
|Google Workspace|Google Workspace - Document Flow Diagram|Logs|Google Workspace/Google Workspace - Document Flow Diagram|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"access\\"" "\\"applicationName\\": \\"drive\\""<br />// Add doc\_id, doc\_title, or email to first line to focus the search<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as drive\_action\_type,drive\_action\_name<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_id\\",\\n\\s+\\"value\\": \\"(?\<doc\_id\>[^\\"]\*)\\"" nodrop<br />\| where drive\_action\_type="access"<br />\| "" as \_raw<br />\| transaction on doc\_id with states create, upload, edit, view, rename, move, add\_to\_folder, remove\_from\_folder, trash, delete, untrash, download, preview, print in drive\_action\_name<br />results by flow<br />\| fromstate == "create" ? 1 : fromstate == "upload" ? 2 : fromstate == "edit" ? 3 : fromstate == "view" ? 4 : fromstate == "rename" ? 5 :  fromstate == "move" ? 6 : fromstate == "add\_to\_folder" ? 7 : fromstate == "remove\_from\_folder," ? 8 : fromstate == "trash" ? 9 : fromstate == "delete" ? 10 : fromstate == "untrash" ? 11 : fromstate == "download" ? 12 : fromstate == "preview" ? 13 :  fromstate == "print" ? 14 : 100 as order<br />\| count,  max(latency) by fromstate, tostate, order|
|Google Workspace|Google Workspace - Excessive Login Failures by User|Logs|Google Workspace/Google Workspace - Excessive Login Failures by User|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\| count email, ipAddress<br />\| where \_count \> 3 // configure this value.<br />\| sort by \_count desc, ipaddress, email|
|Google Workspace|Google Workspace - Excessive Login Failures by User|Logs|Installed Apps/Google Workspace/Google Workspace - Excessive Login Failures by User|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\| count email, ipAddress<br />\| where \_count \> 3 // configure this value.<br />\| sort by \_count desc, ipaddress, email|
|Google Workspace|Google Workspace - Login Challenge for Suspicious Sign-ins|Logs|Google Workspace/Google Workspace - Login Challenge for Suspicious Sign-ins|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ("login\_challenge" and "login\_challenge\_status") "\\"type\\": \\"login\\"" <br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\| count by email, loginType, login\_failure\_type, ipAddress<br />\| fields -\_count<br />\| sort by email asc|
|Google Workspace|Google Workspace - Login Challenge for Suspicious Sign-ins|Logs|Installed Apps/Google Workspace/Google Workspace - Login Challenge for Suspicious Sign-ins|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ("login\_challenge" and "login\_challenge\_status") "\\"type\\": \\"login\\"" <br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\| count by email, loginType, login\_failure\_type, ipAddress<br />\| fields -\_count<br />\| sort by email asc|
|Google Workspace|Google Workspace - Password Changes Count|Logs|Google Workspace/Google Workspace - Password Changes Count|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL CHANGE\_PASSWORD "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events", "ipAddress"<br />\| json field=id "applicationName"<br />\| where applicationName="admin"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\""  nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| count by user\_email, admin\_action, admin\_email, ipAddress<br />\| sort by user\_email asc|
|Google Workspace|Google Workspace - Password Changes Count|Logs|Installed Apps/Google Workspace/Google Workspace - Password Changes Count|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL CHANGE\_PASSWORD "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events", "ipAddress"<br />\| json field=id "applicationName"<br />\| where applicationName="admin"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\""  nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| count by user\_email, admin\_action, admin\_email, ipAddress<br />\| sort by user\_email asc|
|Google Workspace|Google Workspace Activity by Users with Compromised Credentials|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}} <br />\| json "actor", "events", "id" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"  <br /> \| count by email<br /> \| compose email  <br />]<br />\| parse regex field=events "\\"type\\":\\"(?\<event\_type\>[^\\"]+)\\",\\"name\\":\\"(?\<event\_name\>[^\\"]+)\\"" multi<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as event\_time<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by event\_time, event\_name, event\_type, email, applicationName<br />\| fields -\_count<br />\| sort by event\_time|
|Google Workspace|Google Workspace Activity by Users with Compromised Credentials|Logs|Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}} <br />\| json "actor", "events", "id" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"  <br /> \| count by email<br /> \| compose email  <br />]<br />\| parse regex field=events "\\"type\\":\\"(?\<event\_type\>[^\\"]+)\\",\\"name\\":\\"(?\<event\_name\>[^\\"]+)\\"" multi<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as event\_time<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by event\_time, event\_name, event\_type, email, applicationName<br />\| fields -\_count<br />\| sort by event\_time|
|Google Workspace|Google Workspace Activity from Compromised Devices|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}} <br />\| json "actor", "events", "id" nodrop<br />\| parse regex field=events "\\"type\\":\\"(?\<event\_type\>[^\\"]+)\\",\\"name\\":\\"(?\<event\_name\>[^\\"]+)\\"" multi<br />\| parse regex field=events "\\"DEVICE\_SERIAL\_NUMBER\\",\\"value\\":\\"(?\<serial\_number\>[^\\"]+)\\"" multi<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />    \| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />    \| where type = "Device compromised"<br />    \| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />    \| json field=device\_info "serialNumber" as serial\_number<br />    \| count by serial\_number<br />    \| compose serial\_number<br />]<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as event\_time<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by event\_time, event\_name, event\_type, serial\_number, applicationName, email<br />\| fields -\_count<br />\| sort by event\_time|
|Google Workspace|Google Workspace Activity from Compromised Devices|Logs|Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}} <br />\| json "actor", "events", "id" nodrop<br />\| parse regex field=events "\\"type\\":\\"(?\<event\_type\>[^\\"]+)\\",\\"name\\":\\"(?\<event\_name\>[^\\"]+)\\"" multi<br />\| parse regex field=events "\\"DEVICE\_SERIAL\_NUMBER\\",\\"value\\":\\"(?\<serial\_number\>[^\\"]+)\\"" multi<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />    \| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />    \| where type = "Device compromised"<br />    \| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />    \| json field=device\_info "serialNumber" as serial\_number<br />    \| count by serial\_number<br />    \| compose serial\_number<br />]<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as event\_time<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by event\_time, event\_name, event\_type, serial\_number, applicationName, email<br />\| fields -\_count<br />\| sort by event\_time|
|Google Workspace|Google Workspace Apps Accessed by Compromised Users|Logs|Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}} <br />\| json "actor", "events", "id" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"  <br /> \| count by email<br /> \| compose email  <br />]<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email, applicationName<br />\| transpose row email column applicationName|
|Google Workspace|Google Workspace Apps Accessed by Compromised Users|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}} <br />\| json "actor", "events", "id" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"  <br /> \| count by email<br /> \| compose email  <br />]<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email, applicationName<br />\| transpose row email column applicationName|
|Google Workspace|Google Workspace Apps Accessed from Compromised Devices|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}} <br />\| json "actor", "events", "id" nodrop<br />\| parse regex field=events "\\"type\\":\\"(?\<event\_type\>[^\\"]+)\\",\\"name\\":\\"(?\<event\_name\>[^\\"]+)\\"" multi<br />\| parse regex field=events "\\"DEVICE\_SERIAL\_NUMBER\\",\\"value\\":\\"(?\<serial\_number\>[^\\"]+)\\"" multi<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />    \| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />    \| where type = "Device compromised"<br />    \| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />    \| json field=device\_info "serialNumber" as serial\_number<br />    \| count by serial\_number<br />    \| compose serial\_number<br />]<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by serial\_number, applicationName<br />\| transpose row serial\_number column applicationName|
|Google Workspace|Google Workspace Apps Accessed from Compromised Devices|Logs|Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}} <br />\| json "actor", "events", "id" nodrop<br />\| parse regex field=events "\\"type\\":\\"(?\<event\_type\>[^\\"]+)\\",\\"name\\":\\"(?\<event\_name\>[^\\"]+)\\"" multi<br />\| parse regex field=events "\\"DEVICE\_SERIAL\_NUMBER\\",\\"value\\":\\"(?\<serial\_number\>[^\\"]+)\\"" multi<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />    \| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />    \| where type = "Device compromised"<br />    \| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />    \| json field=device\_info "serialNumber" as serial\_number<br />    \| count by serial\_number<br />    \| compose serial\_number<br />]<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by serial\_number, applicationName<br />\| transpose row serial\_number column applicationName|
|Google Workspace|Groups - Users Added or Removed|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL AND (ADD\_GROUP\_MEMBER OR REMOVE\_GROUP\_MEMBER) "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count by user\_email, admin\_action, group\_email, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|Google Workspace|Groups - Users Added or Removed|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL AND (ADD\_GROUP\_MEMBER OR REMOVE\_GROUP\_MEMBER) "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count by user\_email, admin\_action, group\_email, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|Google Workspace|Identity Alerts by User|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  email "Google identity"<br />\| json "alertId","customerId","source","type","data"<br />\| where source = "Google identity"<br />\| json auto field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\| count by user,type<br />\| transpose row user column type|
|Google Workspace|Identity Alerts by User|Logs|Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  email "Google identity"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Google identity"<br />\| json field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\|where if ("{{email}}" = "\*", true, user matches "{{email}}")<br />\|count by user,type<br />\| transpose row user column type|
|Google Workspace|Identity Alerts by User|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  email "Google identity"<br />\| json "alertId","customerId","source","type","data"<br />\| where source = "Google identity"<br />\| json auto field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\| count by user,type<br />\| transpose row user column type|
|Google Workspace|Identity Alerts by User|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  email "Google identity"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Google identity"<br />\| json field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\|where if ("{{email}}" = "\*", true, user matches "{{email}}")<br />\|count by user,type<br />\| transpose row user column type|
|Google Workspace|Login Activity by Location|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\| count by ipAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ipAddress<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort by \_count|
|Google Workspace|Login Activity by Location|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\| count by ipAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ipAddress<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort by \_count|
|Google Workspace|Login Activity Over Time|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventName, \_timeslice<br />\| transpose row \_timeslice column eventName|
|Google Workspace|Login Activity Over Time|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventName, \_timeslice<br />\| transpose row \_timeslice column eventName|
|Google Workspace|Login Failures - Outlier|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{loginType}}" = "\*", true, loginType matches "{{loginType}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as login\_failures by \_timeslice<br />\| fillmissing timeslice(1h) with 0 for login\_failures<br />\| outlier login\_failures window=5, threshold=3|
|Google Workspace|Login Failures - Outlier|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{loginType}}" = "\*", true, loginType matches "{{loginType}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as login\_failures by \_timeslice<br />\| fillmissing timeslice(1h) with 0 for login\_failures<br />\| outlier login\_failures window=5, threshold=3|
|Google Workspace|Login Failures by Type|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{loginType}}" = "\*", true, loginType matches "{{loginType}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, login\_failure\_type<br />\| sort by email asc<br />\| fields -eventCount|
|Google Workspace|Login Failures by Type|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{loginType}}" = "\*", true, loginType matches "{{loginType}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, login\_failure\_type<br />\| sort by email asc<br />\| fields -eventCount|
|Google Workspace|Login Failures by User|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| sort by eventCount desc, email asc|
|Google Workspace|Login Failures by User|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| sort by eventCount desc, email asc|
|Google Workspace|Login Failures by User, IP Address|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{loginType}}" = "\*", true, loginType matches "{{loginType}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, ipAddress|
|Google Workspace|Login Failures by User, IP Address|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{loginType}}" = "\*", true, loginType matches "{{loginType}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, ipAddress|
|Google Workspace|Logins from Multiple IPs|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by email, ipAddress<br />\| join (sum(\_count) by ipAddress, email) as t1, (count\_distinct(ipAddress) by email) as t2 on t1.email=t2.email <br />\| where t2\_\_count\_distinct \> 1 <br />\| t1\_email as email<br />\| t1\_ipAddress as ipAddress<br />\| t1\_\_sum as loginCount<br />\| sort by email asc, t2\_\_count\_distinct, loginCount<br />\| fields email, ipAddress, loginCount|
|Google Workspace|Logins from Multiple IPs|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, ipAddress<br />\| join (sum(eventCount) as loginCount by ipAddress, email) as t1, (count\_distinct(ipAddress) by email) as t2 on t1.email=t2.email <br />\| where t2\_\_count\_distinct \> 1 <br />\| t1\_email as email<br />\| t1\_ipAddress as ipAddress<br />\| count as DistinctIPs by email<br />\| sort by DistinctIPs desc, email asc|
|Google Workspace|Logins from Multiple IPs|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, ipAddress<br />\| join (sum(eventCount) as loginCount by ipAddress, email) as t1, (count\_distinct(ipAddress) by email) as t2 on t1.email=t2.email <br />\| where t2\_\_count\_distinct \> 1 <br />\| t1\_email as email<br />\| t1\_ipAddress as ipAddress<br />\| count as DistinctIPs by email<br />\| sort by DistinctIPs desc, email asc|
|Google Workspace|Logins from Multiple IPs|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, ipAddress<br />\| join (sum(eventCount) as loginCount by ipAddress, email) as t1, (count\_distinct(ipAddress) by email) as t2 on t1.email=t2.email <br />\| where t2\_\_count\_distinct \> 1 <br />\| t1\_email as email<br />\| t1\_ipAddress as ipAddress<br />\| count as DistinctIPs, sum(t1\_loginCount) as LoginCount by email<br />\| sort by DistinctIPs desc, LoginCount, email asc|
|Google Workspace|Logins from Multiple IPs|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by email, ipAddress<br />\| join (sum(\_count) by ipAddress, email) as t1, (count\_distinct(ipAddress) by email) as t2 on t1.email=t2.email <br />\| where t2\_\_count\_distinct \> 1 <br />\| t1\_email as email<br />\| t1\_ipAddress as ipAddress<br />\| t1\_\_sum as loginCount<br />\| sort by email asc, t2\_\_count\_distinct, loginCount<br />\| fields email, ipAddress, loginCount|
|Google Workspace|Logins from Multiple IPs|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, ipAddress<br />\| join (sum(eventCount) as loginCount by ipAddress, email) as t1, (count\_distinct(ipAddress) by email) as t2 on t1.email=t2.email <br />\| where t2\_\_count\_distinct \> 1 <br />\| t1\_email as email<br />\| t1\_ipAddress as ipAddress<br />\| count as DistinctIPs, sum(t1\_loginCount) as LoginCount by email<br />\| sort by DistinctIPs desc, LoginCount, email asc|
|Google Workspace|Malicious Email from Whitelisted Domain/IP|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}    "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "Misconfigured whitelist"<br />\| json field=data "messages[\*].recipient", "messages[\*].date", "maliciousEntity.fromHeader", "sourceIP"  as victims, message\_dates, attacker, malicious\_ip nodrop<br />\| parse regex field=message\_dates "\\"(?\<message\_date\>[^\\"]+)\\"" multi<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker, malicious\_ip<br />\| sort by \_count|
|Google Workspace|Malicious Email from Whitelisted Domain/IP|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}    "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "Misconfigured whitelist"<br />\| json field=data "messages[\*].recipient", "messages[\*].date", "maliciousEntity.fromHeader", "sourceIP"  as victims, message\_dates, attacker, malicious\_ip nodrop<br />\| parse regex field=message\_dates "\\"(?\<message\_date\>[^\\"]+)\\"" multi<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker, malicious\_ip<br />\| sort by \_count|
|Google Workspace|Most Active IPs|Logs|Installed Apps/Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName= "drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by ipAddress<br />\| top 10 ipAddress by eventCount|
|Google Workspace|Most Active IPs|Logs|Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName= "drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by ipAddress<br />\| top 10 ipAddress by eventCount|
|Google Workspace|Most Active Users|Logs|Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName= "drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Most Active Users|Logs|Installed Apps/Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName= "drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Primary Action Count|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\""<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex  "\\{\\n\\s+\\"type\\": \\"(?\<eventType\>\\w+)\\",\\n\\s+\\"name\\": \\"(?\<eventName\>\\w+)\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n" multi<br />\| where applicationName="drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventType, eventName<br />\| transpose row eventType column eventName|
|Google Workspace|Primary Action Count|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\""<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex  "\\{\\n\\s+\\"type\\": \\"(?\<eventType\>\\w+)\\",\\n\\s+\\"name\\": \\"(?\<eventName\>\\w+)\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n" multi<br />\| where applicationName="drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventType, eventName<br />\| transpose row eventType column eventName|
|Google Workspace|Recent Alerts|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data", "securityInvestigationToolLink" as alert\_id, customer\_id, source, type, data, investigation\_url nodrop<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id, customer\_id, source, type, data, investigation\_url, \_messageTime<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| if(isNull(investigation\_url), "https://admin.google.com/ac/ic/investigate", concat("https://",investigation\_url)) as investigation\_url<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| sort by \_messageTime<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields create\_time, customer\_id, alert\_id, source, type, investigation\_url, data<br />\| fields -\_messageTime|
|Google Workspace|Recent Alerts|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data", "securityInvestigationToolLink" as alert\_id, customer\_id, source, type, data, investigation\_url nodrop<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id, customer\_id, source, type, data, investigation\_url, \_messageTime<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| if(isNull(investigation\_url), "https://admin.google.com/ac/ic/investigate", concat("https://",investigation\_url)) as investigation\_url<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| sort by \_messageTime<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields create\_time, customer\_id, alert\_id, source, type, investigation\_url, data<br />\| fields -\_messageTime|
|Google Workspace|Recent Attacks by Message Date|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*]", "maliciousEntity.fromHeader"  as messages, attacker<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| parse regex field=messages "(?\<message\_info\>\\{[^\\{]+\\})" multi <br />\| json field=message\_info "date", "subjectText", "recipient", "messageBodySnippet" as message\_date, subject, victim, message\_body\_snippet<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{subject}}" = "\*", true, subject matches "{{subject}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by message\_date, alert\_id, attacker, victim, type, subject, message\_body\_snippet<br />\| sort by message\_date <br />\| fields -\_count|
|Google Workspace|Recent Attacks by Message Date|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*]", "maliciousEntity.fromHeader"  as messages, attacker<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| parse regex field=messages "(?\<message\_info\>\\{[^\\{]+\\})" multi <br />\| json field=message\_info "date", "subjectText", "recipient", "messageBodySnippet" as message\_date, subject, victim, message\_body\_snippet<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{subject}}" = "\*", true, subject matches "{{subject}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by message\_date, alert\_id, attacker, victim, type, subject, message\_body\_snippet<br />\| sort by message\_date <br />\| fields -\_count|
|Google Workspace|Recent Customer Takeout Initiated|Logs|Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}    "Customer takeout initiated"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "Customer takeout initiated"<br />\| json field=data "email" as actor<br />\|count by alert\_id, actor, \_messageTime<br />\| sort by \_messageTime<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| formatDate(fromMillis(toLong(\_messageTime)),"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields -\_messageTime|
|Google Workspace|Recent Customer Takeout Initiated|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}    "Customer takeout initiated"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "Customer takeout initiated"<br />\| json field=data "email" as actor<br />\|count by alert\_id, actor, \_messageTime<br />\| sort by \_messageTime<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| formatDate(fromMillis(toLong(\_messageTime)),"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields -\_messageTime|
|Google Workspace|Recent Devices Compromised|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType", "resourceId", "iosVendorId", "deviceCompromisedState"as device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state nodrop<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\|count by alert\_id, device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state, create\_time<br />\| sort by create\_time<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| fields -\_count|
|Google Workspace|Recent Devices Compromised|Logs|Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType", "resourceId", "iosVendorId", "deviceCompromisedState"as device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state nodrop<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\|count by alert\_id, device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state, create\_time<br />\| sort by create\_time<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| fields -\_count|
|Google Workspace|Recent Google Operations Alerts|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Google Operations"<br />\| json "alertId","customerId","source","type","data", "createTime" as alert\_id, customer\_id, source, type, data, create\_time<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| json field=data "description","affectedUserEmails" <br />\| parse field=affectedUserEmails "[\*]" as affectedUserEmails<br />\|count by alert\_id, description, affectedUserEmails, create\_time<br />\| fields -\_count<br />\| order by create\_time|
|Google Workspace|Recent Google Operations Alerts|Logs|Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Google Operations"<br />\| json "alertId","customerId","source","type","data", "createTime" as alert\_id, customer\_id, source, type, data, create\_time<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| json field=data "description","affectedUserEmails" <br />\| parse field=affectedUserEmails "[\*]" as affectedUserEmails<br />\|count by alert\_id, description, affectedUserEmails, create\_time<br />\| fields -\_count<br />\| order by create\_time|
|Google Workspace|Recent Government-Backed Attack Warnings|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}    "Government attack warning"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "Government attack warning"<br />\| json field=data "email" as attacker<br />\|count by alert\_id, attacker, \_messageTime<br />\| sort by \_messageTime<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| formatDate(fromMillis(toLong(\_messageTime)),"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields -\_messageTime|
|Google Workspace|Recent Government-Backed Attack Warnings|Logs|Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}    "Government attack warning"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "Government attack warning"<br />\| json field=data "email" as attacker<br />\|count by alert\_id, attacker, \_messageTime<br />\| sort by \_messageTime<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| formatDate(fromMillis(toLong(\_messageTime)),"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields -\_messageTime|
|Google Workspace|Recent Suspicious Activity|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Suspicious activity"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Suspicious activity"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "serialNumber", "deviceId", "deviceType", "deviceModel", "iosVendorId", "deviceProperty", "oldValue", "newValue" as serial\_number, device\_id, device\_type, device\_model, ios\_vendor\_id, device\_property, old\_value, new\_value nodrop<br />\|count by alert\_id, serial\_number, device\_id, device\_type, device\_model, ios\_vendor\_id, device\_property, old\_value, new\_value, create\_time<br />\| sort by create\_time<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| fields -\_count|
|Google Workspace|Recent Suspicious Activity|Logs|Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Suspicious activity"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Suspicious activity"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "serialNumber", "deviceId", "deviceType", "deviceModel", "iosVendorId", "deviceProperty", "oldValue", "newValue" as serial\_number, device\_id, device\_type, device\_model, ios\_vendor\_id, device\_property, old\_value, new\_value nodrop<br />\|count by alert\_id, serial\_number, device\_id, device\_type, device\_model, ios\_vendor\_id, device\_property, old\_value, new\_value, create\_time<br />\| sort by create\_time<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| fields -\_count|
|Google Workspace|Recent Uploads by Title|Logs|Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"type\\": \\"access\\"" "\\"name\\": \\"upload\\""<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| parse regex "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]+)\\"" nodrop // short cut here since doc\_title is the same for all event objects<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName="drive" and eventType="access" and eventName="upload"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title<br />\| sort  by \_count desc|
|Google Workspace|Recent Uploads by Title|Logs|Installed Apps/Google Workspace/Google Workspace - Drive|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"type\\": \\"access\\"" "\\"name\\": \\"upload\\""<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| parse regex "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]+)\\"" nodrop // short cut here since doc\_title is the same for all event objects<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName="drive" and eventType="access" and eventName="upload"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title<br />\| sort  by \_count desc|
|Google Workspace|Serious Alerts|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| where type in ("Government attack warning","Device compromised","Leaked password")<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id<br />\| count|
|Google Workspace|Serious Alerts|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| where type in ("Government attack warning","Device compromised","Leaked password")<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id<br />\| count|
|Google Workspace|Successful Logins|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "login\_success" ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="login" and eventType = "login" and eventName="login\_success"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by \_timeslice|
|Google Workspace|Successful Logins|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "login\_success" ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="login" and eventType = "login" and eventName="login\_success"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by \_timeslice|
|Google Workspace|Successful Logins by Compromised Users|Logs|Installed Apps/Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "login\_success" ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="login" and eventType = "login" and eventName="login\_success"<br />\| json field=actor "email", "profileId"<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"    <br /> \| count by email<br /> \| compose email  <br />]<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as event\_time<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}")<br />\|count by event\_time, eventName, eventType, applicationName, email<br />\| fields -\_count<br />\| sort by event\_time|
|Google Workspace|Successful Logins by Compromised Users|Logs|Google Workspace/Google Workspace - Login|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "login\_success" ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="login" and eventType = "login" and eventName="login\_success"<br />\| json field=actor "email", "profileId"<br />\| where [subquery:\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"    <br /> \| count by email<br /> \| compose email  <br />]<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as event\_time<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}")<br />\|count by event\_time, eventName, eventType, applicationName, email<br />\| fields -\_count<br />\| sort by event\_time|
|Google Workspace|Suspended Users|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning suspended<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "User\*suspended\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email<br />\| fields -\_count|
|Google Workspace|Suspended Users|Logs|Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning suspended<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "User\*suspended\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email<br />\| fields -\_count|
|Google Workspace|Suspicious Activity by Device Type|Logs|Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Suspicious activity"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Suspicious activity"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "serialNumber", "deviceId", "deviceType", "deviceModel", "iosVendorId", "deviceProperty", "oldValue", "newValue" as serial\_number, device\_id, device\_type, device\_model, ios\_vendor\_id, device\_property, old\_value, new\_value nodrop<br />\|count by device\_type<br />\| sort by \_count|
|Google Workspace|Suspicious Activity by Device Type|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Suspicious activity"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Suspicious activity"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "serialNumber", "deviceId", "deviceType", "deviceModel", "iosVendorId", "deviceProperty", "oldValue", "newValue" as serial\_number, device\_id, device\_type, device\_model, ios\_vendor\_id, device\_property, old\_value, new\_value nodrop<br />\|count by device\_type<br />\| sort by \_count|
|Google Workspace|Suspicious Emails|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning suspicious<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "Suspicious\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by email<br />\| fields -\_count|
|Google Workspace|Suspicious Emails|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning suspicious<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "Suspicious\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by email<br />\| fields -\_count|
|Google Workspace|Suspicious IP Addresses|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning suspicious<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email","loginDetails.ipAddress" as email, src\_ip<br />\| where type matches "Suspicious\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by src\_ip<br />\| sort by \_count<br />\| fields -\_count|
|Google Workspace|Suspicious IP Addresses|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning suspicious<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email","loginDetails.ipAddress" as email, src\_ip<br />\| where type matches "Suspicious\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by src\_ip<br />\| sort by \_count<br />\| fields -\_count|
|Google Workspace|Suspicious Logins|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning login<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email","loginDetails.ipAddress" as email, src\_ip<br />\| where type matches "Suspicious\*login\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email, src\_ip<br />\| sort by \_count|
|Google Workspace|Suspicious Logins|Logs|Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning login<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email","loginDetails.ipAddress" as email, src\_ip<br />\| where type matches "Suspicious\*login\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email, src\_ip<br />\| sort by \_count|
|Google Workspace|Threat Intel by Attachments|Logs|Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Gmail phishing"<br />\| json "alertId","customerId", "source", "type", "data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].attachmentsSha256Hash" as  attachment\_hashes<br />\| parse regex field=attachment\_hashes "\\"(?\<attachment\_hash\>[^\\"]+)\\"" multi<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=attachment\_hash<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="hash\_sha256" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by attachment\_hash, malicious\_confidence, Actor, \_source, label\_name<br />\| sort by \_count|
|Google Workspace|Threat Intel by Attachments|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Gmail phishing"<br />\| json "alertId","customerId", "source", "type", "data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].attachmentsSha256Hash" as  attachment\_hashes<br />\| parse regex field=attachment\_hashes "\\"(?\<attachment\_hash\>[^\\"]+)\\"" multi<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=attachment\_hash<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="hash\_sha256" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by attachment\_hash, malicious\_confidence, Actor, \_source, label\_name<br />\| sort by \_count|
|Google Workspace|Threat Intel by Domain|Logs|Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Gmail phishing"<br />\| json "alertId","customerId", "source", "type", "data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| parse regex field=data "\\"fromHeader\\":\\"(?\<sender\_email\>[^\\"]\*)\\""<br />\| parse field=sender\_email "\*@\*" as user\_name, domain<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="domain" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by domain, malicious\_confidence, Actor,  \_source, label\_name<br />\| sort by \_count|
|Google Workspace|Threat Intel by Domain|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Gmail phishing"<br />\| json "alertId","customerId", "source", "type", "data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| parse regex field=data "\\"fromHeader\\":\\"(?\<sender\_email\>[^\\"]\*)\\""<br />\| parse field=sender\_email "\*@\*" as user\_name, domain<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=domain<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="domain" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by domain, malicious\_confidence, Actor,  \_source, label\_name<br />\| sort by \_count|
|Google Workspace|Threat Intel by sender email|Logs|Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Gmail phishing"<br />\| json "alertId","customerId", "source", "type", "data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| parse regex field=data "\\"fromHeader\\":\\"(?\<sender\_email\>[^\\"]\*)\\""<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=sender\_email<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by sender\_email, malicious\_confidence, Actor,  \_source, label\_name<br />\| sort by \_count|
|Google Workspace|Threat Intel by sender email|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Investigations|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  "Gmail phishing"<br />\| json "alertId","customerId", "source", "type", "data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| parse regex field=data "\\"fromHeader\\":\\"(?\<sender\_email\>[^\\"]\*)\\""<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=sender\_email<br />\| json field=raw "labels[\*].name" as label\_name<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="email\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by sender\_email, malicious\_confidence, Actor,  \_source, label\_name<br />\| sort by \_count|
|Google Workspace|Top 10 Attackers by Distinct Victims|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count\_distinct(victim) by attacker<br />\| top 10 attacker by \_count\_distinct|
|Google Workspace|Top 10 Attackers by Distinct Victims|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "maliciousEntity.fromHeader"  as victims, attacker<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count\_distinct(victim) by attacker<br />\| top 10 attacker by \_count\_distinct|
|Google Workspace|Top 10 Attackers by Message Count|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   messageId "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "messages[\*].messageId", "maliciousEntity.fromHeader"  as victims, message\_ids, attacker<br />\| parse regex field=message\_ids "\\"(?\<message\_id\>[^\\"]+)\\"" multi<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count(message\_id) by attacker<br />\| top 10 attacker by \_count|
|Google Workspace|Top 10 Attackers by Message Count|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   messageId "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Gmail phishing"<br />\| json field=data "messages[\*].recipient", "messages[\*].messageId", "maliciousEntity.fromHeader"  as victims, message\_ids, attacker<br />\| parse regex field=message\_ids "\\"(?\<message\_id\>[^\\"]+)\\"" multi<br />\| parse regex field=victims "\\"(?\<victim\>[^\\"]+)\\"" multi<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count(message\_id) by attacker<br />\| top 10 attacker by \_count|
|Google Workspace|Top 10 Suspicious Messages Reported|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "Suspicious message reported"<br />\| json field=data "messages[\*]", "maliciousEntity.fromHeader"  as messages, attacker<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| parse regex field=messages "(?\<message\_info\>\\{[^\\{]+\\})" multi <br />\| json field=message\_info "date", "subjectText", "recipient", "messageBodySnippet" as message\_date, subject, victim, message\_body\_snippet<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{subject}}" = "\*", true, subject matches "{{subject}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker, type, subject, message\_body\_snippet<br />\| top 10 attacker, type, subject, message\_body\_snippet by \_count|
|Google Workspace|Top 10 Suspicious Messages Reported|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "Suspicious message reported"<br />\| json field=data "messages[\*]", "maliciousEntity.fromHeader"  as messages, attacker<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| parse regex field=messages "(?\<message\_info\>\\{[^\\{]+\\})" multi <br />\| json field=message\_info "date", "subjectText", "recipient", "messageBodySnippet" as message\_date, subject, victim, message\_body\_snippet<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{subject}}" = "\*", true, subject matches "{{subject}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker, type, subject, message\_body\_snippet<br />\| top 10 attacker, type, subject, message\_body\_snippet by \_count|
|Google Workspace|Top 10 User Reported Phishing Messages|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "User reported phishing"<br />\| json field=data "messages[\*]", "maliciousEntity.fromHeader"  as messages, attacker<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| parse regex field=messages "(?\<message\_info\>\\{[^\\{]+\\})" multi <br />\| json field=message\_info "date", "subjectText", "recipient", "messageBodySnippet" as message\_date, subject, victim, message\_body\_snippet<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{subject}}" = "\*", true, subject matches "{{subject}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker, type, subject, message\_body\_snippet<br />\| top 10 attacker, type, subject, message\_body\_snippet by \_count|
|Google Workspace|Top 10 User Reported Phishing Messages|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "User reported phishing"<br />\| json field=data "messages[\*]", "maliciousEntity.fromHeader"  as messages, attacker<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| parse regex field=messages "(?\<message\_info\>\\{[^\\{]+\\})" multi <br />\| json field=message\_info "date", "subjectText", "recipient", "messageBodySnippet" as message\_date, subject, victim, message\_body\_snippet<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{subject}}" = "\*", true, subject matches "{{subject}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker, type, subject, message\_body\_snippet<br />\| top 10 attacker, type, subject, message\_body\_snippet by \_count|
|Google Workspace|Top 10 User Reported Spam Spike Messages|Logs|Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "User reported spam spike"<br />\| json field=data "messages[\*]", "maliciousEntity.fromHeader"  as messages, attacker<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| parse regex field=messages "(?\<message\_info\>\\{[^\\{]+\\})" multi <br />\| json field=message\_info "date", "subjectText", "recipient", "messageBodySnippet" as message\_date, subject, victim, message\_body\_snippet<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{subject}}" = "\*", true, subject matches "{{subject}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker, type, subject, message\_body\_snippet<br />\| top 10 attacker, type, subject, message\_body\_snippet by \_count|
|Google Workspace|Top 10 User Reported Spam Spike Messages|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Gmail Phishing|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   recipient "Gmail phishing"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where type = "User reported spam spike"<br />\| json field=data "messages[\*]", "maliciousEntity.fromHeader"  as messages, attacker<br />\| toURL(concat("https://admin.google.com/ac/ac/alert/details?alertId=", alert\_id), alert\_id) as alert\_id<br />\| parse regex field=messages "(?\<message\_info\>\\{[^\\{]+\\})" multi <br />\| json field=message\_info "date", "subjectText", "recipient", "messageBodySnippet" as message\_date, subject, victim, message\_body\_snippet<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{subject}}" = "\*", true, subject matches "{{subject}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{attacker}}" = "\*", true, attacker matches "{{attacker}}") AND if ("{{victim}}" = "\*", true, victim matches "{{victim}}")<br />\|count by attacker, type, subject, message\_body\_snippet<br />\| top 10 attacker, type, subject, message\_body\_snippet by \_count|
|Google Workspace|Top Admin Action|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count as eventCount by admin\_action<br />\| sort by eventCount desc, admin\_action asc|
|Google Workspace|Top Admin Action|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count as eventCount by admin\_action<br />\| sort by eventCount desc, admin\_action asc|
|Google Workspace|Top Apps|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"token\\""<br />\| json "actor", "id", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop <br />\| where applicationName="token"<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*?)\\"" nodrop<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}")<br />\|count as eventCount by app\_name<br />\| top 10 app\_name by eventCount, app\_name asc|
|Google Workspace|Top Apps|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"token\\""<br />\| json "actor", "id", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop <br />\| where applicationName="token"<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*?)\\"" nodrop<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}")<br />\|count as eventCount by app\_name<br />\| top 10 app\_name by eventCount, app\_name asc|
|Google Workspace|Top Event Name by Event Type|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  events type name<br />\| json "actor", "ipAddress", "events", "id" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email", "profileId"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventType, eventName <br />\| topk(5,eventCount) by eventType<br />\| sort by eventType asc|
|Google Workspace|Top Event Name by Event Type|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  events type name<br />\| json "actor", "ipAddress", "events", "id" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email", "profileId"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventType, eventName <br />\| topk(5,eventCount) by eventType<br />\| sort by eventType asc|
|Google Workspace|Top Login Failure Reasons|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventName, login\_failure\_type, login\_type \| sort by eventCount, eventName, login\_failure\_type, login\_type|
|Google Workspace|Top Login Failure Reasons|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventName, login\_failure\_type, login\_type \| sort by eventCount, eventName, login\_failure\_type, login\_type|
|Google Workspace|Top Users Creating Contents|Logs|Installed Apps/Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"create\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="create"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Top Users Creating Contents|Logs|Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"create\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="create"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Top Users Downloading Contents|Logs|Installed Apps/Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"type\\": \\"access\\"" "\\"name\\": \\"download\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="download"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Top Users Downloading Contents|Logs|Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"type\\": \\"access\\"" "\\"name\\": \\"download\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="download"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Top Users Sharing Contents Outside of Organization|Logs|Installed Apps/Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName= "drive" and eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where email matches "\*john@lxrtcenter1.bigr.name\*" and !isEmpty(target\_user) and !(target\_user matches "\*acme.com\*")<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Top Users Sharing Contents Outside of Organization|Logs|Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)" multi<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName= "drive" and eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where email matches "\*john@lxrtcenter1.bigr.name\*" and !isEmpty(target\_user) and !(target\_user matches "\*acme.com\*")<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Top Users Uploading Contents|Logs|Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"upload\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="upload"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Top Users Uploading Contents|Logs|Installed Apps/Google Workspace/Google Workspace - Drive - User Activity|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"upload\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="upload"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|Google Workspace|Total Admins|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\| count as eventCount by admin\_email<br />\| count|
|Google Workspace|Total Admins|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\| count as eventCount by admin\_email<br />\| count|
|Google Workspace|Total Alerts|Logs|Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id<br />\| count|
|Google Workspace|Total Alerts|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id<br />\| count|
|Google Workspace|Total Alerts|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\|count by alert\_id<br />\| count|
|Google Workspace|Total Alerts|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\|count by alert\_id<br />\| count|
|Google Workspace|Total Devices Compromised|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType", "resourceId", "iosVendorId", "deviceCompromisedState"as device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state nodrop<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\|count by serial\_number<br />\| count|
|Google Workspace|Total Devices Compromised|Logs|Google Workspace/Google Workspace - Alert Center -  Other Alerts|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}   "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType", "resourceId", "iosVendorId", "deviceCompromisedState"as device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state nodrop<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\|count by serial\_number<br />\| count|
|Google Workspace|Total Login Failures|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount|
|Google Workspace|Total Login Failures|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount|
|Google Workspace|Total Suspended Users|Logs|Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning suspended<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "User\*suspended\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email<br />\| count|
|Google Workspace|Total Suspended Users|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning suspended<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "User\*suspended\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email<br />\| count|
|Google Workspace|Total Suspicious Logins|Logs|Installed Apps/Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning login<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "Suspicious\*login\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email<br />\| count|
|Google Workspace|Total Suspicious Logins|Logs|Google Workspace/Google Workspace - Alert Center - Google Identity|\_sourceCategory={{GoogleWorkspaceAlertsDataSource}}  AccountWarning login<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "Suspicious\*login\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}")<br />\|count by email<br />\| count|
|Google Workspace|Total Users Sharing Contents Outside of Organization|Logs|Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName= "drive" and eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where email matches "\*john@lxrtcenter1.bigr.name\*" and !isEmpty(target\_user) and !(target\_user matches "\*acme.com\*")<br />\| count as eventCount by email<br />\| count|
|Google Workspace|Total Users Sharing Contents Outside of Organization|Logs|Installed Apps/Google Workspace/Google Workspace - Overview|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName= "drive" and eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where email matches "\*john@lxrtcenter1.bigr.name\*" and !isEmpty(target\_user) and !(target\_user matches "\*acme.com\*")<br />\| count as eventCount by email<br />\| count|
|Google Workspace|User Actions Details|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count by user\_email, admin\_action, group\_email, recipient\_email, application\_name, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|Google Workspace|User Actions Details|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count by user\_email, admin\_action, group\_email, recipient\_email, application\_name, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|Google Workspace|User Content Transfered|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL CREATE\_DATA\_TRANSFER\_REQUEST "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by user\_email, admin\_action, recipient\_email, application\_name, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|Google Workspace|User Content Transfered|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL CREATE\_DATA\_TRANSFER\_REQUEST "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by user\_email, admin\_action, recipient\_email, application\_name, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|Google Workspace|Users - Created or Deleted|Logs|Installed Apps/Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL AND (CREATE\_USER OR DELETE\_USER) "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by user\_email, admin\_action, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|Google Workspace|Users - Created or Deleted|Logs|Google Workspace/Google Workspace - Admin|\_sourceCategory={{GoogleWorkspaceAuditLogsSource}}  USER\_EMAIL AND (CREATE\_USER OR DELETE\_USER) "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by user\_email, admin\_action, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|

