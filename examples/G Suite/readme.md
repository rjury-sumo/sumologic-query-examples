# G Suite

## Searches

### Log Searches

- **ACL Changes**: from Dashboard: G Suite/G Suite - Overview - New 
- **ACL Changes**: from Dashboard: G Suite/G Suite - Drive - New 
- **Action by Admin - Distribution**: from Dashboard: G Suite/G Suite - Admin - New 
- **Alerts by Administrators**: from Dashboard: G Suite/G Suite - Admin - New 
- **Alerts by Source IP**: from Dashboard: G Suite/G Suite - Alert Center - Google Identity - New 
- **App Token Actions**: from Dashboard: G Suite/G Suite - Admin - New 
- **App Token Count**: from Dashboard: G Suite/G Suite - Admin - New 
- **Compromised Credentials**: from Dashboard: G Suite/G Suite - Overview - New 
- **Compromised Devices**: from Dashboard: G Suite/G Suite - Overview - New 
- **Content sharing by Compromised Users**: from Dashboard: G Suite/G Suite - Drive - User Activity - New 
- **Document Downloads by Title**: from Dashboard: G Suite/G Suite - Drive - New 
- **Document Types**: from Dashboard: G Suite/G Suite - Drive - New 
- **Documents Being Shared**: from Dashboard: G Suite/G Suite - Drive - New 
- **Documents Shared Outside of Organization**: from Dashboard: G Suite/G Suite - Drive - New 
- **Documents Viewed - Top 10**: from Dashboard: G Suite/G Suite - Drive - New 
- **Drive Activity by Country Over Time**: from Dashboard: G Suite/G Suite - Drive - New 
- **Drive Activity by Location**: from Dashboard: G Suite/G Suite - Drive - New 
- **G Suite - Document Flow Diagram**: from Search: G Suite/G Suite - Document Flow Diagram 
- **G Suite - Excessive Login Failures by User**: from Search: G Suite/G Suite - Excessive Login Failures by User 
- **G Suite - Login Challenge for Suspicious Sign-ins**: from Search: G Suite/G Suite - Login Challenge for Suspicious Sign-ins 
- **G Suite - Password Changes Count**: from Search: G Suite/G Suite - Password Changes Count 
- **Google Activity by Source Location**: from Dashboard: G Suite/G Suite - Overview - New 
- **Groups - Users Added or Removed**: from Dashboard: G Suite/G Suite - Admin - New 
- **Identity Alerts by User**: from Dashboard: G Suite/G Suite - Alert Center - Google Identity - New 
- **Identity Alerts by User**: from Dashboard: G Suite/G Suite - Overview - New 
- **Login Failures by User**: from Dashboard: G Suite/G Suite - Overview - New 
- **Logins from Multiple IPs**: from Dashboard: G Suite/G Suite - Overview - New 
- **Logins from Multiple IPs**: from Dashboard: G Suite/G Suite - Overview - New 
- **Most Active IPs**: from Dashboard: G Suite/G Suite - Drive - User Activity - New 
- **Most Active Users**: from Dashboard: G Suite/G Suite - Drive - User Activity - New 
- **Primary Action Count**: from Dashboard: G Suite/G Suite - Drive - New 
- **Recent Uploads by Title**: from Dashboard: G Suite/G Suite - Drive - New 
- **Suspended Users**: from Dashboard: G Suite/G Suite - Alert Center - Google Identity - New 
- **Suspicious Logins**: from Dashboard: G Suite/G Suite - Alert Center - Google Identity - New 
- **Top Admin Action**: from Dashboard: G Suite/G Suite - Admin - New 
- **Top Apps**: from Dashboard: G Suite/G Suite - Overview - New 
- **Top Event Name by Event Type**: from Dashboard: G Suite/G Suite - Overview - New 
- **Top Login Failure Reasons**: from Dashboard: G Suite/G Suite - Overview - New 
- **Top Users Creating Contents**: from Dashboard: G Suite/G Suite - Drive - User Activity - New 
- **Top Users Downloading Contents**: from Dashboard: G Suite/G Suite - Drive - User Activity - New 
- **Top Users Sharing Contents Outside of Organization**: from Dashboard: G Suite/G Suite - Drive - User Activity - New 
- **Top Users Uploading Contents**: from Dashboard: G Suite/G Suite - Drive - User Activity - New 
- **Total Admins**: from Dashboard: G Suite/G Suite - Overview - New 
- **Total Alerts**: from Dashboard: G Suite/G Suite - Overview - New 
- **Total Login Failures**: from Dashboard: G Suite/G Suite - Overview - New 
- **Total Suspended Users**: from Dashboard: G Suite/G Suite - Alert Center - Google Identity - New 
- **Total Suspicious Logins**: from Dashboard: G Suite/G Suite - Alert Center - Google Identity - New 
- **Total Users Sharing Contents Outside of Organization**: from Dashboard: G Suite/G Suite - Overview - New 
- **User Actions Details**: from Dashboard: G Suite/G Suite - Admin - New 
- **User Content Transfered**: from Dashboard: G Suite/G Suite - Admin - New 
- **Users - Created or Deleted**: from Dashboard: G Suite/G Suite - Admin - New

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|G Suite|ACL Changes|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps acl\_change "\\"applicationName\\": \\"drive\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| timeslice 1d<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventName, \_timeslice<br />\| transpose row \_timeslice column eventName|
|G Suite|ACL Changes|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"old\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<old\_value\>[^\\]]\*)\\]\\n" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| replace (old\_value, "\\"", "") as old\_value<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{target\_user}}" = "\*", true, target\_user matches "{{target\_user}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventName, doc\_title, old\_value, new\_value, target\_user, email<br />\| fields -\_count|
|G Suite|Action by Admin - Distribution|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count as eventCount by admin\_email<br />\| sort by eventCount, admin\_email asc|
|G Suite|Alerts by Administrators|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/alerts<br />\| json "alertId","customerId","source","type","data", "securityInvestigationToolLink" as alert\_id, customer\_id, source, type, data, investigation\_url nodrop<br />\| json field=data "email" as admin\_email<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by admin\_email, alert\_id, customer\_id, source, type, data, investigation\_url, \_messageTime<br />\| where [subquery:\_sourceCategory = Labs/gsuite/apps "admin"<br /> \| json "actor", "id" nodrop<br /> \| json field=id "applicationName"   <br /> \| where applicationName="admin"<br /> \| json field=actor "email" as admin\_email<br /> \| count by admin\_email<br /> \| compose admin\_email  <br />]<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| if(isNull(investigation\_url), "https://admin.google.com/ac/ic/investigate", concat("https://",investigation\_url)) as investigation\_url<br />\| sort by \_messageTime<br />\| formatDate(\_messageTime,"MM-dd-yyyy HH:mm:ss:SSS") as create\_time<br />\| fields -\_messageTime, \_count<br />\| fields create\_time, customer\_id, alert\_id, admin\_email, source, type, investigation\_url, data|
|G Suite|Alerts by Source IP|Logs|G Suite/G Suite - Alert Center - Google Identity - New|\_sourceCategory = Labs/gsuite/alerts email AccountWarning<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\| json field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\| lookup latitude, longitude, city,country\_name, region<br />  from geo://location on ip=src\_ip <br />\| where country\_name matches "{{country}}"<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by latitude,longitude, city, country\_name, region|
|G Suite|App Token Actions|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"token\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<token\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*)\\"\\}" nodrop<br />\| where applicationName="token"<br />\|where if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{token\_action}}" = "\*", true, token\_action matches "{{token\_action}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count as eventCount by token\_action<br />\| sort by eventCount, token\_action|
|G Suite|App Token Count|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"token\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<token\_action\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*?)\\"\\}" nodrop<br />\| where applicationName="token"<br />\|where if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{token\_action}}" = "\*", true, token\_action matches "{{token\_action}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count as eventCount by app\_name<br />\| sort by eventCount|
|G Suite|Compromised Credentials|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/alerts "Leaked password"<br />\| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br />\| where type="Leaked password"<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by email<br />\| count|
|G Suite|Compromised Devices|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/alerts  "Device compromised"<br />\| json "alertId","customerId","source","type","data.email", "data.events[\*]", "createTime" as alert\_id, customer\_id, source, type, email, events, create\_time<br />\| where type = "Device compromised"<br />\| parse regex field=events "(?\<device\_info\>\\{[^\\{]+\\})" multi<br />\| json field=device\_info "deviceId", "serialNumber", "deviceType", "resourceId", "iosVendorId", "deviceCompromisedState"as device\_id, serial\_number, device\_type, resource\_id, ios\_vendor\_id, compromised\_state nodrop<br />\| parse field=compromised\_state "\\u2018\*\\u2019" as compromised\_state<br />\| count by serial\_number<br />\| count|
|G Suite|Content sharing by Compromised Users|Logs|G Suite/G Suite - Drive - User Activity - New|\_sourceCategory = Labs/gsuite/apps "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email"<br />\| where [subquery:\_sourceCategory = Labs/gsuite/alerts "Leaked password"<br /> \| json "alertId","customerId","source","type","data", "data.email" as alert\_id, customer\_id, source, type, data, email<br /> \| where type="Leaked password"  <br /> \| count by email<br /> \| compose email  <br />]<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{target\_user}}" = "\*", true, target\_user matches "{{target\_user}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}")<br />\|count by eventName, doc\_title, new\_value, target\_user, email<br />\| fields -\_count|
|G Suite|Document Downloads by Title|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"download\\""<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]+)\\"" nodrop // short cut here since doc\_title is the same for all event objects<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName="drive" and eventName="download"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title<br />\| sort  by \_count desc|
|G Suite|Document Types|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_type\\",\\n\\s+\\"value\\": \\"(?\<doc\_type\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=doc\_title "[^\\?]+?\\.(?\<doc\_ext\>[a-zA-Z0-9]{2,4})\$"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title,doc\_type,doc\_ext<br />\| if(doc\_type="unknown",doc\_ext,doc\_type) as doc\_type<br />\| count\_distinct(doc\_title) by doc\_type<br />\| sort by \_count\_distinct desc|
|G Suite|Documents Being Shared|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people?with\* OR public\*) <br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop <br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\*" or new\_value matches "public\_\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{target\_user}}" = "\*", true, target\_user matches "{{target\_user}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title, new\_value<br />\| sort by doc\_title asc<br />\| fields -\_count|
|G Suite|Documents Shared Outside of Organization|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where eventType="acl\_change" and applicationName="drive"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where !(target\_user matches "\*acme.com\*") and !isEmpty(target\_user)<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{target\_user}}" = "\*", true, target\_user matches "{{target\_user}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventName, doc\_title, new\_value, target\_user, email<br />\| fields -\_count|
|G Suite|Documents Viewed - Top 10|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"type\\": \\"access\\"" "\\"applicationName\\": \\"drive\\""<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="view"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title, eventName<br />\| Top 10 doc\_title by \_count|
|G Suite|Drive Activity by Country Over Time|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where applicationName="drive" <br />\| timeslice 1h<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by \_timeslice, ipAddress<br />\| lookup latitude, longitude, country\_name from geo://location on ip = ipAddress<br />\| where !isEmpty(country\_name)<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \*|
|G Suite|Drive Activity by Location|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| where applicationName="drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by ipAddress<br />\| lookup latitude, longitude from geo://location on ip = ipAddress<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude<br />\| sort by \_count|
|G Suite|G Suite - Document Flow Diagram|Logs|G Suite/G Suite - Document Flow Diagram|\_sourceCategory = Labs/gsuite/apps "\\"type\\": \\"access\\"" "\\"applicationName\\": \\"drive\\""<br />// Add doc\_id, doc\_title, or email to first line to focus the search<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as drive\_action\_type,drive\_action\_name<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_id\\",\\n\\s+\\"value\\": \\"(?\<doc\_id\>[^\\"]\*)\\"" nodrop<br />\| where drive\_action\_type="access"<br />\| "" as \_raw<br />\| transaction on doc\_id with states create, upload, edit, view, rename, move, add\_to\_folder, remove\_from\_folder, trash, delete, untrash, download, preview, print in drive\_action\_name<br />results by flow<br />\| fromstate == "create" ? 1 : fromstate == "upload" ? 2 : fromstate == "edit" ? 3 : fromstate == "view" ? 4 : fromstate == "rename" ? 5 :  fromstate == "move" ? 6 : fromstate == "add\_to\_folder" ? 7 : fromstate == "remove\_from\_folder," ? 8 : fromstate == "trash" ? 9 : fromstate == "delete" ? 10 : fromstate == "untrash" ? 11 : fromstate == "download" ? 12 : fromstate == "preview" ? 13 :  fromstate == "print" ? 14 : 100 as order<br />\| count,  max(latency) by fromstate, tostate, order|
|G Suite|G Suite - Excessive Login Failures by User|Logs|G Suite/G Suite - Excessive Login Failures by User|\_sourceCategory = Labs/gsuite/apps (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\| count email, ipAddress<br />\| where \_count \> 3 // configure this value.<br />\| sort by \_count desc, ipaddress, email|
|G Suite|G Suite - Login Challenge for Suspicious Sign-ins|Logs|G Suite/G Suite - Login Challenge for Suspicious Sign-ins|\_sourceCategory = Labs/gsuite/apps ("login\_challenge" and "login\_challenge\_status") "\\"type\\": \\"login\\"" <br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<loginType\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\| count by email, loginType, login\_failure\_type, ipAddress<br />\| fields -\_count<br />\| sort by email asc|
|G Suite|G Suite - Password Changes Count|Logs|G Suite/G Suite - Password Changes Count|\_sourceCategory = Labs/gsuite/apps USER\_EMAIL CHANGE\_PASSWORD "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events", "ipAddress"<br />\| json field=id "applicationName"<br />\| where applicationName="admin"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\""  nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| count by user\_email, admin\_action, admin\_email, ipAddress<br />\| sort by user\_email asc|
|G Suite|Google Activity by Source Location|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps ipAddress<br />\| json "actor", "ipAddress", "events", "id" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by ipAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ipAddress<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort by \_count|
|G Suite|Groups - Users Added or Removed|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/apps USER\_EMAIL AND (ADD\_GROUP\_MEMBER OR REMOVE\_GROUP\_MEMBER) "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count by user\_email, admin\_action, group\_email, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|G Suite|Identity Alerts by User|Logs|G Suite/G Suite - Alert Center - Google Identity - New|\_sourceCategory = Labs/gsuite/alerts email "Google identity"<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source = "Google identity"<br />\| json field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by user,type<br />\| transpose row user column type|
|G Suite|Identity Alerts by User|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/alerts email "Google identity"<br />\| json "alertId","customerId","source","type","data"<br />\| where source = "Google identity"<br />\| json auto field=data "email","loginDetails.ipAddress" as user, src\_ip<br />\| count by user,type<br />\| transpose row user column type|
|G Suite|Login Failures by User|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}") AND if ("{{login\_failure\_type}}" = "\*", true, login\_failure\_type matches "{{login\_failure\_type}}")<br />\|count as eventCount by email<br />\| sort by eventCount desc, email asc|
|G Suite|Logins from Multiple IPs|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, ipAddress<br />\| join (sum(eventCount) as loginCount by ipAddress, email) as t1, (count\_distinct(ipAddress) by email) as t2 on t1.email=t2.email <br />\| where t2\_\_count\_distinct \> 1 <br />\| t1\_email as email<br />\| t1\_ipAddress as ipAddress<br />\| count as DistinctIPs, sum(t1\_loginCount) as LoginCount by email<br />\| sort by DistinctIPs desc, LoginCount, email asc|
|G Suite|Logins from Multiple IPs|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps ipAddress email login "\\"type\\": \\"login\\""<br />\| json "actor", "id", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where eventType="login" and applicationName="login"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email, ipAddress<br />\| join (sum(eventCount) as loginCount by ipAddress, email) as t1, (count\_distinct(ipAddress) by email) as t2 on t1.email=t2.email <br />\| where t2\_\_count\_distinct \> 1 <br />\| t1\_email as email<br />\| t1\_ipAddress as ipAddress<br />\| count as DistinctIPs by email<br />\| sort by DistinctIPs desc, email asc|
|G Suite|Most Active IPs|Logs|G Suite/G Suite - Drive - User Activity - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" ipAddress<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName= "drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by ipAddress<br />\| top 10 ipAddress by eventCount|
|G Suite|Most Active Users|Logs|G Suite/G Suite - Drive - User Activity - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" <br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName= "drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|G Suite|Primary Action Count|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\""<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=actor "email"<br />\| json field=id "applicationName"<br />\| parse regex  "\\{\\n\\s+\\"type\\": \\"(?\<eventType\>\\w+)\\",\\n\\s+\\"name\\": \\"(?\<eventName\>\\w+)\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n"<br />\| where applicationName="drive"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by eventType, eventName<br />\| transpose row eventType column eventName|
|G Suite|Recent Uploads by Title|Logs|G Suite/G Suite - Drive - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" "\\"type\\": \\"access\\"" "\\"name\\": \\"upload\\""<br />\| json "id", "actor", "ipAddress" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| parse regex "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]+)\\"" nodrop // short cut here since doc\_title is the same for all event objects<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName="drive" and eventType="access" and eventName="upload"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count by doc\_title<br />\| sort  by \_count desc|
|G Suite|Suspended Users|Logs|G Suite/G Suite - Alert Center - Google Identity - New|\_sourceCategory = Labs/gsuite/alerts AccountWarning suspended<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "User\*suspended\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by email<br />\| fields -\_count|
|G Suite|Suspicious Logins|Logs|G Suite/G Suite - Alert Center - Google Identity - New|\_sourceCategory = Labs/gsuite/alerts AccountWarning login<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email","loginDetails.ipAddress" as email, src\_ip<br />\| where type matches "Suspicious\*login\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by email, src\_ip<br />\| sort by \_count|
|G Suite|Top Admin Action|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/apps USER\_EMAIL "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count as eventCount by admin\_action<br />\| sort by eventCount desc, admin\_action asc|
|G Suite|Top Apps|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"token\\""<br />\| json "actor", "id", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop <br />\| where applicationName="token"<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"app\_name\\",\\"value\\":\\"(?\<app\_name\>.\*?)\\"" nodrop<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}")<br />\|count as eventCount by app\_name<br />\| top 10 app\_name by eventCount, app\_name asc|
|G Suite|Top Event Name by Event Type|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps events type name<br />\| json "actor", "ipAddress", "events", "id" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email", "profileId"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by eventType, eventName <br />\| topk(5,eventCount) by eventType<br />\| sort by eventType asc|
|G Suite|Top Login Failure Reasons|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}") AND if ("{{login\_failure\_type}}" = "\*", true, login\_failure\_type matches "{{login\_failure\_type}}")<br />\|count as eventCount by eventName, login\_failure\_type, login\_type \| sort by eventCount, eventName, login\_failure\_type, login\_type|
|G Suite|Top Users Creating Contents|Logs|G Suite/G Suite - Drive - User Activity - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"create\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="create"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|G Suite|Top Users Downloading Contents|Logs|G Suite/G Suite - Drive - User Activity - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" "\\"type\\": \\"access\\"" "\\"name\\": \\"download\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="download"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|G Suite|Top Users Sharing Contents Outside of Organization|Logs|G Suite/G Suite - Drive - User Activity - New|\_sourceCategory = Labs/gsuite/apps "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName= "drive" and eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where email matches "\*acme.com\*" and !isEmpty(target\_user) and !(target\_user matches "\*acme.com\*")<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{doc\_title}}" = "\*", true, doc\_title matches "{{doc\_title}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{target\_user}}" = "\*", true, target\_user matches "{{target\_user}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|G Suite|Top Users Uploading Contents|Logs|G Suite/G Suite - Drive - User Activity - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"drive\\"" "\\"name\\": \\"upload\\""<br />\| json "id", "ipAddress", "events", "actor" nodrop<br />\| json field=actor "email" <br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop<br />\| where applicationName="drive" and eventType="access" and eventName="upload"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}")<br />\|count as eventCount by email<br />\| top 10 email by eventCount|
|G Suite|Total Admins|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\| count as eventCount by admin\_email<br />\| count|
|G Suite|Total Alerts|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/alerts <br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| where source matches "{{source}}" and type matches "{{type}}"<br />\|where if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}")<br />\|count by alert\_id<br />\| count|
|G Suite|Total Login Failures|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps (("login\_failure" and "login\_failure\_type")  or ("login\_challenge" and "login\_challenge\_status")) "\\"type\\": \\"login\\""<br />\| json "id", "actor", "ipAddress", "events" nodrop<br />\| json field=actor "email", "profileId"<br />\| json field=id "applicationName"<br />\| json "events[0].type" as eventType nodrop \| json "events[0].name" as eventName nodrop \| json "events[0].parameters" as eventparameters nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_type\\",\\"value\\":\\"(?\<login\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_failure\_type\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| parse regex field=eventparameters "\\{\\"name\\":\\"login\_challenge\_status\\",\\"value\\":\\"(?\<login\_failure\_type\>.\*?)\\"\\}" nodrop<br />\| where applicationName="login" and eventType = "login" and eventName\<\>"login\_success"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{eventType}}" = "\*", true, eventType matches "{{eventType}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{eventName}}" = "\*", true, eventName matches "{{eventName}}") AND if ("{{ipAddress}}" = "\*", true, ipAddress matches "{{ipAddress}}") AND if ("{{login\_failure\_type}}" = "\*", true, login\_failure\_type matches "{{login\_failure\_type}}")<br />\|count as eventCount|
|G Suite|Total Suspended Users|Logs|G Suite/G Suite - Alert Center - Google Identity - New|\_sourceCategory = Labs/gsuite/alerts AccountWarning suspended<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "User\*suspended\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by email<br />\| count|
|G Suite|Total Suspicious Logins|Logs|G Suite/G Suite - Alert Center - Google Identity - New|\_sourceCategory = Labs/gsuite/alerts AccountWarning login<br />\| json "alertId","customerId","source","type","data" as alert\_id, customer\_id, source, type, data<br />\| json field=data "email" as email<br />\| where type matches "Suspicious\*login\*"<br />\|where if ("{{email}}" = "\*", true, email matches "{{email}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{source}}" = "\*", true, source matches "{{source}}")<br />\|count by email<br />\| count|
|G Suite|Total Users Sharing Contents Outside of Organization|Logs|G Suite/G Suite - Overview - New|\_sourceCategory = Labs/gsuite/apps "\\"type\\": \\"acl\_change\\"" "\\"applicationName\\": \\"drive\\"" (can\_view OR can\_edit OR people\_with\_link OR public\_on\_the\_web)<br />\| json "id", "ipAddress", "actor" nodrop<br />\| json field=id "applicationName"<br />\| json field=actor "email"<br />\| parse regex "(?\<p\_Event\>\\{\\n\\s+\\"type\\": \\"\\w+\\",\\n\\s+\\"name\\": \\"\\w+\\",\\n\\s+\\"parameters\\": \\[\\n\\s+\\{\\n\\s+\\"name\\": \\"primary\_event\\",\\n\\s+\\"boolValue\\": true\\n(?s).+?)(?=,\\n\\s+\\{\\n\\s+\\"type\\"\|\\n\\s+\\]\\n\\}\$)"<br />\| json field=p\_Event "type","name" as eventType, eventName<br />\| where applicationName= "drive" and eventType="acl\_change"<br />\| parse regex field=p\_Event "\\"name\\": \\"doc\_title\\",\\n\\s+\\"value\\": \\"(?\<doc\_title\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"target\_user\\",\\n\\s+\\"value\\": \\"(?\<target\_user\>[^\\"]\*)\\"" nodrop<br />\| parse regex field=p\_Event "\\"name\\": \\"new\_value\\",\\n\\s+\\"multiValue\\": \\[\\n\\s+(?\<new\_value\>[^\\]]\*?)\\]\\n" nodrop<br />\| replace (new\_value, "\\"", "") as new\_value<br />\| where new\_value matches "\*can\_view\*" or new\_value matches "\*can\_edit\*" or new\_value matches "people\_with\_link\*" or new\_value matches "public\_on\_the\_web\*"<br />// edit this line to match your domain<br />\| where email matches "\*acme.com\*" and !isEmpty(target\_user) and !(target\_user matches "\*acme.com\*")<br />\| count as eventCount by email<br />\| count|
|G Suite|User Actions Details|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/apps USER\_EMAIL "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"GROUP\_EMAIL\\",\\"value\\":\\"(?\<group\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}") AND if ("{{group\_email}}" = "\*", true, group\_email matches "{{group\_email}}")<br />\|count by user\_email, admin\_action, group\_email, recipient\_email, application\_name, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|G Suite|User Content Transfered|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/apps USER\_EMAIL CREATE\_DATA\_TRANSFER\_REQUEST "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"DESTINATION\_USER\_EMAIL\\",\\"value\\":\\"(?\<recipient\_email\>.\*?)\\"" nodrop<br />\| parse regex field=events "\\{\\"name\\":\\"APPLICATION\_NAME\\",\\"value\\":\\"(?\<application\_name\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{application\_name}}" = "\*", true, application\_name matches "{{application\_name}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{recipient\_email}}" = "\*", true, recipient\_email matches "{{recipient\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by user\_email, admin\_action, recipient\_email, application\_name, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|
|G Suite|Users - Created or Deleted|Logs|G Suite/G Suite - Admin - New|\_sourceCategory = Labs/gsuite/apps USER\_EMAIL AND (CREATE\_USER OR DELETE\_USER) "\\"applicationName\\": \\"admin\\""<br />\| json "id", "actor", "events"<br />\| json field=id "applicationName"<br />\| json field=actor "email" as admin\_email<br />\| parse regex field=events "\\[\\{\\"name\\":\\"(?\<admin\_action\>.\*?)\\",\\"type\\":\\"(?\<admin\_action\_type\>.\*?)\\",\\"parameters\\"" nodrop<br />\| parse regex field=events "\\[\\{\\"name\\":\\"USER\_EMAIL\\",\\"value\\":\\"(?\<user\_email\>.\*?)\\"" nodrop<br />\| where applicationName="admin"<br />\|where if ("{{admin\_action}}" = "\*", true, admin\_action matches "{{admin\_action}}") AND if ("{{applicationName}}" = "\*", true, applicationName matches "{{applicationName}}") AND if ("{{admin\_action\_type}}" = "\*", true, admin\_action\_type matches "{{admin\_action\_type}}") AND if ("{{user\_email}}" = "\*", true, user\_email matches "{{user\_email}}") AND if ("{{admin\_email}}" = "\*", true, admin\_email matches "{{admin\_email}}")<br />\|count by user\_email, admin\_action, admin\_email<br />\| sort by user\_email asc<br />\| fields -\_count|

