# AWS Lambda ULM

## Searches

### Log Searches

- **Log - AWS Services Invoking Functions - Outlier**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **Log - Duration by Hour (Average) - Outlier**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **Log - Duration by Hour (Sum) - Outlier**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **Log - Error Breakdown by Function**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **Log - Error Count**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **Log - Max Memory (MB) Used by Hour - Outlier**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **Log - Top Error Messages**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New

### Metric Searches

- **DeadLetterErrors by Functions - Trend**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **Error by Functions - Trend**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **IteratorAge  by Functions - Trend**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New 
- **Throttling by Functions - Trend**: from Dashboard: AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|AWS Lambda ULM|DeadLetterErrors by Functions - Trend|Metrics|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|functionname={{functionname}}  Namespace=AWS/Lambda metric=DeadLetterErrors Statistic=Sum FunctionName=\* Region=\* Resource=\* \| topk(10, max)|
|AWS Lambda ULM|Error by Functions - Trend|Metrics|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|functionname={{functionname}}  Namespace=AWS/Lambda metric=Errors Statistic=Sum FunctionName=\* Region=\* Resource=\* \| topk(10, max)|
|AWS Lambda ULM|IteratorAge  by Functions - Trend|Metrics|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|functionname={{functionname}}  Namespace=AWS/Lambda metric=IteratorAge Statistic=Maximum FunctionName=\* Region=\*  Resource=\* \| topk(10, max)|
|AWS Lambda ULM|Log - AWS Services Invoking Functions - Outlier|Logs|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|\_sourceCategory = Labs/AWS/CloudTrail\* "lambda.amazonaws.com" "Invoke" "AWSService"<br />\| json field=\_raw "eventName" as event\_name<br />\| json field=\_raw "eventSource" as event\_source<br />\| json field=\_raw "userIdentity.type" as caller\_type<br />\| where event\_name = "Invoke" AND caller\_type = "AWSService"<br />\| json field=\_raw "sourceIPAddress" as src\_ip<br />\| json field=\_raw "requestParameters.functionName" as func\_name nodrop<br />\| json field=\_raw "additionalEventData.functionVersion" as func\_version nodrop<br />\| parse regex field=func\_name "\\w+:\\w+:\\S+:[\\w-]+:\\S+:\\S+:(?\<functionName\>[\\S]+)\$"<br />\| parse regex field=func\_version "\\w+:\\w+:\\S+:[\\w-]+:\\S+:\\S+:(?\<function\_version\>[\\S]+:[\\S ]+)\$" \| json field=\_raw "userAgent" as user\_agent<br />\| json field=\_raw "userIdentity.invokedBy"as invoked\_by nodrop<br />\| json field=\_raw "userIdentity.userName"as user\_name nodrop<br />\| if (isNull(user\_name), invoked\_by, user\_name ) as caller<br />\| if (isNull(invoked\_by), user\_name, invoked\_by ) as caller<br />\| where caller\_type = "AWSService" <br />\| timeslice 1h<br />\|where if ("{{functionname}}" = "\*", true, functionname matches "{{functionname}}")<br />\|count by caller, \_timeslice<br />\| outlier \_count by caller<br />\| fields \_timeslice,caller, \_count\_violation<br />\| transpose row \_timeslice column caller|
|AWS Lambda ULM|Log - Duration by Hour (Average) - Outlier|Logs|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|\_sourceCategory = Labs/AWS/Lambda\*<br />\| json "message"<br />\| \_sourceName as logStream<br />\| \_sourceHost as logGroup<br />\| parse regex field=message "REPORT\\s+RequestId:\\s+(?\<RequestId\>[^\\s]+)\\s+Duration:\\s+(?\<Duration\>[^\\s]+)\\s+ms\\s+Billed Duration:\\s+(?\<BilledDuration\>[^\\s]+)\\s+ms\\s+Memory\\s+Size:\\s+(?\<MemorySize\>[^\\s]+)\\s+MB\\s+Max\\s+Memory\\s+Used:\\s+(?\<MaxMemoryUsed\>[^\\s]+)\\s+MB" <br />\| parse field=logstream "\*[\*]\*" as logstreamDate,version,logstreamID<br />\| parse field=loggroup "/aws/lambda/\*" as functionName<br />\| timeslice 1h<br />\|where if ("{{functionname}}" = "\*", true, functionname matches "{{functionname}}") AND if ("{{duration}}" = "\> -2147483648", true, duration {{duration}}) AND if ("{{requestid}}" = "\*", true, requestid matches "{{requestid}}") AND if ("{{version}}" = "\*", true, version matches "{{version}}") AND if ("{{loggroup}}" = "\*", true, loggroup matches "{{loggroup}}") AND if ("{{billedduration}}" = "\> -2147483648", true, billedduration {{billedduration}})<br />\|avg(Duration) as Duration by \_timeslice<br />\| outlier Duration|
|AWS Lambda ULM|Log - Duration by Hour (Sum) - Outlier|Logs|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|\_sourceCategory = Labs/AWS/Lambda\*<br />\| json "message"<br />\| \_sourceName as logStream<br />\| \_sourceHost as logGroup<br />\| parse regex field=message "REPORT\\s+RequestId:\\s+(?\<RequestId\>[^\\s]+)\\s+Duration:\\s+(?\<Duration\>[^\\s]+)\\s+ms\\s+Billed Duration:\\s+(?\<BilledDuration\>[^\\s]+)\\s+ms\\s+Memory\\s+Size:\\s+(?\<MemorySize\>[^\\s]+)\\s+MB\\s+Max\\s+Memory\\s+Used:\\s+(?\<MaxMemoryUsed\>[^\\s]+)\\s+MB" <br />\| parse field=logstream "\*/[\*]\*" as logstreamDate,version,logstreamID<br />\| parse field=loggroup "/aws/lambda/\*" as functionName<br />\| timeslice 1h<br />\|where if ("{{functionname}}" = "\*", true, functionname matches "{{functionname}}") AND if ("{{duration}}" = "\> -2147483648", true, duration {{duration}}) AND if ("{{requestid}}" = "\*", true, requestid matches "{{requestid}}") AND if ("{{version}}" = "\*", true, version matches "{{version}}") AND if ("{{loggroup}}" = "\*", true, loggroup matches "{{loggroup}}") AND if ("{{billedduration}}" = "\> -2147483648", true, billedduration {{billedduration}})<br />\|sum(Duration) as Duration by \_timeslice<br />\| outlier Duration|
|AWS Lambda ULM|Log - Error Breakdown by Function|Logs|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|\_sourceCategory = Labs/AWS/Lambda\* errorMessage<br />\| json "message"<br />\| \_sourceName as logStream<br />\| \_sourceHost as logGroup<br />\| parse field=logstream "\*/[\*]\*" as logstreamDate,version,logstreamID<br />\| parse field=loggroup "/aws/lambda/\*" as functionName<br />\| parse field=message "\*\\t\*\\t\*" as time,RequestId,errorObj<br />\|where if ("{{functionname}}" = "\*", true, functionname matches "{{functionname}}") AND if ("{{requestid}}" = "\*", true, requestid matches "{{requestid}}") AND if ("{{version}}" = "\*", true, version matches "{{version}}") AND if ("{{loggroup}}" = "\*", true, loggroup matches "{{loggroup}}")<br />\|count by functionName<br />\| sort by functionName desc|
|AWS Lambda ULM|Log - Error Count|Logs|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|\_sourceCategory = Labs/AWS/Lambda\* errorMessage<br />\| json "message"<br />\| \_sourceName as logStream<br />\| \_sourceHost as logGroup<br />\| parse field=logstream "\*/[\*]\*" as logstreamDate,version,logstreamID<br />\| parse field=loggroup "/aws/lambda/\*" as functionName<br />\| parse field=message "\*\\t\*\\t\*" as time,RequestId,errorObj<br />\|where if ("{{functionname}}" = "\*", true, functionname matches "{{functionname}}") AND if ("{{requestid}}" = "\*", true, requestid matches "{{requestid}}") AND if ("{{version}}" = "\*", true, version matches "{{version}}") AND if ("{{loggroup}}" = "\*", true, loggroup matches "{{loggroup}}")<br />\|count|
|AWS Lambda ULM|Log - Max Memory (MB) Used by Hour - Outlier|Logs|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|\_sourceCategory = Labs/AWS/Lambda\*<br />\| json "message"<br />\| \_sourceName as logStream<br />\| \_sourceHost as logGroup<br />\| parse regex field=message "REPORT\\s+RequestId:\\s+(?\<RequestId\>[^\\s]+)\\s+Duration:\\s+(?\<Duration\>[^\\s]+)\\s+ms\\s+Billed Duration:\\s+(?\<BilledDuration\>[^\\s]+)\\s+ms\\s+Memory\\s+Size:\\s+(?\<MemorySize\>[^\\s]+)\\s+MB\\s+Max\\s+Memory\\s+Used:\\s+(?\<MaxMemoryUsed\>[^\\s]+)\\s+MB" <br />\| parse field=logstream "\*/[\*]\*" as logstreamDate,version,logstreamID<br />\| parse field=loggroup "/aws/lambda/\*" as functionName<br />\| timeslice 1h<br />\|where if ("{{functionname}}" = "\*", true, functionname matches "{{functionname}}") AND if ("{{duration}}" = "\> -2147483648", true, duration {{duration}}) AND if ("{{requestid}}" = "\*", true, requestid matches "{{requestid}}") AND if ("{{version}}" = "\*", true, version matches "{{version}}") AND if ("{{loggroup}}" = "\*", true, loggroup matches "{{loggroup}}") AND if ("{{billedduration}}" = "\> -2147483648", true, billedduration {{billedduration}})<br />\|sum(MaxMemoryUsed) as MaxMemoryUsed by \_timeslice<br />\| outlier MaxMemoryUsed|
|AWS Lambda ULM|Log - Top Error Messages|Logs|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|\_sourceCategory = Labs/AWS/Lambda\* errorMessage<br />\| json "message"<br />\| \_sourceName as logStream<br />\| \_sourceHost as logGroup<br />\| parse field=logstream "\*/[\*]\*" as logstreamDate,version,logstreamID<br />\| parse field=loggroup "/aws/lambda/\*" as functionName<br />\| parse field=message "\*\\t\*\\t\*" as time,RequestId,errorObj<br />\| json  field=errorObj "errorMessage"<br />\|where if ("{{functionname}}" = "\*", true, functionname matches "{{functionname}}") AND if ("{{requestid}}" = "\*", true, requestid matches "{{requestid}}") AND if ("{{version}}" = "\*", true, version matches "{{version}}") AND if ("{{loggroup}}" = "\*", true, loggroup matches "{{loggroup}}")<br />\|count by errorMessage, functionName <br />\| top 10 errorMessage, functionName by \_count|
|AWS Lambda ULM|Throttling by Functions - Trend|Metrics|AWS Lambda ULM/AWS Lambda ULM - Error Analysis - New|functionname={{functionname}}  Namespace=AWS/Lambda metric=Throttles Statistic=Sum FunctionName=\* Region=\* Resource=\* \| topk(10, max)|

