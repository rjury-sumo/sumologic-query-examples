# Amazon Inspector Classic
## Sumo Logic App For: Amazon Inspector Classic
Amazon Inspector allows you to monitor your AWS resources for potential security risks. The Sumo Logic App for Amazon Inspector provides preconfigured searches and Dashboards that give you instant access to an overview of Amazon Inspector as well as details on assessments, runs, and findings.
Docs Link: [Amazon Inspector Classic](https://help.sumologic.com/?cid=6020)

## Searches

### Log Searches

- **Events by Template**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview 
- **Finding Details**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings 
- **Finding Severity by InstanceId**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview 
- **Finding Severity by Template**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview 
- **Finding Severity by Template and Run**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings 
- **Finding Severity Over Time**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings 
- **Last Run by Template**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview 
- **Outlier Indicator of Non-Informational Findings**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings 
- **Persistent Findings**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings 
- **Templates Not Run in a Day**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings 
- **Top 5 Findings**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview 
- **Top 5 RulesPackages by Findings**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview 
- **Trend of Findings by  RulesPackage**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview 
- **Trend of Findings by Template**: from Dashboard: Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Amazon Inspector Classic|Events by Template|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name" nodrop <br />\| format("%s : %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{event}}" = "\*", true, event matches "{{event}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|count by event, template<br />\| transpose row template column event|
|Amazon Inspector Classic|Finding Details|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED<br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\| where !isNull(findingSeverity)<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}") AND if ("{{findingseverity}}" = "\*", true, findingseverity matches "{{findingseverity}}") AND if ("{{findingioc}}" = "\*", true, findingioc matches "{{findingioc}}")<br />\|count by findingTitle,description,createdAt,template,run, findingseverity, \_messagetime<br />\| order by findingSeverity,\_messagetime  \| fields -\_count,\_messagetime|
|Amazon Inspector Classic|Finding Severity by InstanceId|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED<br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\| parse regex field=findingtitle " (?\<instanceId\>i\\-\\w+) "<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{event}}" = "\*", true, event matches "{{event}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|count by instanceId, findingName, findingSeverity <br />\| count by instanceId,findingSeverity<br />\| transpose row instanceId column findingSeverity|
|Amazon Inspector Classic|Finding Severity by Template|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED<br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{event}}" = "\*", true, event matches "{{event}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|count by findingSeverity,template<br />\| transpose row template column findingSeverity|
|Amazon Inspector Classic|Finding Severity by Template and Run|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED<br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.createdAt","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","description" as findingName, findingSeverity,findingIoC, findingTitle,description  <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\| %"runLookup.createdAt" as createdAt<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}") AND if ("{{findingseverity}}" = "\*", true, findingseverity matches "{{findingseverity}}") AND if ("{{findingioc}}" = "\*", true, findingioc matches "{{findingioc}}")<br />\|count by findingSeverity,template, run,createdAt<br />\| transpose row template,run,createdAt column findingSeverity<br />\| toMillis(parseDate(createdAt,"yyyy-MM-dd HH:mm:ss.")) as time<br />\| order by template,time \| fields - time|
|Amazon Inspector Classic|Finding Severity Over Time|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED <br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description","rulesPackageLookup.name","serviceAttributes.rulesPackageArn" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description,rulesPackageName,rulesPackageArn nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\| format("%s - %s", rulesPackageName,rulesPackageArn) as rulesPackageName<br />\| timeslice 1d<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}") AND if ("{{findingseverity}}" = "\*", true, findingseverity matches "{{findingseverity}}") AND if ("{{findingioc}}" = "\*", true, findingioc matches "{{findingioc}}")<br />\|count by findingSeverity,\_timeslice <br />\| transpose row \_timeslice column findingSeverity|
|Amazon Inspector Classic|Last Run by Template|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview|\_sourceCategory={{Logsdatasource}}  event<br />\| json "Message","Timestamp" as rawMsg, timestamp<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","newstate" nodrop <br />\| run as runRaw<br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| where !isnull(runRaw)<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{event}}" = "\*", true, event matches "{{event}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|first(run)  as lastRun, first(event) as lastEvent, first(\_messagetime) as rawtimestamp by template <br />\| order by rawtimestamp \| formatDate(rawtimestamp,"yyyy-MM-dd HH:mm:ssZ") as timestamp<br />\| fields  - rawtimestamp|
|Amazon Inspector Classic|Outlier Indicator of Non-Informational Findings|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED <br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description","rulesPackageLookup.name","serviceAttributes.rulesPackageArn" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description,rulesPackageName,rulesPackageArn nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\| format("%s - %s", rulesPackageName,rulesPackageArn) as rulesPackageName<br />\| where findingSeverity!="informational" and !isNull(findingSeverity)<br />\| timeslice 1d<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}") AND if ("{{findingseverity}}" = "\*", true, findingseverity matches "{{findingseverity}}") AND if ("{{findingioc}}" = "\*", true, findingioc matches "{{findingioc}}")<br />\|count by \_timeslice,findingSeverity<br />\| outlier \_count window=3 <br />\| fields \_timeslice,findingSeverity, \_count\_violation<br />\| transpose row \_timeslice column findingSeverity|
|Amazon Inspector Classic|Persistent Findings|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED<br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}") AND if ("{{findingseverity}}" = "\*", true, findingseverity matches "{{findingseverity}}") AND if ("{{findingioc}}" = "\*", true, findingioc matches "{{findingioc}}")<br />\|count(run) as runs by findingTitle,template,findingSeverity<br />\| where runs \> 1|
|Amazon Inspector Classic|Templates Not Run in a Day|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Findings|\_sourceCategory={{Logsdatasource}}  event<br />\| json "Message","Timestamp" as rawMsg, timestamp<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","newstate" nodrop <br />\| run as runRaw<br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| where !isnull(runRaw)<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|first(event) as lastEvent, first(\_messagetime) as rawtimestamp by template <br />\| order by rawtimestamp<br />\| where rawtimestamp \< now()-86400000<br />\| formatDate(rawtimestamp,"yyyy-MM-dd HH:mm:ssZ") as lastEventDate \| fields -rawtimestamp|
|Amazon Inspector Classic|Top 5 Findings|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED<br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{event}}" = "\*", true, event matches "{{event}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|count as count by description, findingSeverity \| sort by count \| limit 5|
|Amazon Inspector Classic|Top 5 RulesPackages by Findings|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED <br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description","rulesPackageLookup.name","serviceAttributes.rulesPackageArn" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description,rulesPackageName,rulesPackageArn nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\| format("%s - %s", rulesPackageName,rulesPackageArn) as rulesPackageName<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{event}}" = "\*", true, event matches "{{event}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|count by rulesPackageName <br />\| top 5 rulesPackageName by \_count|
|Amazon Inspector Classic|Trend of Findings by  RulesPackage|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED <br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description","rulesPackageLookup.name","serviceAttributes.rulesPackageArn" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description,rulesPackageName,rulesPackageArn nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\| format("%s - %s", rulesPackageName,rulesPackageArn) as rulesPackageName<br />\| timeslice 1d<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{event}}" = "\*", true, event matches "{{event}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|count by rulesPackageName,\_timeslice <br />\| transpose row \_timeslice column rulesPackageName|
|Amazon Inspector Classic|Trend of Findings by Template|Logs|Installed Apps/Amazon Inspector Classic/Amazon Inspector - Overview|\_sourceCategory={{Logsdatasource}}  FINDING REPORTED <br />\| json "Message" as rawMsg<br />\| json field=rawMsg "event","target","run","template","targetLookup.name","runLookup.name","templateLookup.name","findingDetails" nodrop <br />\| where event="FINDING\_REPORTED"<br />\| json field=findingDetails "id","severity","indicatorOfCompromise","title","createdAt","description","rulesPackageLookup.name","serviceAttributes.rulesPackageArn" as findingName, findingSeverity,findingIoC, findingTitle, createdAt,description,rulesPackageName,rulesPackageArn nodrop <br />\| format("%s - %s", %"templatelookup.name", template) as template<br />\| format("%s - %s", %"runLookup.name", run) as run<br />\| format("%s - %s", %"targetLookup.name", target) as target<br />\| format("%s - %s", rulesPackageName,rulesPackageArn) as rulesPackageName<br />\| timeslice 1d<br />\|where if ("{{run}}" = "\*", true, run matches "{{run}}") AND if ("{{event}}" = "\*", true, event matches "{{event}}") AND if ("{{template}}" = "\*", true, template matches "{{template}}")<br />\|count by template,\_timeslice <br />\| transpose row \_timeslice column template|

