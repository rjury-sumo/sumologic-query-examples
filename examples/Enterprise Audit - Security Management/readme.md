# Enterprise Audit - Security Management

## Searches

### Log Searches

- **Active Admins**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities 
- **Active Admins Updating Password Policy**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **Active Admins Updating Service AllowList**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **Active Users**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities 
- **Active Vs InActive Access Keys**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities 
- **Activities Over Time**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview 
- **Distribution - Access Keys**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview 
- **Distribution - AllowList Users Activity**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview 
- **Distribution - SAML Configuration Activity**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview 
- **Distribution - SAML Lockdown Activity**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview 
- **Enterprise Audit - Australia embargoed countries**: from Search: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Australia embargoed countries 
- **Enterprise Audit - Australia embargoed countries**: from Search: Enterprise Audit - Security Management/Enterprise Audit - Australia embargoed countries 
- **Enterprise Audit - US embargoed countries**: from Search: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - US embargoed countries 
- **Enterprise Audit - US embargoed countries**: from Search: Enterprise Audit - Security Management/Enterprise Audit - US embargoed countries 
- **Geo Location**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities 
- **Geo Location**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview 
- **Geo Location**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities 
- **Geo Location Of All Activities**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **Geo Location Of AllowList Users**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **One Day Time Shift Comparison**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities 
- **One Day Time Shift Comparison**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities 
- **Recent - Access Keys Activities**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities 
- **Recent - AllowList User Activity**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities 
- **Recent - Password Policy Changes**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **Recent - SAML Configuration Activity**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities 
- **Recent - SAML Lockdown Activity**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities 
- **Recent - Service AllowList Permission Activities**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **Recent - Service Allowlist Update**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **Recent Users Disabled MFA**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **Recent Users Enabled MFA**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities 
- **Top Users By Events**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview 
- **Trend - Access Key Events**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities 
- **Trend - AllowList Users**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities 
- **Trend - SAML Configuration**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities 
- **Users Disabled MFA**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview 
- **Users Enabled MFA**: from Dashboard: Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Enterprise Audit - Security Management|Active Admins|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities|\_index=sumologic\_audit\_events \_sourceCategory=saml<br />\| json "eventName", "eventTime", "operator.email", "operator.id", "operator.sourceIp"  as EventName, EventTime, Admin, AdminId, AdminIp<br />\| where EventName in ("SamlConfigurationCreated", "SamlConfigurationUpdated", "SamlConfigurationDeleted", "SamlLockdownEnabled", "SamlLockdownDisabled", "AllowlistedUsersCreated", "AllowlistedUsersDeleted")<br />\| where EventName matches "{{EventName}}"<br />\|count by EventName, Admin<br />\| transpose row Admin column EventName as %"SamlConfigurationCreated", %"SamlConfigurationUpdated", %"SamlConfigurationDeleted", %"SamlLockdownEnabled", %"SamlLockdownDisabled", %"AllowlistedUsersCreated", %"AllowlistedUsersDeleted"<br />\| sort by SamlConfigurationCreated, SamlConfigurationUpdated, SamlConfigurationDeleted, SamlLockdownEnabled, SamlLockdownDisabled, AllowlistedUsersCreated, AllowlistedUsersDeleted<br />\| limit 5|
|Enterprise Audit - Security Management|Active Admins Updating Password Policy|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events \_sourceCategory=passwordPolicy<br />\| json "operator.email","operator.sourceIp" as Admin,AdminIp<br />\| where AdminIp matches "{{AdminIp}}"\|count as Count by Admin<br />\| limit 5<br />|
|Enterprise Audit - Security Management|Active Admins Updating Service AllowList|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events \_sourceCategory=serviceAllowlist (ServiceAllowlistPermissionsSet OR ServiceAllowlistUpdated)<br />\| json "eventName", "operator.email","operator.sourceIp" as EventName, Admin, AdminIp nodrop<br />\| where EventName in ("ServiceAllowlistPermissionsSet", "ServiceAllowlistUpdated")<br />\| where AdminIp matches "{{AdminIp}}"\|count as Count by Admin, EventName<br />\| transpose row Admin column EventName as %"ServiceAllowlistPermissionsSet", %"ServiceAllowlistUpdated"<br />\| sort by ServiceAllowlistPermissionsSet, ServiceAllowlistUpdated|
|Enterprise Audit - Security Management|Active Users|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities|\_index=sumologic\_audit\_events \_SourceCategory=accessKeys (AccessKeyCreated OR AccessKeyDeleted OR AccessKeyUpdated)<br />\| json "eventName", "eventTime", "accessId", "operator.email", "operator.id", "operator.sourceIp", "accessKey.accessKeyLabel", "accessKey.enabled", "to", "from", "to.enabled"  as EventName, EventTime, AccessId, User, UserId, UserIp, AccessKeyLabel, IsActive, CurrentValue, PreviousValue, IsActiveUpdated nodrop<br />\| where EventName in <br />("AccessKeyCreated","AccessKeyDeleted","AccessKeyUpdated") AND EventName matches "{{EventName}}"<br />\| where EventName matches "{{EventName}}" and AccessId matches "{{AccessId}}" and User matches "{{User}}" and UserIp matches "{{UserIp}}" and AccessKeyLabel matches "{{AccessKeyLabel}}"<br />\|count by User, EventName<br />\| transpose row User column EventName as %"AccessKeyCreated", %"AccessKeyUpdated", %"AccessKeyDeleted"<br />\| sort by AccessKeyCreated, AccessKeyUpdated, AccessKeyDeleted<br />\| limit 5<br />|
|Enterprise Audit - Security Management|Active Vs InActive Access Keys|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities|\_index=sumologic\_audit\_events \_SourceCategory=accessKeys (AccessKeyCreated OR AccessKeyDeleted OR AccessKeyUpdated)<br />\| json "eventName", "eventTime", "accessId", "operator.email", "operator.id", "operator.sourceIp", "accessKey.accessKeyLabel", "accessKey.enabled", "to", "from", "to.enabled"  as EventName, EventTime, AccessId, User, UserId, UserIp, AccessKeyLabel, IsActive, CurrentValue, PreviousValue, IsActiveUpdated nodrop<br />\| if(isNull(IsActive), if(isNull(IsActiveUpdated), "-", IsActiveUpdated) ,IsActive) as IsActive<br />\| where EventName in ("AccessKeyCreated","AccessKeyDeleted","AccessKeyUpdated") <br />\| where EventName matches "{{EventName}}" and AccessId matches "{{AccessId}}" and User matches "{{User}}" and UserIp matches "{{UserIp}}" and AccessKeyLabel matches "{{AccessKeyLabel}}"<br />\| withtime IsActive<br />\| most\_recent(IsActive\_withtime) as Status by AccessId<br />\| count as Count by Status<br />\| where Status != "-"<br />\| if (Status matches "true", "Active", "InActive") as Status<br /><br />|
|Enterprise Audit - Security Management|Activities Over Time|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events<br />\| where \_sourceCategory in ("accessKeys", "saml", "serviceAllowlist", "passwordPolicy", "multiFactorAuthentication")<br />\| timeslice 1d<br />\| count as Count by \_timeslice, \_sourceCategory<br />\| fillmissing timeslice(1d),<br />  values("accessKeys", "saml", "serviceAllowlist", "passwordPolicy", "multiFactorAuthentication") in \_sourceCategory<br />\| transpose row \_timeslice column \_sourceCategory|
|Enterprise Audit - Security Management|Distribution - Access Keys|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=accessKeys<br />\| json "eventName" as EventName nodrop<br />\| count as Count by EventName|
|Enterprise Audit - Security Management|Distribution - AllowList Users Activity|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=saml (AllowlistedUsersCreated OR AllowlistedUsersDeleted)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("AllowlistedUsersCreated","AllowlistedUsersDeleted")<br />\| count as Count by EventName|
|Enterprise Audit - Security Management|Distribution - SAML Configuration Activity|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=saml (SamlConfigurationCreated OR SamlConfigurationUpdated OR SamlConfigurationDeleted)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("SamlConfigurationCreated","SamlConfigurationUpdated","SamlConfigurationDeleted")<br />\| count as Count by EventName|
|Enterprise Audit - Security Management|Distribution - SAML Lockdown Activity|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=saml (SamlLockdownEnabled OR SamlLockdownDisabled)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("SamlLockdownEnabled","SamlLockdownDisabled")<br />\| count as Count by EventName|
|Enterprise Audit - Security Management|Enterprise Audit - Australia embargoed countries|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Australia embargoed countries|\_index=sumologic\_audit\_events (\_sourceCategory=userSessions or \_sourceCategory=collection) (UserLoggedIn OR CollectorCreated OR CollectorUpdated OR CollectorDeleted OR EphemeralCollectorDeleted OR ClobberCollectorDeleted OR CollectorUpgradeRequested OR CollectorUpgradeCompleted)<br />\| json "eventName"  as EventName<br />\| where EventName in ("UserLoggedIn", "CollectorCreated", "CollectorUpdated", "CollectorDeleted", "EphemeralCollectorDeleted", "ClobberCollectorDeleted", "CollectorUpgradeRequested", "CollectorUpgradeCompleted")<br />\| json "userSession.sourceIp" as srcIP  nodrop <br />\| json "operator.sourceIp" as  srcIp\_1 nodrop<br />\| if (isNull(srcIp), srcIp\_1, srcIp) as srcIp<br />\| lookup country\_name from geo://location on ip=srcIp <br />\| where country\_name in ("Iran", "North Korea", "Myanmar","Mali") <br />|
|Enterprise Audit - Security Management|Enterprise Audit - Australia embargoed countries|Logs|Enterprise Audit - Security Management/Enterprise Audit - Australia embargoed countries|\_index=sumologic\_audit\_events (\_sourceCategory=userSessions or \_sourceCategory=collection) (UserLoggedIn OR CollectorCreated OR CollectorUpdated OR CollectorDeleted OR EphemeralCollectorDeleted OR ClobberCollectorDeleted OR CollectorUpgradeRequested OR CollectorUpgradeCompleted)<br />\| json "eventName"  as EventName<br />\| where EventName in ("UserLoggedIn", "CollectorCreated", "CollectorUpdated", "CollectorDeleted", "EphemeralCollectorDeleted", "ClobberCollectorDeleted", "CollectorUpgradeRequested", "CollectorUpgradeCompleted")<br />\| json "userSession.sourceIp" as srcIP  nodrop <br />\| json "operator.sourceIp" as  srcIp\_1 nodrop<br />\| if (isNull(srcIp), srcIp\_1, srcIp) as srcIp<br />\| lookup country\_name from geo://location on ip=srcIp <br />\| where country\_name in ("Iran", "North Korea", "Myanmar","Mali") <br />|
|Enterprise Audit - Security Management|Enterprise Audit - US embargoed countries|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - US embargoed countries|\_index=sumologic\_audit\_events (\_sourceCategory=userSessions or \_sourceCategory=collection) (UserLoggedIn OR CollectorCreated OR CollectorUpdated OR CollectorDeleted OR EphemeralCollectorDeleted OR ClobberCollectorDeleted OR CollectorUpgradeRequested OR CollectorUpgradeCompleted)<br />\| json "eventName"  as EventName<br />\| where EventName in ("UserLoggedIn", "CollectorCreated", "CollectorUpdated", "CollectorDeleted", "EphemeralCollectorDeleted", "ClobberCollectorDeleted", "CollectorUpgradeRequested", "CollectorUpgradeCompleted")<br />\| json "userSession.sourceIp" as srcIP  nodrop <br />\| json "operator.sourceIp" as  srcIp\_1 nodrop<br />\| if (isNull(srcIp), srcIp\_1, srcIp) as srcIp<br />\| lookup country\_name from geo://location on ip=srcIp <br />\| where country\_name in ("Iran", "North Korea", "Syria","Sudan","Cuba","Venezuela") <br />|
|Enterprise Audit - Security Management|Enterprise Audit - US embargoed countries|Logs|Enterprise Audit - Security Management/Enterprise Audit - US embargoed countries|\_index=sumologic\_audit\_events (\_sourceCategory=userSessions or \_sourceCategory=collection) (UserLoggedIn OR CollectorCreated OR CollectorUpdated OR CollectorDeleted OR EphemeralCollectorDeleted OR ClobberCollectorDeleted OR CollectorUpgradeRequested OR CollectorUpgradeCompleted)<br />\| json "eventName"  as EventName<br />\| where EventName in ("UserLoggedIn", "CollectorCreated", "CollectorUpdated", "CollectorDeleted", "EphemeralCollectorDeleted", "ClobberCollectorDeleted", "CollectorUpgradeRequested", "CollectorUpgradeCompleted")<br />\| json "userSession.sourceIp" as srcIP  nodrop <br />\| json "operator.sourceIp" as  srcIp\_1 nodrop<br />\| if (isNull(srcIp), srcIp\_1, srcIp) as srcIp<br />\| lookup country\_name from geo://location on ip=srcIp <br />\| where country\_name in ("Iran", "North Korea", "Syria","Sudan","Cuba","Venezuela") <br />|
|Enterprise Audit - Security Management|Geo Location|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities|\_index=sumologic\_audit\_events \_SourceCategory=accessKeys (AccessKeyCreated OR AccessKeyDeleted OR AccessKeyUpdated)<br />\| json "eventName", "eventTime", "accessId", "operator.email", "operator.id", "operator.sourceIp", "accessKey.accessKeyLabel", "accessKey.enabled", "to", "from", "to.enabled"  as EventName, EventTime, AccessId, User, UserId, UserIp, AccessKeyLabel, IsActive, CurrentValue, PreviousValue, IsActiveUpdated nodrop<br />\| where EventName in ("AccessKeyCreated","AccessKeyDeleted","AccessKeyUpdated")<br />\| where EventName matches "{{EventName}}" and AccessId matches "{{AccessId}}" and User matches "{{User}}" and UserIp matches "{{UserIp}}" and AccessKeyLabel matches "{{AccessKeyLabel}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = UserIp<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />|
|Enterprise Audit - Security Management|Geo Location|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events<br />\| where \_sourceCategory in ("accessKeys", "saml", "serviceAllowlist", "passwordPolicy", "multiFactorAuthentication")<br />\| json "eventName", "operator.sourceIp" as EventName, UserIp nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = UserIp<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Enterprise Audit - Security Management|Geo Location|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities|\_index=sumologic\_audit\_events \_sourceCategory=saml<br />\| json "eventName" as EventName nodrop<br />\| where EventName matches "{{EventName}}"<br />\| json "operator" nodrop<br />\| json field=operator "sourceIp" as AdminIp nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = AdminIp<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Enterprise Audit - Security Management|Geo Location Of All Activities|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events (\_sourceCategory=serviceAllowlist OR \_sourceCategory=passwordPolicy OR \_sourceCategory=multiFactorAuthentication)<br />\| json "operator.sourceIp" as AdminIp nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = AdminIp<br />\|where if ("{{AdminIp}}" = "\*", true, AdminIp matches "{{AdminIp}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Enterprise Audit - Security Management|Geo Location Of AllowList Users|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events \_sourceCategory=serviceAllowlist ServiceAllowlistUpdated<br />\| json "eventName", "addedCIDRs[\*].cidr","operator.sourceIp" as EventName, AllowListUsers,AdminIp nodrop<br />\| where EventName="ServiceAllowlistUpdated"<br />\| where AdminIp matches "{{AdminIp}}"<br />\| extract field=AllowListUsers "\\"(?\<IP\>.\*?)\\"" multi<br />\| count\_distinct(IP) as Count by IP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = IP<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />|
|Enterprise Audit - Security Management|One Day Time Shift Comparison|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities|\_index=sumologic\_audit\_events \_sourceCategory=saml<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("SamlConfigurationCreated", "SamlConfigurationUpdated", "SamlConfigurationDeleted", "SamlLockdownEnabled", "SamlLockdownDisabled", "AllowlistedUsersCreated", "AllowlistedUsersDeleted") AND EventName matches "{{EventName}}"<br />\| count as Count by EventName<br />\| fillmissing values("SamlConfigurationCreated", "SamlConfigurationUpdated", "SamlConfigurationDeleted" , "SamlLockdownEnabled", "SamlLockdownDisabled", "AllowlistedUsersCreated", "AllowlistedUsersDeleted") in EventName <br />\| compare timeshift 1d as Shift\_1d|
|Enterprise Audit - Security Management|One Day Time Shift Comparison|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities|\_index=sumologic\_audit\_events \_SourceCategory=accessKeys (AccessKeyCreated OR AccessKeyDeleted OR AccessKeyUpdated)<br />\| json "eventName", "eventTime", "accessId", "operator.email", "operator.id", "operator.sourceIp", "accessKey.accessKeyLabel", "accessKey.enabled", "to", "from", "to.enabled"  as EventName, EventTime, AccessId, User, UserId, UserIp, AccessKeyLabel, IsActive, CurrentValue, PreviousValue, IsActiveUpdated nodrop<br />\| where EventName in ("AccessKeyCreated","AccessKeyDeleted","AccessKeyUpdated") <br />\| where EventName matches "{{EventName}}" and AccessId matches "{{AccessId}}" and User matches "{{User}}" and UserIp matches "{{UserIp}}" and AccessKeyLabel matches "{{AccessKeyLabel}}"<br />\| count as Count by EventName<br />\| fillmissing values("AccessKeyCreated", "AccessKeyUpdated", "AccessKeyDeleted") in EventName <br />\| compare timeshift 1d as Shift\_1d<br />|
|Enterprise Audit - Security Management|Recent - Access Keys Activities|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities|\_index=sumologic\_audit\_events \_SourceCategory=accessKeys (AccessKeyCreated OR AccessKeyDeleted OR AccessKeyUpdated)<br />\| json "eventName", "eventTime", "accessId", "operator.email", "operator.id", "operator.sourceIp", "accessKey.accessKeyLabel", "accessKey.enabled", "to", "from", "to.enabled"  as EventName, EventTime, AccessId, User, UserId, UserIp, AccessKeyLabel, IsActive, CurrentValue, PreviousValue, IsActiveUpdated nodrop<br />\| if(isNull(IsActive), if(isNull(IsActiveUpdated), "-", IsActiveUpdated) ,IsActive) as IsActive<br />\| json field=CurrentValue "accessKeyLabel", "enabled" as AccessKeyLabelUpdated, EnabledUpdated nodrop<br />\| if(isNull(AccessKeyLabel), if(isNull(AccessKeyLabelUpdated), "-", AccessKeyLabelUpdated) ,AccessKeyLabel) as AccessKeyLabel<br />\| if(isNull(IsActive), if(isNull(EnabledUpdated), "-", EnabledUpdated) ,IsActive) as IsActive<br />\| where EventName in <br />("AccessKeyCreated","AccessKeyDeleted","AccessKeyUpdated") <br />\| where EventName matches "{{EventName}}" and AccessId matches "{{AccessId}}" and User matches "{{User}}" and UserIp matches "{{UserIp}}" and AccessKeyLabel matches "{{AccessKeyLabel}}"<br />\|count by EventName, EventTime, AccessId, AccessKeyLabel, IsActive, User, UserId, UserIp, CurrentValue, PreviousValue<br />\| sort by EventTime desc<br />\| fields - \_count, UserId, CurrentValue, PreviousValue<br />\| limit 10<br />|
|Enterprise Audit - Security Management|Recent - AllowList User Activity|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities|\_index=sumologic\_audit\_events \_sourceCategory=saml (AllowlistedUsersCreated OR AllowlistedUsersDeleted)<br />\| json "eventName", "eventTime", "operator.email", "operator.id", "operator.sourceIp", "allowlistedUsers"  as EventName, EventTime, Admin, AdminId, AdminIp, allowlistedUsers nodrop<br />\| parse regex field=allowlistedUsers "\\"userEmail\\":\\"(?\<UserAddedToAllowList\>.\*?)\\"" multi<br />\| where EventName in ("AllowlistedUsersCreated", "AllowlistedUsersDeleted") AND EventName matches "{{EventName}}"<br />\|count by EventTime, EventName, UserAddedToAllowList, Admin, AdminIp<br />\| sort by EventTime<br />\| fields - \_count<br />|
|Enterprise Audit - Security Management|Recent - Password Policy Changes|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events  \_sourceCategory=passwordPolicy PasswordPolicyUpdated<br />\| json "eventName", "eventTime", "from", "to", "operator.email", "operator.sourceIp" as EventName, EventTime, PreviousValue, CurrentValue, Admin, AdminIp nodrop<br />\| where EventName="PasswordPolicyUpdated"<br />\| json field=PreviousValue "expireAfterDays", "reuseAfterChanges", "lockoutPolicy.failedAttempts", "lockoutPolicy.lockoutMinutes", "mfaPolicy.required", "mfaPolicy.rememberBrowser" as PreviousexpireAfterDays, PreviousreuseAfterChanges, PreviousfailedAttempts, PreviouslockoutMinutes, Previousrequired, PreviousrememberBrowser nodrop<br />\| json field=CurrentValue "expireAfterDays", "reuseAfterChanges", "lockoutPolicy.failedAttempts", "lockoutPolicy.lockoutMinutes", "mfaPolicy.required", "mfaPolicy.rememberBrowser" as CurrentexpireAfterDays, CurrentreuseAfterChanges, CurrentfailedAttempts, CurrentlockoutMinutes, Currentrequired, CurrentrememberBrowser nodrop<br />\| if(PreviousexpireAfterDays!=CurrentexpireAfterDays, concat("PasswordExpiryAfterDays changed from ", PreviousexpireAfterDays, " to ", CurrentexpireAfterDays), "NoChange") as PasswordExpiryAfterDays<br />\| if(PreviousreuseAfterChanges!=CurrentreuseAfterChanges, concat("PasswordReuseAfterChanges changed from ", PreviousreuseAfterChanges, " to ", CurrentreuseAfterChanges), "NoChange") as PasswordReuseAfterChanges<br />\| if(PreviousfailedAttempts!=CurrentfailedAttempts, concat("LockOutAfterFailedAttempts changed from ", PreviousfailedAttempts, " to ", CurrentfailedAttempts), "NoChange") as LockOutAfterFailedAttempts<br />\| if(PreviouslockoutMinutes!=CurrentlockoutMinutes, concat("LockOutMinutes changed from ", PreviouslockoutMinutes, " to ", CurrentlockoutMinutes), "NoChange") as LockOutMinutes<br />\| if(Previousrequired!=Currentrequired, concat("MFARequired changed from ", Previousrequired, " to ", Currentrequired), "NoChange") as MFARequired<br />\| if(PreviousrememberBrowser!=CurrentrememberBrowser, concat("RememberBrowser changed from ", PreviousrememberBrowser, " to ", CurrentrememberBrowser), "NoChange") as RememberBrowser<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count by EventTime, Admin, AdminIp, PasswordExpiryAfterDays, PasswordReuseAfterChanges, LockOutAfterFailedAttempts, LockOutMinutes, MFARequired, RememberBrowser<br />\| sort by EventTime<br />\| fields - \_count<br />|
|Enterprise Audit - Security Management|Recent - SAML Configuration Activity|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities|\_index=sumologic\_audit\_events \_sourceCategory="saml" (SamlConfigurationCreated OR SamlConfigurationUpdated OR SamlConfigurationDeleted)<br />\| json "eventName", "eventTime", "operator.email", "operator.id", "operator.sourceIp", "samlConfigurationIdentity.id", "samlConfigurationIdentity.configurationName", "samlConfiguration", "to", "from" as EventName, EventTime, Admin, AdminId, AdminIp, ConfigurationId, ConfigurationName, ConfigurationDetails, CurrentValue, PreviuosValue nodrop<br />\| where  EventName matches "{{EventName}}"  <br />\| where EventName in ("SamlConfigurationCreated", "SamlConfigurationUpdated", "SamlConfigurationDeleted") <br />\|count by EventName, EventTime, ConfigurationName, Admin, AdminId, AdminIp, ConfigurationId, ConfigurationDetails, CurrentValue, PreviuosValue<br />\| fields - \_count, AdminId, ConfigurationId, ConfigurationDetails, CurrentValue, PreviuosValue|
|Enterprise Audit - Security Management|Recent - SAML Lockdown Activity|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities|\_index=sumologic\_audit\_events \_sourceCategory=saml (SamlLockdownEnabled OR SamlLockdownDisabled)<br />\| json "eventName", "eventTime", "operator.email", "operator.id", "operator.sourceIp"  as EventName, EventTime, Admin, AdminId, AdminIp<br />\| where EventName in ("SamlLockdownEnabled", "SamlLockdownDisabled") AND EventName matches "{{EventName}}"<br />\|count by EventTime, EventName, Admin, AdminIp<br />\| sort by EventTime<br />\| fields - \_count|
|Enterprise Audit - Security Management|Recent - Service AllowList Permission Activities|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events \_sourceCategory=serviceAllowlist ServiceAllowlistPermissionsSet<br />\| json "eventName", "eventTime", "operator.email", "operator.sourceIp", "loginAndApi", "shareDashboards" as EventName, EventTime, Admin, AdminIp, LoginAndApiStatus, ShareDashBoardStatus nodrop<br />\| where EventName="ServiceAllowlistPermissionsSet"<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count by EventTime, Admin, AdminIp, LoginAndApiStatus, ShareDashBoardStatus<br />\| sort by EventTime<br />\| fields - \_count|
|Enterprise Audit - Security Management|Recent - Service Allowlist Update|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events \_sourceCategory=serviceAllowlist ServiceAllowlistUpdated<br />\| json "eventName", "eventTime", "operator.email", "operator.sourceIp", "addedCIDRs[\*].cidr" as EventName, EventTime, Admin, AdminIp, AllowListUsers nodrop<br />\| where EventName="ServiceAllowlistUpdated"<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count by EventTime, Admin, AdminIp, AllowListUsers<br />\| sort by EventTime<br />\| fields - \_count|
|Enterprise Audit - Security Management|Recent Users Disabled MFA|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events \_sourceCategory=multiFactorAuthentication UserMultiFactorAuthenticationDisabled<br />\| json "eventName", "eventTime", "userIdentity.userEmail", "operator.sourceIp" as EventName, EventTime, UserEmail, AdminIp nodrop<br />\| where EventName="UserMultiFactorAuthenticationDisabled"<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count by EventTime, UserEmail<br />\| sort by EventTime<br />\| fields - \_count, EventTime<br />|
|Enterprise Audit - Security Management|Recent Users Enabled MFA|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Password Policy, MFA, Service AllowList Activities|\_index=sumologic\_audit\_events \_sourceCategory=multiFactorAuthentication UserMultiFactorAuthenticationEnabled<br />\| json "eventName", "eventTime", "userIdentity.userEmail","operator.sourceIp" as EventName, EventTime, UserEmail, AdminIp nodrop<br />\| where EventName="UserMultiFactorAuthenticationEnabled"<br />\| where AdminIp matches "{{AdminIp}}"<br />\|count by EventTime, UserEmail<br />\| sort by EventTime<br />\| fields - \_count, EventTime|
|Enterprise Audit - Security Management|Top Users By Events|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events<br />\| where \_sourceCategory in ("accessKeys", "saml", "serviceAllowlist", "passwordPolicy", "multiFactorAuthentication")<br />\| \_sourceCategory as EventType<br />\| json "eventName", "operator.email" as EventName, UserEmail nodrop<br />\| Count as Count by UserEmail, EventType<br />\| transpose row UserEmail column EventType as %"accessKeys", %"saml", %"serviceAllowlist", %"passwordPolicy", %"multiFactorAuthentication"<br />\| sort by accessKeys, saml, serviceAllowlist, passwordPolicy, multiFactorAuthentication<br />\| limit 5 |
|Enterprise Audit - Security Management|Trend - Access Key Events|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Access Key Activities|<br />\_index=sumologic\_audit\_events \_SourceCategory=accessKeys (AccessKeyCreated OR AccessKeyDeleted OR AccessKeyUpdated)<br />\| json "eventName", "eventTime", "accessId", "operator.email", "operator.id", "operator.sourceIp", "accessKey.accessKeyLabel", "accessKey.enabled", "to", "from", "to.enabled"  as EventName, EventTime, AccessId, User, UserId, UserIp, AccessKeyLabel, IsActive, CurrentValue, PreviousValue, IsActiveUpdated nodrop<br />\| where EventName in ("AccessKeyCreated","AccessKeyDeleted","AccessKeyUpdated") <br />\| where EventName matches "{{EventName}}" and AccessId matches "{{AccessId}}" and User matches "{{User}}" and UserIp matches "{{UserIp}}" and AccessKeyLabel matches "{{AccessKeyLabel}}"<br />\| timeslice 1d<br />\| count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d),<br />  values("AccessKeyCreated", "AccessKeyUpdated", "AccessKeyDeleted") in EventName<br />\| transpose row \_timeslice column EventName<br />|
|Enterprise Audit - Security Management|Trend - AllowList Users|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities|\_index=sumologic\_audit\_events \_sourceCategory=saml (AllowlistedUsersCreated OR AllowlistedUsersDeleted)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("AllowlistedUsersCreated", "AllowlistedUsersDeleted") AND EventName matches "{{EventName}}"<br />\| timeslice 1d<br />\| count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d),<br />  values("AllowlistedUsersCreated", "AllowlistedUsersDeleted") in EventName<br />\| transpose row \_timeslice column EventName|
|Enterprise Audit - Security Management|Trend - SAML Configuration|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - SAML Activities|\_index=sumologic\_audit\_events  \_sourceCategory=saml (SamlConfigurationCreated OR SamlConfigurationUpdated OR SamlConfigurationDeleted)<br />\| json "eventName" as EventName nodrop<br />\| where EventName in ("SamlConfigurationCreated", "SamlConfigurationUpdated", "SamlConfigurationDeleted") <br />\| where  EventName matches "{{EventName}}"  <br />\| timeslice 1d<br />\| count as Count by \_timeslice, EventName<br />\| fillmissing timeslice(1d),<br />  values("SamlConfigurationCreated", "SamlConfigurationUpdated", "SamlConfigurationDeleted") in EventName<br />\| transpose row \_timeslice column EventName<br />|
|Enterprise Audit - Security Management|Users Disabled MFA|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=multiFactorAuthentication UserMultiFactorAuthenticationDisabled<br />\| json "eventName", "eventTime", "userIdentity.userEmail" as EventName, EventTime, UserEmail nodrop<br />\| where EventName="UserMultiFactorAuthenticationDisabled"<br />\| count as Count by UserEmail<br />\| sum(Count) as Total|
|Enterprise Audit - Security Management|Users Enabled MFA|Logs|Installed Apps/Enterprise Audit - Security Management/Enterprise Audit - Security Management Overview|\_index=sumologic\_audit\_events \_sourceCategory=multiFactorAuthentication UserMultiFactorAuthenticationEnabled<br />\| json "eventName", "eventTime", "userIdentity.userEmail" as EventName, EventTime, UserEmail nodrop<br />\| where EventName="UserMultiFactorAuthenticationEnabled"<br />\| count as Count by UserEmail<br />\| sum(Count) as Total|

