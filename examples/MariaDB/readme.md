# MariaDB
## Sumo Logic App For: MariaDB
The MariaDB app is a unified logs and metrics app that helps you monitor the availability, performance and resource utilization of MariaDB database clusters. Preconfigured dashboards and searches provide insight into the health of your database clusters, performance metrics, resource metrics, schema metrics, replication, error logs, slow queries, Innodb operations, failed logins and error logs.
Docs Link: [MariaDB](https://help.sumologic.com/?cid=220111)

## Searches

### Log Searches

- **Avg Execution Time by Slow SQL Cmds**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Crash Recovery Attempts Over Time**: from Dashboard: MariaDB/Logs/MariaDB - Error Logs 
- **Error Log Type Over Time**: from Dashboard: MariaDB/Logs/MariaDB - Error Logs 
- **Errors**: from Dashboard: MariaDB/MariaDB - Overview 
- **Excessive Slow Queries (>=15 secs)**: from Dashboard: MariaDB/MariaDB - Overview 
- **Excessive Slow Queries by Host**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Excessive Slow Queries Over Time**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Failed Login Attempts**: from Dashboard: MariaDB/Logs/MariaDB - Failed Logins 
- **Failed Login Attempts**: from Dashboard: MariaDB/MariaDB - Overview 
- **Failed Login Attempts - Details**: from Dashboard: MariaDB/Logs/MariaDB - Failed Logins 
- **Failed Login Attempts - Location**: from Dashboard: MariaDB/Logs/MariaDB - Failed Logins 
- **Failed Login Attempts - Location**: from Dashboard: MariaDB/MariaDB - Overview 
- **Failed Login Over Time**: from Dashboard: MariaDB/Logs/MariaDB - Failed Logins 
- **Log Reduce**: from Dashboard: MariaDB/Logs/MariaDB - Error Logs 
- **MariaDB -  Slow Query Server Location**: from Search: MariaDB/Logs/Searches/MariaDB -  Slow Query Server Location 
- **MariaDB - Crash Recovery Attempts by Host**: from Search: MariaDB/Logs/Searches/MariaDB - Crash Recovery Attempts by Host 
- **MariaDB - Number of Replication Completion Events by Host**: from Search: MariaDB/Logs/Searches/MariaDB - Number of Replication Completion Events by Host 
- **MariaDB - Replication Failures by Host**: from Search: MariaDB/Logs/Searches/MariaDB - Replication Failures by Host 
- **MariaDB - Server Latest Replication State**: from Search: MariaDB/Logs/Searches/MariaDB - Server Latest Replication State 
- **MariaDB - Server Latest Running State**: from Search: MariaDB/Logs/Searches/MariaDB - Server Latest Running State 
- **MariaDB - Server Up-Down Events by Host**: from Search: MariaDB/Logs/Searches/MariaDB - Server Up-Down Events by Host 
- **Replication Errors**: from Dashboard: MariaDB/MariaDB - Overview 
- **Replication Start-Stop Events**: from Dashboard: MariaDB/Logs/MariaDB - Replication 
- **Replication Status Over Time**: from Dashboard: MariaDB/Logs/MariaDB - Replication 
- **Server Start and Shutdown Events Over Time**: from Dashboard: MariaDB/Logs/MariaDB - Error Logs 
- **Slow Queries by Client IPs**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Slow Queries by Hosts**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Slow Queries by Users**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Slow Queries Over Time**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Slow Queries Over Time**: from Dashboard: MariaDB/MariaDB - Overview 
- **Slow Query by Cmd Type**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Stopped Servers**: from Dashboard: MariaDB/Logs/MariaDB - Error Logs 
- **Top 10 Errors**: from Dashboard: MariaDB/MariaDB - Overview 
- **Top 10 Excessive Slow Queries by Frequency**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Top 10 Hosts by Failed Login Attempts**: from Dashboard: MariaDB/Logs/MariaDB - Failed Logins 
- **Top 10 Slow Queries by Average Execution Time**: from Dashboard: MariaDB/Logs/MariaDB - Slow Queries 
- **Top 10 Users by Failed Login Attempts**: from Dashboard: MariaDB/Logs/MariaDB - Failed Logins 
- **Top 10 Warnings**: from Dashboard: MariaDB/MariaDB - Overview 
- **Top Errors**: from Dashboard: MariaDB/Logs/MariaDB - Error Logs 
- **Top Reasons for Replication Failures**: from Dashboard: MariaDB/Logs/MariaDB - Replication 
- **Top Warnings**: from Dashboard: MariaDB/Logs/MariaDB - Error Logs

### Metric Searches

- **Aborted and Locked Connects**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Aborted Clients**: from Dashboard: MariaDB/MariaDB - Overview 
- **Aborted Clients**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Avg Row Lock Rate**: from Dashboard: MariaDB/MariaDB - Overview 
- **Binlog Written**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Buffer Pool Pages Data**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Buffer Pool Pages Free**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Buffer Pool Pages Misc**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Bytes Sent, Received**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Connection Errors**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Connection Errors (Internal  and Max Connections)**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Connection Retry**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Connections**: from Dashboard: MariaDB/MariaDB - Overview 
- **Connections**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Data Fsyncs**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Data Reads**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Data Writes**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Disk Reads vs Writes**: from Dashboard: MariaDB/MariaDB - Overview 
- **Executed SQL Statements**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **FSync Op Count**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **FSync Op Count**: from Dashboard: MariaDB/MariaDB - Overview 
- **Innodb Buffer Pool Read Requests vs Disk Reads**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **InnoDB Buffer Pool Requests**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **InnoDB Buffer Pool Size**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Innodb Buffer Pool Usage**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Innodb Buffer Pool Usage**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **InnoDB Buffer Reads**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **InnoDB Change Buffer Activity (metrics)**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Innodb Data (fsyncs, read, write)**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **InnoDB Data Read**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **InnoDB Locks**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Innodb Read-Ahead**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Innodb Row Lock Waits**: from Dashboard: MariaDB/MariaDB - Overview 
- **Innodb Row Lock Waits**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Innodb Rows (read, updated, inserted, deleted)**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **InnoDB Transactions**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Innodb Waits**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **InnoDB Waits**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **IO capacity (Variable)**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **IO Thread Running**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Log Fsyncs**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Log Writes**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Master Log Pos**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Master Servers**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Master Servers**: from Dashboard: MariaDB/MariaDB - Overview 
- **Memory Used (MB)**: from Dashboard: MariaDB/MariaDB - Overview 
- **Network Bytes - Received vs Sent**: from Dashboard: MariaDB/MariaDB - Overview 
- **Open Table Cache Hit Ratio**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Opened Tables and Files**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Pages Created**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Pages Read**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Pages Written**: from Dashboard: MariaDB/Metrics/MariaDB - InnoDB Metrics 
- **Queries Executed**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Queries Executed**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Query Cache (Hits, Inserts)**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Questions**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Questions**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Read Only**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Relay Log Space**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Replication Delay**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Replication Error No**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Running Threads**: from Dashboard: MariaDB/MariaDB - Overview 
- **Select Types**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Server Uptime**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Server Uptime (Days)**: from Dashboard: MariaDB/MariaDB - Overview 
- **Slave  Servers Error**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Slave Servers**: from Dashboard: MariaDB/MariaDB - Overview 
- **Slave Servers**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Slave Servers with Errors**: from Dashboard: MariaDB/MariaDB - Overview 
- **Slow Queries**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Slow Queries**: from Dashboard: MariaDB/MariaDB - Overview 
- **Sorts (Rows, Range, Scan, Merge Passes)**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **SQL Thread Running**: from Dashboard: MariaDB/Metrics/MariaDB - Replication Metrics 
- **Table Lock Waits**: from Dashboard: MariaDB/MariaDB - Overview 
- **Table Open Cache Hits, Misses and Overflows**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Tables Locks**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Temporary Objects**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Threads (Created, Running, Cached, Connected)**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics 
- **Worker Threads**: from Dashboard: MariaDB/Metrics/MariaDB - Performance and Resource Metrics

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|MariaDB/Metrics|Aborted and Locked Connects|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_aborted\_connects  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB/Metrics|Aborted Clients|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_aborted\_clients db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB|Aborted Clients|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_aborted\_clients db\_cluster={{db\_cluster}} db\_system=mariadb\| sum|
|MariaDB/Logs|Avg Execution Time by Slow SQL Cmds|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" // Pttrn2-vrtn4<br />\| parse regex field=query\_block "SET timestamp=(?\<set\_timestamp\>\\d\*);(?:\\\\n\|\\n)(?\<sql\_cmd\>[\\s\\S]\*);" nodrop<br />\| parse regex field=sql\_cmd "[^a-zA-Z]\*(?\<sql\_cmd\_type\>[a-zA-Z]+)(?:\\s\|\\\\n\|\\n)" nodrop<br />\| parse field=sql\_cmd "# administrator command: \*" as admn\_sql\_cmd<br />\| if (sql\_cmd matches "# administrator command: \*", admn\_sql\_cmd, sql\_cmd\_type) as sql\_cmd\_type<br />\| toUpperCase(sql\_cmd\_type)<br />\| fields -query\_block<br />\| timeslice 1h<br />\| avg(query\_time) as avg\_query\_time group by \_timeslice, sql\_cmd\_type<br />\| transpose row \_timeslice column sql\_cmd\_type|
|MariaDB|Avg Row Lock Rate|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_innodb\_row\_lock\_waits db\_cluster={{db\_cluster}} db\_system=mariadb \| avg|
|MariaDB/Metrics|Binlog Written|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb metric=mysql\_binlog\_bytes\_written db\_system=mariadb db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB/Metrics|Buffer Pool Pages Data|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_buffer\_pool\_pages\_data db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Buffer Pool Pages Free|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_buffer\_pool\_pages\_free db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Buffer Pool Pages Misc|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_buffer\_pool\_pages\_misc  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| count by db\_cluster, host, server|
|MariaDB/Metrics|Bytes Sent, Received|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_bytes\_received db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Connection Errors|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_connection\_errors\_\*  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum|
|MariaDB/Metrics|Connection Errors (Internal  and Max Connections)|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_connection\_errors\_internal db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB/Metrics|Connection Retry|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb metric=mysql\_slave\_connect\_retry db\_system=mariadb db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB/Metrics|Connections|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_connections db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB|Connections|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_connections db\_cluster={{db\_cluster}} \| sum |
|MariaDB/Logs|Crash Recovery Attempts Over Time|Logs|MariaDB/Logs/MariaDB - Error Logs|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "Crash recovery"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| \_sourceHost as Host<br />\| timeslice 1h<br />\| count as recovery\_attempts by \_timeslice|
|MariaDB/Metrics|Data Fsyncs|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_data\_fsyncs db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Data Reads|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_data\_reads db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Data Writes|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_data\_writes db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB|Disk Reads vs Writes|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_innodb\_data\_reads db\_cluster={{db\_cluster}} db\_system=mariadb \| sum by db\_cluster,host,server|
|MariaDB/Logs|Error Log Type Over Time|Logs|MariaDB/Logs/MariaDB - Error Logs|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} (Error or Warning or Note or Info or Information or DEBUG or CRITICAL)<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| where touppercase(ErrorLogtype) in ("ERROR", "WARNING", "NOTE", "INFO", "INFORMATION", "DEBUG", "CRITICAL")<br />\| timeslice 1h<br />\| count by \_timeslice, ErrorLogtype<br />\| transpose row \_timeslice column ErrorLogType|
|MariaDB|Errors|Logs|MariaDB/MariaDB - Overview| db\_system=mariadb db\_cluster={{db\_cluster}} "[ERROR]"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)"<br />\| where ErrorLogtype="ERROR" \| count as error\_count|
|MariaDB|Excessive Slow Queries (\>=15 secs)|Logs|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" // Pttrn2-vrtn4<br />\| fields -query\_block<br />\| num(query\_time)<br />\| 15 as threshold // customize if need different value. As an example query taking more than 15 Seconds is considered as Excessive Slow. <br />\| where query\_time \>= threshold \| count as queries\_count|
|MariaDB/Logs|Excessive Slow Queries by Host|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" // Pttrn2-vrtn4<br />\| num(query\_time)<br />\| 15 as threshold // customize if need different value. As an example query taking more than 15 Seconds is considered as Excessive Slow. <br />\| where (query\_time \>= threshold)<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| fields -query\_block<br />\| count as queries\_count by host \| sort by queries\_count|
|MariaDB/Logs|Excessive Slow Queries Over Time|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" // Pttrn2-vrtn4<br />\| num(query\_time)<br />\| 15 as threshold // customize if need different value. As an example query taking more than 15 Seconds is considered as Excessive Slow. <br />\| where query\_time \>= threshold <br />\| timeslice 1h<br />\| count as queries\_count by \_timeslice|
|MariaDB/Metrics|Executed SQL Statements|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_com\_insert db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| parse field=metric mysql\_com\_\* as com \| sum by db\_cluster, host, server, com|
|MariaDB|Failed Login Attempts|Logs|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "Access denied for user"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse field=mariadb\_log\_message "Access denied for user '\*'@'\*' (using password: YES)" as user, ip\_address<br />\| count as failed\_login\_count|
|MariaDB/Logs|Failed Login Attempts|Logs|MariaDB/Logs/MariaDB - Failed Logins|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[Warning]" "Access denied for user"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Access denied for user '\*'@'\*' (using password: YES)" as user, ip\_address<br />\| count as failed\_login\_event\_count|
|MariaDB/Logs|Failed Login Attempts - Details|Logs|MariaDB/Logs/MariaDB - Failed Logins|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[Warning]" "Access denied for user"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Access denied for user '\*'@'\*' (using password: YES)" as user, ip\_address<br />\| timeslice 1s<br />\| count as event\_count by \_timeslice, user, ip\_address, db\_cluster<br />\| sort by \_timeslice \| limit 10|
|MariaDB|Failed Login Attempts - Location|Logs|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "Access denied for user"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse field=mariadb\_log\_message "Access denied for user '\*'@'\*' (using password: YES)" as user, ip\_address<br />\| count as event\_count by ip\_address<br />\| lookup latitude, longitude, country\_name, state, city from geo://location on ip = ip\_address<br />\| where !isNull(latitude)|
|MariaDB/Logs|Failed Login Attempts - Location|Logs|MariaDB/Logs/MariaDB - Failed Logins|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[Warning]" "Access denied for user"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Access denied for user '\*'@'\*' (using password: YES)" as user, ip\_address<br />\| count as event\_count by ip\_address<br />\| lookup latitude, longitude, country\_name, state, city from geo://location on ip = ip\_address<br />\| where !isNull(latitude)|
|MariaDB/Logs|Failed Login Over Time|Logs|MariaDB/Logs/MariaDB - Failed Logins|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}}  "[Warning]" "Access denied for user"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Access denied for user '\*'@'\*' (using password: YES)" as user, ip\_address<br />\| timeslice 1h<br />\| count as event\_count by \_timeslice|
|MariaDB|FSync Op Count|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_innodb\_data\_fsyncs db\_cluster={{db\_cluster}} db\_system=mariadb\| sum|
|MariaDB/Metrics|FSync Op Count|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_data\_fsyncs db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum|
|MariaDB/Metrics|Innodb Buffer Pool Read Requests vs Disk Reads|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_buffer\_pool\_read\_requests  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|InnoDB Buffer Pool Requests|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_buffer\_pool\_read\_requests db\_cluster={{db\_cluster}} host={{host}} server={{server}}|
|MariaDB/Metrics|InnoDB Buffer Pool Size|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_variables\_innodb\_buffer\_pool\_size  db\_cluster={{db\_cluster}} host={{host}} server={{server}} |
|MariaDB/Metrics|Innodb Buffer Pool Usage|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_buffer\_pool\_pages\_total db\_cluster={{db\_cluster}} host={{host}} server={{server}}\| sum|
|MariaDB/Metrics|Innodb Buffer Pool Usage|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_Innodb\_buffer\_pool\_pages\_total db\_cluster={{db\_cluster}} host={{host}} server={{server}}\| sum by db\_cluster,host,server|
|MariaDB/Metrics|InnoDB Buffer Reads|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_buffer\_pool\_reads  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|InnoDB Change Buffer Activity (metrics)|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_ibuf\_merges db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| count by db\_cluster, host, server|
|MariaDB/Metrics|Innodb Data (fsyncs, read, write)|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_data\_read db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| parse field=metric mysql\_innodb\_data\_\* as data \|  sum by db\_cluster,host,data,server|
|MariaDB/Metrics|InnoDB Data Read|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_data\_reads db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|InnoDB Locks|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_row\_lock\_time db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| count by db\_cluster, host, server|
|MariaDB/Metrics|Innodb Read-Ahead|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_buffer\_pool\_read\_ahead db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB|Innodb Row Lock Waits|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_innodb\_row\_lock\_waits db\_cluster={{db\_cluster}} db\_system=mariadb \| sum by db\_cluster,host,server|
|MariaDB/Metrics|Innodb Row Lock Waits|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_row\_lock\_waits  db\_cluster={{db\_cluster}} host={{host}} server={{server}}\| sum by db\_cluster, host, server|
|MariaDB/Metrics|Innodb Rows (read, updated, inserted, deleted)|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_rows\_read db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| parse field=metric mysql\_innodb\_rows\_\* as row \|  sum by db\_cluster,host,row,server|
|MariaDB/Metrics|InnoDB Transactions|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_max\_trx\_id  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host,server|
|MariaDB/Metrics|Innodb Waits|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_log\_waits  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB/Metrics|InnoDB Waits|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_log\_waits  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| count by db\_cluster, host, server|
|MariaDB/Metrics|IO capacity (Variable)|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_variables\_innodb\_io\_capacity  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|IO Thread Running|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_slave\_slave\_io\_running db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Log Fsyncs|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_os\_log\_fsyncs db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Logs|Log Reduce|Logs|MariaDB/Logs/MariaDB - Error Logs|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} ("ERROR" or "CRITICAL") <br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| logreduce(mesg) by db\_cluster limit=20<br />\| \_count as count \| fields -\_count \| sort by count, signature asc|
|MariaDB/Metrics|Log Writes|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_log\_writes  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Logs/Searches|MariaDB -  Slow Query Server Location|Logs|MariaDB/Logs/Searches/MariaDB -  Slow Query Server Location|\_sourceCategory = Labs/mariadb db\_system=mariadb "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ \\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop // Pttrn1-vrtn1<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @\\s+\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" nodrop // Pttrn1-vrtn2<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" // Pttrn1-vrtn3<br />\| count by db\_cluster, ip\_addr, host\_name<br />\| where !isEmpty(ip\_addr)<br />\| lookup latitude, longitude, country\_name, state, city, postal\_code from geo://location on ip=ip\_addr<br />\| where !isNull(latitude)|
|MariaDB/Logs/Searches|MariaDB - Crash Recovery Attempts by Host|Logs|MariaDB/Logs/Searches/MariaDB - Crash Recovery Attempts by Host|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster=\* "Crash recovery"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| where mesg matches "\*Crash recovery\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| count as recovery\_attempts by host, db\_cluster <br />\| Sort by recovery\_attempts|
|MariaDB/Logs/Searches|MariaDB - Number of Replication Completion Events by Host|Logs|MariaDB/Logs/Searches/MariaDB - Number of Replication Completion Events by Host|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster=\* "Slave SQL thread" "because it reached its UNTIL position"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Slave SQL thread \* because it reached its UNTIL position \*" as State, StoppedUntilPosition<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| timeslice 3h<br />\| count by \_timeslice, host, db\_cluster<br />\| transpose row \_timeslice column host, db\_cluster|
|MariaDB/Logs/Searches|MariaDB - Replication Failures by Host|Logs|MariaDB/Logs/Searches/MariaDB - Replication Failures by Host|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster=\* "[ERROR]" ("Slave I/O" or "Error reading packet from server" or "Slave SQL")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| where ErrorLogtype="ERROR"<br />\| parse field=ErrorMsg "\*: error \* to master '\*' - retry-time: \* retries: \*, Error\_code: \*" as subsystem, action, Master, Retry\_time, Retries, Error\_code nodrop<br />\| parse field=ErrorMsg "\*: Got fatal error \*, Error\_code: \*" as subsystem, Error\_Msg, Error\_code nodrop<br />\| parse field=ErrorMsg "\*: \* ( server\_errno=\*)" as subsystem, Error\_Msg, Error\_code nodrop<br />\| parse field=ErrorMsg "\*: The slave I/O thread stops because \*. Error:\*, Error\_code: \*" as subsystem, Error\_Msg\_details, Error\_Msg, Error\_code nodrop<br />\| parse field=ErrorMsg "\*: \* Default database: '\*'. Query: '\*', Error\_code: \*" as subsystem, Error\_Msg, Default\_Database, Query, Error\_code nodrop<br />\| parse field=ErrorMsg "\*: Cou\*d not execute \*" as subsystem, f1, Error\_Msg nodrop<br />\| parse field=ErrorMsg "\*: Master command \*, Error\_code: \*" as subsystem, Error\_Msg, Error\_code nodrop<br />\| parse field=ErrorMsg "\* thread couldn't register on master" as subsystem nodrop<br />\| timeslice 1h<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| count by \_timeslice, host, db\_cluster<br />\| transpose row \_timeslice column host, db\_cluster|
|MariaDB/Logs/Searches|MariaDB - Server Latest Replication State|Logs|MariaDB/Logs/Searches/MariaDB - Server Latest Replication State|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster=\* ("[Note]" or ("[ERROR]" ("Slave I/O" or "Error reading packet from server" or "Slave SQL")))<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Slave SQL thread initialized, \* replication in log '\*' at position \*, relay log '\*' position: \*" as replication\_state, ReplicationLog, ReplicationPosition, ReplayLog, RelayPosition nodrop<br />\| parse field=ErrorMsg "Slave SQL thread \* because it reached its UNTIL position \*" as replication\_state, StoppedUntilPosition nodrop<br />\| parse field=ErrorMsg "Error reading relay log event: slave SQL thread was \*" as replication\_state nodrop<br />\| if(\_raw matches "\*[ERROR] Slave I/O\*" or \_raw matches "\*[ERROR] Error reading packet from server\*"  or \_raw matches "\*[ERROR] Slave SQL\*","failed", replication\_state) as replication\_state<br />\| where replication\_state in ("starting", "stopped", "killed", "failed")<br />\| if (replication\_state in ("starting", "stopped"), "Up", "Down") as replication\_state<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| withtime replication\_state \| withtime \_messagetime<br />\| most\_recent(replication\_state\_withtime) as replication\_state, most\_recent(\_messagetime\_withtime) as m\_time by host, db\_cluster<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS Z") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60\*60)) as since\_hours \| format("%.2f", since\_hours) as since\_hours<br />\| concat ("Since ", since\_hours, " hours") as remark<br />\| fields - m\_time <br />\| fields db\_cluster, host, event\_time, replication\_state, remark|
|MariaDB/Logs/Searches|MariaDB - Server Latest Running State|Logs|MariaDB/Logs/Searches/MariaDB - Server Latest Running State|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster=\* mysqld ("ready for connections." or "Shutdown complete" or "Terminated." or "Normal shutdown" or "Shutting down" or "starting as process")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| if (ErrorMsg matches "\*ready for connections.\*", "Up","Unknown") as server\_status<br />\| if (ErrorMsg matches "\*Terminated.\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Normal shutdown\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutting down\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutdown complete\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*starting as process\*", "Starting",server\_status) as server\_status<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| timeslice 15m<br />\| withtime server\_status \| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by host, db\_cluster<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS Z") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60\*60)) as since\_hours \| format("%.2f", since\_hours) as since\_hours<br />\| concat ("Since ", since\_hours, " hours") as remark<br />\| fields - m\_time <br />\| fields host, event\_time, server\_status, remark, db\_cluster|
|MariaDB/Logs/Searches|MariaDB - Server Up-Down Events by Host|Logs|MariaDB/Logs/Searches/MariaDB - Server Up-Down Events by Host|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster=\* mysqld ("ready for connections." or "Shutdown complete" or "Terminated." or "Normal shutdown" or "Shutting down" or "starting as process")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| if (ErrorMsg matches "\*ready for connections.\*", "Up","Unknown") as server\_status<br />\| if (ErrorMsg matches "\*Terminated.\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Normal shutdown\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutting down\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutdown complete\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*starting as process\*", "Starting",server\_status) as server\_status<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| formatDate(fromMillis(\_messagetime), "MM-dd-yyyy HH:mm:ss.SSS Z")  as event\_time<br />\| count by host, event\_time, server\_status, db\_cluster<br />\| sort by host, event\_time, server\_status, db\_cluster<br />\| fields - \_count|
|MariaDB/Metrics|Master Log Pos|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb metric=mysql\_slave\_read\_master\_log\_pos db\_system=mariadb db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| count by db\_cluster,host,server|
|MariaDB|Master Servers|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_slave\_master\_server\_id db\_system=mariadb db\_cluster={{db\_cluster}}  \| filter latest=0 \| count by metric|
|MariaDB/Metrics|Master Servers|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_process\_list\_threads\_replication\_master db\_cluster={{db\_cluster}} host={{host}} server={{server}}  \| filter latest\>0 \| count by metric|
|MariaDB|Memory Used (MB)|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_memory\_used  db\_cluster={{db\_cluster}} db\_system=mariadb \| sum \| eval \_value/1024/1024|
|MariaDB|Network Bytes - Received vs Sent|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_bytes\_received db\_cluster={{db\_cluster}} db\_system=mariadb \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Open Table Cache Hit Ratio|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_table\_open\_cache\_hits db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum|
|MariaDB/Metrics|Opened Tables and Files|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_opened\_tables  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Pages Created|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_pages\_created db\_cluster={{db\_cluster}} host={{host}} server={{server}} |
|MariaDB/Metrics|Pages Read|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_pages\_read  db\_cluster={{db\_cluster}} host={{host}} server={{server}} |
|MariaDB/Metrics|Pages Written|Metrics|MariaDB/Metrics/MariaDB - InnoDB Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_innodb\_pages\_written  db\_cluster={{db\_cluster}} host={{host}} server={{server}} |
|MariaDB/Metrics|Queries Executed|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_queries db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum|
|MariaDB/Metrics|Queries Executed|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_queries db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB/Metrics|Query Cache (Hits, Inserts)|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_qcache\_hits  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Questions|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_questions db\_cluster={{db\_cluster}} host={{host}} server={{server}}\| sum by db\_cluster, host, server|
|MariaDB/Metrics|Questions|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_questions db\_cluster={{db\_cluster}} host={{host}} server={{server}}\| sum|
|MariaDB/Metrics|Read Only|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_variables\_read\_only db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| count by db\_cluster, host, server|
|MariaDB/Metrics|Relay Log Space|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb metric=mysql\_slave\_relay\_log\_space db\_system=mariadb db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB/Metrics|Replication Delay|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb metric=mysql\_slave\_seconds\_behind\_master db\_system=mariadb db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host,server|
|MariaDB/Metrics|Replication Error No|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_slave\_last\_errno db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB|Replication Errors|Logs|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} (("[ERROR]" and ("Slave I/O" or "Error reading packet from server" or "Slave SQL")) or "[Note] Error reading relay log event: slave SQL thread was killed")<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| count as replication\_failure\_count|
|MariaDB/Logs|Replication Start-Stop Events|Logs|MariaDB/Logs/MariaDB - Replication|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[Note]" "SQL thread"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Slave SQL thread initialized, \* replication in log '\*' at position \*, relay log '\*' position: \*" as State,ReplicationLog,ReplicationPosition,ReplayLog,RelayPosition nodrop<br />\| parse field=ErrorMsg "Slave SQL thread exiting, replication \* in log '\*' at position \*" as state,ReplicationLog,RelayPosition nodrop<br />\| where state in ("starting", "stopped")<br />\| timeslice 1h<br />\| count as event\_count by \_timeslice, state<br />\| transpose row \_timeslice column state as starting, stopped<br />\| (starting+stopped)/2 as halfway\_count|
|MariaDB/Logs|Replication Status Over Time|Logs|MariaDB/Logs/MariaDB - Replication|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} ("[Note]" or ("[ERROR]" ("Slave I/O" or "Error reading packet from server" or "Slave SQL")))<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Slave SQL thread initialized, \* replication in log '\*' at position \*, relay log '\*' position: \*" as State,ReplicationLog,ReplicationPosition,ReplayLog,RelayPosition nodrop<br />\| parse field=ErrorMsg "Slave SQL thread \* because it reached its UNTIL position \*" as State, StoppedUntilPosition nodrop<br />\| parse field=ErrorMsg "Error reading relay log event: slave SQL thread was \*" as state nodrop<br />\| if(\_raw matches "\*[ERROR] Slave I/O\*" or \_raw matches "\*[ERROR] Error reading packet from server\*"  or \_raw matches "\*[ERROR] Slave SQL\*","failed",state) as state<br />\| where state in ("starting", "stopped", "killed", "failed")<br />\| timeslice 1h<br />\| count by \_timeslice, state<br />\| transpose row \_timeslice column state<br />\| fillmissing timeslice(1h)|
|MariaDB|Running Threads|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_threads\_running db\_cluster={{db\_cluster}} db\_system=mariadb \| sum|
|MariaDB/Metrics|Select Types|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_select\_full\_join  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| parse field=metric mysql\_select\_\* as type \|  sum by db\_cluster,host,server,type|
|MariaDB/Logs|Server Start and Shutdown Events Over Time|Logs|MariaDB/Logs/MariaDB - Error Logs|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} ("ready for connections" or "Shutdown complete" or "Terminated." or "Normal shutdown" or "Shutting down" or "starting as process")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| if (ErrorMsg matches "\*ready for connections\*", "Up","Unknown") as server\_status<br />\| if (ErrorMsg matches "\*Terminated.\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Normal shutdown\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutting down\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutdown complete\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*starting as process\*", "Starting",server\_status) as server\_status<br />\| timeslice 15m<br />\| count by \_timeslice, server\_status<br />\| transpose row \_timeslice column server\_status|
|MariaDB/Metrics|Server Uptime|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_uptime db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| max \| eval \_value / 86400|
|MariaDB|Server Uptime (Days)|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_uptime db\_cluster={{db\_cluster}} \| max \| eval \_value / 86400|
|MariaDB/Metrics|Slave  Servers Error|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb (metric=mysql\_slave\_last\_io\_errno or metric=mysql\_slave\_last\_sql\_errno) db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| filter latest \> 0 \| sum by db\_cluster,host,server \| count|
|MariaDB|Slave Servers|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_slave\_master\_server\_id db\_system=mariadb db\_cluster={{db\_cluster}} \| filter latest\>0 \| count|
|MariaDB/Metrics|Slave Servers|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_slave\_master\_server\_id db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| filter latest\>0 \| count by metric|
|MariaDB|Slave Servers with Errors|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb (metric=mysql\_slave\_last\_io\_errno or metric=mysql\_slave\_last\_sql\_errno) db\_cluster={{db\_cluster}} \| filter latest \> 0 \| sum by db\_cluster,host,server \| count|
|MariaDB/Metrics|Slow Queries|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_slow\_queries db\_cluster={{db\_cluster}} host={{host}} server={{server}}\| sum|
|MariaDB|Slow Queries|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_slow\_queries db\_cluster={{db\_cluster}} db\_system=mariadb \| sum|
|MariaDB/Logs|Slow Queries by Client IPs|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ \\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop // Pttrn1-vrtn1<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @\\s+\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" nodrop // Pttrn1-vrtn2<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" // Pttrn1-vrtn3<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" nodrop // Pttrn2-vrtn4<br />\| num(query\_time) as query\_time<br />\| where query\_time \>= {{slow\_query\_latency}}<br />\| fields -query\_block<br />\| count as frequency by ip\_addr <br />\| where !isEmpty(ip\_addr)<br />\| sort by frequency|
|MariaDB/Logs|Slow Queries by Hosts|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" nodrop // Pttrn2-vrtn4<br />\| num(query\_time) as query\_time<br />\| where query\_time \>= {{slow\_query\_latency}}<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| fields -query\_block<br />\| count as queries\_count by host <br />\| sort by queries\_count|
|MariaDB/Logs|Slow Queries by Users|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ \\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop // Pttrn1-vrtn1<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @\\s+\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" nodrop // Pttrn1-vrtn2<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" // Pttrn1-vrtn3<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" nodrop // Pttrn2-vrtn4<br />\| num(query\_time) as query\_time<br />\| where query\_time \>= {{slow\_query\_latency}}<br />\| fields -query\_block<br />\| count as frequency by user \| sort by frequency|
|MariaDB|Slow Queries Over Time|Logs|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| timeslice 1h<br />\| count as queries\_count by \_timeslice|
|MariaDB/Logs|Slow Queries Over Time|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" nodrop // Pttrn2-vrtn4<br />\| num(query\_time) as query\_time<br />\| where query\_time \>= {{slow\_query\_latency}}<br />\| timeslice 1h<br />\| count as queries\_count by \_timeslice|
|MariaDB/Logs|Slow Query by Cmd Type|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "SET timestamp=(?\<set\_timestamp\>\\d\*);(?:\\\\n\|\\n)(?\<sql\_cmd\>[\\s\\S]\*);" nodrop<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" nodrop // Pttrn2-vrtn4<br />\| num(query\_time) as query\_time<br />\| where query\_time \>= {{slow\_query\_latency}}<br />\| parse regex field=sql\_cmd "[^a-zA-Z]\*(?\<sql\_cmd\_type\>[a-zA-Z]+)(?:\\s\|\\\\n\|\\n)" nodrop<br />\| parse field=sql\_cmd "# administrator command: \*" as admn\_sql\_cmd<br />\| if (sql\_cmd matches "# administrator command: \*", admn\_sql\_cmd, sql\_cmd\_type) as sql\_cmd\_type<br />\| toUpperCase(sql\_cmd\_type)<br />\| fields -query\_block<br />\| count as frequency group by sql\_cmd\_type \| sort by frequency|
|MariaDB/Metrics|Sorts (Rows, Range, Scan, Merge Passes)|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_sort\_rows db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| parse field=metric mysql\_sort\_\* as sorts \|  sum by db\_cluster,host,server,sorts|
|MariaDB/Metrics|SQL Thread Running|Metrics|MariaDB/Metrics/MariaDB - Replication Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_slave\_slave\_sql\_running db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Logs|Stopped Servers|Logs|MariaDB/Logs/MariaDB - Error Logs|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} ("ready for connections."  or "Terminated." or "Shutdown complete" or "Normal shutdown")<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| if (ErrorMsg matches "\*ready for connections.\*", "Up","Unknown") as server\_status<br />\| if (ErrorMsg matches "\*Terminated.\*", "Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Normal shutdown\*", "Shutting Down", server\_status) as server\_status<br />\| if (ErrorMsg matches "\*Shutdown complete\*", "Down", server\_status) as server\_status<br />\| \_sourceHost as Host<br />\| timeslice 100s<br />\| withtime server\_status \| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by Host, db\_cluster<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS Z") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60)) as since\_mins \| format("%.2f", since\_mins) as since\_minutes<br />\| concat ("Since ", since\_minutes, " minutes") as remark<br />\| where server\_status != "Up"<br />\| fields - m\_time, since\_mins, since\_minutes <br />\| fields Host, event\_time, server\_status, remark, db\_cluster|
|MariaDB|Table Lock Waits|Metrics|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb metric=mysql\_table\_locks\_waited db\_cluster={{db\_cluster}} db\_system=mariadb \| sum|
|MariaDB/Metrics|Table Open Cache Hits, Misses and Overflows|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_table\_open\_cache\_hits db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| parse field=metric mysql\_table\_open\_cache\_\* as cache \|  sum by db\_cluster,host,cache, server|
|MariaDB/Metrics|Tables Locks|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_table\_locks\_immediate  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Temporary Objects|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_created\_tmp\_disk\_tables  db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster, host, server|
|MariaDB/Metrics|Threads (Created, Running, Cached, Connected)|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_threads\_created db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| parse field=metric mysql\_threads\_\* as thread \|  sum by db\_cluster,host,thread,server|
|MariaDB|Top 10 Errors|Logs|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[ERROR]"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)"<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| ErrorMsg as error\_message<br />\| count as frequency by error\_message, db\_cluster, host<br />\| sort by frequency, error\_message asc<br />\| fields db\_cluster,host,error\_message,frequency<br />\| limit 10|
|MariaDB/Logs|Top 10 Excessive Slow Queries by Frequency|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ \\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop // Pttrn1-vrtn1<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @\\s+\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" nodrop // Pttrn1-vrtn2<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" // Pttrn1-vrtn3<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" // Pttrn2-vrtn4<br />\| parse regex field=query\_block "# Bytes\_sent:\\s+(?\<bytes\_sent\>\\d\*)\\s+Tmp\_tables:\\s+(?\<tmp\_tables\>\\d\*)\\s+Tmp\_disk\_tables:\\s+(?\<temp\_disk\_tables\>\\d\*)\\s+Tmp\_table\_sizes:\\s+(?\<tmp\_table\_sizes\>\\d\*)\\n" nodrop // Pttrn3-vrtn1<br />\| parse regex field=query\_block "# Bytes\_sent:\\s+(?\<bytes\_sent\>\\d\*)\\n" nodrop // Pttrn3-vrtn2<br />\| parse regex field=query\_block "SET timestamp=(?\<set\_timestamp\>\\d\*);(?:\\\\n\|\\n)(?\<sql\_cmd\>[\\s\\S]\*);" nodrop<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| fields -query\_block<br />\| count as frequency, sum(query\_time) as total\_time, min(query\_time) as min\_time, max(query\_time) as max\_time, avg(query\_time) as avg\_time, avg(rows\_examined) as avg\_rows\_examined, avg(rows\_sent) as avg\_rows\_sent, avg(Lock\_Time) as avg\_lock\_time group by sql\_cmd, host<br />\| where avg\_time \>= {{slow\_query\_latency}}<br />\| sort by frequency \| limit 10|
|MariaDB/Logs|Top 10 Hosts by Failed Login Attempts|Logs|MariaDB/Logs/MariaDB - Failed Logins|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[Warning]" "Access denied for user"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Access denied for user '\*'@'\*' (using password: YES)" as user, ip\_address<br />\| count as event\_count by ip\_address<br />\| top 10 ip\_address by event\_count|
|MariaDB/Logs|Top 10 Slow Queries by Average Execution Time|Logs|MariaDB/Logs/MariaDB - Slow Queries|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "User@Host" "Query\_time"<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as mariadb\_log\_message<br />\| parse regex field=mariadb\_log\_message "(?\<query\_block\># User@Host:[\\S\\s]+?SET timestamp=\\d+;[\\S\\s]+?;)" multi<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ \\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]" nodrop // Pttrn1-vrtn1<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @\\s+\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" nodrop // Pttrn1-vrtn2<br />\| parse regex field=query\_block "# User@Host: \\S+?\\[(?\<user\>\\S\*?)\\] @ (?\<host\_name\>\\S+)\\s\\[(?\<ip\_addr\>\\S\*?)\\]\\s+Id:\\s+(?\<Id\>\\d{1,10})" // Pttrn1-vrtn3<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d.]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d.]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d.]\*)\\s+Rows\_read:\\s+(?\<rows\_read\>[\\d.]\*)\\n" nodrop // Pttrn2-vrtn1<br />\| parse regex field=query\_block "Schema: (?\<schema\>(?:\\S\*\|\\s)?)\\s\*Last\_errno[\\s\\S]+?\\s+Killed:\\s+\\d+\\n" nodrop // Pttrn2-vrtn2<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)\\s+Rows\_affected:\\s+(?\<rows\_affected\>[\\d]\*)\\s+" nodrop // Pttrn2-vrtn3<br />\| parse regex field=query\_block "Query\_time:\\s+(?\<query\_time\>[\\d.]\*)\\s+Lock\_time:\\s+(?\<lock\_time\>[\\d.]\*)\\s+Rows\_sent:\\s+(?\<rows\_sent\>[\\d]\*)\\s+Rows\_examined:\\s+(?\<rows\_examined\>[\\d]\*)" // Pttrn2-vrtn4<br />\| parse regex field=query\_block "# Bytes\_sent:\\s+(?\<bytes\_sent\>\\d\*)\\s+Tmp\_tables:\\s+(?\<tmp\_tables\>\\d\*)\\s+Tmp\_disk\_tables:\\s+(?\<temp\_disk\_tables\>\\d\*)\\s+Tmp\_table\_sizes:\\s+(?\<tmp\_table\_sizes\>\\d\*)\\n" nodrop // Pttrn3-vrtn1<br />\| parse regex field=query\_block "# Bytes\_sent:\\s+(?\<bytes\_sent\>\\d\*)\\n" nodrop // Pttrn3-vrtn2<br />\| parse regex field=query\_block "SET timestamp=(?\<set\_timestamp\>\\d\*);(?:\\\\n\|\\n)(?\<sql\_cmd\>[\\s\\S]\*);" nodrop<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| fields -query\_block<br />\| avg(query\_time) as avg\_time, sum(query\_time) as total\_time, min(query\_time) as min\_time, max(query\_time) as max\_time, avg(rows\_examined) as avg\_rows\_examined, avg(rows\_sent) as avg\_rows\_sent, avg(Lock\_Time) as avg\_lock\_time, count as frequency group by sql\_cmd, host<br />\| where avg\_time \>= {{slow\_query\_latency}}<br />\| sort by avg\_time \| limit 10|
|MariaDB/Logs|Top 10 Users by Failed Login Attempts|Logs|MariaDB/Logs/MariaDB - Failed Logins|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[Warning]" "Access denied for user"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| parse field=ErrorMsg "Access denied for user '\*'@'\*' (using password: YES)" as user, ip\_address<br />\| count as event\_count by user<br />\| top 10 user by event\_count|
|MariaDB|Top 10 Warnings|Logs|MariaDB/MariaDB - Overview|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[Warning]"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)"<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| ErrorMsg as warning\_message<br />\| count as frequency by warning\_message, db\_cluster, host<br />\| sort by frequency, warning\_message asc<br />\| fields db\_cluster,host,warning\_message,frequency<br />\| limit 10|
|MariaDB/Logs|Top Errors|Logs|MariaDB/Logs/MariaDB - Error Logs|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[ERROR]"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)"<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| ErrorMsg as error\_message<br />\| count as frequency by error\_message, db\_cluster, host<br />\| sort by frequency, error\_message asc<br />\| fields db\_cluster,host,error\_message,frequency<br />\| limit 30|
|MariaDB/Logs|Top Reasons for Replication Failures|Logs|MariaDB/Logs/MariaDB - Replication|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} (("[ERROR]" and ("Slave I/O" or "Error reading packet from server" or "Slave SQL")) or ("[Note] Error reading relay log event: slave SQL thread was killed"))<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)" nodrop<br />\| ErrorMsg as error\_message<br />\| count as frequency by error\_message, db\_cluster<br />\| sort by frequency \| limit 10|
|MariaDB/Logs|Top Warnings|Logs|MariaDB/Logs/MariaDB - Error Logs|\_sourceCategory = Labs/mariadb db\_system=mariadb db\_cluster={{db\_cluster}} "[Warning]"<br />\| json "log" nodrop \| if (\_raw matches "{\*", log, \_raw) as mesg<br />\| parse regex field=mesg "\\[(?\<ErrorLogtype\>[^\\]]\*)][\\:]\*\\s(?\<ErrorMsg\>.\*)"<br />\| if (isEmpty(pod),\_sourceHost,pod) as host<br />\| ErrorMsg as warning\_message<br />\| count as frequency by warning\_message, db\_cluster, host<br />\| sort by frequency, warning\_message asc<br />\| fields db\_cluster,host,warning\_message,frequency<br />\| limit 30|
|MariaDB/Metrics|Worker Threads|Metrics|MariaDB/Metrics/MariaDB - Performance and Resource Metrics|\_sourceCategory = Labs/mariadb db\_system=mariadb metric=mysql\_threadpool\_idle\_threads db\_cluster={{db\_cluster}} host={{host}} server={{server}} \| sum by db\_cluster,host, server|

