# AWS Elastic Load Balancer - Application

## Searches

### Log Searches

- **4XX and 5XX Status Codes by Backend Instance and ELB**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/4XX and 5XX Status Codes by Backend Instance and ELB 
- **4XX and 5XX Status Codes by Backend Instance and ELB**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **ALB Parser 2.0**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/ALB Parser 2.0 
- **Average Req and Resp Processing Time by ELB**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **Average Target Processing Time by Target Group**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **Backend Instance and Load Balancer 4XX Status Codes by Client**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 4XX Status Codes by Client 
- **Backend Instance and Load Balancer 4XX Status Codes by Domain**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 4XX Status Codes by Domain 
- **Backend Instance and Load Balancer 4XX Status Codes by Target Group**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 4XX Status Codes by Target Group 
- **Backend Instance and Load Balancer 4XX Status Codes by URI**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 4XX Status Codes by URI 
- **Backend Instance and Load Balancer 5XX Status Codes by Client**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 5XX Status Codes by Client 
- **Backend Instance and Load Balancer 5XX Status Codes by Domain**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 5XX Status Codes by Domain 
- **Backend Instance and Load Balancer 5XX Status Codes by Target Group**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 5XX Status Codes by Target Group 
- **Backend Instance and Load Balancer 5XX Status Codes by URI**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 5XX Status Codes by URI 
- **Browsers and Operating Systems**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Browsers and Operating Systems 
- **Browsers and Operating Systems**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **Data Sent and Received in MB**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **Failed Dispatch Monitoring**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatch Monitoring 
- **Failed Dispatches by Backend**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatches by Backend 
- **Failed Dispatches by Client**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatches by Client 
- **Failed Dispatches By Target Group**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatches By Target Group 
- **Failed Dispatches Count**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatches Count 
- **Latency by Domain**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Domain 
- **Latency by Load Balancer**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Load Balancer 
- **Latency by Protocol**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Protocol 
- **Latency by Target Group**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Target Group 
- **Latency by Top 20 Backend Instances**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Top 20 Backend Instances 
- **Latency by Top 20 Clients**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Top 20 Clients 
- **Latency by Top 20 URI**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Top 20 URI 
- **Requests and Data Volume**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests and Data Volume 
- **Requests by Geolocation**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by Geolocation 
- **Requests by Geolocation**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **Requests by Load Balancer**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **Requests by Load Balancer Over Time**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by Load Balancer Over Time 
- **Requests by SSL Protocol and Cipher**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by SSL Protocol and Cipher 
- **Requests by SSL Protocol and Cipher**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **Requests by Target Group Over Time**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by Target Group Over Time 
- **Requests by Type Over Time**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by Type Over Time 
- **Target Group Utilization**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Target Group Utilization 
- **Target Group Utilization**: from Dashboard: AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New 
- **Total Process Time Latency 90th, 95 pct**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Total Process Time Latency 90th, 95 pct 
- **Total Requests and Data Volume**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Total Requests and Data Volume 
- **Total Requests by Load Balancer**: from Search: AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Total Requests by Load Balancer

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|4XX and 5XX Status Codes by Backend Instance and ELB|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/4XX and 5XX Status Codes by Backend Instance and ELB|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| where (elb\_status\_code matches "4\*") or (target\_status\_code matches "4\*") or (elb\_status\_code matches "5\*") or (target\_status\_code matches "5\*") <br />\| if (elb\_status\_code matches "4\*",1,0) as elb\_flag4<br />\| if (target\_status\_code matches "4\*",1,0) as be\_flag4<br />\| if (elb\_status\_code matches "5\*",1,0) as elb\_flag5<br />\| if (target\_status\_code matches "5\*",1,0) as be\_flag5<br />\| sum(elb\_flag4) as elb\_4xx, sum(be\_flag4) as backend\_4xx, sum(elb\_flag5) as elb\_5xx, sum(be\_flag5) as backend\_5xx|
|AWS Elastic Load Balancer - Application|4XX and 5XX Status Codes by Backend Instance and ELB|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Parse all fields above, then aggregate<br />\| where (elb\_status\_code matches "4\*") or (target\_status\_code matches "4\*") or (elb\_status\_code matches "5\*") or (target\_status\_code matches "5\*") <br />//\| timeslice by 15m <br />\| if (elb\_status\_code matches "4\*",1,0) as elb\_flag4<br />\| if (target\_status\_code matches "4\*",1,0) as be\_flag4<br />\| if (elb\_status\_code matches "5\*",1,0) as elb\_flag5<br />\| if (target\_status\_code matches "5\*",1,0) as be\_flag5<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{target\_group\_arn}}" = "\*", true, target\_group\_arn matches "{{target\_group\_arn}}") AND if ("{{backendip}}" = "\*", true, backendip matches "{{backendip}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|sum(elb\_flag4) as elb\_4xx, sum(be\_flag4) as backend\_4xx, sum(elb\_flag5) as elb\_5xx, sum(be\_flag5) as backend\_5xx|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|ALB Parser 2.0|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/ALB Parser 2.0|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend|
|AWS Elastic Load Balancer - Application|Average Req and Resp Processing Time by ELB|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Parse all fields above, then aggregate<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{target\_group\_arn}}" = "\*", true, target\_group\_arn matches "{{target\_group\_arn}}") AND if ("{{backendip}}" = "\*", true, backendip matches "{{backendip}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|avg(request\_processing\_time) as request\_processing\_time, avg(response\_processing\_time) as response\_processing\_time by elb\_server|
|AWS Elastic Load Balancer - Application|Average Target Processing Time by Target Group|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Parse all fields above, then aggregate<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|avg(target\_processing\_time) as target\_processing\_time by target\_group\_arn|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Backend Instance and Load Balancer 4XX Status Codes by Client|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 4XX Status Codes by Client|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| where (elb\_status\_code matches "4\*") or (target\_status\_code matches "4\*") <br />\| timeslice 1m <br />\| if (elb\_status\_code matches "4\*",1,0) as elb\_flag<br />\| if (target\_status\_code matches "4\*",1,0) as be\_flag <br />\| sum(elb\_flag) as load\_balancer, sum(be\_flag) as backend\_instance by \_timeslice,clientIP <br />\| fields \_timeslice,clientIP,load\_balancer, backend\_instance \| (load\_balancer+backend\_instance) as total\_4xx \| sort by total\_4xx<br />\| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Backend Instance and Load Balancer 4XX Status Codes by Domain|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 4XX Status Codes by Domain|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| where (elb\_status\_code matches "4\*") or (target\_status\_code matches "4\*") <br />\| timeslice 1m <br />\| if (elb\_status\_code matches "4\*",1,0) as elb\_flag<br />\| if (target\_status\_code matches "4\*",1,0) as be\_flag <br />\| sum(elb\_flag) as load\_balancer, sum(be\_flag) as backend\_instance by \_timeslice,domain <br />\| fields \_timeslice,domain,load\_balancer, backend\_instance <br />\| (load\_balancer+backend\_instance) as total\_4xx <br />\| sort by total\_4xx<br />\| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Backend Instance and Load Balancer 4XX Status Codes by Target Group|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 4XX Status Codes by Target Group|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| where (elb\_status\_code matches "4\*") or (target\_status\_code matches "4\*") <br />\| timeslice 1m <br />\| if (elb\_status\_code matches "4\*",1,0) as elb\_flag<br />\| if (target\_status\_code matches "4\*",1,0) as be\_flag <br />\| sum(elb\_flag) as load\_balancer, sum(be\_flag) as backend\_instance by \_timeslice,target\_group\_arn <br />\| fields \_timeslice,target\_group\_arn,load\_balancer, backend\_instance <br />\| (load\_balancer+backend\_instance) as total\_4xx <br />\| sort by total\_4xx<br />\| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Backend Instance and Load Balancer 4XX Status Codes by URI|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 4XX Status Codes by URI|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| where (elb\_status\_code matches "4\*") or (target\_status\_code matches "4\*") <br />\| timeslice 1m <br />\| if (elb\_status\_code matches "4\*",1,0) as elb\_flag<br />\| if (target\_status\_code matches "4\*",1,0) as be\_flag <br />\| sum(elb\_flag) as load\_balancer, sum(be\_flag) as backend\_instance by \_timeslice,uri <br />\| fields \_timeslice,uri,load\_balancer, backend\_instance <br />\| (load\_balancer+backend\_instance) as total\_4xx <br />\| sort by total\_4xx<br />\| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Backend Instance and Load Balancer 5XX Status Codes by Client|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 5XX Status Codes by Client|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| where (elb\_status\_code matches "5\*") or (target\_status\_code matches "5\*") <br />\| timeslice 1m <br />\| if (elb\_status\_code matches "5\*",1,0) as elb\_flag<br />\| if (target\_status\_code matches "5\*",1,0) as be\_flag <br />\| sum(elb\_flag) as load\_balancer, sum(be\_flag) as backend\_instance by \_timeslice,clientIP <br />\| fields \_timeslice,clientIP,load\_balancer, backend\_instance \| (load\_balancer+backend\_instance) as total\_5xx \| sort by total\_5xx<br />\| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Backend Instance and Load Balancer 5XX Status Codes by Domain|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 5XX Status Codes by Domain|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| where (elb\_status\_code matches "5\*") or (target\_status\_code matches "5\*") <br />\| timeslice 1m <br />\| if (elb\_status\_code matches "5\*",1,0) as elb\_flag<br />\| if (target\_status\_code matches "5\*",1,0) as be\_flag <br />\| sum(elb\_flag) as load\_balancer, sum(be\_flag) as backend\_instance by \_timeslice,domain <br />\| fields \_timeslice,domain,load\_balancer, backend\_instance \| (load\_balancer+backend\_instance) as total\_5xx <br />\| sort by total\_5xx<br />\| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Backend Instance and Load Balancer 5XX Status Codes by Target Group|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 5XX Status Codes by Target Group|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| where (elb\_status\_code matches "5\*") or (target\_status\_code matches "5\*") <br />\| timeslice 1m <br />\| if (elb\_status\_code matches "5\*",1,0) as elb\_flag<br />\| if (target\_status\_code matches "5\*",1,0) as be\_flag <br />\| sum(elb\_flag) as load\_balancer, sum(be\_flag) as backend\_instance by \_timeslice,target\_group\_arn <br />\| fields \_timeslice,target\_group\_arn,load\_balancer, backend\_instance <br />\| (load\_balancer+backend\_instance) as total\_5xx <br />\| sort by total\_5xx<br />\| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Backend Instance and Load Balancer 5XX Status Codes by URI|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Backend Instance and Load Balancer 5XX Status Codes by URI|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "arn:\* " as target\_group\_arn nodrop<br />\| fields - request<br />\| where (elb\_status\_code matches "5\*") or (target\_status\_code matches "5\*") <br />\| timeslice 1m <br />\| if (elb\_status\_code matches "5\*",1,0) as elb\_flag<br />\| if (target\_status\_code matches "5\*",1,0) as be\_flag <br />\| sum(elb\_flag) as load\_balancer, sum(be\_flag) as backend\_instance by \_timeslice,uri <br />\| fields \_timeslice,uri,load\_balancer, backend\_instance <br />\| (load\_balancer+backend\_instance) as total\_5xx <br />\| sort by total\_5xx<br />\| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Browsers and Operating Systems|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Browsers and Operating Systems|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| if (user\_agent matches "\*Windows \*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*Win64\*","Windows","") as OS <br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Darwin/\*" OR user\_agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\|  if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (user\_agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (user\_agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (user\_agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND user\_agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (user\_agent matches "\*Mobile/\*" OR user\_agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND user\_agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (user\_agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (user\_agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (user\_agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (user\_agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\|  if (Browser == "","Other",Browser) as Browser  <br />\| count by OS,browser<br />\| transpose row os column browser as \*|
|AWS Elastic Load Balancer - Application|Browsers and Operating Systems|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Parse all fields above, then aggregate<br />\| if (user\_agent matches "\*Windows \*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*Win64\*","Windows","") as OS <br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Darwin/\*" OR user\_agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\|  if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (user\_agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (user\_agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (user\_agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND user\_agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (user\_agent matches "\*Mobile/\*" OR user\_agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND user\_agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (user\_agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (user\_agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (user\_agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (user\_agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\|  if (Browser == "","Other",Browser) as Browser<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{target\_group\_arn}}" = "\*", true, target\_group\_arn matches "{{target\_group\_arn}}") AND if ("{{backendip}}" = "\*", true, backendip matches "{{backendip}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|count by OS,browser<br />\| transpose row os column browser as \*|
|AWS Elastic Load Balancer - Application|Data Sent and Received in MB|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Parse all fields above, then aggregate<br />\| ((received\_bytes/(1024))/(1024)) as mbytes1 <br />\| ((sent\_bytes/(1024))/(1024)) as mbytes2<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{target\_group\_arn}}" = "\*", true, target\_group\_arn matches "{{target\_group\_arn}}") AND if ("{{backendip}}" = "\*", true, backendip matches "{{backendip}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|sum(mbytes1) as data\_received, sum(mbytes2) as data\_sent by ELB\_Server|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Failed Dispatch Monitoring|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatch Monitoring|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where (request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice 1m<br />\| count as failures by \_timeslice<br />\| outlier failures direction=+|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Failed Dispatches by Backend|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatches by Backend|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where (request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice 1m<br />\| count by backendIP, \_timeslice<br />\| transpose row \_timeslice column backendIP|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Failed Dispatches by Client|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatches by Client|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where (request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice 1m<br />\| count by clientIP, \_timeslice<br />\| transpose row \_timeslice column clientIP|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Failed Dispatches By Target Group|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatches By Target Group|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where (request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice 1m<br />\| count by target\_group\_arn, \_timeslice<br />\| transpose row \_timeslice column target\_group\_arn|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Failed Dispatches Count|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Failed Dispatches Count|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \*" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where (request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| count|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Latency by Domain|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Domain|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend <br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice by 1m<br />\| avg(request\_processing\_time) as a1, avg(target\_processing\_time) as a2,avg(response\_processing\_time) as a3 by \_timeslice, domain <br />\| (a1+a2+a3) as total\_process\_time<br />\| fields \_timeslice,domain,total\_process\_time <br />\| transpose row \_timeslice column domain|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Latency by Load Balancer|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Load Balancer|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Parse all fields above, then aggregate<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| avg(request\_processing\_time) as a1, avg(target\_processing\_time) as a2,avg(response\_processing\_time) as a3 by elb\_server <br />\| (a1+a2+a3) as total\_process\_time|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Latency by Protocol|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Protocol|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \*" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice by 1m<br />\| avg(request\_processing\_time) as a1, avg(target\_processing\_time) as a2,avg(response\_processing\_time) as a3 by \_timeslice, type <br />\| (a1+a2+a3) as total\_process\_time<br />\| fields \_timeslice,type,total\_process\_time <br />\| transpose row \_timeslice column type|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Latency by Target Group|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Target Group|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend <br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice by 1m<br />\| avg(request\_processing\_time) as a1, avg(target\_processing\_time) as a2,avg(response\_processing\_time) as a3 by \_timeslice, target\_group\_arn <br />\| (a1+a2+a3) as total\_process\_time<br />\| fields \_timeslice,target\_group\_arn,total\_process\_time <br />\| transpose row \_timeslice column target\_group\_arn|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Latency by Top 20 Backend Instances|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Top 20 Backend Instances|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice by 1m<br />\| avg(request\_processing\_time) as a1, avg(target\_processing\_time) as a2,avg(response\_processing\_time) as a3 by \_timeslice, backendIP \| (a1+a2+a3) as total\_process\_time<br />\| fields \_timeslice,backendIP,total\_process\_time<br />\| sort by total\_process\_time \| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Latency by Top 20 Clients|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Top 20 Clients|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice by 1m<br />\| avg(request\_processing\_time) as a1, avg(target\_processing\_time) as a2,avg(response\_processing\_time) as a3 by \_timeslice, clientIP \| (a1+a2+a3) as total\_process\_time<br />\| fields \_timeslice,clientIP,total\_process\_time <br />\| sort by total\_process\_time \| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Latency by Top 20 URI|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Latency by Top 20 URI|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice by 1m<br />\| avg(request\_processing\_time) as a1, avg(target\_processing\_time) as a2,avg(response\_processing\_time) as a3 by \_timeslice, uri \| (a1+a2+a3) as total\_process\_time<br />\| fields \_timeslice,uri,total\_process\_time <br />\| sort by total\_process\_time \| limit 20|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Requests and Data Volume|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests and Data Volume|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| ((received\_bytes/(1024))/(1024)) as mbytes1 <br />\| ((sent\_bytes/(1024))/(1024)) as mbytes2 <br />\| sum(mbytes1) as data\_received, sum(mbytes2) as data\_sent|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Requests by Geolocation|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by Geolocation|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|AWS Elastic Load Balancer - Application|Requests by Geolocation|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Parse all fields above, then aggregate<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{target\_group\_arn}}" = "\*", true, target\_group\_arn matches "{{target\_group\_arn}}") AND if ("{{backendip}}" = "\*", true, backendip matches "{{backendip}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|AWS Elastic Load Balancer - Application|Requests by Load Balancer|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{target\_group\_arn}}" = "\*", true, target\_group\_arn matches "{{target\_group\_arn}}") AND if ("{{backendip}}" = "\*", true, backendip matches "{{backendip}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|count by elb\_server<br />\| sort \_count|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Requests by Load Balancer Over Time|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by Load Balancer Over Time|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| timeslice by 1m <br />\| count by \_timeslice,elb\_server<br />\| transpose row \_timeslice column elb\_server|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Requests by SSL Protocol and Cipher|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by SSL Protocol and Cipher|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| count by ssl\_protocol, ssl\_cipher<br />\| transpose row ssl\_protocol column ssl\_cipher|
|AWS Elastic Load Balancer - Application|Requests by SSL Protocol and Cipher|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{target\_group\_arn}}" = "\*", true, target\_group\_arn matches "{{target\_group\_arn}}") AND if ("{{backendip}}" = "\*", true, backendip matches "{{backendip}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|count by ssl\_protocol, ssl\_cipher<br />\| transpose row ssl\_cipher column ssl\_protocol|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Requests by Target Group Over Time|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by Target Group Over Time|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| timeslice by 1m <br />\| count by \_timeslice,target\_group\_arn<br />\| transpose row \_timeslice column target\_group\_arn|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Requests by Type Over Time|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Requests by Type Over Time|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| timeslice by 1m <br />\| count by \_timeslice,type<br />\| transpose row \_timeslice column type|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Target Group Utilization|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Target Group Utilization|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend <br />\| count by target\_group\_arn<br />\| sort \_count|
|AWS Elastic Load Balancer - Application|Target Group Utilization|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Overview - New|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, path<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\|where if ("{{trace\_id}}" = "\*", true, trace\_id matches "{{trace\_id}}") AND if ("{{elb\_server}}" = "\*", true, elb\_server matches "{{elb\_server}}") AND if ("{{target\_status\_code}}" = "\*", true, target\_status\_code matches "{{target\_status\_code}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{target\_group\_arn}}" = "\*", true, target\_group\_arn matches "{{target\_group\_arn}}") AND if ("{{backendip}}" = "\*", true, backendip matches "{{backendip}}") AND if ("{{elb\_status\_code}}" = "\*", true, elb\_status\_code matches "{{elb\_status\_code}}")<br />\|count by target\_group\_arn<br />\| sort \_count|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Total Process Time Latency 90th, 95 pct|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Total Process Time Latency 90th, 95 pct|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />// Need to filter out logs where request\_processing\_time, target\_processing\_time, or response\_processing\_time are -1<br />// This means the load balancer can't dispatch the request to a target<br />\| where !(request\_processing\_time=-1 OR request\_processing\_time=-1 OR response\_processing\_time=-1)<br />\| timeslice by 1m<br />\| pct(request\_processing\_time,90,95), pct(target\_processing\_time,90,95), pct(response\_processing\_time,90,95) by \_timeslice<br />\| (\_request\_processing\_time\_pct\_90+\_target\_processing\_time\_pct\_90+\_response\_processing\_time\_pct\_90) as total\_process\_time\_pct\_90<br />\| (\_request\_processing\_time\_pct\_95+\_target\_processing\_time\_pct\_95+\_response\_processing\_time\_pct\_95) as total\_process\_time\_pct\_95<br />\| fields - \_request\_processing\_time\_pct\_90, \_target\_processing\_time\_pct\_90, \_response\_processing\_time\_pct\_90, \_request\_processing\_time\_pct\_95, \_target\_processing\_time\_pct\_95, \_response\_processing\_time\_pct\_95|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Total Requests and Data Volume|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Total Requests and Data Volume|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| timeslice 1m<br />\| ((received\_bytes/(1024))/(1024)) as mbytes1 \| ((sent\_bytes/(1024))/(1024)) as mbytes2 <br />\| count as clientIP, sum(mbytes1) as data\_received, sum(mbytes2) as data\_sent by \_timeslice <br />\| sort \_timeslice|
|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches|Total Requests by Load Balancer|Logs|AWS Elastic Load Balancer - Application/AWS ELB - Application - Searches/Total Requests by Load Balancer|\_sourceCategory = Labs/AWS/ALB<br />\| parse "\* \* \* \* \* \* \* \* \* \* \* \* \\"\*\\" \\"\*\\" \* \* \* \\"\*\\"" as type, datetime, ELB\_Server, client, backend, request\_processing\_time, target\_processing\_time, response\_processing\_time, elb\_status\_code, target\_status\_code, received\_bytes, sent\_bytes, request,user\_agent,ssl\_cipher,ssl\_protocol,target\_group\_arn,trace\_id<br />\| parse field=request "\* \*://\*:\*/\* HTTP" as method, protocol, domain, server\_port, uri<br />\| parse field=target\_group\_arn "\* " as target\_group\_arn nodrop<br />\| parse field=client "\*:\*" as clientIP, port nodrop<br />\| parse field=backend "\*:\*" as backendIP, backend\_port nodrop<br />\| fields - request, client, backend<br />\| count by elb\_server<br />\| sort \_count|

