# CrowdStrike - Falcon V2

## Searches

### Log Searches

- **Active Sensors**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **API clients Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Authentication Operations**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Authentication Operations - One Day Time Comparison**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Authentication Operations over Time**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Blocked Detections**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Breakdown by Operation Name**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Create User Event**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Detection based on Command Line Execution**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Detection by Host**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Detection by Severity**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Detection by Severity - One Day Time Comparison**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Detection by Tactic**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Detection by User**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Detection Count**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Detection Summary**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Detection Update Events - Outlier**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Detections by Objective**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Detections by Tactic**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Detections by Technique**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Detections for the Past 7 Days**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Events - One Day Time Comparison**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Events Over Time**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Failed Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Failed User Login Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **File based Detections**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Geo Location of Authentication Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Geo Location of Detection Status Update Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New 
- **Grant User Role Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **High Severity Detections**: from Search: CrowdStrike - Falcon V2/High Severity Detections 
- **High Severity Detections by Host**: from Search: CrowdStrike - Falcon V2/High Severity Detections by Host 
- **High Severity Detections by User**: from Search: CrowdStrike - Falcon V2/High Severity Detections by User 
- **High Severity Trending IOCs**: from Search: CrowdStrike - Falcon V2/High Severity Trending IOCs 
- **Login Events - Outlier**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Operation Name**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New 
- **Operation Name - One Day Time Comparison**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Quarantined Files**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New 
- **Quarantined Files Count**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New 
- **Requested Auth Secret Reset Event**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Severity**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **SHA based Detections**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Success 2FA Authenticate Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New 
- **Successful User Login Events**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New 
- **Trending IOCs**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New 
- **Update Group**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New 
- **Update Policy**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New 
- **User Auth Without 2FA**: from Dashboard: CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|CrowdStrike - Falcon V2|Active Sensors|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.SensorId" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, sensor\_id nodrop<br />\| timeslice 1d<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count\_distinct (sensor\_id) by \_timeslice<br />\| fillmissing timeslice(1d)|
|CrowdStrike - Falcon V2|API clients Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent 	CreateAPIClient<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| parse regex "name\\",[\\s]+\\"ValueString\\": \\"(?\<name\>.+)\\""<br />\| parse regex "scope\\(s\\)\\",[\\s]+\\"ValueString\\": \\"(?\<scope\>.+)\\""<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}")<br />\|count by operation\_time, operation\_name, src\_user, name,scope, success|
|CrowdStrike - Falcon V2|Authentication Operations|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}")<br />\|count by operation\_name <br />\| sort by \_count|
|CrowdStrike - Falcon V2|Authentication Operations - One Day Time Comparison|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}")<br />\|count by operation\_name   <br />\| compare with timeshift 1d|
|CrowdStrike - Falcon V2|Authentication Operations over Time|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| timeslice 1h<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}")<br />\|count by \_timeslice, operation\_name<br />\| transpose row \_timeslice column operation\_name|
|CrowdStrike - Falcon V2|Blocked Detections|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\| json "event.PatternDispositionFlags.ProcessBlocked" as isProcessBlocked<br />\| where isProcessBlocked="true"<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by detection\_URL, severity\_name, tactic, technique, objective, detect\_desc, IOC\_value, file\_name, computer\_name, user\_name<br />\| sort by detection\_URL|
|CrowdStrike - Falcon V2|Breakdown by Operation Name|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by operation\_name<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Create User Event|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent 	createUser<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\| json "event.AuditKeyValues[0].ValueString" as target\_user<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{target\_user}}" = "\*", true, target\_user matches "{{target\_user}}")<br />\|count by operation\_time, operation\_name, src\_user, target\_user, user\_ip|
|CrowdStrike - Falcon V2|Detection based on Command Line Execution|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\| json   "event.ParentImageFileName", "event.ParentCommandLine", "event.GrandparentImageFileName", "event.GrandparentCommandLine" as  ParentImageFileName, ParentCommandLine, GrandparentImageFileName, GrandparentCommandLine<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by detection\_URL, severity\_name, cmd\_line, ParentImageFileName, ParentCommandLine, GrandparentImageFileName, GrandparentCommandLine|
|CrowdStrike - Falcon V2|Detection by Host|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by computer\_name<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Detection by Severity|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\| timeslice 1d<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by \_timeslice, severity\_name<br />\| transpose row \_timeslice column severity\_name|
|CrowdStrike - Falcon V2|Detection by Severity - One Day Time Comparison|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by severity\_name <br />\| compare with timeshift 1d|
|CrowdStrike - Falcon V2|Detection by Tactic|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\| timeslice 1d<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by \_timeslice, tactic<br />\| transpose row \_timeslice column tactic|
|CrowdStrike - Falcon V2|Detection by User|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by user\_name<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Detection Count|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count\_distinct (detect\_id)|
|CrowdStrike - Falcon V2|Detection Summary|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by detection\_URL, severity\_name, tactic, technique, objective, detect\_desc, IOC\_value, file\_name, computer\_name, user\_name<br />\| sort by detection\_URL|
|CrowdStrike - Falcon V2|Detection Update Events - Outlier|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\| timeslice 1h<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by \_timeslice <br />\| fillmissing timeslice(1h)<br />\| outlier \_count|
|CrowdStrike - Falcon V2|Detections by Objective|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by objective<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Detections by Tactic|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by tactic<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Detections by Technique|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by technique<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Detections for the Past 7 Days|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2<br />\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess<br />\| timeslice 1d<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count\_distinct (detect\_id) by \_timeslice, severity\_name<br />\| fillmissing timeslice(1d)<br />\| transpose row \_timeslice column severity\_name|
|CrowdStrike - Falcon V2|Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by event\_type<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Events - One Day Time Comparison|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by event\_type<br />\| compare with timeshift 1d|
|CrowdStrike - Falcon V2|Events Over Time|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| timeslice 1h<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by \_timeslice, event\_type<br />\| transpose row \_timeslice column event\_type|
|CrowdStrike - Falcon V2|Failed Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent 	<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="false"<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}")<br />\|count by operation\_time, operation\_name, src\_user, user\_ip|
|CrowdStrike - Falcon V2|Failed User Login Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent (userAuthenticate or twoFactorAuthenticate)<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="false"<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by operation\_time, operation\_name, src\_user, user\_ip|
|CrowdStrike - Falcon V2|File based Detections|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\| where  !isNull(file\_name)<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by detection\_URL, file\_name<br />\| sort by detection\_URL|
|CrowdStrike - Falcon V2|Geo Location of Authentication Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = user\_ip<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|CrowdStrike - Falcon V2|Geo Location of Detection Status Update Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, audit\_values<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = user\_ip<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{event\_time}}" = "\*", true, event\_time matches "{{event\_time}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|CrowdStrike - Falcon V2|Grant User Role Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent grantUserRoles<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\| parse regex "roles\\",[\\s]+\\"ValueString\\": \\"(?\<updated\_roles\>.+)\\""<br />\| parse regex "target\_name\\",[\\s]+\\"ValueString\\": \\"(?\<target\_user\>.+)\\""<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{target\_user}}" = "\*", true, target\_user matches "{{target\_user}}")<br />\|count by operation\_time, operation\_name, src\_user, target\_user, updated\_roles|
|CrowdStrike - Falcon V2|High Severity Detections|Logs|CrowdStrike - Falcon V2/High Severity Detections|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\|where severity\_name = "High"<br />\|count by detection\_URL, severity\_name, tactic, technique, objective, detect\_desc, IOC\_value, file\_name, computer\_name, user\_name<br />\| sort by detection\_URL|
|CrowdStrike - Falcon V2|High Severity Detections by Host|Logs|CrowdStrike - Falcon V2/High Severity Detections by Host|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where severity\_name = "High"<br />\|count by computer\_name<br />\| sort by \_count|
|CrowdStrike - Falcon V2|High Severity Detections by User|Logs|CrowdStrike - Falcon V2/High Severity Detections by User|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where severity\_name = "High"<br />\|count by user\_name<br />\| sort by \_count|
|CrowdStrike - Falcon V2|High Severity Trending IOCs|Logs|CrowdStrike - Falcon V2/High Severity Trending IOCs|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where severity\_name = "High"<br />\|count by IOC\_Ttype, IOC\_value<br />\| topk(5,\_count) by IOC\_Ttype|
|CrowdStrike - Falcon V2|Login Events - Outlier|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent (userAuthenticate or twoFactorAuthenticate)<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| timeslice 1h<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by \_timeslice <br />\| fillmissing timeslice(1h)<br />\| outlier \_count|
|CrowdStrike - Falcon V2|Operation Name|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{event\_time}}" = "\*", true, event\_time matches "{{event\_time}}")<br />\|count by operation\_name<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Operation Name - One Day Time Comparison|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by operation\_name<br />\| compare with timeshift 1d|
|CrowdStrike - Falcon V2|Quarantined Files|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent quarantined action\_taken<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\| where operation\_name="quarantined\_file\_update"  <br />\| parse regex field=audit\_values "\\"ValueString\\":\\"(?\<file\_id\>.+)\\",\\"Key\\":\\"quarantined\_file\_id\\""<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{event\_time}}" = "\*", true, event\_time matches "{{event\_time}}")<br />\|count by file\_id<br />\| sort by \_count|
|CrowdStrike - Falcon V2|Quarantined Files Count|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent quarantined action\_taken<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, user\_id, src\_user, service\_name, audit\_values<br />\| where operation\_name="quarantined\_file\_update"<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{event\_time}}" = "\*", true, event\_time matches "{{event\_time}}")<br />\|count|
|CrowdStrike - Falcon V2|Requested Auth Secret Reset Event|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent 	resetAuthSecret<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\| json "event.AuditKeyValues[0].ValueString" as target\_user<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{target\_user}}" = "\*", true, target\_user matches "{{target\_user}}")<br />\|count by operation\_time, operation\_name, src\_user, target\_user, user\_ip|
|CrowdStrike - Falcon V2|Severity|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by severity\_name|
|CrowdStrike - Falcon V2|SHA based Detections|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\| tourl(falconHost\_link, event\_time,"Detected at: ","") as detection\_URL<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by detection\_URL, sha1\_string<br />\| sort by detection\_URL|
|CrowdStrike - Falcon V2|Success 2FA Authenticate Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent 	twoFactorAuthenticate<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{success}}" = "\*", true, success matches "{{success}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}")<br />\|count by operation\_time, operation\_name, src\_user, user\_ip|
|CrowdStrike - Falcon V2|Successful User Login Events|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon - Overview - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent (userAuthenticate or twoFactorAuthenticate)<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\|where if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}")<br />\|count by operation\_time, operation\_name, src\_user, user\_ip|
|CrowdStrike - Falcon V2|Trending IOCs|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detections - New|\_sourceCategory = Labs/CrowdStrikeV2  DetectionSummaryEvent<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="DetectionSummaryEvent"<br />\| json  "event.Tactic","event.Technique", "event.Objective", "event.ComputerName", "event.UserName", "event.DetectId", "event.DetectDescription", "event.Severity", "event.SeverityName", "event.FileName", "event.FilePath", "event.CommandLine", "event.MD5String", "event.SHA1String", "event.MachineDomain" , "event.FalconHostLink", "event.IOCType", "event.IOCValue", "event.LocalIP", "event.MACAddress", "event.ProcessEndTime" as tactic, technique, objective, computer\_name, user\_name, detect\_id, detect\_desc, severity, severity\_name, file\_name, file\_path, cmd\_line, md5\_string, sha1\_string, machine\_domain, falconHost\_link, IOC\_Ttype, IOC\_value, local\_ip, mac\_adderess, process\_endTIme<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{technique}}" = "\*", true, technique matches "{{technique}}") AND if ("{{computer\_name}}" = "\*", true, computer\_name matches "{{computer\_name}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{tactic}}" = "\*", true, tactic matches "{{tactic}}") AND if ("{{objective}}" = "\*", true, objective matches "{{objective}}") AND if ("{{machine\_domain}}" = "\*", true, machine\_domain matches "{{machine\_domain}}") AND if ("{{detect\_desc}}" = "\*", true, detect\_desc matches "{{detect\_desc}}") AND if ("{{severity\_name}}" = "\*", true, severity\_name matches "{{severity\_name}}")<br />\|count by IOC\_Ttype, IOC\_value<br />\| topk(5,\_count) by IOC\_Ttype|
|CrowdStrike - Falcon V2|Update Group|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, changed\_values<br />\| where operation\_name="update\_group"<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{event\_time}}" = "\*", true, event\_time matches "{{event\_time}}")<br />\|count by event\_time, operation\_name, src\_user, changed\_values|
|CrowdStrike - Falcon V2|Update Policy|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Detection Status Update - New|\_sourceCategory = Labs/CrowdStrikeV2  UserActivityAuditEvent <br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| where event\_type="UserActivityAuditEvent"<br />\| json "event.OperationName",  "event.UserId", "event.UserIp", "event.ServiceName", "event.AuditKeyValues" as operation\_name, src\_user, user\_ip, service\_name, changed\_values<br />\| where operation\_name="update\_policy"<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{customer\_id}}" = "\*", true, customer\_id matches "{{customer\_id}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{operation\_name}}" = "\*", true, operation\_name matches "{{operation\_name}}") AND if ("{{event\_time}}" = "\*", true, event\_time matches "{{event\_time}}")<br />\|count by event\_time, operation\_name, src\_user|
|CrowdStrike - Falcon V2|User Auth Without 2FA|Logs|CrowdStrike - Falcon V2/CrowdStrike - Falcon -  Authentication - New|\_sourceCategory = Labs/CrowdStrikeV2  AuthActivityAuditEvent userAuthenticate<br />\| json "metadata.eventType", "metadata.customerIDString", "metadata.eventCreationTime" as event\_type, customer\_id, event\_time<br />\| formatDate(fromMillis(event\_time), "MM/dd/yyyy HH:mm:ss:SSS") as event\_time<br />\| json "event.UserId", "event.UserIp", "event.OperationName", "event.ServiceName", "event.Success", "event.UTCTimestamp" as src\_user, user\_ip, operation\_name, service\_name, success, operation\_time<br />\| formatDate(fromMillis(operation\_time), "MM/dd/yyyy HH:mm:ss:SSS") as operation\_time<br />\| where success="true"<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}")<br />\|count by operation\_time, operation\_name, src\_user, user\_ip|

