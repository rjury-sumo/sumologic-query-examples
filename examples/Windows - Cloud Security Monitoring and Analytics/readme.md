# Windows - Cloud Security Monitoring and Analytics

## Searches

### Log Searches

- **Channels**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Channels**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Channels Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Channels Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Computers**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Computers**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Description**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Description**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Details**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Details**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Events**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Events**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Events**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Events**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Events**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Events**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Events**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Events**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Group**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Group**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Latest Events**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Latest Events**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Latest Events**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Latest Events**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Latest Events**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Latest Events**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Latest Events (Last 1000)**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Latest Events (Last 1000)**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Latest Events (Last 1000)**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Latest Events (Last 1000)**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Maximum Ingestion Delay**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Maximum Ingestion Delay**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Member**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Member**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Provider**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Provider**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Subject**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Subject**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **SubjectUserName**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **SubjectUserName**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Summary**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Summary**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Summary**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Summary**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Summary**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Summary**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **TargetUserName**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **TargetUserName**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Top 10 Event IDs**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Top 10 Event IDs**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Trend**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates 
- **Trend**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory 
- **Update**: from Dashboard: Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates 
- **Update**: from Dashboard: Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Windows - Cloud Security Monitoring and Analytics|Channels|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" as Channel, Provider, Computer  nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Channel<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Channels|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" as Channel, Provider, Computer  nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Channel<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Channels Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" as Channel, Provider, Computer  nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, Channel<br />\| transpose row \_timeslice column Channel<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Channels Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" as Channel, Provider, Computer  nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, Channel<br />\| transpose row \_timeslice column Channel<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5024" OR "5025" OR "5027" OR "5028" OR "5029" OR "5030" OR "5032" OR "5033" OR "5034" OR "5035" OR "5037") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5024", "5025", "5027", "5028", "5029", "5030", "5032", "5033", "5034", "5035", "5037")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4944" OR "4945" OR "4946" OR "4947" OR "4948" OR "4949" OR  "4950" OR "4951" OR "4952" OR "4954" OR "4956" OR "4957" OR "4958") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4944", "4945", "4946", "4947", "4948", "4949", "4950", "4951", "4952", "4954", "4956", "4957", "4958")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total Computer<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5024" OR "5025" OR "5027" OR "5028" OR "5029" OR "5030" OR "5032" OR "5033" OR "5034" OR "5035" OR "5037") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5024", "5025", "5027", "5028", "5029", "5030", "5032", "5033", "5034", "5035", "5037")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5440" OR "5441" OR "5442" OR "5443" OR "5444" OR "5446" OR  "5447" OR "5448" OR "5449" OR "5450") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5440", "5441", "5442", "5443", "5444", "5446", "5447", "5448", "5449", "5450")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4944" OR "4945" OR "4946" OR "4947" OR "4948" OR "4949" OR  "4950" OR "4951" OR "4952" OR "4954" OR "4956" OR "4957" OR "4958") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4944", "4945", "4946", "4947", "4948", "4949", "4950", "4951", "4952", "4954", "4956", "4957", "4958")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5152" OR "5153" OR "5031" OR "5154" OR "5155" OR "5156" OR  "5157" OR "5158" OR "5159") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5152", "5153", "5031", "5154", "5155", "5156", "5157", "5158", "5159")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| count as Events Computer<br />\| order by Events<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json field=\_raw "Computer" as Computer nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| \_receiptTime - \_messageTime as delayMS<br />\| (delayMS/1000/60) as delayMIN<br />\| round(delayMIN) as delayMIN<br /><br />\| where delayMIN \> 10<br /><br />\| count as Total by Computer|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total Computer<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* ("104" OR "517" OR "1102") {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel in ("System", "Security")<br />\| where EventID in ("104", "517", "1102")<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Computer|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* "Service Control Manager" "7036" {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel = "System"<br />\| where EventID = "7036"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "Provider.Name", "EventData.param1", "EventData.param2" as provider, service, status nodrop<br />\| where provider = "Service Control Manager"<br />\| where status = "stopped"<br /><br />\| count as Total by Computer|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4608" {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where Provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4608"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Total Computer<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Computer<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory={{Logsdatasource}}  ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{EventID}} {{Computer}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{EventID}}"<br />\| where Computer matches "{{Computer}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST") OR TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{SubjectUserName}}"<br />\| where TargetUserName matches "{{TargetUserName}}"<br /><br />\| count as Events Computer<br />\| order by Events<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory={{Logsdatasource}}  "Schannel" ("36864" OR "36866" OR "36867" OR "36868" OR "36869" OR "36870" OR "36871" OR "36872" OR "36873" OR "36874" OR "36875" OR "36876" OR "36877" OR "36878" OR "36879" OR "36880" OR "36881" OR "36882" OR "36883" OR "36884" OR "36885" OR "36886" OR "36887" OR "36888") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Schannel"<br /><br />\| where EventID in ("36864", "36866", "36867", "36868", "36869", "36870", "36871", "36872", "36873", "36874", "36875", "36876", "36877", "36878", "36879", "36880", "36881", "36882", "36883", "36884", "36885", "36886", "36887", "36888")<br />\| where EventID matches "{{{EventID}}}"<br /><br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5152" OR "5153" OR "5031" OR "5154" OR "5155" OR "5156" OR  "5157" OR "5158" OR "5159") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5152", "5153", "5031", "5154", "5155", "5156", "5157", "5158", "5159")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5440" OR "5441" OR "5442" OR "5443" OR "5444" OR "5446" OR  "5447" OR "5448" OR "5449" OR "5450") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5440", "5441", "5442", "5443", "5444", "5446", "5447", "5448", "5449", "5450")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4868" OR "4869" OR "4870" OR "4871" OR "4872" OR "4873" OR "4875" OR "4876" OR "4877" OR "4878" OR "4879" OR "4880" OR "4881" OR "4882" OR "4883" OR "4884" OR "4885" OR "4886" OR "4887" OR "4888" OR "4889" OR "4890" OR "4891" OR "4892" OR "4893" OR "4894" OR "4895" OR "4896" OR "4897" OR "4898" OR "4899" OR "4900") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br /><br />\| where EventID in ("4868", "4869", "4870", "4871", "4872", "4873", "4875", "4876", "4877", "4878", "4879", "4880", "4881", "4882", "4883", "4884", "4885", "4886", "4887", "4888", "4889", "4890", "4891", "4892", "4893", "4894", "4895", "4896", "4897", "4898", "4899", "4900")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  "Service Control Manager" "7036" {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel = "System"<br />\| where EventID = "7036"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "Provider.Name", "EventData.param1", "EventData.param2" as provider, service, status nodrop<br />\| where provider = "Service Control Manager"<br />\| where status = "stopped"<br /><br />\| count as Total by Computer|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory = Labs/windows\* "Schannel" ("36864" OR "36866" OR "36867" OR "36868" OR "36869" OR "36870" OR "36871" OR "36872" OR "36873" OR "36874" OR "36875" OR "36876" OR "36877" OR "36878" OR "36879" OR "36880" OR "36881" OR "36882" OR "36883" OR "36884" OR "36885" OR "36886" OR "36887" OR "36888") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Schannel"<br /><br />\| where EventID in ("36864", "36866", "36867", "36868", "36869", "36870", "36871", "36872", "36873", "36874", "36875", "36876", "36877", "36878", "36879", "36880", "36881", "36882", "36883", "36884", "36885", "36886", "36887", "36888")<br />\| where EventID matches "{{{EventID}}}"<br /><br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4868" OR "4869" OR "4870" OR "4871" OR "4872" OR "4873" OR "4875" OR "4876" OR "4877" OR "4878" OR "4879" OR "4880" OR "4881" OR "4882" OR "4883" OR "4884" OR "4885" OR "4886" OR "4887" OR "4888" OR "4889" OR "4890" OR "4891" OR "4892" OR "4893" OR "4894" OR "4895" OR "4896" OR "4897" OR "4898" OR "4899" OR "4900") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br /><br />\| where EventID in ("4868", "4869", "4870", "4871", "4872", "4873", "4875", "4876", "4877", "4878", "4879", "4880", "4881", "4882", "4883", "4884", "4885", "4886", "4887", "4888", "4889", "4890", "4891", "4892", "4893", "4894", "4895", "4896", "4897", "4898", "4899", "4900")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  ("104" OR "517" OR "1102") {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel in ("System", "Security")<br />\| where EventID in ("104", "517", "1102")<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Computer|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json field=\_raw "Computer" as Computer nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| \_receiptTime - \_messageTime as delayMS<br />\| (delayMS/1000/60) as delayMIN<br />\| round(delayMIN) as delayMIN<br /><br />\| where delayMIN \> 10<br /><br />\| count as Total by Computer|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Computer<br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| count as Events Computer<br />\| order by Events<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory = Labs/windows\* ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{EventID}} {{Computer}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{EventID}}"<br />\| where Computer matches "{{Computer}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST") OR TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{SubjectUserName}}"<br />\| where TargetUserName matches "{{TargetUserName}}"<br /><br />\| count as Events Computer<br />\| order by Events<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Computers|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4608" {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where Provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4608"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Total Computer<br />|
|Windows - Cloud Security Monitoring and Analytics|Description|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total EventID,Message<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Description|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total EventID,Message<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Success" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Success"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| "\*\* Unknown \*\*" as LogonDescription<br />\| if(IsEmpty(LogonType), 0, LogonType) as LogonType<br />\| if(LogonType=0, "N/A", LogonDescription) as LogonDescription<br />\| if(LogonType=2, "Interactive", LogonDescription) as LogonDescription<br />\| if(LogonType=3, "Network", LogonDescription) as LogonDescription<br />\| if(LogonType=4, "Batch", LogonDescription) as LogonDescription<br />\| if(LogonType=5, "Service", LogonDescription) as LogonDescription<br />\| if(LogonType=7, "Unlock", LogonDescription) as LogonDescription<br />\| if(LogonType=8, "NetworkCleartext", LogonDescription) as LogonDescription<br />\| if(LogonType=9, "NewCredentials", LogonDescription) as LogonDescription<br />\| if(LogonType=10, "RemoteInteractive", LogonDescription) as LogonDescription<br />\| if(LogonType=11, "CachedInteractive", LogonDescription) as LogonDescription<br /><br />\| "\*\* Unknown \*\*" as StatusDescription<br />\| if(IsEmpty(Status), "N/A", Status) as Status<br />\| if(ToUpperCase(Status)="N/A", "N/A", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000005E", "There are currently no logon servers available to service the logon request.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000064", "User logon with misspelled or bad user account", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006A", "User logon with misspelled or bad password", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006D", "The cause is either a bad username or authentication information", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006E", "Indicates a referenced user name and authentication information are valid, but some user account restriction has prevented successful authentication (such as time-of-day restrictions).", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006F", "User logon outside authorized hours", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000070", "User logon from unauthorized workstation", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000071", "User logon with expired password", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000072", "User logon to account disabled by administrator", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC00000DC", "Indicates the Sam Server was in the wrong state to perform the desired operation.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000133", "Clocks between DC and other computer too far out of sync", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000015B", "The user has not been granted the requested logon type (also called the logon right) at this machine", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000018C", "The logon request failed because the trust relationship between the primary domain and the trusted domain failed.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000192", "An attempt was made to logon, but the Netlogon service was not started.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000193", "User logon with expired account", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000224", "User is required to change password at next logon", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000225", "Evidently a bug in Windows and not a risk", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000234", "User logon with account locked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC00002EE", "Failure Reason: An Error occurred during Logon", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000413", "Logon Failure: The machine you are logging on to is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine.", StatusDescription) as StatusDescription<br /><br />\| if(ToUpperCase(Status)="0X0", "KDC\_ERR\_NONE: No error", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1", "KDC\_ERR\_NAME\_EXP: Client's entry in KDC database has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2", "KDC\_ERR\_SERVICE\_EXP: Server's entry in KDC database has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3", "KDC\_ERR\_BAD\_PVNO: Requested Kerberos version number not supported", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X4", "KDC\_ERR\_C\_OLD\_MAST\_KVNO: Client's key encrypted in old master key", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X5", "KDC\_ERR\_S\_OLD\_MAST\_KVNO: Server's key encrypted in old master key", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X6", "KDC\_ERR\_C\_PRINCIPAL\_UNKNOWN: Client not found in Kerberos database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X7", "KDC\_ERR\_S\_PRINCIPAL\_UNKNOWN: Server not found in Kerberos database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X8", "KDC\_ERR\_PRINCIPAL\_NOT\_UNIQUE: Multiple principal entries in KDC database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X9", "KDC\_ERR\_NULL\_KEY: The client or server has a null key (master key)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XA", "KDC\_ERR\_CANNOT\_POSTDATE: Ticket (TGT) not eligible for postdating", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XB", "KDC\_ERR\_NEVER\_VALID: Requested start time is later than end time", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC", "KDC\_ERR\_POLICY: Requested start time is later than end time", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XD", "KDC\_ERR\_BADOPTION: KDC cannot accommodate requested option", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XE", "KDC\_ERR\_ETYPE\_NOTSUPP: KDC has no support for encryption type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XF", "KDC\_ERR\_SUMTYPE\_NOSUPP: KDC has no support for checksum type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X10", "KDC\_ERR\_PADATA\_TYPE\_NOSUPP: KDC has no support for PADATA type (pre-authentication data)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X11", "KDC\_ERR\_TRTYPE\_NO\_SUPP: KDC has no support for transited type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X12", "KDC\_ERR\_CLIENT\_REVOKED: Client’s credentials have been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X13", "KDC\_ERR\_SERVICE\_REVOKED: Credentials for server have been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X14", "KDC\_ERR\_TGT\_REVOKED: TGT has been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X15", "KDC\_ERR\_CLIENT\_NOTYET: Client not yet valid—try again later", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X16", "KDC\_ERR\_SERVICE\_NOTYET: Server not yet valid—try again later", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X17", "KDC\_ERR\_KEY\_EXPIRED: Password has expired—change password to reset", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X18", "KDC\_ERR\_PREAUTH\_FAILED: Pre-authentication information was invalid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X19", "KDC\_ERR\_PREAUTH\_REQUIRED: Additional pre-authentication required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1A", "KDC\_ERR\_SERVER\_NOMATCH: KDC does not know about the requested server", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1B", "KDC\_ERR\_MUST\_USE\_USER2USER: This error occurs because the service is missing an SPN.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1D", "KDC\_ERR\_SVC\_UNAVAILABLE: KDC is unavailable", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1F", "KRB\_AP\_ERR\_BAD\_INTEGRITY: Integrity check on decrypted field failed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X20", "KRB\_AP\_ERR\_TKT\_EXPIRED: The ticket has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X21", "KRB\_AP\_ERR\_TKT\_NYV: The ticket is not yet valid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X22", "KRB\_AP\_ERR\_REPEAT: The request is a replay", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X23", "KRB\_AP\_ERR\_NOT\_US: The ticket is not for us", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X24", "KRB\_AP\_ERR\_BADMATCH: The ticket and authenticator do not match", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X25", "KRB\_AP\_ERR\_SKEW: The clock skew is too great", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X26", "KRB\_AP\_ERR\_BADADDR: Network address in network layer header doesn't match address inside ticket", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X27", "KRB\_AP\_ERR\_BADVERSION: Protocol version numbers don't match (PVNO)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X28", "KRB\_AP\_ERR\_MSG\_TYPE: Message type is unsupported", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X29", "KRB\_AP\_ERR\_MODIFIED: Message stream modified and checksum didn't match", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2A", "KRB\_AP\_ERR\_BADORDER: Message out of order (possible tampering)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2C", "KRB\_AP\_ERR\_BADKEYVER: Specified version of key is not available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2D", "KRB\_AP\_ERR\_NOKEY: Service key not available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2E", "KRB\_AP\_ERR\_MUT\_FAIL: Mutual authentication failed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2F", "KRB\_AP\_ERR\_BADDIRECTION: Incorrect message direction", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X30", "KRB\_AP\_ERR\_METHOD: Alternative authentication method required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X31", "KRB\_AP\_ERR\_BADSEQ: Incorrect sequence number in message", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X32", "KRB\_AP\_ERR\_INAPP\_CKSUM: Inappropriate type of checksum in message (checksum may be unsupported)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X33", "KRB\_AP\_PATH\_NOT\_ACCEPTED: Desired path is unreachable", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X34", "KRB\_ERR\_RESPONSE\_TOO\_BIG: Too much data", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3C", "KRB\_ERR\_GENERIC: Generic error", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3D", "KRB\_ERR\_FIELD\_TOOLONG: Field is too long for this implementation", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3E", "KDC\_ERR\_CLIENT\_NOT\_TRUSTED: The client trust failed or is not implemented", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3F", "KDC\_ERR\_KDC\_NOT\_TRUSTED: The KDC server trust failed or could not be verified", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X40", "KDC\_ERR\_INVALID\_SIG: The signature is invalid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X41", "KDC\_ERR\_KEY\_TOO\_WEAK: A higher encryption level is needed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X42", "KRB\_AP\_ERR\_USER\_TO\_USER\_REQUIRED: User-to-user authorization is required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X43", "KRB\_AP\_ERR\_NO\_TGT: No TGT was presented or available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X44", "KDC\_ERR\_WRONG\_REALM: Incorrect domain or principal", StatusDescription) as StatusDescription<br /><br />\| count as Total Date, Computer, EventID, Message, Subject, Target, Keywords, LogonType, LogonDescription,Status, StatusDescription, IPAddress<br />\| order by Date<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events by date, Computer, EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="1000", "An antimalware scan started.", Description) as Description<br />\| if(EventID="1001", "An antimalware scan finished.", Description) as Description<br />\| if(EventID="1002", "An antimalware scan was stopped before it finished.", Description) as Description<br />\| if(EventID="1003", "An antimalware scan was paused.", Description) as Description<br />\| if(EventID="1004", "An antimalware scan was resumed.", Description) as Description<br />\| if(EventID="1005", "An antimalware scan failed.", Description) as Description<br />\| if(EventID="1013", "The antimalware platform deleted history of malware and other potentially unwanted software.", Description) as Description<br />\| if(EventID="1014", "The antimalware platform could not delete history of malware and other potentially unwanted software.", Description) as Description<br />\| if(EventID="1150", "If your antimalware platform reports status to a monitoring platform, this event indicates that the antimalware platform is running and in a healthy state.", Description) as Description<br />\| if(EventID="1151", "Endpoint Protection client health report (time in UTC)", Description) as Description<br />\| if(EventID="2000", "The antimalware definitions updated successfully.", Description) as Description<br />\| if(EventID="2001", "The security intelligence update failed.", Description) as Description<br />\| if(EventID="2002", "The antimalware engine updated successfully.", Description) as Description<br />\| if(EventID="2003", "The antimalware engine update failed.", Description) as Description<br />\| if(EventID="2004", "There was a problem loading antimalware definitions. The antimalware engine will attempt to load the last-known good set of definitions.", Description) as Description<br />\| if(EventID="2005", "The antimalware engine failed to load because the antimalware platform is out of date. The antimalware platform will load the last-known good antimalware engine and attempt to update.", Description) as Description<br />\| if(EventID="2006", "The platform update failed.", Description) as Description<br />\| if(EventID="2007", "The platform will soon be out of date. Download the latest platform to maintain up-to-date protection.", Description) as Description<br />\| if(EventID="2010", "The antimalware engine used the Dynamic Signature Service to get additional definitions.", Description) as Description<br />\| if(EventID="2011", "The Dynamic Signature Service deleted the out-of-date dynamic definitions.", Description) as Description<br />\| if(EventID="2012", "The antimalware engine encountered an error when trying to use the Dynamic Signature Service.", Description) as Description<br />\| if(EventID="2013", "The Dynamic Signature Service deleted all dynamic definitions.", Description) as Description<br />\| if(EventID="2020", "The antimalware engine downloaded a clean file.", Description) as Description<br />\| if(EventID="2021", "The antimalware engine failed to download a clean file.", Description) as Description<br />\| if(EventID="2030", "The antimalware engine was downloaded and is configured to run offline on the next system restart.", Description) as Description<br />\| if(EventID="2031", "The antimalware engine was unable to download and configure an offline scan.", Description) as Description<br />\| if(EventID="2040", "Antimalware support for this operating system version will soon end.", Description) as Description<br />\| if(EventID="2041", "Antimalware support for this operating system has ended. You must upgrade the operating system for continued support.", Description) as Description<br />\| if(EventID="2042", "The antimalware engine no longer supports this operating system, and is no longer protecting your system from malware.", Description) as Description<br />\| if(EventID="3002", "Real-time protection encountered an error and failed.", Description) as Description<br />\| if(EventID="3007", "Real-time protection recovered from a failure. We recommend running a full system scan when you see this error.", Description) as Description<br />\| if(EventID="5000", "Real-time protection is enabled.", Description) as Description<br />\| if(EventID="5001", "Real-time protection is disabled.", Description) as Description<br />\| if(EventID="5004", "The real-time protection configuration changed.", Description) as Description<br />\| if(EventID="5007", "The antimalware platform configuration changed.", Description) as Description<br />\| if(EventID="5008", "The antimalware engine encountered an error and failed.", Description) as Description<br />\| if(EventID="5009", "Scanning for malware and other potentially unwanted software is enabled.", Description) as Description<br />\| if(EventID="5010", "Scanning for malware and other potentially unwanted software is disabled.", Description) as Description<br />\| if(EventID="5011", "Scanning for viruses is enabled.", Description) as Description<br />\| if(EventID="5012", "Scanning for viruses is disabled.", Description) as Description<br />\| if(EventID="5100", "The antimalware platform will expire soon.", Description) as Description<br />\| if(EventID="5101", "The antimalware platform is expired.", Description) as Description<br /><br />\| fields Date, Computer, EventId, Description, Events<br />\| order by Date<br />\| fields -Events<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4726" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4726"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json field=\_raw "Computer" as Computer nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| \_receiptTime - \_messageTime as delayMS<br />\| (delayMS/1000/60) as delayMIN<br />\| round(delayMIN) as delayMIN<br /><br />\| where delayMIN \> 10<br /><br />\| max(DelayMIN) as Minutes by Computer<br />\| order by Minutes<br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  "Service Control Manager" "7036" {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel = "System"<br />\| where EventID = "7036"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "Provider.Name", "EventData.param1", "EventData.param2" as provider, service, status nodrop<br />\| where provider = "Service Control Manager"<br />\| where status = "stopped"<br /><br />\| count as Total by Computer, service<br />\| order by Total|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4725" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4725"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4740" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4740"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* ("104" OR "517" OR "1102") {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel in ("System", "Security")<br />\| where EventID in ("104", "517", "1102")<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "UserData.LogFileCleared.SubjectUserName", "UserData.LogFileCleared.Channel" as SubjectUserName, targetChannel nodrop<br /><br />\| if(Channel="Security", "Security", targetChannel) as targetChannel<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br /><br />\| count as Events Date, Computer, SubjectUserName, targetChannel<br />\| order by Date<br />\| fields -Events|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Success" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Success"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| "\*\* Unknown \*\*" as LogonDescription<br />\| if(IsEmpty(LogonType), 0, LogonType) as LogonType<br />\| if(LogonType=0, "N/A", LogonDescription) as LogonDescription<br />\| if(LogonType=2, "Interactive", LogonDescription) as LogonDescription<br />\| if(LogonType=3, "Network", LogonDescription) as LogonDescription<br />\| if(LogonType=4, "Batch", LogonDescription) as LogonDescription<br />\| if(LogonType=5, "Service", LogonDescription) as LogonDescription<br />\| if(LogonType=7, "Unlock", LogonDescription) as LogonDescription<br />\| if(LogonType=8, "NetworkCleartext", LogonDescription) as LogonDescription<br />\| if(LogonType=9, "NewCredentials", LogonDescription) as LogonDescription<br />\| if(LogonType=10, "RemoteInteractive", LogonDescription) as LogonDescription<br />\| if(LogonType=11, "CachedInteractive", LogonDescription) as LogonDescription<br /><br />\| "\*\* Unknown \*\*" as StatusDescription<br />\| if(IsEmpty(Status), "N/A", Status) as Status<br />\| if(ToUpperCase(Status)="N/A", "N/A", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000005E", "There are currently no logon servers available to service the logon request.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000064", "User logon with misspelled or bad user account", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006A", "User logon with misspelled or bad password", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006D", "The cause is either a bad username or authentication information", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006E", "Indicates a referenced user name and authentication information are valid, but some user account restriction has prevented successful authentication (such as time-of-day restrictions).", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006F", "User logon outside authorized hours", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000070", "User logon from unauthorized workstation", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000071", "User logon with expired password", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000072", "User logon to account disabled by administrator", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC00000DC", "Indicates the Sam Server was in the wrong state to perform the desired operation.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000133", "Clocks between DC and other computer too far out of sync", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000015B", "The user has not been granted the requested logon type (also called the logon right) at this machine", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000018C", "The logon request failed because the trust relationship between the primary domain and the trusted domain failed.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000192", "An attempt was made to logon, but the Netlogon service was not started.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000193", "User logon with expired account", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000224", "User is required to change password at next logon", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000225", "Evidently a bug in Windows and not a risk", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000234", "User logon with account locked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC00002EE", "Failure Reason: An Error occurred during Logon", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000413", "Logon Failure: The machine you are logging on to is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine.", StatusDescription) as StatusDescription<br /><br />\| if(ToUpperCase(Status)="0X0", "KDC\_ERR\_NONE: No error", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1", "KDC\_ERR\_NAME\_EXP: Client's entry in KDC database has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2", "KDC\_ERR\_SERVICE\_EXP: Server's entry in KDC database has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3", "KDC\_ERR\_BAD\_PVNO: Requested Kerberos version number not supported", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X4", "KDC\_ERR\_C\_OLD\_MAST\_KVNO: Client's key encrypted in old master key", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X5", "KDC\_ERR\_S\_OLD\_MAST\_KVNO: Server's key encrypted in old master key", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X6", "KDC\_ERR\_C\_PRINCIPAL\_UNKNOWN: Client not found in Kerberos database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X7", "KDC\_ERR\_S\_PRINCIPAL\_UNKNOWN: Server not found in Kerberos database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X8", "KDC\_ERR\_PRINCIPAL\_NOT\_UNIQUE: Multiple principal entries in KDC database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X9", "KDC\_ERR\_NULL\_KEY: The client or server has a null key (master key)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XA", "KDC\_ERR\_CANNOT\_POSTDATE: Ticket (TGT) not eligible for postdating", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XB", "KDC\_ERR\_NEVER\_VALID: Requested start time is later than end time", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC", "KDC\_ERR\_POLICY: Requested start time is later than end time", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XD", "KDC\_ERR\_BADOPTION: KDC cannot accommodate requested option", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XE", "KDC\_ERR\_ETYPE\_NOTSUPP: KDC has no support for encryption type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XF", "KDC\_ERR\_SUMTYPE\_NOSUPP: KDC has no support for checksum type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X10", "KDC\_ERR\_PADATA\_TYPE\_NOSUPP: KDC has no support for PADATA type (pre-authentication data)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X11", "KDC\_ERR\_TRTYPE\_NO\_SUPP: KDC has no support for transited type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X12", "KDC\_ERR\_CLIENT\_REVOKED: Client?s credentials have been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X13", "KDC\_ERR\_SERVICE\_REVOKED: Credentials for server have been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X14", "KDC\_ERR\_TGT\_REVOKED: TGT has been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X15", "KDC\_ERR\_CLIENT\_NOTYET: Client not yet valid?try again later", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X16", "KDC\_ERR\_SERVICE\_NOTYET: Server not yet valid?try again later", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X17", "KDC\_ERR\_KEY\_EXPIRED: Password has expired?change password to reset", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X18", "KDC\_ERR\_PREAUTH\_FAILED: Pre-authentication information was invalid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X19", "KDC\_ERR\_PREAUTH\_REQUIRED: Additional pre-authentication required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1A", "KDC\_ERR\_SERVER\_NOMATCH: KDC does not know about the requested server", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1B", "KDC\_ERR\_MUST\_USE\_USER2USER: This error occurs because the service is missing an SPN.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1D", "KDC\_ERR\_SVC\_UNAVAILABLE: KDC is unavailable", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1F", "KRB\_AP\_ERR\_BAD\_INTEGRITY: Integrity check on decrypted field failed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X20", "KRB\_AP\_ERR\_TKT\_EXPIRED: The ticket has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X21", "KRB\_AP\_ERR\_TKT\_NYV: The ticket is not yet valid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X22", "KRB\_AP\_ERR\_REPEAT: The request is a replay", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X23", "KRB\_AP\_ERR\_NOT\_US: The ticket is not for us", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X24", "KRB\_AP\_ERR\_BADMATCH: The ticket and authenticator do not match", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X25", "KRB\_AP\_ERR\_SKEW: The clock skew is too great", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X26", "KRB\_AP\_ERR\_BADADDR: Network address in network layer header doesn't match address inside ticket", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X27", "KRB\_AP\_ERR\_BADVERSION: Protocol version numbers don't match (PVNO)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X28", "KRB\_AP\_ERR\_MSG\_TYPE: Message type is unsupported", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X29", "KRB\_AP\_ERR\_MODIFIED: Message stream modified and checksum didn't match", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2A", "KRB\_AP\_ERR\_BADORDER: Message out of order (possible tampering)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2C", "KRB\_AP\_ERR\_BADKEYVER: Specified version of key is not available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2D", "KRB\_AP\_ERR\_NOKEY: Service key not available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2E", "KRB\_AP\_ERR\_MUT\_FAIL: Mutual authentication failed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2F", "KRB\_AP\_ERR\_BADDIRECTION: Incorrect message direction", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X30", "KRB\_AP\_ERR\_METHOD: Alternative authentication method required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X31", "KRB\_AP\_ERR\_BADSEQ: Incorrect sequence number in message", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X32", "KRB\_AP\_ERR\_INAPP\_CKSUM: Inappropriate type of checksum in message (checksum may be unsupported)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X33", "KRB\_AP\_PATH\_NOT\_ACCEPTED: Desired path is unreachable", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X34", "KRB\_ERR\_RESPONSE\_TOO\_BIG: Too much data", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3C", "KRB\_ERR\_GENERIC: Generic error", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3D", "KRB\_ERR\_FIELD\_TOOLONG: Field is too long for this implementation", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3E", "KDC\_ERR\_CLIENT\_NOT\_TRUSTED: The client trust failed or is not implemented", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3F", "KDC\_ERR\_KDC\_NOT\_TRUSTED: The KDC server trust failed or could not be verified", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X40", "KDC\_ERR\_INVALID\_SIG: The signature is invalid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X41", "KDC\_ERR\_KEY\_TOO\_WEAK: A higher encryption level is needed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X42", "KRB\_AP\_ERR\_USER\_TO\_USER\_REQUIRED: User-to-user authorization is required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X43", "KRB\_AP\_ERR\_NO\_TGT: No TGT was presented or available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X44", "KDC\_ERR\_WRONG\_REALM: Incorrect domain or principal", StatusDescription) as StatusDescription<br /><br />\| count as Total Date, Computer, EventID, Message, Subject, Target, Keywords, LogonType, LogonDescription,Status, StatusDescription, IPAddress<br />\| order by Date<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Failure" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Failure"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| "\*\* Unknown \*\*" as LogonDescription<br />\| if(IsEmpty(LogonType), 0, LogonType) as LogonType<br />\| if(LogonType=0, "N/A", LogonDescription) as LogonDescription<br />\| if(LogonType=2, "Interactive", LogonDescription) as LogonDescription<br />\| if(LogonType=3, "Network", LogonDescription) as LogonDescription<br />\| if(LogonType=4, "Batch", LogonDescription) as LogonDescription<br />\| if(LogonType=5, "Service", LogonDescription) as LogonDescription<br />\| if(LogonType=7, "Unlock", LogonDescription) as LogonDescription<br />\| if(LogonType=8, "NetworkCleartext", LogonDescription) as LogonDescription<br />\| if(LogonType=9, "NewCredentials", LogonDescription) as LogonDescription<br />\| if(LogonType=10, "RemoteInteractive", LogonDescription) as LogonDescription<br />\| if(LogonType=11, "CachedInteractive", LogonDescription) as LogonDescription<br /><br />\| "\*\* Unknown \*\*" as StatusDescription<br />\| if(IsEmpty(Status), "N/A", Status) as Status<br />\| if(ToUpperCase(Status)="N/A", "N/A", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000005E", "There are currently no logon servers available to service the logon request.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000064", "User logon with misspelled or bad user account", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006A", "User logon with misspelled or bad password", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006D", "The cause is either a bad username or authentication information", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006E", "Indicates a referenced user name and authentication information are valid, but some user account restriction has prevented successful authentication (such as time-of-day restrictions).", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006F", "User logon outside authorized hours", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000070", "User logon from unauthorized workstation", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000071", "User logon with expired password", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000072", "User logon to account disabled by administrator", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC00000DC", "Indicates the Sam Server was in the wrong state to perform the desired operation.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000133", "Clocks between DC and other computer too far out of sync", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000015B", "The user has not been granted the requested logon type (also called the logon right) at this machine", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000018C", "The logon request failed because the trust relationship between the primary domain and the trusted domain failed.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000192", "An attempt was made to logon, but the Netlogon service was not started.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000193", "User logon with expired account", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000224", "User is required to change password at next logon", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000225", "Evidently a bug in Windows and not a risk", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000234", "User logon with account locked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC00002EE", "Failure Reason: An Error occurred during Logon", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000413", "Logon Failure: The machine you are logging on to is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine.", StatusDescription) as StatusDescription<br /><br />\| if(ToUpperCase(Status)="0X0", "KDC\_ERR\_NONE: No error", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1", "KDC\_ERR\_NAME\_EXP: Client's entry in KDC database has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2", "KDC\_ERR\_SERVICE\_EXP: Server's entry in KDC database has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3", "KDC\_ERR\_BAD\_PVNO: Requested Kerberos version number not supported", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X4", "KDC\_ERR\_C\_OLD\_MAST\_KVNO: Client's key encrypted in old master key", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X5", "KDC\_ERR\_S\_OLD\_MAST\_KVNO: Server's key encrypted in old master key", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X6", "KDC\_ERR\_C\_PRINCIPAL\_UNKNOWN: Client not found in Kerberos database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X7", "KDC\_ERR\_S\_PRINCIPAL\_UNKNOWN: Server not found in Kerberos database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X8", "KDC\_ERR\_PRINCIPAL\_NOT\_UNIQUE: Multiple principal entries in KDC database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X9", "KDC\_ERR\_NULL\_KEY: The client or server has a null key (master key)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XA", "KDC\_ERR\_CANNOT\_POSTDATE: Ticket (TGT) not eligible for postdating", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XB", "KDC\_ERR\_NEVER\_VALID: Requested start time is later than end time", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC", "KDC\_ERR\_POLICY: Requested start time is later than end time", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XD", "KDC\_ERR\_BADOPTION: KDC cannot accommodate requested option", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XE", "KDC\_ERR\_ETYPE\_NOTSUPP: KDC has no support for encryption type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XF", "KDC\_ERR\_SUMTYPE\_NOSUPP: KDC has no support for checksum type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X10", "KDC\_ERR\_PADATA\_TYPE\_NOSUPP: KDC has no support for PADATA type (pre-authentication data)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X11", "KDC\_ERR\_TRTYPE\_NO\_SUPP: KDC has no support for transited type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X12", "KDC\_ERR\_CLIENT\_REVOKED: Client?s credentials have been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X13", "KDC\_ERR\_SERVICE\_REVOKED: Credentials for server have been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X14", "KDC\_ERR\_TGT\_REVOKED: TGT has been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X15", "KDC\_ERR\_CLIENT\_NOTYET: Client not yet valid?try again later", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X16", "KDC\_ERR\_SERVICE\_NOTYET: Server not yet valid?try again later", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X17", "KDC\_ERR\_KEY\_EXPIRED: Password has expired?change password to reset", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X18", "KDC\_ERR\_PREAUTH\_FAILED: Pre-authentication information was invalid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X19", "KDC\_ERR\_PREAUTH\_REQUIRED: Additional pre-authentication required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1A", "KDC\_ERR\_SERVER\_NOMATCH: KDC does not know about the requested server", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1B", "KDC\_ERR\_MUST\_USE\_USER2USER: This error occurs because the service is missing an SPN.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1D", "KDC\_ERR\_SVC\_UNAVAILABLE: KDC is unavailable", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1F", "KRB\_AP\_ERR\_BAD\_INTEGRITY: Integrity check on decrypted field failed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X20", "KRB\_AP\_ERR\_TKT\_EXPIRED: The ticket has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X21", "KRB\_AP\_ERR\_TKT\_NYV: The ticket is not yet valid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X22", "KRB\_AP\_ERR\_REPEAT: The request is a replay", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X23", "KRB\_AP\_ERR\_NOT\_US: The ticket is not for us", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X24", "KRB\_AP\_ERR\_BADMATCH: The ticket and authenticator do not match", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X25", "KRB\_AP\_ERR\_SKEW: The clock skew is too great", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X26", "KRB\_AP\_ERR\_BADADDR: Network address in network layer header doesn't match address inside ticket", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X27", "KRB\_AP\_ERR\_BADVERSION: Protocol version numbers don't match (PVNO)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X28", "KRB\_AP\_ERR\_MSG\_TYPE: Message type is unsupported", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X29", "KRB\_AP\_ERR\_MODIFIED: Message stream modified and checksum didn't match", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2A", "KRB\_AP\_ERR\_BADORDER: Message out of order (possible tampering)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2C", "KRB\_AP\_ERR\_BADKEYVER: Specified version of key is not available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2D", "KRB\_AP\_ERR\_NOKEY: Service key not available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2E", "KRB\_AP\_ERR\_MUT\_FAIL: Mutual authentication failed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2F", "KRB\_AP\_ERR\_BADDIRECTION: Incorrect message direction", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X30", "KRB\_AP\_ERR\_METHOD: Alternative authentication method required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X31", "KRB\_AP\_ERR\_BADSEQ: Incorrect sequence number in message", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X32", "KRB\_AP\_ERR\_INAPP\_CKSUM: Inappropriate type of checksum in message (checksum may be unsupported)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X33", "KRB\_AP\_PATH\_NOT\_ACCEPTED: Desired path is unreachable", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X34", "KRB\_ERR\_RESPONSE\_TOO\_BIG: Too much data", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3C", "KRB\_ERR\_GENERIC: Generic error", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3D", "KRB\_ERR\_FIELD\_TOOLONG: Field is too long for this implementation", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3E", "KDC\_ERR\_CLIENT\_NOT\_TRUSTED: The client trust failed or is not implemented", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3F", "KDC\_ERR\_KDC\_NOT\_TRUSTED: The KDC server trust failed or could not be verified", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X40", "KDC\_ERR\_INVALID\_SIG: The signature is invalid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X41", "KDC\_ERR\_KEY\_TOO\_WEAK: A higher encryption level is needed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X42", "KRB\_AP\_ERR\_USER\_TO\_USER\_REQUIRED: User-to-user authorization is required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X43", "KRB\_AP\_ERR\_NO\_TGT: No TGT was presented or available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X44", "KDC\_ERR\_WRONG\_REALM: Incorrect domain or principal", StatusDescription) as StatusDescription<br /><br />\| count as Total Date, Computer, EventID, Message, Subject, Target, Keywords, LogonType, LogonDescription,Status, StatusDescription, IPAddress<br />\| order by Date<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Success" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Success"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br /><br />\| count as Total Target<br />\| order by Total|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4720" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4720"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Failure" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Failure"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop <br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| count as Total Target<br />\| order by Total|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4724" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4724"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Events Computer<br />\| order by Events|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* "Service Control Manager" "7036" {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel = "System"<br />\| where EventID = "7036"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "Provider.Name", "EventData.param1", "EventData.param2" as provider, service, status nodrop<br />\| where provider = "Service Control Manager"<br />\| where status = "stopped"<br /><br />\| count as Total by Computer, service<br />\| order by Total|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4720" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4720"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events by date, Computer, EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="1006", "The antimalware engine found malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1007", "The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1008", "The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", Description) as Description<br />\| if(EventID="1009", "The antimalware platform restored an item from quarantine.", Description) as Description<br />\| if(EventID="1010", "The antimalware platform could not restore an item from quarantine.", Description) as Description<br />\| if(EventID="1011", "The antimalware platform deleted an item from quarantine.", Description) as Description<br />\| if(EventID="1012", "The antimalware platform could not delete an item from quarantine.", Description) as Description<br />\| if(EventID="1015", "The antimalware platform detected suspicious behavior.", Description) as Description<br />\| if(EventID="1116", "The antimalware platform detected malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1117", "The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1118", "The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", Description) as Description<br />\| if(EventID="1119", "The antimalware platform encountered a critical error when trying to take action on malware or other potentially unwanted software. There are more details in the event message.", Description) as Description<br />\| if(EventID="1120", "Microsoft Defender Antivirus has deduced the hashes for a threat resource.", Description) as Description<br /><br />\| fields Date, Computer, EventId, Description, Events<br />\| order by Date<br />\| fields -Events<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Failure" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Failure"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| "\*\* Unknown \*\*" as LogonDescription<br />\| if(IsEmpty(LogonType), 0, LogonType) as LogonType<br />\| if(LogonType=0, "N/A", LogonDescription) as LogonDescription<br />\| if(LogonType=2, "Interactive", LogonDescription) as LogonDescription<br />\| if(LogonType=3, "Network", LogonDescription) as LogonDescription<br />\| if(LogonType=4, "Batch", LogonDescription) as LogonDescription<br />\| if(LogonType=5, "Service", LogonDescription) as LogonDescription<br />\| if(LogonType=7, "Unlock", LogonDescription) as LogonDescription<br />\| if(LogonType=8, "NetworkCleartext", LogonDescription) as LogonDescription<br />\| if(LogonType=9, "NewCredentials", LogonDescription) as LogonDescription<br />\| if(LogonType=10, "RemoteInteractive", LogonDescription) as LogonDescription<br />\| if(LogonType=11, "CachedInteractive", LogonDescription) as LogonDescription<br /><br />\| "\*\* Unknown \*\*" as StatusDescription<br />\| if(IsEmpty(Status), "N/A", Status) as Status<br />\| if(ToUpperCase(Status)="N/A", "N/A", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000005E", "There are currently no logon servers available to service the logon request.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000064", "User logon with misspelled or bad user account", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006A", "User logon with misspelled or bad password", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006D", "The cause is either a bad username or authentication information", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006E", "Indicates a referenced user name and authentication information are valid, but some user account restriction has prevented successful authentication (such as time-of-day restrictions).", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000006F", "User logon outside authorized hours", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000070", "User logon from unauthorized workstation", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000071", "User logon with expired password", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000072", "User logon to account disabled by administrator", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC00000DC", "Indicates the Sam Server was in the wrong state to perform the desired operation.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000133", "Clocks between DC and other computer too far out of sync", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000015B", "The user has not been granted the requested logon type (also called the logon right) at this machine", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC000018C", "The logon request failed because the trust relationship between the primary domain and the trusted domain failed.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000192", "An attempt was made to logon, but the Netlogon service was not started.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000193", "User logon with expired account", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000224", "User is required to change password at next logon", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000225", "Evidently a bug in Windows and not a risk", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000234", "User logon with account locked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC00002EE", "Failure Reason: An Error occurred during Logon", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC0000413", "Logon Failure: The machine you are logging on to is protected by an authentication firewall. The specified account is not allowed to authenticate to the machine.", StatusDescription) as StatusDescription<br /><br />\| if(ToUpperCase(Status)="0X0", "KDC\_ERR\_NONE: No error", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1", "KDC\_ERR\_NAME\_EXP: Client's entry in KDC database has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2", "KDC\_ERR\_SERVICE\_EXP: Server's entry in KDC database has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3", "KDC\_ERR\_BAD\_PVNO: Requested Kerberos version number not supported", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X4", "KDC\_ERR\_C\_OLD\_MAST\_KVNO: Client's key encrypted in old master key", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X5", "KDC\_ERR\_S\_OLD\_MAST\_KVNO: Server's key encrypted in old master key", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X6", "KDC\_ERR\_C\_PRINCIPAL\_UNKNOWN: Client not found in Kerberos database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X7", "KDC\_ERR\_S\_PRINCIPAL\_UNKNOWN: Server not found in Kerberos database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X8", "KDC\_ERR\_PRINCIPAL\_NOT\_UNIQUE: Multiple principal entries in KDC database", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X9", "KDC\_ERR\_NULL\_KEY: The client or server has a null key (master key)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XA", "KDC\_ERR\_CANNOT\_POSTDATE: Ticket (TGT) not eligible for postdating", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XB", "KDC\_ERR\_NEVER\_VALID: Requested start time is later than end time", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XC", "KDC\_ERR\_POLICY: Requested start time is later than end time", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XD", "KDC\_ERR\_BADOPTION: KDC cannot accommodate requested option", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XE", "KDC\_ERR\_ETYPE\_NOTSUPP: KDC has no support for encryption type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0XF", "KDC\_ERR\_SUMTYPE\_NOSUPP: KDC has no support for checksum type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X10", "KDC\_ERR\_PADATA\_TYPE\_NOSUPP: KDC has no support for PADATA type (pre-authentication data)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X11", "KDC\_ERR\_TRTYPE\_NO\_SUPP: KDC has no support for transited type", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X12", "KDC\_ERR\_CLIENT\_REVOKED: Client’s credentials have been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X13", "KDC\_ERR\_SERVICE\_REVOKED: Credentials for server have been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X14", "KDC\_ERR\_TGT\_REVOKED: TGT has been revoked", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X15", "KDC\_ERR\_CLIENT\_NOTYET: Client not yet valid—try again later", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X16", "KDC\_ERR\_SERVICE\_NOTYET: Server not yet valid—try again later", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X17", "KDC\_ERR\_KEY\_EXPIRED: Password has expired—change password to reset", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X18", "KDC\_ERR\_PREAUTH\_FAILED: Pre-authentication information was invalid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X19", "KDC\_ERR\_PREAUTH\_REQUIRED: Additional pre-authentication required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1A", "KDC\_ERR\_SERVER\_NOMATCH: KDC does not know about the requested server", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1B", "KDC\_ERR\_MUST\_USE\_USER2USER: This error occurs because the service is missing an SPN.", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1D", "KDC\_ERR\_SVC\_UNAVAILABLE: KDC is unavailable", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X1F", "KRB\_AP\_ERR\_BAD\_INTEGRITY: Integrity check on decrypted field failed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X20", "KRB\_AP\_ERR\_TKT\_EXPIRED: The ticket has expired", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X21", "KRB\_AP\_ERR\_TKT\_NYV: The ticket is not yet valid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X22", "KRB\_AP\_ERR\_REPEAT: The request is a replay", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X23", "KRB\_AP\_ERR\_NOT\_US: The ticket is not for us", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X24", "KRB\_AP\_ERR\_BADMATCH: The ticket and authenticator do not match", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X25", "KRB\_AP\_ERR\_SKEW: The clock skew is too great", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X26", "KRB\_AP\_ERR\_BADADDR: Network address in network layer header doesn't match address inside ticket", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X27", "KRB\_AP\_ERR\_BADVERSION: Protocol version numbers don't match (PVNO)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X28", "KRB\_AP\_ERR\_MSG\_TYPE: Message type is unsupported", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X29", "KRB\_AP\_ERR\_MODIFIED: Message stream modified and checksum didn't match", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2A", "KRB\_AP\_ERR\_BADORDER: Message out of order (possible tampering)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2C", "KRB\_AP\_ERR\_BADKEYVER: Specified version of key is not available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2D", "KRB\_AP\_ERR\_NOKEY: Service key not available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2E", "KRB\_AP\_ERR\_MUT\_FAIL: Mutual authentication failed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X2F", "KRB\_AP\_ERR\_BADDIRECTION: Incorrect message direction", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X30", "KRB\_AP\_ERR\_METHOD: Alternative authentication method required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X31", "KRB\_AP\_ERR\_BADSEQ: Incorrect sequence number in message", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X32", "KRB\_AP\_ERR\_INAPP\_CKSUM: Inappropriate type of checksum in message (checksum may be unsupported)", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X33", "KRB\_AP\_PATH\_NOT\_ACCEPTED: Desired path is unreachable", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X34", "KRB\_ERR\_RESPONSE\_TOO\_BIG: Too much data", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3C", "KRB\_ERR\_GENERIC: Generic error", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3D", "KRB\_ERR\_FIELD\_TOOLONG: Field is too long for this implementation", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3E", "KDC\_ERR\_CLIENT\_NOT\_TRUSTED: The client trust failed or is not implemented", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X3F", "KDC\_ERR\_KDC\_NOT\_TRUSTED: The KDC server trust failed or could not be verified", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X40", "KDC\_ERR\_INVALID\_SIG: The signature is invalid", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X41", "KDC\_ERR\_KEY\_TOO\_WEAK: A higher encryption level is needed", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X42", "KRB\_AP\_ERR\_USER\_TO\_USER\_REQUIRED: User-to-user authorization is required", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X43", "KRB\_AP\_ERR\_NO\_TGT: No TGT was presented or available", StatusDescription) as StatusDescription<br />\| if(ToUpperCase(Status)="0X44", "KDC\_ERR\_WRONG\_REALM: Incorrect domain or principal", StatusDescription) as StatusDescription<br /><br />\| count as Total Date, Computer, EventID, Message, Subject, Target, Keywords, LogonType, LogonDescription,Status, StatusDescription, IPAddress<br />\| order by Date<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json field=\_raw "Computer" as Computer nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| \_receiptTime - \_messageTime as delayMS<br />\| (delayMS/1000/60) as delayMIN<br />\| round(delayMIN) as delayMIN<br /><br />\| where delayMIN \> 10<br /><br />\| max(DelayMIN) as Minutes by Computer<br />\| order by Minutes<br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events by date, Computer, EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="1000", "An antimalware scan started.", Description) as Description<br />\| if(EventID="1001", "An antimalware scan finished.", Description) as Description<br />\| if(EventID="1002", "An antimalware scan was stopped before it finished.", Description) as Description<br />\| if(EventID="1003", "An antimalware scan was paused.", Description) as Description<br />\| if(EventID="1004", "An antimalware scan was resumed.", Description) as Description<br />\| if(EventID="1005", "An antimalware scan failed.", Description) as Description<br />\| if(EventID="1013", "The antimalware platform deleted history of malware and other potentially unwanted software.", Description) as Description<br />\| if(EventID="1014", "The antimalware platform could not delete history of malware and other potentially unwanted software.", Description) as Description<br />\| if(EventID="1150", "If your antimalware platform reports status to a monitoring platform, this event indicates that the antimalware platform is running and in a healthy state.", Description) as Description<br />\| if(EventID="1151", "Endpoint Protection client health report (time in UTC)", Description) as Description<br />\| if(EventID="2000", "The antimalware definitions updated successfully.", Description) as Description<br />\| if(EventID="2001", "The security intelligence update failed.", Description) as Description<br />\| if(EventID="2002", "The antimalware engine updated successfully.", Description) as Description<br />\| if(EventID="2003", "The antimalware engine update failed.", Description) as Description<br />\| if(EventID="2004", "There was a problem loading antimalware definitions. The antimalware engine will attempt to load the last-known good set of definitions.", Description) as Description<br />\| if(EventID="2005", "The antimalware engine failed to load because the antimalware platform is out of date. The antimalware platform will load the last-known good antimalware engine and attempt to update.", Description) as Description<br />\| if(EventID="2006", "The platform update failed.", Description) as Description<br />\| if(EventID="2007", "The platform will soon be out of date. Download the latest platform to maintain up-to-date protection.", Description) as Description<br />\| if(EventID="2010", "The antimalware engine used the Dynamic Signature Service to get additional definitions.", Description) as Description<br />\| if(EventID="2011", "The Dynamic Signature Service deleted the out-of-date dynamic definitions.", Description) as Description<br />\| if(EventID="2012", "The antimalware engine encountered an error when trying to use the Dynamic Signature Service.", Description) as Description<br />\| if(EventID="2013", "The Dynamic Signature Service deleted all dynamic definitions.", Description) as Description<br />\| if(EventID="2020", "The antimalware engine downloaded a clean file.", Description) as Description<br />\| if(EventID="2021", "The antimalware engine failed to download a clean file.", Description) as Description<br />\| if(EventID="2030", "The antimalware engine was downloaded and is configured to run offline on the next system restart.", Description) as Description<br />\| if(EventID="2031", "The antimalware engine was unable to download and configure an offline scan.", Description) as Description<br />\| if(EventID="2040", "Antimalware support for this operating system version will soon end.", Description) as Description<br />\| if(EventID="2041", "Antimalware support for this operating system has ended. You must upgrade the operating system for continued support.", Description) as Description<br />\| if(EventID="2042", "The antimalware engine no longer supports this operating system, and is no longer protecting your system from malware.", Description) as Description<br />\| if(EventID="3002", "Real-time protection encountered an error and failed.", Description) as Description<br />\| if(EventID="3007", "Real-time protection recovered from a failure. We recommend running a full system scan when you see this error.", Description) as Description<br />\| if(EventID="5000", "Real-time protection is enabled.", Description) as Description<br />\| if(EventID="5001", "Real-time protection is disabled.", Description) as Description<br />\| if(EventID="5004", "The real-time protection configuration changed.", Description) as Description<br />\| if(EventID="5007", "The antimalware platform configuration changed.", Description) as Description<br />\| if(EventID="5008", "The antimalware engine encountered an error and failed.", Description) as Description<br />\| if(EventID="5009", "Scanning for malware and other potentially unwanted software is enabled.", Description) as Description<br />\| if(EventID="5010", "Scanning for malware and other potentially unwanted software is disabled.", Description) as Description<br />\| if(EventID="5011", "Scanning for viruses is enabled.", Description) as Description<br />\| if(EventID="5012", "Scanning for viruses is disabled.", Description) as Description<br />\| if(EventID="5100", "The antimalware platform will expire soon.", Description) as Description<br />\| if(EventID="5101", "The antimalware platform is expired.", Description) as Description<br /><br />\| fields Date, Computer, EventId, Description, Events<br />\| order by Date<br />\| fields -Events<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4944" OR "4945" OR "4946" OR "4947" OR "4948" OR "4949" OR  "4950" OR "4951" OR "4952" OR "4954" OR "4956" OR "4957" OR "4958") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4944", "4945", "4946", "4947", "4948", "4949", "4950", "4951", "4952", "4954", "4956", "4957", "4958")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="4944", "The following policy was active when the Windows Firewall started.", Description) as Description<br />\| if(EventID="4945", "A rule was listed when the Windows Firewall started.", Description) as Description<br />\| if(EventID="4946", "A change has been made to Windows Firewall exception list. A rule was added.", Description) as Description<br />\| if(EventID="4947", "A change has been made to Windows Firewall exception list. A rule was modified.", Description) as Description<br />\| if(EventID="4948", "A change has been made to Windows Firewall exception list. A rule was deleted.", Description) as Description<br />\| if(EventID="4949", "Windows Firewall settings were restored to the default values.", Description) as Description<br />\| if(EventID="4950", "A Windows Firewall setting has changed.", Description) as Description<br />\| if(EventID="4951", "A rule has been ignored because its major version number was not recognized by Windows Firewall.", Description) as Description<br />\| if(EventID="4952", "Parts of a rule have been ignored because its minor version number was not recognized by Windows Firewall.", Description) as Description<br />\| if(EventID="4954", "Windows Firewall Group Policy settings has changed. The new settings have been applied.", Description) as Description<br />\| if(EventID="4956", "Windows Firewall has changed the active profile.", Description) as Description<br />\| if(EventID="4957", "Windows Firewall did not apply the following rule.", Description) as Description<br />\| if(EventID="4958", "Windows Firewall did not apply the following rule because the rule referred to items not configured on this computer.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4740" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4740"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Failure" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Failure"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop <br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| count as Total Target<br />\| order by Total|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Success" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Success"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br /><br />\| count as Total Target<br />\| order by Total|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events by date, Computer, EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="1006", "The antimalware engine found malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1007", "The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1008", "The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", Description) as Description<br />\| if(EventID="1009", "The antimalware platform restored an item from quarantine.", Description) as Description<br />\| if(EventID="1010", "The antimalware platform could not restore an item from quarantine.", Description) as Description<br />\| if(EventID="1011", "The antimalware platform deleted an item from quarantine.", Description) as Description<br />\| if(EventID="1012", "The antimalware platform could not delete an item from quarantine.", Description) as Description<br />\| if(EventID="1015", "The antimalware platform detected suspicious behavior.", Description) as Description<br />\| if(EventID="1116", "The antimalware platform detected malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1117", "The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1118", "The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", Description) as Description<br />\| if(EventID="1119", "The antimalware platform encountered a critical error when trying to take action on malware or other potentially unwanted software. There are more details in the event message.", Description) as Description<br />\| if(EventID="1120", "Microsoft Defender Antivirus has deduced the hashes for a threat resource.", Description) as Description<br /><br />\| fields Date, Computer, EventId, Description, Events<br />\| order by Date<br />\| fields -Events<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4724" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4724"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4944" OR "4945" OR "4946" OR "4947" OR "4948" OR "4949" OR  "4950" OR "4951" OR "4952" OR "4954" OR "4956" OR "4957" OR "4958") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4944", "4945", "4946", "4947", "4948", "4949", "4950", "4951", "4952", "4954", "4956", "4957", "4958")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="4944", "The following policy was active when the Windows Firewall started.", Description) as Description<br />\| if(EventID="4945", "A rule was listed when the Windows Firewall started.", Description) as Description<br />\| if(EventID="4946", "A change has been made to Windows Firewall exception list. A rule was added.", Description) as Description<br />\| if(EventID="4947", "A change has been made to Windows Firewall exception list. A rule was modified.", Description) as Description<br />\| if(EventID="4948", "A change has been made to Windows Firewall exception list. A rule was deleted.", Description) as Description<br />\| if(EventID="4949", "Windows Firewall settings were restored to the default values.", Description) as Description<br />\| if(EventID="4950", "A Windows Firewall setting has changed.", Description) as Description<br />\| if(EventID="4951", "A rule has been ignored because its major version number was not recognized by Windows Firewall.", Description) as Description<br />\| if(EventID="4952", "Parts of a rule have been ignored because its minor version number was not recognized by Windows Firewall.", Description) as Description<br />\| if(EventID="4954", "Windows Firewall Group Policy settings has changed. The new settings have been applied.", Description) as Description<br />\| if(EventID="4956", "Windows Firewall has changed the active profile.", Description) as Description<br />\| if(EventID="4957", "Windows Firewall did not apply the following rule.", Description) as Description<br />\| if(EventID="4958", "Windows Firewall did not apply the following rule because the rule referred to items not configured on this computer.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  ("104" OR "517" OR "1102") {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel in ("System", "Security")<br />\| where EventID in ("104", "517", "1102")<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "UserData.LogFileCleared.SubjectUserName", "UserData.LogFileCleared.Channel" as SubjectUserName, targetChannel nodrop<br /><br />\| if(Channel="Security", "Security", targetChannel) as targetChannel<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br /><br />\| count as Events Date, Computer, SubjectUserName, targetChannel<br />\| order by Date<br />\| fields -Events|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5440" OR "5441" OR "5442" OR "5443" OR "5444" OR "5446" OR  "5447" OR "5448" OR "5449" OR "5450") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5440", "5441", "5442", "5443", "5444", "5446", "5447", "5448", "5449", "5450")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="5440", "The following callout was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5441", "The following filter was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5442", "The following provider was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5443", "The following provider context was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5444", "The following sub-layer was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5446", "A Windows Filtering Platform callout has been changed.", Description) as Description<br />\| if(EventID="5447", "A Windows Filtering Platform filter has been changed.", Description) as Description<br />\| if(EventID="5448", "A Windows Filtering Platform provider has been changed.", Description) as Description<br />\| if(EventID="5449", "A Windows Filtering Platform provider context has been changed.", Description) as Description<br />\| if(EventID="5450", "A Windows Filtering Platform sub-layer has been changed.", Description) as Description<br /><br />\| fields EventId, Description, Events <br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5152" OR "5153" OR "5031" OR "5154" OR "5155" OR "5156" OR  "5157" OR "5158" OR "5159") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5152", "5153", "5031", "5154", "5155", "5156", "5157", "5158", "5159")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="5031", "The Windows Firewall Service blocked an application from accepting incoming connections on the network.", Description) as Description<br />\| if(EventID="5152", "The Windows Filtering Platform blocked a packet.", Description) as Description<br />\| if(EventID="5153", "A more restrictive Windows Filtering Platform filter has blocked a packet.", Description) as Description<br />\| if(EventID="5154", "The Windows Filtering Platform has permitted an application or service to listen on a port for incoming connections.", Description) as Description<br />\| if(EventID="5155", "The Windows Filtering Platform has blocked an application or service from listening on a port for incoming connections.", Description) as Description<br />\| if(EventID="5156", "The Windows Filtering Platform has allowed a connection.", Description) as Description<br />\| if(EventID="5157", "The Windows Filtering Platform has blocked a connection.", Description) as Description<br />\| if(EventID="5158", "The Windows Filtering Platform has permitted a bind to a local port.", Description) as Description<br />\| if(EventID="5159", "The Windows Filtering Platform has blocked a bind to a local port.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5440" OR "5441" OR "5442" OR "5443" OR "5444" OR "5446" OR  "5447" OR "5448" OR "5449" OR "5450") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5440", "5441", "5442", "5443", "5444", "5446", "5447", "5448", "5449", "5450")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="5440", "The following callout was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5441", "The following filter was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5442", "The following provider was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5443", "The following provider context was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5444", "The following sub-layer was present when the Windows Filtering Platform Base Filtering Engine started.", Description) as Description<br />\| if(EventID="5446", "A Windows Filtering Platform callout has been changed.", Description) as Description<br />\| if(EventID="5447", "A Windows Filtering Platform filter has been changed.", Description) as Description<br />\| if(EventID="5448", "A Windows Filtering Platform provider has been changed.", Description) as Description<br />\| if(EventID="5449", "A Windows Filtering Platform provider context has been changed.", Description) as Description<br />\| if(EventID="5450", "A Windows Filtering Platform sub-layer has been changed.", Description) as Description<br /><br />\| fields EventId, Description, Events <br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4726" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4726"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5152" OR "5153" OR "5031" OR "5154" OR "5155" OR "5156" OR  "5157" OR "5158" OR "5159") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5152", "5153", "5031", "5154", "5155", "5156", "5157", "5158", "5159")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="5031", "The Windows Firewall Service blocked an application from accepting incoming connections on the network.", Description) as Description<br />\| if(EventID="5152", "The Windows Filtering Platform blocked a packet.", Description) as Description<br />\| if(EventID="5153", "A more restrictive Windows Filtering Platform filter has blocked a packet.", Description) as Description<br />\| if(EventID="5154", "The Windows Filtering Platform has permitted an application or service to listen on a port for incoming connections.", Description) as Description<br />\| if(EventID="5155", "The Windows Filtering Platform has blocked an application or service from listening on a port for incoming connections.", Description) as Description<br />\| if(EventID="5156", "The Windows Filtering Platform has allowed a connection.", Description) as Description<br />\| if(EventID="5157", "The Windows Filtering Platform has blocked a connection.", Description) as Description<br />\| if(EventID="5158", "The Windows Filtering Platform has permitted a bind to a local port.", Description) as Description<br />\| if(EventID="5159", "The Windows Filtering Platform has blocked a bind to a local port.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5024" OR "5025" OR "5027" OR "5028" OR "5029" OR "5030" OR "5032" OR "5033" OR "5034" OR "5035" OR "5037") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5024", "5025", "5027", "5028", "5029", "5030", "5032", "5033", "5034", "5035", "5037")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="5024", "The Windows Firewall Service has started successfully", Description) as Description<br />\| if(EventID="5025", "The Windows Firewall Service has been stopped", Description) as Description<br />\| if(EventID="5027", "The Windows Firewall Service was unable to retrieve the security policy from the local storage", Description) as Description<br />\| if(EventID="5028", "The Windows Firewall Service was unable to parse the new security policy", Description) as Description<br />\| if(EventID="5029", "The Windows Firewall Service failed to initialize the driver", Description) as Description<br />\| if(EventID="5030", "The Windows Firewall Service failed to start", Description) as Description<br />\| if(EventID="5032", "Windows Firewall was unable to notify the user that it blocked an application from accepting incoming connections on the network", Description) as Description<br />\| if(EventID="5033", "The Windows Firewall Driver has started successfully", Description) as Description<br />\| if(EventID="5034", "The Windows Firewall Driver has been stopped", Description) as Description<br />\| if(EventID="5035", "The Windows Firewall Driver failed to start", Description) as Description<br />\| if(EventID="5037", "The Windows Firewall Driver detected critical runtime error. Terminating.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5024" OR "5025" OR "5027" OR "5028" OR "5029" OR "5030" OR "5032" OR "5033" OR "5034" OR "5035" OR "5037") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5024", "5025", "5027", "5028", "5029", "5030", "5032", "5033", "5034", "5035", "5037")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="5024", "The Windows Firewall Service has started successfully", Description) as Description<br />\| if(EventID="5025", "The Windows Firewall Service has been stopped", Description) as Description<br />\| if(EventID="5027", "The Windows Firewall Service was unable to retrieve the security policy from the local storage", Description) as Description<br />\| if(EventID="5028", "The Windows Firewall Service was unable to parse the new security policy", Description) as Description<br />\| if(EventID="5029", "The Windows Firewall Service failed to initialize the driver", Description) as Description<br />\| if(EventID="5030", "The Windows Firewall Service failed to start", Description) as Description<br />\| if(EventID="5032", "Windows Firewall was unable to notify the user that it blocked an application from accepting incoming connections on the network", Description) as Description<br />\| if(EventID="5033", "The Windows Firewall Driver has started successfully", Description) as Description<br />\| if(EventID="5034", "The Windows Firewall Driver has been stopped", Description) as Description<br />\| if(EventID="5035", "The Windows Firewall Driver failed to start", Description) as Description<br />\| if(EventID="5037", "The Windows Firewall Driver detected critical runtime error. Terminating.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Details|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4725" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4725"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| count as Total Date, Computer, Subject, Target<br />\| fields -Total<br />\| order by Date|
|Windows - Cloud Security Monitoring and Analytics|Events|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="16", "Unable to connect.", Description) as Description<br />\| if(EventID="17", "Installation Ready.", Description) as Description<br />\| if(EventID="18", "Installation Ready.", Description) as Description<br />\| if(EventID="19", "Installation Successful.", Description) as Description<br />\| if(EventID="20", "Installation Failure.", Description) as Description<br />\| if(EventID="21", "Restart Required.", Description) as Description<br />\| if(EventID="22", "Restart Required.", Description) as Description<br />\| if(EventID="27", "Automatic Updates is now paused.", Description) as Description<br />\| if(EventID="43", "Installation Started.", Description) as Description<br />\| if(EventID="44", "Windows Update started downloading an update.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Events|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="1000", "An antimalware scan started.", Description) as Description<br />\| if(EventID="1001", "An antimalware scan finished.", Description) as Description<br />\| if(EventID="1002", "An antimalware scan was stopped before it finished.", Description) as Description<br />\| if(EventID="1003", "An antimalware scan was paused.", Description) as Description<br />\| if(EventID="1004", "An antimalware scan was resumed.", Description) as Description<br />\| if(EventID="1005", "An antimalware scan failed.", Description) as Description<br />\| if(EventID="1013", "The antimalware platform deleted history of malware and other potentially unwanted software.", Description) as Description<br />\| if(EventID="1014", "The antimalware platform could not delete history of malware and other potentially unwanted software.", Description) as Description<br />\| if(EventID="1150", "If your antimalware platform reports status to a monitoring platform, this event indicates that the antimalware platform is running and in a healthy state.", Description) as Description<br />\| if(EventID="1151", "Endpoint Protection client health report (time in UTC)", Description) as Description<br />\| if(EventID="2000", "The antimalware definitions updated successfully.", Description) as Description<br />\| if(EventID="2001", "The security intelligence update failed.", Description) as Description<br />\| if(EventID="2002", "The antimalware engine updated successfully.", Description) as Description<br />\| if(EventID="2003", "The antimalware engine update failed.", Description) as Description<br />\| if(EventID="2004", "There was a problem loading antimalware definitions. The antimalware engine will attempt to load the last-known good set of definitions.", Description) as Description<br />\| if(EventID="2005", "The antimalware engine failed to load because the antimalware platform is out of date. The antimalware platform will load the last-known good antimalware engine and attempt to update.", Description) as Description<br />\| if(EventID="2006", "The platform update failed.", Description) as Description<br />\| if(EventID="2007", "The platform will soon be out of date. Download the latest platform to maintain up-to-date protection.", Description) as Description<br />\| if(EventID="2010", "The antimalware engine used the Dynamic Signature Service to get additional definitions.", Description) as Description<br />\| if(EventID="2011", "The Dynamic Signature Service deleted the out-of-date dynamic definitions.", Description) as Description<br />\| if(EventID="2012", "The antimalware engine encountered an error when trying to use the Dynamic Signature Service.", Description) as Description<br />\| if(EventID="2013", "The Dynamic Signature Service deleted all dynamic definitions.", Description) as Description<br />\| if(EventID="2020", "The antimalware engine downloaded a clean file.", Description) as Description<br />\| if(EventID="2021", "The antimalware engine failed to download a clean file.", Description) as Description<br />\| if(EventID="2030", "The antimalware engine was downloaded and is configured to run offline on the next system restart.", Description) as Description<br />\| if(EventID="2031", "The antimalware engine was unable to download and configure an offline scan.", Description) as Description<br />\| if(EventID="2040", "Antimalware support for this operating system version will soon end.", Description) as Description<br />\| if(EventID="2041", "Antimalware support for this operating system has ended. You must upgrade the operating system for continued support.", Description) as Description<br />\| if(EventID="2042", "The antimalware engine no longer supports this operating system, and is no longer protecting your system from malware.", Description) as Description<br />\| if(EventID="3002", "Real-time protection encountered an error and failed.", Description) as Description<br />\| if(EventID="3007", "Real-time protection recovered from a failure. We recommend running a full system scan when you see this error.", Description) as Description<br />\| if(EventID="5000", "Real-time protection is enabled.", Description) as Description<br />\| if(EventID="5001", "Real-time protection is disabled.", Description) as Description<br />\| if(EventID="5004", "The real-time protection configuration changed.", Description) as Description<br />\| if(EventID="5007", "The antimalware platform configuration changed.", Description) as Description<br />\| if(EventID="5008", "The antimalware engine encountered an error and failed.", Description) as Description<br />\| if(EventID="5009", "Scanning for malware and other potentially unwanted software is enabled.", Description) as Description<br />\| if(EventID="5010", "Scanning for malware and other potentially unwanted software is disabled.", Description) as Description<br />\| if(EventID="5011", "Scanning for viruses is enabled.", Description) as Description<br />\| if(EventID="5012", "Scanning for viruses is disabled.", Description) as Description<br />\| if(EventID="5100", "The antimalware platform will expire soon.", Description) as Description<br />\| if(EventID="5101", "The antimalware platform is expired.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by Events<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Events|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory = Labs/windows\* "Schannel" ("36864" OR "36866" OR "36867" OR "36868" OR "36869" OR "36870" OR "36871" OR "36872" OR "36873" OR "36874" OR "36875" OR "36876" OR "36877" OR "36878" OR "36879" OR "36880" OR "36881" OR "36882" OR "36883" OR "36884" OR "36885" OR "36886" OR "36887" OR "36888") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Schannel"<br /><br />\| where EventID in ("36864", "36866", "36867", "36868", "36869", "36870", "36871", "36872", "36873", "36874", "36875", "36876", "36877", "36878", "36879", "36880", "36881", "36882", "36883", "36884", "36885", "36886", "36887", "36888")<br />\| where EventID matches "{{{EventID}}}"<br /><br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events date, EventID, Computer<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="36864", "The Schannel Security Package has Loaded Successfully", Description) as Description<br />\| if(EventID="36866", "The Schannel Security Package Has Failed to Load", Description) as Description<br />\| if(EventID="36867", "Creating an SSL (client or server) Credential", Description) as Description<br />\| if(EventID="36868", "The SSL (client or server) Credential's Private Key Has the Following Properties", Description) as Description<br />\| if(EventID="36869", "The SSL (client or server) Credential’s Certificate Does Not Have a Private Key Information Property Attached to it", Description) as Description<br />\| if(EventID="36870", "A Fatal Error Occurred When Attempting to Access the SSL (client or server) Credential Private Key", Description) as Description<br />\| if(EventID="36871", "A Fatal Error Occurred While Creating An SSL (client or server) Credential", Description) as Description<br />\| if(EventID="36872", "No Suitable Default Server Credential Exists on this System", Description) as Description<br />\| if(EventID="36873", "No Supported Cipher Suites Were Found When Initiating an SSL Connection", Description) as Description<br />\| if(EventID="36874", "An SSL Connection Request Was Received From a Remote Client Application, But None of the Cipher Suites Supported by the Client Application Are Supported by the Server", Description) as Description<br />\| if(EventID="36875", "The Remote Server Has Requested SSL Client Authentication, But No Suitable Client Certificate Could Be Found", Description) as Description<br />\| if(EventID="36876", "The Certificate Received From the Remote Server Has Not Validated Correctly", Description) as Description<br />\| if(EventID="36877", "The Certificate Received From the Remote Client Application Has Not Validated Correctly", Description) as Description<br />\| if(EventID="36878", "The Certificate Received From the Remote Client Application Is Not Suitable for Direct Mapping to a Client System Account, Possibly Because the Authority that is Issuing the Certificate Is Not Sufficiently Trusted", Description) as Description<br />\| if(EventID="36879", "The Certificate Received From the Remote Client Application Was Not Successfully Mapped to a Client System Account", Description) as Description<br />\| if(EventID="36880", "An SSL (client or server) Handshake Completed Successfully", Description) as Description<br />\| if(EventID="36881", "The Certificate Received From the Remote Server Has Expired", Description) as Description<br />\| if(EventID="36882", "The Certificate Received From the Remote Server Was Issued By an Untrusted Certificate Authority", Description) as Description<br />\| if(EventID="36883", "The Certificate Received From the Remote Server Has Been Revoked", Description) as Description<br />\| if(EventID="36884", "The Certificate Received From the Remote Server Does Not Contain the Expected Name", Description) as Description<br />\| if(EventID="36885", "When Asking for Client Authentication, This Server Sends a List of Trusted Certificate Authorities to the Client.", Description) as Description<br />\| if(EventID="36886", "No Suitable Default Server Credential Exists on This System", Description) as Description<br />\| if(EventID="36887", "A Fatal Alert Was Received", Description) as Description<br />\| if(EventID="36888", "A Fatal Alert Was Generated", Description) as Description<br /><br />\| fields Date, Computer, EventId, Description, Events<br />\| order by Date<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Events|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory={{Logsdatasource}}  "Schannel" ("36864" OR "36866" OR "36867" OR "36868" OR "36869" OR "36870" OR "36871" OR "36872" OR "36873" OR "36874" OR "36875" OR "36876" OR "36877" OR "36878" OR "36879" OR "36880" OR "36881" OR "36882" OR "36883" OR "36884" OR "36885" OR "36886" OR "36887" OR "36888") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Schannel"<br /><br />\| where EventID in ("36864", "36866", "36867", "36868", "36869", "36870", "36871", "36872", "36873", "36874", "36875", "36876", "36877", "36878", "36879", "36880", "36881", "36882", "36883", "36884", "36885", "36886", "36887", "36888")<br />\| where EventID matches "{{{EventID}}}"<br /><br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events date, EventID, Computer<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="36864", "The Schannel Security Package has Loaded Successfully", Description) as Description<br />\| if(EventID="36866", "The Schannel Security Package Has Failed to Load", Description) as Description<br />\| if(EventID="36867", "Creating an SSL (client or server) Credential", Description) as Description<br />\| if(EventID="36868", "The SSL (client or server) Credential's Private Key Has the Following Properties", Description) as Description<br />\| if(EventID="36869", "The SSL (client or server) Credential?s Certificate Does Not Have a Private Key Information Property Attached to it", Description) as Description<br />\| if(EventID="36870", "A Fatal Error Occurred When Attempting to Access the SSL (client or server) Credential Private Key", Description) as Description<br />\| if(EventID="36871", "A Fatal Error Occurred While Creating An SSL (client or server) Credential", Description) as Description<br />\| if(EventID="36872", "No Suitable Default Server Credential Exists on this System", Description) as Description<br />\| if(EventID="36873", "No Supported Cipher Suites Were Found When Initiating an SSL Connection", Description) as Description<br />\| if(EventID="36874", "An SSL Connection Request Was Received From a Remote Client Application, But None of the Cipher Suites Supported by the Client Application Are Supported by the Server", Description) as Description<br />\| if(EventID="36875", "The Remote Server Has Requested SSL Client Authentication, But No Suitable Client Certificate Could Be Found", Description) as Description<br />\| if(EventID="36876", "The Certificate Received From the Remote Server Has Not Validated Correctly", Description) as Description<br />\| if(EventID="36877", "The Certificate Received From the Remote Client Application Has Not Validated Correctly", Description) as Description<br />\| if(EventID="36878", "The Certificate Received From the Remote Client Application Is Not Suitable for Direct Mapping to a Client System Account, Possibly Because the Authority that is Issuing the Certificate Is Not Sufficiently Trusted", Description) as Description<br />\| if(EventID="36879", "The Certificate Received From the Remote Client Application Was Not Successfully Mapped to a Client System Account", Description) as Description<br />\| if(EventID="36880", "An SSL (client or server) Handshake Completed Successfully", Description) as Description<br />\| if(EventID="36881", "The Certificate Received From the Remote Server Has Expired", Description) as Description<br />\| if(EventID="36882", "The Certificate Received From the Remote Server Was Issued By an Untrusted Certificate Authority", Description) as Description<br />\| if(EventID="36883", "The Certificate Received From the Remote Server Has Been Revoked", Description) as Description<br />\| if(EventID="36884", "The Certificate Received From the Remote Server Does Not Contain the Expected Name", Description) as Description<br />\| if(EventID="36885", "When Asking for Client Authentication, This Server Sends a List of Trusted Certificate Authorities to the Client.", Description) as Description<br />\| if(EventID="36886", "No Suitable Default Server Credential Exists on This System", Description) as Description<br />\| if(EventID="36887", "A Fatal Alert Was Received", Description) as Description<br />\| if(EventID="36888", "A Fatal Alert Was Generated", Description) as Description<br /><br />\| fields Date, Computer, EventId, Description, Events<br />\| order by Date<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Events|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="1006", "The antimalware engine found malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1007", "The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1008", "The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", Description) as Description<br />\| if(EventID="1009", "The antimalware platform restored an item from quarantine.", Description) as Description<br />\| if(EventID="1010", "The antimalware platform could not restore an item from quarantine.", Description) as Description<br />\| if(EventID="1011", "The antimalware platform deleted an item from quarantine.", Description) as Description<br />\| if(EventID="1012", "The antimalware platform could not delete an item from quarantine.", Description) as Description<br />\| if(EventID="1015", "The antimalware platform detected suspicious behavior.", Description) as Description<br />\| if(EventID="1116", "The antimalware platform detected malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1117", "The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1118", "The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", Description) as Description<br />\| if(EventID="1119", "The antimalware platform encountered a critical error when trying to take action on malware or other potentially unwanted software. There are more details in the event message.", Description) as Description<br />\| if(EventID="1120", "Microsoft Defender Antivirus has deduced the hashes for a threat resource.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by Events<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Events|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="16", "Unable to connect.", Description) as Description<br />\| if(EventID="17", "Installation Ready.", Description) as Description<br />\| if(EventID="18", "Installation Ready.", Description) as Description<br />\| if(EventID="19", "Installation Successful.", Description) as Description<br />\| if(EventID="20", "Installation Failure.", Description) as Description<br />\| if(EventID="21", "Restart Required.", Description) as Description<br />\| if(EventID="22", "Restart Required.", Description) as Description<br />\| if(EventID="27", "Automatic Updates is now paused.", Description) as Description<br />\| if(EventID="43", "Installation Started.", Description) as Description<br />\| if(EventID="44", "Windows Update started downloading an update.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by EventId asc<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Events|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="1000", "An antimalware scan started.", Description) as Description<br />\| if(EventID="1001", "An antimalware scan finished.", Description) as Description<br />\| if(EventID="1002", "An antimalware scan was stopped before it finished.", Description) as Description<br />\| if(EventID="1003", "An antimalware scan was paused.", Description) as Description<br />\| if(EventID="1004", "An antimalware scan was resumed.", Description) as Description<br />\| if(EventID="1005", "An antimalware scan failed.", Description) as Description<br />\| if(EventID="1013", "The antimalware platform deleted history of malware and other potentially unwanted software.", Description) as Description<br />\| if(EventID="1014", "The antimalware platform could not delete history of malware and other potentially unwanted software.", Description) as Description<br />\| if(EventID="1150", "If your antimalware platform reports status to a monitoring platform, this event indicates that the antimalware platform is running and in a healthy state.", Description) as Description<br />\| if(EventID="1151", "Endpoint Protection client health report (time in UTC)", Description) as Description<br />\| if(EventID="2000", "The antimalware definitions updated successfully.", Description) as Description<br />\| if(EventID="2001", "The security intelligence update failed.", Description) as Description<br />\| if(EventID="2002", "The antimalware engine updated successfully.", Description) as Description<br />\| if(EventID="2003", "The antimalware engine update failed.", Description) as Description<br />\| if(EventID="2004", "There was a problem loading antimalware definitions. The antimalware engine will attempt to load the last-known good set of definitions.", Description) as Description<br />\| if(EventID="2005", "The antimalware engine failed to load because the antimalware platform is out of date. The antimalware platform will load the last-known good antimalware engine and attempt to update.", Description) as Description<br />\| if(EventID="2006", "The platform update failed.", Description) as Description<br />\| if(EventID="2007", "The platform will soon be out of date. Download the latest platform to maintain up-to-date protection.", Description) as Description<br />\| if(EventID="2010", "The antimalware engine used the Dynamic Signature Service to get additional definitions.", Description) as Description<br />\| if(EventID="2011", "The Dynamic Signature Service deleted the out-of-date dynamic definitions.", Description) as Description<br />\| if(EventID="2012", "The antimalware engine encountered an error when trying to use the Dynamic Signature Service.", Description) as Description<br />\| if(EventID="2013", "The Dynamic Signature Service deleted all dynamic definitions.", Description) as Description<br />\| if(EventID="2020", "The antimalware engine downloaded a clean file.", Description) as Description<br />\| if(EventID="2021", "The antimalware engine failed to download a clean file.", Description) as Description<br />\| if(EventID="2030", "The antimalware engine was downloaded and is configured to run offline on the next system restart.", Description) as Description<br />\| if(EventID="2031", "The antimalware engine was unable to download and configure an offline scan.", Description) as Description<br />\| if(EventID="2040", "Antimalware support for this operating system version will soon end.", Description) as Description<br />\| if(EventID="2041", "Antimalware support for this operating system has ended. You must upgrade the operating system for continued support.", Description) as Description<br />\| if(EventID="2042", "The antimalware engine no longer supports this operating system, and is no longer protecting your system from malware.", Description) as Description<br />\| if(EventID="3002", "Real-time protection encountered an error and failed.", Description) as Description<br />\| if(EventID="3007", "Real-time protection recovered from a failure. We recommend running a full system scan when you see this error.", Description) as Description<br />\| if(EventID="5000", "Real-time protection is enabled.", Description) as Description<br />\| if(EventID="5001", "Real-time protection is disabled.", Description) as Description<br />\| if(EventID="5004", "The real-time protection configuration changed.", Description) as Description<br />\| if(EventID="5007", "The antimalware platform configuration changed.", Description) as Description<br />\| if(EventID="5008", "The antimalware engine encountered an error and failed.", Description) as Description<br />\| if(EventID="5009", "Scanning for malware and other potentially unwanted software is enabled.", Description) as Description<br />\| if(EventID="5010", "Scanning for malware and other potentially unwanted software is disabled.", Description) as Description<br />\| if(EventID="5011", "Scanning for viruses is enabled.", Description) as Description<br />\| if(EventID="5012", "Scanning for viruses is disabled.", Description) as Description<br />\| if(EventID="5100", "The antimalware platform will expire soon.", Description) as Description<br />\| if(EventID="5101", "The antimalware platform is expired.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by Events<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Events|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| count as Events by EventID<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="1006", "The antimalware engine found malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1007", "The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1008", "The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", Description) as Description<br />\| if(EventID="1009", "The antimalware platform restored an item from quarantine.", Description) as Description<br />\| if(EventID="1010", "The antimalware platform could not restore an item from quarantine.", Description) as Description<br />\| if(EventID="1011", "The antimalware platform deleted an item from quarantine.", Description) as Description<br />\| if(EventID="1012", "The antimalware platform could not delete an item from quarantine.", Description) as Description<br />\| if(EventID="1015", "The antimalware platform detected suspicious behavior.", Description) as Description<br />\| if(EventID="1116", "The antimalware platform detected malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1117", "The antimalware platform performed an action to protect your system from malware or other potentially unwanted software.", Description) as Description<br />\| if(EventID="1118", "The antimalware platform attempted to perform an action to protect your system from malware or other potentially unwanted software, but the action failed.", Description) as Description<br />\| if(EventID="1119", "The antimalware platform encountered a critical error when trying to take action on malware or other potentially unwanted software. There are more details in the event message.", Description) as Description<br />\| if(EventID="1120", "Microsoft Defender Antivirus has deduced the hashes for a threat resource.", Description) as Description<br /><br />\| fields EventId, Description, Events<br />\| order by Events<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Group|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br />\| count as Total TargetUserName<br />\| order by Total|
|Windows - Cloud Security Monitoring and Analytics|Group|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br />\| count as Total TargetUserName<br />\| order by Total|
|Windows - Cloud Security Monitoring and Analytics|Latest Events|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4868" OR "4869" OR "4870" OR "4871" OR "4872" OR "4873" OR "4875" OR "4876" OR "4877" OR "4878" OR "4879" OR "4880" OR "4881" OR "4882" OR "4883" OR "4884" OR "4885" OR "4886" OR "4887" OR "4888" OR "4889" OR "4890" OR "4891" OR "4892" OR "4893" OR "4894" OR "4895" OR "4896" OR "4897" OR "4898" OR "4899" OR "4900") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br /><br />\| where EventID in ("4868", "4869", "4870", "4871", "4872", "4873", "4875", "4876", "4877", "4878", "4879", "4880", "4881", "4882", "4883", "4884", "4885", "4886", "4887", "4888", "4889", "4890", "4891", "4892", "4893", "4894", "4895", "4896", "4897", "4898", "4899", "4900")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events date, EventID, Computer<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="4868", "The certificate manager denied a pending certificate request.", Description) as Description<br />\| if(EventID="4869", "Certificate Services received a resubmitted certificate request.", Description) as Description<br />\| if(EventID="4870", "Certificate Services revoked a certificate.", Description) as Description<br />\| if(EventID="4871", "Certificate Services received a request to publish the certificate revocation list (CRL).", Description) as Description<br />\| if(EventID="4872", "Certificate Services published the certificate revocation list (CRL).", Description) as Description<br />\| if(EventID="4873", "A certificate request extension changed.", Description) as Description<br />\| if(EventID="4875", "Certificate Services received a request to shut down.", Description) as Description<br />\| if(EventID="4876", "Certificate Services backup started.", Description) as Description<br />\| if(EventID="4877", "Certificate Services backup completed.", Description) as Description<br />\| if(EventID="4878", "Certificate Services restore started.", Description) as Description<br />\| if(EventID="4879", "Certificate Services restore completed.", Description) as Description<br />\| if(EventID="4880", "Certificate Services started.", Description) as Description<br />\| if(EventID="4881", "Certificate Services stopped.", Description) as Description<br />\| if(EventID="4882", "The security permissions for Certificate Services changed.", Description) as Description<br />\| if(EventID="4883", "Certificate Services retrieved an archived key.", Description) as Description<br />\| if(EventID="4884", "Certificate Services imported a certificate into its database.", Description) as Description<br />\| if(EventID="4885", "The audit filter for Certificate Services changed..", Description) as Description<br />\| if(EventID="4886", "Certificate Services received a certificate request.", Description) as Description<br />\| if(EventID="4887", "Certificate Services approved a certificate request and issued a certificate.", Description) as Description<br />\| if(EventID="4888", "Certificate Services denied a certificate request.", Description) as Description<br />\| if(EventID="4889", "Certificate Services set the status of a certificate request to pending.", Description) as Description<br />\| if(EventID="4890", "The certificate manager settings for Certificate Services changed.", Description) as Description<br />\| if(EventID="4891", "A configuration entry changed in Certificate Services.", Description) as Description<br />\| if(EventID="4892", "A property of Certificate Services changed.", Description) as Description<br />\| if(EventID="4893", "Certificate Services archived a key.", Description) as Description<br />\| if(EventID="4894", "Certificate Services imported and archived a key.", Description) as Description<br />\| if(EventID="4895", "Certificate Services published the CA certificate to Active Directory Domain Services.", Description) as Description<br />\| if(EventID="4896", "One or more rows have been deleted from the certificate database.", Description) as Description<br />\| if(EventID="4897", "Role separation enabled.", Description) as Description<br />\| if(EventID="4898", "Certificate Services loaded a template.", Description) as Description<br />\| if(EventID="4899", "A Certificate Services template was updated.", Description) as Description<br />\| if(EventID="4900", "Certificate Services template security was updated.", Description) as Description<br /><br />\| fields Date, Computer, EventId, Description, Events<br />\| order by Date<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Latest Events|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total date, Message, subject, MemberName, target, Keywords<br />\| order by date<br /><br />\| fields -Total<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Latest Events|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="16", "Unable to connect.", Description) as Description<br />\| if(EventID="17", "Installation Ready.", Description) as Description<br />\| if(EventID="18", "Installation Ready.", Description) as Description<br />\| if(EventID="19", "Installation Successful.", Description) as Description<br />\| if(EventID="20", "Installation Failure.", Description) as Description<br />\| if(EventID="21", "Restart Required.", Description) as Description<br />\| if(EventID="22", "Restart Required.", Description) as Description<br />\| if(EventID="27", "Automatic Updates is now paused.", Description) as Description<br />\| if(EventID="43", "Installation Started.", Description) as Description<br />\| if(EventID="44", "Windows Update started downloading an update.", Description) as Description<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br /><br />\| count as Events Date, Computer, EventID, Description, update<br />\| order by date|
|Windows - Cloud Security Monitoring and Analytics|Latest Events|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="16", "Unable to connect.", Description) as Description<br />\| if(EventID="17", "Installation Ready.", Description) as Description<br />\| if(EventID="18", "Installation Ready.", Description) as Description<br />\| if(EventID="19", "Installation Successful.", Description) as Description<br />\| if(EventID="20", "Installation Failure.", Description) as Description<br />\| if(EventID="21", "Restart Required.", Description) as Description<br />\| if(EventID="22", "Restart Required.", Description) as Description<br />\| if(EventID="27", "Automatic Updates is now paused.", Description) as Description<br />\| if(EventID="43", "Installation Started.", Description) as Description<br />\| if(EventID="44", "Windows Update started downloading an update.", Description) as Description<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br /><br />\| count as Events Date, Computer, EventID, Description, update<br />\| order by date|
|Windows - Cloud Security Monitoring and Analytics|Latest Events|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total date, Message, subject, MemberName, target, Keywords<br />\| order by date<br /><br />\| fields -Total<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Latest Events|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4868" OR "4869" OR "4870" OR "4871" OR "4872" OR "4873" OR "4875" OR "4876" OR "4877" OR "4878" OR "4879" OR "4880" OR "4881" OR "4882" OR "4883" OR "4884" OR "4885" OR "4886" OR "4887" OR "4888" OR "4889" OR "4890" OR "4891" OR "4892" OR "4893" OR "4894" OR "4895" OR "4896" OR "4897" OR "4898" OR "4899" OR "4900") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br /><br />\| where EventID in ("4868", "4869", "4870", "4871", "4872", "4873", "4875", "4876", "4877", "4878", "4879", "4880", "4881", "4882", "4883", "4884", "4885", "4886", "4887", "4888", "4889", "4890", "4891", "4892", "4893", "4894", "4895", "4896", "4897", "4898", "4899", "4900")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events date, EventID, Computer<br /><br />\| "\*\* Unknown \*\*" as Description<br /><br />\| if(EventID="4868", "The certificate manager denied a pending certificate request.", Description) as Description<br />\| if(EventID="4869", "Certificate Services received a resubmitted certificate request.", Description) as Description<br />\| if(EventID="4870", "Certificate Services revoked a certificate.", Description) as Description<br />\| if(EventID="4871", "Certificate Services received a request to publish the certificate revocation list (CRL).", Description) as Description<br />\| if(EventID="4872", "Certificate Services published the certificate revocation list (CRL).", Description) as Description<br />\| if(EventID="4873", "A certificate request extension changed.", Description) as Description<br />\| if(EventID="4875", "Certificate Services received a request to shut down.", Description) as Description<br />\| if(EventID="4876", "Certificate Services backup started.", Description) as Description<br />\| if(EventID="4877", "Certificate Services backup completed.", Description) as Description<br />\| if(EventID="4878", "Certificate Services restore started.", Description) as Description<br />\| if(EventID="4879", "Certificate Services restore completed.", Description) as Description<br />\| if(EventID="4880", "Certificate Services started.", Description) as Description<br />\| if(EventID="4881", "Certificate Services stopped.", Description) as Description<br />\| if(EventID="4882", "The security permissions for Certificate Services changed.", Description) as Description<br />\| if(EventID="4883", "Certificate Services retrieved an archived key.", Description) as Description<br />\| if(EventID="4884", "Certificate Services imported a certificate into its database.", Description) as Description<br />\| if(EventID="4885", "The audit filter for Certificate Services changed..", Description) as Description<br />\| if(EventID="4886", "Certificate Services received a certificate request.", Description) as Description<br />\| if(EventID="4887", "Certificate Services approved a certificate request and issued a certificate.", Description) as Description<br />\| if(EventID="4888", "Certificate Services denied a certificate request.", Description) as Description<br />\| if(EventID="4889", "Certificate Services set the status of a certificate request to pending.", Description) as Description<br />\| if(EventID="4890", "The certificate manager settings for Certificate Services changed.", Description) as Description<br />\| if(EventID="4891", "A configuration entry changed in Certificate Services.", Description) as Description<br />\| if(EventID="4892", "A property of Certificate Services changed.", Description) as Description<br />\| if(EventID="4893", "Certificate Services archived a key.", Description) as Description<br />\| if(EventID="4894", "Certificate Services imported and archived a key.", Description) as Description<br />\| if(EventID="4895", "Certificate Services published the CA certificate to Active Directory Domain Services.", Description) as Description<br />\| if(EventID="4896", "One or more rows have been deleted from the certificate database.", Description) as Description<br />\| if(EventID="4897", "Role separation enabled.", Description) as Description<br />\| if(EventID="4898", "Certificate Services loaded a template.", Description) as Description<br />\| if(EventID="4899", "A Certificate Services template was updated.", Description) as Description<br />\| if(EventID="4900", "Certificate Services template security was updated.", Description) as Description<br /><br />\| fields Date, Computer, EventId, Description, Events<br />\| order by Date<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Latest Events (Last 1000)|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4608" {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where Provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4608"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br /><br />\| count as Total Date, Computer<br />\| order by Date<br />\| fields -Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Latest Events (Last 1000)|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory = Labs/windows\* ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST") OR TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events date, EventID, Message, Computer, SubjectUserName, TargetUserName<br />\| order by Date<br />|
|Windows - Cloud Security Monitoring and Analytics|Latest Events (Last 1000)|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory={{Logsdatasource}}  ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST") OR TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| count as Events date, EventID, Message, Computer, SubjectUserName, TargetUserName<br />\| order by Date<br />|
|Windows - Cloud Security Monitoring and Analytics|Latest Events (Last 1000)|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4608" {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where Provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4608"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br /><br />\| count as Total Date, Computer<br />\| order by Date<br />\| fields -Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Maximum Ingestion Delay|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json field=\_raw "Computer" as Computer nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| \_receiptTime - \_messageTime as delayMS<br />\| (delayMS/1000/60) as delayMIN<br />\| round(delayMIN) as delayMIN<br /><br />//\| where delayMIN \> 10<br /><br />\| timeslice 1h<br /><br />\| max(delayMIN) as Minutes by \_timeslice<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Maximum Ingestion Delay|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json field=\_raw "Computer" as Computer nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| \_receiptTime - \_messageTime as delayMS<br />\| (delayMS/1000/60) as delayMIN<br />\| round(delayMIN) as delayMIN<br /><br />//\| where delayMIN \> 10<br /><br />\| timeslice 1h<br /><br />\| max(delayMIN) as Minutes by \_timeslice<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Member|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total MemberName<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Member|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total MemberName<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Provider|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" as Channel, Provider, Computer  nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Provider<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Provider|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" as Channel, Provider, Computer  nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Provider<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Subject|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total subject<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|Subject|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| count as Total subject<br />\| order by Total<br />|
|Windows - Cloud Security Monitoring and Analytics|SubjectUserName|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory={{Logsdatasource}}  ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br /><br />\| count as Events SubjectUserName<br />\| order by Events<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|SubjectUserName|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory = Labs/windows\* ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br /><br />\| count as Events SubjectUserName<br />\| order by Events<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Success" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Success"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4740" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4740"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Failure" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Failure"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4726" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4726"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Success" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Success"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Failure" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Failure"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4720" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4720"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4724" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4724"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4725" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4725"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4740" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4740"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4720" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4720"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4726" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4726"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4724" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4724"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Summary|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4725" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4725"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|TargetUserName|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory={{Logsdatasource}}  ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br />\| count as Events TargetUserName<br />\| order by Events<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|TargetUserName|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory = Labs/windows\* ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br />\| count as Events TargetUserName<br />\| order by Events<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Top 10 Event IDs|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer", "EventID" as Channel, Provider, Computer, EventId  nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Channel, Provider, EventId<br />\| order by Total<br /><br />\| limit 10<br />|
|Windows - Cloud Security Monitoring and Analytics|Top 10 Event IDs|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer", "EventID" as Channel, Provider, Computer, EventId  nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| count as Total Channel, Provider, EventId<br />\| order by Total<br /><br />\| limit 10<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4724" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4724"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5152" OR "5153" OR "5031" OR "5154" OR "5155" OR "5156" OR  "5157" OR "5158" OR "5159") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5152", "5153", "5031", "5154", "5155", "5156", "5157", "5158", "5159")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4740" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4740"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4725" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4725"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4944" OR "4945" OR "4946" OR "4947" OR "4948" OR "4949" OR  "4950" OR "4951" OR "4952" OR "4954" OR "4956" OR "4957" OR "4958") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4944", "4945", "4946", "4947", "4948", "4949", "4950", "4951", "4952", "4954", "4956", "4957", "4958")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, eventId<br />\| transpose row \_timeslice column eventID<br />\| order by \_timeslice<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4868" OR "4869" OR "4870" OR "4871" OR "4872" OR "4873" OR "4875" OR "4876" OR "4877" OR "4878" OR "4879" OR "4880" OR "4881" OR "4882" OR "4883" OR "4884" OR "4885" OR "4886" OR "4887" OR "4888" OR "4889" OR "4890" OR "4891" OR "4892" OR "4893" OR "4894" OR "4895" OR "4896" OR "4897" OR "4898" OR "4899" OR "4900") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br /><br />\| where EventID in ("4868", "4869", "4870", "4871", "4872", "4873", "4875", "4876", "4877", "4878", "4879", "4880", "4881", "4882", "4883", "4884", "4885", "4886", "4887", "4888", "4889", "4890", "4891", "4892", "4893", "4894", "4895", "4896", "4897", "4898", "4899", "4900")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, EventID<br />\| transpose row \_timeslice column eventId<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4720" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4720"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  "Service Control Manager" "7036" {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel = "System"<br />\| where EventID = "7036"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "Provider.Name", "EventData.param1", "EventData.param2" as provider, service, status nodrop<br />\| where provider = "Service Control Manager"<br />\| where status = "stopped"<br />\| timeslice 1h<br />\| count as Total by \_timeslice, service<br />\| transpose row \_timeslice column service<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory={{Logsdatasource}}  ("104" OR "517" OR "1102") {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel in ("System", "Security")<br />\| where EventID in ("104", "517", "1102")<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "UserData.LogFileCleared.SubjectUserName", "UserData.LogFileCleared.Channel" as SubjectUserName, targetChannel nodrop<br /><br />\| if(Channel="Security", "Security", targetChannel) as targetChannel<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, computer<br />\| transpose row \_timeslice column computer<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory = Labs/windows\* "Schannel" ("36864" OR "36866" OR "36867" OR "36868" OR "36869" OR "36870" OR "36871" OR "36872" OR "36873" OR "36874" OR "36875" OR "36876" OR "36877" OR "36878" OR "36879" OR "36880" OR "36881" OR "36882" OR "36883" OR "36884" OR "36885" OR "36886" OR "36887" OR "36888") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Schannel"<br /><br />\| where EventID in ("36864", "36866", "36867", "36868", "36869", "36870", "36871", "36872", "36873", "36874", "36875", "36876", "36877", "36878", "36879", "36880", "36881", "36882", "36883", "36884", "36885", "36886", "36887", "36888")<br />\| where EventID matches "{{{EventID}}}"<br /><br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, EventID<br />\| transpose row \_timeslice column eventId<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4868" OR "4869" OR "4870" OR "4871" OR "4872" OR "4873" OR "4875" OR "4876" OR "4877" OR "4878" OR "4879" OR "4880" OR "4881" OR "4882" OR "4883" OR "4884" OR "4885" OR "4886" OR "4887" OR "4888" OR "4889" OR "4890" OR "4891" OR "4892" OR "4893" OR "4894" OR "4895" OR "4896" OR "4897" OR "4898" OR "4899" OR "4900") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br /><br />\| where EventID in ("4868", "4869", "4870", "4871", "4872", "4873", "4875", "4876", "4877", "4878", "4879", "4880", "4881", "4882", "4883", "4884", "4885", "4886", "4887", "4888", "4889", "4890", "4891", "4892", "4893", "4894", "4895", "4896", "4897", "4898", "4899", "4900")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, EventID<br />\| transpose row \_timeslice column eventId<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory = Labs/windows\* ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, TargetUserName<br />\| transpose row \_timeslice column TargetUserName<br />\| order by \_timeslice<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory = Labs/windows\* ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, SubjectUserName<br />\| transpose row \_timeslice column SubjectUserName<br />\| order by \_timeslice<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory = Labs/windows\* ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST") OR TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, Computer<br />\| transpose row \_timeslice column Computer<br />\| order by \_timeslice<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4608" {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where Provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4608"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br /><br />\| count as Total \_timeslice, Computer<br />\| count as Total \_timeslice, Computer<br />\| transpose row \_timeslice column Computer<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4726" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4726"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5440" OR "5441" OR "5442" OR "5443" OR "5444" OR "5446" OR  "5447" OR "5448" OR "5449" OR "5450") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5440", "5441", "5442", "5443", "5444", "5446", "5447", "5448", "5449", "5450")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Success" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Success"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory={{Logsdatasource}}  ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST") OR TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, Computer<br />\| transpose row \_timeslice column Computer<br />\| order by \_timeslice<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - TLS Certificates and Secure Channels|\_sourceCategory={{Logsdatasource}}  "Schannel" ("36864" OR "36866" OR "36867" OR "36868" OR "36869" OR "36870" OR "36871" OR "36872" OR "36873" OR "36874" OR "36875" OR "36876" OR "36877" OR "36878" OR "36879" OR "36880" OR "36881" OR "36882" OR "36883" OR "36884" OR "36885" OR "36886" OR "36887" OR "36888") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Schannel"<br /><br />\| where EventID in ("36864", "36866", "36867", "36868", "36869", "36870", "36871", "36872", "36873", "36874", "36875", "36876", "36877", "36878", "36879", "36880", "36881", "36882", "36883", "36884", "36885", "36886", "36887", "36888")<br />\| where EventID matches "{{{EventID}}}"<br /><br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, EventID<br />\| transpose row \_timeslice column eventId<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory={{Logsdatasource}}  ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(TargetUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, TargetUserName<br />\| transpose row \_timeslice column TargetUserName<br />\| order by \_timeslice<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4725" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4725"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4724" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4724"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4720" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4720"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4726" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4726"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Default Accounts Usage|\_sourceCategory={{Logsdatasource}}  ("ROOT" OR "ADMIN" OR "ADMINISTRATOR" OR "DBSNMP" OR "SYS" OR "SYSMAN" OR "SYSTEM" OR "CISCO15" OR "SADMIN" OR "CISCO" OR "NETSCREEN" OR "GUEST") {{{EventID}}} {{{Computer}}}<br /><br />\| json "EventID", "Computer", "Message" nodrop<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| parse regex field=Message "^(?\<message\>[^\\n\\r]\*)" nodrop<br /><br />\| json "EventData.SubjectUserName", "EventData.TargetUserName" as SubjectUserName, TargetUserName nodrop<br />\| ToUpperCase(SubjectUserName) as SubjectUserName<br />\| ToUpperCase(TargetUserName) as TargetUserName<br /><br />\| where(SubjectUserName in ("ROOT", "ADMIN", "ADMINISTRATOR", "DBSNMP", "SYS", "SYSMAN", "SYSTEM", "CISCO15", "SADMIN", "CISCO", "NETSCREEN", "GUEST"))<br /><br />\| where SubjectUserName matches "{{{SubjectUserName}}}"<br />\| where TargetUserName matches "{{{TargetUserName}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, SubjectUserName<br />\| transpose row \_timeslice column SubjectUserName<br />\| order by \_timeslice<br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Account Changes|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" "4740" {{{Computer}}} {{{Subject}}} {{{Target}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords" as Channel, Provider, EventID, Computer, Keywords nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4740"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, Computer<br />\| count as Total \_timeslice<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" "4608" {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where Provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID = "4608"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br /><br />\| count as Total \_timeslice, Computer<br />\| count as Total \_timeslice, Computer<br />\| transpose row \_timeslice column Computer<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Success" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Success"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Failure" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Failure"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("5024" OR "5025" OR "5027" OR "5028" OR "5029" OR "5030" OR "5032" OR "5033" OR "5034" OR "5035" OR "5037") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5024", "5025", "5027", "5028", "5029", "5030", "5032", "5033", "5034", "5035", "5037")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* "Service Control Manager" "7036" {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel = "System"<br />\| where EventID = "7036"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "Provider.Name", "EventData.param1", "EventData.param2" as provider, service, status nodrop<br />\| where provider = "Service Control Manager"<br />\| where status = "stopped"<br />\| timeslice 1h<br />\| count as Total by \_timeslice, service<br />\| transpose row \_timeslice column service<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Critical Events|\_sourceCategory = Labs/windows\* ("104" OR "517" OR "1102") {{{Computer}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where Channel in ("System", "Security")<br />\| where EventID in ("104", "517", "1102")<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "UserData.LogFileCleared.SubjectUserName", "UserData.LogFileCleared.Channel" as SubjectUserName, targetChannel nodrop<br /><br />\| if(Channel="Security", "Security", targetChannel) as targetChannel<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, computer<br />\| transpose row \_timeslice column computer<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, eventId<br />\| transpose row \_timeslice column eventID<br />\| order by \_timeslice<br /><br /><br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5152" OR "5153" OR "5031" OR "5154" OR "5155" OR "5156" OR  "5157" OR "5158" OR "5159") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5152", "5153", "5031", "5154", "5155", "5156", "5157", "5158", "5159")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5440" OR "5441" OR "5442" OR "5443" OR "5444" OR "5446" OR  "5447" OR "5448" OR "5449" OR "5450") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5440", "5441", "5442", "5443", "5444", "5446", "5447", "5448", "5449", "5450")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4944" OR "4945" OR "4946" OR "4947" OR "4948" OR "4949" OR  "4950" OR "4951" OR "4952" OR "4954" OR "4956" OR "4957" OR "4958") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4944", "4945", "4946", "4947", "4948", "4949", "4950", "4951", "4952", "4954", "4956", "4957", "4958")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Firewall|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("5024" OR "5025" OR "5027" OR "5028" OR "5029" OR "5030" OR "5032" OR "5033" OR "5034" OR "5035" OR "5037") {{{EventID}}} {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("5024", "5025", "5027", "5028", "5029", "5030", "5032", "5033", "5034", "5035", "5037")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events by \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1006", "1007", "1008", "1009", "1010", "1011", "1012", "1015", "1116", "1117", "1118", "1119", "1120")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Defender|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Windows Defender/Operational" {{{Computer}}} {{{EventID}}}<br /><br />\| json "Channel", "EventID", "Computer" nodrop<br />\| where channel = "Microsoft-Windows-Windows Defender/Operational"<br /><br />\| where EventID in ("1000", "1001", "1002", "1003", "1004", "1005", "1013", "1014", "1150", "1151", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2010", "2011", "2012", "2013", "2020", "2021", "2030", "2031", "2040", "2041", "2042", "3002", "3007", "5000", "5001", "5004", "5007", "5008", "5009", "5010", "5011", "5012", "5100", "5101")<br /><br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Events \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, EventID<br />\| transpose row \_timeslice column eventId<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Authentication|\_sourceCategory = Labs/windows\* "Microsoft-Windows-Security-Auditing" ("4770" OR "4771" OR "4772" OR "4776" OR "4777" OR "4768" OR "4769" OR "4820" OR "4625" OR "4624" OR "4647" OR "4778" OR "4779" OR "4800" OR "4801" OR "4802" OR "4803") "Audit Failure" {{{Computer}}} {{{Subject}}} {{{Target}}} {{{IpAddress}}} {{{EventID}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4770", "4771", "4772", "4776", "4776", "4768", "4769", "4820", "4625", "4624", "4647", "4778", "4779", "4800", "4801", "4802","4803")<br />\| where EventID matches "{{{EventID}}}"<br />\| where Keywords = "Audit Failure"<br />\| where computer matches "{{{Computer}}}"<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.IpAddress", "EventData.LogonType", "EventData.Status" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, IpAddress, LogonType, Status nodrop<br />\| where !(TargetUserName matches "\*\$")<br />\| replace(IpAddress, "::ffff:", "") as IpAddress<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| parse field=Message "\*\\n" as message nodrop<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where target matches "{{{Target}}}"<br />\| where IpAddress matches "{{{IpAddress}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, EventID<br />\| transpose row \_timeslice column EventID<br />\| order by \_timeslice|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - User Group Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-Security-Auditing" ("4732" OR "4728" OR "4756" OR "4746" OR "4751" OR "4761" OR "4733" OR "4729" OR "4757" OR "4747" OR "4752" OR "4762") {{{Subject}}} {{{Member}}} {{{Group}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer", "Keywords", "Message" as Channel, Provider, EventID, Computer, Keywords, Message nodrop<br />\| where Channel = "Security"<br />\| where provider = "Microsoft-Windows-Security-Auditing"<br />\| where EventID in ("4732", "4728", "4756", "4746", "4751", "4761", "4733", "4729", "4757", "4747", "4752", "4762")<br /><br />\| json "EventData.TargetDomainName", "EventData.TargetUserName", "EventData.SubjectDomainName", "EventData.SubjectUserName", "EventData.MemberName" as TargetDomainName, TargetUserName, SubjectDomainName, SubjectUserName, MemberName nodrop<br /><br />\| formatDate(\_messageTime, "yyyy-MM-dd hh:mm:ss") as date<br />\| format("%s/%s", SubjectDomainName, SubjectUserName) as subject<br />\| format("%s/%s", TargetDomainName, TargetUserName) as target<br />\| replace(MemberName, ",", "\\n") as MemberName<br /><br />\| where subject matches "{{{Subject}}}"<br />\| where MemberName matches "{{{Member}}}"<br />\| where target matches "{{{Group}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, EventID<br />\| transpose row \_timeslice column eventId<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Trend|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Monitoring - Inventory|\_sourceCategory={{Logsdatasource}}  {{{Computer}}}<br /><br />\| json "Channel", "Provider.Name", "Computer" nodrop<br />\| where computer matches "{{{Computer}}}"<br /><br />\| timeslice 1h<br />\| count as Total \_timeslice, Computer<br />\| count as Total \_timeslice<br />\| order by \_timeslice<br />|
|Windows - Cloud Security Monitoring and Analytics|Update|Logs|Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory = Labs/windows\* "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| count as Events update|
|Windows - Cloud Security Monitoring and Analytics|Update|Logs|Installed Apps/Windows - Cloud Security Monitoring and Analytics/Windows - Security Analytics - Windows Updates|\_sourceCategory={{Logsdatasource}}  "Microsoft-Windows-WindowsUpdateClient" {{{Computer}}} {{{EventID}}} {{{Update}}}<br /><br />\| json "Channel", "Provider.Name", "EventID", "Computer" as Channel, Provider, EventID, Computer nodrop<br />\| where Channel = "System"<br />\| where provider = "Microsoft-Windows-WindowsUpdateClient"<br />\| where EventID matches "{{{EventID}}}"<br />\| where Computer matches "{{{Computer}}}"<br /><br />\| json "EventData.updateTitle", "UserData.updatelist.content" as updateTitle, updateList nodrop<br /><br />\| if(IsEmpty(updateTitle), updateList, updateTitle) as update<br />\| parse regex field=update "\\-\\s(?\<update\>.\*)" multi nodrop<br /><br />\| where update matches "{{{Update}}}"<br /><br />\| count as Events update|

