# Okta
## Sumo Logic App For: Okta
Okta provides secure connections between people and your applications on any device through identity management service built for the cloud. The Sumo Logic App for Okta helps you monitor the admin actions, failed logins, successful logins, and user activities to your applications through Okta. The App consists of dashboards that give you visibility into the applications, accesses, user events, and MFA.
Docs Link: [Okta](https://help.sumologic.com/?cid=6112)

## Searches

### Log Searches

- **App Login**: from Dashboard: Installed Apps/Okta/Okta - Failed Login Activity 
- **App Login**: from Dashboard: Okta/Okta - Failed Login Activity - New 
- **App Login**: from Dashboard: Okta/Okta - Successful Login Activity - New 
- **App Login**: from Dashboard: Installed Apps/Okta/Okta - Successful Login Activity 
- **Application Created**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Application Deleted**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Application Events by Severity**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Application Events by Severity Over Time**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Breakdown By Application**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Breakdown by Client Device and Browser**: from Dashboard: Okta/Okta - Failed Login Activity - New 
- **Breakdown by Client Device and Browser**: from Dashboard: Installed Apps/Okta/Okta - Successful Login Activity 
- **Breakdown by Client Device and Browser**: from Dashboard: Okta/Okta - Successful Login Activity - New 
- **Breakdown by Client Device and Browser**: from Dashboard: Installed Apps/Okta/Okta - Failed Login Activity 
- **Breakdown by Client OS and Browser**: from Dashboard: Okta/Okta - Failed Login Activity - New 
- **Breakdown by Client OS and Browser**: from Dashboard: Installed Apps/Okta/Okta - Failed Login Activity 
- **Breakdown by Client OS and Browser**: from Dashboard: Okta/Okta - Successful Login Activity - New 
- **Breakdown by Client OS and Browser**: from Dashboard: Installed Apps/Okta/Okta - Successful Login Activity 
- **Breakdown by Events**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Connect AD Agent to Okta**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Deactivated Application**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Events by Severity Over Time**: from Dashboard: Okta/Okta - User Activity - New 
- **Events by Severity Over Time**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **Events by User**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **Events by User**: from Dashboard: Okta/Okta - User Activity - New 
- **Failed Application Access by Users**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Failed Application Access by Users over Time**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Geolocation of Application Events**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Geolocation of Application Logins**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Geolocation of Logins**: from Dashboard: Installed Apps/Okta/Okta - Failed Login Activity 
- **Geolocation of Logins**: from Dashboard: Installed Apps/Okta/Okta - Successful Login Activity 
- **Geolocation of Logins**: from Dashboard: Okta/Okta - Failed Login Activity - New 
- **Geolocation of Logins**: from Dashboard: Okta/Okta - Successful Login Activity - New 
- **Geolocation of User Activity**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **Geolocation of User Activity**: from Dashboard: Okta/Okta - User Activity - New 
- **Login - Outlier**: from Dashboard: Installed Apps/Okta/Okta - Failed Login Activity 
- **Login - Outlier**: from Dashboard: Installed Apps/Okta/Okta - Successful Login Activity 
- **Login - Outlier**: from Dashboard: Okta/Okta - Failed Login Activity - New 
- **Login - Outlier**: from Dashboard: Okta/Okta - Successful Login Activity - New 
- **Login breakdown by Country and State**: from Dashboard: Installed Apps/Okta/Okta - Successful Login Activity 
- **Login breakdown by Country and State**: from Dashboard: Okta/Okta - Failed Login Activity - New 
- **Login breakdown by Country and State**: from Dashboard: Installed Apps/Okta/Okta - Failed Login Activity 
- **Login breakdown by Country and State**: from Dashboard: Okta/Okta - Successful Login Activity - New 
- **Logins Overtime**: from Dashboard: Installed Apps/Okta/Okta - Failed Login Activity 
- **Logins Overtime**: from Dashboard: Okta/Okta - Failed Login Activity - New 
- **Logins Overtime**: from Dashboard: Installed Apps/Okta/Okta - Successful Login Activity 
- **Logins Overtime**: from Dashboard: Okta/Okta - Successful Login Activity - New 
- **MFA Deactivate Event**: from Dashboard: Installed Apps/Okta/Okta - User Authentication and MFA 
- **Okta Admin Access**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **Okta Login by User(s) in different countries within 3 hours**: from Search: Installed Apps/Okta/Okta Login by User(s) in different countries within 3 hours 
- **Okta Login by User(s) in different countries within 3 hours**: from Search: Okta/Okta Login by User(s) in different countries within 3 hours 
- **Outlier in Failed Application Access by User**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Outlier in Successful Application Access by User**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Password Reset Event**: from Dashboard: Okta/Okta - User Activity - New 
- **Password Reset Event**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **Password Update Event**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **Password Update Event**: from Dashboard: Okta/Okta - User Activity - New 
- **Successful Application Access Over Time**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Successful Distinct Application Access by User**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Top 10 Active Users**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **Top 10 Active Users**: from Dashboard: Okta/Okta - User Activity - New 
- **Top 10 Active users**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Top 10 Applications**: from Dashboard: Installed Apps/Okta/Okta - Application Access 
- **Top 10 Users by Login Attempt Count**: from Dashboard: Installed Apps/Okta/Okta - Failed Login Activity 
- **Top 10 Users by Login Attempt Count**: from Dashboard: Okta/Okta - Failed Login Activity - New 
- **Top 10 Users by Login Count**: from Dashboard: Okta/Okta - Successful Login Activity - New 
- **Top 10 Users by Login Count**: from Dashboard: Installed Apps/Okta/Okta - Successful Login Activity 
- **User Account Lock**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **User Account Lock**: from Dashboard: Okta/Okta - User Activity - New 
- **User Authentication**: from Dashboard: Installed Apps/Okta/Okta - User Authentication and MFA 
- **User Authentication Activity**: from Dashboard: Installed Apps/Okta/Okta - User Authentication and MFA 
- **User Authentication via MFA**: from Dashboard: Installed Apps/Okta/Okta - User Authentication and MFA 
- **User Create Event**: from Dashboard: Installed Apps/Okta/Okta - Administrative Actions 
- **User Events Breakdown**: from Dashboard: Okta/Okta - User Activity - New 
- **User Events Breakdown**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **User Events by Severity**: from Dashboard: Installed Apps/Okta/Okta - User Activity 
- **User Events by Severity**: from Dashboard: Okta/Okta - User Activity - New 
- **User MFA Activity**: from Dashboard: Installed Apps/Okta/Okta - User Authentication and MFA 
- **User MFA Events Over Time**: from Dashboard: Installed Apps/Okta/Okta - User Authentication and MFA

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Okta|App Login|Logs|Installed Apps/Okta/Okta - Failed Login Activity| \_sourceCategory={{Logsdatasource}}  "app.generic.unauth\_app\_access\_attempt" <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "app.generic.unauth\_app\_access\_attempt"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name|
|Okta|App Login|Logs|Okta/Okta - Failed Login Activity - New| \_sourceCategory = Labs/Okta "app.generic.unauth\_app\_access\_attempt" <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "app.generic.unauth\_app\_access\_attempt"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name|
|Okta|App Login|Logs|Okta/Okta - Successful Login Activity - New|\_sourceCategory = Labs/Okta "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name|
|Okta|App Login|Logs|Installed Apps/Okta/Okta - Successful Login Activity|\_sourceCategory={{Logsdatasource}}  "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name|
|Okta|Application Created|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  "application.lifecycle.create"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "application\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name, okta\_user\_id, outcome\_result, display\_message|
|Okta|Application Deleted|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  "application.lifecycle.delete"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "application.lifecycle.delete"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name, okta\_user\_id, outcome\_result, display\_message|
|Okta|Application Events by Severity|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "application\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by event\_type, severity<br />\| transpose row event\_type column severity|
|Okta|Application Events by Severity Over Time|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "application\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code<br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by  \_timeslice, severity<br />\| fillmissing timeslice(1h), values("ERROR", "WARN", "INFO") in severity<br />\| transpose row \_timeslice column severity|
|Okta|Breakdown By Application|Logs|Installed Apps/Okta/Okta - Application Access|\_sourceCategory={{Logsdatasource}}  "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name|
|Okta|Breakdown by Client Device and Browser|Logs|Okta/Okta - Failed Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by device, browser<br />\| transpose row device column browser|
|Okta|Breakdown by Client Device and Browser|Logs|Installed Apps/Okta/Okta - Successful Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by device, browser<br />\| transpose row device column browser|
|Okta|Breakdown by Client Device and Browser|Logs|Okta/Okta - Successful Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by device, browser<br />\| transpose row device column browser|
|Okta|Breakdown by Client Device and Browser|Logs|Installed Apps/Okta/Okta - Failed Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by device, browser<br />\| transpose row device column browser|
|Okta|Breakdown by Client OS and Browser|Logs|Okta/Okta - Failed Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by OS, browser<br />\| transpose row OS column browser|
|Okta|Breakdown by Client OS and Browser|Logs|Installed Apps/Okta/Okta - Failed Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by OS, browser<br />\| transpose row OS column browser|
|Okta|Breakdown by Client OS and Browser|Logs|Okta/Okta - Successful Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by OS, browser<br />\| transpose row OS column browser|
|Okta|Breakdown by Client OS and Browser|Logs|Installed Apps/Okta/Okta - Successful Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by OS, browser<br />\| transpose row OS column browser|
|Okta|Breakdown by Events|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "application\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code<br />\| json field=\_raw "severity"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count  event\_type|
|Okta|Connect AD Agent to Okta|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  "system.agent.ad.connect"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "system.agent.ad.connect"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as os <br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by  okta\_user\_id, outcome\_result, display\_message|
|Okta|Deactivated Application|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  "application.lifecycle.deactivate"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "application\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name, okta\_user\_id, outcome\_result, display\_message|
|Okta|Events by Severity Over Time|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by  \_timeslice, severity<br />\| fillmissing timeslice(1h), values("ERROR", "WARN", "INFO") in severity<br />\| transpose row \_timeslice column severity|
|Okta|Events by Severity Over Time|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by  \_timeslice, severity<br />\| fillmissing timeslice(1h), values("ERROR", "WARN", "INFO") in severity<br />\| transpose row \_timeslice column severity|
|Okta|Events by User|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| where okta\_user\_name not in ("unknown", "Okta System")<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_name, event\_type<br />\| transpose row okta\_user\_name column event\_type|
|Okta|Events by User|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| where okta\_user\_name not in ("unknown", "Okta System")<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_name, event\_type<br />\| transpose row okta\_user\_name column event\_type|
|Okta|Failed Application Access by Users|Logs|Installed Apps/Okta/Okta - Application Access| \_sourceCategory={{Logsdatasource}}  "app.generic.unauth\_app\_access\_attempt" <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "app.generic.unauth\_app\_access\_attempt"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as os <br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device <br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].alternateId" as app\_name<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name, okta\_user\_id, outcome\_result, display\_message<br />\| sort by \_count|
|Okta|Failed Application Access by Users over Time|Logs|Installed Apps/Okta/Okta - Application Access| \_sourceCategory={{Logsdatasource}}  "app.generic.unauth\_app\_access\_attempt" <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "app.generic.unauth\_app\_access\_attempt"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as os <br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device <br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].alternateId" as app\_name<br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice, okta\_user\_id<br />\| transpose row \_timeslice column okta\_user\_id <br />\| fillmissing timeslice(1h)|
|Okta|Geolocation of Application Events|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "application\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Okta|Geolocation of Application Logins|Logs|Installed Apps/Okta/Okta - Application Access|\_sourceCategory={{Logsdatasource}}  "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Okta|Geolocation of Logins|Logs|Installed Apps/Okta/Okta - Failed Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE" <br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Okta|Geolocation of Logins|Logs|Installed Apps/Okta/Okta - Successful Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Okta|Geolocation of Logins|Logs|Okta/Okta - Failed Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE" <br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Okta|Geolocation of Logins|Logs|Okta/Okta - Successful Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Okta|Geolocation of User Activity|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Okta|Geolocation of User Activity|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Okta|Login - Outlier|Logs|Installed Apps/Okta/Okta - Failed Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| sort by \_timeslice<br />\| outlier \_count|
|Okta|Login - Outlier|Logs|Installed Apps/Okta/Okta - Successful Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| sort by \_timeslice<br />\| outlier \_count|
|Okta|Login - Outlier|Logs|Okta/Okta - Failed Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| sort by \_timeslice<br />\| outlier \_count|
|Okta|Login - Outlier|Logs|Okta/Okta - Successful Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| sort by \_timeslice<br />\| outlier \_count|
|Okta|Login breakdown by Country and State|Logs|Installed Apps/Okta/Okta - Successful Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by country, state<br />\| transpose row country column state|
|Okta|Login breakdown by Country and State|Logs|Okta/Okta - Failed Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by country, state<br />\| transpose row country column state|
|Okta|Login breakdown by Country and State|Logs|Installed Apps/Okta/Okta - Failed Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by country, state<br />\| transpose row country column state|
|Okta|Login breakdown by Country and State|Logs|Okta/Okta - Successful Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by country, state<br />\| transpose row country column state|
|Okta|Logins Overtime|Logs|Installed Apps/Okta/Okta - Failed Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| sort by \_timeslice|
|Okta|Logins Overtime|Logs|Okta/Okta - Failed Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| sort by \_timeslice|
|Okta|Logins Overtime|Logs|Installed Apps/Okta/Okta - Successful Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| sort by \_timeslice|
|Okta|Logins Overtime|Logs|Okta/Okta - Successful Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| sort by \_timeslice|
|Okta|MFA Deactivate Event|Logs|Installed Apps/Okta/Okta - User Authentication and MFA|\_sourceCategory={{Logsdatasource}}  "user.mfa.factor.deactivate"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.mfa.factor.deactivate"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as okta\_user\_name<br />\| json field=\_raw "target[0].alternateId" as okta\_user\_id<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}")<br />\|count by okta\_user\_id, actor, outcome\_result, country, state|
|Okta|Okta Admin Access|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  "user.session.access\_admin\_app"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.access\_admin\_app"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published"<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as os <br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.state" as state <br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id, city, display\_message, outcome\_result|
|Okta|Okta Login by User(s) in different countries within 3 hours|Logs|Installed Apps/Okta/Okta Login by User(s) in different countries within 3 hours|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"<br />\| json field=\_raw "actor.displayName" as user\_name<br />\| json field=\_raw "actor.alternateId" as user\_email<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity"<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city"<br />\| count by user\_email, country<br />\| count by user\_email<br />\| where \_count \> 1|
|Okta|Okta Login by User(s) in different countries within 3 hours|Logs|Okta/Okta Login by User(s) in different countries within 3 hours|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"<br />\| json field=\_raw "actor.displayName" as user\_name<br />\| json field=\_raw "actor.alternateId" as user\_email<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity"<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city"<br />\| count by user\_email, country<br />\| count by user\_email<br />\| where \_count \> 1|
|Okta|Outlier in Failed Application Access by User|Logs|Installed Apps/Okta/Okta - Application Access| \_sourceCategory={{Logsdatasource}}  "app.generic.unauth\_app\_access\_attempt" <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "app.generic.unauth\_app\_access\_attempt"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as os <br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device <br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].alternateId" as app\_name<br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice, okta\_user\_id<br />\| outlier \_count by okta\_user\_id<br />\| where  \_count\_violation =1|
|Okta|Outlier in Successful Application Access by User|Logs|Installed Apps/Okta/Okta - Application Access|\_sourceCategory={{Logsdatasource}}  "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by \_timeslice, app\_user\_id<br />\| outlier \_count by app\_user\_id<br />\| where  \_count\_violation =1|
|Okta|Password Reset Event|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta "user.account.reset\_password"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.account.reset\_password"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as okta\_user\_name<br />\| json field=\_raw "target[0].alternateId" as okta\_user\_id<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id, actor, outcome\_result, country, state|
|Okta|Password Reset Event|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  "user.account.reset\_password"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.account.reset\_password"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as okta\_user\_name<br />\| json field=\_raw "target[0].alternateId" as okta\_user\_id<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id, actor, outcome\_result, country, state|
|Okta|Password Update Event|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  "user.account.update\_password"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.account.update\_password"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as okta\_user\_name<br />\| json field=\_raw "target[0].alternateId" as okta\_user\_id<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id, actor, outcome\_result, country, state|
|Okta|Password Update Event|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta "user.account.update\_password"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.account.update\_password"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as okta\_user\_name<br />\| json field=\_raw "target[0].alternateId" as okta\_user\_id<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id, actor, outcome\_result, country, state|
|Okta|Successful Application Access Over Time|Logs|Installed Apps/Okta/Okta - Application Access|\_sourceCategory={{Logsdatasource}}  "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name, \_timeslice<br />\| transpose row \_timeslice column app\_name<br />\| fillmissing timeslice(1h)|
|Okta|Successful Distinct Application Access by User|Logs|Installed Apps/Okta/Okta - Application Access|\_sourceCategory={{Logsdatasource}}  "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count\_distinct(app\_name) by \_timeslice, app\_user\_id<br />\| transpose row \_timeslice column app\_user\_id <br />\| fillmissing timeslice(1h)|
|Okta|Top 10 Active Users|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id<br />\| limit 10<br />\| sort by \_count|
|Okta|Top 10 Active Users|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id<br />\| limit 10<br />\| sort by \_count|
|Okta|Top 10 Active users|Logs|Installed Apps/Okta/Okta - Application Access|\_sourceCategory={{Logsdatasource}}  "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_user\_id<br />\| sort by \_count<br />\| limit 10|
|Okta|Top 10 Applications|Logs|Installed Apps/Okta/Okta - Application Access|\_sourceCategory={{Logsdatasource}}  "user.authentication.sso"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type ="user.authentication.sso"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as app\_name<br />\| json field=\_raw "target[0].type" as app\_type<br />\| json field=\_raw "target[1].alternateId" as app\_user\_id<br />\| json field=\_raw "target[1].displayName" as app\_user\_name<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by app\_name<br />\| sort by \_count<br />\| limit 10|
|Okta|Top 10 Users by Login Attempt Count|Logs|Installed Apps/Okta/Okta - Failed Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id<br />\| sort by \_count<br />\| limit 10|
|Okta|Top 10 Users by Login Attempt Count|Logs|Okta/Okta - Failed Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="FAILURE"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id<br />\| sort by \_count<br />\| limit 10|
|Okta|Top 10 Users by Login Count|Logs|Okta/Okta - Successful Login Activity - New|\_sourceCategory = Labs/Okta "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id<br />\| sort by \_count<br />\| limit 10|
|Okta|Top 10 Users by Login Count|Logs|Installed Apps/Okta/Okta - Successful Login Activity|\_sourceCategory={{Logsdatasource}}  "user.session.start"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.session.start"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| where outcome\_result ="SUCCESS"<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by okta\_user\_id<br />\| sort by \_count<br />\| limit 10|
|Okta|User Account Lock|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  "user.account.lock"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.account.lock"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city"<br />\|where if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}")<br />\|count by  actor, actor\_id, outcome\_result, display\_message|
|Okta|User Account Lock|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta "user.account.lock"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.account.lock"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city"<br />\|where if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}")<br />\|count by  actor, actor\_id, outcome\_result, display\_message|
|Okta|User Authentication|Logs|Installed Apps/Okta/Okta - User Authentication and MFA|\_sourceCategory={{Logsdatasource}}  !(user.authentication.auth\_via\_mfa)<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user.auth\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_msg<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}")<br />\|count by  \_timeslice, event\_type<br />\| transpose row \_timeslice column event\_type|
|Okta|User Authentication Activity|Logs|Installed Apps/Okta/Okta - User Authentication and MFA|\_sourceCategory={{Logsdatasource}}  "user.authentication.auth\_via\_AD\_agent"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user.auth\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_msg<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}")<br />\|count by  event\_type, outcome\_result, display\_msg, okta\_user\_id|
|Okta|User Authentication via MFA|Logs|Installed Apps/Okta/Okta - User Authentication and MFA|\_sourceCategory={{Logsdatasource}}  (user.authentication.auth\_via\_mfa)<br />\| json field=\_raw "eventType" as event\_type<br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "actor.detailEntry.factor" as factor <br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "displayMessage" as display\_message<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as os <br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country<br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}")<br />\|count by okta\_user\_id, factor, user\_agent , display\_message, outcome\_result<br />\| sort by \_count|
|Okta|User Create Event|Logs|Installed Apps/Okta/Okta - Administrative Actions|\_sourceCategory={{Logsdatasource}}  "user.lifecycle.create"<br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type = "user.lifecycle.create"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.city" as city nodrop<br />\| json field=\_raw "client.geographicalContext.state" as state nodrop<br />\| json field=\_raw "client.geographicalContext.country" as country nodrop<br />\| json field=\_raw "client.geographicalContext.postalCode" as postal\_code nodrop<br />\| json field=\_raw "target[0].displayName" as okta\_user\_name<br />\| json field=\_raw "target[0].alternateId" as okta\_user\_id<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{event\_type}}" = "\*", true, event\_type matches "{{event\_type}}") AND if ("{{city}}" = "\*", true, city matches "{{city}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by actor, okta\_user\_id, outcome\_result|
|Okta|User Events Breakdown|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by event\_type|
|Okta|User Events Breakdown|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by event\_type|
|Okta|User Events by Severity|Logs|Installed Apps/Okta/Okta - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by event\_type, severity<br />\| transpose row event\_type column severity|
|Okta|User Events by Severity|Logs|Okta/Okta - User Activity - New|\_sourceCategory = Labs/Okta <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published"as published\_time<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| json field=\_raw "actor.type" <br />\| json field=\_raw "severity" as severity <br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.userAgent.rawUserAgent" as user\_agent<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}") AND if ("{{outcome\_result}}" = "\*", true, outcome\_result matches "{{outcome\_result}}") AND if ("{{okta\_user\_name}}" = "\*", true, okta\_user\_name matches "{{okta\_user\_name}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{country}}" = "\*", true, country matches "{{country}}")<br />\|count by event\_type, severity<br />\| transpose row event\_type column severity|
|Okta|User MFA Activity|Logs|Installed Apps/Okta/Okta - User Authentication and MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user.mfa.\*"<br />\| json field=\_raw "outcome.result" as outcome\_result<br />\| json field=\_raw "published" as published\_time<br />\| json field=\_raw "actor.displayName" as actor<br />\| json field=\_raw "actor.alternateId" as actor\_id<br />\| json field=\_raw "actor.type"<br />\| json field=\_raw "severity" as severity<br />\| json field=\_raw "client.userAgent.os" as OS<br />\| json field=\_raw "client.userAgent.browser" as browser<br />\| json field=\_raw "client.device" as device<br />\| json field=\_raw "client.ipAddress" as client\_ip<br />\| json field=\_raw "client.geographicalContext.country" as country <br />\| json field=\_raw "client.geographicalContext.state" as state<br />\| json field=\_raw "client.geographicalContext.city" as city <br />\| json field=\_raw "target[0].displayName" as okta\_user\_name<br />\| json field=\_raw "target[0].alternateId" as okta\_user\_id<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}")<br />\|count by  event\_type, okta\_user\_id, country, state, outcome\_result|
|Okta|User MFA Events Over Time|Logs|Installed Apps/Okta/Okta - User Authentication and MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "eventType" as event\_type<br />\| where event\_type matches "user.mfa\*"<br />\| json field=\_raw "severity"  as severity<br />\| json field=\_raw "actor.displayName" as okta\_user\_name<br />\| json field=\_raw "actor.alternateId" as okta\_user\_id<br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{okta\_user\_id}}" = "\*", true, okta\_user\_id matches "{{okta\_user\_id}}") AND if ("{{user\_agent}}" = "\*", true, user\_agent matches "{{user\_agent}}")<br />\|count by  \_timeslice, event\_type<br />\| transpose row \_timeslice column event\_type|

