# Barracuda CloudGen Firewall
## Sumo Logic App For: Barracuda CloudGen Firewall
The Barracuda CloudGen Firewall app provides a dashboard to monitor actions, IP addresses, and rule and application usage. Data is imported into Sumo via syslog streaming of the Firewall logs.
Docs Link: [Barracuda CloudGen Firewall](https://campus.barracuda.com/product/cloudgenfirewall/doc/91132156/sumo-logic-integration/)

## Searches

### Log Searches

- **Action Summary**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall 
- **Destination IP Addresses**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall 
- **Drop Summary**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall 
- **Protocols Over Time**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall 
- **Rule Summary**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall 
- **Top Applications**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall 
- **Top Destination IP Addresses**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall 
- **Top Source IP Addresses**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall 
- **Top Users**: from Dashboard: Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Barracuda CloudGen Firewall|Action Summary|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   ("type=" AND "proto=")\|parse regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<src\_user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)"\| where !isBlank(action)<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by action\|order by \_count|
|Barracuda CloudGen Firewall|Destination IP Addresses|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   \| parse regex "\\(\\S\\\|\\d\\\|\\S+\\\|\\d\\\|\\S+\\\|\\d+\\\|(?\<atp\_action\>[^\|]\*)\\\|(?\<hostname\>[^\|]\*)\\\|(?\<atp\_timestamp\>\\d+)\\\|.\*(?\<src\_ip\>\\d+.\\d+.\\d+.\\d+):(?\<src\_port\>\\d+) -\> (?\<dest\_ip\>\\d+.\\d+.\\d+.\\d+):(?\<dest\_port\>\\d+)",regex " - (?\<timestamp\>[\\S]+) 1 (?\<src\_ip\>[\\S]+) (?\<dest\_ip\>[\\S]+) (?\<content\_type\>[\\S]+) (?\<srcip\>[\\S]+) (?\<uri\>[\\S]+) (?\<content\_length\>[\\S]+) BYF",regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<src\_user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)" ,regex "File: (?\<file\>\\S+) SHA1: (?\<sha1\>\\S+) DestinationIP: (?\<dest\_ip\>\\S+) DestinationPort: (?\<dest\_port\>\\S+) SourceIP: (?\<src\_ip\>\\S+) SourcePort: (?\<src\_port\>\\S+) Url: (?\<url\>\\S+) Disposition: (?\<disposition\>\\S+)"\|where !isBlank(dest\_ip) \| lookup latitude, longitude from geo://location on ip=dest\_ip<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by latitude, longitude \| sort \_count|
|Barracuda CloudGen Firewall|Drop Summary|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   ("type=" AND "proto=")\|parse regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<src\_user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)"\|where !isBlank(info)<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by info\|order by \_count|
|Barracuda CloudGen Firewall|Protocols Over Time|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   \|parse regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<src\_user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)"\| where !isBlank(proto) \| timeslice 1m<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count as eventCount by \_timeslice, proto \| transpose row \_timeslice column proto|
|Barracuda CloudGen Firewall|Rule Summary|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   ("type=" AND "proto=")\|parse regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<src\_user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)"\|where !isBlank(rule)<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by rule\|order by \_count|
|Barracuda CloudGen Firewall|Top Applications|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   \|parse regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<src\_user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)"\| application as %"Application" \| where !isBlank(Application)<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count as Count by Application \| Sort by Count \| limit 10|
|Barracuda CloudGen Firewall|Top Destination IP Addresses|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   \| parse regex "\\(\\S\\\|\\d\\\|\\S+\\\|\\d\\\|\\S+\\\|\\d+\\\|(?\<atp\_action\>[^\|]\*)\\\|(?\<hostname\>[^\|]\*)\\\|(?\<atp\_timestamp\>\\d+)\\\|.\*(?\<src\_ip\>\\d+.\\d+.\\d+.\\d+):(?\<src\_port\>\\d+) -\> (?\<dest\_ip\>\\d+.\\d+.\\d+.\\d+):(?\<dest\_port\>\\d+)",regex " - (?\<timestamp\>[\\S]+) 1 (?\<src\_ip\>[\\S]+) (?\<dest\_ip\>[\\S]+) (?\<content\_type\>[\\S]+) (?\<srcip\>[\\S]+) (?\<uri\>[\\S]+) (?\<content\_length\>[\\S]+) BYF",regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<src\_user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)",regex "File: (?\<file\>\\S+) SHA1: (?\<sha1\>\\S+) DestinationIP: (?\<dest\_ip\>\\S+) DestinationPort: (?\<dest\_port\>\\S+) SourceIP: (?\<src\_ip\>\\S+) SourcePort: (?\<src\_port\>\\S+) Url: (?\<url\>\\S+) Disposition: (?\<disposition\>\\S+)"\|where !isBlank(dest\_ip)<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count as Hits by dest\_ip \| sort by Hits \| limit 10|
|Barracuda CloudGen Firewall|Top Source IP Addresses|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   \| parse regex "\\(\\S\\\|\\d\\\|\\S+\\\|\\d\\\|\\S+\\\|\\d+\\\|(?\<atp\_action\>[^\|]\*)\\\|(?\<hostname\>[^\|]\*)\\\|(?\<atp\_timestamp\>\\d+)\\\|.\*(?\<src\_ip\>\\d+.\\d+.\\d+.\\d+):(?\<src\_port\>\\d+) -\> (?\<dest\_ip\>\\d+.\\d+.\\d+.\\d+):(?\<dest\_port\>\\d+)",regex " - (?\<timestamp\>[\\S]+) 1 (?\<src\_ip\>[\\S]+) (?\<dest\_ip\>[\\S]+) (?\<content\_type\>[\\S]+) (?\<srcip\>[\\S]+) (?\<uri\>[\\S]+) (?\<content\_length\>[\\S]+) BYF",regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<src\_user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)", regex "File: (?\<file\>\\S+) SHA1: (?\<sha1\>\\S+) DestinationIP: (?\<dest\_ip\>\\S+) DestinationPort: (?\<dest\_port\>\\S+) SourceIP: (?\<src\_ip\>\\S+) SourcePort: (?\<src\_port\>\\S+) Url: (?\<url\>\\S+) Disposition: (?\<disposition\>\\S+)"<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count as Hits by src\_ip \| sort by Hits \| limit 10|
|Barracuda CloudGen Firewall|Top Users|Logs|Installed Apps/Barracuda CloudGen Firewall/Barracuda CloudGen Firewall|\_sourceCategory={{Logsdatasource}}   \| parse regex " (?\<action\>[\\S]\*): type=(?\<type\>[^\|]\*)\\\|proto=(?\<proto\>[^\|]\*)\\\|srcIF=(?\<srcif\>[^\|]\*)\\\|srcIP=(?\<src\_ip\>[^\|]\*)\\\|srcPort=(?\<src\_port\>[^\|]\*)\\\|srcMAC=(?\<srcmac\>[^\|]\*)\\\|dstIP=(?\<dest\_ip\>[^\|]\*)\\\|dstPort=(?\<dest\_port\>[^\|]\*)\\\|dstService=(?\<dstservice\>[^\|]\*)\\\|dstIF=(?\<dstif\>[^\|]\*)\\\|rule=(?\<rule\>[^\|]\*)\\\|info=(?\<info\>[^\|]\*)\\\|srcNAT=(?\<srcnat\>[^\|]\*)\\\|dstNAT=(?\<dstnat\>[^\|]\*)\\\|duration=(?\<duration\>[^\|]\*)\\\|count=(?\<count\>[^\|]\*)\\\|receivedBytes=(?\<receivedbytes\>[^\|]\*)\\\|sentBytes=(?\<sentbytes\>[^\|]\*)\\\|receivedPackets=(?\<receivedpackets\>[^\|]\*)\\\|sentPackets=(?\<sentpackets\>[^\|]\*)\\\|user=(?\<user\>[^\|]\*)\\\|protocol=(?\<protocol\>[^\|]\*)\\\|application=(?\<application\>[^\|]\*)\\\|target=(?\<target\>[^\|]\*)\\\|content=(?\<content\>[^\|]\*)\\\|urlcat=(?\<urlcat\>[^\|]\*)",regex " - (?\<timestamp\>[\\S]+) 1 (?\<src\_ip\>[\\S]+) (?\<dest\_ip\>[\\S]+) (?\<content\_type\>[\\S]+) (?\<srcip\>[\\S]+) (?\<uri\>[\\S]+) (?\<content\_length\>[\\S]+) BYF \\S+ \\S+  \\S+ \\S+ \\S+ \\S+ \\S+ \\(\\S+\\) \\S+ \\S+ \\S+ \\S+ \\S+ \\S+ \\S+ \\[(?\<user\>[^]]\*)\\]"\| where !isEmpty(user) \| replace(user,"-","Unauthenticated")as %"User"<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by user \| limit 10|

