# Azure SQL
## Sumo Logic App For: Azure SQL
Azure SQL Database is a managed relational cloud database service. The Sumo Logic app for Azure SQL helps you monitor activity in Azure SQL. The preconfigured dashboards provide insight into resource utilization, blocking queries, database wait events, errors, runtime execution stats, and other database analytics.
Docs Link: [Azure SQL](https://help.sumologic.com/?cid=56234)

## Searches

### Log Searches

- **Active SQLInsights**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Active SQLInsights**: from Dashboard: Azure SQL/Azure SQL - SQLInsights 
- **Active SQLInsights**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQLInsights 
- **Active SQLInsights**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Audit Actions**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Automatic Tuning Events**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Automatic Tuning 
- **Automatic Tuning Settings Event**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Automatic Tuning 
- **Average Wait Time Per Task**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats 
- **Average Wait Time Per Task**: from Dashboard: Azure SQL/Azure SQL - DatabaseWait Stats 
- **Block Event Details**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Blocking Stats 
- **Block Event Details**: from Dashboard: Azure SQL/Azure SQL - Blocking Stats 
- **Blocks by Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Blocking Stats 
- **Blocks by Database**: from Dashboard: Azure SQL/Azure SQL - Blocking Stats 
- **Blocks by Database Trend**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Blocking Stats 
- **Blocks by Database Trend**: from Dashboard: Azure SQL/Azure SQL - Blocking Stats 
- **CPU Time by DatabaseName**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **CPU Time by DatabaseName**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **CPU Time by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **CPU Time by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Create Index Recommendations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Automatic Tuning 
- **Databases**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Databases**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Detailed Stats**: from Dashboard: Azure SQL/Azure SQL - DatabaseWait Stats 
- **Detailed Stats**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats 
- **Distinct Error Messages - One Day Time Comparison**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Distinct Error Messages - One Day Time Comparison**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Distribution  by Operation Type (Read, Write and Delete)**: from Dashboard: Installed Apps/Azure SQL/Azure SQL -  Administrative Operations 
- **Distribution by Operations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL -  Administrative Operations 
- **Drop Index Recommendations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Automatic Tuning 
- **Error Details**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Error Details**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Error Severity**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Error Severity**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Error Trend**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Error Trend**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Errors**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Errors**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Errors**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Errors**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Errors - One Day Time Comparison**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Errors - One Day Time Comparison**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Errors by Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Errors by Database**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Errors by Severity**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Errors by Severity**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Events by recommendation category**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Execution Count by DatabaseName**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Count by DatabaseName**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Count of Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Count of Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Duration by DatabaseName**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Duration by DatabaseName**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Duration of Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Duration of Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Type of Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Execution Type of Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Failed  Logins**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Failed  Logins Locations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Failed policy events**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Frequency of Physical IO Reads by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Frequency of Physical IO Reads by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **High Impact Recommendations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Insight Metric**: from Dashboard: Azure SQL/Azure SQL - SQLInsights 
- **Insight Metric**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQLInsights 
- **Issue Details**: from Dashboard: Azure SQL/Azure SQL - SQLInsights 
- **Issue Details**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQLInsights 
- **Issue State**: from Dashboard: Azure SQL/Azure SQL - SQLInsights 
- **Issue State**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQLInsights 
- **Issues by Database**: from Dashboard: Azure SQL/Azure SQL - SQLInsights 
- **Issues by Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQLInsights 
- **Latest Issue Status**: from Dashboard: Azure SQL/Azure SQL - SQLInsights 
- **Latest Issue Status**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQLInsights 
- **Lock Duration**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Lock Duration**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Lock Duration**: from Dashboard: Azure SQL/Azure SQL - Blocking Stats 
- **Lock Duration**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Blocking Stats 
- **Lock Mode Used by Query**: from Dashboard: Azure SQL/Azure SQL - Blocking Stats 
- **Lock Mode Used by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Blocking Stats 
- **Log Bytes Used by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Log Bytes Used by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Logical IO Reads by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Logical IO Reads by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Logical IO Writes by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Logical IO Writes by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Logical Servers**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Logical Servers**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Max Degree of Parallelism by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Max Degree of Parallelism by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Max Query Wait Time by DatabaseName**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Max Query Wait Time by DatabaseName**: from Dashboard: Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Memory Used by DatabaseName**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Memory Used by DatabaseName**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Memory Used by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Memory Used by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Operations Trend**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Operations Trend**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Owner Type Used by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Blocking Stats 
- **Owner Type Used by Query**: from Dashboard: Azure SQL/Azure SQL - Blocking Stats 
- **Physical IO Reads by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Physical IO Reads by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Policy events by Severity Level**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Policy events with warning or error**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Recent DDL statements**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Recent Delete Operations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL -  Administrative Operations 
- **Recent DML statements**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Recent DQL and TCL statements**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Recent Failed  Logins**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Recent Failed Policy Events**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Recent policy events with warning or error**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Recent recommendation events**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Recent Resource Health Incidents**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Health 
- **Recent Service Health Incidents**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Health 
- **Recent Write Operations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL -  Administrative Operations 
- **Recommendations by Impact**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Resource Health by  Status**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Health 
- **Rows Returned by Query**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Rows Returned by Query**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Service Health by Incident Type**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Health 
- **Service Health by Incident Type**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Health 
- **Successful  Logins**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Timeouts**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Timeouts 
- **Timeouts**: from Dashboard: Azure SQL/Azure SQL - Timeouts 
- **Timeouts by Database**: from Dashboard: Azure SQL/Azure SQL - Timeouts 
- **Timeouts by Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Timeouts 
- **Timeouts Details**: from Dashboard: Azure SQL/Azure SQL - Timeouts 
- **Timeouts Details**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Timeouts 
- **Top 10 Active Logical Server Names**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 Active Logical Server Names**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Active Resource Groups**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 Active Resource Groups**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Active ResourceId**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 Active ResourceId**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Active Server, Database and Elastic Pool**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 Active Server, Database and Elastic Pool**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Active Server, Databases**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 Active Server, Databases**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Active SubscriptionId**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 Active SubscriptionId**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Categories**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 Categories**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Error Messages**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Top 10 Error Messages**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Top 10 Error States**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Timeouts 
- **Top 10 Error States**: from Dashboard: Azure SQL/Azure SQL - Timeouts 
- **Top 10 Errors**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Errors 
- **Top 10 Errors**: from Dashboard: Azure SQL/Azure SQL - Errors 
- **Top 10 host names**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Top 10 Operations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Operations**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 operations that caused the most errors**: from Dashboard: Installed Apps/Azure SQL/Azure SQL -  Administrative Operations 
- **Top 10 Server, Database and WaitType**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Overview 
- **Top 10 Server, Database and WaitType**: from Dashboard: Azure SQL/Azure SQL - Overview 
- **Top 10 Service Principals**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQL Security Audit 
- **Top Queries by High Execution Time**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Top Queries by High Execution Time**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Total recommendations**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations 
- **Total Wait Time for Query by Wait Category**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Total Wait Time for Query by Wait Category**: from Dashboard: Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Tuning Events by OperationName**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Automatic Tuning 
- **Tuning Events by Type**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Automatic Tuning 
- **Unique Issues**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - SQLInsights 
- **Unique Issues**: from Dashboard: Azure SQL/Azure SQL - SQLInsights 
- **Unique PlanId's**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Unique PlanId's**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Unique QueryId's**: from Dashboard: Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Unique QueryId's**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats 
- **Users / Applications by Operation type**: from Dashboard: Installed Apps/Azure SQL/Azure SQL -  Administrative Operations 
- **Wait Category**: from Dashboard: Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Wait Category**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Wait Category Breakup**: from Dashboard: Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Wait Category Breakup**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Wait Category Trend**: from Dashboard: Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Wait Category Trend**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Wait Details**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Wait Details**: from Dashboard: Azure SQL/Azure SQL - QueryStoreWait Stats 
- **Wait Events Breakdown by Database**: from Dashboard: Azure SQL/Azure SQL - DatabaseWait Stats 
- **Wait Events Breakdown by Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats 
- **Wait Events by Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats 
- **Wait Events by Database**: from Dashboard: Azure SQL/Azure SQL - DatabaseWait Stats 
- **Wait Type Trend**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats 
- **Wait Type Trend**: from Dashboard: Azure SQL/Azure SQL - DatabaseWait Stats

### Metric Searches

- **Avg CPU Utilization Percent Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Avg CPU Utilization Percent Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Blocked by Firewall**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Blocked by Firewall**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Blocked by Firewall Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Blocked by Firewall Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Connection Failed**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Connection Failed**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Connection Failed Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Connection Failed Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Deadlocks**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Deadlocks**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Deadlocks Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Deadlocks Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **DTU Consumption Percent Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **DTU Consumption Percent Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **DTU Limit Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **DTU Limit Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **DTU Used Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **DTU Used Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Log Write Percent**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Log Write Percent**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Max CPU Utilization Percent Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Max CPU Utilization Percent Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Physical Data Read Percent**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Physical Data Read Percent**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Sessions Percent Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Sessions Percent Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Storage Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Storage Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Storage Percent Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Storage Percent Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Successful Connection**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Successful Connection**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Successful Connection Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Successful Connection Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **Workers Percent Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **Workers Percent Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics 
- **XPT Storage Percent Per Database**: from Dashboard: Azure SQL/Azure SQL - Metrics 
- **XPT Storage Percent Per Database**: from Dashboard: Installed Apps/Azure SQL/Azure SQL - Metrics

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Azure SQL|Active SQLInsights|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}}  SQLInsights "\\"operationName\\":\\"Insight\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\| where status="Active"<br />\| count|
|Azure SQL|Active SQLInsights|Logs|Azure SQL/Azure SQL - SQLInsights|\_sourceCategory={{Logsdatasource}}  SQLInsights "\\"operationName\\":\\"Insight\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\| where status="Active"<br />\| count|
|Azure SQL|Active SQLInsights|Logs|Installed Apps/Azure SQL/Azure SQL - SQLInsights|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  SQLInsights <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}")  AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\| where status="Active"<br />\| count|
|Azure SQL|Active SQLInsights|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  SQLInsights <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\| where status="Active"<br />\| count|
|Azure SQL|Audit Actions|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name" as logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\| count by action<br />\| sort by \_count<br />|
|Azure SQL|Automatic Tuning Events|Logs|Installed Apps/Azure SQL/Azure SQL - Automatic Tuning|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} AutomaticTuning <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties  "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName)<br />\|where  if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND  if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") and category="AutomaticTuning"<br />\| count|
|Azure SQL|Automatic Tuning Settings Event|Logs|Installed Apps/Azure SQL/Azure SQL - Automatic Tuning|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} AutomaticTuning <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "DatabaseName", "ElasticPoolName" nodrop<br />\| where category="AutomaticTuning" and operationName = "AutomaticTuningSettingsEvent" and if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND  if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\| count as eventCount by  LogicalServerName, DatabaseName, operationName, properties|
|Azure SQL|Average Wait Time Per Task|Logs|Azure SQL/Azure SQL - DatabaseWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"DatabaseWaitStatistcsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(delta\_waiting\_tasks\_count) as sum\_delta\_waiting\_tasks\_count, sum(delta\_wait\_time\_ms) as sum\_delta\_wait\_time\_ms by LogicalServerName, DatabaseName, ElasticPoolName, wait\_type <br />\| sum\_delta\_wait\_time\_ms/sum\_delta\_waiting\_tasks\_count as Avg\_Wait\_Time\_Per\_Task<br />\| sort by Avg\_Wait\_Time\_Per\_Task, sum\_delta\_waiting\_tasks\_count|
|Azure SQL|Average Wait Time Per Task|Logs|Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  DatabaseWaitStatistcsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\|where if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(delta\_waiting\_tasks\_count) as sum\_delta\_waiting\_tasks\_count, sum(delta\_wait\_time\_ms) as sum\_delta\_wait\_time\_ms by LogicalServerName, DatabaseName, ElasticPoolName, wait\_type <br />\| sum\_delta\_wait\_time\_ms/sum\_delta\_waiting\_tasks\_count as Avg\_Wait\_Time\_Per\_Task<br />\| sort by Avg\_Wait\_Time\_Per\_Task, sum\_delta\_waiting\_tasks\_count|
|Azure SQL|Avg CPU Utilization Percent Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=cpu\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Avg CPU Utilization Percent Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=cpu\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Block Event Details|Logs|Azure SQL/Azure SQL - Blocking Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"BlockEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(duration) as lock\_duration by LogicalServerName, DatabaseName, ElasticPoolName, lock\_mode, resource\_owner\_type, blockedprocess\_transactionname, blockingprocess\_clientapp, blockingprocess\_isolationlevel<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields -lock\_duration<br />\| sort by lock\_duration\_sec|
|Azure SQL|Block Event Details|Logs|Installed Apps/Azure SQL/Azure SQL - Blocking Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  BlockEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}")  AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(duration) as lock\_duration by LogicalServerName, DatabaseName, ElasticPoolName, lock\_mode, resource\_owner\_type, blockedprocess\_transactionname, blockingprocess\_clientapp, blockingprocess\_isolationlevel<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields -lock\_duration<br />\| sort by lock\_duration\_sec|
|Azure SQL|Blocked by Firewall|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=blocked\_by\_firewall statistic=count \| sum |
|Azure SQL|Blocked by Firewall|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=blocked\_by\_firewall statistic=count \| sum |
|Azure SQL|Blocked by Firewall Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=blocked\_by\_firewall  statistic=count resourceId=\* \| sum by resourceId |
|Azure SQL|Blocked by Firewall Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=blocked\_by\_firewall  statistic=count resourceId=\* \| sum by resourceId |
|Azure SQL|Blocks by Database|Logs|Azure SQL/Azure SQL - Blocking Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"BlockEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount, sum(duration) as lock\_duration by LogicalServerName, DatabaseName<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields -lock\_duration<br />\| sort by eventCount, lock\_duration\_sec, LogicalServerName, DatabaseName|
|Azure SQL|Blocks by Database|Logs|Installed Apps/Azure SQL/Azure SQL - Blocking Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  BlockEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}")  AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount, sum(duration) as lock\_duration by LogicalServerName, DatabaseName<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields -lock\_duration<br />\| sort by eventCount, lock\_duration\_sec, LogicalServerName, DatabaseName|
|Azure SQL|Blocks by Database Trend|Logs|Azure SQL/Azure SQL - Blocking Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"BlockEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\| timeslice 1d<br />\| concat (LogicalServerName, " : " ,DatabaseName) as Server\_DatabaseName<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(duration) as lock\_duration by \_timeslice, Server\_DatabaseName<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields -lock\_duration<br />\| transpose row \_timeslice column Server\_DatabaseName|
|Azure SQL|Blocks by Database Trend|Logs|Installed Apps/Azure SQL/Azure SQL - Blocking Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  BlockEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\| timeslice 1d<br />\| concat (LogicalServerName, " : " ,DatabaseName) as Server\_DatabaseName<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}")  AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(duration) as lock\_duration by \_timeslice, Server\_DatabaseName<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields -lock\_duration<br />\| transpose row \_timeslice column Server\_DatabaseName|
|Azure SQL|Connection Failed|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=connection\_failed\* statistic=count \| sum |
|Azure SQL|Connection Failed|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=connection\_failed\* statistic=count \| sum |
|Azure SQL|Connection Failed Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=connection\_failed\* statistic=count resourceId=\* \| sum by resourceId|
|Azure SQL|Connection Failed Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=connection\_failed\* statistic=count resourceId=\* \| sum by resourceId|
|Azure SQL|CPU Time by DatabaseName|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "cpu\_time"  nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(cpu\_time) as sum\_cpu\_time\_microsec by \_timeslice, DatabaseName<br />\| transpose row \_timeslice column DatabaseName|
|Azure SQL|CPU Time by DatabaseName|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "cpu\_time"  nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(cpu\_time) as sum\_cpu\_time\_microsec by \_timeslice, DatabaseName<br />\| transpose row \_timeslice column DatabaseName|
|Azure SQL|CPU Time by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "cpu\_time" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(cpu\_time) as cpu\_time by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|CPU Time by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "cpu\_time" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(cpu\_time) as cpu\_time by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Create Index Recommendations|Logs|Installed Apps/Azure SQL/Azure SQL - Automatic Tuning|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} CREATE\_INDEX AutomaticTuning <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "DatabaseName", "ElasticPoolName" nodrop<br />\| where category="AutomaticTuning" and !(operationName in ("AutomaticTuningSettingsEvent", "AutomaticTuningSettingsSnapshotEvent")) and if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND  if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") <br />\| count as eventCount by  LogicalServerName, DatabaseName, operationName, properties|
|Azure SQL|Databases|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and !isEmpty(DatabaseName)<br />\| concat(LogicalServerName, ":", DatabaseName) as Databases<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count\_distinct(Databases) as Databases|
|Azure SQL|Databases|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and !isEmpty(DatabaseName)<br />\| concat(LogicalServerName, ":", DatabaseName) as Databases<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count\_distinct(Databases) as Databases|
|Azure SQL|Deadlocks|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=deadlock statistic=count \| sum|
|Azure SQL|Deadlocks|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=deadlock statistic=count \| sum|
|Azure SQL|Deadlocks Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=deadlock statistic=count resourceId=\* \| sum by resourceId|
|Azure SQL|Deadlocks Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=deadlock statistic=count resourceId=\* \| sum by resourceId|
|Azure SQL|Detailed Stats|Logs|Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  DatabaseWaitStatistcsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\| timeslice 1s<br />\|where if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, wait\_type, delta\_max\_wait\_time\_ms, delta\_signal\_wait\_time\_ms, delta\_wait\_time\_ms, delta\_waiting\_tasks\_count <br />\| sort by \_timeslice<br />\| fields -eventCount|
|Azure SQL|Detailed Stats|Logs|Azure SQL/Azure SQL - DatabaseWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"DatabaseWaitStatistcsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\| timeslice 1s<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, wait\_type, delta\_max\_wait\_time\_ms, delta\_signal\_wait\_time\_ms, delta\_wait\_time\_ms, delta\_waiting\_tasks\_count <br />\| sort by \_timeslice<br />\| fields -eventCount|
|Azure SQL|Distinct Error Messages - One Day Time Comparison|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count\_distinct(message) as uniqueErrorMessages by \_timeslice<br />\| compare with timeshift 1d|
|Azure SQL|Distinct Error Messages - One Day Time Comparison|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count\_distinct(message) as uniqueErrorMessages by \_timeslice<br />\| compare with timeshift 1d|
|Azure SQL|Distribution  by Operation Type (Read, Write and Delete)|Logs|Installed Apps/Azure SQL/Azure SQL -  Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} <br /> provider\_name={{provider\_name}} resource\_type={{resource\_type}} \*SQL\* Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative" and if ("{{database\_name}}" = "\*", true, service\_name matches "{{database\_name}}")<br />\| "OTHERS" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by operationType<br />\| sort by \_count|
|Azure SQL|Distribution by Operations|Logs|Installed Apps/Azure SQL/Azure SQL -  Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}} \*SQL\* Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative" and  if ("{{database\_name}}" = "\*", true, service\_name matches "{{database\_name}}")<br />\| count by operationName<br />\| order by \_count|
|Azure SQL|Drop Index Recommendations|Logs|Installed Apps/Azure SQL/Azure SQL - Automatic Tuning|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} DROP\_INDEX AutomaticTuning <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "DatabaseName", "ElasticPoolName" nodrop<br />\|where category="AutomaticTuning" and !(operationName in ("AutomaticTuningSettingsEvent", "AutomaticTuningSettingsSnapshotEvent")) AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND  if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\| count as eventCount by  LogicalServerName, DatabaseName, operationName, properties|
|Azure SQL|DTU Consumption Percent Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=dtu\_consumption\_percent statistic=maximum resourceId=\* \| max by resourceId |
|Azure SQL|DTU Consumption Percent Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=dtu\_consumption\_percent statistic=maximum resourceId=\* \| max by resourceId |
|Azure SQL|DTU Limit Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=dtu\_limit statistic=maximum resourceId=\* \| max by resourceId |
|Azure SQL|DTU Limit Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=dtu\_limit statistic=maximum resourceId=\* \| max by resourceId |
|Azure SQL|DTU Used Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=dtu\_used statistic=maximum resourceId=\* \| max by resourceId |
|Azure SQL|DTU Used Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=dtu\_used statistic=maximum resourceId=\* \| max by resourceId |
|Azure SQL|Error Details|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\| timeslice 1s<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice, LogicalServerName, DatabaseName, severity, error\_number, message, user\_defined, state<br />\| sort by \_timeslice|
|Azure SQL|Error Details|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\| timeslice 1s<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by \_timeslice, LogicalServerName, DatabaseName, severity, error\_number, message, user\_defined, state<br />\| sort by \_timeslice|
|Azure SQL|Error Severity|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "severity", "error\_number", "DatabaseName", "ElasticPoolName" nodrop<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by severity<br />\| sort by eventCount, severity asc|
|Azure SQL|Error Severity|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "severity", "error\_number", "DatabaseName", "ElasticPoolName" nodrop<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by severity<br />\| sort by eventCount, severity asc|
|Azure SQL|Error Trend|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by \_timeslice, error\_number<br />\| transpose row \_timeslice column error\_number<br />\| fillmissing timeslice(15m)|
|Azure SQL|Error Trend|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice, error\_number<br />\| transpose row \_timeslice column error\_number<br />\| fillmissing timeslice(15m)|
|Azure SQL|Errors|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "severity", "error\_number", "DatabaseName", "ElasticPoolName" nodrop<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount|
|Azure SQL|Errors|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount|
|Azure SQL|Errors|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount|
|Azure SQL|Errors|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "severity", "error\_number", "DatabaseName", "ElasticPoolName" nodrop<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount|
|Azure SQL|Errors - One Day Time Comparison|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by \_timeslice<br />\| compare with timeshift 1d|
|Azure SQL|Errors - One Day Time Comparison|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice<br />\| compare with timeshift 1d|
|Azure SQL|Errors by Database|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by DatabaseName<br />\| top 10 DatabaseName by eventCount, DatabaseName asc|
|Azure SQL|Errors by Database|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by DatabaseName<br />\| top 10 DatabaseName by eventCount, DatabaseName asc|
|Azure SQL|Errors by Severity|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by severity<br />\| sort by eventCount, severity asc|
|Azure SQL|Errors by Severity|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by severity<br />\| sort by eventCount, severity asc|
|Azure SQL|Events by recommendation category|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "recommendationResourceLink" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink nodrop<br />\| where category="Recommendation" <br />\| count by recommendationCategory<br />\| sort by \_count|
|Azure SQL|Execution Count by DatabaseName|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "cpu\_time", "count\_executions"  nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(count\_executions) as count\_executions by \_timeslice, DatabaseName<br />\| transpose row \_timeslice column DatabaseName|
|Azure SQL|Execution Count by DatabaseName|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "cpu\_time", "count\_executions"  nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(count\_executions) as count\_executions by \_timeslice, DatabaseName<br />\| transpose row \_timeslice column DatabaseName|
|Azure SQL|Execution Count of Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(count\_executions) as count\_executions by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Execution Count of Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(count\_executions) as count\_executions by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Execution Duration by DatabaseName|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "cpu\_time", "duration"  nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(duration) as sum\_duration\_microsec by \_timeslice, DatabaseName<br />\| transpose row \_timeslice column DatabaseName|
|Azure SQL|Execution Duration by DatabaseName|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "cpu\_time", "duration"  nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(duration) as sum\_duration\_microsec by \_timeslice, DatabaseName<br />\| transpose row \_timeslice column DatabaseName|
|Azure SQL|Execution Duration of Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(duration) as duration by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Execution Duration of Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(duration) as duration by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Execution Type of Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads", "logical\_io\_writes", "execution\_type" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| if (execution\_type == "0", "Regular", if (execution\_type == "3", "Aborted", if (execution\_type == "4", "Exception", execution\_type))) as execution\_type<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by \_timeslice, execution\_type<br />\| transpose row \_timeslice column execution\_type<br />\| fillmissing timeslice(1h)|
|Azure SQL|Execution Type of Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads", "logical\_io\_writes", "execution\_type" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| if (execution\_type == "0", "Regular", if (execution\_type == "3", "Aborted", if (execution\_type == "4", "Exception", execution\_type))) as execution\_type<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice, execution\_type<br />\| transpose row \_timeslice column execution\_type<br />\| fillmissing timeslice(1h)|
|Azure SQL|Failed  Logins|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name" as logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") AND action="DATABASE AUTHENTICATION FAILED"<br />\| count|
|Azure SQL|Failed  Logins Locations|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name" as logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") AND action="DATABASE AUTHENTICATION FAILED"<br />\| count by client\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort by \_count<br />|
|Azure SQL|Failed policy events|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} Policy<br />\| JSON "category", "resultType", "level", "properties.resourceLocation", "properties.entity" as category, resultType, level, location, entity nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Failure"<br />\| count |
|Azure SQL|Frequency of Physical IO Reads by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads", "num\_physical\_io\_reads" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(num\_physical\_io\_reads) as Frequency\_physical\_io\_reads by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Frequency of Physical IO Reads by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads", "num\_physical\_io\_reads" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(num\_physical\_io\_reads) as Frequency\_physical\_io\_reads by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|High Impact Recommendations|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "recommendationResourceLink" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink nodrop<br />\| where category="Recommendation" and recommendationImpact = "High"<br />\| count|
|Azure SQL|Insight Metric|Logs|Installed Apps/Azure SQL/Azure SQL - SQLInsights|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  SQLInsights <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\| withtime metric \| withtime value<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}")  AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|most\_recent(metric\_withtime) as %"LatestMetric", most\_recent(value\_withtime) as %"LatestValue" by issueId|
|Azure SQL|Insight Metric|Logs|Azure SQL/Azure SQL - SQLInsights|\_sourceCategory={{Logsdatasource}}  SQLInsights "\\"operationName\\":\\"Insight\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\| withtime metric \| withtime value<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|most\_recent(metric\_withtime) as %"LatestMetric", most\_recent(value\_withtime) as %"LatestValue" by issueId|
|Azure SQL|Issue Details|Logs|Azure SQL/Azure SQL - SQLInsights|\_sourceCategory={{Logsdatasource}}  SQLInsights "\\"operationName\\":\\"Insight\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\| timeslice 1s<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, issueId, status, metric, value, impact, detections, rootCauseAnalysis<br />\| sort by issueId, \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, metric, status, rootCauseAnalysis<br />\| fields -eventCount|
|Azure SQL|Issue Details|Logs|Installed Apps/Azure SQL/Azure SQL - SQLInsights|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  SQLInsights <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\| timeslice 1s<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}")  AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, issueId, status, metric, value, impact, detections, rootCauseAnalysis<br />\| sort by issueId, \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, metric, status, rootCauseAnalysis<br />\| fields -eventCount|
|Azure SQL|Issue State|Logs|Installed Apps/Azure SQL/Azure SQL - SQLInsights|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  SQLInsights <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\| withtime status \| withtime \_messagetime \| withtime value<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}")  AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|least\_recent(\_messagetime\_withtime) as earliest\_time, least\_recent(status\_withtime) as earliest\_status, least\_recent(value\_withtime) as earliest\_metricValue, most\_recent(\_messagetime\_withtime) as latest\_time, most\_recent(status\_withtime) as latest\_status, most\_recent(value\_withtime) as latest\_metricValue by LogicalServerName, DatabaseName, ElasticPoolName, metric, issueId<br />\| formatDate(fromMillis(earliest\_time), "MM-dd-yyyy HH:mm:ss:SSS Z") as earliest\_event\_time<br />\| formatDate(fromMillis(latest\_time), "MM-dd-yyyy HH:mm:ss:SSS Z") as latest\_event\_time<br />\| fields -earliest\_time, latest\_time|
|Azure SQL|Issue State|Logs|Azure SQL/Azure SQL - SQLInsights|\_sourceCategory={{Logsdatasource}}  SQLInsights "\\"operationName\\":\\"Insight\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\| withtime status \| withtime \_messagetime \| withtime value<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|least\_recent(\_messagetime\_withtime) as earliest\_time, least\_recent(status\_withtime) as earliest\_status, least\_recent(value\_withtime) as earliest\_metricValue, most\_recent(\_messagetime\_withtime) as latest\_time, most\_recent(status\_withtime) as latest\_status, most\_recent(value\_withtime) as latest\_metricValue by LogicalServerName, DatabaseName, ElasticPoolName, metric, issueId<br />\| formatDate(fromMillis(earliest\_time), "MM-dd-yyyy HH:mm:ss:SSS Z") as earliest\_event\_time<br />\| formatDate(fromMillis(latest\_time), "MM-dd-yyyy HH:mm:ss:SSS Z") as latest\_event\_time<br />\| fields -earliest\_time, latest\_time|
|Azure SQL|Issues by Database|Logs|Installed Apps/Azure SQL/Azure SQL - SQLInsights|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  SQLInsights <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}")  AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count\_distinct(issueId) as %"Issues" by LogicalServerName, databaseName|
|Azure SQL|Issues by Database|Logs|Azure SQL/Azure SQL - SQLInsights|\_sourceCategory={{Logsdatasource}}  SQLInsights "\\"operationName\\":\\"Insight\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count\_distinct(issueId) as %"Issues" by LogicalServerName, databaseName|
|Azure SQL|Latest Issue Status|Logs|Azure SQL/Azure SQL - SQLInsights|\_sourceCategory={{Logsdatasource}}  SQLInsights "\\"operationName\\":\\"Insight\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\| withtime status \| withtime rootCauseAnalysis<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|most\_recent(status\_withtime) as %"LatestStatus", most\_recent(rootCauseAnalysis\_withtime) as %"LatestRootCauseAnalysis" by issueId<br />\| count as %"IssueCount" by %"LatestStatus", %"LatestRootCauseAnalysis"|
|Azure SQL|Latest Issue Status|Logs|Installed Apps/Azure SQL/Azure SQL - SQLInsights|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  SQLInsights <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\| withtime status \| withtime rootCauseAnalysis<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}")  AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|most\_recent(status\_withtime) as %"LatestStatus", most\_recent(rootCauseAnalysis\_withtime) as %"LatestRootCauseAnalysis" by issueId<br />\| count as %"IssueCount" by %"LatestStatus", %"LatestRootCauseAnalysis"|
|Azure SQL|Lock Duration|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  BlockEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| where operationName = "BlockEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(duration) as lock\_duration<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields lock\_duration\_sec|
|Azure SQL|Lock Duration|Logs|Installed Apps/Azure SQL/Azure SQL - Blocking Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  BlockEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}")  AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(duration) as lock\_duration<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields lock\_duration\_sec|
|Azure SQL|Lock Duration|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"BlockEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| where operationName = "BlockEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(duration) as lock\_duration<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields lock\_duration\_sec|
|Azure SQL|Lock Duration|Logs|Azure SQL/Azure SQL - Blocking Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"BlockEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(duration) as lock\_duration<br />\| (lock\_duration/(1000\*1000)) as lock\_duration\_sec<br />\| fields lock\_duration\_sec|
|Azure SQL|Lock Mode Used by Query|Logs|Installed Apps/Azure SQL/Azure SQL - Blocking Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  BlockEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}")  AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by lock\_mode<br />\| sort by eventCount, lock\_mode asc|
|Azure SQL|Lock Mode Used by Query|Logs|Azure SQL/Azure SQL - Blocking Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"BlockEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by lock\_mode<br />\| sort by eventCount, lock\_mode asc|
|Azure SQL|Log Bytes Used by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "cpu\_time", "query\_max\_used\_memory", "log\_bytes\_used" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(log\_bytes\_used) as log\_bytes\_used by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Log Bytes Used by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "cpu\_time", "query\_max\_used\_memory", "log\_bytes\_used" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(log\_bytes\_used) as log\_bytes\_used by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Log Write Percent|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=log\_write\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Log Write Percent|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=log\_write\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Logical IO Reads by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(logical\_io\_reads) as logical\_io\_reads by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Logical IO Reads by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(logical\_io\_reads) as logical\_io\_reads by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Logical IO Writes by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads", "logical\_io\_writes" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(logical\_io\_writes) as logical\_io\_writes by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Logical IO Writes by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads", "logical\_io\_writes" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(logical\_io\_writes) as logical\_io\_writes by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Logical Servers|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName)<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count\_distinct(LogicalServerName) as LogicalServers|
|Azure SQL|Logical Servers|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName)<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count\_distinct(LogicalServerName) as LogicalServers|
|Azure SQL|Max CPU Utilization Percent Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=cpu\_percent statistic=maximum resourceId=\* \| max by resourceId |
|Azure SQL|Max CPU Utilization Percent Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=cpu\_percent statistic=maximum resourceId=\* \| max by resourceId |
|Azure SQL|Max Degree of Parallelism by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads", "num\_physical\_io\_reads", "dop" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|max(dop) as max\_dop by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Max Degree of Parallelism by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads", "num\_physical\_io\_reads", "dop" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|max(dop) as max\_dop by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Max Query Wait Time by DatabaseName|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreWaitStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName", "max\_query\_wait\_time\_ms"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| timeslice 1h<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}")  AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|max(max\_query\_wait\_time\_ms) as max\_query\_wait\_time\_ms by \_timeslice, databaseName<br />\| transpose row \_timeslice column databaseName|
|Azure SQL|Max Query Wait Time by DatabaseName|Logs|Azure SQL/Azure SQL - QueryStoreWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreWaitStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName", "max\_query\_wait\_time\_ms"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|max(max\_query\_wait\_time\_ms) as max\_query\_wait\_time\_ms by \_timeslice, databaseName<br />\| transpose row \_timeslice column databaseName|
|Azure SQL|Memory Used by DatabaseName|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "cpu\_time", "query\_max\_used\_memory"  nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(query\_max\_used\_memory) as sum\_query\_max\_used\_memory\_kb by \_timeslice, DatabaseName<br />\| transpose row \_timeslice column DatabaseName|
|Azure SQL|Memory Used by DatabaseName|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "cpu\_time", "query\_max\_used\_memory"  nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(query\_max\_used\_memory) as sum\_query\_max\_used\_memory\_kb by \_timeslice, DatabaseName<br />\| transpose row \_timeslice column DatabaseName|
|Azure SQL|Memory Used by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "cpu\_time", "query\_max\_used\_memory" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(query\_max\_used\_memory) as query\_max\_used\_memory by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Memory Used by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "cpu\_time", "query\_max\_used\_memory" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(query\_max\_used\_memory) as query\_max\_used\_memory by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Operations Trend|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by operationName, \_timeslice<br />\| transpose row \_timeslice column operationName|
|Azure SQL|Operations Trend|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| timeslice 1h<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by operationName, \_timeslice<br />\| transpose row \_timeslice column operationName|
|Azure SQL|Owner Type Used by Query|Logs|Azure SQL/Azure SQL - Blocking Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"BlockEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by resource\_owner\_type<br />\| sort by eventCount, resource\_owner\_type asc|
|Azure SQL|Owner Type Used by Query|Logs|Installed Apps/Azure SQL/Azure SQL - Blocking Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  BlockEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "duration", "lock\_mode", "resource\_owner\_type", "blocked\_process\_filtered"  nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocked-process/process/@transactionname" as blockedprocess\_transactionname nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@clientapp" as blockingprocess\_clientapp nodrop<br />\| parse xml field=blocked\_process\_filtered "/blocked-process-report/blocking-process/process/@isolationlevel" as blockingprocess\_isolationlevel nodrop<br />\| where operationName = "BlockEvent"<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{resource\_owner\_type}}" = "\*", true, resource\_owner\_type matches "{{resource\_owner\_type}}") AND if ("{{blockedprocess\_transactionname}}" = "\*", true, blockedprocess\_transactionname matches "{{blockedprocess\_transactionname}}") AND if ("{{blockingprocess\_clientapp}}" = "\*", true, blockingprocess\_clientapp matches "{{blockingprocess\_clientapp}}")  AND if ("{{lock\_mode}}" = "\*", true, lock\_mode matches "{{lock\_mode}}") AND if ("{{blockingprocess\_isolationlevel}}" = "\*", true, blockingprocess\_isolationlevel matches "{{blockingprocess\_isolationlevel}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by resource\_owner\_type<br />\| sort by eventCount, resource\_owner\_type asc|
|Azure SQL|Physical Data Read Percent|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=physical\_data\_read\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Physical Data Read Percent|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=physical\_data\_read\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Physical IO Reads by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(physical\_io\_reads) as physical\_io\_reads by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Physical IO Reads by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount", "physical\_io\_reads", "logical\_io\_reads" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(physical\_io\_reads) as physical\_io\_reads by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash<br />\| fillmissing timeslice(1h)|
|Azure SQL|Policy events by Severity Level|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} Policy <br />\| JSON "category", "resultType", "level", "properties.message", "properties.resourceLocation", "properties.entity", "properties.policies" as category, resultType, level, message, location, entity, policies nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Success"<br />\| resource\_name as logicalServerName \| service\_name as databaseName \| count as Count by level, resource\_group, logicalServerName, databaseName, location<br />\| transpose row resource\_group, logicalServerName, databaseName, location column level|
|Azure SQL|Policy events with warning or error|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} Policy<br />\| JSON "category", "resultType", "level", "properties.resourceLocation", "properties.entity" as category, resultType, level, location, entity nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Success" and level != "Information"<br />\| count |
|Azure SQL|Recent DDL statements|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "properties.event\_time", "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name", "properties.statement" as event\_time, logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name, statement nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") AND action matches /CREATE\|DROP\|RENAME\|TRUNCATE\|ALTER\|GRANT\|DENY\|REVOKE/<br />\| count by event\_time, LogicalServerName, databasename, host\_name, client\_ip, session\_server\_principal\_name, object\_name, application\_name,  action, statement<br />\| fields -\_count<br />\| sort by event\_time desc|
|Azure SQL|Recent Delete Operations|Logs|Installed Apps/Azure SQL/Azure SQL -  Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "properties.entity", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, entity, identity\_claims\_name, authmethods nodrop<br />\| where resultType="Accept" and category="Administrative" and  if ("{{database\_name}}" = "\*", true, service\_name matches "{{database\_name}}") and toUppercase(operationName) matches /DELETE/ <br />\| if (idtyp =="user", name, appid) as name<br />\| resource\_name as logicalServerName<br />\| service\_name as databaseName<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, logicalServerName, databaseName, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message, entity<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure SQL|Recent DML statements|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "properties.event\_time", "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name", "properties.statement" as event\_time, logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name, statement nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") AND action matches /INSERT\|UPDATE\|DELETE\|LOCK\|CALL\|EXEC\|EXPLAIN/<br />\| count by event\_time, LogicalServerName, databasename, host\_name, client\_ip, session\_server\_principal\_name, object\_name, application\_name,  action, statement<br />\| fields -\_count<br />\| sort by event\_time desc|
|Azure SQL|Recent DQL and TCL statements|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "properties.event\_time", "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name", "properties.statement" as event\_time, logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name, statement nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") AND action matches /TRANSACTION\|COMMIT\|ROLLBACK\|SAVEPOINT\|SELECT/<br />\| count by event\_time, LogicalServerName, databasename, host\_name, client\_ip, session\_server\_principal\_name, object\_name, application\_name, action, statement<br />\| fields -\_count<br />\| sort by event\_time desc|
|Azure SQL|Recent Failed  Logins|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name", "properties.additional\_information" as logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name, additional\_information nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") AND action="DATABASE AUTHENTICATION FAILED"<br />\| count by LogicalServerName, databasename, host\_name, client\_ip, session\_server\_principal\_name, object\_name, application\_name, additional\_information|
|Azure SQL|Recent Failed Policy Events|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} Policy<br />\| JSON "category", "resultType", "level", "properties.message", "properties.resourceLocation", "properties.entity", "properties.policies" as category, resultType, level, message, location, entity, policies nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Failure"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count as Count by time, level, resource\_group, resource\_name, location, policies<br />\| fields -Count|
|Azure SQL|Recent policy events with warning or error|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} Policy<br />\| JSON "category", "resultType", "level", "properties.message", "properties.resourceLocation", "properties.entity", "properties.policies" as category, resultType, level, message, location, entity, policies nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Success" and level!= "Information"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count as Count by time, level, resource\_group, resource\_name, location, policies<br />\| fields -Count|
|Azure SQL|Recent recommendation events|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "properties.recommendationResourceLink", "resourceId" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink, resourceId nodrop<br />\| where category="Recommendation" <br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| resource\_name as logicalServerName<br />\| if (resourceId matches /DATABASES/, service\_name, "") as database\_name<br />\| count by \_messageTime, time, logicalServerName, database\_name, recommendationName, recommendationCategory, recommendationImpact, recommendationResourceLink<br />\| tourl(recommendationResourceLink, recommendationName) as recommendationName<br />\| sort by \_messageTime desc<br />\| fields -\_messageTime, \_count, recommendationResourceLink|
|Azure SQL|Recent Resource Health Incidents|Logs|Installed Apps/Azure SQL/Azure SQL - Health|tenant\_name={{tenant\_name}}<br />provider\_name={{provider\_name}}<br />resource\_type={{resource\_type}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}} ResourceHealth <br />\| JSON "category", "operationName", "time","level","resultType", "properties.title", "properties.details", "properties.currentHealthStatus", "properties.type", "properties.cause" as category, operationName, time,level,resultType, title, details, currentHealthStatus, type, cause nodrop<br />\| where category="ResourceHealth"<br />\| parse field=operationName "\*/\*/\*" as category, operation\_name, action nodrop<br />\| count as Count by time, level, resource\_name, resource\_group, resultType, operation\_name, title, details, currentHealthStatus, type, cause|
|Azure SQL|Recent Service Health Incidents|Logs|Installed Apps/Azure SQL/Azure SQL - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} ServiceHealth <br />\| JSON "category", "operationName", "time","level","resultType", "properties.incidentType", "properties.service", "properties.region", "properties.impactStartTime", "properties.impactMitigationTime", "properties.defaultLanguageTitle", "properties.stage" as category, operationName, time,level,resultType, incidentType, service, service\_region, impactStartTime, impactMitigationTime, defaultLanguageTitle, stage nodrop<br />\| replace(toLowerCase(service\_region), " ", "") as service\_region<br />\| where category="ServiceHealth" and (toUpperCase(service) matches /SQL/  OR toUpperCase(service) matches /DATABASE/) <br />\| parse field=operationName "\*/\*/\*" as category, operation\_name, action nodrop<br />\| count as Count by time , level, service, resultType, operation\_name, impactStartTime, impactMitigationTime, defaultLanguageTitle, stage|
|Azure SQL|Recent Write Operations|Logs|Installed Apps/Azure SQL/Azure SQL -  Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']"  as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, identity\_claims\_name, authmethods nodrop<br />\| where resultType="Accept" and category="Administrative" and  if ("{{database\_name}}" = "\*", true, service\_name matches "{{database\_name}}") and toUppercase(operationName) matches /WRITE/<br />\| if (idtyp =="user", name, appid) as name<br />\| resource\_name as logicalServerName<br />\| service\_name as databaseName<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, logicalServerName, databaseName, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure SQL|Recommendations by Impact|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "recommendationResourceLink" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink nodrop<br />\| where category="Recommendation" <br />\| count by recommendationImpact<br />\| sort by \_count|
|Azure SQL|Resource Health by  Status|Logs|Installed Apps/Azure SQL/Azure SQL - Health|tenant\_name={{tenant\_name}}<br />provider\_name={{provider\_name}}<br />resource\_type={{resource\_type}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}} ResourceHealth <br />\| JSON "category", "properties.currentHealthStatus" as category, currentHealthStatus<br />\| where category="ResourceHealth"<br />\| count as Count by currentHealthStatus|
|Azure SQL|Rows Returned by Query|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(rowCount) as rowcount by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Rows Returned by Query|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "query\_hash", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "count\_executions", "duration", "rowcount" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(rowCount) as rowcount by \_timeslice, query\_hash<br />\| transpose row \_timeslice column query\_hash|
|Azure SQL|Service Health by Incident Type|Logs|Installed Apps/Azure SQL/Azure SQL - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} ServiceHealth<br />\| JSON "category", "properties.incidentType", "properties.service", "properties.region" as category, incidentType, service, service\_region<br />\| replace(toLowerCase(service\_region), " ", "") as service\_region<br />\| where category="ServiceHealth" and (toUpperCase(service) matches /SQL/  OR toUpperCase(service) matches /DATABASE/)<br />\| count by incidentType<br />\| order by incidentType|
|Azure SQL|Service Health by Incident Type|Logs|Installed Apps/Azure SQL/Azure SQL - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} ServiceHealth <br />\| JSON "category", "properties.incidentType", "properties.service", "properties.region" as category, incidentType, service, service\_region<br />\| replace(toLowerCase(service\_region), " ", "") as service\_region<br />\| where category="ServiceHealth" and (toUpperCase(service) matches /SQL/  OR toUpperCase(service) matches /DATABASE/) <br />\| count as Count by incidentType|
|Azure SQL|Sessions Percent Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=sessions\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Sessions Percent Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=sessions\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Storage Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=storage statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Storage Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=storage statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Storage Percent Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=storage\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Storage Percent Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=storage\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Successful  Logins|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name" as logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") AND action="DATABASE AUTHENTICATION SUCCEEDED"<br />\| count|
|Azure SQL|Successful Connection|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=connection\_successful statistic=count \| sum|
|Azure SQL|Successful Connection|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=connection\_successful statistic=count \| sum|
|Azure SQL|Successful Connection Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=connection\_successful statistic=total resourceId=\* \| sum by resourceId |
|Azure SQL|Successful Connection Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=connection\_successful statistic=total resourceId=\* \| sum by resourceId |
|Azure SQL|Timeouts|Logs|Installed Apps/Azure SQL/Azure SQL - Timeouts|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  TimeoutEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "error\_state"<br />\| where operationName="TimeoutEvent" and if ("{{error\_state}}" = "\*", true, error\_state matches "{{error\_state}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount|
|Azure SQL|Timeouts|Logs|Azure SQL/Azure SQL - Timeouts|\_sourceCategory={{Logsdatasource}}  TimeoutEvent "\\"operationName\\":\\"TimeoutEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "error\_state"<br />\| where operationName="TimeoutEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{error\_state}}" = "\*", true, error\_state matches "{{error\_state}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount|
|Azure SQL|Timeouts by Database|Logs|Installed Apps/Azure SQL/Azure SQL - Timeouts|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  TimeoutEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "error\_state"<br />\| where operationName="TimeoutEvent" and if ("{{error\_state}}" = "\*", true, error\_state matches "{{error\_state}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by DatabaseName<br />\| top 10 DatabaseName by eventCount, DatabaseName asc|
|Azure SQL|Timeouts by Database|Logs|Azure SQL/Azure SQL - Timeouts|\_sourceCategory={{Logsdatasource}}  TimeoutEvent "\\"operationName\\":\\"TimeoutEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "error\_state"<br />\| where operationName="TimeoutEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{error\_state}}" = "\*", true, error\_state matches "{{error\_state}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by DatabaseName<br />\| top 10 DatabaseName by eventCount, DatabaseName asc|
|Azure SQL|Timeouts Details|Logs|Azure SQL/Azure SQL - Timeouts|\_sourceCategory={{Logsdatasource}}  TimeoutEvent "\\"operationName\\":\\"TimeoutEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "error\_state"<br />\| where operationName="TimeoutEvent"<br />\| timeslice 1s<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{error\_state}}" = "\*", true, error\_state matches "{{error\_state}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, error\_state, ResourceGroup<br />\| sort by \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, error\_state, ResourceGroup|
|Azure SQL|Timeouts Details|Logs|Installed Apps/Azure SQL/Azure SQL - Timeouts|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  TimeoutEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "error\_state"<br />\| where operationName="TimeoutEvent" and if ("{{error\_state}}" = "\*", true, error\_state matches "{{error\_state}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\| timeslice 1s<br />\|count as eventCount by \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, error\_state, ResourceGroup<br />\| sort by \_timeslice, LogicalServerName, DatabaseName, ElasticPoolName, error\_state, ResourceGroup|
|Azure SQL|Top 10 Active Logical Server Names|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName)<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by LogicalServerName<br />\| top 10 LogicalServerName by eventCount, LogicalServerName|
|Azure SQL|Top 10 Active Logical Server Names|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName)<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by LogicalServerName<br />\| top 10 LogicalServerName by eventCount, LogicalServerName|
|Azure SQL|Top 10 Active Resource Groups|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(ResourceGroup)<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by ResourceGroup<br />\| top 10 ResourceGroup by eventCount, ResourceGroup|
|Azure SQL|Top 10 Active Resource Groups|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(ResourceGroup)<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by ResourceGroup<br />\| top 10 ResourceGroup by eventCount, ResourceGroup|
|Azure SQL|Top 10 Active ResourceId|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by resourceId<br />\| top 10 resourceId by eventCount, resourceId asc|
|Azure SQL|Top 10 Active ResourceId|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by resourceId<br />\| top 10 resourceId by eventCount, resourceId asc|
|Azure SQL|Top 10 Active Server, Database and Elastic Pool|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !(isEmpty(LogicalServerName) and isEmpty(DatabaseName) and isEmpty(ElasticPoolName))<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by LogicalServerName, DatabaseName, ElasticPoolName<br />\| top 10 LogicalServerName, DatabaseName, ElasticPoolName by eventCount, LogicalServerName, DatabaseName, ElasticPoolName|
|Azure SQL|Top 10 Active Server, Database and Elastic Pool|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !(isEmpty(LogicalServerName) and isEmpty(DatabaseName) and isEmpty(ElasticPoolName))<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by LogicalServerName, DatabaseName, ElasticPoolName<br />\| top 10 LogicalServerName, DatabaseName, ElasticPoolName by eventCount, LogicalServerName, DatabaseName, ElasticPoolName|
|Azure SQL|Top 10 Active Server, Databases|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !(isEmpty(LogicalServerName) and isEmpty(DatabaseName))<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by LogicalServerName, DatabaseName<br />\| top 10 LogicalServerName, DatabaseName by eventCount, LogicalServerName asc, DatabaseName asc|
|Azure SQL|Top 10 Active Server, Databases|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !(isEmpty(LogicalServerName) and isEmpty(DatabaseName))<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by LogicalServerName, DatabaseName<br />\| top 10 LogicalServerName, DatabaseName by eventCount, LogicalServerName asc, DatabaseName asc|
|Azure SQL|Top 10 Active SubscriptionId|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(SubscriptionId)<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by SubscriptionId<br />\| top 10 SubscriptionId by eventCount, SubscriptionId|
|Azure SQL|Top 10 Active SubscriptionId|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(SubscriptionId)<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by SubscriptionId<br />\| top 10 SubscriptionId by eventCount, SubscriptionId|
|Azure SQL|Top 10 Categories|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by category<br />\| top 10 category by eventCount, category|
|Azure SQL|Top 10 Categories|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by category<br />\| top 10 category by eventCount, category|
|Azure SQL|Top 10 Error Messages|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by message<br />\| top 10 message by eventCount, message asc|
|Azure SQL|Top 10 Error Messages|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by message<br />\| top 10 message by eventCount, message asc|
|Azure SQL|Top 10 Error States|Logs|Installed Apps/Azure SQL/Azure SQL - Timeouts|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  TimeoutEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "error\_state"<br />\| where operationName="TimeoutEvent" and if ("{{error\_state}}" = "\*", true, error\_state matches "{{error\_state}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by error\_state<br />\| top 10 error\_state by eventCount, error\_state asc|
|Azure SQL|Top 10 Error States|Logs|Azure SQL/Azure SQL - Timeouts|\_sourceCategory={{Logsdatasource}}  TimeoutEvent "\\"operationName\\":\\"TimeoutEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "error\_state"<br />\| where operationName="TimeoutEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{error\_state}}" = "\*", true, error\_state matches "{{error\_state}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by error\_state<br />\| top 10 error\_state by eventCount, error\_state asc|
|Azure SQL|Top 10 Errors|Logs|Azure SQL/Azure SQL - Errors|\_sourceCategory={{Logsdatasource}}  ErrorEvent "\\"operationName\\":\\"ErrorEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{message}}" = "\*", true, message matches "{{message}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by error\_number<br />\| top 10 error\_number by eventCount, error\_number asc|
|Azure SQL|Top 10 Errors|Logs|Installed Apps/Azure SQL/Azure SQL - Errors|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  ErrorEvent <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "severity", "error\_number", "DatabaseName", "message", "user\_defined", "state"<br />\| where operationName="ErrorEvent"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{message}}" = "\*", true, message matches "{{message}}")  AND if ("{{error\_number}}" = "\*", true, error\_number matches "{{error\_number}}") AND if ("{{state}}" = "\*", true, state matches "{{state}}")  AND if ("{{user\_defined}}" = "\*", true, user\_defined matches "{{user\_defined}}") AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by error\_number<br />\| top 10 error\_number by eventCount, error\_number asc|
|Azure SQL|Top 10 host names|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name" as logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\| count by host\_name<br />\| top 10 host\_name by \_count<br />|
|Azure SQL|Top 10 Operations|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by operationName<br />\| top 10 operationName by eventCount, operationName|
|Azure SQL|Top 10 Operations|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}} <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "status", "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by operationName<br />\| top 10 operationName by eventCount, operationName|
|Azure SQL|Top 10 operations that caused the most errors|Logs|Installed Apps/Azure SQL/Azure SQL -  Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}   provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| json "resultType", "operationName", "properties.statusMessage", "category"  as resultType, operationName, failureMessage, category<br />\| where category="Administrative" and resultType="Failure" and if ("{{database\_name}}" = "\*", true, service\_name matches "{{database\_name}}")<br />\| resource\_name as logicalServerName<br />\| service\_name as databaseName<br />\| count as Count by logicalServerName, databaseName, operationname, failureMessage<br />\| order by Count <br />\| limit 10|
|Azure SQL|Top 10 Server, Database and WaitType|Logs|Installed Apps/Azure SQL/Azure SQL - Overview|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  wait\_type<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "DatabaseName", "ElasticPoolName", "wait\_type"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by LogicalServerName, DatabaseName, wait\_type<br />\| top 10 LogicalServerName, DatabaseName, wait\_type by eventCount, LogicalServerName, DatabaseName, wait\_type|
|Azure SQL|Top 10 Server, Database and WaitType|Logs|Azure SQL/Azure SQL - Overview|\_sourceCategory={{Logsdatasource}}  wait\_type<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "DatabaseName", "ElasticPoolName", "wait\_type"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by LogicalServerName, DatabaseName, wait\_type<br />\| top 10 LogicalServerName, DatabaseName, wait\_type by eventCount, LogicalServerName, DatabaseName, wait\_type|
|Azure SQL|Top 10 Service Principals|Logs|Installed Apps/Azure SQL/Azure SQL - SQL Security Audit|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS"  SQLSecurityAuditEvents<br />\| json "LogicalServerName", "category", "operationName", "properties.database\_name", "properties.action\_name", "properties.client\_ip", "properties.client\_tls\_version","properties.host\_name", "properties.session\_server\_principal\_name", "properties.object\_name", "properties.application\_name" as logicalservername,category,operationName, databaseName, action, client\_ip, client\_tls\_version, host\_name, session\_server\_principal\_name, object\_name, application\_name nodrop<br />\| parse field=resourceId "MANAGEDINSTANCES/\*/DATABASES/\*/" as MANAGEDINSTANCES, databaseName3 nodrop<br />\| if (isEmpty(DatabaseName), databaseName3, DatabaseName) as DatabaseName<br />\| if (isEmpty(LogicalServerName), MANAGEDINSTANCES, LogicalServerName) as LogicalServerName<br />\| where !isEmpty(LogicalServerName) and category="SQLSecurityAuditEvents"   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\| count by session\_server\_principal\_name<br />\| top 10 session\_server\_principal\_name by \_count<br />|
|Azure SQL|Top Queries by High Execution Time|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "query\_hash", "count\_executions", "duration", "cpu\_time", "query\_max\_used\_memory", "rowcount" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|avg(duration) as avg\_duration\_microSec, sum(count\_executions) as count\_executions, avg(cpu\_time) as avg\_cpu\_time\_microSec, avg(query\_max\_used\_memory) as avg\_memory\_used\_KB, avg(rowCount) as avg\_rows\_Returned by query\_hash, query\_id, plan\_id<br />\| top 15 query\_hash, query\_id, plan\_id by avg\_duration\_microSec, count\_executions, avg\_cpu\_time\_microSec, avg\_memory\_used\_KB, avg\_rows\_Returned|
|Azure SQL|Top Queries by High Execution Time|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "query\_hash", "count\_executions", "duration", "cpu\_time", "query\_max\_used\_memory", "rowcount" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|avg(duration) as avg\_duration\_microSec, sum(count\_executions) as count\_executions, avg(cpu\_time) as avg\_cpu\_time\_microSec, avg(query\_max\_used\_memory) as avg\_memory\_used\_KB, avg(rowCount) as avg\_rows\_Returned by query\_hash, query\_id, plan\_id<br />\| top 15 query\_hash, query\_id, plan\_id by avg\_duration\_microSec, count\_executions, avg\_cpu\_time\_microSec, avg\_memory\_used\_KB, avg\_rows\_Returned|
|Azure SQL|Total recommendations|Logs|Installed Apps/Azure SQL/Azure SQL - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "recommendationResourceLink" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink nodrop<br />\| where category="Recommendation" <br />\| count|
|Azure SQL|Total Wait Time for Query by Wait Category|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreWaitStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName", "query\_hash", "total\_query\_wait\_time\_ms"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| if (exec\_type == "0", "Regular", if (exec\_type == "3", "Aborted",if (exec\_type == "4", "Exception", exec\_type))) as exec\_type<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}")  AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|sum(total\_query\_wait\_time\_ms) by query\_hash, wait\_category<br />\| transpose row query\_hash column wait\_category|
|Azure SQL|Total Wait Time for Query by Wait Category|Logs|Azure SQL/Azure SQL - QueryStoreWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreWaitStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName", "query\_hash", "total\_query\_wait\_time\_ms"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| if (exec\_type == "0", "Regular", if (exec\_type == "3", "Aborted",if (exec\_type == "4", "Exception", exec\_type))) as exec\_type<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|sum(total\_query\_wait\_time\_ms) by query\_hash, wait\_category<br />\| transpose row query\_hash column wait\_category|
|Azure SQL|Tuning Events by OperationName|Logs|Installed Apps/Azure SQL/Azure SQL - Automatic Tuning|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} AutomaticTuning <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties  "DatabaseName", "ElasticPoolName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\|where  if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND  if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") and category="AutomaticTuning"<br />\| count by operationName<br />|
|Azure SQL|Tuning Events by Type|Logs|Installed Apps/Azure SQL/Azure SQL - Automatic Tuning|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}} AutomaticTuning <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties  "DatabaseName", "ElasticPoolName", "OptionName" nodrop<br />\| json field=properties "databaseName" as databaseName2 nodrop<br />\| concat (DatabaseName, databaseName2) as DatabaseName<br />\|where  if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND  if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}") and category="AutomaticTuning"<br />\| count by OptionName<br />|
|Azure SQL|Unique Issues|Logs|Installed Apps/Azure SQL/Azure SQL - SQLInsights|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  SQLInsights <br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}")  AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count\_distinct(issueId) as %"Issues"|
|Azure SQL|Unique Issues|Logs|Azure SQL/Azure SQL - SQLInsights|\_sourceCategory={{Logsdatasource}}  SQLInsights "\\"operationName\\":\\"Insight\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "issueId", "ElasticPoolName", "databaseName", "status", "metric", "rootCauseAnalysis", "value", "impact", "detections"<br />\| where operationName="Insight"<br />\|where if ("{{value}}" = "\*", true, value matches "{{value}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{rootcauseanalysis}}" = "\*", true, rootcauseanalysis matches "{{rootcauseanalysis}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{metric}}" = "\*", true, metric matches "{{metric}}") AND if ("{{issueid}}" = "\*", true, issueid matches "{{issueid}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count\_distinct(issueId) as %"Issues"|
|Azure SQL|Unique PlanId's|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "query\_hash", "count\_executions" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count\_distinct(plan\_id) as %"UniquePlanIds"|
|Azure SQL|Unique PlanId's|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "query\_hash", "count\_executions" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count\_distinct(plan\_id) as %"UniquePlanIds"|
|Azure SQL|Unique QueryId's|Logs|Azure SQL/Azure SQL - QueryStoreRuntime Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreRuntimeStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "query\_hash", "count\_executions" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count\_distinct(query\_id) as %"UniqueQueryIds"|
|Azure SQL|Unique QueryId's|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreRuntime Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreRuntimeStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "query\_id", "plan\_id", "ElasticPoolName", "DatabaseName", "max\_cpu\_time", "max\_duration", "query\_hash", "count\_executions" nodrop<br />\| where operationName = "QueryStoreRuntimeStatisticsEvent"<br />\|where if ("{{plan\_id}}" = "\*", true, plan\_id matches "{{plan\_id}}") AND if ("{{query\_hash}}" = "\*", true, query\_hash matches "{{query\_hash}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")  AND if ("{{query\_id}}" = "\*", true, query\_id matches "{{query\_id}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count\_distinct(query\_id) as %"UniqueQueryIds"|
|Azure SQL|Users / Applications by Operation type|Logs|Installed Apps/Azure SQL/Azure SQL -  Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid nodrop<br />\| where resultType="Accept" and category="Administrative" and  if ("{{database\_name}}" = "\*", true, service\_name matches "{{database\_name}}")<br />\| if (idtyp =="user", name, appid) as name<br />\| "Others" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by name, operationType<br />\| transpose row name column operationType|
|Azure SQL|Wait Category|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreWaitStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| concat(LogicalServerName, ":", DatabaseName) as Server\_DatabaseName<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}")  AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by Server\_DatabaseName<br />\| sort by  eventCount, Server\_DatabaseName asc|
|Azure SQL|Wait Category|Logs|Azure SQL/Azure SQL - QueryStoreWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreWaitStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| concat(LogicalServerName, ":", DatabaseName) as Server\_DatabaseName<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by Server\_DatabaseName<br />\| sort by  eventCount, Server\_DatabaseName asc|
|Azure SQL|Wait Category Breakup|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreWaitStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| concat(LogicalServerName, ":", DatabaseName) as Server\_DatabaseName<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}")  AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by Server\_DatabaseName, wait\_Category<br />\| transpose row Server\_DatabaseName column wait\_Category|
|Azure SQL|Wait Category Breakup|Logs|Azure SQL/Azure SQL - QueryStoreWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreWaitStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| concat(LogicalServerName, ":", DatabaseName) as Server\_DatabaseName<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by Server\_DatabaseName, wait\_Category<br />\| transpose row Server\_DatabaseName column wait\_Category|
|Azure SQL|Wait Category Trend|Logs|Azure SQL/Azure SQL - QueryStoreWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreWaitStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice, wait\_category<br />\| transpose row \_timeslice column wait\_category|
|Azure SQL|Wait Category Trend|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreWaitStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| timeslice 1h<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}")  AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by \_timeslice, wait\_category<br />\| transpose row \_timeslice column wait\_category|
|Azure SQL|Wait Details|Logs|Installed Apps/Azure SQL/Azure SQL - QueryStoreWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  QueryStoreWaitStatisticsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| if (exec\_type == "0", "Regular", if (exec\_type == "3", "Aborted",if (exec\_type == "4", "Exception", exec\_type))) as exec\_type<br />\|where   if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}")  AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}")  AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by LogicalServerName, DatabaseName, ElasticPoolName, statement\_type, exec\_type, is\_parameterizable, query\_param\_type, wait\_category<br />\| sort by eventCount, wait\_category asc, LogicalServerName, DatabaseName, statement\_type, exec\_type, is\_parameterizable, query\_param\_type, ElasticPoolName|
|Azure SQL|Wait Details|Logs|Azure SQL/Azure SQL - QueryStoreWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"QueryStoreWaitStatisticsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "exec\_type", "statement\_type", "is\_parameterizable", "query\_param\_type", "wait\_category", "ElasticPoolName", "DatabaseName"<br />\| where operationName = "QueryStoreWaitStatisticsEvent"<br />\| if (exec\_type == "0", "Regular", if (exec\_type == "3", "Aborted",if (exec\_type == "4", "Exception", exec\_type))) as exec\_type<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{exec\_type}}" = "\*", true, exec\_type matches "{{exec\_type}}") AND if ("{{statement\_type}}" = "\*", true, statement\_type matches "{{statement\_type}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{wait\_category}}" = "\*", true, wait\_category matches "{{wait\_category}}") AND if ("{{query\_param\_type}}" = "\*", true, query\_param\_type matches "{{query\_param\_type}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{is\_parameterizable}}" = "\*", true, is\_parameterizable matches "{{is\_parameterizable}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by LogicalServerName, DatabaseName, ElasticPoolName, statement\_type, exec\_type, is\_parameterizable, query\_param\_type, wait\_category<br />\| sort by eventCount, wait\_category asc, LogicalServerName, DatabaseName, statement\_type, exec\_type, is\_parameterizable, query\_param\_type, ElasticPoolName|
|Azure SQL|Wait Events Breakdown by Database|Logs|Azure SQL/Azure SQL - DatabaseWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"DatabaseWaitStatistcsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\| concat(LogicalServerName, ":", DatabaseName) as Server\_DatabaseName<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by Server\_DatabaseName, wait\_type<br />\| transpose row Server\_DatabaseName column wait\_type|
|Azure SQL|Wait Events Breakdown by Database|Logs|Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  DatabaseWaitStatistcsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\| concat(LogicalServerName, ":", DatabaseName) as Server\_DatabaseName<br />\|where if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by Server\_DatabaseName, wait\_type<br />\| transpose row Server\_DatabaseName column wait\_type|
|Azure SQL|Wait Events by Database|Logs|Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  DatabaseWaitStatistcsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\| concat(LogicalServerName, ":", DatabaseName) as Server\_DatabaseName<br />\|where if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by Server\_DatabaseName<br />\| sort by  eventCount, Server\_DatabaseName asc|
|Azure SQL|Wait Events by Database|Logs|Azure SQL/Azure SQL - DatabaseWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"DatabaseWaitStatistcsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\| concat(LogicalServerName, ":", DatabaseName) as Server\_DatabaseName<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by Server\_DatabaseName<br />\| sort by  eventCount, Server\_DatabaseName asc|
|Azure SQL|Wait Type Trend|Logs|Installed Apps/Azure SQL/Azure SQL - DatabaseWait Stats|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  DatabaseWaitStatistcsEvent<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\| timeslice 1h<br />\|where if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}")  AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}")   AND if ("{{database\_name}}" = "\*", true, toLowerCase(databasename) matches "{{database\_name}}")<br />\|count as eventCount by \_timeslice, wait\_type<br />\| transpose row \_timeslice column wait\_type|
|Azure SQL|Wait Type Trend|Logs|Azure SQL/Azure SQL - DatabaseWait Stats|\_sourceCategory={{Logsdatasource}}  "\\"operationName\\":\\"DatabaseWaitStatistcsEvent\\""<br />\| json "LogicalServerName", "SubscriptionId", "ResourceGroup", "resourceId", "category", "operationName", "properties" nodrop<br />\| json field=properties "ElasticPoolName", "DatabaseName", "wait\_type", "delta\_max\_wait\_time\_ms", "delta\_signal\_wait\_time\_ms", "delta\_wait\_time\_ms", "delta\_waiting\_tasks\_count"  nodrop<br />\| where operationName = "DatabaseWaitStatistcsEvent"<br />\| timeslice 1h<br />\|where if ("{{resourceid}}" = "\*", true, resourceid matches "{{resourceid}}") AND if ("{{wait\_type}}" = "\*", true, wait\_type matches "{{wait\_type}}") AND if ("{{subscriptionid}}" = "\*", true, subscriptionid matches "{{subscriptionid}}") AND if ("{{operationname}}" = "\*", true, operationname matches "{{operationname}}") AND if ("{{elasticpoolname}}" = "\*", true, elasticpoolname matches "{{elasticpoolname}}") AND if ("{{logicalservername}}" = "\*", true, logicalservername matches "{{logicalservername}}") AND if ("{{resourcegroup}}" = "\*", true, resourcegroup matches "{{resourcegroup}}") AND if ("{{category}}" = "\*", true, category matches "{{category}}") AND if ("{{databasename}}" = "\*", true, databasename matches "{{databasename}}")<br />\|count as eventCount by \_timeslice, wait\_type<br />\| transpose row \_timeslice column wait\_type|
|Azure SQL|Workers Percent Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=workers\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|Workers Percent Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=workers\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|XPT Storage Percent Per Database|Metrics|Installed Apps/Azure SQL/Azure SQL - Metrics|tenant\_name={{tenant\_name}} location={{location}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.SQL" resource\_type="SERVERS" resource\_name={{resource\_name}}  service\_name={{database\_name}} metric=xtp\_storage\_percent statistic=average resourceId=\* \| avg by resourceId |
|Azure SQL|XPT Storage Percent Per Database|Metrics|Azure SQL/Azure SQL - Metrics|\_sourceCategory={{Metricsdatasource}}  metric=xtp\_storage\_percent statistic=average resourceId=\* \| avg by resourceId |

