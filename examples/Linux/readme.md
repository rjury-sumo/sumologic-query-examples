# Linux
## Sumo Logic App For: Linux
The Sumo Logic app for Linux allows you to view information about events, logins, and the security status of your Linux system. The app consists of predefined searches and dashboards that provide visibility into your environment for real-time or historical analysis.
Docs Link: [Linux](https://help.sumologic.com/?cid=5216)

## Searches

### Log Searches

- **All Failed Authentication Attempts**: from Search: Installed Apps/Linux/User Logins/All Failed Authentication Attempts 
- **All Failed Authentication Attempts**: from Search: Linux/User Logins/All Failed Authentication Attempts 
- **Event Count by Host and Service**: from Dashboard: Linux/Linux - Event Sources 
- **Event Count by Host and Service**: from Dashboard: Installed Apps/Linux/Linux - Event Sources 
- **Event Count per Host by Hour**: from Dashboard: Linux/Linux - Event Sources 
- **Event Count per Host by Hour**: from Dashboard: Installed Apps/Linux/Linux - Event Sources 
- **Existing User Assignments**: from Dashboard: Installed Apps/Linux/Linux - Security Status 
- **Existing User Assignments**: from Dashboard: Linux/Linux - Security Status 
- **Existing Users Added to Privileged Group**: from Search: Linux/Privilege Assignments/Existing Users Added to Privileged Group 
- **Existing Users Added to Privileged Group**: from Search: Installed Apps/Linux/Privilege Assignments/Existing Users Added to Privileged Group 
- **Failed Local Logins**: from Search: Linux/User Logins/Failed Local Logins 
- **Failed Local Logins**: from Search: Installed Apps/Linux/User Logins/Failed Local Logins 
- **Failed Logins**: from Search: Linux/User Logins/Failed Logins 
- **Failed Logins**: from Search: Installed Apps/Linux/User Logins/Failed Logins 
- **Failed Logins per Host by Hour**: from Dashboard: Installed Apps/Linux/Linux - Login Status 
- **Failed Logins per Host by Hour**: from Dashboard: Linux/Linux - Login Status 
- **Failed Password Changes**: from Search: Linux/Password Changes/Failed Password Changes 
- **Failed Password Changes**: from Search: Installed Apps/Linux/Password Changes/Failed Password Changes 
- **Failed Remote Logins**: from Search: Installed Apps/Linux/User Logins/Failed Remote Logins 
- **Failed Remote Logins**: from Search: Linux/User Logins/Failed Remote Logins 
- **Failed SU Attempts**: from Search: Linux/User Logins/Failed SU Attempts 
- **Failed SU Attempts**: from Dashboard: Linux/Linux - Security Status 
- **Failed SU Attempts**: from Search: Installed Apps/Linux/User Logins/Failed SU Attempts 
- **Failed SU Attempts**: from Dashboard: Installed Apps/Linux/Linux - Security Status 
- **Group Removal**: from Search: Linux/Privilege Assignments/Group Removal 
- **Group Removal**: from Search: Installed Apps/Linux/Privilege Assignments/Group Removal 
- **Logins by Hour**: from Dashboard: Linux/Linux - Login Status 
- **Logins by Hour**: from Search: Linux/User Logins/Logins by Hour 
- **Logins by Hour**: from Dashboard: Installed Apps/Linux/Linux - Login Status 
- **Logins by Hour**: from Search: Installed Apps/Linux/User Logins/Logins by Hour 
- **Logins by Outcome**: from Dashboard: Installed Apps/Linux/Linux - Overview 
- **Logins by Outcome**: from Dashboard: Linux/Linux - Overview 
- **New Group Creation**: from Search: Linux/Privilege Assignments/New Group Creation 
- **New Group Creation**: from Search: Installed Apps/Linux/Privilege Assignments/New Group Creation 
- **New User Added to Privileged Group**: from Search: Installed Apps/Linux/Privilege Assignments/New User Added to Privileged Group 
- **New User Added to Privileged Group**: from Search: Linux/Privilege Assignments/New User Added to Privileged Group 
- **New User Assignments**: from Dashboard: Installed Apps/Linux/Linux - Security Status 
- **New User Assignments**: from Dashboard: Linux/Linux - Security Status 
- **New User Creation**: from Search: Linux/Privilege Assignments/New User Creation 
- **New User Creation**: from Search: Installed Apps/Linux/Privilege Assignments/New User Creation 
- **Package Operations**: from Search: Installed Apps/Linux/System Events/Package Operations 
- **Package Operations**: from Dashboard: Linux/Linux - Security Status 
- **Package Operations**: from Dashboard: Installed Apps/Linux/Linux - Security Status 
- **Package Operations**: from Search: Linux/System Events/Package Operations 
- **Remote Logins**: from Search: Installed Apps/Linux/User Logins/Remote Logins 
- **Remote Logins**: from Search: Linux/User Logins/Remote Logins 
- **Reporting Hosts**: from Dashboard: Installed Apps/Linux/Linux - Overview 
- **Reporting Hosts**: from Dashboard: Linux/Linux - Overview 
- **Reporting Hosts by Hour**: from Dashboard: Installed Apps/Linux/Linux - Event Sources 
- **Reporting Hosts by Hour**: from Dashboard: Linux/Linux - Event Sources 
- **Root Activity**: from Search: Installed Apps/Linux/Root Activity/Root Activity 
- **Root Activity**: from Search: Linux/Root Activity 
- **Root Login**: from Search: Installed Apps/Linux/Root Activity/Root Login 
- **Root Login**: from Search: Linux/Root Activity/Root Login 
- **Service Shutdown or Exiting**: from Search: Installed Apps/Linux/System Events/Service Shutdown or Exiting 
- **Service Shutdown or Exiting**: from Search: Linux/System Events/Service Shutdown or Exiting 
- **Successful Local Logins**: from Search: Linux/User Logins/Successful Local Logins 
- **Successful Local Logins**: from Search: Installed Apps/Linux/User Logins/Successful Local Logins 
- **Successful Password Changes**: from Search: Linux/Password Changes/Successful Password Changes 
- **Successful Password Changes**: from Search: Installed Apps/Linux/Password Changes/Successful Password Changes 
- **Successful Remote Login Events**: from Search: Installed Apps/Linux/User Logins/Successful Remote Login Events 
- **Successful Remote Login Events**: from Search: Linux/User Logins/Successful Remote Login Events 
- **Sudo Attempt**: from Search: Linux/Root Activity/Sudo Attempt 
- **Sudo Attempt**: from Search: Installed Apps/Linux/Root Activity/Sudo Attempt 
- **Sudo Attempts**: from Dashboard: Linux/Linux - Overview 
- **Sudo Attempts**: from Dashboard: Linux/Linux - Security Status 
- **Sudo Attempts**: from Dashboard: Installed Apps/Linux/Linux - Security Status 
- **Sudo Attempts**: from Dashboard: Installed Apps/Linux/Linux - Overview 
- **System Shutdown**: from Search: Linux/System Events/System Shutdown 
- **System Shutdown**: from Search: Installed Apps/Linux/System Events/System Shutdown 
- **System Start**: from Search: Linux/System Events/System Start 
- **System Start**: from Search: Installed Apps/Linux/System Events/System Start 
- **System Starts**: from Dashboard: Installed Apps/Linux/Linux - Security Status 
- **System Starts**: from Dashboard: Linux/Linux - Security Status 
- **Top 30 Failed Logins**: from Dashboard: Installed Apps/Linux/Linux - Login Status 
- **Top 30 Failed Logins**: from Dashboard: Linux/Linux - Login Status 
- **Top 30 Failed Remote Logins**: from Dashboard: Linux/Linux - Login Status 
- **Top 30 Failed Remote Logins**: from Dashboard: Installed Apps/Linux/Linux - Login Status 
- **Top 30 Successful Remote Logins**: from Dashboard: Installed Apps/Linux/Linux - Login Status 
- **Top 30 Successful Remote Logins**: from Dashboard: Linux/Linux - Login Status 
- **Top 30 Successful User Logins**: from Dashboard: Installed Apps/Linux/Linux - Login Status 
- **Top 30 Successful User Logins**: from Dashboard: Linux/Linux - Login Status 
- **Total Event Distribution**: from Dashboard: Installed Apps/Linux/Linux - Event Sources 
- **Total Event Distribution**: from Dashboard: Linux/Linux - Overview 
- **Total Event Distribution**: from Dashboard: Linux/Linux - Event Sources 
- **Total Event Distribution**: from Dashboard: Installed Apps/Linux/Linux - Overview 
- **User Assignments**: from Dashboard: Linux/Linux - Overview 
- **User Assignments**: from Dashboard: Installed Apps/Linux/Linux - Overview 
- **User Removal**: from Search: Installed Apps/Linux/Privilege Assignments/User Removal 
- **User Removal**: from Search: Linux/Privilege Assignments/User Removal 
- **User Removal From Group**: from Search: Installed Apps/Linux/Privilege Assignments/User Removal From Group 
- **User Removal From Group**: from Search: Linux/Privilege Assignments/User Removal From Group 
- **Users Logging in From Multiple Remote Hosts**: from Search: Installed Apps/Linux/User Logins/Users Logging in From Multiple Remote Hosts 
- **Users Logging in From Multiple Remote Hosts**: from Search: Linux/User Logins/Users Logging in From Multiple Remote Hosts 
- **Users with Multiple Failed Logins**: from Search: Installed Apps/Linux/User Logins/Users with Multiple Failed Logins 
- **Users with Multiple Failed Logins**: from Search: Linux/User Logins/Users with Multiple Failed Logins

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Linux/User Logins|All Failed Authentication Attempts|Logs|Installed Apps/Linux/User Logins/All Failed Authentication Attempts|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| if (!isEmpty(protocol), protocol, if (message matches "sshd[\*", "ssh", protocol)) as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip|
|Linux/User Logins|All Failed Authentication Attempts|Logs|Linux/User Logins/All Failed Authentication Attempts|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| if (!isEmpty(protocol), protocol, if (message matches "sshd[\*", "ssh", protocol)) as protocol<br />\| where dest\_user!=""<br />\| if (src\_user="", dest\_user, src\_user) as src\_user<br />\| if (src\_host=" " or isEmpty(src\_host), \_sourceHost, src\_host) as src\_host \| src\_host as src\_ip|
|Linux|Event Count by Host and Service|Logs|Linux/Linux - Event Sources|\_sourceCategory={{Logsdatasource}} <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w+)(?:\\[\\d+\\]\|):\\s+" <br />\| where process\_name !=""<br />\| dest\_hostname as host<br />\|where if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}")<br />\|count as events by process\_name,host <br />\| transpose row host column process\_name|
|Linux|Event Count by Host and Service|Logs|Installed Apps/Linux/Linux - Event Sources|\_sourceCategory={{Logsdatasource}} <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w+)(?:\\[\\d+\\]\|):\\s+" <br />\| where process\_name !=""<br />\| dest\_hostname as host<br />\|where if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}")<br />\|count as events by process\_name,host <br />\| transpose row host column process\_name|
|Linux|Event Count per Host by Hour|Logs|Linux/Linux - Event Sources|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" <br />\| timeslice 1h<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}")<br />\|count  as Events  by dest\_hostname,\_timeslice\|  sort by -Events <br />\| transpose row \_timeslice column dest\_hostname|
|Linux|Event Count per Host by Hour|Logs|Installed Apps/Linux/Linux - Event Sources|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" <br />\| timeslice 1h<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}")<br />\|count  as Events  by dest\_hostname,\_timeslice\|  sort by -Events <br />\| transpose row \_timeslice column dest\_hostname|
|Linux|Existing User Assignments|Logs|Installed Apps/Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  "to group" or "default group changed" or "change user"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop<br />\| parse "add '\*' to group '\*'" as dest\_user,dest\_group nodrop<br />\| parse "account added to group - account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop<br />\| parse "account=\*, uid=\*, gid=\*, old gid=\*," as dest\_user,dest\_uid, dest\_gid,src\_gid nodrop<br />\| parse "change user '\*' GID from '\*' to '\*'" as dest\_user,src\_gid, dest\_gid<br />\| where dest\_gid in("10","0","4") or dest\_group in ("root", "wheel", "adm")  <br />\| timeslice 1h<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_group}}" = "\*", true, dest\_group matches "{{dest\_group}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by dest\_hostname,\_timeslice \| sort -\_timeslice \| transpose row \_timeslice column dest\_hostname as \*|
|Linux|Existing User Assignments|Logs|Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  "to group" or "default group changed" or "change user"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop<br />\| parse "add '\*' to group '\*'" as dest\_user,dest\_group nodrop<br />\| parse "account added to group - account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop<br />\| parse "account=\*, uid=\*, gid=\*, old gid=\*," as dest\_user,dest\_uid, dest\_gid,src\_gid nodrop<br />\| parse "change user '\*' GID from '\*' to '\*'" as dest\_user,src\_gid, dest\_gid<br />\| where dest\_gid in("10","0","4") or dest\_group in ("root", "wheel", "adm")  <br />\| timeslice 1h<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_group}}" = "\*", true, dest\_group matches "{{dest\_group}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by dest\_hostname,\_timeslice \| sort -\_timeslice \| transpose row \_timeslice column dest\_hostname as \*|
|Linux/Privilege Assignments|Existing Users Added to Privileged Group|Logs|Linux/Privilege Assignments/Existing Users Added to Privileged Group|\_sourceCategory={{Logsdatasource}}  "to group" or "default group changed" or "change user" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "add '\*' to group '\*'" as dest\_user,dest\_group nodrop \| parse "account added to group - account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop <br />\| parse "account=\*, uid=\*, gid=\*, old gid=\*," as dest\_user,dest\_uid, dest\_gid,src\_gid nodrop <br />\| parse "change user '\*' GID from '\*' to '\*'" as dest\_user,src\_gid, dest\_gid <br />\| where dest\_gid in("10","0","4") or dest\_group in ("root", "wheel", "adm")|
|Linux/Privilege Assignments|Existing Users Added to Privileged Group|Logs|Installed Apps/Linux/Privilege Assignments/Existing Users Added to Privileged Group|\_sourceCategory={{Logsdatasource}}  "to group" or "default group changed" or "change user" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "add '\*' to group '\*'" as dest\_user,dest\_group nodrop \| parse "account added to group - account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop <br />\| parse "account=\*, uid=\*, gid=\*, old gid=\*," as dest\_user,dest\_uid, dest\_gid,src\_gid nodrop <br />\| parse "change user '\*' GID from '\*' to '\*'" as dest\_user,src\_gid, dest\_gid <br />\| where dest\_gid in("10","0","4") or dest\_group in ("root", "wheel", "adm")|
|Linux/User Logins|Failed Local Logins|Logs|Linux/User Logins/Failed Local Logins|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") !"ssh" !"sshd"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""|
|Linux/User Logins|Failed Local Logins|Logs|Installed Apps/Linux/User Logins/Failed Local Logins|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") !"ssh" !"sshd"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""|
|Linux/User Logins|Failed Logins|Logs|Linux/User Logins/Failed Logins|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""|
|Linux/User Logins|Failed Logins|Logs|Installed Apps/Linux/User Logins/Failed Logins|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""|
|Linux|Failed Logins per Host by Hour|Logs|Installed Apps/Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| timeslice 1h <br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{src\_tty}}" = "\*", true, src\_tty matches "{{src\_tty}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by dest\_hostname,\_timeslice \| sort by -\_timeslice \| transpose row \_timeslice column dest\_hostname|
|Linux|Failed Logins per Host by Hour|Logs|Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| timeslice 1h <br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{src\_tty}}" = "\*", true, src\_tty matches "{{src\_tty}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by dest\_hostname,\_timeslice \| sort by -\_timeslice \| transpose row \_timeslice column dest\_hostname|
|Linux/Password Changes|Failed Password Changes|Logs|Linux/Password Changes/Failed Password Changes|\_sourceCategory={{Logsdatasource}}  "Authentication failure" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "User \*:" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop <br />\| where process\_name="passwd"|
|Linux/Password Changes|Failed Password Changes|Logs|Installed Apps/Linux/Password Changes/Failed Password Changes|\_sourceCategory={{Logsdatasource}}  "Authentication failure" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "User \*:" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop <br />\| where process\_name="passwd"|
|Linux/User Logins|Failed Remote Logins|Logs|Installed Apps/Linux/User Logins/Failed Remote Logins|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") ("ssh" or "sshd") <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""|
|Linux/User Logins|Failed Remote Logins|Logs|Linux/User Logins/Failed Remote Logins|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") ("ssh" or "sshd") <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""|
|Linux/User Logins|Failed SU Attempts|Logs|Linux/User Logins/Failed SU Attempts|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") ("su:" or "su[")  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse "FAILED su for \* by \*" as dest\_user,src\_user  nodrop <br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!="" and src\_user!=""|
|Linux|Failed SU Attempts|Logs|Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}} ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") ("su:" or "su[")  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse "FAILED su for \* by \*" as dest\_user,src\_user  nodrop <br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!="" and src\_user!=""<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as attempts by dest\_hostname, src\_user, dest\_user \| sort - attempts|
|Linux/User Logins|Failed SU Attempts|Logs|Installed Apps/Linux/User Logins/Failed SU Attempts|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") ("su:" or "su[")  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse "FAILED su for \* by \*" as dest\_user,src\_user  nodrop <br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!="" and src\_user!=""|
|Linux|Failed SU Attempts|Logs|Installed Apps/Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}} ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") ("su:" or "su[")  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse "FAILED su for \* by \*" as dest\_user,src\_user  nodrop <br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!="" and src\_user!=""<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as attempts by dest\_hostname, src\_user, dest\_user \| sort - attempts|
|Linux/Privilege Assignments|Group Removal|Logs|Linux/Privilege Assignments/Group Removal|\_sourceCategory={{Logsdatasource}}  "groupdel" or "removed group" or "group deleted" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "delete user '\*'" as dest\_user nodrop <br />\| parse regex "removed group \\'(?\<dest\_group\>[^ ]\*)\\' owned by \\'(?\<dest\_user\>[^ ]\*)\\'" nodrop <br />\| parse regex "group '(?\<dest\_group\>[^ ]\*)' removed\$" nodrop <br />\| parse "group=\*, gid=\*," as dest\_group,dest\_gid nodrop <br />\| where dest\_group!=""|
|Linux/Privilege Assignments|Group Removal|Logs|Installed Apps/Linux/Privilege Assignments/Group Removal|\_sourceCategory={{Logsdatasource}}  "groupdel" or "removed group" or "group deleted" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "delete user '\*'" as dest\_user nodrop <br />\| parse regex "removed group \\'(?\<dest\_group\>[^ ]\*)\\' owned by \\'(?\<dest\_user\>[^ ]\*)\\'" nodrop <br />\| parse regex "group '(?\<dest\_group\>[^ ]\*)' removed\$" nodrop <br />\| parse "group=\*, gid=\*," as dest\_group,dest\_gid nodrop <br />\| where dest\_group!=""|
|Linux|Logins by Hour|Logs|Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:" ) (("Accepted" and "pam") or "session" or ("to" and "on") or ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")) !"closed"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| if (message matches "\*failure;\*" or message matches "\*FAILED \*" or message matches "\*invalid user\*" or message matches "\*Invalid user\*" or message matches "\*Failed\*", "Failure", "Success") as outcome<br />\| timeslice 1h<br />\|where if ("{{outcome}}" = "\*", true, outcome matches "{{outcome}}") AND if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by outcome, \_timeslice \| transpose row \_timeslice column outcome as %"Success", %"Failure"|
|Linux/User Logins|Logins by Hour|Logs|Linux/User Logins/Logins by Hour|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:" ) (("Accepted" and "pam") or "session" or ("to" and "on") or ("authentication failure" or "FAILED SU") ) !"closed" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop <br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| if (message matches "\*failure;\*" or message matches "\*FAILED \*","Failure","Success") as outcome <br />\| timeslice 1h \|  count by outcome,\_timeslice \| sort -\_timeslice <br />\| transpose row \_timeslice column outcome as %"Success", %"Failure"|
|Linux|Logins by Hour|Logs|Installed Apps/Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:" ) (("Accepted" and "pam") or "session" or ("to" and "on") or ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")) !"closed"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| if (message matches "\*failure;\*" or message matches "\*FAILED \*" or message matches "\*invalid user\*" or message matches "\*Invalid user\*" or message matches "\*Failed\*", "Failure", "Success") as outcome<br />\| timeslice 1h<br />\|where if ("{{outcome}}" = "\*", true, outcome matches "{{outcome}}") AND if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by outcome, \_timeslice \| transpose row \_timeslice column outcome as %"Success", %"Failure"|
|Linux/User Logins|Logins by Hour|Logs|Installed Apps/Linux/User Logins/Logins by Hour|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:" ) (("Accepted" and "pam") or "session" or ("to" and "on") or ("authentication failure" or "FAILED SU") ) !"closed" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop <br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| if (message matches "\*failure;\*" or message matches "\*FAILED \*","Failure","Success") as outcome <br />\| timeslice 1h \|  count by outcome,\_timeslice \| sort -\_timeslice <br />\| transpose row \_timeslice column outcome as %"Success", %"Failure"|
|Linux|Logins by Outcome|Logs|Installed Apps/Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:" ) (("Accepted" and "pam") or "session" or ("to" and "on") or ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")) !"closed"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| if (message matches "\*failure;\*" or message matches "\*FAILED \*" or message matches "\*invalid user\*" or message matches "\*Invalid user\*" or message matches "\*Failed\*", "Failure", "Success") as outcome<br />\|where if ("{{outcome}}" = "\*", true, outcome matches "{{outcome}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by outcome|
|Linux|Logins by Outcome|Logs|Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:" ) (("Accepted" and "pam") or "session" or ("to" and "on") or ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")) !"closed"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?:\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| if (message matches "\*failure;\*" or message matches "\*FAILED \*" or message matches "\*invalid user\*" or message matches "\*Invalid user\*" or message matches "\*Failed\*", "Failure", "Success") as outcome<br />\|where if ("{{outcome}}" = "\*", true, outcome matches "{{outcome}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by outcome|
|Linux/Privilege Assignments|New Group Creation|Logs|Linux/Privilege Assignments/New Group Creation|\_sourceCategory={{Logsdatasource}}  "new group" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "name=\*, GID=\*" as dest\_group,dest\_gid nodrop <br />\| parse "group=\*, gid=\*," as dest\_group,dest\_gid nodrop|
|Linux/Privilege Assignments|New Group Creation|Logs|Installed Apps/Linux/Privilege Assignments/New Group Creation|\_sourceCategory={{Logsdatasource}}  "new group" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "name=\*, GID=\*" as dest\_group,dest\_gid nodrop <br />\| parse "group=\*, gid=\*," as dest\_group,dest\_gid nodrop|
|Linux/Privilege Assignments|New User Added to Privileged Group|Logs|Installed Apps/Linux/Privilege Assignments/New User Added to Privileged Group|\_sourceCategory={{Logsdatasource}}  "useradd" and (("new user") or ("new account")) <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop <br />\| parse "account=\*, uid=\*, gid=\*, home=\*, shell=\*," as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop|
|Linux/Privilege Assignments|New User Added to Privileged Group|Logs|Linux/Privilege Assignments/New User Added to Privileged Group|\_sourceCategory={{Logsdatasource}}  "useradd" and (("new user") or ("new account")) <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop <br />\| parse "account=\*, uid=\*, gid=\*, home=\*, shell=\*," as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop|
|Linux|New User Assignments|Logs|Installed Apps/Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  "useradd" and (("new user") or ("new account"))<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop<br />\| parse "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop<br />\| parse "account=\*, uid=\*, gid=\*, home=\*, shell=\*," as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop <br />\| timeslice 1h<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{shell}}" = "\*", true, shell matches "{{shell}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{home\_dir}}" = "\*", true, home\_dir matches "{{home\_dir}}")<br />\|count by dest\_hostname,\_timeslice \| sort - \_timeslice  \| transpose row \_timeslice column dest\_hostname as \*|
|Linux|New User Assignments|Logs|Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  "useradd" and (("new user") or ("new account"))<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop<br />\| parse "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop<br />\| parse "account=\*, uid=\*, gid=\*, home=\*, shell=\*," as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop <br />\| timeslice 1h<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{shell}}" = "\*", true, shell matches "{{shell}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{home\_dir}}" = "\*", true, home\_dir matches "{{home\_dir}}")<br />\|count by dest\_hostname,\_timeslice \| sort - \_timeslice  \| transpose row \_timeslice column dest\_hostname as \*|
|Linux/Privilege Assignments|New User Creation|Logs|Linux/Privilege Assignments/New User Creation|\_sourceCategory={{Logsdatasource}}  "useradd" and (("new user") or ("new account")) <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop <br />\| parse "account=\*, uid=\*, gid=\*, home=\*, shell=\*," as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop|
|Linux/Privilege Assignments|New User Creation|Logs|Installed Apps/Linux/Privilege Assignments/New User Creation|\_sourceCategory={{Logsdatasource}}  "useradd" and (("new user") or ("new account")) <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop <br />\| parse "account=\*, uid=\*, gid=\*, home=\*, shell=\*," as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop|
|Linux/System Events|Package Operations|Logs|Installed Apps/Linux/System Events/Package Operations|\_sourceCategory={{Logsdatasource}}  ("installed" or "erased" or "remove" or "\<install\>" or "\<uninstall\>") NOT "MTA"<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+status\\s+(?\<action\>installed)\\s+(?\<pkg\_name\>\\S\*)\\s+" nodrop<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+(?\<action\>Installed)\\:\\s+(?:\\d+\\:)?(?\<pkg\_name\>\\S\*)" nodrop<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+(?\<action\>remove)\\s+(?\<pkg\_name\>[^ ]\*)\\s" nodrop<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+(?\<action\>Erased)\\:\\s+(?:\\d+\\:)?(?\<pkg\_name\>\\S\*)" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<action\>\\w\*):\\s(?\<pkg\_name\>[^ ]\*)\\s" nodrop<br />\| parse regex "\<(?\<action\>[a-zA-Z]\*)\>\\s+[^\\(\\)]\*\\(\\d+\\)(?\<pkg\_name\>[^\\(]\*)\\(" nodrop<br />\| if (action in ("Installed","install"), "installed",action) as action<br />\| if (action in ("uninstall","erased","remove", "Erased"), "uninstalled",action) as action<br />\| \_sourceHost as sourceHost<br />\| where action!=""|
|Linux|Package Operations|Logs|Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  ("installed" or "erased" or "remove" or "\<install\>" or "\<uninstall\>") NOT "MTA"<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+status\\s+(?\<action\>installed)\\s+(?\<pkg\_name\>\\S\*)\\s+" nodrop<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+(?\<action\>remove)\\s+(?\<pkg\_name\>[^ ]\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<action\>\\w\*):\\s(?\<pkg\_name\>[^ ]\*)\\s" nodrop<br />\| parse regex "\<(?\<action\>[a-zA-Z]\*)\>\\s+[^\\(\\)]\*\\(\\d+\\)(?\<pkg\_name\>[^\\(]\*)\\(" nodrop<br />\| if (action in ("Installed","install"), "installed",action) as action<br />\| if (action in ("uninstall","erased","remove"), "uninstalled",action) as action<br />\| \_sourceHost as sourceHost<br />\| where action!=""<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by sourceHost,action \| transpose row sourceHost column action as \*|
|Linux|Package Operations|Logs|Installed Apps/Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  ("installed" or "erased" or "remove" or "\<install\>" or "\<uninstall\>") NOT "MTA"<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+status\\s+(?\<action\>installed)\\s+(?\<pkg\_name\>\\S\*)\\s+" nodrop<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+(?\<action\>remove)\\s+(?\<pkg\_name\>[^ ]\*)\\s" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<action\>\\w\*):\\s(?\<pkg\_name\>[^ ]\*)\\s" nodrop<br />\| parse regex "\<(?\<action\>[a-zA-Z]\*)\>\\s+[^\\(\\)]\*\\(\\d+\\)(?\<pkg\_name\>[^\\(]\*)\\(" nodrop<br />\| if (action in ("Installed","install"), "installed",action) as action<br />\| if (action in ("uninstall","erased","remove"), "uninstalled",action) as action<br />\| \_sourceHost as sourceHost<br />\| where action!=""<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by sourceHost,action \| transpose row sourceHost column action as \*|
|Linux/System Events|Package Operations|Logs|Linux/System Events/Package Operations|\_sourceCategory={{Logsdatasource}}  ("installed" or "erased" or "remove" or "\<install\>" or "\<uninstall\>") NOT "MTA"<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+status\\s+(?\<action\>installed)\\s+(?\<pkg\_name\>\\S\*)\\s+" nodrop<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+(?\<action\>Installed)\\:\\s+(?:\\d+\\:)?(?\<pkg\_name\>\\S\*)" nodrop<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+(?\<action\>remove)\\s+(?\<pkg\_name\>[^ ]\*)\\s" nodrop<br />\| parse regex "\\s+\\d+:\\d+:\\d+\\s+(?\<action\>Erased)\\:\\s+(?:\\d+\\:)?(?\<pkg\_name\>\\S\*)" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<action\>\\w\*):\\s(?\<pkg\_name\>[^ ]\*)\\s" nodrop<br />\| parse regex "\<(?\<action\>[a-zA-Z]\*)\>\\s+[^\\(\\)]\*\\(\\d+\\)(?\<pkg\_name\>[^\\(]\*)\\(" nodrop<br />\| if (action in ("Installed","install"), "installed",action) as action<br />\| if (action in ("uninstall","erased","remove", "Erased"), "uninstalled",action) as action<br />\| \_sourceHost as sourceHost<br />\| where action!=""|
|Linux/User Logins|Remote Logins|Logs|Installed Apps/Linux/User Logins/Remote Logins|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop <br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop <br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop <br />\| where dest\_user!="" \| count as Attempts by dest\_user,dest\_hostname|
|Linux/User Logins|Remote Logins|Logs|Linux/User Logins/Remote Logins|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop <br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop <br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop <br />\| where dest\_user!="" \| count as Attempts by dest\_user,dest\_hostname|
|Linux|Reporting Hosts|Logs|Installed Apps/Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+"<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count\_distinct(dest\_hostname) as \_hostCount|
|Linux|Reporting Hosts|Logs|Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+"<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count\_distinct(dest\_hostname) as \_hostCount|
|Linux|Reporting Hosts by Hour|Logs|Installed Apps/Linux/Linux - Event Sources|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" <br />\| timeslice 1h<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}")<br />\|count by dest\_hostname,\_timeslice\| count(dest\_hostname) as Hosts by \_timeslice  \| sort by -\_timeslice|
|Linux|Reporting Hosts by Hour|Logs|Linux/Linux - Event Sources|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" <br />\| timeslice 1h<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}")<br />\|count by dest\_hostname,\_timeslice\| count(dest\_hostname) as Hosts by \_timeslice  \| sort by -\_timeslice|
|Linux/Root Activity|Root Activity|Logs|Installed Apps/Linux/Root Activity/Root Activity|\_sourceCategory={{Logsdatasource}}  ("sudo" or "root" or "su") <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s" nodrop \| extract "sudo:\\s+(?\<src\_user\>[^ ]+?)\\s:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+"  nodrop <br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop <br />\| parse " user \* " as dest\_user nodrop <br />\| parse " user \*" as dest\_user nodrop <br />\| where command !="" or dest\_user in ("root") or src\_user in ("root")|
|Linux|Root Activity|Logs|Linux/Root Activity|\_sourceCategory={{Logsdatasource}}  ("sudo" or "root" or "su") <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s" nodrop \| extract "sudo:\\s+(?\<src\_user\>[^ ]+?)\\s:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+"  nodrop <br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop <br />\| parse " user \* " as dest\_user nodrop <br />\| parse " user \*" as dest\_user nodrop <br />\| where command !="" or dest\_user in ("root") or src\_user in ("root")|
|Linux/Root Activity|Root Login|Logs|Installed Apps/Linux/Root Activity/Root Login|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop <br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop <br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop <br />\| parse "Accepted keyboard-interactive/pam for \* from \* port \* \*" as (dest\_user,src\_hostname,src\_port,protocol) <br />\| where dest\_user in ("root")|
|Linux/Root Activity|Root Login|Logs|Linux/Root Activity/Root Login|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop <br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop <br />\| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop <br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop <br />\| parse "Accepted keyboard-interactive/pam for \* from \* port \* \*" as (dest\_user,src\_hostname,src\_port,protocol) <br />\| where dest\_user in ("root")|
|Linux/System Events|Service Shutdown or Exiting|Logs|Installed Apps/Linux/System Events/Service Shutdown or Exiting|\_sourceCategory={{Logsdatasource}}  ("exiting" or "exited" or "terminating" or "terminated" or "shutting")  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" nodrop<br />\| where process\_name !=""|
|Linux/System Events|Service Shutdown or Exiting|Logs|Linux/System Events/Service Shutdown or Exiting|\_sourceCategory={{Logsdatasource}}  ("exiting" or "exited" or "terminating" or "terminated" or "shutting")  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" nodrop<br />\| where process\_name !=""|
|Linux/User Logins|Successful Local Logins|Logs|Linux/User Logins/Successful Local Logins|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "pam:" or "systemd-logind") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed" !"sshd" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+" nodrop <br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+" nodrop \| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop <br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop <br />\| parse "New session \* of user \*." as sessionNo,dest\_user nodrop <br />\| where dest\_user!=""|
|Linux/User Logins|Successful Local Logins|Logs|Installed Apps/Linux/User Logins/Successful Local Logins|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "pam:" or "systemd-logind") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed" !"sshd" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+" nodrop <br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+" nodrop \| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop <br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop <br />\| parse "New session \* of user \*." as sessionNo,dest\_user nodrop <br />\| where dest\_user!=""|
|Linux/Password Changes|Successful Password Changes|Logs|Linux/Password Changes/Successful Password Changes|\_sourceCategory={{Logsdatasource}}  password changed <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "account=\*, uid=\*," as dest\_user,dest\_uid nodrop <br />\| parse "password changed for \*" as dest\_user nodrop|
|Linux/Password Changes|Successful Password Changes|Logs|Installed Apps/Linux/Password Changes/Successful Password Changes|\_sourceCategory={{Logsdatasource}}  password changed <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "account=\*, uid=\*," as dest\_user,dest\_uid nodrop <br />\| parse "password changed for \*" as dest\_user nodrop|
|Linux/User Logins|Successful Remote Login Events|Logs|Installed Apps/Linux/User Logins/Successful Remote Login Events|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[") "Accepted" ("pam" or "password") !"closed" <br /> \| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+" nodrop <br /> \| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+" nodrop <br /> \| parse "ruser=\* rhost=\* user=\*" as src\_user,src\_hostname, dest\_user nodrop <br /> \| parse "Accepted keyboard-interactive/pam for \* from \* port \* \*" as (dest\_user,src\_hostname,src\_port,protocol) <br /> \| parse "Accepted password for \* from \* port \* \*" as dest\_user,src\_hostname,src\_port,protocol nodrop \| where dest\_user!=""|
|Linux/User Logins|Successful Remote Login Events|Logs|Linux/User Logins/Successful Remote Login Events|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[") "Accepted" ("pam" or "password") !"closed" <br /> \| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+" nodrop <br /> \| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+" nodrop <br /> \| parse "ruser=\* rhost=\* user=\*" as src\_user,src\_hostname, dest\_user nodrop <br /> \| parse "Accepted keyboard-interactive/pam for \* from \* port \* \*" as (dest\_user,src\_hostname,src\_port,protocol) <br /> \| parse "Accepted password for \* from \* port \* \*" as dest\_user,src\_hostname,src\_port,protocol nodrop \| where dest\_user!=""|
|Linux/Root Activity|Sudo Attempt|Logs|Linux/Root Activity/Sudo Attempt|\_sourceCategory={{Logsdatasource}}  "sudo" <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S\*)\\s" nodrop<br />\| \_sourceHost as dest\_host<br />\| parse regex "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop<br />\| parse regex "\\s+(?\<process\>\\w\*): pam\_unix\\(sudo:auth\\): conversation failed" nodrop<br />\| parse "pam\_unix(\*:auth): authentication failure;" as process nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| where process="sudo"|
|Linux/Root Activity|Sudo Attempt|Logs|Installed Apps/Linux/Root Activity/Sudo Attempt|\_sourceCategory={{Logsdatasource}}  "sudo" <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S\*)\\s" nodrop<br />\| \_sourceHost as dest\_host<br />\| parse regex "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop<br />\| parse regex "\\s+(?\<process\>\\w\*): pam\_unix\\(sudo:auth\\): conversation failed" nodrop<br />\| parse "pam\_unix(\*:auth): authentication failure;" as process nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| where process="sudo"|
|Linux|Sudo Attempts|Logs|Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  "sudo" <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S\*)\\s" nodrop<br />\| \_sourceHost as dest\_host<br />\| parse regex "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop<br />\| parse regex "\\s+(?\<process\>\\w\*): pam\_unix\\(sudo:auth\\): conversation failed" nodrop<br />\| parse "pam\_unix(\*:auth): authentication failure;" as process nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| where process="sudo" and command != ""<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{command}}" = "\*", true, command matches "{{command}}")<br />\|count as attempts by dest\_hostname,src\_user,dest\_user, command <br />\| sort - attempts|
|Linux|Sudo Attempts|Logs|Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  "sudo" <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S\*)\\s" nodrop<br />\| \_sourceHost as dest\_host<br />\| parse regex "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop<br />\| parse regex "\\s+(?\<process\>\\w\*): pam\_unix\\(sudo:auth\\): conversation failed" nodrop<br />\| parse "pam\_unix(\*:auth): authentication failure;" as process nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| where process="sudo" and command !=""<br />\| where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{command}}" = "\*", true, command matches "{{command}}")<br />\|count as attempts by dest\_hostname,src\_user,dest\_user, command \| sort - attempts|
|Linux|Sudo Attempts|Logs|Installed Apps/Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  "sudo" <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S\*)\\s" nodrop<br />\| \_sourceHost as dest\_host<br />\| parse regex "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop<br />\| parse regex "\\s+(?\<process\>\\w\*): pam\_unix\\(sudo:auth\\): conversation failed" nodrop<br />\| parse "pam\_unix(\*:auth): authentication failure;" as process nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| where process="sudo" and command !=""<br />\| where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{command}}" = "\*", true, command matches "{{command}}")<br />\|count as attempts by dest\_hostname,src\_user,dest\_user, command \| sort - attempts|
|Linux|Sudo Attempts|Logs|Installed Apps/Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  "sudo" <br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S\*)\\s" nodrop<br />\| \_sourceHost as dest\_host<br />\| parse regex "(?\<process\>\\w\*):\\s+(?\<src\_user\>[^ ]+?)\\s+:.+?USER=(?\<dest\_user\>[^ ]+?)\\s+" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse regex "COMMAND=(?\<command\>[^\$]\*)\$" nodrop<br />\| parse regex "\\s+(?\<process\>\\w\*): pam\_unix\\(sudo:auth\\): conversation failed" nodrop<br />\| parse "pam\_unix(\*:auth): authentication failure;" as process nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| where process="sudo" and command != ""<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{command}}" = "\*", true, command matches "{{command}}")<br />\|count as attempts by dest\_hostname,src\_user,dest\_user, command <br />\| sort - attempts|
|Linux/System Events|System Shutdown|Logs|Linux/System Events/System Shutdown|\_sourceCategory={{Logsdatasource}}   "main process" "killed by TERM" "init" \| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+"|
|Linux/System Events|System Shutdown|Logs|Installed Apps/Linux/System Events/System Shutdown|\_sourceCategory={{Logsdatasource}}   "main process" "killed by TERM" "init" \| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+"|
|Linux/System Events|System Start|Logs|Linux/System Events/System Start|\_sourceCategory={{Logsdatasource}}  "Initializing cgroup subsys cpuset" <br />\| parse regex "^(?\<StartTime\>\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+)\\s(?\<dest\_hostname\>\\S\*)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" nodrop <br />\| count by dest\_hostname,process\_name,StartTime,\_messagetime <br />\| sort by \_messagetime <br />\| fields - \_count,\_messagetime|
|Linux/System Events|System Start|Logs|Installed Apps/Linux/System Events/System Start|\_sourceCategory={{Logsdatasource}}  "Initializing cgroup subsys cpuset" <br />\| parse regex "^(?\<StartTime\>\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+)\\s(?\<dest\_hostname\>\\S\*)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" nodrop <br />\| count by dest\_hostname,process\_name,StartTime,\_messagetime <br />\| sort by \_messagetime <br />\| fields - \_count,\_messagetime|
|Linux|System Starts|Logs|Installed Apps/Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  "Initializing cgroup subsys cpuset"<br />\| parse regex "^(?\<StartTime\>\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+)\\s(?\<dest\_hostname\>\\S\*)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" nodrop<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by dest\_hostname,process\_name,StartTime,\_messagetime \| sort by \_messagetime \| fields - \_count,\_messagetime|
|Linux|System Starts|Logs|Linux/Linux - Security Status|\_sourceCategory={{Logsdatasource}}  "Initializing cgroup subsys cpuset"<br />\| parse regex "^(?\<StartTime\>\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+)\\s(?\<dest\_hostname\>\\S\*)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+" nodrop<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count by dest\_hostname,process\_name,StartTime,\_messagetime \| sort by \_messagetime \| fields - \_count,\_messagetime|
|Linux|Top 30 Failed Logins|Logs|Installed Apps/Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{src\_tty}}" = "\*", true, src\_tty matches "{{src\_tty}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as Attempts by src\_host, dest\_user, dest\_hostname \| sort - Attempts \| limit 30|
|Linux|Top 30 Failed Logins|Logs|Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password")<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{src\_tty}}" = "\*", true, src\_tty matches "{{src\_tty}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as Attempts by src\_host, dest\_user, dest\_hostname \| sort - Attempts \| limit 30|
|Linux|Top 30 Failed Remote Logins|Logs|Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") ("ssh" or "sshd") <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{src\_tty}}" = "\*", true, src\_tty matches "{{src\_tty}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as Attempts by src\_host, dest\_user, dest\_hostname \| sort - Attempts \| limit 30|
|Linux|Top 30 Failed Remote Logins|Logs|Installed Apps/Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") ("ssh" or "sshd") <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{src\_tty}}" = "\*", true, src\_tty matches "{{src\_tty}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as Attempts by src\_host, dest\_user, dest\_hostname \| sort - Attempts \| limit 30|
|Linux|Top 30 Successful Remote Logins|Logs|Installed Apps/Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop<br />\| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as count by dest\_user,dest\_hostname \| sort - count \| limit 30|
|Linux|Top 30 Successful Remote Logins|Logs|Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop<br />\| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as count by dest\_user,dest\_hostname \| sort - count \| limit 30|
|Linux|Top 30 Successful User Logins|Logs|Installed Apps/Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop<br />\| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "Accepted keyboard-interactive/pam for \* from \* port \* \*" as (dest\_user,src\_hostname,src\_port,protocol)<br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{src\_hostname}}" = "\*", true, src\_hostname matches "{{src\_hostname}}")<br />\|count as count by dest\_user,dest\_hostname \| sort by -count \| limit 30|
|Linux|Top 30 Successful User Logins|Logs|Linux/Linux - Login Status|\_sourceCategory={{Logsdatasource}}  ("su:" or "sudo:" or "sshd:" or "sshd[" or "pam:") (("Accepted" and "pam") or "session" or ("to" and "on")) !"closed"<br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*):\\s+(?\<message\>.\*)\$" nodrop<br />\| parse regex  "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\S\*)\\[\\d+\\]:\\s+(?\<message\>.\*)\$" nodrop<br />\| parse "session \* for user \* by \*(uid=\*)" as (action,dest\_user,src\_user,src\_user\_id) nodrop<br />\| parse regex "session (?\<action\>\\w\*) for user (?\<dest\_user\>\\S\*)" nodrop<br />\| parse "Accepted keyboard-interactive/pam for \* from \* port \* \*" as (dest\_user,src\_hostname,src\_port,protocol)<br />\| where dest\_user!=""<br />\|where if ("{{protocol}}" = "\*", true, protocol matches "{{protocol}}") AND if ("{{action}}" = "\*", true, action matches "{{action}}") AND if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{src\_port}}" = "\*", true, src\_port matches "{{src\_port}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{src\_hostname}}" = "\*", true, src\_hostname matches "{{src\_hostname}}")<br />\|count as count by dest\_user,dest\_hostname \| sort by -count \| limit 30|
|Linux|Total Event Distribution|Logs|Installed Apps/Linux/Linux - Event Sources|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+"<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}")<br />\|count as Events by dest\_hostname|
|Linux|Total Event Distribution|Logs|Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S\*)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+"<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as Events by dest\_hostname|
|Linux|Total Event Distribution|Logs|Linux/Linux - Event Sources|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+"<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}")<br />\|count as Events by dest\_hostname|
|Linux|Total Event Distribution|Logs|Installed Apps/Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S\*)\\s(?\<process\_name\>\\w\*)(?:\\[\\d+\\]\|):\\s+"<br />\|where if ("{{dest\_hostname}}" = "\*", true, dest\_hostname matches "{{dest\_hostname}}") AND if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{process\_name}}" = "\*", true, process\_name matches "{{process\_name}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}")<br />\|count as Events by dest\_hostname|
|Linux|User Assignments|Logs|Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  ("to group" or "default group changed" or "change user") or ("useradd" and (("new user") or ("new account")))<br />\| parse "add '\*' to group '\*'" as dest\_user,dest\_group nodrop<br />\| parse "account added to group - account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop<br />\| parse "account=\*, uid=\*, gid=\*, old gid=\*," as dest\_user,dest\_uid, dest\_gid,src\_gid nodrop<br />\| parse "change user '\*' GID from '\*' to '\*'" as dest\_user,src\_gid, dest\_gid nodrop<br />\| parse "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop<br />\| parse "account=\*, uid=\*, gid=\*, home=\*, shell=\*," as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop<br />\| if(dest\_group="" or isNull(dest\_group), dest\_gid, dest\_group) as dest\_group<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{shell}}" = "\*", true, shell matches "{{shell}}") AND if ("{{dest\_group}}" = "\*", true, dest\_group matches "{{dest\_group}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{home\_dir}}" = "\*", true, home\_dir matches "{{home\_dir}}")<br />\|count\_distinct(dest\_user) by dest\_group<br />\| sum(\_count\_distinct)|
|Linux|User Assignments|Logs|Installed Apps/Linux/Linux - Overview|\_sourceCategory={{Logsdatasource}}  ("to group" or "default group changed" or "change user") or ("useradd" and (("new user") or ("new account")))<br />\| parse "add '\*' to group '\*'" as dest\_user,dest\_group nodrop<br />\| parse "account added to group - account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop<br />\| parse "account=\*, uid=\*, gid=\*, old gid=\*," as dest\_user,dest\_uid, dest\_gid,src\_gid nodrop<br />\| parse "change user '\*' GID from '\*' to '\*'" as dest\_user,src\_gid, dest\_gid nodrop<br />\| parse "name=\*, UID=\*, GID=\*, home=\*, shell=\*" as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop<br />\| parse "account=\*, uid=\*, gid=\*, home=\*, shell=\*," as dest\_user,dest\_uid,dest\_gid,home\_dir,shell nodrop<br />\| if(dest\_group="" or isNull(dest\_group), dest\_gid, dest\_group) as dest\_group<br />\|where if ("{{src\_user}}" = "\*", true, src\_user matches "{{src\_user}}") AND if ("{{shell}}" = "\*", true, shell matches "{{shell}}") AND if ("{{dest\_group}}" = "\*", true, dest\_group matches "{{dest\_group}}") AND if ("{{dest\_user}}" = "\*", true, dest\_user matches "{{dest\_user}}") AND if ("{{home\_dir}}" = "\*", true, home\_dir matches "{{home\_dir}}")<br />\|count\_distinct(dest\_user) by dest\_group<br />\| sum(\_count\_distinct)|
|Linux/Privilege Assignments|User Removal|Logs|Installed Apps/Linux/Privilege Assignments/User Removal|\_sourceCategory={{Logsdatasource}}  ("userdel" and "delete user") or "account deleted" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "delete user '\*'" as dest\_user nodrop <br />\| parse "account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop <br />\| parse "account=\*, uid=\*," as dest\_user,dest\_uid nodrop|
|Linux/Privilege Assignments|User Removal|Logs|Linux/Privilege Assignments/User Removal|\_sourceCategory={{Logsdatasource}}  ("userdel" and "delete user") or "account deleted" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "delete user '\*'" as dest\_user nodrop <br />\| parse "account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop <br />\| parse "account=\*, uid=\*," as dest\_user,dest\_uid nodrop|
|Linux/Privilege Assignments|User Removal From Group|Logs|Installed Apps/Linux/Privilege Assignments/User Removal From Group|\_sourceCategory={{Logsdatasource}}  "from group" or "default group changed" or "change user" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "delete '\*' from group '\*'" as dest\_user,dest\_group nodrop <br />\| parse "account removed from group - account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop <br />\| parse "account=\*, uid=\*, gid=\*, old gid=\*," as dest\_user,dest\_uid, dest\_gid,src\_gid nodrop <br />\| parse "change user '\*' GID from '\*' to '\*'" as dest\_user,src\_gid, dest\_gid nodrop|
|Linux/Privilege Assignments|User Removal From Group|Logs|Linux/Privilege Assignments/User Removal From Group|\_sourceCategory={{Logsdatasource}}  "from group" or "default group changed" or "change user" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse "delete '\*' from group '\*'" as dest\_user,dest\_group nodrop <br />\| parse "account removed from group - account=\*, group=\*, gid=\*," as dest\_user,dest\_group,dest\_gid nodrop <br />\| parse "account=\*, uid=\*, gid=\*, old gid=\*," as dest\_user,dest\_uid, dest\_gid,src\_gid nodrop <br />\| parse "change user '\*' GID from '\*' to '\*'" as dest\_user,src\_gid, dest\_gid nodrop|
|Linux/User Logins|Users Logging in From Multiple Remote Hosts|Logs|Installed Apps/Linux/User Logins/Users Logging in From Multiple Remote Hosts|\_sourceCategory={{Logsdatasource}}  "Accepted" AND ("sshd" OR "pam\_unix") <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s" nodrop <br />\| extract "Accepted [^ ]+ for (?\<user\>.+?) from (?\<src\_host\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop <br />\| count by user,dest\_hostname,src\_host <br />\| count as SourceHosts by user,dest\_hostname \| where SourceHosts \> 1|
|Linux/User Logins|Users Logging in From Multiple Remote Hosts|Logs|Linux/User Logins/Users Logging in From Multiple Remote Hosts|\_sourceCategory={{Logsdatasource}}  "Accepted" AND ("sshd" OR "pam\_unix") <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s" nodrop <br />\| extract "Accepted [^ ]+ for (?\<user\>.+?) from (?\<src\_host\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop <br />\| count by user,dest\_hostname,src\_host <br />\| count as SourceHosts by user,dest\_hostname \| where SourceHosts \> 1|
|Linux/User Logins|Users with Multiple Failed Logins|Logs|Installed Apps/Linux/User Logins/Users with Multiple Failed Logins|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") !"passwd" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_ser, src\_host, src\_port, protocol nodrop<br />\| count as Attempts by dest\_user,dest\_hostname <br />\| where (Attempts \> 1) and dest\_user!=""<br />\| sort by attempts, dest\_user asc, dest\_hostname asc|
|Linux/User Logins|Users with Multiple Failed Logins|Logs|Linux/User Logins/Users with Multiple Failed Logins|\_sourceCategory={{Logsdatasource}}  ("authentication failure" or "FAILED SU" or "input\_userauth\_request: invalid user" or "Invalid user" or "Failed publickey" or "Failed password") !"passwd" <br />\| parse regex "\\d+\\s+\\d+:\\d+:\\d+\\s(?\<dest\_hostname\>\\S+)\\s(?\<process\_name\>\\w\*)(?:\\[\|:)" nodrop <br />\| parse " user = \* " as dest\_user nodrop <br />\| parse "User \*: Authentication failure" as dest\_user nodrop <br />\| parse " user=\*" as dest\_user nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<\_sourceHost\>\\S\*)\\s+" nodrop<br />\| parse regex "\\S\*\\s+\\d+\\s+\\d+:\\d+:\\d+\\s+(?\<dest\_hostname\>\\S\*)\\s+(?\<message\>[^;]+)" nodrop<br />\| parse "ruser=\* rhost=\* user=\*" as src\_user, src\_host, dest\_user nodrop<br />\| parse "ruser= rhost=\* user=\*" as src\_host, dest\_user nodrop<br />\| parse " user=\*\\"" as dest\_user nodrop<br />\| parse "Authentication failure for \* from \*" as dest\_user, src\_host nodrop<br />\| parse "FAILED SU (to \*) \* on" as dest\_user, src\_user nodrop<br />\| parse regex "FAILED LOGIN (?:SESSION\|\\d+) FROM (?\<src\_tty\>\\S+) FOR (?\<dest\_user\>\\S+)," nodrop<br />\| parse "input\_userauth\_request: invalid user \*" as dest\_user nodrop<br />\| parse "Invalid user \* from \* port \*" as dest\_user, src\_host, src\_port nodrop<br />\| parse "Failed publickey for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for \* from \* port \* \*" as dest\_user, src\_host, src\_port, protocol nodrop<br />\| parse "Failed password for invalid user \* from \* port \* \*" as dest\_ser, src\_host, src\_port, protocol nodrop<br />\| count as Attempts by dest\_user,dest\_hostname <br />\| where (Attempts \> 1) and dest\_user!=""<br />\| sort by attempts, dest\_user asc, dest\_hostname asc|

