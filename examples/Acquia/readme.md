# Acquia
## Sumo Logic App For: Acquia
Sumo Logic provides instant visibility across the critical components of the Acquia Platform, helping organizations become more proactive in their site monitoring as well as reducing the mean time to identify and resolve issues.

The Sumo Logic App for Acquia provides visibility into the key components of the Acquia platform with preconfigured dashboards for Apache, Varnish, PHP, FPM and Drupal.
Docs Link: [Acquia](https://help.sumologic.com/?cid=1985)

## Searches

### Log Searches

- **Activity Over Time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Activity Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Apache Non 2XX Status Codes**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Apache Non 2XX Status Codes**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Apache Request Volume**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Apache Request Volume**: from Dashboard: Acquia/Acquia - Overview 
- **Apache Response Size Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Apache Response Size Over Time**: from Dashboard: Acquia/Acquia - Overview 
- **Apache Response Time Outlier**: from Dashboard: Acquia/Acquia - Overview 
- **Apache Response Time Outlier**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Average CPU Consumed by Timeslice**: from Dashboard: Acquia/Acquia - FPM Overview 
- **Average CPU Consumed by Timeslice**: from Dashboard: Installed Apps/Acquia/Acquia - FPM Overview 
- **Average Memory Consumed by Timeslice**: from Dashboard: Installed Apps/Acquia/Acquia - FPM Overview 
- **Average Memory Consumed by Timeslice**: from Dashboard: Acquia/Acquia - FPM Overview 
- **Average Response Time Outlier**: from Dashboard: Installed Apps/Acquia/Acquia - Drupal Requests Overview 
- **Average Response Time Outlier**: from Dashboard: Acquia/Acquia - Drupal Requests Overview 
- **Bot Traffic Over Time**: from Dashboard: Acquia/Acquia - Overview 
- **Bot Traffic Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Browsers and Operating Systems**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Access Types 
- **Browsers and Operating Systems**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Access Types 
- **Cache Miss Rate Outlier**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Cache Miss Rate Outlier**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Cache Performance**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Cache Performance**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Cache Performance Over Time**: from Dashboard: Acquia/Varnish/Acquia - Varnish Overview 
- **Cache Performance Over Time**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Overview 
- **Client Errors Over Time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Client Errors Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Client Location - 4xx Errors**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Client Location - 4xx Errors**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Client Locations - 4xx Errors**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Client Locations - 4xx Errors**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Drupal Requests Non 2xx Status Codes**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Drupal Requests Non 2xx Status Codes**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Error Responses by Server**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Error Responses by Server**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Errors by Domain**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Errors by Domain**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Errors by Environment**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Errors by Environment**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Errors by Module**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Errors by Module**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Errors by URL**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Errors by URL**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Errors Outlier Over Time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Errors Outlier Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Media Types Served**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight 
- **Media Types Served**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight 
- **Non 2** Response Codes**: from Dashboard: Installed Apps/Acquia/Acquia - FPM Overview 
- **Non 2** Response Codes**: from Dashboard: Acquia/Acquia - FPM Overview 
- **Non 200 Response Status Codes**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Non 200 Response Status Codes**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Non 2xx Status Codes by Location**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Non 2xx Status Codes by Location**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Non 2xx Status Codes Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Non 2xx Status Codes Over Time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Non 2xx Status Codes Over Time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Non 2xx Status Codes Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Number of Hits by Host - One Day Time Comparison**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Overview 
- **Number of Hits by Host - One Day Time Comparison**: from Dashboard: Acquia/Varnish/Acquia - Varnish Overview 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: Acquia/Acquia - Apache Overview 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: Installed Apps/Acquia/Acquia - Apache Overview 
- **PHP Error Details**: from Dashboard: Acquia/Acquia - Errors Overview 
- **PHP Error Details**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **PHP Error Outlier**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **PHP Error Outlier**: from Dashboard: Acquia/Acquia - Errors Overview 
- **PHP Errors Over Time**: from Dashboard: Acquia/Acquia - Overview 
- **PHP Errors Over Time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **PHP Errors Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **PHP Errors Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Popular Mobile Device Versions**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Access Types 
- **Popular Mobile Device Versions**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Access Types 
- **Queue Time Outlier**: from Dashboard: Acquia/Acquia - Drupal Requests Overview 
- **Queue Time Outlier**: from Dashboard: Installed Apps/Acquia/Acquia - Drupal Requests Overview 
- **Requests by Domain**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Requests by Domain**: from Dashboard: Acquia/Acquia - Overview 
- **Response Codes Overtime**: from Dashboard: Installed Apps/Acquia/Acquia - Drupal Requests Overview 
- **Response Codes Overtime**: from Dashboard: Acquia/Acquia - Drupal Requests Overview 
- **Response Time Outlier**: from Dashboard: Installed Apps/Acquia/Acquia - FPM Overview 
- **Response Time Outlier**: from Dashboard: Acquia/Acquia - FPM Overview 
- **Responses Over Time**: from Dashboard: Acquia/Varnish/Acquia - Varnish Overview 
- **Responses Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Apache Overview 
- **Responses Over Time**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Overview 
- **Responses Over Time**: from Dashboard: Acquia/Acquia - Apache Overview 
- **Server Errors Over Time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Server Errors Over Time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Server Errors Over Time**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Server Errors Over Time**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Server Errors Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Server Errors Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Status Codes Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - FPM Overview 
- **Status Codes Over Time**: from Dashboard: Acquia/Acquia - FPM Overview 
- **Threat Breakdown by Sources**: from Dashboard: Acquia/Acquia - Threat Analysis 
- **Threat Breakdown by Sources**: from Dashboard: Installed Apps/Acquia/Acquia - Threat Analysis 
- **Threat by Actors**: from Dashboard: Acquia/Acquia - Threat Analysis 
- **Threat by Actors**: from Dashboard: Installed Apps/Acquia/Acquia - Threat Analysis 
- **Threat by Geo Location**: from Dashboard: Installed Apps/Acquia/Acquia - Threat Analysis 
- **Threat by Geo Location**: from Dashboard: Acquia/Acquia - Threat Analysis 
- **Threat Count**: from Dashboard: Installed Apps/Acquia/Acquia - Threat Analysis 
- **Threat Count**: from Dashboard: Acquia/Acquia - Threat Analysis 
- **Threat Table**: from Dashboard: Acquia/Acquia - Threat Analysis 
- **Threat Table**: from Dashboard: Installed Apps/Acquia/Acquia - Threat Analysis 
- **Threats by Malicious Confidence**: from Dashboard: Installed Apps/Acquia/Acquia - Threat Analysis 
- **Threats by Malicious Confidence**: from Dashboard: Acquia/Acquia - Threat Analysis 
- **Top 10 Bots Observed**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Top 10 Bots Observed**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Top 10 Error Codes**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Top 10 Error Codes**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Top 10 PC and Mac Versions**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Access Types 
- **Top 10 PC and Mac Versions**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Access Types 
- **Top 10 Referrers**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Top 10 Referrers**: from Dashboard: Acquia/Acquia - Overview 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight 
- **Top 10 Slowest Queries**: from Dashboard: Installed Apps/Acquia/Acquia - Drupal Requests Overview 
- **Top 10 Slowest Queries**: from Dashboard: Acquia/Acquia - Drupal Requests Overview 
- **Top 10 Slowest URLs**: from Dashboard: Installed Apps/Acquia/Acquia - Drupal Requests Overview 
- **Top 10 Slowest URLs**: from Dashboard: Acquia/Acquia - Drupal Requests Overview 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Top 5 URIs causing 404 Responses**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Top 5 URIs causing 404 Responses**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Top 5 User Agents**: from Dashboard: Acquia/Acquia - Overview 
- **Top 5 User Agents**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Top Clients**: from Dashboard: Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Top Clients**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations 
- **Top Documents**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight 
- **Top Documents**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight 
- **Top Referrers**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight 
- **Top Referrers**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight 
- **Top Requests**: from Dashboard: Acquia/Acquia - Overview 
- **Top Requests**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Traffic by Host Over Time**: from Dashboard: Acquia/Acquia - Overview 
- **Traffic by Host Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Traffic by Site Over Time**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Traffic by Site Over Time**: from Dashboard: Acquia/Acquia - Overview 
- **Traffic Distribution by Host**: from Dashboard: Acquia/Varnish/Acquia - Varnish Overview 
- **Traffic Distribution by Host**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Overview 
- **Traffic Distribution by Server**: from Dashboard: Acquia/Acquia - Apache Overview 
- **Traffic Distribution by Server**: from Dashboard: Installed Apps/Acquia/Acquia - Apache Overview 
- **Traffic Volume and Bytes Served**: from Dashboard: Installed Apps/Acquia/Acquia - Apache Overview 
- **Traffic Volume and Bytes Served**: from Dashboard: Acquia/Acquia - Apache Overview 
- **Traffic Volume and Bytes Served**: from Dashboard: Acquia/Varnish/Acquia - Varnish Overview 
- **Traffic Volume and Bytes Served**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Overview 
- **United States**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Locations 
- **United States**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Locations 
- **Varnish Cache Performance**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Varnish Cache Performance**: from Dashboard: Acquia/Acquia - Overview 
- **Varnish Non 2xx Status Codes**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Varnish Non 2xx Status Codes**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Varnish Requests by Country**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Varnish Requests by Country**: from Dashboard: Acquia/Acquia - Overview 
- **Varnish Response Time Outlier**: from Dashboard: Acquia/Acquia - Overview 
- **Varnish Response Time Outlier**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Visitor Geolocations**: from Dashboard: Acquia/Acquia - Overview 
- **Visitor Geolocations**: from Dashboard: Installed Apps/Acquia/Acquia - Overview 
- **Visitor Locations**: from Dashboard: Acquia/Varnish/Acquia - Varnish Overview 
- **Visitor Locations**: from Dashboard: Acquia/Acquia - Apache Overview 
- **Visitor Locations**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Overview 
- **Visitor Locations**: from Dashboard: Installed Apps/Acquia/Acquia - Apache Overview 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: Acquia/Acquia - Apache Overview 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: Installed Apps/Acquia/Acquia - Apache Overview 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: Acquia/Varnish/Acquia - Varnish Overview 
- **Visitor Locations - One Day Time Comparison**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Overview 
- **Visits by Country Over Time**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Locations 
- **Visits by Country Over Time**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Locations 
- **Visits by US State Over Time**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Locations 
- **Visits by US State Over Time**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Locations 
- **Vistor Platforms**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Access Types 
- **Vistor Platforms**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Access Types 
- **Watchdog Errors Over time**: from Dashboard: Acquia/Acquia - Errors Overview 
- **Watchdog Errors Over time**: from Dashboard: Installed Apps/Acquia/Acquia - Errors Overview 
- **Worldwide**: from Dashboard: Acquia/Varnish/Acquia - Varnish Visitor Locations 
- **Worldwide**: from Dashboard: Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Locations

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Acquia|Activity Over Time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| timeslice 1m<br />\| count as count by \_timeslice|
|Acquia|Activity Over Time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| timeslice 1m<br />\| count as count by \_timeslice|
|Acquia|Apache Non 2XX Status Codes|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where !(status\_code matches "2\*")<br />\| count|
|Acquia|Apache Non 2XX Status Codes|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where !(status\_code matches "2\*")<br />\| count|
|Acquia|Apache Request Volume|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse regex "(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| timeslice 5m <br />\| count by \_timeslice|
|Acquia|Apache Request Volume|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse regex "(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| timeslice 5m <br />\| count by \_timeslice|
|Acquia|Apache Response Size Over Time|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse regex "(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| timeslice 1h<br />\| where \_timeslice \> queryStartTime() and \_\_timeslice\_end \< queryEndTime()<br />\| count as totalCount, sum(size) as size by \_timeslice  |
|Acquia|Apache Response Size Over Time|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse regex "(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| parse regex "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)" nodrop<br />\| parse regex "(?\<method\>[A-Z]+)\\s(?\<url\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s(?\<status\_code\>\\d+)\\s(?\<size\>[\\d-]+)\\s\\"(?\<referrer\>.\*?)\\"\\s\\"(?\<user\_agent\>.+?)\\".\*" nodrop<br />\| timeslice 1h<br />\| where \_timeslice \> queryStartTime() and \_\_timeslice\_end \< queryEndTime()<br />\| count as totalCount, sum(size) as size by \_timeslice  |
|Acquia|Apache Response Time Outlier|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse "vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| timeslice 1m<br />\| toLong(request\_time/(1000000)) as request\_time<br />\| avg(request\_time) as seconds by \_timeslice<br />\| outlier seconds window=5,threshold=3,consecutive=1, direction=+|
|Acquia|Apache Response Time Outlier|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse "vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| timeslice 1m<br />\| toLong(request\_time/(1000000)) as request\_time<br />\| avg(request\_time) as seconds by \_timeslice<br />\| outlier seconds window=5,threshold=3,consecutive=1, direction=+|
|Acquia|Average CPU Consumed by Timeslice|Logs|Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access !AH\_FPM\_STATUS<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| memory\_kb / 1000 as memory\_mb<br />\| timeslice 1m<br />\| avg(cpu) as cpu\_percent by \_timeslice|
|Acquia|Average CPU Consumed by Timeslice|Logs|Installed Apps/Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access !AH\_FPM\_STATUS<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| memory\_kb / 1000 as memory\_mb<br />\| timeslice 1m<br />\| avg(cpu) as cpu\_percent by \_timeslice|
|Acquia|Average Memory Consumed by Timeslice|Logs|Installed Apps/Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access !AH\_FPM\_STATUS<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| memory\_kb / 1000 as memory\_mb<br />\| timeslice 1m<br />\| avg(memory\_mb) as memory by \_timeslice|
|Acquia|Average Memory Consumed by Timeslice|Logs|Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access !AH\_FPM\_STATUS<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| memory\_kb / 1000 as memory\_mb<br />\| timeslice 1m<br />\| avg(memory\_mb) as memory by \_timeslice|
|Acquia|Average Response Time Outlier|Logs|Installed Apps/Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests <br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| where query != "" or url != ""<br />\| timeslice 1m<br />\| avg(php\_time) as seconds by \_timeslice<br />\| outlier seconds window=5,threshold=3,direction=+|
|Acquia|Average Response Time Outlier|Logs|Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests <br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| where query != "" or url != ""<br />\| timeslice 1m<br />\| avg(php\_time) as seconds by \_timeslice<br />\| outlier seconds window=5,threshold=3,direction=+|
|Acquia|Bot Traffic Over Time|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} (apache-access or varnishncsa)<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location nodrop<br />\| parse "\\"user\_agent\\":\\"\*\\"," as user\_agent<br />\| timeslice 1m<br />\| where user\_agent matches "\*bot\*" or user\_agent matches "\*index\*"<br />\| count by user\_agent, \_timeslice<br />\| transpose row \_timeslice column user\_agent|
|Acquia|Bot Traffic Over Time|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} (apache-access or varnishncsa)<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location nodrop<br />\| parse "\\"user\_agent\\":\\"\*\\"," as user\_agent<br />\| timeslice 1m<br />\| where user\_agent matches "\*bot\*" or user\_agent matches "\*index\*"<br />\| count by user\_agent, \_timeslice<br />\| transpose row \_timeslice column user\_agent|
|Acquia/Varnish|Browsers and Operating Systems|Logs|Acquia/Varnish/Acquia - Varnish Visitor Access Types|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| json field=message "user\_agent" as agent<br />\| if (agent matches "\*Windows \*" OR agent matches "\*Win32\*" OR agent matches "\*Win64\*","Windows","") as OS <br />\| if (agent matches "\*Macintosh\*" OR agent matches "\*Darwin/\*" OR agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (agent matches "\*iPhone\*","iPhone",OS) as OS <br />\|  if (agent matches "\*Android\*","Android",OS) as OS <br />\| if (agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (agent matches "\*Mobile/\*" OR agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser ="" AND OS=="MacOS" AND agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\|  if (Browser == "","Other",Browser) as Browser<br />\|where host matches "{{host}}"<br />\|count by OS,browser<br />\| transpose row os column browser as \*|
|Acquia/Varnish|Browsers and Operating Systems|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Access Types|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| json field=message "user\_agent" as agent<br />\| if (agent matches "\*Windows \*" OR agent matches "\*Win32\*" OR agent matches "\*Win64\*","Windows","") as OS <br />\| if (agent matches "\*Macintosh\*" OR agent matches "\*Darwin/\*" OR agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (agent matches "\*iPhone\*","iPhone",OS) as OS <br />\|  if (agent matches "\*Android\*","Android",OS) as OS <br />\| if (agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (agent matches "\*Mobile/\*" OR agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser ="" AND OS=="MacOS" AND agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\|  if (Browser == "","Other",Browser) as Browser<br />\|where host matches "{{host}}"<br />\|count by OS,browser<br />\| transpose row os column browser as \*|
|Acquia|Cache Miss Rate Outlier|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as msg<br />\| json field=msg "hitmiss"<br />\| json field=msg "request\_id"<br />\| if (hitmiss="hit", 1, 0) as hit<br />\| if (hitmiss="miss", 1, 0) as miss<br />\| timeslice 1m<br />\| sum(hit) as hit\_cnt, sum(miss) as miss\_cnt by \_timeslice <br />\| miss\_cnt/hit\_cnt as miss\_rate <br />\| sort \_timeslice desc <br />\| outlier miss\_rate window=10, threshold=3, consecutive=1, direction=+ |
|Acquia|Cache Miss Rate Outlier|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as msg<br />\| json field=msg "hitmiss"<br />\| json field=msg "request\_id"<br />\| if (hitmiss="hit", 1, 0) as hit<br />\| if (hitmiss="miss", 1, 0) as miss<br />\| timeslice 1m<br />\| sum(hit) as hit\_cnt, sum(miss) as miss\_cnt by \_timeslice <br />\| miss\_cnt/hit\_cnt as miss\_rate <br />\| sort \_timeslice desc <br />\| outlier miss\_rate window=10, threshold=3, consecutive=1, direction=+ |
|Acquia|Cache Performance|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as msg<br />\| json field=msg "handling"<br />\| json field=msg "request\_id"<br />\| count by handling|
|Acquia|Cache Performance|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as msg<br />\| json field=msg "handling"<br />\| json field=msg "request\_id"<br />\| count by handling|
|Acquia/Varnish|Cache Performance Over Time|Logs|Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "handling"<br />\| json field=message "host"<br />\| timeslice 1m<br />\|where host matches "{{host}}"<br />\|count by handling, \_timeslice<br />\| transpose row \_timeslice column handling|
|Acquia/Varnish|Cache Performance Over Time|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "handling"<br />\| json field=message "host"<br />\| timeslice 1m<br />\|where host matches "{{host}}"<br />\|count by handling, \_timeslice<br />\| transpose row \_timeslice column handling|
|Acquia|Client Errors Over Time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where status\_code matches "4\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice,status\_code<br />\| transpose row \_timeslice column status\_code as \*|
|Acquia|Client Errors Over Time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where status\_code matches "4\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice,status\_code<br />\| transpose row \_timeslice column status\_code as \*|
|Acquia|Client Location - 4xx Errors|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "request\_id"<br />\| json field=message "status"<br />\| json field=message "client\_ip"<br />\| where status matches "4\*" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Client Location - 4xx Errors|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "request\_id"<br />\| json field=message "status"<br />\| json field=message "client\_ip"<br />\| where status matches "4\*" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia/Varnish|Client Locations - 4xx Errors|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| where status\_code matches "4\*" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia/Varnish|Client Locations - 4xx Errors|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| where status\_code matches "4\*" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Drupal Requests Non 2xx Status Codes|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests //v-0a1773c0-9147-11e9-bfae-f3b30d819671<br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| split url delim='?' extract 1 as url, 2 as qstring<br />\| where !(http\_code matches "2\*")<br />\| count<br />|
|Acquia|Drupal Requests Non 2xx Status Codes|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests //v-0a1773c0-9147-11e9-bfae-f3b30d819671<br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| split url delim='?' extract 1 as url, 2 as qstring<br />\| where !(http\_code matches "2\*")<br />\| count<br />|
|Acquia/Varnish|Error Responses by Server|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "host" as host<br />\| num(status\_code)<br />\| where status\_code \>= 400<br />\| timeslice 5m<br />\|where host matches "{{host}}"<br />\|count as count by \_timeslice, host<br />\| transpose row \_timeslice column host|
|Acquia/Varnish|Error Responses by Server|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "host" as host<br />\| num(status\_code)<br />\| where status\_code \>= 400<br />\| timeslice 5m<br />\|where host matches "{{host}}"<br />\|count as count by \_timeslice, host<br />\| transpose row \_timeslice column host|
|Acquia|Errors by Domain|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| count as count by domain|
|Acquia|Errors by Domain|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| count as count by domain|
|Acquia/Varnish|Errors by Environment|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "ah\_environment" as env<br />\| json field=message "host" as host<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\|where host matches "{{host}}"<br />\|count as count by \_timeslice, env<br />\| transpose row \_timeslice column env as \*|
|Acquia/Varnish|Errors by Environment|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "ah\_environment" as env<br />\| json field=message "host" as host<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\|where host matches "{{host}}"<br />\|count as count by \_timeslice, env<br />\| transpose row \_timeslice column env as \*|
|Acquia|Errors by Module|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog error<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| count as count by module|
|Acquia|Errors by Module|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog error<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| count as count by module|
|Acquia|Errors by URL|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| split url delim='?' extract 1 as url, 2 as qstring<br />\| count as count by url|
|Acquia|Errors by URL|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| split url delim='?' extract 1 as url, 2 as qstring<br />\| count as count by url|
|Acquia|Errors Outlier Over Time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| timeslice 1m <br />\| count as count by \_timeslice<br />\| outlier count window=5,direction=+,threshold=3|
|Acquia|Errors Outlier Over Time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| timeslice 1m <br />\| count as count by \_timeslice<br />\| outlier count window=5,direction=+,threshold=3|
|Acquia/Varnish|Media Types Served|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "url" as url<br />\| json field=message "host" as host<br />\| parse regex field=url "^[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$" nodrop<br />\| parse regex field=url "/\\S+?(?\<email\_prefix\>(?:%40\|@)[^.]+?)\\.\\w+" <br />\| where email\_prefix=""<br />\|where host matches "{{host}}"<br />\|count as count by type|
|Acquia/Varnish|Media Types Served|Logs|Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "url" as url<br />\| json field=message "host" as host<br />\| parse regex field=url "^[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$" nodrop<br />\| parse regex field=url "/\\S+?(?\<email\_prefix\>(?:%40\|@)[^.]+?)\\.\\w+" <br />\| where email\_prefix=""<br />\|where host matches "{{host}}"<br />\|count as count by type|
|Acquia|Non 2\*\* Response Codes|Logs|Installed Apps/Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| where !(status\_code matches "2\*") <br />\| count as count by status\_code <br />\| sort by count|
|Acquia|Non 2\*\* Response Codes|Logs|Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| where !(status\_code matches "2\*") <br />\| count as count by status\_code <br />\| sort by count|
|Acquia/Varnish|Non 200 Response Status Codes|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "host" as host<br />\| where !(status\_code matches "2\*")<br />\|where host matches "{{host}}"<br />\|count as count by status\_code <br />\| sort by count|
|Acquia/Varnish|Non 200 Response Status Codes|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "host" as host<br />\| where !(status\_code matches "2\*")<br />\|where host matches "{{host}}"<br />\|count as count by status\_code <br />\| sort by count|
|Acquia|Non 2xx Status Codes by Location|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Non 2xx Status Codes by Location|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Non 2xx Status Codes Over Time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "request\_id"<br />\| where !(status\_code matches "2\*") <br />\| timeslice 1m<br />\| count(status\_code) as status\_code by \_timeslice<br />\| outlier status\_code window=5,threshold=3,consecutive=1,direction=+|
|Acquia|Non 2xx Status Codes Over Time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "request\_id"<br />\| where !(status\_code matches "2\*") <br />\| timeslice 1m<br />\| count(status\_code) as status\_code by \_timeslice<br />\| outlier status\_code window=5,threshold=3,consecutive=1,direction=+|
|Acquia|Non 2xx Status Codes Over Time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where !(status\_code matches "2\*") <br />\| timeslice 1m<br />\| count(status\_code) as status\_code by \_timeslice<br />\| outlier status\_code window=5,threshold=3,consecutive=1,direction=+|
|Acquia|Non 2xx Status Codes Over Time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where !(status\_code matches "2\*") <br />\| timeslice 1m<br />\| count(status\_code) as status\_code by \_timeslice<br />\| outlier status\_code window=5,threshold=3,consecutive=1,direction=+|
|Acquia/Varnish|Number of Hits by Host - One Day Time Comparison|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\|where host matches "{{host}}"<br />\|count by host<br />\| compare with timeshift 1d|
|Acquia/Varnish|Number of Hits by Host - One Day Time Comparison|Logs|Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\|where host matches "{{host}}"<br />\|count by host<br />\| compare with timeshift 1d|
|Acquia|Number of Hits by Server - One Day Time Comparison|Logs|Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| count by host<br />\| compare with timeshift 1d|
|Acquia|Number of Hits by Server - One Day Time Comparison|Logs|Installed Apps/Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| count by host<br />\| compare with timeshift 1d|
|Acquia|PHP Error Details|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} php-errors<br />\| parse "\* \* \* \* - - - [\*] \*: \* request\_id=\\"\*\\"" as head,systime,env,host,time,type,message,request\_id<br />\| count as count by Type, message<br />\| sort by count<br />|
|Acquia|PHP Error Details|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} php-errors<br />\| parse "\* \* \* \* - - - [\*] \*: \* request\_id=\\"\*\\"" as head,systime,env,host,time,type,message,request\_id<br />\| count as count by Type, message<br />\| sort by count<br />|
|Acquia|PHP Error Outlier|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} php-errors<br />\| timeslice 1m<br />\| count by \_timeslice<br />\| outlier \_count window=5,threshold=3,consecutive=2,direction=+<br />|
|Acquia|PHP Error Outlier|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} php-errors<br />\| timeslice 1m<br />\| count by \_timeslice<br />\| outlier \_count window=5,threshold=3,consecutive=2,direction=+<br />|
|Acquia|PHP Errors Over Time|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} php-errors<br />\| parse "\* \* \* \* - - - [\*] \*: \* request\_id=\\"\*\\"" as head,systime,env,host,time,type,message,request\_id<br />\| timeslice 5m<br />\| count by type, \_timeslice<br />\| transpose row \_timeslice column type as \*|
|Acquia|PHP Errors Over Time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} php-errors<br />\| parse "\* \* \* \* - - - [\*] \*: \* request\_id=\\"\*\\"" as head,systime,env,host,time,type,message,request\_id<br />\| timeslice 5m<br />\| count as count by \_timeslice,type<br />\| transpose row \_timeslice column type as \*|
|Acquia|PHP Errors Over Time|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} php-errors<br />\| parse "\* \* \* \* - - - [\*] \*: \* request\_id=\\"\*\\"" as head,systime,env,host,time,type,message,request\_id<br />\| timeslice 5m<br />\| count by type, \_timeslice<br />\| transpose row \_timeslice column type as \*|
|Acquia|PHP Errors Over Time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} php-errors<br />\| parse "\* \* \* \* - - - [\*] \*: \* request\_id=\\"\*\\"" as head,systime,env,host,time,type,message,request\_id<br />\| timeslice 5m<br />\| count as count by \_timeslice,type<br />\| transpose row \_timeslice column type as \*|
|Acquia/Varnish|Popular Mobile Device Versions|Logs|Acquia/Varnish/Acquia - Varnish Visitor Access Types|\_sourceCategory={{\_sourceCategory}} varnishncsa ( iphone or ipad or android or samsung) <br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| parse regex "\\((?\<device\>iPhone).+? CPU iPhone OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex "\\((?\<device\>iPad).+? CPU OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex " (?\<device\>Android) (?\<version\>[\\d\\.]+)" nodrop <br />\| parse regex "(?\<device\>SAMSUNG).+?(?\<version\>(?:GT-\\w+\|SGH-\\w+\|SPH-\\w+\|SCH-\\w+))"<br />\|where host matches "{{host}}"<br />\|count as count by device,version <br />\| sort count <br />\| limit 10|
|Acquia/Varnish|Popular Mobile Device Versions|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Access Types|\_sourceCategory={{\_sourceCategory}} varnishncsa ( iphone or ipad or android or samsung) <br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| parse regex "\\((?\<device\>iPhone).+? CPU iPhone OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex "\\((?\<device\>iPad).+? CPU OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex " (?\<device\>Android) (?\<version\>[\\d\\.]+)" nodrop <br />\| parse regex "(?\<device\>SAMSUNG).+?(?\<version\>(?:GT-\\w+\|SGH-\\w+\|SPH-\\w+\|SCH-\\w+))"<br />\|where host matches "{{host}}"<br />\|count as count by device,version <br />\| sort count <br />\| limit 10|
|Acquia|Queue Time Outlier|Logs|Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests	<br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| where queue\_wait != "0"<br />\| timeslice 1m<br />\| count(queue\_wait) as queue\_wait by \_timeslice<br />\| outlier queue\_wait window=5,threshold=3,consecutive=1,direction=+<br />|
|Acquia|Queue Time Outlier|Logs|Installed Apps/Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests	<br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| where queue\_wait != "0"<br />\| timeslice 1m<br />\| count(queue\_wait) as queue\_wait by \_timeslice<br />\| outlier queue\_wait window=5,threshold=3,consecutive=1,direction=+<br />|
|Acquia|Requests by Domain|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "\\"host\\":\\"\*\\"," as host nodrop<br />\| count by host|
|Acquia|Requests by Domain|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "\\"host\\":\\"\*\\"," as host nodrop<br />\| count by host|
|Acquia|Response Codes Overtime|Logs|Installed Apps/Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests<br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| timeslice 1m<br />\| count by \_timeslice, http\_code<br />\| transpose row \_timeslice column http\_code as \*<br />|
|Acquia|Response Codes Overtime|Logs|Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests<br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| timeslice 1m<br />\| count by \_timeslice, http\_code<br />\| transpose row \_timeslice column http\_code as \*<br />|
|Acquia|Response Time Outlier|Logs|Installed Apps/Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access !AH\_FPM\_STATUS<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| timeslice 1m<br />\| avg(duration\_ms) as duration by \_timeslice<br />\| outlier duration window=5,threshold=3,consecutive=1,direction=+|
|Acquia|Response Time Outlier|Logs|Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access !AH\_FPM\_STATUS<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| timeslice 1m<br />\| avg(duration\_ms) as duration by \_timeslice<br />\| outlier duration window=5,threshold=3,consecutive=1,direction=+|
|Acquia/Varnish|Responses Over Time|Logs|Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| json field=message "status" as status\_code<br />\| if(status\_code matches "2\*", 1, 0) as successes <br />\| if(status\_code matches "3\*", 1, 0) as redirects <br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1h<br />\|where host matches "{{host}}"<br />\|sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice<br />\| sort by \_timeslice asc|
|Acquia|Responses Over Time|Logs|Installed Apps/Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| if(status\_code matches "2\*", 1, 0) as successes <br />\| if(status\_code matches "3\*", 1, 0) as redirects <br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1h <br />\| sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice<br />\| sort by \_timeslice asc|
|Acquia/Varnish|Responses Over Time|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| json field=message "status" as status\_code<br />\| if(status\_code matches "2\*", 1, 0) as successes <br />\| if(status\_code matches "3\*", 1, 0) as redirects <br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1h<br />\|where host matches "{{host}}"<br />\|sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice<br />\| sort by \_timeslice asc|
|Acquia|Responses Over Time|Logs|Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| if(status\_code matches "2\*", 1, 0) as successes <br />\| if(status\_code matches "3\*", 1, 0) as redirects <br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice by 1h <br />\| sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice<br />\| sort by \_timeslice asc|
|Acquia|Server Errors Over Time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "request\_id"<br />\| json field=message "status"<br />\| where status matches "5\*" or status matches "4\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice,status<br />\| transpose row \_timeslice column status as \*|
|Acquia|Server Errors Over Time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice,status\_code<br />\| transpose row \_timeslice column status\_code as \*|
|Acquia/Varnish|Server Errors Over Time|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "host" as host<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\|where host matches "{{host}}"<br />\|count as count by \_timeslice,status\_code<br />\| transpose row \_timeslice column status\_code as \*|
|Acquia/Varnish|Server Errors Over Time|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "host" as host<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\|where host matches "{{host}}"<br />\|count as count by \_timeslice,status\_code<br />\| transpose row \_timeslice column status\_code as \*|
|Acquia|Server Errors Over Time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "request\_id"<br />\| json field=message "status"<br />\| where status matches "5\*" or status matches "4\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice,status<br />\| transpose row \_timeslice column status as \*|
|Acquia|Server Errors Over Time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice,status\_code<br />\| transpose row \_timeslice column status\_code as \*|
|Acquia|Status Codes Over Time|Logs|Installed Apps/Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| timeslice 1m<br />\| count as count by status\_code, \_timeslice<br />\| transpose row \_timeslice column status\_code|
|Acquia|Status Codes Over Time|Logs|Acquia/Acquia - FPM Overview|\_sourceCategory={{\_sourceCategory}} fpm-access<br />\| parse "\\"\* /\*\\" \* memory\_kb=\* %cpu=\* duration\_ms=\* request\_id=\\"\*\\"" as method,url,status\_code,memory\_kb,cpu,duration\_ms,request\_id<br />\| timeslice 1m<br />\| count as count by status\_code, \_timeslice<br />\| transpose row \_timeslice column status\_code|
|Acquia|Threat Breakdown by Sources|Logs|Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_source|
|Acquia|Threat Breakdown by Sources|Logs|Installed Apps/Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_source|
|Acquia|Threat by Actors|Logs|Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by Actor|
|Acquia|Threat by Actors|Logs|Installed Apps/Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by Actor|
|Acquia|Threat by Geo Location|Logs|Installed Apps/Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code, malicious\_confidence<br />\| sort \_count|
|Acquia|Threat by Geo Location|Logs|Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code, malicious\_confidence<br />\| sort \_count|
|Acquia|Threat Count|Logs|Installed Apps/Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|Acquia|Threat Count|Logs|Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|Acquia|Threat Table|Logs|Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|count by src\_ip,method, status\_code, size, referrer, user\_agent<br />\| sort by \_count|
|Acquia|Threat Table|Logs|Installed Apps/Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|count by src\_ip,method, status\_code, size, referrer, user\_agent<br />\| sort by \_count|
|Acquia|Threats by Malicious Confidence|Logs|Installed Apps/Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by malicious\_confidence|
|Acquia|Threats by Malicious Confidence|Logs|Acquia/Acquia - Threat Analysis|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as src\_ip<br />\|count as ip\_count by src\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=src\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by malicious\_confidence|
|Acquia/Varnish|Top 10 Bots Observed|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br />\| parse "- - - \*" as message<br />\| json field=message "user\_agent" as agent<br />\| json field=message "host" as host<br />\| parse regex field=agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Exabot?)\\W"<br />\| where bot\_name != ""<br />\| if (bot\_name="bing","Bing",bot\_name) as bot\_name<br />\|where host matches "{{host}}"<br />\|count as count by bot\_name<br />\| sort by count <br />\| limit 10|
|Acquia/Varnish|Top 10 Bots Observed|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br />\| parse "- - - \*" as message<br />\| json field=message "user\_agent" as agent<br />\| json field=message "host" as host<br />\| parse regex field=agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=agent "(?\<bot\_name\>Exabot?)\\W"<br />\| where bot\_name != ""<br />\| if (bot\_name="bing","Bing",bot\_name) as bot\_name<br />\|where host matches "{{host}}"<br />\|count as count by bot\_name<br />\| sort by count <br />\| limit 10|
|Acquia|Top 10 Error Codes|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-error<br />\| parse " vhost=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" hosting\_site=\* \*: \*" as vhost,forwarded\_for,request\_id,hosting\_site,error\_code,error<br />\| count by error\_code<br />\| sort by \_count<br />\| limit 10|
|Acquia|Top 10 Error Codes|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} apache-error<br />\| parse " vhost=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" hosting\_site=\* \*: \*" as vhost,forwarded\_for,request\_id,hosting\_site,error\_code,error<br />\| count by error\_code<br />\| sort by \_count<br />\| limit 10|
|Acquia/Varnish|Top 10 PC and Mac Versions|Logs|Acquia/Varnish/Acquia - Varnish Visitor Access Types|\_sourceCategory={{\_sourceCategory}} varnishncsa   ("macintosh" OR "mac os" OR "windows" OR "i686" or "PC" or ("Linux" AND !android))   <br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| json field=message "user\_agent" as agent<br />\| parse regex field=agent "(?\<os\>Mac OS) (?\<version\>[^;\\)]+?)(?:;\|\\))" nodrop <br />\| parse regex field=agent "(?\<os\>Windows)(?: NT \| )(?\<version\>[\\d.]+)" nodrop <br />\| parse regex field=agent "(?\<os\>Linux) (?\<version\>\\S+?)(?:\\)\|;)" nodrop <br />\| where os!=""<br />\|where host matches "{{host}}"<br />\|count as count by os,version<br />\| sort count <br />\| limit 10|
|Acquia/Varnish|Top 10 PC and Mac Versions|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Access Types|\_sourceCategory={{\_sourceCategory}} varnishncsa   ("macintosh" OR "mac os" OR "windows" OR "i686" or "PC" or ("Linux" AND !android))   <br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| json field=message "user\_agent" as agent<br />\| parse regex field=agent "(?\<os\>Mac OS) (?\<version\>[^;\\)]+?)(?:;\|\\))" nodrop <br />\| parse regex field=agent "(?\<os\>Windows)(?: NT \| )(?\<version\>[\\d.]+)" nodrop <br />\| parse regex field=agent "(?\<os\>Linux) (?\<version\>\\S+?)(?:\\)\|;)" nodrop <br />\| where os!=""<br />\|where host matches "{{host}}"<br />\|count as count by os,version<br />\| sort count <br />\| limit 10|
|Acquia|Top 10 Referrers|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} (apache-access OR varnishncsa)<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location nodrop<br />\| parse "\\"referrer\\":\\"\*\\"," as referrer<br />\| where referrer != "-"<br />\| count by referrer \| top 10 referrer by \_count  <br />|
|Acquia|Top 10 Referrers|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} (apache-access OR varnishncsa)<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location nodrop<br />\| parse "\\"referrer\\":\\"\*\\"," as referrer<br />\| where referrer != "-"<br />\| count by referrer \| top 10 referrer by \_count  <br />|
|Acquia/Varnish|Top 10 Search Terms from Popular Search Engines|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight|\_sourceCategory={{\_sourceCategory}} varnishncsa  (google OR bing OR aol OR ask OR yahoo) ("p=" OR "q=" OR "wd=" OR "searchfor=")<br />\| parse "- - - \*" as message<br />\| json field=message "referrer" as referrer<br />\| json field=message "host" as host<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where search\_term!=""<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*","Google","") as engine<br />\| if(referrer matches "\*bing.\*","Bing",engine) as engine<br />\| if(referrer matches "\*ask.com\*","Ask.com",engine) as engine<br />\| if(referrer matches "\*aol.\*","AOL",engine) as engine<br />\| if(referrer matches "\*yahoo.\*","Yahoo",engine) as engine<br />\| where engine !=""<br />\|where host matches "{{host}}"<br />\|count as count  by search\_term<br />\| sort count <br />\| limit 10|
|Acquia/Varnish|Top 10 Search Terms from Popular Search Engines|Logs|Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight|\_sourceCategory={{\_sourceCategory}} varnishncsa  (google OR bing OR aol OR ask OR yahoo) ("p=" OR "q=" OR "wd=" OR "searchfor=")<br />\| parse "- - - \*" as message<br />\| json field=message "referrer" as referrer<br />\| json field=message "host" as host<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where search\_term!=""<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*","Google","") as engine<br />\| if(referrer matches "\*bing.\*","Bing",engine) as engine<br />\| if(referrer matches "\*ask.com\*","Ask.com",engine) as engine<br />\| if(referrer matches "\*aol.\*","AOL",engine) as engine<br />\| if(referrer matches "\*yahoo.\*","Yahoo",engine) as engine<br />\| where engine !=""<br />\|where host matches "{{host}}"<br />\|count as count  by search\_term<br />\| sort count <br />\| limit 10|
|Acquia|Top 10 Slowest Queries|Logs|Installed Apps/Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests <br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,status\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| split url delim='?' extract 1 as url, 2 as qstring<br />\| parse "http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as http\_code,query,uid,php\_pid,php\_time,queue\_wait,request\_id<br />\| where query != "" and url != ""<br />\| avg(php\_time) by query<br />\| \_avg/1000 as seconds<br />\| fields - \_avg<br />\| sort seconds desc<br />\| limit 10<br />|
|Acquia|Top 10 Slowest Queries|Logs|Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests <br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,status\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| split url delim='?' extract 1 as url, 2 as qstring<br />\| parse "http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as http\_code,query,uid,php\_pid,php\_time,queue\_wait,request\_id<br />\| where query != "" and url != ""<br />\| avg(php\_time) by query<br />\| \_avg/1000 as seconds<br />\| fields - \_avg<br />\| sort seconds desc<br />\| limit 10<br />|
|Acquia|Top 10 Slowest URLs|Logs|Installed Apps/Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests<br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| split url delim='?' extract 1 as url, 2 as qstring<br />\| where query != "" and url != ""<br />\| avg(php\_time) by url<br />\| \_avg/1000 as seconds<br />\| fields - \_avg<br />\| sort seconds desc<br />\| limit 10<br />|
|Acquia|Top 10 Slowest URLs|Logs|Acquia/Acquia - Drupal Requests Overview|\_sourceCategory={{\_sourceCategory}} drupal-requests<br />\| parse "\<133\>1 \* \* \*.\* - - - [\*] \* \* \* http\_code=\* query=\* uid=\* php\_pid=\* php\_time=\* queue\_wait=\* request\_id=\\"\*\\"" as timestamp,lb,host,logtype,time,appurl,method,url,http\_code,query,uid,php\_id,php\_time,queue\_wait,request\_id<br />\| split url delim='?' extract 1 as url, 2 as qstring<br />\| where query != "" and url != ""<br />\| avg(php\_time) by url<br />\| \_avg/1000 as seconds<br />\| fields - \_avg<br />\| sort seconds desc<br />\| limit 10<br />|
|Acquia/Varnish|Top 5 Clients Causing 4xx Errors|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa (400 OR 401 OR 402 OR 403 OR 404) <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "status" as status\_code<br />\| json field=message "host" as host<br />\| where status\_code matches "4\*"<br />\|where host matches "{{host}}"<br />\|count as count by client\_ip<br />\| sort count <br />\| limit 5|
|Acquia/Varnish|Top 5 Clients Causing 4xx Errors|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa (400 OR 401 OR 402 OR 403 OR 404) <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "status" as status\_code<br />\| json field=message "host" as host<br />\| where status\_code matches "4\*"<br />\|where host matches "{{host}}"<br />\|count as count by client\_ip<br />\| sort count <br />\| limit 5|
|Acquia/Varnish|Top 5 URIs causing 404 Responses|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa 404 <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "url" as url<br />\| json field=message "host" as host<br />\| where status\_code="404"<br />\|where host matches "{{host}}"<br />\|count as count by url<br />\| sort count <br />\| limit 5|
|Acquia/Varnish|Top 5 URIs causing 404 Responses|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa 404 <br />\| parse "- - - \*" as message<br />\| json field=message "status" as status\_code<br />\| json field=message "url" as url<br />\| json field=message "host" as host<br />\| where status\_code="404"<br />\|where host matches "{{host}}"<br />\|count as count by url<br />\| sort count <br />\| limit 5|
|Acquia|Top 5 User Agents|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "\\"user\_agent\\":\\"\*\\"," as user\_agent<br />\| where user\_agent != "-"<br />\| urldecode(user\_agent) as user\_agent<br />\| count by user\_agent <br />\| sort \_count<br />\| limit 5|
|Acquia|Top 5 User Agents|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "\\"user\_agent\\":\\"\*\\"," as user\_agent<br />\| where user\_agent != "-"<br />\| urldecode(user\_agent) as user\_agent<br />\| count by user\_agent <br />\| sort \_count<br />\| limit 5|
|Acquia/Varnish|Top Clients|Logs|Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "host" as host<br />\| json field=message "client\_ip" as client\_ip<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by client\_ip, country\_name<br />\| sort \_count<br />\| limit 10|
|Acquia/Varnish|Top Clients|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Web Server Operations|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "host" as host<br />\| json field=message "client\_ip" as client\_ip<br />\| lookup country\_name from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by client\_ip, country\_name<br />\| sort \_count<br />\| limit 10|
|Acquia/Varnish|Top Documents|Logs|Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "url" as url<br />\| json field=message "host" as host<br />\|where host matches "{{host}}"<br />\|count as count by url<br />\| sort by count<br />\| limit 10|
|Acquia/Varnish|Top Documents|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "url" as url<br />\| json field=message "host" as host<br />\|where host matches "{{host}}"<br />\|count as count by url<br />\| sort by count<br />\| limit 10|
|Acquia/Varnish|Top Referrers|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "referrer" as referrer<br />\| json field=message "host" as host<br />\| where referrer != "-"<br />\|where host matches "{{host}}"<br />\|count by referrer<br />\| sort by \_count<br />\| limit 5|
|Acquia/Varnish|Top Referrers|Logs|Acquia/Varnish/Acquia - Varnish Visitor Traffic Insight|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "referrer" as referrer<br />\| json field=message "host" as host<br />\| where referrer != "-"<br />\|where host matches "{{host}}"<br />\|count by referrer<br />\| sort by \_count<br />\| limit 5|
|Acquia|Top Requests|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} (apache-access OR varnishncsa)<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location nodrop<br />\| parse "\\"url\\":\\"\*\\"," as url<br />\| urldecode(url) as url<br />\| count by url \| top 10 url by \_count|
|Acquia|Top Requests|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} (apache-access OR varnishncsa)<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location nodrop<br />\| parse "\\"url\\":\\"\*\\"," as url<br />\| urldecode(url) as url<br />\| count by url \| top 10 url by \_count|
|Acquia|Traffic by Host Over Time|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\|parse "\<133\>1 \* \* \*.\* - - - \*" as timestamp,host,site,reportType,msg<br />\| timeslice 1m<br />\| count by host, \_timeslice<br />\| transpose row \_timeslice column host as \*|
|Acquia|Traffic by Host Over Time|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\|parse "\<133\>1 \* \* \*.\* - - - \*" as timestamp,host,site,reportType,msg<br />\| timeslice 1m<br />\| count by host, \_timeslice<br />\| transpose row \_timeslice column host as \*|
|Acquia|Traffic by Site Over Time|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\|parse "\<133\>1 \* \* \*.\* - - - \*" as timestamp,host,site,reportType,msg<br />\| timeslice 1m<br />\| count by site, \_timeslice<br />\| transpose row \_timeslice column site as \*|
|Acquia|Traffic by Site Over Time|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\|parse "\<133\>1 \* \* \*.\* - - - \*" as timestamp,host,site,reportType,msg<br />\| timeslice 1m<br />\| count by site, \_timeslice<br />\| transpose row \_timeslice column site as \*|
|Acquia/Varnish|Traffic Distribution by Host|Logs|Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| timeslice 1h<br />\|where host matches "{{host}}"<br />\|count by \_timeslice,host  <br />\| transpose row \_timeslice column host|
|Acquia/Varnish|Traffic Distribution by Host|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "host"<br />\| timeslice 1h<br />\|where host matches "{{host}}"<br />\|count by \_timeslice,host  <br />\| transpose row \_timeslice column host|
|Acquia|Traffic Distribution by Server|Logs|Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| timeslice 1h<br />\| count by \_timeslice, host<br />\| transpose row \_timeslice column host|
|Acquia|Traffic Distribution by Server|Logs|Installed Apps/Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| timeslice 1h<br />\| count by \_timeslice, host<br />\| transpose row \_timeslice column host|
|Acquia|Traffic Volume and Bytes Served|Logs|Installed Apps/Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where size != "-"<br />\| timeslice 1h <br />\| (size/(1048576\*1000)) as gbytes <br />\| count as hits, sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc|
|Acquia|Traffic Volume and Bytes Served|Logs|Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where size != "-"<br />\| timeslice 1h <br />\| (size/(1048576\*1000)) as gbytes <br />\| count as hits, sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc|
|Acquia/Varnish|Traffic Volume and Bytes Served|Logs|Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "bytes" as size<br />\| json field=message "host"<br />\| where size != "-"<br />\| timeslice 1h <br />\| (size/1024/1024) as mbytes<br />\|where host matches "{{host}}"<br />\|count as hits, sum(mbytes) as mbytes by \_timeslice <br />\| sort \_timeslice asc|
|Acquia/Varnish|Traffic Volume and Bytes Served|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "bytes" as size<br />\| json field=message "host"<br />\| where size != "-"<br />\| timeslice 1h <br />\| (size/1024/1024) as mbytes<br />\|where host matches "{{host}}"<br />\|count as hits, sum(mbytes) as mbytes by \_timeslice <br />\| sort \_timeslice asc|
|Acquia/Varnish|United States|Logs|Acquia/Varnish/Acquia - Varnish Visitor Locations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| where country\_name="United States"<br />\|where host matches "{{host}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia/Varnish|United States|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Locations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| where country\_name="United States"<br />\|where host matches "{{host}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Varnish Cache Performance|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "handling"<br />\| count by handling|
|Acquia|Varnish Cache Performance|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "handling"<br />\| count by handling|
|Acquia|Varnish Non 2xx Status Codes|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "status"<br />\| json field=message "request\_id"<br />\| where !(status matches "2\*")<br />\| count|
|Acquia|Varnish Non 2xx Status Codes|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "status"<br />\| json field=message "request\_id"<br />\| where !(status matches "2\*")<br />\| count|
|Acquia|Varnish Requests by Country|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse regex "(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| count by country\_code|
|Acquia|Varnish Requests by Country|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse regex "(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| count by country\_code|
|Acquia|Varnish Response Time Outlier|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as msg<br />\| json field=msg "time\_firstbyte"<br />\| timeslice 1m<br />\| avg(time\_firstbyte) as seconds by \_timeslice<br />\| outlier seconds window=5,threshold=3,consecutive=1, direction=+|
|Acquia|Varnish Response Time Outlier|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as msg<br />\| json field=msg "time\_firstbyte"<br />\| timeslice 1m<br />\| avg(time\_firstbyte) as seconds by \_timeslice<br />\| outlier seconds window=5,threshold=3,consecutive=1, direction=+|
|Acquia|Visitor Geolocations|Logs|Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse regex "(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Visitor Geolocations|Logs|Installed Apps/Acquia/Acquia - Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse regex "(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})" nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia/Varnish|Visitor Locations|Logs|Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip"<br />\| json field=message "host"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Visitor Locations|Logs|Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia/Varnish|Visitor Locations|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip"<br />\| json field=message "host"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Visitor Locations|Logs|Installed Apps/Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access<br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia|Visitor Locations - One Day Time Comparison|Logs|Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where isPublicIP(src\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by country\_name, city<br />\| sort \_count <br />\| compare with timeshift 1d|
|Acquia|Visitor Locations - One Day Time Comparison|Logs|Installed Apps/Acquia/Acquia - Apache Overview|\_sourceCategory={{\_sourceCategory}} apache-access <br />\| parse " - - - \* - - [\*] \\"\* \* HTTP/1.1\\" \* \* \\"\*\\" \\"\*\\" vhost=\* host=\* hosting\_site=\* pid=\* request\_time=\* forwarded\_for=\\"\*\\" request\_id=\\"\*\\" location=\\"\*\\"" as src\_ip,timestamp,method,url,status\_code,size,referrer,user\_agent,vhost,host,hosting\_site,pid,request\_time,forwarded\_for,request\_id,location<br />\| where isPublicIP(src\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by country\_name, city<br />\| sort \_count <br />\| compare with timeshift 1d|
|Acquia/Varnish|Visitor Locations - One Day Time Comparison|Logs|Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip"<br />\| json field=message "host"<br />\| where isPublicIP(client\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by country\_name, city<br />\| sort \_count <br />\| compare with timeshift 1d|
|Acquia/Varnish|Visitor Locations - One Day Time Comparison|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Overview|\_sourceCategory={{\_sourceCategory}} varnishncsa<br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip"<br />\| json field=message "host"<br />\| where isPublicIP(client\_ip)<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by country\_name, city<br />\| sort \_count <br />\| compare with timeshift 1d|
|Acquia/Varnish|Visits by Country Over Time|Logs|Acquia/Varnish/Acquia - Varnish Visitor Locations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| where !isNull(country\_name) AND country\_name !=""<br />\| timeslice 5m<br />\|where host matches "{{host}}"<br />\|count by \_timeslice,country\_name<br />\| transpose row \_timeslice column country\_name as \*|
|Acquia/Varnish|Visits by Country Over Time|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Locations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| where !isNull(country\_name) AND country\_name !=""<br />\| timeslice 5m<br />\|where host matches "{{host}}"<br />\|count by \_timeslice,country\_name<br />\| transpose row \_timeslice column country\_name as \*|
|Acquia/Varnish|Visits by US State Over Time|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Locations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| timeslice 5m<br />\| where country\_name="United States" AND !isNull(region) AND region !=""<br />\|where host matches "{{host}}"<br />\|count by \_timeslice,region<br />\| transpose row \_timeslice column region as \*|
|Acquia/Varnish|Visits by US State Over Time|Logs|Acquia/Varnish/Acquia - Varnish Visitor Locations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| timeslice 5m<br />\| where country\_name="United States" AND !isNull(region) AND region !=""<br />\|where host matches "{{host}}"<br />\|count by \_timeslice,region<br />\| transpose row \_timeslice column region as \*|
|Acquia/Varnish|Vistor Platforms|Logs|Acquia/Varnish/Acquia - Varnish Visitor Access Types|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "user\_agent" as agent<br />\| json field=message "host"<br />\| if (agent matches "\*iPad\*" OR agent matches "\*iPhone\*" OR agent matches "\*Android\*" OR agent matches "\*BlackBerry\*" OR agent matches "\*Galaxy\*" OR agent matches "LGE-\*" OR agent matches "SCH-\*" OR agent matches "\*HUAWEI-\*" OR agent matches "\*SAMSUNG\*" OR agent matches "\*samsung\*" OR agent matches "Dalvik/\*" OR agent matches "Nokia\*" OR agent matches "LG-\*" OR agent matches "\*CFNetwork\*"  OR agent matches "\*UP.Browser/\*" OR agent matches "\*QQ\*rowser\*" OR agent matches "\*NetFront/\*" OR agent matches "\*Windows Phone\*" OR agent matches "\*Mobile Safari\*" OR agent matches "\*iemobile\*","Mobile","") as type<br />\| if (agent matches "\*Windows\*" OR agent matches "\*Win64\*" OR agent matches "\*Win32\*" OR agent matches "\*i686\*" OR agent matches "\*x86\*","PC",type) as type<br />\| if (agent matches "\*Macintosh\*" OR agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\|where host matches "{{host}}"<br />\|count type|
|Acquia/Varnish|Vistor Platforms|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Access Types|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "user\_agent" as agent<br />\| json field=message "host"<br />\| if (agent matches "\*iPad\*" OR agent matches "\*iPhone\*" OR agent matches "\*Android\*" OR agent matches "\*BlackBerry\*" OR agent matches "\*Galaxy\*" OR agent matches "LGE-\*" OR agent matches "SCH-\*" OR agent matches "\*HUAWEI-\*" OR agent matches "\*SAMSUNG\*" OR agent matches "\*samsung\*" OR agent matches "Dalvik/\*" OR agent matches "Nokia\*" OR agent matches "LG-\*" OR agent matches "\*CFNetwork\*"  OR agent matches "\*UP.Browser/\*" OR agent matches "\*QQ\*rowser\*" OR agent matches "\*NetFront/\*" OR agent matches "\*Windows Phone\*" OR agent matches "\*Mobile Safari\*" OR agent matches "\*iemobile\*","Mobile","") as type<br />\| if (agent matches "\*Windows\*" OR agent matches "\*Win64\*" OR agent matches "\*Win32\*" OR agent matches "\*i686\*" OR agent matches "\*x86\*","PC",type) as type<br />\| if (agent matches "\*Macintosh\*" OR agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\|where host matches "{{host}}"<br />\|count type|
|Acquia|Watchdog Errors Over time|Logs|Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| timeslice 1m<br />\| count as count by \_timeslice|
|Acquia|Watchdog Errors Over time|Logs|Installed Apps/Acquia/Acquia - Errors Overview|\_sourceCategory={{\_sourceCategory}} drupal-watchdog<br />\| parse ": \*\|\*\|\*\|\*\|\*\|\*\|\*\|\*\|\* request\_id=\\"\*\\"" as domain,timestamp,module,src\_ip,url,referrer,uid,link,message,request\_id<br />\| where message matches "\*error\*"<br />\| timeslice 1m<br />\| count as count by \_timeslice|
|Acquia/Varnish|Worldwide|Logs|Acquia/Varnish/Acquia - Varnish Visitor Locations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Acquia/Varnish|Worldwide|Logs|Installed Apps/Acquia/Varnish/Acquia - Varnish Visitor Locations|\_sourceCategory={{\_sourceCategory}} varnishncsa <br />\| parse "- - - \*" as message<br />\| json field=message "client\_ip" as client\_ip<br />\| json field=message "host" as host<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where host matches "{{host}}"<br />\|count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|

