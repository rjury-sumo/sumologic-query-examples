# MongoDB Atlas 6
## Sumo Logic App For: MongoDB Atlas 6
The Sumo Logic App for MongoDB Atlas allows you to monitor database operations, performance KPIs and provides visibility into the security posture of your clusters.
Docs Link: [MongoDB Atlas 6](https://help.sumologic.com/?cid=1978)

## Searches

### Log Searches

- **Alerts by HostName - Distribution**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by HostName - Distribution**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by MetricName**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by MetricName**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by MetricName - Trend**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by MetricName - Trend**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by Status**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by Status**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by Status - Trend**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts by Status - Trend**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts Outlier Over Time**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Alerts Outlier Over Time**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Audit Events by Action Type**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Audit Events by Action Type**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Audit Events by Hostname - Trend**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Audit Events by Hostname - Trend**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Audit Events by Users**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Audit Events by Users**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Audit Events Locations by Remote IP**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Audit Events Locations by Remote IP**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Average Query Duration by Namespace**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Average Query Duration by Namespace**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Balancer Failures**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Balancer Failures**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Chunk Split by Shard and Collection**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Chunk Split by Shard and Collection**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Chunks Moving Between Shards**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Chunks Moving Between Shards**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Chunks Moving by Collection**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Chunks Moving by Collection**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Cluster Ready Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Cluster Ready Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Database Read/Write Operations**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Database Read/Write Operations**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Error Messages with Low Severity**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Error Messages with Low Severity**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Errors**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Errors**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Errors**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Errors**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Errors**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Errors**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Errors - Time Compare**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Errors - Time Compare**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Errors by Component**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Errors by Component**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Events by Location**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Events by Location**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Events by User Name**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Events by User Name**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Events Distribution by type**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Events Distribution by type**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Failed Audit Events**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Failed Audit Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Failed Audit Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Failed Audit Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Failed Authentications**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Failed Authentications**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Failed Authorizations**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Failed Authorizations**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Failed Login Attempt Summary**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Failed Login Attempt Summary**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Failed Logins**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Failed Logins**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Heartbeat Error Events**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Heartbeat Error Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Hosts  by Errors and Warnings**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Hosts  by Errors and Warnings**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Indexed Keys by database and collection**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Indexed Keys by database and collection**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Last 3 Cluster Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Last 3 Cluster Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Last 3 Errors by Hostname**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Last 3 Errors by Hostname**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Last 3 Host Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Last 3 Host Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Location of Client Connection Requests**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Location of Client Connection Requests**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Location of Failed Logins**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Location of Failed Logins**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Logins from Malicious Remote IP**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Logins from Malicious Remote IP**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Messages  with High Severity**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Messages  with High Severity**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Messages by Severity**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Messages by Severity**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **MongoDB Exit Events**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **MongoDB Exit Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **MongoDB User Updated Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **MongoDB User Updated Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Number of CRUD Commands Over Time**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Number of CRUD Commands Over Time**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Open Alerts**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Open Alerts**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Open Alerts**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Open Alerts**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Primary Node**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Primary Node**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Project Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Project Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Queries with Scanned Keys/Returned Objects ratio less than  1**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Queries with Scanned Keys/Returned Objects ratio less than  1**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Queries with Scanned Objects/Returned Objects ratio greater than 1**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Queries with Scanned Objects/Returned Objects ratio greater than 1**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Recent Alerts**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Recent Alerts**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Recent Alerts**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Recent Alerts**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Recent Audit Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Recent Audit Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Audit 
- **Recent Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Recent Events**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Recent Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Recent Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Replication Error Summary**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Error Summary**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Errors**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Errors**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Events**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Events**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Warnings**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Replication Warnings**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Running Servers**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Running Servers**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Secondary Node(s)**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Secondary Node(s)**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication 
- **Slow CRUD Operations by Database and Collection**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow CRUD Operations by Database and Collection**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow Queries**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow Queries**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Slow Queries**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Slow Queries**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow Queries by Connection ID**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow Queries by Connection ID**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow Queries by Database**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow Queries by Database**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow Queries Over Time by Type**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Slow Queries Over Time by Type**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries  
- **Socket Excpetions**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Socket Excpetions**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Stopped Servers**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Stopped Servers**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Summary of Errors**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Summary of Errors**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Summary of Warnings**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Summary of Warnings**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Threat Intel by Remote IP**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Threat Intel by Remote IP**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Threat Intel Outlier by Remote IP**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Threat Intel Outlier by Remote IP**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Timeout Events**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Timeout Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Total Alerts by Day**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Total Alerts by Day**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts 
- **Total Events**: from Dashboard: Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Total Events**: from Dashboard: MongoDB Atlas 6/Security/MongoDB Atlas - Events 
- **Unreachable Nodes**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Unreachable Nodes**: from Dashboard: MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Unreachable Nodes**: from Dashboard: Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview 
- **Unreachable Nodes**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections 
- **Warnings**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Warnings**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding 
- **Warnings**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Warnings**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Warnings by Component**: from Dashboard: Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings 
- **Warnings by Component**: from Dashboard: MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings

### Metric Searches

- **Cache Dirty Bytes**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Cache Dirty Bytes**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Cache Usage**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Cache Usage**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Cache Used Bytes**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Cache Used Bytes**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Connections**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Connections**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Connections**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Connections**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **DataSize (documents+padding size in bytes)**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **DataSize (documents+padding size in bytes)**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **DataSize (documents+padding size in bytes)**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **DataSize (documents+padding size in bytes)**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Disk IOPS Read**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Disk IOPS Read**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Disk IOPS Write**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Disk IOPS Write**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Disk Partition Utilization %**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Disk Partition Utilization %**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Disk Space Used**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Disk Space Used**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Disk Space Used**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Disk Space Used**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Disk Write Latency**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Disk Write Latency**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Network Bytes In**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Network Bytes In**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Network Bytes Out**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Network Bytes Out**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Normalized System CPU IOWAIT**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Normalized System CPU IOWAIT**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Operation Execution Time Total**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Operation Execution Time Total**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Page Faults**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Page Faults**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Queued Operations**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Queued Operations**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Read Operations**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Read Operations**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Read Operations Executions Times**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Read Operations Executions Times**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Resident Memory**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Resident Memory**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Scanned Index Keys / Returned Documents Ratio**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Scanned Index Keys / Returned Documents Ratio**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Scanned Objects / Returned Documents Ratio**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Scanned Objects / Returned Documents Ratio**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Total Open Cursors**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Total Open Cursors**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics 
- **Write Operations**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Write Operations**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Write Operations Execution Times**: from Dashboard: MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics 
- **Write Operations Execution Times**: from Dashboard: Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|MongoDB Atlas 6/Security|Alerts by HostName - Distribution|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| parse field=hostnameAndPort "\*:\*" as hostname, port<br />\| count by metricName, hostname<br />\| total \_count as alert\_count by hostname<br />\| transpose row hostname, alert\_count column metricName <br />\| sort by alert\_count|
|MongoDB Atlas 6/Security|Alerts by HostName - Distribution|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| parse field=hostnameAndPort "\*:\*" as hostname, port<br />\| count by metricName, hostname<br />\| total \_count as alert\_count by hostname<br />\| transpose row hostname, alert\_count column metricName <br />\| sort by alert\_count|
|MongoDB Atlas 6/Security|Alerts by MetricName|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| count by metricName<br />\| sort by \_count|
|MongoDB Atlas 6/Security|Alerts by MetricName|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| count by metricName<br />\| sort by \_count|
|MongoDB Atlas 6/Security|Alerts by MetricName - Trend|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| timeslice 1h<br />\| count(id) by \_timeslice, metricName<br />\| transpose row \_timeslice column metricName|
|MongoDB Atlas 6/Security|Alerts by MetricName - Trend|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| timeslice 1h<br />\| count(id) by \_timeslice, metricName<br />\| transpose row \_timeslice column metricName|
|MongoDB Atlas 6/Security|Alerts by Status|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| count by status<br />\| sort by \_count|
|MongoDB Atlas 6/Security|Alerts by Status|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| count by status<br />\| sort by \_count|
|MongoDB Atlas 6/Security|Alerts by Status - Trend|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| timeslice 1h<br />\| count(id) by \_timeslice, status<br />\| transpose row \_timeslice column status|
|MongoDB Atlas 6/Security|Alerts by Status - Trend|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| timeslice 1h<br />\| count(id) by \_timeslice, status<br />\| transpose row \_timeslice column status|
|MongoDB Atlas 6/Security|Alerts Outlier Over Time|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| timeslice 15m<br />\| count(id) by \_timeslice<br />\| sort +\_timeslice<br />\| outlier \_count |
|MongoDB Atlas 6/Security|Alerts Outlier Over Time|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| timeslice 15m<br />\| count(id) by \_timeslice<br />\| sort +\_timeslice<br />\| outlier \_count |
|MongoDB Atlas 6/Security|Audit Events by Action Type|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by \_timeslice, atype<br />\| transpose row \_timeslice column atype|
|MongoDB Atlas 6/Security|Audit Events by Action Type|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by \_timeslice, atype<br />\| transpose row \_timeslice column atype|
|MongoDB Atlas 6/Security|Audit Events by Hostname - Trend|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by \_timeslice, hostname<br />\| transpose row \_timeslice column hostname|
|MongoDB Atlas 6/Security|Audit Events by Hostname - Trend|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by \_timeslice, hostname<br />\| transpose row \_timeslice column hostname|
|MongoDB Atlas 6/Security|Audit Events by Users|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| parse regex field=users "(?\<json\_blob\>\\{[^\\}]+\\})" multi<br />\| json auto field=json\_blob<br />\| json field=json\_blob "user", "db" as user, database\_name<br />\| count by user, atype<br />\| if (atype matches "\*create\*" OR atype matches "\*add\*" OR atype matches "\*grant\*", "created", if (atype matches "\*drop\*" OR atype matches "\*remove\*" OR atype matches "\*revoke\*", "deleted", if (atype matches "\*update\*", "updated", "other"))) as audit\_action\_type<br />\| count by user, audit\_action\_type<br />\| total \_count as activity\_count by user<br />\| sort by activity\_count<br />\| fields -activity\_count<br />\| transpose row user column audit\_action\_type|
|MongoDB Atlas 6/Security|Audit Events by Users|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| parse regex field=users "(?\<json\_blob\>\\{[^\\}]+\\})" multi<br />\| json auto field=json\_blob<br />\| json field=json\_blob "user", "db" as user, database\_name<br />\| count by user, atype<br />\| if (atype matches "\*create\*" OR atype matches "\*add\*" OR atype matches "\*grant\*", "created", if (atype matches "\*drop\*" OR atype matches "\*remove\*" OR atype matches "\*revoke\*", "deleted", if (atype matches "\*update\*", "updated", "other"))) as audit\_action\_type<br />\| count by user, audit\_action\_type<br />\| total \_count as activity\_count by user<br />\| sort by activity\_count<br />\| fields -activity\_count<br />\| transpose row user column audit\_action\_type|
|MongoDB Atlas 6/Security|Audit Events Locations by Remote IP|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| count by remote\_ip <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br /><br />|
|MongoDB Atlas 6/Security|Audit Events Locations by Remote IP|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| count by remote\_ip <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip<br /><br />|
|MongoDB Atlas 6|Average Query Duration by Namespace|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs COMMAND<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.ns" as severity,timestamp,component,context,database,duration,namespace<br />\| timeslice 1h<br />\| avg(duration) by \_timeslice, namespace<br />\| transpose row \_timeslice column namespace|
|MongoDB Atlas 6|Average Query Duration by Namespace|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  COMMAND<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.ns" as severity,timestamp,component,context,database,duration,namespace<br />\| timeslice 1h<br />\| avg(duration) by \_timeslice, namespace<br />\| transpose row \_timeslice column namespace|
|MongoDB Atlas 6/Operations|Balancer Failures|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory=Labs/MongoDBAtlas/logs SHARDING and (error\* or fail\* or exception\*) BALANCER<br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where severity in  ("W", "E") and context matches "\*Balancer\*"<br />\| count by timestamp,cluster\_name,project\_id,hostname,severity,component,context,msg, \_sourceHost<br />\| fields - \_count<br />|
|MongoDB Atlas 6/Operations|Balancer Failures|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory={{Logsdatasource}}  SHARDING and (error\* or fail\* or exception\*) BALANCER<br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where severity in  ("W", "E") and context matches "\*Balancer\*"<br />\| count by timestamp,cluster\_name,project\_id,hostname,severity,component,context,msg, \_sourceHost<br />\| fields - \_count<br />|
|MongoDB Atlas 6/Performance|Cache Dirty Bytes|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=CACHE\_DIRTY\_BYTES hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Cache Dirty Bytes|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=CACHE\_DIRTY\_BYTES hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Cache Usage|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=CACHE\_USED\_BYTES hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Cache Usage|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=CACHE\_USED\_BYTES hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Cache Used Bytes|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=CACHE\_USED\_BYTES hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Cache Used Bytes|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=CACHE\_USED\_BYTES hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Operations|Chunk Split by Shard and Collection|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory=Labs/MongoDBAtlas/logs \*split\* \*chunk\* <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.splitPoint","attr.namespace","attr.shardId" as severity,timestamp,component,context,chunkSplitPoint,collection,shard<br />\| count by chunkSplitPoint,shard,collection<br />\| fields - \_count|
|MongoDB Atlas 6/Operations|Chunk Split by Shard and Collection|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory={{Logsdatasource}}  \*split\* \*chunk\* <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.splitPoint","attr.namespace","attr.shardId" as severity,timestamp,component,context,chunkSplitPoint,collection,shard<br />\| count by chunkSplitPoint,shard,collection<br />\| fields - \_count|
|MongoDB Atlas 6/Operations|Chunks Moving Between Shards|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory={{Logsdatasource}}  moveChunk<br />\| json field=\_raw "attr.event.ns"<br />\| json "t.\$date","s","c","ctx","attr.event.details.from","attr.event.details.to","attr.event.ns" as timestamp,severity,component,context,fromShard,toShard,collection<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| \_sourceHost as Host<br />\| count by fromShard,toShard, Host <br />|
|MongoDB Atlas 6/Operations|Chunks Moving Between Shards|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory=Labs/MongoDBAtlas/logs moveChunk<br />\| json field=\_raw "attr.event.ns"<br />\| json "t.\$date","s","c","ctx","attr.event.details.from","attr.event.details.to","attr.event.ns" as timestamp,severity,component,context,fromShard,toShard,collection<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| \_sourceHost as Host<br />\| count by fromShard,toShard, Host <br />|
|MongoDB Atlas 6/Operations|Chunks Moving by Collection|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory={{Logsdatasource}}  \*move\* \*Chunk\*<br />\| json field=\_raw "attr.event.ns"<br />\| json "t.\$date","s","c","ctx","attr.event.details.from","attr.event.details.to","attr.event.ns" as timestamp,severity,component,context,fromShard,toShard,collection<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| count by collection |
|MongoDB Atlas 6/Operations|Chunks Moving by Collection|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory=Labs/MongoDBAtlas/logs \*move\* \*Chunk\*<br />\| json field=\_raw "attr.event.ns"<br />\| json "t.\$date","s","c","ctx","attr.event.details.from","attr.event.details.to","attr.event.ns" as timestamp,severity,component,context,fromShard,toShard,collection<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| count by collection |
|MongoDB Atlas 6/Security|Cluster Ready Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where eventTypeName="CLUSTER\_READY"<br />\| count|
|MongoDB Atlas 6/Security|Cluster Ready Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where eventTypeName="CLUSTER\_READY"<br />\| count|
|MongoDB Atlas 6/Performance|Connections|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=CONNECTIONS hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Connections|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=CONNECTIONS hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Connections|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=CONNECTIONS hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Connections|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=CONNECTIONS hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Security|Database Read/Write Operations|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name", "param.ns", "param.command" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name, namespace, command<br />\| parse regex field=users "\\"user\\":\\"(?\<user\>.\*?)\\"" multi nodrop<br />\| parse field=namespace "\*.\*" as database, collection<br />\| where atype matches "authCheck" and command matches /find\|insert\|delete\|update\|findandmodify/<br />\| first(\_messageTime) as latest\_event\_date group by atype, project\_id, hostname, cluster\_name, database, collection, user, command, local\_ip, remote\_ip<br />\| sort by latest\_event\_date<br />\| formatDate(fromMillis(toLong(latest\_event\_date)),"MM-dd-yyyy HH:mm:ss:SSS") as latest\_event\_date|
|MongoDB Atlas 6/Security|Database Read/Write Operations|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name", "param.ns", "param.command" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name, namespace, command<br />\| parse regex field=users "\\"user\\":\\"(?\<user\>.\*?)\\"" multi nodrop<br />\| parse field=namespace "\*.\*" as database, collection<br />\| where atype matches "authCheck" and command matches /find\|insert\|delete\|update\|findandmodify/<br />\| first(\_messageTime) as latest\_event\_date group by atype, project\_id, hostname, cluster\_name, database, collection, user, command, local\_ip, remote\_ip<br />\| sort by latest\_event\_date<br />\| formatDate(fromMillis(toLong(latest\_event\_date)),"MM-dd-yyyy HH:mm:ss:SSS") as latest\_event\_date|
|MongoDB Atlas 6/Performance|DataSize (documents+padding size in bytes)|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=DB\_DATA\_SIZE\_TOTAL  hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|DataSize (documents+padding size in bytes)|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=DB\_DATA\_SIZE\_TOTAL hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|DataSize (documents+padding size in bytes)|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=DB\_DATA\_SIZE\_TOTAL  hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|DataSize (documents+padding size in bytes)|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=DB\_DATA\_SIZE\_TOTAL hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Disk IOPS Read|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}    metric=DISK\_PARTITION\_IOPS\_READ hostid={{hostid}}  projectid={{projectid}}  cluster\_name={{cluster\_name}} processid={{processid}}  \| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Disk IOPS Read|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics   metric=DISK\_PARTITION\_IOPS\_READ hostid={{hostid}}  projectid={{projectid}}  cluster\_name={{cluster\_name}} processid={{processid}}  \| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Disk IOPS Write|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=DISK\_PARTITION\_IOPS\_WRITE  hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Disk IOPS Write|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=DISK\_PARTITION\_IOPS\_WRITE  hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Disk Partition Utilization %|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=DISK\_PARTITION\_UTILIZATION hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Disk Partition Utilization %|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=DISK\_PARTITION\_UTILIZATION hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Disk Space Used|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=DISK\_PARTITION\_SPACE\_PERCENT\_USED  hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Disk Space Used|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=DISK\_PARTITION\_SPACE\_PERCENT\_USED hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Disk Space Used|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=DISK\_PARTITION\_SPACE\_PERCENT\_USED  hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Disk Space Used|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=DISK\_PARTITION\_SPACE\_PERCENT\_USED hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Disk Write Latency|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=DISK\_PARTITION\_LATENCY\_WRITE hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Disk Write Latency|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=DISK\_PARTITION\_LATENCY\_WRITE hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Operations|Error Messages with Low Severity|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("W", "I", "D")<br />\| count by timestamp, project\_id, cluster\_name, hostname,severity, component, context , msg<br />\| if (severity matches "W", 3, if(severity matches "I", 2, 1)) as severity\_order<br />\| sort by severity\_order, timestamp<br />\| fields - \_count , severity\_order|
|MongoDB Atlas 6/Operations|Error Messages with Low Severity|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("W", "I", "D")<br />\| count by timestamp, project\_id, cluster\_name, hostname,severity, component, context , msg<br />\| if (severity matches "W", 3, if(severity matches "I", 2, 1)) as severity\_order<br />\| sort by severity\_order, timestamp<br />\| fields - \_count , severity\_order|
|MongoDB Atlas 6/Operations|Errors|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| count |
|MongoDB Atlas 6|Errors|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| count |
|MongoDB Atlas 6/Operations|Errors|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory={{Logsdatasource}}  SHARDING<br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where component matches "\*SHARDING\*" and severity in ("F","E") <br />\| count|
|MongoDB Atlas 6|Errors|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| count |
|MongoDB Atlas 6/Operations|Errors|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| count |
|MongoDB Atlas 6/Operations|Errors|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory=Labs/MongoDBAtlas/logs SHARDING<br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where component matches "\*SHARDING\*" and severity in ("F","E") <br />\| count|
|MongoDB Atlas 6/Operations|Errors - Time Compare|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| timeslice 1h<br />\| count as today by \_timeslice<br />\| compare with timeshift 1d 7 avg<br />\| today\_7d\_avg as last\_week\_avg<br />\| fields -today\_7d\_avg |
|MongoDB Atlas 6/Operations|Errors - Time Compare|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| timeslice 1h<br />\| count as today by \_timeslice<br />\| compare with timeshift 1d 7 avg<br />\| today\_7d\_avg as last\_week\_avg<br />\| fields -today\_7d\_avg |
|MongoDB Atlas 6/Operations|Errors by Component|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| count by component|
|MongoDB Atlas 6/Operations|Errors by Component|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| count by component|
|MongoDB Atlas 6/Security|Events by Location|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, created, username, remoteAddress nodrop<br />\| count by remoteAddress <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remoteAddress|
|MongoDB Atlas 6/Security|Events by Location|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, created, username, remoteAddress nodrop<br />\| count by remoteAddress <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remoteAddress|
|MongoDB Atlas 6/Security|Events by User Name|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where !isNull(username)<br />\| count by username,eventTypeName<br />\| sort by \_count|
|MongoDB Atlas 6/Security|Events by User Name|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where !isNull(username)<br />\| count by username,eventTypeName<br />\| sort by \_count|
|MongoDB Atlas 6/Security|Events Distribution by type|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| count by eventTypeName<br />\| if (isNull(eventTypeName), "Others", eventTypeName) as eventTypeName<br />\| sort by \_count|
|MongoDB Atlas 6/Security|Events Distribution by type|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| count by eventTypeName<br />\| if (isNull(eventTypeName), "Others", eventTypeName) as eventTypeName<br />\| sort by \_count|
|MongoDB Atlas 6|Failed Audit Events|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| where result!=0<br />\| count<br />|
|MongoDB Atlas 6/Security|Failed Audit Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| where result!=0<br />\| count<br />|
|MongoDB Atlas 6/Security|Failed Audit Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| where result!=0<br />\| count<br />|
|MongoDB Atlas 6|Failed Audit Events|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| where result!=0<br />\| count<br />|
|MongoDB Atlas 6/Security|Failed Authentications|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| where result=18<br />\| count<br /><br />|
|MongoDB Atlas 6/Security|Failed Authentications|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| where result=18<br />\| count<br /><br />|
|MongoDB Atlas 6/Security|Failed Authorizations|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| where result=13<br />\| count<br /><br />|
|MongoDB Atlas 6/Security|Failed Authorizations|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| where result=13<br />\| count<br /><br />|
|MongoDB Atlas 6/Operations|Failed Login Attempt Summary|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory=Labs/MongoDBAtlas/logs "authentication failed"<br />\| json "t.\$date","s","c","ctx","attr.authenticationDatabase","attr.remote","attr.principalName","attr.error" as timestamp,severity,component,context,database,client\_ip,user,reason<br />\| substring(client\_ip,0,15) as client\_ip<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| count by timestamp, project\_id, hostname, cluster\_name, user, database, client\_ip, reason<br />\| fields - \_count|
|MongoDB Atlas 6/Operations|Failed Login Attempt Summary|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory={{Logsdatasource}}  "authentication failed"<br />\| json "t.\$date","s","c","ctx","attr.authenticationDatabase","attr.remote","attr.principalName","attr.error" as timestamp,severity,component,context,database,client\_ip,user,reason<br />\| substring(client\_ip,0,15) as client\_ip<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| count by timestamp, project\_id, hostname, cluster\_name, user, database, client\_ip, reason<br />\| fields - \_count|
|MongoDB Atlas 6|Failed Logins|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  "authentication failed"<br />\| json "t.\$date","s","c","ctx","attr.authenticationDatabase","attr.remote","attr.principalName","attr.error" as timestamp,severity,component,context,database,client\_ip,user,reason<br />\| count|
|MongoDB Atlas 6|Failed Logins|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs "authentication failed"<br />\| json "t.\$date","s","c","ctx","attr.authenticationDatabase","attr.remote","attr.principalName","attr.error" as timestamp,severity,component,context,database,client\_ip,user,reason<br />\| count|
|MongoDB Atlas 6/Operations|Heartbeat Error Events|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory=Labs/MongoDBAtlas/logs \*Heartbeat\* \*fail\*<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where component matches "\*REPL\*"<br />\| count by timestamp,project\_id, cluster\_name,hostname, severity,component,msg, \_sourceHost<br />\| fields - \_count |
|MongoDB Atlas 6/Operations|Heartbeat Error Events|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory={{Logsdatasource}}  \*Heartbeat\* \*fail\*<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where component matches "\*REPL\*"<br />\| count by timestamp,project\_id, cluster\_name,hostname, severity,component,msg, \_sourceHost<br />\| fields - \_count |
|MongoDB Atlas 6/Operations|Hosts  by Errors and Warnings|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F", "W")<br />\| count by hostname, severity<br />\| total \_count by hostname<br />\| transpose row hostname, \_total column severity<br />\| sort by \_total|
|MongoDB Atlas 6/Operations|Hosts  by Errors and Warnings|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F", "W")<br />\| count by hostname, severity<br />\| total \_count by hostname<br />\| transpose row hostname, \_total column severity<br />\| sort by \_total|
|MongoDB Atlas 6/Performance|Indexed Keys by database and collection|Logs|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory={{Logsdatasource}}  INDEX<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.namespace" as severity,timestamp,component,context,namespace<br />\| where component matches "\*INDEX\*"<br />\| parse regex field=namespace "(?\<database\>.+?(?=\\.))"<br />\| parse regex field=namespace "(?\<collection\>(?\<=\\.).+?(?=\$))"<br />\| count by project\_id, cluster\_name, hostname, database, collection<br />\| sort by \_count|
|MongoDB Atlas 6/Performance|Indexed Keys by database and collection|Logs|MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory=Labs/MongoDBAtlas/logs INDEX<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.namespace" as severity,timestamp,component,context,namespace<br />\| where component matches "\*INDEX\*"<br />\| parse regex field=namespace "(?\<database\>.+?(?=\\.))"<br />\| parse regex field=namespace "(?\<collection\>(?\<=\\.).+?(?=\$))"<br />\| count by project\_id, cluster\_name, hostname, database, collection<br />\| sort by \_count|
|MongoDB Atlas 6/Security|Last 3 Cluster Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname","clusterName", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname,cluster\_name, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where !isNull(cluster\_name)<br />\| count by created, eventTypeName,cluster\_name<br />\| topk(3, created) by cluster\_name<br />\| format("last\_event\_data: %s, eventTypeName: %s", created, eventTypeName) as host\_event<br />\| fields -\_count,created,eventTypeName<br />\| transpose row cluster\_name column \_rank |
|MongoDB Atlas 6/Security|Last 3 Cluster Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname","clusterName", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname,cluster\_name, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where !isNull(cluster\_name)<br />\| count by created, eventTypeName,cluster\_name<br />\| topk(3, created) by cluster\_name<br />\| format("last\_event\_data: %s, eventTypeName: %s", created, eventTypeName) as host\_event<br />\| fields -\_count,created,eventTypeName<br />\| transpose row cluster\_name column \_rank |
|MongoDB Atlas 6|Last 3 Errors by Hostname|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E","F","W") OR msg matches /error\*\|fail\*\|exception\*\|timeout\*\|stop\*\|shut\*\|down\*\|exit\*/<br />\| count by hostname,component,msg,timestamp<br />\| topk(3, timestamp) by hostname, component<br />\| format("Timestamp: %s\\nComponent: %s\\nMessage: %s", timestamp, component, msg) as latest\_error<br />\| fields -msg, component, \_count, timestamp<br />\| transpose row hostname column \_rank<br />|
|MongoDB Atlas 6|Last 3 Errors by Hostname|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E","F","W") OR msg matches /error\*\|fail\*\|exception\*\|timeout\*\|stop\*\|shut\*\|down\*\|exit\*/<br />\| count by hostname,component,msg,timestamp<br />\| topk(3, timestamp) by hostname, component<br />\| format("Timestamp: %s\\nComponent: %s\\nMessage: %s", timestamp, component, msg) as latest\_error<br />\| fields -msg, component, \_count, timestamp<br />\| transpose row hostname column \_rank<br />|
|MongoDB Atlas 6/Security|Last 3 Host Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where !isNull(hostname)<br />\| count by created, eventTypeName,hostname<br />\| topk(3, created) by hostname<br />\| format("last\_event\_data: %s, eventTypeName: %s", created, eventTypeName) as host\_event<br />\| fields -\_count,created,eventTypeName<br />\| transpose row hostname column \_rank |
|MongoDB Atlas 6/Security|Last 3 Host Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where !isNull(hostname)<br />\| count by created, eventTypeName,hostname<br />\| topk(3, created) by hostname<br />\| format("last\_event\_data: %s, eventTypeName: %s", created, eventTypeName) as host\_event<br />\| fields -\_count,created,eventTypeName<br />\| transpose row hostname column \_rank |
|MongoDB Atlas 6/Operations|Location of Client Connection Requests|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory={{Logsdatasource}}  ("connection accepted" and NETWORK) <br />\| json "t.\$date","s","c","ctx","attr.remote" as timestamp,severity,component,context,client\_ip<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| parse regex field=client\_ip "(?\<client\_ip\>(?\<=).\*(?=:))"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|MongoDB Atlas 6/Operations|Location of Client Connection Requests|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory=Labs/MongoDBAtlas/logs ("connection accepted" and NETWORK) <br />\| json "t.\$date","s","c","ctx","attr.remote" as timestamp,severity,component,context,client\_ip<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| parse regex field=client\_ip "(?\<client\_ip\>(?\<=).\*(?=:))"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|MongoDB Atlas 6/Operations|Location of Failed Logins|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory={{Logsdatasource}}  "authentication failed"<br />\| json "t.\$date","s","c","ctx","attr.authenticationDatabase","attr.remote","attr.principalName","attr.error" as timestamp,severity,component,context,database,client\_ip,user,reason<br />\| parse regex field=client\_ip "(?\<client\_ip\>(?\<=).\*(?=:))"<br />\| json "msg","project\_id","hostname","cluster\_name" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|MongoDB Atlas 6/Operations|Location of Failed Logins|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory=Labs/MongoDBAtlas/logs "authentication failed"<br />\| json "t.\$date","s","c","ctx","attr.authenticationDatabase","attr.remote","attr.principalName","attr.error" as timestamp,severity,component,context,database,client\_ip,user,reason<br />\| parse regex field=client\_ip "(?\<client\_ip\>(?\<=).\*(?=:))"<br />\| json "msg","project\_id","hostname","cluster\_name" <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|MongoDB Atlas 6/Operations|Logins from Malicious Remote IP|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users", "result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=remote\_ip<br />\| where type="ip\_address" and malicious\_confidence ="high"<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as threat\_last\_updated <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip|
|MongoDB Atlas 6/Operations|Logins from Malicious Remote IP|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users", "result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=remote\_ip<br />\| where type="ip\_address" and malicious\_confidence ="high"<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as threat\_last\_updated <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = remote\_ip|
|MongoDB Atlas 6/Operations|Messages  with High Severity|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| count by timestamp, project\_id, hostname, cluster\_name, severity, component, context , msg<br />\| if (severity matches "F", 5, 4) as severity\_order<br />\| sort by severity\_order, timestamp<br />\| fields - \_count , severity\_order|
|MongoDB Atlas 6/Operations|Messages  with High Severity|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("E", "F")<br />\| count by timestamp, project\_id, hostname, cluster\_name, severity, component, context , msg<br />\| if (severity matches "F", 5, 4) as severity\_order<br />\| sort by severity\_order, timestamp<br />\| fields - \_count , severity\_order|
|MongoDB Atlas 6|Messages by Severity|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| if (severity="I", "Informational", if(severity="W", "Warning", if(severity="E", "Error", if(severity="F", "Fatal", "Debug")))) as severity<br />\| count by severity<br />|
|MongoDB Atlas 6|Messages by Severity|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| if (severity="I", "Informational", if(severity="W", "Warning", if(severity="E", "Error", if(severity="F", "Fatal", "Debug")))) as severity<br />\| count by severity<br />|
|MongoDB Atlas 6/Operations|MongoDB Exit Events|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  (dbexit OR shutdown OR "shutting down")<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.exitCode" as severity,timestamp,component,context,code<br />\| lookup desc  as error\_description from https://s3.amazonaws.com/sumologic-app-data/mongo\_exit\_codes.csv on code=code<br />\| count by timestamp, project\_id, hostname, cluster\_name, code, severity, msg, error\_description, context, \_sourceHost<br />\| order by timestamp<br />\| fields - \_count |
|MongoDB Atlas 6/Operations|MongoDB Exit Events|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs (dbexit OR shutdown OR "shutting down")<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.exitCode" as severity,timestamp,component,context,code<br />\| lookup desc  as error\_description from https://s3.amazonaws.com/sumologic-app-data/mongo\_exit\_codes.csv on code=code<br />\| count by timestamp, project\_id, hostname, cluster\_name, code, severity, msg, error\_description, context, \_sourceHost<br />\| order by timestamp<br />\| fields - \_count |
|MongoDB Atlas 6/Security|MongoDB User Updated Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where eventTypeName="MONGODB\_USER\_UPDATED"<br />\| count|
|MongoDB Atlas 6/Security|MongoDB User Updated Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| where eventTypeName="MONGODB\_USER\_UPDATED"<br />\| count|
|MongoDB Atlas 6/Performance|Network Bytes In|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=NETWORK\_BYTES\_IN hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Network Bytes In|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=NETWORK\_BYTES\_IN hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Network Bytes Out|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=NETWORK\_BYTES\_OUT  hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Network Bytes Out|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=NETWORK\_BYTES\_OUT  hostid={{hostid}} processid={{processid}} projectid={{projectid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Normalized System CPU IOWAIT|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=SYSTEM\_NORMALIZED\_CPU\_IOWAIT hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Normalized System CPU IOWAIT|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=SYSTEM\_NORMALIZED\_CPU\_IOWAIT hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6|Number of CRUD Commands Over Time|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns" as severity,timestamp,component,context,database,duration,db\_cmd,collection<br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| timeslice 1 h<br />\| count by \_timeslice, crud\_operation<br />\| transpose row \_timeslice column crud\_operation|
|MongoDB Atlas 6|Number of CRUD Commands Over Time|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns" as severity,timestamp,component,context,database,duration,db\_cmd,collection<br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| timeslice 1 h<br />\| count by \_timeslice, crud\_operation<br />\| transpose row \_timeslice column crud\_operation|
|MongoDB Atlas 6|Open Alerts|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| where status = "OPEN"<br />\| count |
|MongoDB Atlas 6/Security|Open Alerts|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| where status = "OPEN"<br />\| count |
|MongoDB Atlas 6/Security|Open Alerts|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| where status = "OPEN"<br />\| count |
|MongoDB Atlas 6|Open Alerts|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| where status = "OPEN"<br />\| count |
|MongoDB Atlas 6/Performance|Operation Execution Time Total|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  (metric=OP\_EXECUTION\_TIME\_READS OR metric=OP\_EXECUTION\_TIME\_WRITES OR metric=OP\_EXECUTION\_TIME\_COMMANDS) hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Operation Execution Time Total|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   (metric=OP\_EXECUTION\_TIME\_READS OR metric=OP\_EXECUTION\_TIME\_WRITES OR metric=OP\_EXECUTION\_TIME\_COMMANDS) hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Page Faults|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=EXTRA\_INFO\_PAGE\_FAULTS hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Page Faults|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=EXTRA\_INFO\_PAGE\_FAULTS hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Operations|Primary Node|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory=Labs/MongoDBAtlas/logs REPL <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.primary" as severity,timestamp,component,context,primary\_node<br />\| withtime msg <br />\| most\_recent(msg\_withtime) as message by  hostname<br />|
|MongoDB Atlas 6/Operations|Primary Node|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory={{Logsdatasource}}  REPL <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.primary" as severity,timestamp,component,context,primary\_node<br />\| withtime msg <br />\| most\_recent(msg\_withtime) as message by  hostname<br />|
|MongoDB Atlas 6/Security|Project Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| count(id)|
|MongoDB Atlas 6/Security|Project Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| count(id)|
|MongoDB Atlas 6/Performance|Queries with Scanned Keys/Returned Objects ratio less than  1|Logs|MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns","attr.nreturned","attr.docsExamined","attr.keysExamined" as severity,timestamp,component,context,database,duration,db\_cmd,collection,nreturned,docs\_examined,keys\_examined <br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| number(keys\_examined) \| number(docs\_examined) \| number(nreturned) \| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count by database, collection, crud\_operation, duration,keys\_examined,docs\_examined,nreturned<br />\| docs\_examined/nreturned as scanned\_obj\_by\_return\_ratio<br />\| where scanned\_obj\_by\_return\_ratio \< 1<br />\| fields -\_count<br />\| sort by scanned\_obj\_by\_return\_ratio|
|MongoDB Atlas 6/Performance|Queries with Scanned Keys/Returned Objects ratio less than  1|Logs|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns","attr.nreturned","attr.docsExamined","attr.keysExamined" as severity,timestamp,component,context,database,duration,db\_cmd,collection,nreturned,docs\_examined,keys\_examined <br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| number(keys\_examined) \| number(docs\_examined) \| number(nreturned) \| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count by database, collection, crud\_operation, duration,keys\_examined,docs\_examined,nreturned<br />\| docs\_examined/nreturned as scanned\_obj\_by\_return\_ratio<br />\| where scanned\_obj\_by\_return\_ratio \< 1<br />\| fields -\_count<br />\| sort by scanned\_obj\_by\_return\_ratio|
|MongoDB Atlas 6/Performance|Queries with Scanned Objects/Returned Objects ratio greater than 1|Logs|MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns","attr.nreturned","attr.docsExamined","attr.keysExamined" as severity,timestamp,component,context,database,duration,db\_cmd,collection,nreturned,docs\_examined,keys\_examined <br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| number(keys\_examined) \| number(docs\_examined) \| number(nreturned) \| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count by database, collection, crud\_operation, duration,keys\_examined,docs\_examined,nreturned<br />\| docs\_examined/nreturned as scanned\_obj\_by\_return\_ratio<br />\| where scanned\_obj\_by\_return\_ratio \> 1<br />\| fields -\_count<br />\| sort by scanned\_obj\_by\_return\_ratio|
|MongoDB Atlas 6/Performance|Queries with Scanned Objects/Returned Objects ratio greater than 1|Logs|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns","attr.nreturned","attr.docsExamined","attr.keysExamined" as severity,timestamp,component,context,database,duration,db\_cmd,collection,nreturned,docs\_examined,keys\_examined <br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| number(keys\_examined) \| number(docs\_examined) \| number(nreturned) \| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count by database, collection, crud\_operation, duration,keys\_examined,docs\_examined,nreturned<br />\| docs\_examined/nreturned as scanned\_obj\_by\_return\_ratio<br />\| where scanned\_obj\_by\_return\_ratio \> 1<br />\| fields -\_count<br />\| sort by scanned\_obj\_by\_return\_ratio|
|MongoDB Atlas 6/Performance|Queued Operations|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=GLOBAL\_LOCK\_CURRENT\_QUEUE\_TOTAL hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Queued Operations|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=GLOBAL\_LOCK\_CURRENT\_QUEUE\_TOTAL hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}} \| sum by hostId|
|MongoDB Atlas 6/Performance|Read Operations|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics   (metric=OPCOUNTER\_CMD OR metric=OPCOUNTER\_QUERY OR metric=OPCOUNTER\_GETMORE)  hostid={{hostid}} projectid={{projectid}} processid={{processid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Read Operations|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}    (metric=OPCOUNTER\_CMD OR metric=OPCOUNTER\_QUERY OR metric=OPCOUNTER\_GETMORE)  hostid={{hostid}} projectid={{projectid}} processid={{processid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Read Operations Executions Times|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=OP\_EXECUTION\_TIME\_READS hostid={{hostid}} projectid={{projectid}} processid={{processid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Read Operations Executions Times|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=OP\_EXECUTION\_TIME\_READS hostid={{hostid}} projectid={{projectid}} processid={{processid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Security|Recent Alerts|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","orgId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id, org\_id, hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| if (isNull(org\_id), format("https://cloud.mongodb.com/v2/%s#alerts", project\_id), format("https://cloud.mongodb.com/v2#/org/%s/alerts/list", org\_id)) as link<br />\| tourl(link, id) as id<br />\| count by id, updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName<br />\| sort by updated<br />\| fields -\_count|
|MongoDB Atlas 6|Recent Alerts|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","orgId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id, org\_id, hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| if (isNull(org\_id), format("https://cloud.mongodb.com/v2/%s#alerts", project\_id), format("https://cloud.mongodb.com/v2#/org/%s/alerts/list", org\_id)) as link<br />\| tourl(link, id) as id<br />\| count by id, updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName<br />\| sort by updated<br />\| fields -\_count|
|MongoDB Atlas 6|Recent Alerts|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","orgId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id, org\_id, hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| if (isNull(org\_id), format("https://cloud.mongodb.com/v2/%s#alerts", project\_id), format("https://cloud.mongodb.com/v2#/org/%s/alerts/list", org\_id)) as link<br />\| tourl(link, id) as id<br />\| count by id, updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName<br />\| sort by updated<br />\| fields -\_count|
|MongoDB Atlas 6/Security|Recent Alerts|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","orgId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id, org\_id, hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| topk(1, updated) by id<br />\| if (isNull(org\_id), format("https://cloud.mongodb.com/v2/%s#alerts", project\_id), format("https://cloud.mongodb.com/v2#/org/%s/alerts/list", org\_id)) as link<br />\| tourl(link, id) as id<br />\| count by id, updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName<br />\| sort by updated<br />\| fields -\_count|
|MongoDB Atlas 6/Security|Recent Audit Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name", "param" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name, param<br />\| json field=param "db", "ns" as database1, database2 nodrop<br />\| parse field=database2 "\*.\*" as database2, collection nodrop<br />\| if (isBlank(database1), database2, database1) as database<br />\| where atype matches /create\|add\|grant\|drop\|remove\|revoke\|shutdown\|rename\|update\|authenticate\|authcheck/<br />\| first(\_messageTime) as latest\_event\_date group by atype, project\_id, hostname, cluster\_name,  database, collection, users, local\_ip, remote\_ip<br />\| sort by latest\_event\_date<br />\| formatDate(fromMillis(toLong(latest\_event\_date)),"MM-dd-yyyy HH:mm:ss:SSS") as latest\_event\_date|
|MongoDB Atlas 6/Security|Recent Audit Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Audit|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name", "param" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name, param<br />\| json field=param "db", "ns" as database1, database2 nodrop<br />\| parse field=database2 "\*.\*" as database2, collection nodrop<br />\| if (isBlank(database1), database2, database1) as database<br />\| where atype matches /create\|add\|grant\|drop\|remove\|revoke\|shutdown\|rename\|update\|authenticate\|authcheck/<br />\| first(\_messageTime) as latest\_event\_date group by atype, project\_id, hostname, cluster\_name,  database, collection, users, local\_ip, remote\_ip<br />\| sort by latest\_event\_date<br />\| formatDate(fromMillis(toLong(latest\_event\_date)),"MM-dd-yyyy HH:mm:ss:SSS") as latest\_event\_date|
|MongoDB Atlas 6|Recent Events|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port,created, username, remoteAddress nodrop<br />\| where eventTypeName matches "\*"<br />\| if (isNull(org\_id), format("https://cloud.mongodb.com/v2/%s#activity", project\_id),format("https://cloud.mongodb.com/v2#/org/%s/activity/list", org\_id)) as link<br />\| tourl(link, id) as id<br />\| count by created, id, org\_id, project\_id, eventTypeName, metricName, hostname, port, username, remoteAddress<br />\| sort by created|
|MongoDB Atlas 6/Security|Recent Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port,created, username, remoteAddress nodrop<br />\| where eventTypeName matches "\*"<br />\| if (isNull(org\_id), format("https://cloud.mongodb.com/v2/%s#activity", project\_id),format("https://cloud.mongodb.com/v2#/org/%s/activity/list", org\_id)) as link<br />\| tourl(link, id) as id<br />\| count by created, id, org\_id, project\_id, eventTypeName, metricName, hostname, port, username, remoteAddress<br />\| sort by created|
|MongoDB Atlas 6|Recent Events|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port,created, username, remoteAddress nodrop<br />\| where eventTypeName matches "\*"<br />\| if (isNull(org\_id), format("https://cloud.mongodb.com/v2/%s#activity", project\_id),format("https://cloud.mongodb.com/v2#/org/%s/activity/list", org\_id)) as link<br />\| tourl(link, id) as id<br />\| count by created, id, org\_id, project\_id, eventTypeName, metricName, hostname, port, username, remoteAddress<br />\| sort by created|
|MongoDB Atlas 6/Security|Recent Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port,created, username, remoteAddress nodrop<br />\| where eventTypeName matches "\*"<br />\| if (isNull(org\_id), format("https://cloud.mongodb.com/v2/%s#activity", project\_id),format("https://cloud.mongodb.com/v2#/org/%s/activity/list", org\_id)) as link<br />\| tourl(link, id) as id<br />\| count by created, id, org\_id, project\_id, eventTypeName, metricName, hostname, port, username, remoteAddress<br />\| sort by created|
|MongoDB Atlas 6/Operations|Replication Error Summary|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory={{Logsdatasource}}  REPL (error\* OR fail\* OR exception)<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where component matches "\*REPL\*"<br />\| count by timestamp, project\_id, hostname, cluster\_name, severity, component, context , msg<br />\| fields - \_count |
|MongoDB Atlas 6/Operations|Replication Error Summary|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory=Labs/MongoDBAtlas/logs REPL (error\* OR fail\* OR exception)<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where component matches "\*REPL\*"<br />\| count by timestamp, project\_id, hostname, cluster\_name, severity, component, context , msg<br />\| fields - \_count |
|MongoDB Atlas 6/Operations|Replication Errors|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory=Labs/MongoDBAtlas/logs REPL (error\* OR fail\* OR exception)<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where component matches "\*REPL\*"<br />\| count |
|MongoDB Atlas 6/Operations|Replication Errors|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory={{Logsdatasource}}  REPL (error\* OR fail\* OR exception)<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where component matches "\*REPL\*"<br />\| count |
|MongoDB Atlas 6/Operations|Replication Events|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory=Labs/MongoDBAtlas/logs and REPL<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| count by timestamp, project\_id, cluster\_name, hostname, severity, context , msg<br />\| order by timestamp <br />\| limit 100<br />\| fields - \_count|
|MongoDB Atlas 6/Operations|Replication Events|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory={{Logsdatasource}}  and REPL<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| count by timestamp, project\_id, cluster\_name, hostname, severity, context , msg<br />\| order by timestamp <br />\| limit 100<br />\| fields - \_count|
|MongoDB Atlas 6/Operations|Replication Events|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory=Labs/MongoDBAtlas/logs and REPL and (! "Error in heartbeat" )  and !(	"Not starting an election, since we are not electable") and !("pings from other members before syncing")<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.hostAndPort" as severity,timestamp,component,context,host\_name<br />\| count by timestamp, project\_id, cluster\_name, hostname, severity, context , msg<br />\| order by timestamp <br />\| limit 100<br />\| fields - \_count<br />|
|MongoDB Atlas 6/Operations|Replication Events|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory={{Logsdatasource}}  and REPL and (! "Error in heartbeat" )  and !(	"Not starting an election, since we are not electable") and !("pings from other members before syncing")<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.hostAndPort" as severity,timestamp,component,context,host\_name<br />\| count by timestamp, project\_id, cluster\_name, hostname, severity, context , msg<br />\| order by timestamp <br />\| limit 100<br />\| fields - \_count<br />|
|MongoDB Atlas 6/Operations|Replication Warnings|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory=Labs/MongoDBAtlas/logs REPL<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity = "W" and  component matches "\*REPL\*"<br />\| count |
|MongoDB Atlas 6/Operations|Replication Warnings|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory={{Logsdatasource}}  REPL<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity = "W" and  component matches "\*REPL\*"<br />\| count |
|MongoDB Atlas 6/Performance|Resident Memory|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=MEMORY\_RESIDENT hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Resident Memory|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=MEMORY\_RESIDENT hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6|Running Servers|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  ("dbexit") or  ( "] waiting for connections on port") or ("transition to" or "Transition to") <br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| if (\_raw matches "\*dbexit\*", "Down",if (\_raw matches "\*Transition to\*", "Up" ,if (\_raw matches "\*] waiting for connections on port\*", "Up", "UnKnown")))  as server\_status<br />\| timeslice 100s<br />\| withtime server\_status <br />\| where (server\_status = "Up")<br />\| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by hostname<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS", "etc/utc") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60)) as since\_mins \| format("%.2f", since\_mins) as since\_minutes<br />\| concat ("Since ", since\_minutes, " minutes") as Remark<br />\| fields - m\_time, since\_mins, since\_minutes <br />\| fields hostname, event\_time, server\_status, remark|
|MongoDB Atlas 6|Running Servers|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs ("dbexit") or  ( "] waiting for connections on port") or ("transition to" or "Transition to") <br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| if (\_raw matches "\*dbexit\*", "Down",if (\_raw matches "\*Transition to\*", "Up" ,if (\_raw matches "\*] waiting for connections on port\*", "Up", "UnKnown")))  as server\_status<br />\| timeslice 100s<br />\| withtime server\_status <br />\| where (server\_status = "Up")<br />\| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by hostname<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS", "etc/utc") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60)) as since\_mins \| format("%.2f", since\_mins) as since\_minutes<br />\| concat ("Since ", since\_minutes, " minutes") as Remark<br />\| fields - m\_time, since\_mins, since\_minutes <br />\| fields hostname, event\_time, server\_status, remark|
|MongoDB Atlas 6/Performance|Scanned Index Keys / Returned Documents Ratio|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=QUERY\_TARGETING\_SCANNED\_PER\_RETURNED hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Scanned Index Keys / Returned Documents Ratio|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=QUERY\_TARGETING\_SCANNED\_PER\_RETURNED hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Scanned Objects / Returned Documents Ratio|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=QUERY\_TARGETING\_SCANNED\_OBJECTS\_PER\_RETURNED hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Scanned Objects / Returned Documents Ratio|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=QUERY\_TARGETING\_SCANNED\_OBJECTS\_PER\_RETURNED hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Operations|Secondary Node(s)|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory={{Logsdatasource}}  is in state<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.hostAndPort","attr.newState" as severity,timestamp,component,context,hostaddressport,state<br />\| parse regex field=hostaddressport "(?\<host\_name\>^.\*(?=:))"<br />\| where component matches "\*REPL\*" and state = "SECONDARY"<br />\| withtime msg <br />\| most\_recent(msg\_withtime) as message by  host\_name,state|
|MongoDB Atlas 6/Operations|Secondary Node(s)|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Replication|\_sourceCategory=Labs/MongoDBAtlas/logs is in state<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.hostAndPort","attr.newState" as severity,timestamp,component,context,hostaddressport,state<br />\| parse regex field=hostaddressport "(?\<host\_name\>^.\*(?=:))"<br />\| where component matches "\*REPL\*" and state = "SECONDARY"<br />\| withtime msg <br />\| most\_recent(msg\_withtime) as message by  host\_name,state|
|MongoDB Atlas 6/Performance|Slow CRUD Operations by Database and Collection|Logs|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns" as severity,timestamp,component,context,database,duration,db\_cmd,collection<br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| min(duration), max(duration), avg(duration), pct(duration, 95), pct(duration, 75) by database,collection,crud\_operation<br />\| where \_duration\_pct\_75 \> \_avg<br />\| format("min: %f\\nmax: %f\\navg: %f\\n75perc: %f\\n95perc: %f", \_min, \_max, \_avg, \_duration\_pct\_75, \_duration\_pct\_95) as stats<br />\| fields -\_min,\_max,\_avg, \_duration\_pct\_95, \_duration\_pct\_75|
|MongoDB Atlas 6/Performance|Slow CRUD Operations by Database and Collection|Logs|MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns" as severity,timestamp,component,context,database,duration,db\_cmd,collection<br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| min(duration), max(duration), avg(duration), pct(duration, 95), pct(duration, 75) by database,collection,crud\_operation<br />\| where \_duration\_pct\_75 \> \_avg<br />\| format("min: %f\\nmax: %f\\navg: %f\\n75perc: %f\\n95perc: %f", \_min, \_max, \_avg, \_duration\_pct\_75, \_duration\_pct\_95) as stats<br />\| fields -\_min,\_max,\_avg, \_duration\_pct\_95, \_duration\_pct\_75|
|MongoDB Atlas 6/Performance|Slow Queries|Logs|MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory=Labs/MongoDBAtlas/logs "Slow query"<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis" as severity,timestamp,component,context,database,duration<br />\| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count|
|MongoDB Atlas 6|Slow Queries|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  "Slow query"<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis" as severity,timestamp,component,context,database,duration<br />\| number(duration)<br />\| where duration \> 100<br />\| count|
|MongoDB Atlas 6/Performance|Slow Queries|Logs|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory={{Logsdatasource}}  "Slow query"<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis" as severity,timestamp,component,context,database,duration<br />\| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count|
|MongoDB Atlas 6|Slow Queries|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs "Slow query"<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis" as severity,timestamp,component,context,database,duration<br />\| number(duration)<br />\| where duration \> 100<br />\| count|
|MongoDB Atlas 6/Performance|Slow Queries by Connection ID|Logs|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns" as severity,timestamp,component,context,database,duration,db\_cmd,collection<br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count by context<br />\| order by \_count desc<br />\| limit 10|
|MongoDB Atlas 6/Performance|Slow Queries by Connection ID|Logs|MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns" as severity,timestamp,component,context,database,duration,db\_cmd,collection<br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| number(duration)<br />\| where duration \> 100<br />\| count by context<br />\| order by \_count desc<br />\| limit 10|
|MongoDB Atlas 6/Performance|Slow Queries by Database|Logs|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory={{Logsdatasource}}  "Slow query"<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis" as severity,timestamp,component,context,database,duration<br />\| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count by database<br />\| order by \_count desc<br />\| limit 10|
|MongoDB Atlas 6/Performance|Slow Queries by Database|Logs|MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory=Labs/MongoDBAtlas/logs "Slow query"<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis" as severity,timestamp,component,context,database,duration<br />\| number(duration)<br />\| where duration \> "{{duration}}"<br />\| count by database<br />\| order by \_count desc<br />\| limit 10|
|MongoDB Atlas 6/Performance|Slow Queries Over Time by Type|Logs|MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns" as severity,timestamp,component,context,database,duration,db\_cmd,collection<br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| number(duration)<br />\| where duration \> "{{duration}}"<br />\| timeslice 1h<br />\| count by \_timeslice, crud\_operation<br />\| transpose row \_timeslice column crud\_operation|
|MongoDB Atlas 6/Performance|Slow Queries Over Time by Type|Logs|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas  - Slow Queries |\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx","attr.command.\$db","attr.durationMillis","attr.command","attr.ns" as severity,timestamp,component,context,database,duration,db\_cmd,collection<br />\| where component matches "\*COMMAND\*"<br />\| parse regex field=db\_cmd "(?\<crud\_operation\>^[^:]\*)"<br />\| parse regex field=crud\_operation "(?\<crud\_operation\>(?\<=\\").\*(?=\\"))"<br />\| where (crud\_operation matches "\*find\*" or crud\_operation matches "\*insert\*" or crud\_operation matches "\*remove\*" or crud\_operation matches "\*delete\*" or crud\_operation matches "\*update\*" or crud\_operation matches "\*get\*" or crud\_operation matches "\*aggregate\*" or crud\_operation matches "\*replace\*" or crud\_operation matches "\*save\*" or crud\_operation matches "\*bulkWrite\*")<br />\| number(duration)<br />\| where duration \> "{{duration}}"<br />\| timeslice 1h<br />\| count by \_timeslice, crud\_operation<br />\| transpose row \_timeslice column crud\_operation|
|MongoDB Atlas 6/Operations|Socket Excpetions|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs ("socket exception" or exception or "SocketException")<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| count by timestamp,project\_id,cluster\_name,hostname,severity,component,context,msg, \_sourceHost<br />\| fields - \_count|
|MongoDB Atlas 6/Operations|Socket Excpetions|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  ("socket exception" or exception or "SocketException")<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| count by timestamp,project\_id,cluster\_name,hostname,severity,component,context,msg, \_sourceHost<br />\| fields - \_count|
|MongoDB Atlas 6|Stopped Servers|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  ("dbexit" or  ( "] waiting for connections on port") or "transition to") <br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| if (\_raw matches "\*dbexit\*", "Down",if (\_raw matches "\*Transition to\*", "Up" ,if (\_raw matches "\*] waiting for connections on port\*", "Up", "UnKnown")))  as server\_status<br />\| timeslice 100s<br />\| withtime server\_status <br />\| where (server\_status = "UnKnown") <br />\| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by hostname<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS", "UTC") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60)) as since\_mins \| format("%.2f", since\_mins) as since\_minutes<br />\| concat ("Since ", since\_minutes, " minutes") as Remark<br />\| where !(server\_status = "Up")<br />\| fields - m\_time, since\_mins, since\_minutes <br />\| fields hostname, event\_time, server\_status, remark|
|MongoDB Atlas 6|Stopped Servers|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs ("dbexit" or  ( "] waiting for connections on port") or "transition to") <br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| if (\_raw matches "\*dbexit\*", "Down",if (\_raw matches "\*Transition to\*", "Up" ,if (\_raw matches "\*] waiting for connections on port\*", "Up", "UnKnown")))  as server\_status<br />\| timeslice 100s<br />\| withtime server\_status <br />\| where (server\_status = "UnKnown") <br />\| withtime \_messagetime<br />\| most\_recent(server\_status\_withtime) as server\_status, most\_recent(\_messagetime\_withtime) as m\_time by hostname<br />\| formatDate(fromMillis(m\_time), "MM-dd-yyyy HH:mm:ss:SSS", "UTC") as event\_time<br />\| ((toMillis(now())-m\_time)/(1000\*60)) as since\_mins \| format("%.2f", since\_mins) as since\_minutes<br />\| concat ("Since ", since\_minutes, " minutes") as Remark<br />\| where !(server\_status = "Up")<br />\| fields - m\_time, since\_mins, since\_minutes <br />\| fields hostname, event\_time, server\_status, remark|
|MongoDB Atlas 6/Operations|Summary of Errors|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory={{Logsdatasource}}  SHARDING (error or fail or exception)<br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where component matches "\*SHARDING\*" <br />\| count as count, last(timestamp) as last\_date by project\_id, cluster\_name, hostname, severity,component,context,msg, \_sourceHost<br />|
|MongoDB Atlas 6/Operations|Summary of Errors|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory=Labs/MongoDBAtlas/logs SHARDING (error or fail or exception)<br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where component matches "\*SHARDING\*" <br />\| count as count, last(timestamp) as last\_date by project\_id, cluster\_name, hostname, severity,component,context,msg, \_sourceHost<br />|
|MongoDB Atlas 6/Operations|Summary of Warnings|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory=Labs/MongoDBAtlas/logs SHARDING <br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where component matches "\*SHARDING\*" and severity = "W" <br />\| count as count, last(timestamp) as last\_date by project\_id, cluster\_name, hostname, severity,component,context,msg, \_sourceHost<br />|
|MongoDB Atlas 6/Operations|Summary of Warnings|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory={{Logsdatasource}}  SHARDING <br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where component matches "\*SHARDING\*" and severity = "W" <br />\| count as count, last(timestamp) as last\_date by project\_id, cluster\_name, hostname, severity,component,context,msg, \_sourceHost<br />|
|MongoDB Atlas 6/Operations|Threat Intel by Remote IP|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users", "result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=remote\_ip<br />\| where type="ip\_address" and malicious\_confidence ="high"<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as threat\_last\_updated <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| fields -\_count|
|MongoDB Atlas 6/Operations|Threat Intel by Remote IP|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")<br />\| json "atype", "local.ip", "remote.ip", "users", "result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=remote\_ip<br />\| where type="ip\_address" and malicious\_confidence ="high"<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as threat\_last\_updated <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| fields -\_count|
|MongoDB Atlas 6/Operations|Threat Intel Outlier by Remote IP|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory={{Logsdatasource}}  AND (\_sourceName="mongodb-audit-log.gz" OR \_sourceName="mongos-audit-log.gz")\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by \_timeslice, remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=remote\_ip<br />\| where type="ip\_address" and malicious\_confidence ="high"<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as threat\_last\_updated <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| sum(\_count) as count by \_timeslice<br />\| outlier count|
|MongoDB Atlas 6/Operations|Threat Intel Outlier by Remote IP|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory=Labs/MongoDBAtlas/logs AND (\_source="mongodb-audit-log.gz" OR \_source="mongos-audit-log.gz")\| json "atype", "local.ip", "remote.ip", "users","result", "project\_id", "hostname", "cluster\_name" as atype, local\_ip, remote\_ip, users, result, project\_id, hostname, cluster\_name<br />\| timeslice 1h<br />\| count by \_timeslice, remote\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence, threat from sumo://threat/cs on threat=remote\_ip<br />\| where type="ip\_address" and malicious\_confidence ="high"<br />\| json field=raw "malware\_families[\*]" as threat\_malware\_families nodrop<br />\| json field=raw "last\_updated" as last\_updated nodrop<br />\| formatDate(fromseconds(last\_updated), "MM-dd-yyyy") as threat\_last\_updated <br />\| json field=raw "labels[\*].name" as label\_name nodrop<br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| sum(\_count) as count by \_timeslice<br />\| outlier count|
|MongoDB Atlas 6/Operations|Timeout Events|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  (Timeout or timeout) not ("SocketException")<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| count by timestamp,project\_id, hostname, cluster\_name, severity,component,context,msg<br />\| fields - \_count|
|MongoDB Atlas 6/Operations|Timeout Events|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs (Timeout or timeout) not ("SocketException")<br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| count by timestamp,project\_id, hostname, cluster\_name, severity,component,context,msg<br />\| fields - \_count|
|MongoDB Atlas 6/Security|Total Alerts by Day|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory={{Logsdatasource}}  alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| count(id)|
|MongoDB Atlas 6/Security|Total Alerts by Day|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Alerts|\_sourceCategory=Labs/MongoDBAtlas/logs alertConfigId<br />\| json "id","updated","metricName","status", "groupId","hostnameAndPort","typeName","replicaSetName","links","clusterName" as id,updated,metricName,status, project\_id,hostnameAndPort,typeName,replicaSetName,links,cluster\_name nodrop<br />\| count(id)|
|MongoDB Atlas 6/Security|Total Events|Logs|MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory=Labs/MongoDBAtlas/logs and (\_source=events OR \_source=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| count(id)|
|MongoDB Atlas 6/Security|Total Events|Logs|Installed Apps/MongoDB Atlas 6/Security/MongoDB Atlas - Events|\_sourceCategory={{Logsdatasource}}  and (\_sourceName=events OR \_sourceName=orgevents)<br />\| json "id", "groupId", "orgId", "eventTypeName", "metricName", "links", "hostname", "port", "replicaSetName", "created", "username", "remoteAddress" as id, project\_id, org\_id, eventTypeName, metricName, links, hostname, port, replicaSetName, created, username, remoteAddress nodrop<br />\| count(id)|
|MongoDB Atlas 6/Performance|Total Open Cursors|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory={{Metricsdatasource}}   metric=CURSORS\_TOTAL\_OPEN hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6/Performance|Total Open Cursors|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=CURSORS\_TOTAL\_OPEN hostId={{hostid}} projectId={{projectid}} processId={{processid}} cluster\_name={{cluster\_name}}|
|MongoDB Atlas 6|Unreachable Nodes|Logs|Installed Apps/MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory={{Logsdatasource}}  (NETWORK OR ASIO) (reach OR connect)<br />\| json "t.\$date","s","c","ctx","attr.error.codeName","attr.error.errmsg" as timestamp,severity,component,context,errorName,errorMessage<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where (component matches "\*NETWORK\*" or component matches "\*ASIO\*") and (errorName matches "\*HostUnreachable\*")<br />\| hostname as from\_node<br />\| parse regex field=errorMessage "(?\<dest\_node\>(?\<=server ).\*(?=,))" nodrop<br />\| last(msg) by project\_id, cluster\_name, from\_node, dest\_node<br />\| if (\_last matches "Successfully\*", 1, 0) as isreachable<br />\| where isreachable = 0<br />\| \_last as message<br />\| fields -isreachable,\_last|
|MongoDB Atlas 6/Operations|Unreachable Nodes|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory=Labs/MongoDBAtlas/logs (NETWORK OR ASIO) (reach OR connect)<br />\| json "t.\$date","s","c","ctx","attr.error.codeName","attr.error.errmsg" as timestamp,severity,component,context,errorName,errorMessage<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where (component matches "\*NETWORK\*" or component matches "\*ASIO\*") and (errorName matches "\*HostUnreachable\*")<br />\| hostname as from\_node<br />\| parse regex field=errorMessage "(?\<dest\_node\>(?\<=server ).\*(?=,))" nodrop<br />\| last(msg) by project\_id, cluster\_name, from\_node, dest\_node<br />\| if (\_last matches "Successfully\*", 1, 0) as isreachable<br />\| where isreachable = 0<br />\| \_last as message<br />\| fields -isreachable,\_last|
|MongoDB Atlas 6|Unreachable Nodes|Logs|MongoDB Atlas 6/MongoDB Atlas - Overview|\_sourceCategory=Labs/MongoDBAtlas/logs (NETWORK OR ASIO) (reach OR connect)<br />\| json "t.\$date","s","c","ctx","attr.error.codeName","attr.error.errmsg" as timestamp,severity,component,context,errorName,errorMessage<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where (component matches "\*NETWORK\*" or component matches "\*ASIO\*") and (errorName matches "\*HostUnreachable\*")<br />\| hostname as from\_node<br />\| parse regex field=errorMessage "(?\<dest\_node\>(?\<=server ).\*(?=,))" nodrop<br />\| last(msg) by project\_id, cluster\_name, from\_node, dest\_node<br />\| if (\_last matches "Successfully\*", 1, 0) as isreachable<br />\| where isreachable = 0<br />\| \_last as message<br />\| fields -isreachable,\_last|
|MongoDB Atlas 6/Operations|Unreachable Nodes|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Logins and Connections|\_sourceCategory={{Logsdatasource}}  (NETWORK OR ASIO) (reach OR connect)<br />\| json "t.\$date","s","c","ctx","attr.error.codeName","attr.error.errmsg" as timestamp,severity,component,context,errorName,errorMessage<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where (component matches "\*NETWORK\*" or component matches "\*ASIO\*") and (errorName matches "\*HostUnreachable\*")<br />\| hostname as from\_node<br />\| parse regex field=errorMessage "(?\<dest\_node\>(?\<=server ).\*(?=,))" nodrop<br />\| last(msg) by project\_id, cluster\_name, from\_node, dest\_node<br />\| if (\_last matches "Successfully\*", 1, 0) as isreachable<br />\| where isreachable = 0<br />\| \_last as message<br />\| fields -isreachable,\_last|
|MongoDB Atlas 6/Operations|Warnings|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("W")<br />\| count |
|MongoDB Atlas 6/Operations|Warnings|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory={{Logsdatasource}}  SHARDING<br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where component matches "\*SHARDING\*" and severity = "W" <br />\| count|
|MongoDB Atlas 6/Operations|Warnings|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Sharding|\_sourceCategory=Labs/MongoDBAtlas/logs SHARDING<br />\| json "t.\$date","s","c","ctx" as timestamp,severity,component,context<br />\| json "msg","project\_id","hostname","cluster\_name"<br />\| where component matches "\*SHARDING\*" and severity = "W" <br />\| count|
|MongoDB Atlas 6/Operations|Warnings|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("W")<br />\| count |
|MongoDB Atlas 6/Operations|Warnings by Component|Logs|MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory=Labs/MongoDBAtlas/logs <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("W")<br />\| count by component|
|MongoDB Atlas 6/Operations|Warnings by Component|Logs|Installed Apps/MongoDB Atlas 6/Operations/MongoDB Atlas - Errors and Warnings|\_sourceCategory={{Logsdatasource}}  <br />\| json "msg","hostname","project\_id","cluster\_name" <br />\| json "s","t.\$date","c","ctx" as severity,timestamp,component,context<br />\| where severity in ("W")<br />\| count by component|
|MongoDB Atlas 6/Performance|Write Operations|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}    (metric=OPCOUNTER\_INSERT OR metric=OPCOUNTER\_UPDATE OR metric=OPCOUNTER\_DELETE) hostid={{hostid}} projectid={{projectid}} processid={{processid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Write Operations|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics   (metric=OPCOUNTER\_INSERT OR metric=OPCOUNTER\_UPDATE OR metric=OPCOUNTER\_DELETE) hostid={{hostid}} projectid={{projectid}} processid={{processid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Write Operations Execution Times|Metrics|Installed Apps/MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory={{Metricsdatasource}}   metric=OP\_EXECUTION\_TIME\_WRITES hostid={{hostid}} projectid={{projectid}} processid={{processid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|
|MongoDB Atlas 6/Performance|Write Operations Execution Times|Metrics|MongoDB Atlas 6/Performance/MongoDB Atlas - Cluster Metrics|\_sourceCategory=Labs/MongoDBAtlas/metrics  metric=OP\_EXECUTION\_TIME\_WRITES hostid={{hostid}} projectid={{projectid}} processid={{processid}} cluster\_name={{cluster\_name}}\| sum by cluster\_name|

