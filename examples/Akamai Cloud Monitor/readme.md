# Akamai Cloud Monitor
## Sumo Logic App For: Akamai Cloud Monitor
The Sumo Logic Application for Akamai Cloud Monitor allows you to analyze and correlate Akamai data with origin data in order to improve availability and performance of applications, improve end-user experience, gain deeper user insights, and enforce rigorous security controls. The app uses predefined searches and dashboards that provide visibility into your environment for real time analysis of overall usage. 
Docs Link: [Akamai Cloud Monitor](https://help.sumologic.com/?cid=5026)

## Searches

### Log Searches

- **90%-ile Latency**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **90%-ile Latency**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **90%-ile Latency**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **90%-ile Latency**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **Attacks (Individual Warn/Deny Events)**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Web Application Firewall - Attacks 
- **Cache Offload Percentage Over Time**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service 
- **Cache Performance**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service 
- **Cacheable Content Download Times**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service 
- **Countries**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors 
- **Countries**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview 
- **Denials by Host**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security 
- **Download Performance Hotspots - Avg Download Above 300 by Country**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service 
- **Download Performance Hotspots - Avg Download Above 300 by Country**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview 
- **Error Rate 4xx by Code**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **Error Rate 4xx by Code**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **Error Rate 5xx by Code**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **Error Rate 5xx by Code**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **Map (Unique Visitors)**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors 
- **Map (Unique Visitors)**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview 
- **Median**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **Median**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **Median Latency**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **Median Latency**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **Origin Download Times Histogram**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service 
- **Overall Request Volume**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors 
- **Performance Stats by Country**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service 
- **Slowest URLs**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **Slowest URLs**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **Top 404-Causing URLs**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **Top 404-Causing URLs**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview 
- **Top 404-Causing URLs**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **Top Deny Rules**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security 
- **Top Deny URLs**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security 
- **Top Error-Causing URLs**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance 
- **Top Error-Causing URLs**: from Dashboard: Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New 
- **Top Error-Causing URLs**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview 
- **Top Requests**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors 
- **Top Warn Rules**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security 
- **Top Warn URLs**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security 
- **UA Over Time**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors 
- **User Agents**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors 
- **WAF-Warn Requests per Host**: from Dashboard: Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Akamai Cloud Monitor|90%-ile Latency|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}}\| parse "\\"netOriginLatency\\":\\"\*\\"" as originLatency, "\\"originIP\\":\\"\*\\"" as originIP<br />\| timeslice 1m<br />\| pct(originLatency, 90) as nintieth by originIP, \_timeslice<br />\| transpose row \_timeslice column originIP|
|Akamai Cloud Monitor|90%-ile Latency|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}}\| parse "\\"netOriginLatency\\":\\"\*\\"" as originLatency, "\\"fwdHost\\":\\"\*\\"" as fwdHost<br />\| timeslice 1m<br />\| pct(originLatency, 90) as nintieth by fwdHost, \_timeslice<br />\| transpose row \_timeslice column fwdHost|
|Akamai Cloud Monitor|90%-ile Latency|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\*\| parse "\\"netOriginLatency\\":\\"\*\\"" as originLatency, "\\"originIP\\":\\"\*\\"" as originIP<br />\| timeslice 1m<br />\| pct(originLatency, 90) as nintieth by originIP, \_timeslice<br />\| transpose row \_timeslice column originIP|
|Akamai Cloud Monitor|90%-ile Latency|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\*\| parse "\\"netOriginLatency\\":\\"\*\\"" as originLatency, "\\"fwdHost\\":\\"\*\\"" as fwdHost<br />\| timeslice 1m<br />\| pct(originLatency, 90) as nintieth by fwdHost, \_timeslice<br />\| transpose row \_timeslice column fwdHost|
|Akamai Cloud Monitor|Attacks (Individual Warn/Deny Events)|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Web Application Firewall - Attacks|\_sourceCategory={{\_sourceCategory}}\| parse "\\"warnRules\\":\\"\*\\"" as warn, "\\"denyRules\\":\\"\*\\"" as deny, "\\"cliIP\\":\\"\*\\"" as cliip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = cliip<br />\| where warn != "" OR deny != ""<br />\| count by latitude, longitude<br />|
|Akamai Cloud Monitor|Cache Offload Percentage Over Time|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service|\_sourceCategory={{\_sourceCategory}} cacheStatus<br />\| parse "\\"cacheStatus\\":\\"\*\\"" as status<br />\| if (status="1" OR status="2",1,0) as cache\_offload<br />\| timeslice 5m<br />\| count as totalCount, sum(cache\_offload) as cache\_offload by \_timeslice <br />\| toInt((cache\_offload/totalCount)\*100) as CacheOffloadPct \| fields -totalCount,cache\_offload|
|Akamai Cloud Monitor|Cache Performance|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service|\_sourceCategory={{\_sourceCategory}} cacheStatus<br />\| parse "\\"cacheStatus\\":\\"\*\\"" as status<br />\| where !(status="")<br />\| if(status="0", "0 - Non cacheable", if(status="1" OR status="2", "1/2 - Cache Hit", if(status="3", "3 - Cache Miss", ""))) as cachestatus<br />\| count by cachestatus|
|Akamai Cloud Monitor|Cacheable Content Download Times|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service|\_sourceCategory={{\_sourceCategory}} netPerf downloadTime cacheStatus<br />\| parse "\\"cacheStatus\\":\\"\*\\"" as cachestatus, "\\"downloadTime\\":\\"\*\\"" as result<br />\| toInt(cachestatus) as cachestatus<br />\| toInt(result) as result<br />\| where  cachestatus \> 0<br />\| floor(result/100) \* 100 as Response\_Time<br />\| if (Response\_time \> 2000, "2001", Response\_Time) as Response\_time<br />\| count as Requests by Response\_Time \| sort by + Response\_Time<br />\| if (Response\_time \> 2000, "\>2000", toString(Response\_Time)) as Response\_time|
|Akamai Cloud Monitor|Countries|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors|\_sourceCategory={{\_sourceCategory}} <br />\| parse "\\"bytes\\":\\"\*\\"" as bytes, "\\"edgeIP\\":\\"\*\\"" as edgeip, "\\"country\\":\\"\*\\"" as country, "\\"cookie\\":\\"\*\\"" as cookie<br />\| count\_distinct(cookie) by country \|sort \_count\_distinct|
|Akamai Cloud Monitor|Countries|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview|\_sourceCategory={{\_sourceCategory}} <br />\| parse "\\"bytes\\":\\"\*\\"" as bytes, "\\"edgeIP\\":\\"\*\\"" as edgeip, "\\"country\\":\\"\*\\"" as country, "\\"cookie\\":\\"\*\\"" as cookie<br />\| count\_distinct(cookie) by country \|sort \_count\_distinct|
|Akamai Cloud Monitor|Denials by Host|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security|\_sourceCategory={{\_sourceCategory}} waf denyRules reqHost<br />\| parse "\\"denyRules\\":\\"\*\\"" as deny, "\\"reqHost\\":\\"\*\\"" as host<br />\| where deny != ""<br />\| timeslice 1m<br />\| count by host, \_timeslice<br />\| transpose row \_timeslice column host|
|Akamai Cloud Monitor|Download Performance Hotspots - Avg Download Above 300 by Country|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service|\_sourceCategory={{\_sourceCategory}} cliIP downloadTime country\|  parse "\\"cliIP\\":\\"\*\\"" as ip \| parse "\\"downloadTime\\":\\"\*\\"" as downloadtime\| parse "\\"country\\":\\"\*\\"" as country\_code<br />\| lookup latitude, longitude from geo://location on ip=ip<br />\| count, avg(downloadTime) as avg\_download\_time by country\_code, latitude, longitude \| round(avg\_download\_time)<br />\| where avg\_download\_time \> 300 and \_count \> 1\| sort by - avg\_download\_time<br />\| fields latitude, longitude, \_count|
|Akamai Cloud Monitor|Download Performance Hotspots - Avg Download Above 300 by Country|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview|\_sourceCategory={{\_sourceCategory}} cliIP downloadTime country\|  parse "\\"cliIP\\":\\"\*\\"" as ip \| parse "\\"downloadTime\\":\\"\*\\"" as downloadtime\| parse "\\"country\\":\\"\*\\"" as country\_code<br />\| lookup latitude, longitude from geo://location on ip=ip<br />\| count, avg(downloadTime) as avg\_download\_time by country\_code, latitude, longitude \| round(avg\_download\_time)<br />\| where avg\_download\_time \> 300 and \_count \> 1\| sort by - avg\_download\_time<br />\| fields latitude, longitude, \_count|
|Akamai Cloud Monitor|Error Rate 4xx by Code|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}} 4??<br />\| parse "\\"reqMethod\\":\\"\*\\"" as method, "\\"status\\":\\"\*\\"" as status, "\\"fwdHost\\":\\"\*\\"" as origin<br />\| where status matches "4\*" and method="GET"<br />\| timeslice 10m as \_timeslice<br />\| count by \_timeslice, status<br />\| transpose row \_timeslice column status|
|Akamai Cloud Monitor|Error Rate 4xx by Code|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\* 4??<br />\| parse "\\"reqMethod\\":\\"\*\\"" as method, "\\"status\\":\\"\*\\"" as status, "\\"fwdHost\\":\\"\*\\"" as origin<br />\| where status matches "4\*" and method="GET"<br />\| timeslice 10m as \_timeslice<br />\| count by \_timeslice, status<br />\| transpose row \_timeslice column status|
|Akamai Cloud Monitor|Error Rate 5xx by Code|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}} (500 or 501 or 502 or 503 or 504 or 505)<br />\| parse "\\"reqMethod\\":\\"\*\\"" as method, "\\"status\\":\\"\*\\"" as status, "\\"fwdHost\\":\\"\*\\"" as origin<br />\| where status in ("500", "501", "502", "503", "504", "505") and method="GET"<br />\| timeslice 10m as \_timeslice<br />\| count by \_timeslice, status<br />\| transpose row \_timeslice column status<br />|
|Akamai Cloud Monitor|Error Rate 5xx by Code|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\* (500 or 501 or 502 or 503 or 504 or 505)<br />\| parse "\\"reqMethod\\":\\"\*\\"" as method, "\\"status\\":\\"\*\\"" as status, "\\"fwdHost\\":\\"\*\\"" as origin<br />\| where status in ("500", "501", "502", "503", "504", "505") and method="GET"<br />\| timeslice 10m as \_timeslice<br />\| count by \_timeslice, status<br />\| transpose row \_timeslice column status<br />|
|Akamai Cloud Monitor|Map (Unique Visitors)|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors|\_sourceCategory={{\_sourceCategory}}\| parse "\\"cliIP\\":\\"\*\\"" as cliip<br />\| lookup latitude, longitude, country\_code,country\_name,city from geo://location on ip = cliip<br />\| count(cliip) as \_count by city,country\_name|
|Akamai Cloud Monitor|Map (Unique Visitors)|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview|\_sourceCategory={{\_sourceCategory}} \| parse "\\"cliIP\\":\\"\*\\"" as cliip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = cliip<br />\| count\_distinct(cliip) as \_count by latitude, longitude|
|Akamai Cloud Monitor|Median|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\*\| parse "\\"netOriginLatency\\":\\"\*\\"" as originLatency, "\\"originIP\\":\\"\*\\"" as originIP<br />\| timeslice 1m<br />\| pct(originLatency, 50) as median by originIP, \_timeslice<br />\| transpose row \_timeslice column originIP|
|Akamai Cloud Monitor|Median|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}}\| parse "\\"netOriginLatency\\":\\"\*\\"" as originLatency, "\\"originIP\\":\\"\*\\"" as originIP<br />\| timeslice 1m<br />\| pct(originLatency, 50) as median by originIP, \_timeslice<br />\| transpose row \_timeslice column originIP|
|Akamai Cloud Monitor|Median Latency|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}}\| parse "\\"netOriginLatency\\":\\"\*\\"" as originLatency, "\\"fwdHost\\":\\"\*\\"" as fwdHost<br />\| timeslice 1m<br />\| pct(originLatency, 50) as median by fwdHost, \_timeslice<br />\| transpose row \_timeslice column fwdHost|
|Akamai Cloud Monitor|Median Latency|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\*\| parse "\\"netOriginLatency\\":\\"\*\\"" as originLatency, "\\"fwdHost\\":\\"\*\\"" as fwdHost<br />\| timeslice 1m<br />\| pct(originLatency, 50) as median by fwdHost, \_timeslice<br />\| transpose row \_timeslice column fwdHost|
|Akamai Cloud Monitor|Origin Download Times Histogram|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service|\_sourceCategory={{\_sourceCategory}} netPerf downloadTime cacheStatus<br />\| parse "\\"cacheStatus\\":\\"\*\\"" as cachestatus, "\\"downloadTime\\":\\"\*\\"" as result<br />\| toInt(cachestatus) as cachestatus<br />\| toInt(result) as result<br />\| where  cachestatus = 3<br />\| floor(result/100) \* 100 as Response\_Time<br />\| if (Response\_time \> 2000, "2001", Response\_Time) as Response\_time<br />\| count as Requests by Response\_Time \| sort by + Response\_Time<br />\| if (Response\_time \> 2000, "\>2000", toString(Response\_Time)) as Response\_time|
|Akamai Cloud Monitor|Overall Request Volume|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors|\_sourceCategory={{\_sourceCategory}}\| timeslice 5m <br />\| count by \_timeslice<br />|
|Akamai Cloud Monitor|Performance Stats by Country|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Quality of Service|\_sourceCategory={{\_sourceCategory}} cliIP downloadTime country<br />\| parse "\\"cliIP\\":\\"\*\\"" as ip <br />\| parse "\\"downloadTime\\":\\"\*\\"" as downloadtime\| parse "\\"country\\":\\"\*\\"" as country\_code<br />\| toUpperCase(country\_code) as country\_code<br />\| count as numhits, pct(downloadTime, 5) as pct\_5, pct(downloadTime, 25) as lowerq, pct(downloadTime, 50) as median, pct(downloadTime, 75) as upperq, pct(downloadTime, 95) as pct\_95,avg(downloadTime) as average by country\_code<br />\| round(pct\_5) \| round(lowerq)\| round(median)\| round(upperq)\| round(pct\_95)\| round(average)<br />\| sort by average|
|Akamai Cloud Monitor|Slowest URLs|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\*\| parse "\\"reqPath\\":\\"\*\\"" as path, "\\"netOriginLatency\\":\\"\*\\"" as latency<br />\| urldecode(path) as path<br />\| max(latency) as max\_latency by path<br />\| sort by max\_latency<br />\| limit 10|
|Akamai Cloud Monitor|Slowest URLs|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}}\| parse "\\"reqPath\\":\\"\*\\"" as path, "\\"netOriginLatency\\":\\"\*\\"" as latency<br />\| urldecode(path) as path<br />\| max(latency) as max\_latency by path<br />\| sort by max\_latency<br />\| limit 10|
|Akamai Cloud Monitor|Top 404-Causing URLs|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\*\| parse "\\"reqPath\\":\\"\*\\"" as path, "\\"status\\":\\"\*\\"" as status<br />\| urldecode(path) as path<br />\| where status = 404<br />\| count as errors by path \| sort by errors \| limit 25|
|Akamai Cloud Monitor|Top 404-Causing URLs|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview|\_sourceCategory={{\_sourceCategory}}\| parse "\\"reqPath\\":\\"\*\\"" as path, "\\"status\\":\\"\*\\"" as status<br />\| urldecode(path) as path<br />\| where status = 404<br />\| count as errors by path \| sort by errors \| limit 25|
|Akamai Cloud Monitor|Top 404-Causing URLs|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}}\| parse "\\"reqPath\\":\\"\*\\"" as path, "\\"status\\":\\"\*\\"" as status<br />\| urldecode(path) as path<br />\| where status = 404<br />\| count as errors by path \| sort by errors \| limit 25|
|Akamai Cloud Monitor|Top Deny Rules|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security|\_sourceCategory={{\_sourceCategory}} !"\\"denyRules\\":\\"\\""<br />\| parse "\\"denyRules\\":\\"\*\\"" as deny \|urldecode(deny)<br />\| where deny != ""<br />\| count as deny\_count by deny\| sort by deny\_count|
|Akamai Cloud Monitor|Top Deny URLs|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security|\_sourceCategory={{\_sourceCategory}}\| parse "\\"denyRules\\":\\"\*\\"" as deny, "\\"reqPath\\":\\"\*\\"" as path<br />\| urldecode(path) as path<br />\| where deny != ""<br />\| count as deny\_count by path<br />\| total deny\_count<br />\| deny\_count/\_total\*100 as percent<br />\| fields - \_total<br />\| sort by percent<br />\| limit 10|
|Akamai Cloud Monitor|Top Error-Causing URLs|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance|\_sourceCategory={{\_sourceCategory}} 50?<br />\| parse "\\"reqPath\\":\\"\*\\"" as path, "\\"status\\":\\"\*\\"" as status<br />\| urldecode(path) as path<br />\| where status \> 499<br />\| where status \< 600<br />\| count as errors by path<br />\| sort by errors|
|Akamai Cloud Monitor|Top Error-Causing URLs|Logs|Akamai Cloud Monitor/Akamai Cloud Monitor - Origin Performance - New|\_sourceCategory = Labs/Akamai\* 50?<br />\| parse "\\"reqPath\\":\\"\*\\"" as path, "\\"status\\":\\"\*\\"" as status<br />\| urldecode(path) as path<br />\| where status \> 499<br />\| where status \< 600<br />\| count as errors by path<br />\| sort by errors|
|Akamai Cloud Monitor|Top Error-Causing URLs|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Overview|\_sourceCategory={{\_sourceCategory}} 50?<br />\| parse "\\"reqPath\\":\\"\*\\"" as path, "\\"status\\":\\"\*\\"" as status<br />\| urldecode(path) as path<br />\| where status \> 499<br />\| where status \< 600<br />\| count as errors by path<br />\| sort by errors|
|Akamai Cloud Monitor|Top Requests|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors|\_sourceCategory={{\_sourceCategory}} reqPath !"\\"reqPath\\":\\"%2f\\"" !".js" !".css" !".png" !".jpg" !".cgi" !".xml" !".ico"  !".gif"  !".csv" !".swf"  !".tiff" !".tif"\| urldecode(\_raw) <br />\|  parse "\\"reqPath\\":\\"\*\\"" as reqpath \| count\_frequent(reqpath) \| sort by \_approxcount \| limit 20|
|Akamai Cloud Monitor|Top Warn Rules|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security|\_sourceCategory={{\_sourceCategory}} !"\\"warnRules\\":\\"\\""<br />\| parse "\\"warnRules\\":\\"\*\\"" as warn \|urldecode(warn)<br />\| parse regex field=warn "(?\<warn\_rule\>[\\w-]+)" multi<br />\| where warn\_rule != ""<br />\| count as %"Count" by warn\_rule \| sort by count|
|Akamai Cloud Monitor|Top Warn URLs|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security|\_sourceCategory={{\_sourceCategory}} waf warnRules reqPath<br />\| parse "\\"warnRules\\":\\"\*\\"" as warning\_id, "\\"reqPath\\":\\"\*\\"" as path \| urldecode(path)<br />\| where warning\_id != ""<br />\| count as warn\_count by path<br />\| total warn\_count<br />\| warn\_count/\_total\*100 as percent<br />\| fields - \_total<br />\| sort by percent<br />\| limit 10|
|Akamai Cloud Monitor|UA Over Time|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors|\_sourceCategory={{\_sourceCategory}} <br />\| parse "\\"UA\\":\\"\*\\"" as ua \| timeslice 1m<br />\| urldecode(ua) as agent<br />\| count by agent, \_timeslice//,evolution,version<br />\| transpose row \_timeslice column agent|
|Akamai Cloud Monitor|User Agents|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Visitors|\_sourceCategory={{\_sourceCategory}} <br />\| parse "\\"UA\\":\\"\*\\"" as ua<br />\| urldecode(ua) as agent<br />\| count by agent \| sort \_count|
|Akamai Cloud Monitor|WAF-Warn Requests per Host|Logs|Installed Apps/Akamai Cloud Monitor/Akamai Cloud Monitor - Security|\_sourceCategory={{\_sourceCategory}} waf warnRules reqHost<br />\| parse "\\"warnRules\\":\\"\*\\"" as warn, "\\"reqHost\\":\\"\*\\"" as host<br />\| where warn != ""<br />\| timeslice 1m <br />\| count by \_timeslice, host<br />\| transpose row \_timeslice column host<br />|

