# Google BigQuery
## Sumo Logic App For: Google BigQuery
The Sumo Logic app for Google BigQuery helps you monitor data and activity in your BigQuery data warehouse. The preconfigured dashboards provide insight into the projects, operations, queries, user management operations, user activities, and billed GBs in BigQuery.
Docs Link: [Google BigQuery](https://help.sumologic.com/?cid=22671)

## Searches

### Log Searches

- **Authorization Failures Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Authorization Failures Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Billed GB by User Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Billed GB by User Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Billed GB Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Billed GB Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Billed GB, Latency (s), Errors Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Billed GB, Latency (s), Errors Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Dataset Service Operation Error Outliers**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Dataset Service Operation Error Outliers**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Dataset Service Operations Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Dataset Service Operations Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Errors by User Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Errors by User Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Errors Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Errors Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Failed Operation Locations**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Failed Operation Locations**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Google BigQuery - Management Operation Errors by Project**: from Search: Installed Apps/Google BigQuery/Google BigQuery - Management Operation Errors by Project 
- **Google BigQuery - Management Operation Errors by Project**: from Search: Google BigQuery/Google BigQuery - Management Operation Errors by Project 
- **Google BigQuery - Management Operations by Project**: from Search: Installed Apps/Google BigQuery/Google BigQuery - Management Operations by Project 
- **Google BigQuery - Management Operations by Project**: from Search: Google BigQuery/Google BigQuery - Management Operations by Project 
- **Google BigQuery - Query Statistics by Project**: from Search: Installed Apps/Google BigQuery/Google BigQuery - Query Statistics by Project 
- **Google BigQuery - Query Statistics by Project**: from Search: Google BigQuery/Google BigQuery - Query Statistics by Project 
- **Latency (s) by Users Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Latency (s) by Users Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Latency (s) Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Latency (s) Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Location of Authorization Failures**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Location of Authorization Failures**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Location of Failed Executions**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Location of Failed Executions**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Location of Query Requests**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Location of Query Requests**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Location of Users Executing Queries**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Location of Users Executing Queries**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Location of Users With Errors**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Location of Users With Errors**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Operation Failure Percentage**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Operation Failure Percentage**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Operation Failures by Project**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Operation Failures by Project**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Operations**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Operations**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Operations Breakdown**: from Dashboard: Google BigQuery/Google BigQuery - Overview - New 
- **Operations Breakdown**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Overview 
- **Operations by Project**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Operations by Project**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Operations Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Overview 
- **Operations Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Overview - New 
- **Query Executions by User Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Query Executions by User Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Query Request Locations**: from Dashboard: Google BigQuery/Google BigQuery - Overview - New 
- **Query Request Locations**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Overview 
- **Query Statistics by Project**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Query Statistics by Project**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Recent Authorization Failures**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Recent Authorization Failures**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Recent Operation Failures**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Recent Operation Failures**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Recent Query Failures**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Recent Query Failures**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Recent Query Failures by User**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Recent Query Failures by User**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Table Service Operation Error Outliers**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Table Service Operation Error Outliers**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Table Service Operations Over Time**: from Dashboard: Google BigQuery/Google BigQuery - Management - New 
- **Table Service Operations Over Time**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Management 
- **Top 10 Queries by Billed GB**: from Dashboard: Google BigQuery/Google BigQuery - Overview - New 
- **Top 10 Queries by Billed GB**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Top 10 Queries by Billed GB**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Top 10 Queries by Billed GB**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Overview 
- **Top 10 Queries by Errors**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Top 10 Queries by Errors**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Top 10 Queries by Latency (s)**: from Dashboard: Google BigQuery/Google BigQuery - Queries - New 
- **Top 10 Queries by Latency (s)**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Overview 
- **Top 10 Queries by Latency (s)**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Queries 
- **Top 10 Queries by Latency (s)**: from Dashboard: Google BigQuery/Google BigQuery - Overview - New 
- **Top 10 Users by Billed GB**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Top 10 Users by Billed GB**: from Dashboard: Google BigQuery/Google BigQuery - Overview - New 
- **Top 10 Users by Billed GB**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Top 10 Users by Billed GB**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Overview 
- **Top 10 Users by Errors**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Top 10 Users by Errors**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Top 10 Users by Latency (s)**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Top 10 Users by Latency (s)**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Top 10 Users by Query Executions**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users 
- **Top 10 Users by Query Executions**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **Top Projects by Billed GB**: from Dashboard: Google BigQuery/Google BigQuery - Overview - New 
- **Top Projects by Billed GB**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Overview 
- **User Management Operations**: from Dashboard: Google BigQuery/Google BigQuery - Users - New 
- **User Management Operations**: from Dashboard: Installed Apps/Google BigQuery/Google BigQuery - Users

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Google BigQuery|Authorization Failures Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource callerIp authorizationInfo "type":"bigquery\_resource"  <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authorizationInfo[\*]" as labels, project, permissions<br />\| parse regex field=permissions "\\"granted\\":(?\<granted\>[a-z]+)" multi nodrop<br />\| where granted != "true"<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count as failures by \_timeslice|
|Google BigQuery|Authorization Failures Over Time|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp authorizationInfo "type":"bigquery\_resource"  <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authorizationInfo[\*]" as labels, project, permissions<br />\| parse regex field=permissions "\\"granted\\":(?\<granted\>[a-z]+)}" multi nodrop<br />\| where granted != "true"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as failures by \_timeslice|
|Google BigQuery|Billed GB by User Over Time|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Fdata\_access"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "serviceData.jobCompletedEvent.job.jobStatistics.totalBilledBytes", "authenticationInfo.principalEmail" as billed\_bytes, user<br />\| timeslice 1h<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(billed\_gbytes) as billed\_gbytes by \_timeslice, user<br />\| transpose row \_timeslice column user|
|Google BigQuery|Billed GB by User Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Fdata\_access"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "serviceData.jobCompletedEvent.job.jobStatistics.totalBilledBytes", "authenticationInfo.principalEmail" as billed\_bytes, user<br />\| timeslice 1h<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|sum(billed\_gbytes) as billed\_gbytes by \_timeslice, user<br />\| transpose row \_timeslice column user|
|Google BigQuery|Billed GB Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|sum(billed\_gbytes) as billed\_gbytes by \_timeslice, query<br />\| transpose row \_timeslice column query|
|Google BigQuery|Billed GB Over Time|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|sum(billed\_gbytes) as billed\_gbytes by \_timeslice, query<br />\| transpose row \_timeslice column query|
|Google BigQuery|Billed GB, Latency (s), Errors Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource severity startTime endTime "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, severity, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query nodrop<br />\| if(isNull(billed\_bytes), 0, billed\_bytes) as billed\_bytes<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency\_s<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|sum(billed\_gbytes) as billed\_gbytes, sum(latency\_s) as latency\_s, sum(error) as errors by \_timeslice<br />\| compare with timeshift 1d 7 avg|
|Google BigQuery|Billed GB, Latency (s), Errors Over Time|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity startTime endTime "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, severity, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query nodrop<br />\| if(isNull(billed\_bytes), 0, billed\_bytes) as billed\_bytes<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency\_s<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|sum(billed\_gbytes) as billed\_gbytes, sum(latency\_s) as latency\_s, sum(error) as errors by \_timeslice<br />\| compare with timeshift 1d 7 avg|
|Google BigQuery|Dataset Service Operation Error Outliers|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource methodName "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id" as labels, project<br />\| parse regex "\\"methodName\\":\\"(?\<service\>[^\\"]+)\\.(?\<method\>[^\\"]+)\\""<br />\| where service="datasetservice"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count by \_timeslice, method<br />\| outlier \_count by method<br />\| fields \_timeslice,method, \_count\_violation<br />\| transpose row \_timeslice column method|
|Google BigQuery|Dataset Service Operation Error Outliers|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource methodName "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id" as labels, project<br />\| parse regex "\\"methodName\\":\\"(?\<service\>[^\\"]+)\\.(?\<method\>[^\\"]+)\\""<br />\| where service="datasetservice"<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count by \_timeslice, method<br />\| outlier \_count by method<br />\| fields \_timeslice,method, \_count\_violation<br />\| transpose row \_timeslice column method|
|Google BigQuery|Dataset Service Operations Over Time|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity" as labels, project, severity<br />\| parse regex "\\"methodName\\":\\"(?\<service\>[^\\"]+)\\.(?\<method\>[^\\"]+)\\""<br />\| where service="datasetservice"<br />\| timeslice 1h<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| if(method matches "insert", 1, 0) as insert<br />\| if(method matches "delete", 1, 0) as delete<br />\| if(method matches "update", 1, 0) as update<br />\| if(!(method matches "insert" or method matches "delete" or method matches "update"), 1, 0) as other<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(insert) as inserts, sum(delete) as deletes, sum(update) as updates, sum(other) as other, sum(error) as errors by \_timeslice<br />\| fillmissing timeslice(1h)|
|Google BigQuery|Dataset Service Operations Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity" as labels, project, severity<br />\| parse regex "\\"methodName\\":\\"(?\<service\>[^\\"]+)\\.(?\<method\>[^\\"]+)\\""<br />\| where service="datasetservice"<br />\| timeslice 1h<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| if(method matches "insert", 1, 0) as insert<br />\| if(method matches "delete", 1, 0) as delete<br />\| if(method matches "update", 1, 0) as update<br />\| if(!(method matches "insert" or method matches "delete" or method matches "update"), 1, 0) as other<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|sum(insert) as inserts, sum(delete) as deletes, sum(update) as updates, sum(other) as other, sum(error) as errors by \_timeslice<br />\| fillmissing timeslice(1h)|
|Google BigQuery|Errors by User Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource severity principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, severity, user<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|sum(error) as errors by \_timeslice, user<br />\| transpose row \_timeslice column user|
|Google BigQuery|Errors by User Over Time|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, severity, user<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| timeslice 1h<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(error) as errors by \_timeslice, user<br />\| transpose row \_timeslice column user|
|Google BigQuery|Errors Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource severity "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, query<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|count as errors by \_timeslice, query<br />\| transpose row \_timeslice column query|
|Google BigQuery|Errors Over Time|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, query<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|count as errors by \_timeslice, query<br />\| transpose row \_timeslice column query|
|Google BigQuery|Failed Operation Locations|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.requestMetadata.callerIp" as labels, project, caller\_ip<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as error by latitude, longitude|
|Google BigQuery|Failed Operation Locations|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource callerIp "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.requestMetadata.callerIp" as labels, project, caller\_ip<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count by latitude, longitude|
|Google BigQuery|Google BigQuery - Management Operation Errors by Project|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management Operation Errors by Project|\_sourceCategory={{Logsdatasource}}  logName resource methodName severity "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.methodName" as labels, project, severity, method<br />\| count as operations by project, method<br />\| transpose row project column method|
|Google BigQuery|Google BigQuery - Management Operation Errors by Project|Logs|Google BigQuery/Google BigQuery - Management Operation Errors by Project|\_sourceCategory = Labs/GCP/bigquery logName resource methodName severity "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.methodName" as labels, project, severity, method<br />\| count as operations by project, method<br />\| transpose row project column method|
|Google BigQuery|Google BigQuery - Management Operations by Project|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management Operations by Project|\_sourceCategory={{Logsdatasource}}  logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName" as labels, project, method<br />\| count as operations by project, method<br />\| transpose row project column method|
|Google BigQuery|Google BigQuery - Management Operations by Project|Logs|Google BigQuery/Google BigQuery - Management Operations by Project|\_sourceCategory = Labs/GCP/bigquery logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName" as labels, project, method<br />\| count as operations by project, method<br />\| transpose row project column method|
|Google BigQuery|Google BigQuery - Query Statistics by Project|Logs|Installed Apps/Google BigQuery/Google BigQuery - Query Statistics by Project|\_sourceCategory={{Logsdatasource}}  logName resource severity startTime endTime "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, severity, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query nodrop<br />\| if(isNull(billed\_bytes), 0, billed\_bytes) as billed\_bytes<br />\| billed\_bytes / 1073741824.f as billed\_gbytes<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency\_s<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| sum(billed\_gbytes) as billed\_gbytes, sum(latency\_s) as tot\_s, avg(latency\_s) as avg\_s, count as executions, sum(error) as errors by project<br />\| errors / executions \* 100 as error\_pct|
|Google BigQuery|Google BigQuery - Query Statistics by Project|Logs|Google BigQuery/Google BigQuery - Query Statistics by Project|\_sourceCategory = Labs/GCP/bigquery logName resource severity startTime endTime "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, severity, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query nodrop<br />\| if(isNull(billed\_bytes), 0, billed\_bytes) as billed\_bytes<br />\| billed\_bytes / 1073741824.f as billed\_gbytes<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency\_s<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| sum(billed\_gbytes) as billed\_gbytes, sum(latency\_s) as tot\_s, avg(latency\_s) as avg\_s, count as executions, sum(error) as errors by project<br />\| errors / executions \* 100 as error\_pct|
|Google BigQuery|Latency (s) by Users Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource principalEmail "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|sum(latency) as tot\_s by \_timeslice, user<br />\| transpose row \_timeslice column user|
|Google BigQuery|Latency (s) by Users Over Time|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource principalEmail "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\| timeslice 1h<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(latency) as tot\_s by \_timeslice, user<br />\| transpose row \_timeslice column user|
|Google BigQuery|Latency (s) Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, query<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|sum(latency) as tot\_latency\_s by \_timeslice, query<br />\| transpose row \_timeslice column query|
|Google BigQuery|Latency (s) Over Time|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, query<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|sum(latency) as tot\_latency\_s by \_timeslice, query<br />\| transpose row \_timeslice column query|
|Google BigQuery|Location of Authorization Failures|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource callerIp authorizationInfo "type":"bigquery\_resource"  <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "authorizationInfo[\*]", "requestMetadata.callerIp" as permissions, caller\_ip<br />\| parse regex field=permissions "\\"granted\\":(?\<granted\>[a-z]+)" multi nodrop<br />\| where granted != "true"<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count by latitude, longitude<br />\| sort \_count|
|Google BigQuery|Location of Authorization Failures|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp authorizationInfo "type":"bigquery\_resource"  <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "authorizationInfo[\*]", "requestMetadata.callerIp" as permissions, caller\_ip<br />\| parse regex field=permissions "\\"granted\\":(?\<granted\>[a-z]+)}" multi nodrop<br />\| where granted != "true"<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count by latitude, longitude<br />\| sort \_count|
|Google BigQuery|Location of Failed Executions|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource callerIp "eventName":"query\_job\_completed" "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "requestMetadata.callerIp", "serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as caller\_ip, query<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|count by latitude, longitude|
|Google BigQuery|Location of Failed Executions|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp "eventName":"query\_job\_completed" "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "requestMetadata.callerIp", "serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as caller\_ip, query<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|count by latitude, longitude|
|Google BigQuery|Location of Query Requests|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource callerIp "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "requestMetadata.callerIp", "serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as caller\_ip, query<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|count by latitude, longitude|
|Google BigQuery|Location of Query Requests|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "requestMetadata.callerIp", "serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as caller\_ip, query<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|count by latitude, longitude|
|Google BigQuery|Location of Users Executing Queries|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource callerIp principalEmail "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "requestMetadata.callerIp", "authenticationInfo.principalEmail" as caller\_ip, user<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|count\_distinct(user) as \_count by latitude, longitude, user|
|Google BigQuery|Location of Users Executing Queries|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp principalEmail "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "requestMetadata.callerIp", "authenticationInfo.principalEmail" as caller\_ip, user<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count\_distinct(user) by latitude, longitude, user|
|Google BigQuery|Location of Users With Errors|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp principalEmail "eventName":"query\_job\_completed" "type":"bigquery\_resource"("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "requestMetadata.callerIp", "authenticationInfo.principalEmail" as caller\_ip, user<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count\_distinct(user) by latitude, longitude, user|
|Google BigQuery|Location of Users With Errors|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource callerIp principalEmail "eventName":"query\_job\_completed" "type":"bigquery\_resource"("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "requestMetadata.callerIp", "authenticationInfo.principalEmail" as caller\_ip, user<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|count\_distinct(user) as \_count by latitude, longitude, user|
|Google BigQuery|Operation Failure Percentage|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity "type":"bigquery\_resource" <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity" as labels, project, severity<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(error) as errors, count as all\_messages<br />\| errors / all\_messages \* 100 as error\_pct<br />\| pct(error\_pct)|
|Google BigQuery|Operation Failure Percentage|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource severity "type":"bigquery\_resource" <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity" as labels, project, severity<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|sum(error) as errors, count as all\_messages<br />\| errors / all\_messages \* 100 as error\_pct<br />\| pct(error\_pct)|
|Google BigQuery|Operation Failures by Project|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id" as labels, project<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as failures by \_timeslice, project<br />\| transpose row \_timeslice column project|
|Google BigQuery|Operation Failures by Project|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource callerIp "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id" as labels, project<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count as failures by \_timeslice, project<br />\| transpose row \_timeslice column project|
|Google BigQuery|Operations|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName" as labels, project, method<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as operations by method<br />\| sort by operations|
|Google BigQuery|Operations|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName" as labels, project, method<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count as operations by method<br />\| sort by operations|
|Google BigQuery|Operations Breakdown|Logs|Google BigQuery/Google BigQuery - Overview - New|\_sourceCategory = Labs/GCP/bigquery logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName" as labels, project, method<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as operations by method<br />\| sort by operations|
|Google BigQuery|Operations Breakdown|Logs|Installed Apps/Google BigQuery/Google BigQuery - Overview|\_sourceCategory={{Logsdatasource}}  logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName" as labels, project, method<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count as operations by method<br />\| sort by operations|
|Google BigQuery|Operations by Project|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id" as labels, project<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as operations by \_timeslice, project<br />\| transpose row \_timeslice column project|
|Google BigQuery|Operations by Project|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id" as labels, project<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count as operations by \_timeslice, project<br />\| transpose row \_timeslice column project|
|Google BigQuery|Operations Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Overview|\_sourceCategory={{Logsdatasource}}  logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName" as labels, project, method<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count as operations by \_timeslice, method<br />\| transpose row \_timeslice column method|
|Google BigQuery|Operations Over Time|Logs|Google BigQuery/Google BigQuery - Overview - New|\_sourceCategory = Labs/GCP/bigquery logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.methodName" as labels, project, method<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as operations by \_timeslice, method<br />\| transpose row \_timeslice column method|
|Google BigQuery|Query Executions by User Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|count as executions by \_timeslice, user<br />\| transpose row \_timeslice column user|
|Google BigQuery|Query Executions by User Over Time|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\| timeslice 1h<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as executions by \_timeslice, user<br />\| transpose row \_timeslice column user|
|Google BigQuery|Query Request Locations|Logs|Google BigQuery/Google BigQuery - Overview - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.requestMetadata.callerIp" as labels, project, caller\_ip<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count by latitude, longitude|
|Google BigQuery|Query Request Locations|Logs|Installed Apps/Google BigQuery/Google BigQuery - Overview|\_sourceCategory={{Logsdatasource}}  logName resource callerIp "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.requestMetadata.callerIp" as labels, project, caller\_ip<br />\| lookup latitude, longitude from geo://location on ip=caller\_ip<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count by latitude, longitude|
|Google BigQuery|Query Statistics by Project|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource severity startTime endTime "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, severity, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query nodrop<br />\| if(isNull(billed\_bytes), 0, billed\_bytes) as billed\_bytes<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency\_s<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|sum(billed\_gbytes) as billed\_gbytes, sum(latency\_s) as tot\_s, avg(latency\_s) as avg\_s, count as executions, sum(error) as errors by project<br />\| errors / executions \* 100 as error\_pct|
|Google BigQuery|Query Statistics by Project|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity startTime endTime "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, severity, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query nodrop<br />\| if(isNull(billed\_bytes), 0, billed\_bytes) as billed\_bytes<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency\_s<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|sum(billed\_gbytes) as billed\_gbytes, sum(latency\_s) as tot\_s, avg(latency\_s) as avg\_s, count as executions, sum(error) as errors by project<br />\| errors / executions \* 100 as error\_pct|
|Google BigQuery|Recent Authorization Failures|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  authorizationInfo callerIp logName principalEmail resource timestamp "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.timestamp", "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as timestamp, labels, project, payload<br />\| json field=payload "authenticationInfo.principalEmail", "authorizationInfo[\*]", "requestMetadata.callerIp" as user, permissions, caller\_ip<br />\| parse regex field=permissions "\\"permission\\":\\"(?\<action\>[a-zA-Z\\.]+)\\"" multi<br />\| parse regex field=permissions "\\"granted\\":(?\<granted\>[a-z]+)" multi nodrop<br />\| where granted != "true"<br />\| lookup country\_name, city from geo://location on ip=caller\_ip<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count as operations by timestamp, user, action, project, country\_name, city, caller\_ip<br />\| fields timestamp, user, action, project, country\_name, city, caller\_ip<br />\| sort by timestamp|
|Google BigQuery|Recent Authorization Failures|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery authorizationInfo callerIp logName principalEmail resource timestamp "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.timestamp", "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as timestamp, labels, project, payload<br />\| json field=payload "authenticationInfo.principalEmail", "authorizationInfo[\*]", "requestMetadata.callerIp" as user, permissions, caller\_ip<br />\| parse regex field=permissions "\\"permission\\":\\"(?\<action\>[a-zA-Z\\.]+)\\"" multi<br />\| parse regex field=permissions "\\"granted\\":(?\<granted\>[a-z]+)}" multi nodrop<br />\| where granted != "true"<br />\| lookup country\_name, city from geo://location on ip=caller\_ip<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as operations by timestamp, user, action, project, country\_name, city, caller\_ip<br />\| fields timestamp, user, action, project, country\_name, city, caller\_ip<br />\| sort by timestamp|
|Google BigQuery|Recent Operation Failures|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource callerIp "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.timestamp", "message.data.severity", "message.data.protoPayload" as labels, project, timestamp, severity, payload<br />\| json field=payload "authenticationInfo.principalEmail", "methodName", "status.message" as user, method, message<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count timestamp, severity, method, message, user<br />\| fields - \_count<br />\| sort by timestamp|
|Google BigQuery|Recent Operation Failures|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource callerIp "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.timestamp", "message.data.severity", "message.data.protoPayload" as labels, project, timestamp, severity, payload<br />\| json field=payload "authenticationInfo.principalEmail", "methodName", "status.message" as user, method, message<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count timestamp, severity, method, message, user<br />\| fields - \_count<br />\| sort by timestamp|
|Google BigQuery|Recent Query Failures|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity  "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.timestamp", "message.data.severity", "message.data.protoPayload" as labels, project, timestamp, severity, payload<br />\| json field=payload "serviceData.jobCompletedEvent.job.jobConfiguration.query.query", "status.message" as query, message<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|count timestamp, severity, message, query<br />\| fields - \_count<br />\| sort by timestamp|
|Google BigQuery|Recent Query Failures|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource severity  "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.timestamp", "message.data.severity", "message.data.protoPayload" as labels, project, timestamp, severity, payload<br />\| json field=payload "serviceData.jobCompletedEvent.job.jobConfiguration.query.query", "status.message" as query, message<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|count timestamp, severity, message, query<br />\| fields - \_count<br />\| sort by timestamp|
|Google BigQuery|Recent Query Failures by User|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource severity principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.timestamp", "message.data.severity", "message.data.protoPayload" as labels, project, timestamp, severity, payload<br />\| json field=payload "authenticationInfo.principalEmail", "serviceData.jobCompletedEvent.job.jobConfiguration.query.query", "status.message" as user, query, message<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|count timestamp, severity, user, message, query<br />\| fields - \_count<br />\| sort by timestamp asc<br />\| 1 as exec<br />\| accum exec as exec by user<br />\| sort by timestamp|
|Google BigQuery|Recent Query Failures by User|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.timestamp", "message.data.severity", "message.data.protoPayload" as labels, project, timestamp, severity, payload<br />\| json field=payload "authenticationInfo.principalEmail", "serviceData.jobCompletedEvent.job.jobConfiguration.query.query", "status.message" as user, query, message<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count timestamp, severity, user, message, query<br />\| fields - \_count<br />\| sort by timestamp asc<br />\| 1 as exec<br />\| accum exec as exec by user<br />\| sort by timestamp|
|Google BigQuery|Table Service Operation Error Outliers|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource methodName "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id" as labels, project<br />\| parse regex "\\"methodName\\":\\"(?\<service\>[^\\"]+)\\.(?\<method\>[^\\"]+)\\""<br />\| where service="tableservice"<br />\| timeslice 1h<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|count by \_timeslice, method<br />\| outlier \_count by method<br />\| fields \_timeslice,method, \_count\_violation<br />\| transpose row \_timeslice column method|
|Google BigQuery|Table Service Operation Error Outliers|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource methodName "type":"bigquery\_resource" ("\\"severity\\":\\"WARNING\\"" or "\\"severity\\":\\"ERROR\\"" or "\\"severity\\":\\"CRITICAL\\"" or "\\"severity\\":\\"ALERT\\"" or "\\"severity\\":\\"EMERGENCY\\"")<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id" as labels, project<br />\| parse regex "\\"methodName\\":\\"(?\<service\>[^\\"]+)\\.(?\<method\>[^\\"]+)\\""<br />\| where service="tableservice"<br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count by \_timeslice, method<br />\| outlier \_count by method<br />\| fields \_timeslice,method, \_count\_violation<br />\| transpose row \_timeslice column method|
|Google BigQuery|Table Service Operations Over Time|Logs|Google BigQuery/Google BigQuery - Management - New|\_sourceCategory = Labs/GCP/bigquery logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity" as labels, project, severity<br />\| parse regex "\\"methodName\\":\\"(?\<service\>[^\\"]+)\\.(?\<method\>[^\\"]+)\\""<br />\| where service="tableservice"<br />\| timeslice 1h<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| if(method matches "insert", 1, 0) as insert<br />\| if(method matches "delete", 1, 0) as delete<br />\| if(method matches "update", 1, 0) as update<br />\| if(!(method matches "insert" or method matches "delete" or method matches "update"), 1, 0) as other<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(insert) as inserts, sum(delete) as deletes, sum(update) as updates, sum(other) as other, sum(error) as errors by \_timeslice<br />\| fillmissing timeslice(1h)|
|Google BigQuery|Table Service Operations Over Time|Logs|Installed Apps/Google BigQuery/Google BigQuery - Management|\_sourceCategory={{Logsdatasource}}  logName resource methodName "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity" as labels, project, severity<br />\| parse regex "\\"methodName\\":\\"(?\<service\>[^\\"]+)\\.(?\<method\>[^\\"]+)\\""<br />\| where service="tableservice"<br />\| timeslice 1h<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\| if(method matches "insert", 1, 0) as insert<br />\| if(method matches "delete", 1, 0) as delete<br />\| if(method matches "update", 1, 0) as update<br />\| if(!(method matches "insert" or method matches "delete" or method matches "update"), 1, 0) as other<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|sum(insert) as inserts, sum(delete) as deletes, sum(update) as updates, sum(other) as other, sum(error) as errors by \_timeslice<br />\| fillmissing timeslice(1h)|
|Google BigQuery|Top 10 Queries by Billed GB|Logs|Google BigQuery/Google BigQuery - Overview - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(billed\_gbytes) as billed\_gbytes by query<br />\| top 10 query by billed\_gbytes<br />\| fields query, billed\_gbytes|
|Google BigQuery|Top 10 Queries by Billed GB|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|sum(billed\_gbytes) as billed\_gbytes by query, project<br />\| top 10 query, project by billed\_gbytes<br />\| fields billed\_gbytes, project, query|
|Google BigQuery|Top 10 Queries by Billed GB|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|sum(billed\_gbytes) as billed\_gbytes by query, project<br />\| top 10 query, project by billed\_gbytes<br />\| fields billed\_gbytes, project, query|
|Google BigQuery|Top 10 Queries by Billed GB|Logs|Installed Apps/Google BigQuery/Google BigQuery - Overview|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job" as labels, project, job<br />\| json field=job "jobStatistics.totalBilledBytes", "jobConfiguration.query.query" as billed\_bytes, query<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|sum(billed\_gbytes) as billed\_gbytes by query<br />\| top 10 query by billed\_gbytes<br />\| fields query, billed\_gbytes|
|Google BigQuery|Top 10 Queries by Errors|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource severity "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, severity, query<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|count as exec, sum(error) as errors by query, project<br />\| errors / exec \* 100 as error\_pct<br />\| top 10 query, project by errors, error\_pct, exec<br />\| fields errors, exec, error\_pct, project, query|
|Google BigQuery|Top 10 Queries by Errors|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, severity, query<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|count as exec, sum(error) as errors by query, project<br />\| errors / exec \* 100 as error\_pct<br />\| top 10 query, project by errors, error\_pct, exec<br />\| fields errors, exec, error\_pct, project, query|
|Google BigQuery|Top 10 Queries by Latency (s)|Logs|Google BigQuery/Google BigQuery - Queries - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, query<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}") AND if ("{{Query}}" = "\*", true, query matches "{{Query}}")<br />\|sum(latency) as tot\_s, avg(latency) as avg\_s, count as exec by query, project<br />\| top 10 query, project by tot\_s, avg\_s, exec<br />\| fields tot\_s, avg\_s, exec, project, query|
|Google BigQuery|Top 10 Queries by Latency (s)|Logs|Installed Apps/Google BigQuery/Google BigQuery - Overview|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, query<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|sum(latency) as tot\_s, avg(latency) as avg\_s, count as exec by query<br />\| top 10 query by tot\_s, avg\_s, exec<br />\| fields query, tot\_s, avg\_s, exec|
|Google BigQuery|Top 10 Queries by Latency (s)|Logs|Installed Apps/Google BigQuery/Google BigQuery - Queries|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, query<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND query matches "{{Query}}"<br />\|sum(latency) as tot\_s, avg(latency) as avg\_s, count as exec by query, project<br />\| top 10 query, project by tot\_s, avg\_s, exec<br />\| fields tot\_s, avg\_s, exec, project, query|
|Google BigQuery|Top 10 Queries by Latency (s)|Logs|Google BigQuery/Google BigQuery - Overview - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobConfiguration.query.query" as labels, project, query<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(latency) as tot\_s, avg(latency) as avg\_s, count as exec by query<br />\| top 10 query by tot\_s, avg\_s, exec<br />\| fields query, tot\_s, avg\_s, exec|
|Google BigQuery|Top 10 Users by Billed GB|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Fdata\_access"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "serviceData.jobCompletedEvent.job.jobStatistics.totalBilledBytes", "authenticationInfo.principalEmail" as billed\_bytes, user<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|sum(billed\_gbytes) as billed\_gbytes by user<br />\| top 10 billed\_gbytes, user<br />\| fields user, billed\_gbytes|
|Google BigQuery|Top 10 Users by Billed GB|Logs|Google BigQuery/Google BigQuery - Overview - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "serviceData.jobCompletedEvent.job.jobStatistics.totalBilledBytes", "authenticationInfo.principalEmail" as billed\_bytes, user<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(billed\_gbytes) as billed\_gbytes by user<br />\| top 10 user by billed\_gbytes<br />\| fields user, billed\_gbytes|
|Google BigQuery|Top 10 Users by Billed GB|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Fdata\_access"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "serviceData.jobCompletedEvent.job.jobStatistics.totalBilledBytes", "authenticationInfo.principalEmail" as billed\_bytes, user<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(billed\_gbytes) as billed\_gbytes by user<br />\| top 10 billed\_gbytes, user<br />\| fields user, billed\_gbytes|
|Google BigQuery|Top 10 Users by Billed GB|Logs|Installed Apps/Google BigQuery/Google BigQuery - Overview|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, project, payload<br />\| json field=payload "serviceData.jobCompletedEvent.job.jobStatistics.totalBilledBytes", "authenticationInfo.principalEmail" as billed\_bytes, user<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|sum(billed\_gbytes) as billed\_gbytes by user<br />\| top 10 user by billed\_gbytes<br />\| fields user, billed\_gbytes|
|Google BigQuery|Top 10 Users by Errors|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource severity principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, severity, user<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|count as exec, sum(error) as errors by user<br />\| errors / exec \* 100 as error\_pct<br />\| top 10 user by errors, error\_pct, exec<br />\| fields user, errors, exec, error\_pct|
|Google BigQuery|Top 10 Users by Errors|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource severity principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.severity", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, severity, user<br />\| if(severity in ("WARNING", "ERROR","CRITICAL", "ALERT", "EMERGENCY"), 1, 0) as error<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as exec, sum(error) as errors by user<br />\| errors / exec \* 100 as error\_pct<br />\| top 10 user by errors, error\_pct, exec<br />\| fields user, errors, exec, error\_pct|
|Google BigQuery|Top 10 Users by Latency (s)|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource principalEmail "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(latency) as tot\_s, avg(latency) as avg\_s, count as exec by user<br />\| top 10 user by tot\_s, avg\_s, exec<br />\| fields user, tot\_s, avg\_s, exec|
|Google BigQuery|Top 10 Users by Latency (s)|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource principalEmail "\\"jobCompletedEvent\\":" startTime endTime "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\| parse regex "\\"startTime\\":\\"(?\<start\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<start\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<start\_millis\>\\d{3})[^\\"]+\\""<br />\| parse regex "\\"endTime\\":\\"(?\<end\_day\>\\d{4}-\\d{2}-\\d{2})T(?\<end\_time\>\\d{2}:\\d{2}:\\d{2})\\.(?\<end\_millis\>\\d{3})[^\\"]+\\""<br />\| start\_millis + toMillis(parseDate(concat(start\_day, start\_time),"yyyy-MM-ddHH:mm:ss")) as start\_num<br />\| end\_millis + toMillis(parseDate(concat(end\_day, end\_time),"yyyy-MM-ddHH:mm:ss")) as end\_num<br />\| (end\_num - start\_num) / 1000 as latency<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|sum(latency) as tot\_s, avg(latency) as avg\_s, count as exec by user<br />\| top 10 user by tot\_s, avg\_s, exec<br />\| fields user, tot\_s, avg\_s, exec|
|Google BigQuery|Top 10 Users by Query Executions|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|count as executions by user<br />\| top 10 user by executions<br />\| fields user, executions|
|Google BigQuery|Top 10 Users by Query Executions|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource principalEmail "\\"jobCompletedEvent\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as executions by user<br />\| top 10 user by executions<br />\| fields user, executions|
|Google BigQuery|Top Projects by Billed GB|Logs|Google BigQuery/Google BigQuery - Overview - New|\_sourceCategory = Labs/GCP/bigquery logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobStatistics.totalBilledBytes" as labels, project, billed\_bytes<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|sum(billed\_gbytes) as billed\_gbytes by project<br />\| sort by billed\_gbytes|
|Google BigQuery|Top Projects by Billed GB|Logs|Installed Apps/Google BigQuery/Google BigQuery - Overview|\_sourceCategory={{Logsdatasource}}  logName resource "\\"jobCompletedEvent\\":" "\\"totalBilledBytes\\":" "eventName":"query\_job\_completed" "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2F\*"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.jobCompletedEvent.job.jobStatistics.totalBilledBytes" as labels, project, billed\_bytes<br />\| billed\_bytes / 1Gi as billed\_gbytes<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}"<br />\|sum(billed\_gbytes) as billed\_gbytes by project<br />\| sort by billed\_gbytes|
|Google BigQuery|User Management Operations|Logs|Google BigQuery/Google BigQuery - Users - New|\_sourceCategory = Labs/GCP/bigquery logName resource methodName principalEmail "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\| parse regex "\\"methodName\\":\\"(?\<method\>[^\\"]+)\\""<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}") AND if ("{{UserLabels}}" = "\*", true, labels matches "{{UserLabels}}")<br />\|count as operations by user, method<br />\| transpose row user column method|
|Google BigQuery|User Management Operations|Logs|Installed Apps/Google BigQuery/Google BigQuery - Users|\_sourceCategory={{Logsdatasource}}  logName resource methodName principalEmail "type":"bigquery\_resource"<br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\""<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.authenticationInfo.principalEmail" as labels, project, user<br />\| parse regex "\\"methodName\\":\\"(?\<method\>[^\\"]+)\\""<br />\|where project matches "{{Project}}" AND labels matches "{{User Labels}}" AND user matches "{{User}}"<br />\|count as operations by user, method<br />\| transpose row user column method|

