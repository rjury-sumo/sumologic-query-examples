# Microsoft Office 365
## Sumo Logic App For: Microsoft Office 365
The Sumo Logic App for Microsoft Office 365 provides insights for Azure Active Directory, Exchange, and SharePoint. The preconfigured dashboards allow you to monitor the failures, successes, and other operations in Office 365 system.
Docs Link: [Microsoft Office 365](https://help.sumologic.com/?cid=10213)

## Searches

### Log Searches

- **AD Operations**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New 
- **AD Operations**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **AD Operations**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **AD Transactions by Client Location**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New 
- **AD Transactions by Client Location**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **AD Transactions by Client Location**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **Added and Deleted Users**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Added and Deleted Users**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Added and Deleted Users - Trend**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Added and Deleted Users - Trend**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Added or Removed Members from Group**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Added or Removed Members from Group**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Azure AD Operations Trends**: from Dashboard: Installed Apps/Microsoft Office 365/Office 365 - Overview 
- **Azure AD Operations Trends**: from Dashboard: Microsoft Office 365/Office 365 - Overview 
- **Azure AD Operations Trends**: from Dashboard: Microsoft Office 365/Office 365 - Overview - New 
- **Azure AD Transactions by Client Location**: from Dashboard: Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location - New 
- **Azure AD Transactions by Client Location**: from Dashboard: Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location 
- **Azure AD Transactions by Client Location**: from Dashboard: Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location 
- **Clients by Country Over Time**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations 
- **Clients by Country Over Time**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations - New 
- **Clients by Country Over Time**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations 
- **Clients by State Over Time**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations 
- **Clients by State Over Time**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations - New 
- **Clients by State Over Time**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations 
- **Configuration Changes (All)**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Configuration Changes (All)**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New 
- **Configuration Changes (All)**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Configuration Changes by External Access**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Configuration Changes by External Access**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Configuration Changes by External Access**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New 
- **Content Checked In and Out Recently**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Content Checked In and Out Recently**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Demo - Geo Lookup on Suspicious IP**: from Search: Installed Apps/Microsoft Office 365/Demo - Geo Lookup on Suspicious IP 
- **Demo - Geo Lookup on Suspicious IP**: from Search: Microsoft Office 365/Demo - Geo Lookup on Suspicious IP 
- **Demo - Honing on Suspicious User**: from Search: Microsoft Office 365/Demo - Honing on Suspicious User 
- **Demo - Honing on Suspicious User**: from Search: Installed Apps/Microsoft Office 365/Demo - Honing on Suspicious User 
- **Demo - LogReduce on Suspicious IP**: from Search: Installed Apps/Microsoft Office 365/Demo - LogReduce on Suspicious IP 
- **Demo - LogReduce on Suspicious IP**: from Search: Microsoft Office 365/Demo - LogReduce on Suspicious IP 
- **Demo - Outlier**: from Search: Installed Apps/Microsoft Office 365/Demo - Outlier 
- **Demo - Outlier**: from Search: Microsoft Office 365/Demo - Outlier 
- **Exchange  Transactions by Client Location**: from Dashboard: Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location - New 
- **Exchange  Transactions by Client Location**: from Dashboard: Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location 
- **Exchange  Transactions by Client Location**: from Dashboard: Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location 
- **Exchange Operations**: from Dashboard: Microsoft Office 365/Office 365 - Overview - New 
- **Exchange Operations**: from Dashboard: Microsoft Office 365/Office 365 - Overview 
- **Exchange Operations**: from Dashboard: Installed Apps/Microsoft Office 365/Office 365 - Overview 
- **External Access**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **External Access**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New 
- **External Access**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Failed Activity by Workload**: from Dashboard: Installed Apps/Microsoft Office 365/Office 365 - Overview 
- **Failed Activity by Workload**: from Dashboard: Microsoft Office 365/Office 365 - Overview 
- **Failed Activity by Workload**: from Dashboard: Microsoft Office 365/Office 365 - Overview - New 
- **Failed Activity Overtime**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **Failed Activity Overtime**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New 
- **Failed Activity Overtime**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **Failed Logins from US**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations 
- **Failed Logins from US**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations 
- **Failed Logins Outside the US**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations 
- **Failed Logins Outside the US**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations 
- **File Type Accessed**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **File Type Accessed**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Folders**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Folders**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Folders**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New 
- **Login Failure Outlier**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failure Outlier**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Login Failure Outlier**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Login Failures**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Login Failures**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures by ClientIP**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Login Failures by ClientIP**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures by ClientIP**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures by Error**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures by Error**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures by Error**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Login Failures by Operation**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Login Failures by Operation**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures by Operation**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures by User - Trend**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Login Failures by User - Trend**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Login Failures by User - Trend**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Logins Attempts from Multiple ClientIPs (within 15m)**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Logins Attempts from Multiple ClientIPs (within 15m)**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Logins Attempts from Multiple ClientIPs (within 15m)**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Logon Types**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Logon Types**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Logon Types**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New 
- **Logon Types**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Logon Types**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New 
- **Logon Types**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Most Downloaded Content**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Most Downloaded Content**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Office 365 - Activity by Workload**: from Search: Microsoft Office 365/General/Resource Access/Office 365 - Activity by Workload 
- **Office 365 - Activity by Workload**: from Search: Installed Apps/Microsoft Office 365/General/Resource Access/Office 365 - Activity by Workload 
- **Office 365 - All Transactions by Client Location**: from Search: Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - All Transactions by Client Location 
- **Office 365 - All Transactions by Client Location**: from Search: Microsoft Office 365/General/Activity by Location/Office 365 - All Transactions by Client Location 
- **Office 365 - Azure Active Directory - Operations Trends**: from Search: Microsoft Office 365/General/Resource Access/Office 365 - Azure Active Directory - Operations Trends 
- **Office 365 - Azure Active Directory - Operations Trends**: from Search: Installed Apps/Microsoft Office 365/General/Resource Access/Office 365 - Azure Active Directory - Operations Trends 
- **Office 365 - Azure Active Directory - Transactions by Client Location**: from Search: Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Azure Active Directory - Transactions by Client Location 
- **Office 365 - Azure Active Directory - Transactions by Client Location**: from Search: Microsoft Office 365/General/Activity by Location/Office 365 - Azure Active Directory - Transactions by Client Location 
- **Office 365 - Exchange - Operations Trends**: from Search: Microsoft Office 365/General/Resource Access/Office 365 - Exchange - Operations Trends 
- **Office 365 - Exchange - Operations Trends**: from Search: Installed Apps/Microsoft Office 365/General/Resource Access/Office 365 - Exchange - Operations Trends 
- **Office 365 - Exchange - Top Users**: from Search: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Top Users 
- **Office 365 - Exchange - Top Users**: from Search: Microsoft Office 365/Exchange/Office 365 - Exchange - Top Users 
- **Office 365 - Exchange - Transactions by Client Location**: from Search: Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Exchange - Transactions by Client Location 
- **Office 365 - Exchange - Transactions by Client Location**: from Search: Microsoft Office 365/General/Activity by Location/Office 365 - Exchange - Transactions by Client Location 
- **Office 365 - SharePoint - Log Parser**: from Search: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Log Parser 
- **Office 365 - SharePoint - Log Parser**: from Search: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Log Parser 
- **Office 365 - SharePoint - One Drive - Transactions by Client Location**: from Search: Microsoft Office 365/General/Activity by Location/Office 365 - SharePoint - One Drive - Transactions by Client Location 
- **Office 365 - SharePoint - One Drive - Transactions by Client Location**: from Search: Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - SharePoint - One Drive - Transactions by Client Location 
- **Office 365 - Sharepoint or OneDrive - Operations Trends**: from Search: Installed Apps/Microsoft Office 365/General/Resource Access/Office 365 - Sharepoint or OneDrive - Operations Trends 
- **Office 365 - Sharepoint or OneDrive - Operations Trends**: from Search: Microsoft Office 365/General/Resource Access/Office 365 - Sharepoint or OneDrive - Operations Trends 
- **Office 365 Transactions by Client Location**: from Dashboard: Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location - New 
- **Office 365 Transactions by Client Location**: from Dashboard: Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location 
- **Office 365 Transactions by Client Location**: from Dashboard: Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location 
- **Password Resets and Changes**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Password Resets and Changes**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Password Resets and Changes - Trend**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Password Resets and Changes - Trend**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring 
- **Recent Activities (All)**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Recent Activities (All)**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Recent Activities (All)**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New 
- **Recent Activities (External Access)**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Recent Activities (External Access)**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New 
- **Recent Activities (External Access)**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Recent Parameter Changes**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New 
- **Recent Parameter Changes**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Recent Parameter Changes**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Recent Uploads by Non-Domain Users**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Recent Uploads by Non-Domain Users**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Recently Uploaded Content**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Recently Uploaded Content**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **SharePoint Operations**: from Dashboard: Microsoft Office 365/Office 365 - Overview 
- **SharePoint Operations**: from Dashboard: Installed Apps/Microsoft Office 365/Office 365 - Overview 
- **SharePoint Operations**: from Dashboard: Microsoft Office 365/Office 365 - Overview - New 
- **SP and  OD Transactions by Client Location**: from Dashboard: Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location - New 
- **SP and  OD Transactions by Client Location**: from Dashboard: Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location 
- **SP and  OD Transactions by Client Location**: from Dashboard: Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location 
- **Successful Activity by Workload**: from Dashboard: Installed Apps/Microsoft Office 365/Office 365 - Overview 
- **Successful Activity by Workload**: from Dashboard: Microsoft Office 365/Office 365 - Overview - New 
- **Successful Activity by Workload**: from Dashboard: Microsoft Office 365/Office 365 - Overview 
- **Successful Logins**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Successful Logins**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Successful Logins**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Successful Logins**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Successful Logins**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Successful Logins**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Successful Logins by ClientIP**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Successful Logins by ClientIP**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Successful Logins by ClientIP**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Successful Logins by Operation**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Successful Logins by Operation**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring 
- **Successful Logins by Operation**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New 
- **Successful Logins from US**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations 
- **Successful Logins from US**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations 
- **Successful Logins Outside the US**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations 
- **Successful Logins Outside the US**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations 
- **Top 10 Active IPs**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Active IPs**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Active IPs**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New 
- **Top 10 Active Users**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Active Users**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Top 10 Active Users**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New 
- **Top 10 Active Users**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New 
- **Top 10 Active Users**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New 
- **Top 10 Active Users**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Top 10 Active Users**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Top 10 Active Users**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Active Users**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Top 10 Clients**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 Clients**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Top 10 Clients**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New 
- **Top 10 Clients**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New 
- **Top 10 Clients**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 Clients**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Top 10 Content Download by Non-Domain Users**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Content Download by Non-Domain Users**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Content Viewed by Non-Domain Users**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Content Viewed by Non-Domain Users**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Email Clients Used**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New 
- **Top 10 Email Clients Used**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 Email Clients Used**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 IPs**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 IPs**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 IPs**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New 
- **Top 10 Most Viewed Content**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Top 10 Most Viewed Content**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Top 10 Non-Domain Users Downloading**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Non-Domain Users Downloading**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Non-Domain Users Uploading**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Non-Domain Users Uploading**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Non-Domain Users Viewing Content**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Non-Domain Users Viewing Content**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Non-Domain Users With Access**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Non-Domain Users With Access**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Operations**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Top 10 Operations**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 Operations**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New 
- **Top 10 Operations**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 Operations**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New 
- **Top 10 Operations**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Top 10 Operations**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit 
- **Top 10 Operations**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New 
- **Top 10 Operations**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Top 10 SiteUrl Accessed**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Top 10 SiteUrl Accessed**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Top 10 Users**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 Users**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit 
- **Top 10 Users**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New 
- **Top 10 Users Downloading Content**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Users Downloading Content**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New 
- **Top 10 Users Downloading Content**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Users Involved in Sharing Operations**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Users Involved in Sharing Operations**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New 
- **Top 10 Users Involved in Sharing Operations**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Users Sharing Outside Domain**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Users Sharing Outside Domain**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities 
- **Top 10 Users Uploading Content**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Users Uploading Content**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top 10 Users Uploading Content**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New 
- **Top Client IPs**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **Top Client IPs**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New 
- **Top Client IPs**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **Top SharePoint Resources**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Top SharePoint Resources**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight 
- **Top Sharing Activities by User ID**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top Sharing Activities by User ID**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New 
- **Top Sharing Activities by User ID**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity 
- **Top Users by AAD Admin Activity**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **Top Users by AAD Admin Activity**: from Dashboard: Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity 
- **Top Users by AAD Admin Activity**: from Dashboard: Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New 
- **United States Clients**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations 
- **United States Clients**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations 
- **United States Clients**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations - New 
- **United States Visitors**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations 
- **United States Visitors**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations - New 
- **United States Visitors**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations 
- **User Types**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New 
- **User Types**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **User Types**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Users Making Configuration Changes**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New 
- **Users Making Configuration Changes**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Users Making Configuration Changes**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit 
- **Visits by Country Over Time**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations - New 
- **Visits by Country Over Time**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations 
- **Visits by Country Over Time**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations 
- **Visits by State Over Time**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations - New 
- **Visits by US States Over Time**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations 
- **Visits by US States Over Time**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations 
- **Worldwide Clients**: from Dashboard: Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations 
- **Worldwide Clients**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations 
- **Worldwide Clients**: from Dashboard: Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations - New 
- **Worldwide Visitors**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations - New 
- **Worldwide Visitors**: from Dashboard: Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations 
- **Worldwide Visitors**: from Dashboard: Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Microsoft Office 365/Azure Active Directory|AD Operations|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "Operation"<br />\| where workLoad="AzureActiveDirectory"<br />\| timeslice by 1h<br />\|where if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/Azure Active Directory|AD Operations|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "Operation"<br />\| where workLoad="AzureActiveDirectory"<br />\| timeslice by 1h<br />\|where if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/Azure Active Directory|AD Operations|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "Operation"<br />\| where workLoad="AzureActiveDirectory"<br />\| timeslice by 1h<br />\|where if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/Azure Active Directory|AD Transactions by Client Location|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" ClientIP<br />\| json "Workload"<br />\| json "ClientIP" as src\_ip <br />\| where workLoad="AzureActiveDirectory"<br />\| count by src\_ip <br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip|
|Microsoft Office 365/Azure Active Directory|AD Transactions by Client Location|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" ClientIP<br />\| json "Workload"<br />\| json "Operation"<br />\| json "ClientIP" as src\_ip <br />\| where workLoad="AzureActiveDirectory"<br />\|where if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by src\_ip <br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip|
|Microsoft Office 365/Azure Active Directory|AD Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" ClientIP<br />\| json "Workload"<br />\| json "Operation"<br />\| json "ClientIP" as src\_ip <br />\| where workLoad="AzureActiveDirectory"<br />\|where if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by src\_ip <br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip|
|Microsoft Office 365/Azure Active Directory|Added and Deleted Users|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Add user" or "Delete user")<br />\| json "Workload", "Operation", "ObjectId", "ResultStatus"<br />\| where workLoad ="AzureActiveDirectory" and Operation in ("Delete user.", "Add user.")<br />\| ResultStatus as status<br />\| timeslice 1s<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by \_timeslice, Operation, ObjectID, status<br />\| fields - \_count <br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Added and Deleted Users|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Add user" or "Delete user")<br />\| json "Workload", "Operation", "ObjectId", "ResultStatus"<br />\| where workLoad ="AzureActiveDirectory" and Operation in ("Delete user.", "Add user.")<br />\| ResultStatus as status<br />\| timeslice 1s<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by \_timeslice, Operation, ObjectID, status<br />\| fields - \_count <br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Added and Deleted Users - Trend|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Add user" or "Delete user")<br />\| json "Workload", "Operation", "ObjectId", "ResultStatus"<br />\| where workLoad = "AzureActiveDirectory" and Operation in ("Delete user.", "Add user.")<br />\| ResultStatus as status<br />\| timeslice 1d<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by Operation, status, \_timeslice<br />\| transpose row \_timeslice column operation, status|
|Microsoft Office 365/Azure Active Directory|Added and Deleted Users - Trend|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Add user" or "Delete user")<br />\| json "Workload", "Operation", "ObjectId", "ResultStatus"<br />\| where workLoad = "AzureActiveDirectory" and Operation in ("Delete user.", "Add user.")<br />\| ResultStatus as status<br />\| timeslice 1d<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by Operation, status, \_timeslice<br />\| transpose row \_timeslice column operation, status|
|Microsoft Office 365/Azure Active Directory|Added or Removed Members from Group|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Add member to group." or "Remove member from group.") <br />\| json "ObjectId", "UserId", "Workload", "Operation", "ResultStatus"<br />\|json "ModifiedProperties[0].Name", "ModifiedProperties[1].Name", "ModifiedProperties[0].NewValue", "ModifiedProperties[1].NewValue" as InputField0, InputField1, InputFieldValue0, InputFieldValue1 nodrop<br />\| where workLoad = "AzureActiveDirectory" and Operation in ("Add member to group.", "Remove member from group.")<br />\| "" as groupName<br />\| if (InputField0 = "Group.DisplayName", InputFieldValue0, if (InputField1 = "Group.DisplayName", InputFieldValue1, groupName ) ) as groupName<br />\| ResultStatus as status<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{groupname}}" = "\*", true, groupname matches "{{groupname}}")<br />\|count as eventCount by \_timeslice, Operation, ObjectId, UserId, groupName, status<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Added or Removed Members from Group|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Add member to group." or "Remove member from group.") <br />\| json "ObjectId", "UserId", "Workload", "Operation", "ResultStatus"<br />\|json "ModifiedProperties[0].Name", "ModifiedProperties[1].Name", "ModifiedProperties[0].NewValue", "ModifiedProperties[1].NewValue" as InputField0, InputField1, InputFieldValue0, InputFieldValue1 nodrop<br />\| where workLoad = "AzureActiveDirectory" and Operation in ("Add member to group.", "Remove member from group.")<br />\| "" as groupName<br />\| if (InputField0 = "Group.DisplayName", InputFieldValue0, if (InputField1 = "Group.DisplayName", InputFieldValue1, groupName ) ) as groupName<br />\| ResultStatus as status<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{groupname}}" = "\*", true, groupname matches "{{groupname}}")<br />\|count as eventCount by \_timeslice, Operation, ObjectId, UserId, groupName, status<br />\| sort by \_timeslice|
|Microsoft Office 365|Azure AD Operations Trends|Logs|Installed Apps/Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   Workload CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Operation", "Workload"<br />\| where Workload="AzureActiveDirectory"<br />\| timeslice by 1h<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation |
|Microsoft Office 365|Azure AD Operations Trends|Logs|Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   Workload CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Operation", "Workload"<br />\| where Workload="AzureActiveDirectory"<br />\| timeslice by 1h<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation |
|Microsoft Office 365|Azure AD Operations Trends|Logs|Microsoft Office 365/Office 365 - Overview - New|\_sourceCategory = Labs/Microsoft/Office365 Workload CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Operation", "Workload"<br />\| where Workload="AzureActiveDirectory"<br />\| timeslice by 1h<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation |
|Microsoft Office 365/General/Activity by Location|Azure AD Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" "ClientIP"<br />\| json "Workload"<br />\| json "ClientIP" as src\_ip <br />\| where Workload = "AzureActiveDirectory"<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\|count by src\_ip <br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Azure AD Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" "ClientIP"<br />\| json "Workload"<br />\| json "ClientIP" as src\_ip <br />\| where Workload = "AzureActiveDirectory"<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\|count by src\_ip <br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Azure AD Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" "ClientIP"<br />\| json "Workload"<br />\| json "ClientIP" as src\_ip <br />\| where Workload = "AzureActiveDirectory"<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\|count by src\_ip <br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/Exchange|Clients by Country Over Time|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\| timeslice 1h<br />\| count by \_timeslice, ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where !isBlank(country\_name)<br />\| where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientipaddress}}" = "\*", true, ClientIPAddress matches "{{clientipaddress}}")<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name|
|Microsoft Office 365/Exchange|Clients by Country Over Time|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\| timeslice 1h<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by \_timeslice, ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where country\_name\<\>""<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name|
|Microsoft Office 365/Exchange|Clients by Country Over Time|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\| timeslice 1h<br />\| count by \_timeslice, ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where !isBlank(country\_name)<br />\| where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientipaddress}}" = "\*", true, ClientIPAddress matches "{{clientipaddress}}")<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name|
|Microsoft Office 365/Exchange|Clients by State Over Time|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\| timeslice 1h<br />\| count by \_timeslice, ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where country\_name="United States" and region\<\>""<br />\| where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientipaddress}}" = "\*", true, ClientIPAddress matches "{{clientipaddress}}")<br />\| count by \_timeslice, region<br />\| transpose row \_timeslice column region|
|Microsoft Office 365/Exchange|Clients by State Over Time|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\| timeslice 1h<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by \_timeslice, ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where country\_name="United States" and region\<\>""<br />\| count by \_timeslice, region<br />\| transpose row \_timeslice column region|
|Microsoft Office 365/Exchange|Clients by State Over Time|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\| timeslice 1h<br />\| count by \_timeslice, ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where country\_name="United States" and region\<\>""<br />\| where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientipaddress}}" = "\*", true, ClientIPAddress matches "{{clientipaddress}}")<br />\| count by \_timeslice, region<br />\| transpose row \_timeslice column region|
|Microsoft Office 365/Exchange|Configuration Changes (All)|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters // 1 stands for ExchangeAdmin <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId nodrop<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId nodrop<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer nodrop<br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and recordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId, ObjectId, OriginatingServer, Operation, Name, Value|
|Microsoft Office 365/Exchange|Configuration Changes (All)|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters // 1 stands for ExchangeAdmin <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId nodrop<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId nodrop<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer nodrop<br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and recordType=1<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId, ObjectId, OriginatingServer, Operation, Name, Value|
|Microsoft Office 365/Exchange|Configuration Changes (All)|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters // 1 stands for ExchangeAdmin <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId nodrop<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId nodrop<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer nodrop<br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and recordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId, ObjectId, OriginatingServer, Operation, Name, Value|
|Microsoft Office 365/Exchange|Configuration Changes by External Access|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" "\\"ExternalAccess\\":true" Parameters<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1 and ExternalAccess="true"<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId, ObjectId, OriginatingServer, Operation, Name, Value \| sort by Frequency|
|Microsoft Office 365/Exchange|Configuration Changes by External Access|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" "\\"ExternalAccess\\":true" Parameters<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1 and ExternalAccess="true"<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId, ObjectId, OriginatingServer, Operation, Name, Value \| sort by Frequency|
|Microsoft Office 365/Exchange|Configuration Changes by External Access|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" "\\"ExternalAccess\\":true" Parameters<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1 and ExternalAccess="true"<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId, ObjectId, OriginatingServer, Operation, Name, Value \| sort by Frequency|
|Microsoft Office 365/SharePoint|Content Checked In and Out Recently|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload  (FileCheckedOut or FileCheckedIn)<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation in ("FileCheckedOut", "FileCheckedIn")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count by SourceRelativeUrl, SourceFileName \| fields -\_count<br />\| urldecode(SourceRelativeUrl)<br />\| sort by SourceRelativeUrl asc, SourceFileName asc|
|Microsoft Office 365/SharePoint|Content Checked In and Out Recently|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload  (FileCheckedOut or FileCheckedIn)<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation in ("FileCheckedOut", "FileCheckedIn")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count by SourceRelativeUrl, SourceFileName \| fields -\_count<br />\| urldecode(SourceRelativeUrl)<br />\| sort by SourceRelativeUrl asc, SourceFileName asc|
|Microsoft Office 365|Demo - Geo Lookup on Suspicious IP|Logs|Installed Apps/Microsoft Office 365/Demo - Geo Lookup on Suspicious IP|\_sourceCategory={{Logsdatasource}}   CreationTime "Workload":"SharePoint" ClientIP<br />\| json "ClientIP" as src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip \| where src\_ip = "\<EnterSuspiciousIP\>"|
|Microsoft Office 365|Demo - Geo Lookup on Suspicious IP|Logs|Microsoft Office 365/Demo - Geo Lookup on Suspicious IP|\_sourceCategory={{Logsdatasource}}   CreationTime "Workload":"SharePoint" ClientIP<br />\| json "ClientIP" as src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip \| where src\_ip = "\<EnterSuspiciousIP\>"|
|Microsoft Office 365|Demo - Honing on Suspicious User|Logs|Microsoft Office 365/Demo - Honing on Suspicious User|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"SharePoint\\"" ClientIP UserId<br />\| json "ClientIP" as src\_ip<br />\| json "UserId" as userid<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where userid = "\<EnterSuspiciousUserID\>"|
|Microsoft Office 365|Demo - Honing on Suspicious User|Logs|Installed Apps/Microsoft Office 365/Demo - Honing on Suspicious User|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"SharePoint\\"" ClientIP UserId<br />\| json "ClientIP" as src\_ip<br />\| json "UserId" as userid<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where userid = "\<EnterSuspiciousUserID\>"|
|Microsoft Office 365|Demo - LogReduce on Suspicious IP|Logs|Installed Apps/Microsoft Office 365/Demo - LogReduce on Suspicious IP|\_sourceCategory={{Logsdatasource}}   "\<EnterSuspiciousIP\>" \| summarize|
|Microsoft Office 365|Demo - LogReduce on Suspicious IP|Logs|Microsoft Office 365/Demo - LogReduce on Suspicious IP|\_sourceCategory={{Logsdatasource}}   "\<EnterSuspiciousIP\>" \| summarize|
|Microsoft Office 365|Demo - Outlier|Logs|Installed Apps/Microsoft Office 365/Demo - Outlier|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"SharePoint\\"" "\<EnterSuspiciousIP\>"<br />\| json "Workload" <br />\| where workload="SharePoint" <br />\| timeslice 5m<br />\| count by \_timeslice<br />\| outlier \_count|
|Microsoft Office 365|Demo - Outlier|Logs|Microsoft Office 365/Demo - Outlier|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"SharePoint\\"" "\<EnterSuspiciousIP\>"<br />\| json "Workload" <br />\| where workload="SharePoint" <br />\| timeslice 5m<br />\| count by \_timeslice<br />\| outlier \_count|
|Microsoft Office 365/General/Activity by Location|Exchange  Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime ClientIPAddress "\\"Workload\\":\\"Exchange\\""<br />\| json "Workload"<br />\| json "ClientIPAddress"  as src\_ip<br />\| where Workload = "Exchange"<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\|count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Exchange  Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location|\_sourceCategory={{Logsdatasource}}   CreationTime ClientIPAddress "\\"Workload\\":\\"Exchange\\""<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as src\_ip <br />\| where Workload = "Exchange" and !isBlank(src\_ip)<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Exchange  Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location|\_sourceCategory={{Logsdatasource}}   CreationTime ClientIPAddress "\\"Workload\\":\\"Exchange\\""<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as src\_ip <br />\| where Workload = "Exchange" and !isBlank(src\_ip)<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365|Exchange Operations|Logs|Microsoft Office 365/Office 365 - Overview - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\""<br />\| json "Operation", "Workload"<br />\| where Workload="Exchange"<br />\| timeslice by 1h<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365|Exchange Operations|Logs|Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\""<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| where Workload="Exchange"<br />\| timeslice by 1h<br />\| count by \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365|Exchange Operations|Logs|Installed Apps/Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\""<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| where Workload="Exchange"<br />\| timeslice by 1h<br />\| count by \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/Exchange|External Access|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" "\\"ExternalAccess\\":true" // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"," as OriginatingServer <br />\| parse "\\"OrganizationName\\":\\"\*\\"," as OrganizationName <br />\| parse "\\"MailboxOwnerUPN\\":\\"\*\\"," as MailboxOwnerUPN <br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"UserType\\":\*," as UserType<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| where WorkLoad="Exchange" and RecordType=2 and ExternalAccess="true"<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by ClientIPAddress, OriginatingServer, OrganizationName, MailboxOwnerUPN, LogonType, UserType, UserId, Operation<br />\| fields -\_count|
|Microsoft Office 365/Exchange|External Access|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" "\\"ExternalAccess\\":true" // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"," as OriginatingServer <br />\| parse "\\"OrganizationName\\":\\"\*\\"," as OrganizationName <br />\| parse "\\"MailboxOwnerUPN\\":\\"\*\\"," as MailboxOwnerUPN <br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"UserType\\":\*," as UserType<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| where WorkLoad="Exchange" and RecordType=2 and ExternalAccess="true"<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by ClientIPAddress, OriginatingServer, OrganizationName, MailboxOwnerUPN, LogonType, UserType, UserId, Operation<br />\| fields -\_count|
|Microsoft Office 365/Exchange|External Access|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" "\\"ExternalAccess\\":true" // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"," as OriginatingServer <br />\| parse "\\"OrganizationName\\":\\"\*\\"," as OrganizationName <br />\| parse "\\"MailboxOwnerUPN\\":\\"\*\\"," as MailboxOwnerUPN <br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"UserType\\":\*," as UserType<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| where WorkLoad="Exchange" and RecordType=2 and ExternalAccess="true"<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by ClientIPAddress, OriginatingServer, OrganizationName, MailboxOwnerUPN, LogonType, UserType, UserId, Operation<br />\| fields -\_count|
|Microsoft Office 365|Failed Activity by Workload|Logs|Installed Apps/Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   Workload Operation "ResultStatus" fail\* <br />\| json "Workload", "ResultStatus", "Operation" <br />\| where resultstatus matches "\*fail\*" or resultstatus matches "\*Fail\*"<br />\| timeslice 1h<br />\| count \_timeslice, workload <br />\| transpose row \_timeslice column workload|
|Microsoft Office 365|Failed Activity by Workload|Logs|Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   Workload Operation "ResultStatus" fail\* <br />\| json "Workload", "ResultStatus", "Operation" <br />\| where resultstatus matches "\*fail\*" or resultstatus matches "\*Fail\*"<br />\| timeslice 1h<br />\| count \_timeslice, workload <br />\| transpose row \_timeslice column workload|
|Microsoft Office 365|Failed Activity by Workload|Logs|Microsoft Office 365/Office 365 - Overview - New|\_sourceCategory = Labs/Microsoft/Office365 Workload Operation "ResultStatus" fail\* <br />\| json "Workload", "ResultStatus", "Operation" <br />\| where resultstatus matches "\*fail\*" or resultstatus matches "\*Fail\*"<br />\| timeslice 1h<br />\| count \_timeslice, workload <br />\| transpose row \_timeslice column workload|
|Microsoft Office 365/Azure Active Directory|Failed Activity Overtime|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   ResultStatus fail\* "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "ObjectId", "UserId","Operation","ResultStatus" as objectid, src\_user, action, resultstatus<br />\| where workLoad="AzureActiveDirectory" and resultstatus in ( "failed", "Failed")<br />\| timeslice 5m<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}")<br />\|count by \_timeslice, action<br />\| transpose row \_timeslice column action|
|Microsoft Office 365/Azure Active Directory|Failed Activity Overtime|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New|\_sourceCategory = Labs/Microsoft/Office365 ResultStatus fail\* "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "ObjectId", "UserId","Operation","ResultStatus" as objectid, src\_user, action, resultstatus<br />\| where workLoad="AzureActiveDirectory" and resultstatus matches "fail\*"<br />\| timeslice 5m<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}")<br />\|count by \_timeslice, action<br />\| transpose row \_timeslice column action|
|Microsoft Office 365/Azure Active Directory|Failed Activity Overtime|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   ResultStatus fail\* "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "ObjectId", "UserId","Operation","ResultStatus" as objectid, src\_user, action, resultstatus<br />\| where workLoad="AzureActiveDirectory" and resultstatus in ( "failed", "Failed")<br />\| timeslice 5m<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}")<br />\|count by \_timeslice, action<br />\| transpose row \_timeslice column action|
|Microsoft Office 365/Azure Active Directory|Failed Logins from US|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIP<br />\| where (country\_code = "US")<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Azure Active Directory|Failed Logins from US|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIP<br />\| where (country\_code = "US")<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Azure Active Directory|Failed Logins Outside the US|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIP<br />\| where !(country\_code = "US")<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Azure Active Directory|Failed Logins Outside the US|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIP<br />\| where !(country\_code = "US")<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/SharePoint|File Type Accessed|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload ItemType File  SourceFileExtension<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"SourceFileExtension\\":\\"\*\\"" as filetype<br />\| parse "\\"ItemType\\":\\"\*\\"" as itemtype<br />\| where workLoad in ("SharePoint", "OneDrive") and itemtype="File"<br />\| tolowercase(filetype) as filetype <br />\|count by filetype \| sort by \_count, filetype|
|Microsoft Office 365/SharePoint|File Type Accessed|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload ItemType File  SourceFileExtension<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"SourceFileExtension\\":\\"\*\\"" as filetype<br />\| parse "\\"ItemType\\":\\"\*\\"" as itemtype<br />\| where workLoad in ("SharePoint", "OneDrive") and itemtype="File"<br />\| tolowercase(filetype) as filetype <br />\|count by filetype \| sort by \_count, filetype|
|Microsoft Office 365/Exchange|Folders|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| parse field=Folder "\\"Id\\":\\"\*\\"," as Id \| parse field=Folder "\\"Path\\":\\"\*\\"" as Path  <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Path \| sort by Frequency, Path asc|
|Microsoft Office 365/Exchange|Folders|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| parse field=Folder "\\"Id\\":\\"\*\\"," as Id \| parse field=Folder "\\"Path\\":\\"\*\\"" as Path  <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Path \| sort by Frequency, Path asc|
|Microsoft Office 365/Exchange|Folders|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| parse field=Folder "\\"Id\\":\\"\*\\"," as Id \| parse field=Folder "\\"Path\\":\\"\*\\"" as Path  <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Path \| sort by Frequency, Path asc|
|Microsoft Office 365/Azure Active Directory|Login Failure Outlier|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1h<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by \_timeslice<br />\| outlier LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failure Outlier|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1h<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by \_timeslice<br />\| outlier LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failure Outlier|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1h<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by \_timeslice<br />\| outlier LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as eventCount by \_timeslice, Operation, ObjectId, UserId, ClientIP<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Login Failures|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as eventCount by \_timeslice, Operation, ObjectId, UserId, ClientIP<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Login Failures|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as eventCount by \_timeslice, Operation, ObjectId, UserId, ClientIP<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Login Failures by ClientIP|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by ClientIP <br />\| top 10 ClientIP by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by ClientIP|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by ClientIP <br />\| top 10 ClientIP by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by ClientIP|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by ClientIP <br />\| top 10 ClientIP by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by Error|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" "LogonError" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId", "LogonError"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{logonerror}}" = "\*", true, logonerror matches "{{logonerror}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by LogonError \| sort by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by Error|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" "LogonError" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId", "LogonError"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{logonerror}}" = "\*", true, logonerror matches "{{logonerror}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by LogonError \| sort by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by Error|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" "LogonError" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId", "LogonError"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{logonerror}}" = "\*", true, logonerror matches "{{logonerror}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by LogonError \| sort by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by Operation|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by Operation \| sort by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by Operation|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by Operation \| sort by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by Operation|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as LoginFailureCount by Operation \| sort by LoginFailureCount|
|Microsoft Office 365/Azure Active Directory|Login Failures by User - Trend|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" "LogonError" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId", "LogonError"<br />\| if (ObjectId="Unknown", UserId, ObjectId) as ObjectId<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1h<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{logonerror}}" = "\*", true, logonerror matches "{{logonerror}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ObjectId, \_timeslice<br />\| transpose row \_timeslice column ObjectId|
|Microsoft Office 365/Azure Active Directory|Login Failures by User - Trend|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" "LogonError" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId", "LogonError"<br />\| if (ObjectId="Unknown", UserId, ObjectId) as ObjectId<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1h<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{logonerror}}" = "\*", true, logonerror matches "{{logonerror}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ObjectId, \_timeslice<br />\| transpose row \_timeslice column ObjectId|
|Microsoft Office 365/Azure Active Directory|Login Failures by User - Trend|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" "LogonError" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed) failed<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId", "LogonError"<br />\| if (ObjectId="Unknown", UserId, ObjectId) as ObjectId<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed") and ResultStatus in ("failed", "Failed")<br />\| timeslice 1h<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{logonerror}}" = "\*", true, logonerror matches "{{logonerror}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ObjectId, \_timeslice<br />\| transpose row \_timeslice column ObjectId|
|Microsoft Office 365/Azure Active Directory|Logins Attempts from Multiple ClientIPs (within 15m)|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed or UserLoggedIn)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed", "UserLoggedIn")<br />\| timeslice 15m<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count\_distinct(ClientIp) as Unique\_ClientIPs by ObjectId, UserId, \_timeslice<br />\| 1 as threshold // This value can be configured if required in the query<br />\| where Unique\_ClientIPs \> threshold \| fields -threshold<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Logins Attempts from Multiple ClientIPs (within 15m)|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed or UserLoggedIn)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed", "UserLoggedIn")<br />\| timeslice 15m<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count\_distinct(ClientIp) as Unique\_ClientIPs by ObjectId, UserId, \_timeslice<br />\| 1 as threshold // This value can be configured if required in the query<br />\| where Unique\_ClientIPs \> threshold \| fields -threshold<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Logins Attempts from Multiple ClientIPs (within 15m)|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoginFailed or UserLoggedIn)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoginFailed", "UserLoggedIn")<br />\| timeslice 15m<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count\_distinct(ClientIp) as Unique\_ClientIPs by ObjectId, UserId, \_timeslice<br />\| 1 as threshold // This value can be configured if required in the query<br />\| where Unique\_ClientIPs \> threshold \| fields -threshold<br />\| sort by \_timeslice|
|Microsoft Office 365/Exchange|Logon Types|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" LogonType<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| where WorkLoad="Exchange"<br />\|count as Frequency by LogonType<br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\|where if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}")<br />\| sort by Frequency, LogonType asc|
|Microsoft Office 365/Exchange|Logon Types|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" LogonType<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| where WorkLoad="Exchange"<br />\|count as Frequency by LogonType<br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\|where if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}")<br />\| sort by Frequency, LogonType asc|
|Microsoft Office 365/Exchange|Logon Types|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" "LogonType" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by LogonType|
|Microsoft Office 365/Exchange|Logon Types|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" "LogonType" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by LogonType|
|Microsoft Office 365/Exchange|Logon Types|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" LogonType<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| where WorkLoad="Exchange"<br />\|where if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}")<br />\|count as Frequency by LogonType<br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| sort by Frequency, LogonType asc|
|Microsoft Office 365/Exchange|Logon Types|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" "LogonType" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by LogonType|
|Microsoft Office 365/SharePoint|Most Downloaded Content|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload Operation FileDownloaded  UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileDownloaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName<br />\| top 30 SourceRelativeUrl, SourceFileName by Frequency|
|Microsoft Office 365/SharePoint|Most Downloaded Content|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload Operation FileDownloaded  UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileDownloaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName<br />\| top 30 SourceRelativeUrl, SourceFileName by Frequency|
|Microsoft Office 365/General/Resource Access|Office 365 - Activity by Workload|Logs|Microsoft Office 365/General/Resource Access/Office 365 - Activity by Workload|\_sourceCategory={{Logsdatasource}}   Workload<br />\| json "Workload" <br />\| timeslice 1d<br />\| count \_timeslice, workload <br />\| transpose row \_timeslice column workload|
|Microsoft Office 365/General/Resource Access|Office 365 - Activity by Workload|Logs|Installed Apps/Microsoft Office 365/General/Resource Access/Office 365 - Activity by Workload|\_sourceCategory={{Logsdatasource}}   Workload<br />\| json "Workload" <br />\| timeslice 1d<br />\| count \_timeslice, workload <br />\| transpose row \_timeslice column workload|
|Microsoft Office 365/General/Activity by Location|Office 365 - All Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - All Transactions by Client Location|\_sourceCategory={{Logsdatasource}}   CreationTime Workload (ClientIP or ClientIPAddress) <br />\| json "Workload"<br />\| json "ClientIP" as src\_ip\_1 nodrop // for non-Exchange<br />\| json "ClientIPAddress" as src\_ip\_2 nodrop //  for Exchange<br />\| if (workload="Exchange", src\_ip\_2, src\_ip\_1) as src\_ip<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Office 365 - All Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - All Transactions by Client Location|\_sourceCategory={{Logsdatasource}}   CreationTime Workload (ClientIP or ClientIPAddress) <br />\| json "Workload"<br />\| json "ClientIP" as src\_ip\_1 nodrop // for non-Exchange<br />\| json "ClientIPAddress" as src\_ip\_2 nodrop //  for Exchange<br />\| if (workload="Exchange", src\_ip\_2, src\_ip\_1) as src\_ip<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Resource Access|Office 365 - Azure Active Directory - Operations Trends|Logs|Microsoft Office 365/General/Resource Access/Office 365 - Azure Active Directory - Operations Trends|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" "Operation"<br />\| json "Workload", "Operation" <br />\| where workload = "AzureActiveDirectory"<br />\| timeslice by 1d<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/General/Resource Access|Office 365 - Azure Active Directory - Operations Trends|Logs|Installed Apps/Microsoft Office 365/General/Resource Access/Office 365 - Azure Active Directory - Operations Trends|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" "Operation"<br />\| json "Workload", "Operation" <br />\| where workload = "AzureActiveDirectory"<br />\| timeslice by 1d<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/General/Activity by Location|Office 365 - Azure Active Directory - Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Azure Active Directory - Transactions by Client Location|\_sourceCategory={{Logsdatasource}}   CreationTime ClientIP "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "ClientIP"  as src\_ip<br />\| where Workload = "AzureActiveDirectory"<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Office 365 - Azure Active Directory - Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Azure Active Directory - Transactions by Client Location|\_sourceCategory={{Logsdatasource}}   CreationTime ClientIP "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "ClientIP"  as src\_ip<br />\| where Workload = "AzureActiveDirectory"<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Resource Access|Office 365 - Exchange - Operations Trends|Logs|Microsoft Office 365/General/Resource Access/Office 365 - Exchange - Operations Trends|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "Operation"<br />\| json "Workload","Operation"<br />\| where workload = "Exchange"<br />\| timeslice by 1d<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/General/Resource Access|Office 365 - Exchange - Operations Trends|Logs|Installed Apps/Microsoft Office 365/General/Resource Access/Office 365 - Exchange - Operations Trends|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "Operation"<br />\| json "Workload","Operation"<br />\| where workload = "Exchange"<br />\| timeslice by 1d<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/Exchange|Office 365 - Exchange - Top Users|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Top Users|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" UserId<br />\| json "UserId" as user <br />\| count by user<br />\| top 10 user by \_count|
|Microsoft Office 365/Exchange|Office 365 - Exchange - Top Users|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Top Users|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" UserId<br />\| json "UserId" as user <br />\| count by user<br />\| top 10 user by \_count|
|Microsoft Office 365/General/Activity by Location|Office 365 - Exchange - Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Exchange - Transactions by Client Location|\_sourceCategory={{Logsdatasource}}   CreationTime ClientIPAddress "\\"Workload\\":\\"Exchange\\""<br />\| json "Workload"<br />\| json "ClientIPAddress"  as src\_ip<br />\| where Workload = "Exchange"<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Office 365 - Exchange - Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Exchange - Transactions by Client Location|\_sourceCategory={{Logsdatasource}}   CreationTime ClientIPAddress "\\"Workload\\":\\"Exchange\\""<br />\| json "Workload"<br />\| json "ClientIPAddress"  as src\_ip<br />\| where Workload = "Exchange"<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/SharePoint|Office 365 - SharePoint - Log Parser|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Log Parser|\_sourceCategory={{Logsdatasource}}   Workload SiteUrl <br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"SiteUrl\\":\\"\*\\"" as siteUrl<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP|
|Microsoft Office 365/SharePoint|Office 365 - SharePoint - Log Parser|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Log Parser|\_sourceCategory={{Logsdatasource}}   Workload SiteUrl <br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"SiteUrl\\":\\"\*\\"" as siteUrl<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP|
|Microsoft Office 365/General/Activity by Location|Office 365 - SharePoint - One Drive - Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - SharePoint - One Drive - Transactions by Client Location|\_sourceCategory={{Logsdatasource}}   CreationTime ClientIP ("\\"Workload\\":\\"SharePoint\\"" or "\\"Workload\\":\\"OneDrive\\"")<br />\| json "Workload", "Operation"<br />\| json "ClientIP"  as src\_ip<br />\| where workload in ("SharePoint","OneDrive")<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Office 365 - SharePoint - One Drive - Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - SharePoint - One Drive - Transactions by Client Location|\_sourceCategory={{Logsdatasource}}   CreationTime ClientIP ("\\"Workload\\":\\"SharePoint\\"" or "\\"Workload\\":\\"OneDrive\\"")<br />\| json "Workload", "Operation"<br />\| json "ClientIP"  as src\_ip<br />\| where workload in ("SharePoint","OneDrive")<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Resource Access|Office 365 - Sharepoint or OneDrive - Operations Trends|Logs|Installed Apps/Microsoft Office 365/General/Resource Access/Office 365 - Sharepoint or OneDrive - Operations Trends|\_sourceCategory={{Logsdatasource}}   ("\\"Workload\\":\\"SharePoint\\"" or "\\"Workload\\":\\"OneDrive\\"") "Operation"<br />\| json "Workload", "Operation"<br />\| where workload in ("SharePoint","OneDrive")<br />\| timeslice by 1d<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/General/Resource Access|Office 365 - Sharepoint or OneDrive - Operations Trends|Logs|Microsoft Office 365/General/Resource Access/Office 365 - Sharepoint or OneDrive - Operations Trends|\_sourceCategory={{Logsdatasource}}   ("\\"Workload\\":\\"SharePoint\\"" or "\\"Workload\\":\\"OneDrive\\"") "Operation"<br />\| json "Workload", "Operation"<br />\| where workload in ("SharePoint","OneDrive")<br />\| timeslice by 1d<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/General/Activity by Location|Office 365 Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime Workload (ClientIP or ClientIPAddress) <br />\| json "Workload"<br />\| json "ClientIP" as src\_ip\_1 nodrop // for non-Exchange<br />\| json "ClientIPAddress" as src\_ip\_2 nodrop //  for Exchange<br />\| if (workload="Exchange", src\_ip\_2, src\_ip\_1) as src\_ip<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\|count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Office 365 Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location|\_sourceCategory={{Logsdatasource}}   CreationTime Workload (ClientIP or ClientIPAddress) <br />\| json "Workload"<br />\| json "ClientIP" as src\_ip\_1 nodrop // for non-Exchange<br />\| json "ClientIPAddress" as src\_ip\_2 nodrop //  for Exchange<br />\| if (workload="Exchange", src\_ip\_2, src\_ip\_1) as src\_ip<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|Office 365 Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location|\_sourceCategory={{Logsdatasource}}   CreationTime Workload (ClientIP or ClientIPAddress) <br />\| json "Workload"<br />\| json "ClientIP" as src\_ip\_1 nodrop // for non-Exchange<br />\| json "ClientIPAddress" as src\_ip\_2 nodrop //  for Exchange<br />\| if (workload="Exchange", src\_ip\_2, src\_ip\_1) as src\_ip<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\| count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/Azure Active Directory|Password Resets and Changes|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Reset user password" or "Change user password")<br />\| json "Workload", "Operation", "ObjectId", "ResultStatus"<br />\| where workLoad = "AzureActiveDirectory" and Operation in ("Change user password.", "Reset user password.")<br />\| ResultStatus as status<br />\| timeslice 1s<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by \_timeslice, Operation, ObjectID, status<br />\| fields - \_count<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Password Resets and Changes|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Reset user password" or "Change user password")<br />\| json "Workload", "Operation", "ObjectId", "ResultStatus"<br />\| where workLoad = "AzureActiveDirectory" and Operation in ("Change user password.", "Reset user password.")<br />\| ResultStatus as status<br />\| timeslice 1s<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by \_timeslice, Operation, ObjectID, status<br />\| fields - \_count<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Password Resets and Changes - Trend|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Reset user password" or "Change user password")<br />\| json "Workload", "Operation", "ObjectId", "ResultStatus"<br />\| where workLoad = "AzureActiveDirectory" and Operation in ("Change user password.", "Reset user password.")<br />\| ResultStatus as status<br />\| timeslice 1d<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by Operation, status, \_timeslice<br />\| transpose row \_timeslice column operation, status|
|Microsoft Office 365/Azure Active Directory|Password Resets and Changes - Trend|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - User, Account Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" ("Reset user password" or "Change user password")<br />\| json "Workload", "Operation", "ObjectId", "ResultStatus"<br />\| where workLoad = "AzureActiveDirectory" and Operation in ("Change user password.", "Reset user password.")<br />\| ResultStatus as status<br />\| timeslice 1d<br />\|where if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by Operation, status, \_timeslice<br />\| transpose row \_timeslice column operation, status|
|Microsoft Office 365/Exchange|Recent Activities (All)|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType<br />\| sort by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType, \_count \| fields -\_count|
|Microsoft Office 365/Exchange|Recent Activities (All)|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType<br />\| sort by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType, \_count \| fields -\_count|
|Microsoft Office 365/Exchange|Recent Activities (All)|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType<br />\| sort by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType, \_count \| fields -\_count|
|Microsoft Office 365/Exchange|Recent Activities (External Access)|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" "\\"ExternalAccess\\":true" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3 and ExternalAccess="true"<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType<br />\| sort by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType, \_count \| fields -\_count|
|Microsoft Office 365/Exchange|Recent Activities (External Access)|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" "\\"ExternalAccess\\":true" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3 and ExternalAccess="true"<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType<br />\| sort by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType, \_count \| fields -\_count|
|Microsoft Office 365/Exchange|Recent Activities (External Access)|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" "\\"ExternalAccess\\":true" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3 and ExternalAccess="true"<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType<br />\| sort by \_timeslice, UserId, clientipaddress, OriginatingServer, Operation, ClientProcessName, ClientVersion, LogonType, \_count \| fields -\_count|
|Microsoft Office 365/Exchange|Recent Parameter Changes|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by Name \| sort by Frequency, Name asc|
|Microsoft Office 365/Exchange|Recent Parameter Changes|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by Name \| sort by Frequency, Name asc|
|Microsoft Office 365/Exchange|Recent Parameter Changes|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by Name \| sort by Frequency, Name asc|
|Microsoft Office 365/SharePoint|Recent Uploads by Non-Domain Users|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileUploaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileUploaded"<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName  \| sort by Frequency|
|Microsoft Office 365/SharePoint|Recent Uploads by Non-Domain Users|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileUploaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileUploaded"<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName  \| sort by Frequency|
|Microsoft Office 365/SharePoint|Recently Uploaded Content|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload  operation FileUploaded<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation="FileUploaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName, userId \| fields -Frequency|
|Microsoft Office 365/SharePoint|Recently Uploaded Content|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload  operation FileUploaded<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation="FileUploaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName, userId \| fields -Frequency|
|Microsoft Office 365|SharePoint Operations|Logs|Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   CreationTime Workload ("\\"Workload\\":\\"SharePoint\\"" or "\\"Workload\\":\\"OneDrive\\"")<br />\| json "Operation", "Workload"<br />\| where Workload in ("SharePoint", "OneDrive")<br />\| timeslice by 1h<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365|SharePoint Operations|Logs|Installed Apps/Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   CreationTime Workload ("\\"Workload\\":\\"SharePoint\\"" or "\\"Workload\\":\\"OneDrive\\"")<br />\| json "Operation", "Workload"<br />\| where Workload in ("SharePoint", "OneDrive")<br />\| timeslice by 1h<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365|SharePoint Operations|Logs|Microsoft Office 365/Office 365 - Overview - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime Workload ("\\"Workload\\":\\"SharePoint\\"" or "\\"Workload\\":\\"OneDrive\\"")<br />\| json "Operation", "Workload"<br />\| where Workload in ("SharePoint", "OneDrive")<br />\| timeslice by 1h<br />\| count \_timeslice, operation <br />\| transpose row \_timeslice column operation|
|Microsoft Office 365/General/Activity by Location|SP and  OD Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "ClientIP" ( "\\"Workload\\":\\"SharePoint\\"" or  "\\"Workload\\":\\"OneDrive\\"" ) <br />\| json "Workload", "Operation"<br />\| json "ClientIP" as src\_ip<br />\| where workload in ("SharePoint","OneDrive")<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|SP and  OD Transactions by Client Location|Logs|Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location|\_sourceCategory={{Logsdatasource}}   CreationTime "ClientIP" ( "\\"Workload\\":\\"SharePoint\\"" or  "\\"Workload\\":\\"OneDrive\\"" ) <br />\| json "Workload", "Operation"<br />\| json "ClientIP" as src\_ip<br />\| where workload in ("SharePoint","OneDrive")<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\|count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365/General/Activity by Location|SP and  OD Transactions by Client Location|Logs|Installed Apps/Microsoft Office 365/General/Activity by Location/Office 365 - Usage by Location|\_sourceCategory={{Logsdatasource}}   CreationTime "ClientIP" ( "\\"Workload\\":\\"SharePoint\\"" or  "\\"Workload\\":\\"OneDrive\\"" ) <br />\| json "Workload", "Operation"<br />\| json "ClientIP" as src\_ip<br />\| where workload in ("SharePoint","OneDrive")<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{workload}}" = "\*", true, workload matches "{{workload}}")<br />\|count by src\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Microsoft Office 365|Successful Activity by Workload|Logs|Installed Apps/Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   Workload Operation ResultStatus<br />\| json "Workload", "ResultStatus" nodrop<br />\| where !(resultstatus matches "\*fail\*") and !(resultstatus matches "\*Fail\*") and !isBlank(Workload)<br />\| timeslice 1h<br />\| count by \_timeslice, workload <br />\| transpose row \_timeslice column workload|
|Microsoft Office 365|Successful Activity by Workload|Logs|Microsoft Office 365/Office 365 - Overview - New|\_sourceCategory = Labs/Microsoft/Office365 Workload Operation ResultStatus<br />\| json "Workload", "ResultStatus" nodrop<br />\| where !(resultstatus matches "\*fail\*") and !(resultstatus matches "\*Fail\*")<br />\| timeslice 1h<br />\| count \_timeslice, workload <br />\| transpose row \_timeslice column workload|
|Microsoft Office 365|Successful Activity by Workload|Logs|Microsoft Office 365/Office 365 - Overview|\_sourceCategory={{Logsdatasource}}   Workload Operation ResultStatus<br />\| json "Workload", "ResultStatus" nodrop<br />\| where !(resultstatus matches "\*fail\*") and !(resultstatus matches "\*Fail\*") and !isBlank(Workload)<br />\| timeslice 1h<br />\| count by \_timeslice, workload <br />\| transpose row \_timeslice column workload|
|Microsoft Office 365/Azure Active Directory|Successful Logins|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as eventCount by \_timeslice, Operation, ObjectId, UserId, ClientIP<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Successful Logins|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as eventCount by \_timeslice, Operation, ObjectId, UserId, ClientIP<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Successful Logins|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Succeeded")<br />\| timeslice 1s<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as eventCount by \_timeslice, Operation, ObjectId, UserId, ClientIP<br />\| sort by \_timeslice|
|Microsoft Office 365/Azure Active Directory|Successful Logins by ClientIP|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount by ClientIP <br />\| top 10 ClientIP by SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins by ClientIP|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount by ClientIP <br />\| top 10 ClientIP by SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins by ClientIP|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount by ClientIP <br />\| top 10 ClientIP by SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins by Operation|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount by Operation \| sort by SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins by Operation|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount by Operation \| sort by SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins by Operation|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Monitoring - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as SuccessfulLoginCount by Operation \| sort by SuccessfulLoginCount|
|Microsoft Office 365/Azure Active Directory|Successful Logins from US|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload= "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIP<br />\| where (country\_code = "US")<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Azure Active Directory|Successful Logins from US|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload= "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIP<br />\| where (country\_code = "US")<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Azure Active Directory|Successful Logins Outside the US|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIP<br />\| where !(country\_code = "US")<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Azure Active Directory|Successful Logins Outside the US|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory - Login Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"AzureActiveDirectory\\"" (PasswordLogonInitialAuthUsingADFSFederatedToken or PasswordLogonInitialAuthUsingPassword or UserLoggedIn) (success or Succeeded)<br />\| json "Workload", "Operation", "ClientIP", "ResultStatus", "ObjectId", "UserId"<br />\| where Workload = "AzureActiveDirectory" and Operation in ("PasswordLogonInitialAuthUsingADFSFederatedToken", "PasswordLogonInitialAuthUsingPassword", "UserLoggedIn") and ResultStatus in ("success", "Success", "Succeeded")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{resultstatus}}" = "\*", true, resultstatus matches "{{resultstatus}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIP<br />\| where !(country\_code = "US")<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/SharePoint|Top 10 Active IPs|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive")<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count clientIP <br />\| top 10 clientIP by \_count|
|Microsoft Office 365/SharePoint|Top 10 Active IPs|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive")<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count clientIP <br />\| top 10 clientIP by \_count|
|Microsoft Office 365/SharePoint|Top 10 Active IPs|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad="SharePoint"<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count clientIP <br />\| top 10 clientIP by \_count|
|Microsoft Office 365/SharePoint|Top 10 Active Users|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload  UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| where workLoad in ("SharePoint", "OneDrive")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}")<br />\|count userId<br />\| top 10 userId by \_count|
|Microsoft Office 365/Exchange|Top 10 Active Users|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" UserId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer <br />\| parse "\\"UserType\\":\*," as UserType<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{usertype}}" = "\*", true, usertype matches "{{usertype}}")<br />\|count as Frequency by UserId \| top 10 UserId by Frequency|
|Microsoft Office 365/Exchange|Top 10 Active Users|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer<br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by UserId \| top 10 UserId by Frequency|
|Microsoft Office 365/Exchange|Top 10 Active Users|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" UserId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer <br />\| parse "\\"UserType\\":\*," as UserType<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{usertype}}" = "\*", true, usertype matches "{{usertype}}")<br />\|count as Frequency by UserId \| top 10 UserId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Active Users|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| where workLoad="SharePoint"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}")<br />\|count userId<br />\| top 10 userId by \_count|
|Microsoft Office 365/Exchange|Top 10 Active Users|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer<br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by UserId \| top 10 UserId by Frequency|
|Microsoft Office 365/Exchange|Top 10 Active Users|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer<br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by UserId \| top 10 UserId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Active Users|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload  UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| where workLoad in ("SharePoint", "OneDrive")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}")<br />\|count userId<br />\| top 10 userId by \_count|
|Microsoft Office 365/Exchange|Top 10 Active Users|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" UserId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer <br />\| parse "\\"UserType\\":\*," as UserType<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{usertype}}" = "\*", true, usertype matches "{{usertype}}")<br />\|count as Frequency by UserId \| top 10 UserId by Frequency|
|Microsoft Office 365/Exchange|Top 10 Clients|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress (ClientVersion or ClientMachineName or ClientProcessName) // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| parse "\\"ClientMachineName\\":\\"\*\\"" as  ClientMachineName nodrop<br />\| parse "\\"ClientProcessName\\":\\"\*\\"" as  ClientProcessName nodrop<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as  ClientVersion nodrop<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| where Workload="Exchange" and RecordType=2<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, ClientVersion<br />\| where ClientProcessName\<\>"" and ClientProcessName\<\>""<br />\| top 10 ClientProcessName, ClientVersion by Frequency|
|Microsoft Office 365/Exchange|Top 10 Clients|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, ClientVersion<br />\| where ClientProcessName\<\>"" and ClientProcessName\<\>""<br />\| top 10 ClientProcessName, ClientVersion by Frequency|
|Microsoft Office 365/Exchange|Top 10 Clients|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress (ClientVersion or ClientMachineName or ClientProcessName) // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| parse "\\"ClientMachineName\\":\\"\*\\"" as  ClientMachineName nodrop<br />\| parse "\\"ClientProcessName\\":\\"\*\\"" as  ClientProcessName nodrop<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as  ClientVersion nodrop<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| where Workload="Exchange" and RecordType=2<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, ClientVersion<br />\| where ClientProcessName\<\>"" and ClientProcessName\<\>""<br />\| top 10 ClientProcessName, ClientVersion by Frequency|
|Microsoft Office 365/Exchange|Top 10 Clients|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, ClientVersion<br />\| where ClientProcessName\<\>"" and ClientProcessName\<\>""<br />\| top 10 ClientProcessName, ClientVersion by Frequency|
|Microsoft Office 365/Exchange|Top 10 Clients|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress (ClientVersion or ClientMachineName or ClientProcessName) // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| parse "\\"ClientMachineName\\":\\"\*\\"" as  ClientMachineName nodrop<br />\| parse "\\"ClientProcessName\\":\\"\*\\"" as  ClientProcessName nodrop<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as  ClientVersion nodrop<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| where Workload="Exchange" and RecordType=2<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, ClientVersion<br />\| where ClientProcessName\<\>"" and ClientProcessName\<\>""<br />\| top 10 ClientProcessName, ClientVersion by Frequency|
|Microsoft Office 365/Exchange|Top 10 Clients|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"CreationTime\\":\\"\*\\"" as CreationTime<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload \| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation \| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress \| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName \| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess \| parse "\\"LogonType\\":\*," as LogonType <br />\| parse "\\"AffectedItems\\":[\*]," as AffectedItems \| parse "\\"CrossMailboxOperation\\":\*," as CrossMailboxOperation \| parse "\\"Folder\\":\*" as Folder<br />\| parse "\\"OriginatingServer\\":\\"\*\\\\r\\\\n\\"" as OriginatingServer <br />\| if (LogonType=0, "Owner", if (LogonType=1, "Admin", (if(LogonType=2, "Delegated", if (LogonType=3, "Transport", if (LogonType=4, "SystemService", if (LogonType=5, "BestAccess", if (LogonType=6, "DelegatedAdmin", "Unknown")))))))) as LogonType <br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, ClientVersion<br />\| where ClientProcessName\<\>"" and ClientProcessName\<\>""<br />\| top 10 ClientProcessName, ClientVersion by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Content Download by Non-Domain Users|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload "\\"Operation\\":\\"FileDownloaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileDownloaded"<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName \| top 10 SourceRelativeUrl, SourceFileName by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Content Download by Non-Domain Users|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload "\\"Operation\\":\\"FileDownloaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileDownloaded"<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName \| top 10 SourceRelativeUrl, SourceFileName by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Content Viewed by Non-Domain Users|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  ("\\"Operation\\":\\"FileViewed\\"" or "\\"Operation\\":\\"FileAccessed\\"") UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation in ("FileViewed", "FileAccessed")<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName \| top 25 SourceRelativeUrl, SourceFileName by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Content Viewed by Non-Domain Users|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  ("\\"Operation\\":\\"FileViewed\\"" or "\\"Operation\\":\\"FileAccessed\\"") UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation in ("FileViewed", "FileAccessed")<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName \| top 25 SourceRelativeUrl, SourceFileName by Frequency|
|Microsoft Office 365/Exchange|Top 10 Email Clients Used|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientInfoString // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\"" as  ClientProcessName nodrop<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as  ClientVersion nodrop<br />\| where Workload="Exchange" and RecordType=2 <br />\| parse regex field=ClientInfoString "^Client=(?\<email\_client\>[^\\"]\*)" nodrop<br />\| parse regex field=ClientInfoString "^Client=(?\<email\_client\>[^\\;]\*);(?\<email\_client\_version\>.\*);\$" nodrop<br />\| parse field=email\_client "\*;User=" as email\_client nodrop<br />\| if (isEmpty(email\_client\_version), ClientVersion, email\_client\_version) as email\_client\_version<br />\|where if ("{{email\_client}}" = "\*", true, email\_client matches "{{email\_client}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, email\_client, email\_client\_version <br />\| top 10 email\_client, ClientProcessName, email\_client\_version by Frequency|
|Microsoft Office 365/Exchange|Top 10 Email Clients Used|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientInfoString // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\"" as  ClientProcessName nodrop<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as  ClientVersion nodrop<br />\| where Workload="Exchange" and RecordType=2 <br />\| parse regex field=ClientInfoString "^Client=(?\<email\_client\>[^\\"]\*)" nodrop<br />\| parse regex field=ClientInfoString "^Client=(?\<email\_client\>[^\\;]\*);(?\<email\_client\_version\>.\*);\$" nodrop<br />\| parse field=email\_client "\*;User=" as email\_client nodrop<br />\| if (isEmpty(email\_client\_version), ClientVersion, email\_client\_version) as email\_client\_version<br />\|where if ("{{email\_client}}" = "\*", true, email\_client matches "{{email\_client}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, email\_client, email\_client\_version <br />\| top 10 email\_client, ClientProcessName, email\_client\_version by Frequency|
|Microsoft Office 365/Exchange|Top 10 Email Clients Used|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientInfoString // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\"" as  ClientProcessName nodrop<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as  ClientVersion nodrop<br />\| where Workload="Exchange" and RecordType=2 <br />\| parse regex field=ClientInfoString "^Client=(?\<email\_client\>[^\\"]\*)" nodrop<br />\| parse regex field=ClientInfoString "^Client=(?\<email\_client\>[^\\;]\*);(?\<email\_client\_version\>.\*);\$" nodrop<br />\| parse field=email\_client "\*;User=" as email\_client nodrop<br />\| if (isEmpty(email\_client\_version), ClientVersion, email\_client\_version) as email\_client\_version<br />\|where if ("{{email\_client}}" = "\*", true, email\_client matches "{{email\_client}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientProcessName, email\_client, email\_client\_version <br />\| top 10 email\_client, ClientProcessName, email\_client\_version by Frequency|
|Microsoft Office 365/Exchange|Top 10 IPs|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(ClientIPAddress)<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientIPAddress<br />\| top 10 ClientIPAddress by Frequency|
|Microsoft Office 365/Exchange|Top 10 IPs|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(ClientIPAddress)<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientIPAddress<br />\| top 10 ClientIPAddress by Frequency|
|Microsoft Office 365/Exchange|Top 10 IPs|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(ClientIPAddress)<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by ClientIPAddress<br />\| top 10 ClientIPAddress by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Most Viewed Content|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload  Operation (FileViewed or FileAccessed)<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation in ("FileViewed", "FileAccessed") and userId\<\>"SHAREPOINT\\\\\\\\system" and !(SourceRelativeUrl matches "Style Library/\*" or SourceRelativeUrl matches "sites/\*" or SourceRelativeUrl matches	"teams/\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName <br />\| top 10 SourceRelativeUrl, SourceFileName by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Most Viewed Content|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload  Operation (FileViewed or FileAccessed)<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation in ("FileViewed", "FileAccessed") and userId\<\>"SHAREPOINT\\\\\\\\system" and !(SourceRelativeUrl matches "Style Library/\*" or SourceRelativeUrl matches "sites/\*" or SourceRelativeUrl matches	"teams/\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by SourceRelativeUrl, SourceFileName <br />\| top 10 SourceRelativeUrl, SourceFileName by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Non-Domain Users Downloading|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileDownloaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileDownloaded"<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by userId \| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Non-Domain Users Downloading|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileDownloaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileDownloaded"<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by userId \| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Non-Domain Users Uploading|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileUploaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation="FileUploaded"<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by userId \| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Non-Domain Users Uploading|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileUploaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as SourceFileName<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| where workLoad in ("SharePoint", "OneDrive") and operation="FileUploaded"<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count as Frequency by userId \| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Non-Domain Users Viewing Content|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  ("\\"Operation\\":\\"FileViewed\\"" or "\\"Operation\\":\\"FileAccessed\\"") UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation in ("FileViewed", "FileAccessed")<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by userId \| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Non-Domain Users Viewing Content|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  ("\\"Operation\\":\\"FileViewed\\"" or "\\"Operation\\":\\"FileAccessed\\"") UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation in ("FileViewed", "FileAccessed")<br />\| parse field=userId "\*@\*" as username, targetdomain<br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by userId \| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Non-Domain Users With Access|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad \| parse "\\"UserId\\":\\"\*\\"" as userId \| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId \| parse "\\"Operation\\":\\"\*\\"" as operation \| parse "\\"UserSharedWith\\":\\"\*\\"" as UserSharedWith nodrop \| parse "\\"TargetUserOrGroupName\\":\\"\*\\"" as TargetUserOrGroupName nodrop<br />\| parse field=UserSharedWith "\*@\*" as targetusername, targetdomain nodrop<br />\| parse field=TargetUserOrGroupName "\*@\*" as target\_username, target\_domain nodrop<br />\| tolowercase (operation) as opr<br />\| where workLoad in ("SharePoint", "OneDrive") and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br /><br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\| where !(target\_domain matches "\*sumologic.com\*")<br />\| where !(isEmpty(targetusername) and isEmpty(target\_username))<br />\| where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") <br />\|count as Frequency by UserSharedWith, TargetUserOrGroupName \| top 10 UserSharedWith, TargetUserOrGroupName by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Non-Domain Users With Access|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload  UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad \| parse "\\"UserId\\":\\"\*\\"" as userId \| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId \| parse "\\"Operation\\":\\"\*\\"" as operation \| parse "\\"UserSharedWith\\":\\"\*\\"" as UserSharedWith nodrop \| parse "\\"TargetUserOrGroupName\\":\\"\*\\"" as TargetUserOrGroupName nodrop<br />\| parse field=UserSharedWith "\*@\*" as targetusername, targetdomain nodrop<br />\| parse field=TargetUserOrGroupName "\*@\*" as target\_username, target\_domain nodrop<br />\| tolowercase (operation) as opr<br />\| where workLoad in ("SharePoint", "OneDrive") and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br /><br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\| where !(target\_domain matches "\*sumologic.com\*")<br />\| where !(isEmpty(targetusername) and isEmpty(target\_username))<br />\| where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") <br />\|count as Frequency by UserSharedWith, TargetUserOrGroupName \| top 10 UserSharedWith, TargetUserOrGroupName by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters Operation<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by Operation \| top 10 Operation by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(Operation)<br />\|where if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Operation<br />\| top 10 Operation by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters Operation<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by Operation \| top 10 Operation by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(Operation)<br />\|where if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Operation<br />\| top 10 Operation by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(Operation)<br />\|where if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Operation<br />\| top 10 Operation by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer<br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Operation \| top 10 Operation by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer<br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Operation \| top 10 Operation by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Group Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":3" // 3 stands for ExchangeItemGroup<br />\| parse "\\"Workload\\":\\"\*\\"" as Workload<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress<br />\| parse "\\"ClientInfoString\\":\\"\*\\"" as ClientInfoString<br />\| parse "\\"ClientProcessName\\":\\"\*\\""  as ClientProcessName<br />\| parse "\\"ClientVersion\\":\\"\*\\"" as ClientVersion<br />\| parse "\\"ExternalAccess\\":\*," as ExternalAccess<br />\| parse "\\"LogonType\\":\*," as LogonType<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer<br />\| where Workload="Exchange" and recordType=3<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{clientprocessname}}" = "\*", true, clientprocessname matches "{{clientprocessname}}") AND if ("{{logontype}}" = "\*", true, logontype matches "{{logontype}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by Operation \| top 10 Operation by Frequency|
|Microsoft Office 365/Exchange|Top 10 Operations|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters Operation<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by Operation \| top 10 Operation by Frequency|
|Microsoft Office 365/SharePoint|Top 10 SiteUrl Accessed|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload SiteUrl <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"SiteUrl\\":\\"\*\\"" as siteUrl<br />\| where workLoad in ("SharePoint", "OneDrive")<br />\|where if ("{{siteurl}}" = "\*", true, siteurl matches "{{siteurl}}")<br />\|count siteUrl <br />\| urldecode(siteUrl)<br />\| top 10 siteUrl by \_count|
|Microsoft Office 365/SharePoint|Top 10 SiteUrl Accessed|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload SiteUrl <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"SiteUrl\\":\\"\*\\"" as siteUrl<br />\| where workLoad in ("SharePoint", "OneDrive")<br />\|where if ("{{siteurl}}" = "\*", true, siteurl matches "{{siteurl}}")<br />\|count siteUrl <br />\| urldecode(siteUrl)<br />\| top 10 siteUrl by \_count|
|Microsoft Office 365/Exchange|Top 10 Users|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(ClientIPAddress)<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/Exchange|Top 10 Users|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(ClientIPAddress)<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/Exchange|Top 10 Users|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and !isEmpty(ClientIPAddress)<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Users Downloading Content|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileDownloaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileDownloaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Users Downloading Content|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" "\\"Operation\\":\\"FileDownloaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| where workLoad="SharePoint" and operation="FileDownloaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Users Downloading Content|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileDownloaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileDownloaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Users Involved in Sharing Operations|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload  UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Operation\\":\\"\*\\"" as operation \| tolowercase (operation) as opr<br />\| where workLoad in ("SharePoint", "OneDrive")  and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count userid, operation<br />\| top 10 userid, operation by \_count|
|Microsoft Office 365/SharePoint|Top 10 Users Involved in Sharing Operations|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Operation\\":\\"\*\\"" as operation \| tolowercase (operation) as opr<br />\| where workLoad="SharePoint" and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count userid, operation<br />\| top 10 userid, operation by \_count|
|Microsoft Office 365/SharePoint|Top 10 Users Involved in Sharing Operations|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload  UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Operation\\":\\"\*\\"" as operation \| tolowercase (operation) as opr<br />\| where workLoad in ("SharePoint", "OneDrive")  and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count userid, operation<br />\| top 10 userid, operation by \_count|
|Microsoft Office 365/SharePoint|Top 10 Users Sharing Outside Domain|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload SiteUrl  UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad \| parse "\\"UserId\\":\\"\*\\"" as userId \| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId \| parse "\\"Operation\\":\\"\*\\"" as operation  \| parse "\\"UserSharedWith\\":\\"\*\\"" as UserSharedWith nodrop \| parse "\\"TargetUserOrGroupName\\":\\"\*\\"" as TargetUserOrGroupName nodrop <br />\| parse field=UserSharedWith "\*@\*" as targetusername, targetdomain nodrop<br />\| parse field=TargetUserOrGroupName "\*@\*" as target\_username, target\_domain nodrop<br />\| tolowercase (operation) as opr<br />\| where workLoad in ("SharePoint", "OneDrive")  and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br /><br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\| where !(target\_domain matches "\*sumologic.com\*")<br />\| where !(isEmpty(targetusername) and isEmpty(target\_username))<br />\| where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") <br />\|count as Frequency by userId, Operation \| top 10 UserId, Operation by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Users Sharing Outside Domain|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Shared Content Non-Domain Activities|\_sourceCategory={{Logsdatasource}}   Workload SiteUrl  UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad \| parse "\\"UserId\\":\\"\*\\"" as userId \| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId \| parse "\\"Operation\\":\\"\*\\"" as operation  \| parse "\\"UserSharedWith\\":\\"\*\\"" as UserSharedWith nodrop \| parse "\\"TargetUserOrGroupName\\":\\"\*\\"" as TargetUserOrGroupName nodrop <br />\| parse field=UserSharedWith "\*@\*" as targetusername, targetdomain nodrop<br />\| parse field=TargetUserOrGroupName "\*@\*" as target\_username, target\_domain nodrop<br />\| tolowercase (operation) as opr<br />\| where workLoad in ("SharePoint", "OneDrive")  and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br /><br />// configure your domian - sample  \*sumologic.com\*<br />\| where !(targetdomain matches "\*sumologic.com\*")<br />\| where !(target\_domain matches "\*sumologic.com\*")<br />\| where !(isEmpty(targetusername) and isEmpty(target\_username))<br />\| where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{targetdomain}}" = "\*", true, targetdomain matches "{{targetdomain}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") <br />\|count as Frequency by userId, Operation \| top 10 UserId, Operation by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Users Uploading Content|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileUploaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileUploaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Users Uploading Content|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload  "\\"Operation\\":\\"FileUploaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| where workLoad in ("SharePoint", "OneDrive")  and operation="FileUploaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/SharePoint|Top 10 Users Uploading Content|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" "\\"Operation\\":\\"FileUploaded\\"" UserId<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"Operation\\":\\"\*\\"" as operation<br />\| where workLoad="SharePoint" and operation="FileUploaded"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by userId<br />\| top 10 userId by Frequency|
|Microsoft Office 365/Azure Active Directory|Top Client IPs|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" ClientIP<br />\| json "Workload"<br />\| json "ClientIP" as src\_ip <br />\| where workLoad="AzureActiveDirectory"<br />\| timeslice 1h<br />\| count src\_ip,\_timeslice<br />//\| top 20 client\_ip by \_timeslice,\_count<br />\| transpose row \_timeslice column src\_ip|
|Microsoft Office 365/Azure Active Directory|Top Client IPs|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" ClientIP<br />\| json "Workload"<br />\| json "ClientIP" as src\_ip <br />\| where workLoad="AzureActiveDirectory"<br />\| timeslice 1h<br />\| count src\_ip,\_timeslice<br />//\| top 20 client\_ip by \_timeslice,\_count<br />\| transpose row \_timeslice column src\_ip|
|Microsoft Office 365/Azure Active Directory|Top Client IPs|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   CreationTime "\\"Workload\\":\\"AzureActiveDirectory\\"" ClientIP<br />\| json "Workload"<br />\| json "ClientIP" as src\_ip <br />\| where workLoad="AzureActiveDirectory"<br />\| timeslice 1h<br />\| count src\_ip,\_timeslice<br />//\| top 20 client\_ip by \_timeslice,\_count<br />\| transpose row \_timeslice column src\_ip|
|Microsoft Office 365/SharePoint|Top SharePoint Resources|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload   SourceRelativeUrl SourceFileName<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as sourcefilename<br />\| where workLoad in ("SharePoint", "OneDrive")<br />\|where if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count by SourceRelativeUrl, sourcefilename<br />\| urldecode(SourceRelativeUrl)<br />\| order by \_count \| limit 50|
|Microsoft Office 365/SharePoint|Top SharePoint Resources|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Content Insight|\_sourceCategory={{Logsdatasource}}   Workload   SourceRelativeUrl SourceFileName<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"SourceRelativeUrl\\":\\"\*\\"" as SourceRelativeUrl<br />\| parse "\\"SourceFileName\\":\\"\*\\"" as sourcefilename<br />\| where workLoad in ("SharePoint", "OneDrive")<br />\|where if ("{{sourcefilename}}" = "\*", true, sourcefilename matches "{{sourcefilename}}") AND if ("{{sourcerelativeurl}}" = "\*", true, sourcerelativeurl matches "{{sourcerelativeurl}}")<br />\|count by SourceRelativeUrl, sourcefilename<br />\| urldecode(SourceRelativeUrl)<br />\| order by \_count \| limit 50|
|Microsoft Office 365/SharePoint|Top Sharing Activities by User ID|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Operation\\":\\"\*\\"" as operation \| tolowercase (operation) as opr<br />\| where workLoad in ("SharePoint", "OneDrive")  and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count userid, operation <br />\| top 50 userid by \_count, operation<br />\| sort by \_count, userid|
|Microsoft Office 365/SharePoint|Top Sharing Activities by User ID|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Operation\\":\\"\*\\"" as operation \| tolowercase (operation) as opr<br />\| where workLoad="SharePoint" and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count userid, operation <br />\| top 50 userid by \_count, operation<br />\| sort by \_count, userid|
|Microsoft Office 365/SharePoint|Top Sharing Activities by User ID|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - User Activity|\_sourceCategory={{Logsdatasource}}   Workload UserId Operation (access\* or send\* or \*sharing\* or \*shared\*) <br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"UserId\\":\\"\*\\"" as userId<br />\| parse "\\"Operation\\":\\"\*\\"" as operation \| tolowercase (operation) as opr<br />\| where workLoad in ("SharePoint", "OneDrive")  and (opr matches "access\*" or opr matches "send\*" or opr matches "\*sharing\*" or opr matches "\*shared\*")<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count userid, operation <br />\| top 50 userid by \_count, operation<br />\| sort by \_count, userid|
|Microsoft Office 365/Azure Active Directory|Top Users by AAD Admin Activity|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   CreationTime\* "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "UserId"<br />\| where workLoad="AzureActiveDirectory"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}")<br />\|count userid <br />\| top 25 userid by \_count|
|Microsoft Office 365/Azure Active Directory|Top Users by AAD Admin Activity|Logs|Installed Apps/Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity|\_sourceCategory={{Logsdatasource}}   CreationTime\* "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "UserId"<br />\| where workLoad="AzureActiveDirectory"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}")<br />\|count userid <br />\| top 25 userid by \_count|
|Microsoft Office 365/Azure Active Directory|Top Users by AAD Admin Activity|Logs|Microsoft Office 365/Azure Active Directory/Office 365 - Active Directory Activity - New|\_sourceCategory = Labs/Microsoft/Office365 CreationTime\* "\\"Workload\\":\\"AzureActiveDirectory\\""<br />\| json "Workload"<br />\| json "UserId"<br />\| where workLoad="AzureActiveDirectory"<br />\|where if ("{{userid}}" = "\*", true, userid matches "{{userid}}")<br />\|count userid <br />\| top 25 userid by \_count|
|Microsoft Office 365/Exchange|United States Clients|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where workLoad="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\|count by ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where country\_name="United States"<br />\| where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientipaddress}}" = "\*", true, ClientIPAddress matches "{{clientipaddress}}")<br />\| count by ClientIPAddress, latitude, longitude, country\_code, country\_name, region, city, postal\_code|
|Microsoft Office 365/Exchange|United States Clients|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where workLoad="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\|count by ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where country\_name="United States"<br />\| where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientipaddress}}" = "\*", true, ClientIPAddress matches "{{clientipaddress}}")<br />\| count by ClientIPAddress, latitude, longitude, country\_code, country\_name, region, city, postal\_code|
|Microsoft Office 365/Exchange|United States Clients|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where workLoad="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where country\_name="United States"<br />\| count by ClientIPAddress, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}")|
|Microsoft Office 365/SharePoint|United States Visitors|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations|\_sourceCategory={{Logsdatasource}}   Workload  ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive")  and clientIP\<\>""<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where country\_name="United States" <br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/SharePoint|United States Visitors|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad="SharePoint" and clientIP\<\>""<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where country\_name="United States" <br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}")|
|Microsoft Office 365/SharePoint|United States Visitors|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations|\_sourceCategory={{Logsdatasource}}   Workload  ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive")  and clientIP\<\>""<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where country\_name="United States" <br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Exchange|User Types|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" "UserType"<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer <br />\| parse "\\"UserType\\":\*," as UserType<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{usertype}}" = "\*", true, usertype matches "{{usertype}}")<br />\|count as Frequency by UserType \| sort by Frequency, UserType asc|
|Microsoft Office 365/Exchange|User Types|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" "UserType"<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer <br />\| parse "\\"UserType\\":\*," as UserType<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{usertype}}" = "\*", true, usertype matches "{{usertype}}")<br />\|count as Frequency by UserType \| sort by Frequency, UserType asc|
|Microsoft Office 365/Exchange|User Types|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" "UserType"<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer <br />\| parse "\\"UserType\\":\*," as UserType<br />\| if (UserType=0, "Regular", if (UserType=1, "Reserved", (if(UserType=2, "Admin", if (UserType=3, "DcAdmin", if (UserType=4, "System", if (UserType=5, "Application", if (UserType=6, "ServicePrincipal", "Unknown")))))))) as UserType <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}") AND if ("{{usertype}}" = "\*", true, usertype matches "{{usertype}}")<br />\|count as Frequency by UserType \| sort by Frequency, UserType asc|
|Microsoft Office 365/Exchange|Users Making Configuration Changes|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters UserId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId \| sort by Frequency|
|Microsoft Office 365/Exchange|Users Making Configuration Changes|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters UserId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId \| sort by Frequency|
|Microsoft Office 365/Exchange|Users Making Configuration Changes|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Admin Audit|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":1" Parameters UserId<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as recordType<br />\| parse "\\"Operation\\":\\"\*\\"" as Operation<br />\| parse "\\"Parameters\\":\*" as Parameters<br />\| parse "\\"UserId\\":\\"\*\\"" as UserId<br />\| parse "\\"ObjectId\\":\\"\*\\"" as ObjectId<br />\| parse "\\"OriginatingServer\\":\\"\*\\"" as OriginatingServer  <br />\| parse regex field=Parameters "\\"Name\\":\\"(?\<Name\>[^\\"]\*)\\",\\n\\s+\\"Value\\":\\"(?\<Value\>[^\\"]\*)\\"" multi<br />\| where workLoad="Exchange" and RecordType=1<br />\| replace(OriginatingServer, /[\\\\n\|\\\\r]+/, "") as OriginatingServer<br />\|where if ("{{originatingserver}}" = "\*", true, originatingserver matches "{{originatingserver}}") AND if ("{{userid}}" = "\*", true, userid matches "{{userid}}") AND if ("{{objectid}}" = "\*", true, objectid matches "{{objectid}}") AND if ("{{operation}}" = "\*", true, operation matches "{{operation}}")<br />\|count as Frequency by UserId \| sort by Frequency|
|Microsoft Office 365/SharePoint|Visits by Country Over Time|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad="SharePoint" and clientIP\<\>""<br />\| timeslice 1h<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by \_timeslice, ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where !isEmpty(country\_name)<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \*|
|Microsoft Office 365/SharePoint|Visits by Country Over Time|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations|\_sourceCategory={{Logsdatasource}}   Workload ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive") and clientIP\<\>""<br />\| timeslice 1h<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by \_timeslice, ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where !isEmpty(country\_name)<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \*|
|Microsoft Office 365/SharePoint|Visits by Country Over Time|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations|\_sourceCategory={{Logsdatasource}}   Workload ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive") and clientIP\<\>""<br />\| timeslice 1h<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by \_timeslice, ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where !isEmpty(country\_name)<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \*|
|Microsoft Office 365/SharePoint|Visits by State Over Time|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad="SharePoint" and clientIP\<\>""<br />\| timeslice 1h<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by \_timeslice, ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where country\_name="United States" and !isEmpty(region)<br />\| count by \_timeslice, region<br />\| transpose row \_timeslice column region as \*|
|Microsoft Office 365/SharePoint|Visits by US States Over Time|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations|\_sourceCategory={{Logsdatasource}}   Workload  ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive")  and clientIP\<\>""<br />\| timeslice 1h<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by \_timeslice, ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where country\_name="United States" and !isEmpty(region)<br />\| count by \_timeslice, region<br />\| transpose row \_timeslice column region as \*|
|Microsoft Office 365/SharePoint|Visits by US States Over Time|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations|\_sourceCategory={{Logsdatasource}}   Workload  ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive")  and clientIP\<\>""<br />\| timeslice 1h<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by \_timeslice, ClientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where country\_name="United States" and !isEmpty(region)<br />\| count by \_timeslice, region<br />\| transpose row \_timeslice column region as \*|
|Microsoft Office 365/Exchange|Worldwide Clients|Logs|Installed Apps/Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\| count by ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientipaddress}}" = "\*", true, ClientIPAddress matches "{{clientipaddress}}")<br />\| where !isNull(latitude)<br />\| count by ClientIPAddress, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Exchange|Worldwide Clients|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations|\_sourceCategory={{Logsdatasource}}   "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\| count by ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientipaddress}}" = "\*", true, ClientIPAddress matches "{{clientipaddress}}")<br />\| where !isNull(latitude)<br />\| count by ClientIPAddress, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/Exchange|Worldwide Clients|Logs|Microsoft Office 365/Exchange/Office 365 - Exchange - Mailbox Audit - Client Locations - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"Exchange\\"" "\\"RecordType\\":2" ClientIPAddress // 2 stands for ExchangeItem - Events from an Exchange mailbox audit log for actions that are performed on a single item, such as creating or receiving an email message.<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"RecordType\\":\*," as RecordType <br />\| parse "\\"ClientIPAddress\\":\\"\*\\"" as ClientIPAddress <br />\| where Workload="Exchange" and RecordType=2 and ClientIPAddress\<\>""<br />\|where if ("{{clientipaddress}}" = "\*", true, clientipaddress matches "{{clientipaddress}}")<br />\|count by ClientIPAddress<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ClientIPAddress<br />\| where !isNull(latitude)<br />\| count by ClientIPAddress, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}")|
|Microsoft Office 365/SharePoint|Worldwide Visitors|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations - New|\_sourceCategory = Labs/Microsoft/Office365 "\\"Workload\\":\\"SharePoint\\"" ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad="SharePoint" and clientIP\<\>""<br />\|where if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by clientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where !isNull(latitude)<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}")|
|Microsoft Office 365/SharePoint|Worldwide Visitors|Logs|Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations|\_sourceCategory={{Logsdatasource}}   Workload  ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive")  and clientIP\<\>""<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by clientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where !isNull(latitude)<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Microsoft Office 365/SharePoint|Worldwide Visitors|Logs|Installed Apps/Microsoft Office 365/SharePoint/Office 365 - SharePoint - Visitor Locations|\_sourceCategory={{Logsdatasource}}   Workload  ClientIP<br />\| parse "\\"Workload\\":\\"\*\\"" as workLoad<br />\| parse "\\"ClientIP\\":\\"\*\\"" as clientIP<br />\| where workLoad in ("SharePoint", "OneDrive")  and clientIP\<\>""<br />\|where if ("{{region}}" = "\*", true, region matches "{{region}}") AND if ("{{clientip}}" = "\*", true, clientip matches "{{clientip}}")<br />\|count by clientIP<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = clientIP<br />\| where !isNull(latitude)<br />\| count by clientIP, latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|

