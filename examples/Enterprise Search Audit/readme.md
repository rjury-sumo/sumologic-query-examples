# Enterprise Search Audit
## Sumo Logic App For: Enterprise Search Audit
The Enterprise Search Audit App provides immediate visibility into your account's search activity and helps you identify areas of improvement. It gives an overview of search usage within your org, with a breakdown by analytic tiers and other relevant search metrics such as data scanned bytes etc. The pre-built dashboards also help you identify opportunities for improving search performance using the Search Audit Index. Before you can use the Enterprise Search Audit app, an administrator must first enable the Search Audit Index. For more information, see Enable and Manage the Search Audit Index in the Sumo Help doc.
Docs Link: [Enterprise Search Audit](https://help.sumologic.com/?cid=5117)

## Searches

### Log Searches

- **1op 10 Source Categories Referenced by Queries per Tier**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **1op 10 Source Categories Referenced by Queries per Tier**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New 
- **1op 10 Source Categories Referenced by Queries per Tier**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Aggregate vs Non-Aggregate Searches**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Aggregate vs Non-Aggregate Searches**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Aggregate vs Non-Aggregate Searches**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Avg Query RunTime (sec) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New 
- **Avg Query RunTime (sec) by Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Avg Query RunTime (sec) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Data Retrieved (GB) by Top 10 Users per Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Data Retrieved (GB) by Top 10 Users per Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Data Scanned (GB) by Top 10 Users per Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Data Scanned (GB) by Top 10 Users per Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Data Tier Searches**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Data Tier Searches**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Data Tier Searches**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Failed Searches by Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Failed Searches by Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Failed Searches by Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Interactive Dashboard**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Interactive Dashboard**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Interactive Dashboard**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Interactive Dashboard Queries without Metadata**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Interactive Dashboard Queries without Metadata**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Interactive Search**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Interactive Search**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Interactive Search**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Other Popular Keys Referenced by Queries**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Other Popular Keys Referenced by Queries**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Other Popular Keys Referenced by Queries**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New 
- **Other Search Types**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Other Search Types**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Other Search Types**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Popular Partitions and Views Referenced by Queries**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Popular Partitions and Views Referenced by Queries**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New 
- **Popular Partitions and Views Referenced by Queries**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Popular Source Categories Referenced by Queries**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Popular Source Categories Referenced by Queries**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New 
- **Popular Source Categories Referenced by Queries**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Queries by Optimization Techniques**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Queries by Optimization Techniques**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Queries by Optimization Techniques**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Queries by Optimization Techniques**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Query Count by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Query Count by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New 
- **Query Count by Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Query Count by Top 10 Users per Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Query Count by Top 10 Users per Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Query RunTime(sec) Percentiles**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Query RunTime(sec) Percentiles**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Query RunTime(sec) Percentiles**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New 
- **Query Time Range**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Query Time Range**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Retrieved (GB) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New 
- **Retrieved (GB) by Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Retrieved (GB) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Retrieved Bytes Used (GB) by Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Retrieved Bytes Used (GB) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New 
- **Retrieved Bytes Used (GB) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Scanned (GB) by Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Scanned (GB) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Scanned (GB) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New 
- **Scanned Bytes Used (GB) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New 
- **Scanned Bytes Used (GB) by Query Type**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Scanned Bytes Used (GB) by Query Type**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Scheduled Search**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Scheduled Search**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Scheduled Search**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Scheduled Searches without Metadata**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Scheduled Searches without Metadata**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Search API**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Search API**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Search API**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Search RunTime(sec) Percentiles**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Search RunTime(sec) Percentiles**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Search RunTime(sec) Percentiles**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Search Statistics**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Search Statistics**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Search Statistics**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Searches by Location**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Searches by Location**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Searches by Location**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Top 10 Partitions and Views Referenced by Queries per Tier**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Top 10 Partitions and Views Referenced by Queries per Tier**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New 
- **Top 10 Partitions and Views Referenced by Queries per Tier**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources 
- **Top 10 Users by Data Retrieved (GB)**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Top 10 Users by Data Retrieved (GB)**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Top 10 Users by Data Scanned (GB)**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Top 10 Users by Data Scanned (GB)**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Top 10 Users by Query Count**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Top 10 Users by Query Count**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Top 10 Users by Query Count per Tier**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Top 10 Users by Query Count per Tier**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights 
- **Total Scanned and Retrieved (GB)**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Total Scanned and Retrieved (GB)**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time 
- **Total Scanned and Retrieved (GB)**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New 
- **Total Searches**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Total Searches**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Total Searches**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Unoptimized Queries**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Unoptimized Queries**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve 
- **Users**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview 
- **Users**: from Dashboard: Enterprise Search Audit/Enterprise Search Audit - Search Overview - New 
- **Users**: from Dashboard: Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Enterprise Search Audit|1op 10 Source Categories Referenced by Queries per Tier|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "\_sourcecategory\\s\*=\\s\*(?\<meta\_sourcecategory\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_sourcecategory!=""<br />\| count by meta\_sourcecategory,analytics\_tier <br />\| topk(10,meta\_sourcecategory) by analytics\_tier \| fields -\_rank<br />\| transpose row analytics\_tier column meta\_sourcecategory|
|Enterprise Search Audit|1op 10 Source Categories Referenced by Queries per Tier|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New|\_view=sumologic\_search\_usage\_per\_query <br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "\_sourcecategory\\s\*=\\s\*(?\<meta\_sourcecategory\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_sourcecategory!=""<br />\| count by meta\_sourcecategory,analytics\_tier <br />\| topk(10,meta\_sourcecategory) by analytics\_tier \| fields -\_rank<br />\| transpose row analytics\_tier column meta\_sourcecategory|
|Enterprise Search Audit|1op 10 Source Categories Referenced by Queries per Tier|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "\_sourcecategory\\s\*=\\s\*(?\<meta\_sourcecategory\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_sourcecategory!=""<br />\| count by meta\_sourcecategory,analytics\_tier <br />\| topk(10,meta\_sourcecategory) by analytics\_tier \| fields -\_rank<br />\| transpose row analytics\_tier column meta\_sourcecategory|
|Enterprise Search Audit|Aggregate vs Non-Aggregate Searches|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query analytics\_tier=Continuous <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "(?\<aggregation\>sum\|avg\|count\|count\_distinct\|count\_frequent\|max\|min\|avg\|first\|last\|most\_recent\|least\_recent\|pct\|stddev\|fillmissing\|compose)" nodrop<br />\| if (isempty(aggregation),"non-aggregate","aggregate") as query\_type<br />\| count by query\_type|
|Enterprise Search Audit|Aggregate vs Non-Aggregate Searches|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query analytics\_tier=Continuous <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "(?\<aggregation\>sum\|avg\|count\|count\_distinct\|count\_frequent\|max\|min\|avg\|first\|last\|most\_recent\|least\_recent\|pct\|stddev\|fillmissing\|compose)" nodrop<br />\| if (isempty(aggregation),"non-aggregate","aggregate") as query\_type<br />\| count by query\_type|
|Enterprise Search Audit|Aggregate vs Non-Aggregate Searches|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier=Continuous <br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "(?\<aggregation\>sum\|avg\|count\|count\_distinct\|count\_frequent\|max\|min\|avg\|first\|last\|most\_recent\|least\_recent\|pct\|stddev\|fillmissing\|compose)" nodrop<br />\| if (isempty(aggregation),"non-aggregate","aggregate") as query\_type<br />\| count by query\_type|
|Enterprise Search Audit|Avg Query RunTime (sec) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier={{tier}} <br />\| timeslice 15m <br />\| avg(execution\_duration\_ms) as query\_time by query\_type, \_timeslice <br />\| query\_time/1000 as query\_time<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Avg Query RunTime (sec) by Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| timeslice 15m <br />\| avg(execution\_duration\_ms) as query\_time by query\_type, \_timeslice <br />\| query\_time/1000 as query\_time<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Avg Query RunTime (sec) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| timeslice 15m <br />\| avg(execution\_duration\_ms) as query\_time by query\_type, \_timeslice <br />\| query\_time/1000 as query\_time<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Data Retrieved (GB) by Top 10 Users per Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\|where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\|sum(data\_retrieved\_bytes) as retrieved by user\_name,query\_type<br />\| int(retrieved/1Gi) as retrieved <br />\| topk(10,retrieved) by query\_type \| fields -\_rank<br />\| transpose row query\_type column user\_name \| order by query\_type|
|Enterprise Search Audit|Data Retrieved (GB) by Top 10 Users per Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\|where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\|sum(data\_retrieved\_bytes) as retrieved by user\_name,query\_type<br />\| int(retrieved/1Gi) as retrieved <br />\| topk(10,retrieved) by query\_type \| fields -\_rank<br />\| transpose row query\_type column user\_name \| order by query\_type|
|Enterprise Search Audit|Data Scanned (GB) by Top 10 Users per Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\|where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\|sum(data\_scanned\_bytes) as scanned by user\_name, query\_type<br />\| int(scanned/1Gi) as scanned <br />\| topk(10,user\_name) by query\_type \| fields -\_rank<br />\| transpose row query\_type column user\_name \| order by query\_type|
|Enterprise Search Audit|Data Scanned (GB) by Top 10 Users per Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\|where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\|sum(data\_scanned\_bytes) as scanned by user\_name, query\_type<br />\| int(scanned/1Gi) as scanned <br />\| topk(10,user\_name) by query\_type \| fields -\_rank<br />\| transpose row query\_type column user\_name \| order by query\_type|
|Enterprise Search Audit|Data Tier Searches|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query <br />\| count as queries by analytics\_tier \| order by queries|
|Enterprise Search Audit|Data Tier Searches|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| count as queries by analytics\_tier <br />\| order by queries|
|Enterprise Search Audit|Data Tier Searches|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| count as queries by analytics\_tier <br />\| order by queries|
|Enterprise Search Audit|Failed Searches by Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query status\_message="Query Failed"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| timeslice 15m<br />\| count by \_timeslice,query\_type<br />\| transpose row \_timeslice column query\_type<br />|
|Enterprise Search Audit|Failed Searches by Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query status\_message="Query Failed"<br />\| timeslice 15m<br />\| count by \_timeslice,query\_type<br />\|transpose row \_timeslice column query\_type<br />|
|Enterprise Search Audit|Failed Searches by Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query status\_message="Query Failed"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| timeslice 15m<br />\| count by \_timeslice,query\_type<br />\| transpose row \_timeslice column query\_type<br />|
|Enterprise Search Audit|Interactive Dashboard|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Interactive Dashboard" and user\_name matches "{{user\_name}}"<br />\| count |
|Enterprise Search Audit|Interactive Dashboard|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Interactive Dashboard" <br />\| count |
|Enterprise Search Audit|Interactive Dashboard|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Interactive Dashboard" and user\_name matches "{{user\_name}}"<br />\| count |
|Enterprise Search Audit|Interactive Dashboard Queries without Metadata|Logs|Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query query\_type="Interactive Dashboard"<br />\| sum(data\_scanned\_bytes) as scanned\_bytes, sum(data\_retrieved\_bytes) as retrieved\_bytes by user\_name, query, session\_id, execution\_duration\_ms <br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section <br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  <br />\| where ( isEmpty(idx) AND isEmpty(meta))<br />\| fields -queryLower,session\_id,execution\_duration\_ms, scope\_section\_raw,\_some\_matched, scope\_section,meta,idx|
|Enterprise Search Audit|Interactive Dashboard Queries without Metadata|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query query\_type="Interactive Dashboard"<br />\| sum(data\_scanned\_bytes) as scanned\_bytes, sum(data\_retrieved\_bytes) as retrieved\_bytes by user\_name, query, session\_id, execution\_duration\_ms <br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section <br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  <br />\| where ( isEmpty(idx) AND isEmpty(meta))<br />\| fields -queryLower,session\_id,execution\_duration\_ms, scope\_section\_raw,\_some\_matched, scope\_section,meta,idx|
|Enterprise Search Audit|Interactive Search|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Interactive Search" and  user\_name matches "{{user\_name}}"<br />\| count |
|Enterprise Search Audit|Interactive Search|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Interactive Search" and  user\_name matches "{{user\_name}}"<br />\| count |
|Enterprise Search Audit|Interactive Search|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Interactive Search" <br />\| count |
|Enterprise Search Audit|Other Popular Keys Referenced by Queries|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?\<metadataName\>\_sourcehost\|\_sourcename\|\_source\|\_collector\|\\w+)\\s\*=\\s\*(?\<metadataValue\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where metadataName not in ("\_index","\_view","\_sourcecategory")<br />\|where query\_type matches "{{query\_type}}" AND user\_name matches "{{user\_name}}"<br />\|count as appearances by metadataname, metadatavalue<br />\| where metadataname!="" \| sort appearances \| total(appearances) as total\_appearances<br />\| appearances/total\_appearances\*100 as percent \| format ("%.2f%s", percent,"%") as percent|
|Enterprise Search Audit|Other Popular Keys Referenced by Queries|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?\<metadataName\>\_sourcehost\|\_sourcename\|\_source\|\_collector\|\\w+)\\s\*=\\s\*(?\<metadataValue\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where metadataName not in ("\_index","\_view","\_sourcecategory")<br />\|where query\_type matches "{{query\_type}}" AND user\_name matches "{{user\_name}}"<br />\|count as appearances by metadataname, metadatavalue<br />\| where metadataname!="" \| sort appearances \| total(appearances) as total\_appearances<br />\| appearances/total\_appearances\*100 as percent \| format ("%.2f%s", percent,"%") as percent|
|Enterprise Search Audit|Other Popular Keys Referenced by Queries|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New|\_view=sumologic\_search\_usage\_per\_query <br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?\<metadataName\>\_sourcehost\|\_sourcename\|\_source\|\_collector\|\\w+)\\s\*=\\s\*(?\<metadataValue\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where metadataName not in ("\_index","\_view","\_sourcecategory")<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{query\_type}}" = "\*", true, query\_type matches "{{query\_type}}")<br />\|count as appearances by metadataname, metadatavalue<br />\| where metadataname!="" \| sort appearances \| total(appearances) as total\_appearances<br />\| appearances/total\_appearances\*100 as percent \| format ("%.2f%s", percent,"%") as percent|
|Enterprise Search Audit|Other Search Types|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query <br />\| where query\_type not in ("Interactive Dashboard","Interactive Search","Scheduled Search","Search API")<br />\|where if ("{{query\_type}}" = "\*", true, query\_type matches "{{query\_type}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}")<br />\|count  as queries by query\_type \| order by queries|
|Enterprise Search Audit|Other Search Types|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type not in ("Interactive Dashboard","Interactive Search","Scheduled Search","Search API")<br />\|where query\_type matches "{{query\_type}}" AND user\_name matches "{{user\_name}}"<br />\|count  as queries by query\_type \| order by queries|
|Enterprise Search Audit|Other Search Types|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type not in ("Interactive Dashboard","Interactive Search","Scheduled Search","Search API")<br />\|where query\_type matches "{{query\_type}}" AND user\_name matches "{{user\_name}}"<br />\|count  as queries by query\_type \| order by queries|
|Enterprise Search Audit|Popular Partitions and Views Referenced by Queries|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?:\_index\|\_view)\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_index!=""<br />\|where query\_type matches "{{query\_type}}" AND user\_name matches "{{user\_name}}"<br />\|count by meta\_index \| sort by \_count|
|Enterprise Search Audit|Popular Partitions and Views Referenced by Queries|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New|\_view=sumologic\_search\_usage\_per\_query <br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?:\_index\|\_view)\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_index!=""<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{query\_type}}" = "\*", true, query\_type matches "{{query\_type}}")<br />\|count by meta\_index \| sort by \_count|
|Enterprise Search Audit|Popular Partitions and Views Referenced by Queries|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?:\_index\|\_view)\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_index!=""<br />\|where query\_type matches "{{query\_type}}" AND user\_name matches "{{user\_name}}"<br />\|count by meta\_index \| sort by \_count|
|Enterprise Search Audit|Popular Source Categories Referenced by Queries|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "\_sourcecategory\\s\*=\\s\*(?\<meta\_sourcecategory\>[^\\s\\\|\\)]+)" multi nodrop<br />// Below are some other examples<br />//\| parse regex field=scope\_section\_raw "\_index\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_view\\s\*=\\s\*(?\<meta\_view\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_source\\s\*=\\s\*(?\<meta\_source\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_collector\\s\*=\\s\*(?\<meta\_collector\>[^\\s\\\|\\)]+)" multi nodrop<br />//\| parse regex field=scope\_section\_raw "\_sourcename\\s\*=\\s\*(?\<meta\_sourcename\>[^\\s\\\|\\)]+)" multi nodrop<br />//\| parse regex field=scope\_section\_raw "\_sourcehost\\s\*=\\s\*(?\<meta\_sourcehost\>[^\\s\\\|\\)]+)" multi nodrop<br />\| where meta\_sourcecategory!=""<br />\|where query\_type matches "{{query\_type}}" AND user\_name matches "{{user\_name}}"<br />\|count by meta\_sourcecategory \| sort by \_count|
|Enterprise Search Audit|Popular Source Categories Referenced by Queries|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New|\_view=sumologic\_search\_usage\_per\_query <br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "\_sourcecategory\\s\*=\\s\*(?\<meta\_sourcecategory\>[^\\s\\\|\\)]+)" multi nodrop<br />// Below are some other examples<br />//\| parse regex field=scope\_section\_raw "\_index\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_view\\s\*=\\s\*(?\<meta\_view\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_source\\s\*=\\s\*(?\<meta\_source\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_collector\\s\*=\\s\*(?\<meta\_collector\>[^\\s\\\|\\)]+)" multi nodrop<br />//\| parse regex field=scope\_section\_raw "\_sourcename\\s\*=\\s\*(?\<meta\_sourcename\>[^\\s\\\|\\)]+)" multi nodrop<br />//\| parse regex field=scope\_section\_raw "\_sourcehost\\s\*=\\s\*(?\<meta\_sourcehost\>[^\\s\\\|\\)]+)" multi nodrop<br />\| where meta\_sourcecategory!=""<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{query\_type}}" = "\*", true, query\_type matches "{{query\_type}}")<br />\|count by meta\_sourcecategory \| sort by \_count|
|Enterprise Search Audit|Popular Source Categories Referenced by Queries|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "\_sourcecategory\\s\*=\\s\*(?\<meta\_sourcecategory\>[^\\s\\\|\\)]+)" multi nodrop<br />// Below are some other examples<br />//\| parse regex field=scope\_section\_raw "\_index\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_view\\s\*=\\s\*(?\<meta\_view\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_source\\s\*=\\s\*(?\<meta\_source\>[^\\s\\\|\\)]+)" multi nodrop <br />//\| parse regex field=scope\_section\_raw "\_collector\\s\*=\\s\*(?\<meta\_collector\>[^\\s\\\|\\)]+)" multi nodrop<br />//\| parse regex field=scope\_section\_raw "\_sourcename\\s\*=\\s\*(?\<meta\_sourcename\>[^\\s\\\|\\)]+)" multi nodrop<br />//\| parse regex field=scope\_section\_raw "\_sourcehost\\s\*=\\s\*(?\<meta\_sourcehost\>[^\\s\\\|\\)]+)" multi nodrop<br />\| where meta\_sourcecategory!=""<br />\|where query\_type matches "{{query\_type}}" AND user\_name matches "{{user\_name}}"<br />\|count by meta\_sourcecategory \| sort by \_count|
|Enterprise Search Audit|Queries by Optimization Techniques|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query <br />\| count as queries by query<br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section \| if (scope\_section="" or isNull(scope\_section) or scope\_section="\*",1, 0) as  select\_all<br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop  \| if (meta!="",1,0) as use\_meta<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  \| if (idx!="",1,0) as use\_idx<br />\| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<kfield\>\\w+)\\s\*="  nodrop  \| if (kfield!="" and !(kfield in ("sourcecategory","collector","index","view","source","sourcehost","sourcename")),1,0) as use\_field<br />\| 0 as use\_kw \| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<first\>\\"[^\\"]+\\"\|\\'[^\\']+\\'\|[\\w\\"\\']+)(?\<bridge\>\\s\*=\\s\*\|\\s+\|\$)(?\<second\>\\w+\|\$)" multi nodrop \| if ( !(bridge matches "\*=\*") and select\_all!=1,1,use\_kw) as use\_kw<br />\| max(use\_kw) as use\_kw, max(use\_field) as use\_field, max(use\_meta) as use\_meta, max(use\_idx) as use\_idx, max(queries) as queries by query<br />\| (use\_kw+use\_field+use\_meta+use\_idx) as optimizations<br />\| format("%d Optimizations",int(optimizations)) as OptimizationsStr<br />//\| where optimizationsStr matches "4\*" <br />\| sum(queries) as queries by optimizationsStr \| sort by optimizationsStr <br />|
|Enterprise Search Audit|Queries by Optimization Techniques|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query<br />//\| "\_sourcecategory=cqsplitter DefaultPerCustomerLagTracker \\"current lag\\" " as query <br />\| count as qCount, sum(data\_scanned\_bytes) as scanned by query,user\_name<br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section \| if (scope\_section="" or isNull(scope\_section) or scope\_section="\*",1, 0) as  select\_all<br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop  \| if (meta!="",1,0) as use\_meta<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  \| if (idx!="",1,0) as use\_idx<br />\| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<kfield\>\\w+)\\s\*="  nodrop  \| if (kfield!="" and !(kfield in ("sourcecategory","collector","index","view","source","sourcehost","sourcename")),1,0) as use\_field<br />\| 0 as use\_kw \| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<first\>\\"[^\\"]+\\"\|\\'[^\\']+\\'\|[\\w\\"\\']+)(?\<bridge\>\\s\*=\\s\*\|\\s+\|\$)(?\<second\>\\w+\|\$)" multi nodrop \| if ( !(bridge matches "\*=\*") and select\_all!=1,1,use\_kw) as use\_kw<br />\| max(use\_kw) as use\_kw, max(use\_field) as use\_field, max(use\_meta) as use\_meta, max(use\_idx) as use\_idx, max(qCount) as qCount, max(scanned) as scanned by query,user\_name <br />\| scanned/1Gi as scanned<br />\| (use\_kw+use\_field+use\_meta+use\_idx) as optimizations<br />\| format("%d Optimizations",int(optimizations)) as %"Optimization Techniques"<br />// To look for queries WITH a given number of optimizations, uncomment and modify the following line and comment the last line<br />//\| where optimizationsStr matches "0\*" <br />\| sum(qCount) as queries, sum(scanned) as scanned\_in\_GB by %"Optimization Techniques" <br />\| total(queries) as total\_queries \| total(scanned\_in\_gb) as total\_scanned\_in\_gb <br />\| toInt((queries/total\_queries)\*100) as queries\_pct \| toInt((scanned\_in\_gb/total\_scanned\_in\_gb)\*100) as scanned\_pct <br />\| format("%.2f",scanned\_in\_gb) as scanned\_in\_gb<br />\| fields -total\_queries,total\_scanned\_in\_gb<br />\| sort by %"Optimization Techniques" <br />|
|Enterprise Search Audit|Queries by Optimization Techniques|Logs|Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query <br />\| count as queries by query<br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section \| if (scope\_section="" or isNull(scope\_section) or scope\_section="\*",1, 0) as  select\_all<br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop  \| if (meta!="",1,0) as use\_meta<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  \| if (idx!="",1,0) as use\_idx<br />\| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<kfield\>\\w+)\\s\*="  nodrop  \| if (kfield!="" and !(kfield in ("sourcecategory","collector","index","view","source","sourcehost","sourcename")),1,0) as use\_field<br />\| 0 as use\_kw \| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<first\>\\"[^\\"]+\\"\|\\'[^\\']+\\'\|[\\w\\"\\']+)(?\<bridge\>\\s\*=\\s\*\|\\s+\|\$)(?\<second\>\\w+\|\$)" multi nodrop \| if ( !(bridge matches "\*=\*") and select\_all!=1,1,use\_kw) as use\_kw<br />\| max(use\_kw) as use\_kw, max(use\_field) as use\_field, max(use\_meta) as use\_meta, max(use\_idx) as use\_idx, max(queries) as queries by query<br />\| (use\_kw+use\_field+use\_meta+use\_idx) as optimizations<br />\| format("%d Optimizations",int(optimizations)) as OptimizationsStr<br />//\| where optimizationsStr matches "4\*" <br />\| sum(queries) as queries by optimizationsStr \| sort by optimizationsStr <br />|
|Enterprise Search Audit|Queries by Optimization Techniques|Logs|Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query<br />//\| "\_sourcecategory=cqsplitter DefaultPerCustomerLagTracker \\"current lag\\" " as query <br />\| count as qCount, sum(data\_scanned\_bytes) as scanned by query,user\_name<br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section \| if (scope\_section="" or isNull(scope\_section) or scope\_section="\*",1, 0) as  select\_all<br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop  \| if (meta!="",1,0) as use\_meta<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  \| if (idx!="",1,0) as use\_idx<br />\| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<kfield\>\\w+)\\s\*="  nodrop  \| if (kfield!="" and !(kfield in ("sourcecategory","collector","index","view","source","sourcehost","sourcename")),1,0) as use\_field<br />\| 0 as use\_kw \| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<first\>\\"[^\\"]+\\"\|\\'[^\\']+\\'\|[\\w\\"\\']+)(?\<bridge\>\\s\*=\\s\*\|\\s+\|\$)(?\<second\>\\w+\|\$)" multi nodrop \| if ( !(bridge matches "\*=\*") and select\_all!=1,1,use\_kw) as use\_kw<br />\| max(use\_kw) as use\_kw, max(use\_field) as use\_field, max(use\_meta) as use\_meta, max(use\_idx) as use\_idx, max(qCount) as qCount, max(scanned) as scanned by query,user\_name <br />\| scanned/1Gi as scanned<br />\| (use\_kw+use\_field+use\_meta+use\_idx) as optimizations<br />\| format("%d Optimizations",int(optimizations)) as %"Optimization Techniques"<br />// To look for queries WITH a given number of optimizations, uncomment and modify the following line and comment the last line<br />//\| where optimizationsStr matches "0\*" <br />\| sum(qCount) as queries, sum(scanned) as scanned\_in\_GB by %"Optimization Techniques" <br />\| total(queries) as total\_queries \| total(scanned\_in\_gb) as total\_scanned\_in\_gb <br />\| toInt((queries/total\_queries)\*100) as queries\_pct \| toInt((scanned\_in\_gb/total\_scanned\_in\_gb)\*100) as scanned\_pct <br />\| format("%.2f",scanned\_in\_gb) as scanned\_in\_gb<br />\| fields -total\_queries,total\_scanned\_in\_gb<br />\| sort by %"Optimization Techniques" <br />|
|Enterprise Search Audit|Query Count by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query  <br />\| where analytics\_tier matches "{{tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| count as queries by query\_type <br />\| sort by queries|
|Enterprise Search Audit|Query Count by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier={{tier}}  <br />\| count as queries by query\_type <br />\| sort by queries|
|Enterprise Search Audit|Query Count by Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query  <br />\| where analytics\_tier matches "{{tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| count as queries by query\_type <br />\| sort by queries|
|Enterprise Search Audit|Query Count by Top 10 Users per Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\|where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\|count as queries by user\_name, query\_type<br />\| topk(10,user\_name) by query\_type \| fields -\_rank<br />\| transpose row query\_type column user\_name \| order by query\_type|
|Enterprise Search Audit|Query Count by Top 10 Users per Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\|where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\|count as queries by user\_name, query\_type<br />\| topk(10,user\_name) by query\_type \| fields -\_rank<br />\| transpose row query\_type column user\_name \| order by query\_type|
|Enterprise Search Audit|Query RunTime(sec) Percentiles|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query  <br />\| where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| timeslice 15m<br />\| pct(query\_time\_s,50,90,95,99) by \_timeslice<br /><br />|
|Enterprise Search Audit|Query RunTime(sec) Percentiles|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query  <br />\| where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| timeslice 15m<br />\| pct(query\_time\_s,50,90,95,99) by \_timeslice<br /><br />|
|Enterprise Search Audit|Query RunTime(sec) Percentiles|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier="{{tier}}" <br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| timeslice 15m<br />\| pct(query\_time\_s,50,90,95,99) by \_timeslice<br /><br />|
|Enterprise Search Audit|Query Time Range|Logs|Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| now()-query\_start\_time as timegap<br />\| if (timegap\<86400000,"Last24h",if (timegap\<1209600000,"Last14d","15+d")) as timerange<br />\| where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| count as queries by timerange<br />\| order by queries|
|Enterprise Search Audit|Query Time Range|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| now()-query\_start\_time as timegap<br />\| if (timegap\<86400000,"Last24h",if (timegap\<1209600000,"Last14d","15+d")) as timerange<br />\| where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| count as queries by timerange<br />\| order by queries|
|Enterprise Search Audit|Retrieved (GB) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier={{tier}}  <br />\| sum(data\_retrieved\_bytes) as data\_retrieved\_bytes by query\_type <br />\| int(data\_retrieved\_bytes/1Gi) as data\_retrieved\_bytes<br />\| sort by data\_retrieved\_bytes|
|Enterprise Search Audit|Retrieved (GB) by Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| sum(data\_retrieved\_bytes) as data\_retrieved\_bytes by query\_type <br />\| int(data\_retrieved\_bytes/1Gi) as data\_retrieved\_bytes<br />\| sort by data\_retrieved\_bytes|
|Enterprise Search Audit|Retrieved (GB) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| sum(data\_retrieved\_bytes) as data\_retrieved\_bytes by query\_type <br />\| int(data\_retrieved\_bytes/1Gi) as data\_retrieved\_bytes<br />\| sort by data\_retrieved\_bytes|
|Enterprise Search Audit|Retrieved Bytes Used (GB) by Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| timeslice 15m <br />\| sum(data\_retrieved\_bytes) as data\_retrieved\_bytes by query\_type, \_timeslice <br />\| int(data\_retrieved\_bytes/1Gi) as data\_retrieved\_bytes<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Retrieved Bytes Used (GB) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier={{tier}} <br />\| timeslice 15m <br />\| sum(data\_retrieved\_bytes) as data\_retrieved\_bytes by query\_type, \_timeslice <br />\| int(data\_retrieved\_bytes/1Gi) as data\_retrieved\_bytes<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Retrieved Bytes Used (GB) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| timeslice 15m <br />\| sum(data\_retrieved\_bytes) as data\_retrieved\_bytes by query\_type, \_timeslice <br />\| int(data\_retrieved\_bytes/1Gi) as data\_retrieved\_bytes<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Scanned (GB) by Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\|if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| sum(data\_scanned\_bytes) as data\_scanned\_bytes by query\_type <br />\| int(data\_scanned\_bytes/1Gi) as data\_scanned\_bytes<br />\| sort by data\_scanned\_bytes|
|Enterprise Search Audit|Scanned (GB) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\|if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| sum(data\_scanned\_bytes) as data\_scanned\_bytes by query\_type <br />\| int(data\_scanned\_bytes/1Gi) as data\_scanned\_bytes<br />\| sort by data\_scanned\_bytes|
|Enterprise Search Audit|Scanned (GB) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier={{tier}}  <br />\| sum(data\_scanned\_bytes) as data\_scanned\_bytes by query\_type <br />\| int(data\_scanned\_bytes/1Gi) as data\_scanned\_bytes<br />\| sort by data\_scanned\_bytes|
|Enterprise Search Audit|Scanned Bytes Used (GB) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier={{tier}} <br />\| timeslice 15m <br />\| sum(data\_scanned\_bytes) as data\_scanned\_bytes by query\_type, \_timeslice <br />\| int(data\_scanned\_bytes/1Gi) as data\_scanned\_bytes<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Scanned Bytes Used (GB) by Query Type|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| timeslice 15m <br />\| sum(data\_scanned\_bytes) as data\_scanned\_bytes by query\_type, \_timeslice <br />\| int(data\_scanned\_bytes/1Gi) as data\_scanned\_bytes<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Scanned Bytes Used (GB) by Query Type|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| timeslice 15m <br />\| sum(data\_scanned\_bytes) as data\_scanned\_bytes by query\_type, \_timeslice <br />\| int(data\_scanned\_bytes/1Gi) as data\_scanned\_bytes<br />\| transpose row \_timeslice column query\_type|
|Enterprise Search Audit|Scheduled Search|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Scheduled Search" and user\_name matches "{{user\_name}}"<br />\| count |
|Enterprise Search Audit|Scheduled Search|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Scheduled Search" and user\_name matches "{{user\_name}}"<br />\| count |
|Enterprise Search Audit|Scheduled Search|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Scheduled Search" <br />\| count |
|Enterprise Search Audit|Scheduled Searches without Metadata|Logs|Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query query\_type="Scheduled Search"<br />\| sum(data\_scanned\_bytes) as scanned\_bytes, sum(data\_retrieved\_bytes) as retrieved\_bytes by user\_name, query, session\_id, execution\_duration\_ms <br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section <br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  <br />\| where ( isEmpty(idx) AND isEmpty(meta) )<br />\| fields -queryLower,session\_id,execution\_duration\_ms, scope\_section\_raw,\_some\_matched, scope\_section,meta,idx|
|Enterprise Search Audit|Scheduled Searches without Metadata|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query query\_type="Scheduled Search"<br />\| sum(data\_scanned\_bytes) as scanned\_bytes, sum(data\_retrieved\_bytes) as retrieved\_bytes by user\_name, query, session\_id, execution\_duration\_ms <br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section <br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  <br />\| where ( isEmpty(idx) AND isEmpty(meta) )<br />\| fields -queryLower,session\_id,execution\_duration\_ms, scope\_section\_raw,\_some\_matched, scope\_section,meta,idx|
|Enterprise Search Audit|Search API|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Search API"<br />\|where if ("{{query\_type}}" = "\*", true, query\_type matches "{{query\_type}}") AND if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}")<br />\|count|
|Enterprise Search Audit|Search API|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Search API"<br />\| where  user\_name matches "{{user\_name}}"<br />\|count|
|Enterprise Search Audit|Search API|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| where query\_type="Search API"<br />\| where  user\_name matches "{{user\_name}}"<br />\|count|
|Enterprise Search Audit|Search RunTime(sec) Percentiles|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| timeslice 15m<br />\| pct(query\_time\_s,50,90,95,99) by \_timeslice<br /><br />|
|Enterprise Search Audit|Search RunTime(sec) Percentiles|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query <br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| timeslice 15m<br />\| pct(query\_time\_s,50,90,95,99) by \_timeslice<br /><br />|
|Enterprise Search Audit|Search RunTime(sec) Percentiles|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| timeslice 15m<br />\| pct(query\_time\_s,50,90,95,99) by \_timeslice<br /><br />|
|Enterprise Search Audit|Search Statistics|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| count as total\_searches, count\_distinct(user\_name) as users, pct(query\_time\_s,50,95,99), sum(scanned\_message\_count) as scanned\_events, sum(retrieved\_message\_count) as retrieved\_events, sum(data\_scanned\_bytes) as scanned\_bytes by query\_type \| sort query\_type asc<br />\| format("%,.1f",\_query\_time\_s\_pct\_50) as median\_s<br />\| format("%,.1f",\_query\_time\_s\_pct\_95) as pct\_90\_s<br />\| format("%,.1f",\_query\_time\_s\_pct\_99) as pct\_99\_s<br />\| round(scanned\_bytes / 1Gi ) as scanned\_GB<br />\| fields -\_query\_time\_s\_pct\_50, \_query\_time\_s\_pct\_95, \_query\_time\_s\_pct\_99, scanned\_bytes<br />\| order by scanned\_events<br /><br /><br />|
|Enterprise Search Audit|Search Statistics|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| count as total\_searches, count\_distinct(user\_name) as users, pct(query\_time\_s,50,95,99), sum(scanned\_message\_count) as scanned\_events, sum(retrieved\_message\_count) as retrieved\_events, sum(data\_scanned\_bytes) as scanned\_bytes by query\_type \| sort query\_type asc<br />\| format("%,.1f",\_query\_time\_s\_pct\_50) as median\_s<br />\| format("%,.1f",\_query\_time\_s\_pct\_95) as pct\_90\_s<br />\| format("%,.1f",\_query\_time\_s\_pct\_99) as pct\_99\_s<br />\| round(scanned\_bytes / 1Gi ) as scanned\_GB<br />\| fields -\_query\_time\_s\_pct\_50, \_query\_time\_s\_pct\_95, \_query\_time\_s\_pct\_99, scanned\_bytes<br />\| order by scanned\_events<br /><br /><br />|
|Enterprise Search Audit|Search Statistics|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query <br />\| round(execution\_duration\_ms/1000) as duration\_seconds <br />\| execution\_duration\_ms / 1000 as query\_time\_s<br />\| count as total\_searches, count\_distinct(user\_name) as users, pct(query\_time\_s,50,95,99), sum(scanned\_message\_count) as scanned\_events, sum(retrieved\_message\_count) as retrieved\_events, sum(data\_scanned\_bytes) as scanned\_bytes by query\_type \| sort query\_type asc<br />\| format("%,.1f",\_query\_time\_s\_pct\_50) as median\_s<br />\| format("%,.1f",\_query\_time\_s\_pct\_95) as pct\_90\_s<br />\| format("%,.1f",\_query\_time\_s\_pct\_99) as pct\_99\_s<br />\| round(scanned\_bytes / 1Gi ) as scanned\_GB<br />\| fields -\_query\_time\_s\_pct\_50, \_query\_time\_s\_pct\_95, \_query\_time\_s\_pct\_99, scanned\_bytes<br />\| order by scanned\_events<br /><br /><br />|
|Enterprise Search Audit|Searches by Location|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query analytics\_tier=Continuous <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| lookup latitude, longitude, country\_name,city from geo://location on remote\_ip=ip<br />\| where !isnull(longitude) <br />\| count by latitude,longitude |
|Enterprise Search Audit|Searches by Location|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query analytics\_tier=Continuous <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| lookup latitude, longitude, country\_name,city from geo://location on remote\_ip=ip<br />\| where !isnull(longitude) <br />\| count by latitude,longitude |
|Enterprise Search Audit|Searches by Location|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier=Continuous <br />\| lookup latitude, longitude, country\_name,city from geo://location on remote\_ip=ip<br />\| where !isnull(longitude) <br />\| count by latitude,longitude |
|Enterprise Search Audit|Top 10 Partitions and Views Referenced by Queries per Tier|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?:\_index\|\_view)\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_index!=""<br />\| count by meta\_index,analytics\_tier <br />\| topk(10,meta\_index) by analytics\_tier \| fields -\_rank<br />\| transpose row analytics\_tier column meta\_index |
|Enterprise Search Audit|Top 10 Partitions and Views Referenced by Queries per Tier|Logs|Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources - New|\_view=sumologic\_search\_usage\_per\_query <br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?:\_index\|\_view)\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_index!=""<br />\| count by meta\_index,analytics\_tier <br />\| topk(10,meta\_index) by analytics\_tier \| fields -\_rank<br />\| transpose row analytics\_tier column meta\_index |
|Enterprise Search Audit|Top 10 Partitions and Views Referenced by Queries per Tier|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Commonly Referenced Data Sources|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| toLowerCase(query) as queryLower<br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| parse regex field=scope\_section\_raw "(?:\_index\|\_view)\\s\*=\\s\*(?\<meta\_index\>[^\\s\\\|\\)]+)" multi nodrop <br />\| where meta\_index!=""<br />\| count by meta\_index,analytics\_tier <br />\| topk(10,meta\_index) by analytics\_tier \| fields -\_rank<br />\| transpose row analytics\_tier column meta\_index |
|Enterprise Search Audit|Top 10 Users by Data Retrieved (GB)|Logs|Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| sum(data\_retrieved\_bytes) as retrieved by user\_name<br />\| int(retrieved/1Gi) as retrieved <br />\| order by retrieved \| limit 10|
|Enterprise Search Audit|Top 10 Users by Data Retrieved (GB)|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| sum(data\_retrieved\_bytes) as retrieved by user\_name<br />\| int(retrieved/1Gi) as retrieved <br />\| order by retrieved \| limit 10|
|Enterprise Search Audit|Top 10 Users by Data Scanned (GB)|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\|sum(data\_scanned\_bytes) as scanned by user\_name<br />\| int(scanned/1Gi) as scanned <br />\| order by scanned \| limit 10|
|Enterprise Search Audit|Top 10 Users by Data Scanned (GB)|Logs|Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\|sum(data\_scanned\_bytes) as scanned by user\_name<br />\| int(scanned/1Gi) as scanned <br />\| order by scanned \| limit 10|
|Enterprise Search Audit|Top 10 Users by Query Count|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\|where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\|count as queries by user\_name \| order by queries \| limit 10|
|Enterprise Search Audit|Top 10 Users by Query Count|Logs|Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query<br />\|where user\_name matches "{{user\_name}}" AND analytics\_tier matches "{{analytics\_tier}}"<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\|count as queries by user\_name \| order by queries \| limit 10|
|Enterprise Search Audit|Top 10 Users by Query Count per Tier|Logs|Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| count as queries by user\_name, analytics\_tier<br />\| topk(10,user\_name) by analytics\_tier \| fields -\_rank<br />\| transpose row analytics\_tier column user\_name |
|Enterprise Search Audit|Top 10 Users by Query Count per Tier|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - User Insights|\_view=sumologic\_search\_usage\_per\_query <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| count as queries by user\_name, analytics\_tier<br />\| topk(10,user\_name) by analytics\_tier \| fields -\_rank<br />\| transpose row analytics\_tier column user\_name |
|Enterprise Search Audit|Total Scanned and Retrieved (GB)|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| timeslice 15m<br />\| sum(data\_scanned\_bytes) as total\_scanned, sum(data\_retrieved\_bytes) as total\_retrieved by \_timeslice<br />\| int(total\_scanned/1Gi) as total\_scanned \| int(total\_retrieved/1Gi) as total\_retrieved<br />\| order by \_timeslice|
|Enterprise Search Audit|Total Scanned and Retrieved (GB)|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time|\_view=sumologic\_search\_usage\_per\_query <br />\|where analytics\_tier matches "{{tier}}" <br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| timeslice 15m<br />\| sum(data\_scanned\_bytes) as total\_scanned, sum(data\_retrieved\_bytes) as total\_retrieved by \_timeslice<br />\| int(total\_scanned/1Gi) as total\_scanned \| int(total\_retrieved/1Gi) as total\_retrieved<br />\| order by \_timeslice|
|Enterprise Search Audit|Total Scanned and Retrieved (GB)|Logs|Enterprise Search Audit/Enterprise Search Audit - Data Tier Usage Over Time - New|\_view=sumologic\_search\_usage\_per\_query analytics\_tier={{tier}}<br />\| timeslice 15m<br />\| sum(data\_scanned\_bytes) as total\_scanned, sum(data\_retrieved\_bytes) as total\_retrieved by \_timeslice<br />\| int(total\_scanned/1Gi) as total\_scanned \| int(total\_retrieved/1Gi) as total\_retrieved<br />\| order by \_timeslice|
|Enterprise Search Audit|Total Searches|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query<br />\| count |
|Enterprise Search Audit|Total Searches|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| count |
|Enterprise Search Audit|Total Searches|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| count |
|Enterprise Search Audit|Unoptimized Queries|Logs|Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query <br />//(query\_type="Scheduled Search" or query\_type="Interactive Dashboard" or query\_type="Search API")<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| count as qCount, sum(data\_scanned\_bytes) as scanned by query,user\_name,query\_type<br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section \| if (scope\_section="" or isNull(scope\_section) or scope\_section="\*",1, 0) as  select\_all<br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop  \| if (meta!="",1,0) as use\_meta<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  \| if (idx!="",1,0) as use\_idx<br />\| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<kfield\>\\w+)\\s\*="  nodrop  \| if (kfield!="" and !(kfield in ("sourcecategory","collector","index","view","source","sourcehost","sourcename")),1,0) as use\_field<br />\| 0 as use\_kw \| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<first\>\\"[^\\"]+\\"\|\\'[^\\']+\\'\|[\\w\\"\\']+)(?\<bridge\>\\s\*=\\s\*\|\\s+\|\$)(?\<second\>\\w+\|\$)" multi nodrop \| if ( !(bridge matches "\*=\*") and select\_all!=1,1,use\_kw) as use\_kw<br />\| max(use\_kw) as use\_kw, max(use\_field) as use\_field, max(use\_meta) as use\_meta, max(use\_idx) as use\_idx, max(qCount) as queries, max(scanned) as scanned\_bytes by query,user\_name, query\_type <br />\| (scanned\_bytes/1Gi) as scanned\_gbytes \| fields -scanned\_bytes<br />\| (use\_kw+use\_field+use\_meta+use\_idx) as optimizations<br />\| where optimizations =0<br />\| fields -use\_kw,use\_field,use\_idx,optimizations,use\_meta<br />\| sort by scanned\_gbytes<br />|
|Enterprise Search Audit|Unoptimized Queries|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Queries Characteristics and Opportunities to Improve|\_view=sumologic\_search\_usage\_per\_query <br />//(query\_type="Scheduled Search" or query\_type="Interactive Dashboard" or query\_type="Search API")<br />\| if (query\_type == "View Maintenance", "Scheduled Views", query\_type) as query\_type<br />\| count as qCount, sum(data\_scanned\_bytes) as scanned by query,user\_name,query\_type<br />\| toLowerCase(query) as queryLower <br />\| parse regex field=queryLower "^(?\<scope\_section\_raw\>[^\\\|]+)" nodrop <br />\| replace(scope\_section\_raw," ","") as scope\_section \| if (scope\_section="" or isNull(scope\_section) or scope\_section="\*",1, 0) as  select\_all<br />\| parse regex field=scope\_section\_raw "\_(?\<meta\>sourcecategory\|sourcehost\|collector\|source\|sourcename)\\s\*="  nodrop  \| if (meta!="",1,0) as use\_meta<br />\| parse regex field=scope\_section\_raw "\_(?\<idx\>view\|index)\\s\*="  nodrop  \| if (idx!="",1,0) as use\_idx<br />\| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<kfield\>\\w+)\\s\*="  nodrop  \| if (kfield!="" and !(kfield in ("sourcecategory","collector","index","view","source","sourcehost","sourcename")),1,0) as use\_field<br />\| 0 as use\_kw \| parse regex field=scope\_section\_raw "(?:^\|\\s+)(?\<first\>\\"[^\\"]+\\"\|\\'[^\\']+\\'\|[\\w\\"\\']+)(?\<bridge\>\\s\*=\\s\*\|\\s+\|\$)(?\<second\>\\w+\|\$)" multi nodrop \| if ( !(bridge matches "\*=\*") and select\_all!=1,1,use\_kw) as use\_kw<br />\| max(use\_kw) as use\_kw, max(use\_field) as use\_field, max(use\_meta) as use\_meta, max(use\_idx) as use\_idx, max(qCount) as queries, max(scanned) as scanned\_bytes by query,user\_name, query\_type <br />\| (scanned\_bytes/1Gi) as scanned\_gbytes \| fields -scanned\_bytes<br />\| (use\_kw+use\_field+use\_meta+use\_idx) as optimizations<br />\| where optimizations =0<br />\| fields -use\_kw,use\_field,use\_idx,optimizations,use\_meta<br />\| sort by scanned\_gbytes<br />|
|Enterprise Search Audit|Users|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| count\_distinct(user\_name) <br />|
|Enterprise Search Audit|Users|Logs|Enterprise Search Audit/Enterprise Search Audit - Search Overview - New|\_view=sumologic\_search\_usage\_per\_query <br />\| count\_distinct(user\_name) <br />|
|Enterprise Search Audit|Users|Logs|Installed Apps/Enterprise Search Audit/Enterprise Search Audit - Search Overview|\_view=sumologic\_search\_usage\_per\_query <br />\| where query\_type matches "{{query\_type}}" and user\_name matches "{{user\_name}}"<br />\| count\_distinct(user\_name) <br />|

