# Twistlock Classic
## Sumo Logic App For: Twistlock Classic
Twistlock is a cloud native cybersecurity platform for hosts, containers, and serverless setups that ensures the protection of all your workloads across any environment. The Sumo Logic App for Twistlock provides comprehensive monitoring and analysis solution for detecting vulnerabilities and potential threats throughout your environment, including hosts and containers.
Docs Link: [Twistlock Classic](https://help.sumologic.com/?cid=1974)

## Searches

### Log Searches

- **Alerts by Component**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Alerts by Component, Type and Log Type**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Alerts by Log Type**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Alerts by Type**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Audit Alerts**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Audit Events**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Available CVE Fixes for Host Vulnerabilities**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Compliance Scan Events by Severity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Compliance Violations**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Container Compliance Violations by Severity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Container Scan - Top Descriptions**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Container Scan - Top Rules Triggered**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Containers**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Containers by Host**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Containers Impacted**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Defender Incidents**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Defender Incidents**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Defender Incidents 
- **Detected Container Compliance Violations**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Detected Vulnerabilities by Severity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Fixes Available**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Fixes Available by Severity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Fixes Available for CVEs Identified With Images**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Fixes Available for CVEs Identified With Registry**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Host Scan - CVEs Identified - Time Compare**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Host Scan - Top Descriptions**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Host Scan - Top Rules Triggered**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Host Scan CVE Status**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Host Scan CVEs - Fix Available**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Host Vulnerability - Top CVE**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Host Vulnerability - Top Descriptions**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Host Vulnerability - Top Rules Triggered**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Hosts**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Hosts Impacted**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Hosts Impacted with Vulnerability by Severity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Image Scan - Top Descriptions**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Image Scan - Top Rules Triggered**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Image Scan CVE Status**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Image Scan CVEs - Fix Available**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Image Vulnerability - Top CVE**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Image Vulnerability - Top Descriptions**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Image Vulnerability - Top Rules Triggered**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Image, Registry Scan - CVEs Identified - Time Compare**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Images Impacted**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Images Impacted with Vulnerability by Severity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Incident Category**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Defender Incidents 
- **Management Activity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Most Vulnerable Hosts**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Most Vulnerable Images**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Number of Distinct Processes Spawned on Container - Trend**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Defender Incidents 
- **Recent Critical Vulnerabilities**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Recent Defender Incidents**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Defender Incidents 
- **Registry Impacted**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Registry Impacted with Vulnerability by Severity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Registry Scan - Top Descriptions**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Registry Scan - Top Rules Triggered**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Compliance Violations 
- **Registry Scan CVE Status**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Registry Scan CVEs - Fix Available**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - CVE Status 
- **Registry Vulnerability - Top CVE**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Registry Vulnerability - Top Descriptions**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Registry Vulnerability - Top Rules Triggered**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Rules Triggered**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Runtime Filesystem Alert Details**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Runtime Network Alert Details**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Runtime Processes Alert Details**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Scans**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Scans  by Component**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Scans by Log Type**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Scans by Type**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Scans by Type and Log Type**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Top Container Compliance Violations**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Scans 
- **Top Hosts with Most CVEs**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Top Images with Most CVEs**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Top Processes Spawned on Containers**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Defender Incidents 
- **Top Registry with Most CVEs**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities 
- **Top Runtime Filesystem Alerts**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Top Runtime Network Alerts**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Top Runtime Processes Alerts**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Runtime 
- **Vulnerability Scan Events by Severity**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Vulnerable Hosts**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Vulnerable Images**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview 
- **Vulnerable Registry Images**: from Dashboard: Installed Apps/Twistlock Classic/Twistlock - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Twistlock Classic|Alerts by Component|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  (Twistlock-Defender or Twistlock-Console) time \*audit\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "username=\\"\*\\"" as username nodrop \| parse "source\_ip=\\"\*\\"" as source\_ip nodrop \| parse "api=\\"\*\\"" as api nodrop \| parse "status=\\"\*\\"" as status nodrop<br />\| where type matches "\*audit\*"<br />\|where if ("{{username}}" = "\*", true, username matches "{{username}}") AND if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{source\_ip}}" = "\*", true, source\_ip matches "{{source\_ip}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{api}}" = "\*", true, api matches "{{api}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by component<br />\| sort by alerts, component asc|
|Twistlock Classic|Alerts by Component, Type and Log Type|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  (Twistlock-Defender or Twistlock-Console) time \*audit\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "username=\\"\*\\"" as username nodrop \| parse "source\_ip=\\"\*\\"" as source\_ip nodrop \| parse "api=\\"\*\\"" as api nodrop \| parse "status=\\"\*\\"" as status nodrop<br />\| where type matches "\*audit\*"<br />\|where if ("{{username}}" = "\*", true, username matches "{{username}}") AND if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{source\_ip}}" = "\*", true, source\_ip matches "{{source\_ip}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{api}}" = "\*", true, api matches "{{api}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by component, type, log\_type<br />\| sort by component asc, type asc, alerts, log\_type asc|
|Twistlock Classic|Alerts by Log Type|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  type log\_type \*audit\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "username=\\"\*\\"" as username nodrop \| parse "source\_ip=\\"\*\\"" as source\_ip nodrop \| parse "api=\\"\*\\"" as api nodrop \| parse "status=\\"\*\\"" as status nodrop<br />\| where type matches "\*audit\*"<br />\|where if ("{{username}}" = "\*", true, username matches "{{username}}") AND if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{source\_ip}}" = "\*", true, source\_ip matches "{{source\_ip}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{api}}" = "\*", true, api matches "{{api}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by log\_type<br />\| sort by alerts, log\_type asc|
|Twistlock Classic|Alerts by Type|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  type log\_type \*audit\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "username=\\"\*\\"" as username nodrop \| parse "source\_ip=\\"\*\\"" as source\_ip nodrop \| parse "api=\\"\*\\"" as api nodrop \| parse "status=\\"\*\\"" as status nodrop<br />\| where type matches "\*audit\*"<br />\|where if ("{{username}}" = "\*", true, username matches "{{username}}") AND if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{source\_ip}}" = "\*", true, source\_ip matches "{{source\_ip}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{api}}" = "\*", true, api matches "{{api}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by type<br />\| sort by alerts, type asc|
|Twistlock Classic|Audit Alerts|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  type log\_type \*audit\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "username=\\"\*\\"" as username nodrop \| parse "source\_ip=\\"\*\\"" as source\_ip nodrop \| parse "api=\\"\*\\"" as api nodrop \| parse "status=\\"\*\\"" as status nodrop<br />\| where type matches "\*audit\*"<br />\|where if ("{{username}}" = "\*", true, username matches "{{username}}") AND if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{source\_ip}}" = "\*", true, source\_ip matches "{{source\_ip}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{api}}" = "\*", true, api matches "{{api}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts|
|Twistlock Classic|Audit Events|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*audit\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "username=\\"\*\\"" as username nodrop \| parse "source\_ip=\\"\*\\"" as source\_ip nodrop \| parse "api=\\"\*\\"" as api nodrop \| parse "status=\\"\*\\"" as status nodrop<br />\| where type matches "\*audit\*"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts|
|Twistlock Classic|Available CVE Fixes for Host Vulnerabilities|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "fixed", vendor\_status) as cve\_status<br />\| where cve\_status = "fixed"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as fixedCVECount by host, package, package\_version, vendor\_status, cve, severity \| fields -fixedCVECount<br />\| sort by host asc, severity asc|
|Twistlock Classic|Compliance Scan Events by Severity|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* containerCompliance severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "\*scan\*" and log\_type="containerCompliance"<br />\| timeslice 1d<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count by \_timeslice, severity<br />\| transpose row \_timeslice column severity|
|Twistlock Classic|Compliance Violations|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* containerCompliance severity critical<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "\*scan\*" and log\_type="containerCompliance" and severity="critical"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as compliance\_violations|
|Twistlock Classic|Container Compliance Violations by Severity|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* containerCompliance severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop<br />\| where type matches "\*scan\*" and log\_type="containerCompliance"<br />\| where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\| count as scans by severity<br />\| sort by scans, severity asc|
|Twistlock Classic|Container Scan - Top Descriptions|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "container\_scan" containerCompliance host description<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop <br />\| where type matches "container\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents, count\_distinct(host) as hosts by description<br />\| sort by incidents, hosts, description asc|
|Twistlock Classic|Container Scan - Top Rules Triggered|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "container\_scan" containerCompliance rule<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop <br />\| where type matches "container\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by rule<br />\| sort by incidents, rule asc|
|Twistlock Classic|Containers|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* container\_id host<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "rule=\\"\*\\"" as rule nodrop<br />\| where type matches "\*scan\*" and !isEmpty(container\_id) and !isEmpty(host)<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(container\_id) as containers|
|Twistlock Classic|Containers by Host|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* host container\_id <br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop<br />\| where type matches "\*scan\*" and !isEmpty(host) and !isEmpty(container\_id)<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(container\_id) as containers by host<br />\| sort by containers, host asc|
|Twistlock Classic|Containers Impacted|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "container\_scan" containerCompliance severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "container\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(container\_id) as container\_ids by severity<br />\| sort by container\_ids, severity asc|
|Twistlock Classic|Defender Incidents|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  incident incident\_category<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "incident\_category=\\"\*\\"" as incident\_category nodrop <br />\| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type="incident"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}")<br />\|count as incidents|
|Twistlock Classic|Defender Incidents|Logs|Installed Apps/Twistlock Classic/Twistlock - Defender Incidents|\_sourceCategory={{Logsdatasource}}  incident incident\_category<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "incident\_category=\\"\*\\"" as incident\_category nodrop <br />\| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type="incident"<br />\|where if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{incident\_category}}" = "\*", true, incident\_category matches "{{incident\_category}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}")<br />\|count as incidents|
|Twistlock Classic|Detected Container Compliance Violations|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type "container\_scan" container<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "severity=\\"\*\\"" as severity nodrop<br />\| where type matches "container\_scan" and log\_type = "container"<br />\| where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\| num(compliance) as compliance \| compliance as compliance\_id<br />\| count as scans by container\_id, container\_name, image\_name, compliance\_id<br />\| sort by container\_id asc, container\_name asc, image\_name asc, compliance\_id asc|
|Twistlock Classic|Detected Vulnerabilities by Severity|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* vulnerability severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop<br />\| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*scan\*" and log\_type="vulnerability"<br />\| where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\| count as scans by severity<br />\| sort by scans, severity asc|
|Twistlock Classic|Fixes Available|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* vulnerability vendor\_status critical<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*scan\*" and log\_type="vulnerability" and !isEmpty(vendor\_status) and severity="critical"<br />\| if (vendor\_status matches "fixed\*", "fixed", vendor\_status) as cve\_status<br />\| where cve\_status = "fixed"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(cve) as vulnerabilities|
|Twistlock Classic|Fixes Available by Severity|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* vulnerability vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*scan\*" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "fixed", vendor\_status) as cve\_status<br />\| where cve\_status = "fixed"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(cve) as vulnerabilities by severity \| sort by vulnerabilities, severity asc|
|Twistlock Classic|Fixes Available for CVEs Identified With Images|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" vulnerability image\_id vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "fixed", vendor\_status) as cve\_status<br />\| where cve\_status = "fixed"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as fixedCVECount by image\_id, package, package\_version, vendor\_status, cve, severity \| fields -fixedCVECount<br />\| sort by image\_id asc, severity asc|
|Twistlock Classic|Fixes Available for CVEs Identified With Registry|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" vulnerability image\_id vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop  <br />\| where type matches "registry\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "fixed", vendor\_status) as cve\_status<br />\| where cve\_status = "fixed"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as fixedCVECount by image\_id, package, package\_version, vendor\_status, cve, severity \| fields -fixedCVECount<br />\| sort by image\_id asc, severity asc|
|Twistlock Classic|Host Scan - CVEs Identified - Time Compare|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type="host\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "Fix Available", vendor\_status) as cve\_status<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as CVEs\_identified by host<br />\| compare with timeshift -1d 2|
|Twistlock Classic|Host Scan - Top Descriptions|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" containerCompliance<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop<br />\| where type matches "host\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents, count\_distinct(host) as hosts by description<br />\| sort by incidents, hosts, description asc|
|Twistlock Classic|Host Scan - Top Rules Triggered|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" containerCompliance rule<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop<br />\| where type matches "host\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by rule<br />\| sort by incidents, rule asc|
|Twistlock Classic|Host Scan CVE Status|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "Fix Available", vendor\_status) as cve\_status<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count by cve\_status \| sort by \_count, cve\_status asc|
|Twistlock Classic|Host Scan CVEs - Fix Available|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "fixed", vendor\_status) as cve\_status<br />\| where cve\_status = "fixed"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as fixedCVECount by cve, severity, vendor\_status \| fields -fixedCVECount<br />\| sort by severity asc, cve|
|Twistlock Classic|Host Vulnerability - Top CVE|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability host cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(host) as nodes by cve, severity<br />\| sort by nodes, cve|
|Twistlock Classic|Host Vulnerability - Top Descriptions|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability host cve description<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents, count\_distinct(host) as nodes, count\_distinct(cve) as vulnerabilities by description<br />\| sort by incidents, nodes, description asc|
|Twistlock Classic|Host Vulnerability - Top Rules Triggered|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability rule<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by rule<br />\| sort by incidents, rule asc|
|Twistlock Classic|Hosts|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* host<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "rule=\\"\*\\"" as rule nodrop<br />\| where type matches "\*scan\*" and !isEmpty(host)<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\| count\_distinct(host) as hosts|
|Twistlock Classic|Hosts Impacted|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" containerCompliance severity host compliance\_id<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop<br />\| where type matches "host\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(host) as hosts by severity<br />\| sort by hosts, severity asc|
|Twistlock Classic|Hosts Impacted with Vulnerability by Severity|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability host severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(host) as nodes, count\_distinct(cve) as vulnerabilities by severity<br />\| sort by nodes, vulnerabilities, severity asc|
|Twistlock Classic|Image Scan - Top Descriptions|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" containerCompliance image\_id description<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents, count\_distinct(image\_id) as images by description<br />\| sort by incidents, images, description asc|
|Twistlock Classic|Image Scan - Top Rules Triggered|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" containerCompliance rule<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by rule<br />\| sort by incidents, rule asc|
|Twistlock Classic|Image Scan CVE Status|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" vulnerability image\_id cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "Fix Available", vendor\_status) as cve\_status<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count by cve\_status \| sort by \_count, cve\_status asc|
|Twistlock Classic|Image Scan CVEs - Fix Available|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" vulnerability image\_id vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "fixed", vendor\_status) as cve\_status<br />\| where cve\_status = "fixed"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as fixedCVECount by cve, severity, vendor\_status \| fields -fixedCVECount<br />\| sort by severity asc, cve|
|Twistlock Classic|Image Vulnerability - Top CVE|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" vulnerability image\_id cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(image\_id) as images by cve, severity<br />\| sort by images, cve|
|Twistlock Classic|Image Vulnerability - Top Descriptions|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" vulnerability image\_id cve description<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents, count\_distinct(image\_id) as images, count\_distinct(cve) as vulnerabilities by description<br />\| sort by incidents, images, description asc|
|Twistlock Classic|Image Vulnerability - Top Rules Triggered|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" vulnerability rule<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by rule<br />\| sort by incidents, rule asc|
|Twistlock Classic|Image, Registry Scan - CVEs Identified - Time Compare|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type ("image\_scan" or "registry\_scan") vulnerability vendor\_status<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop  <br />\| where type in ("image\_scan", "registry\_scan") and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "Fix Available", vendor\_status) as cve\_status<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as CVEs\_identified by image\_id<br />\| compare with timeshift -1d 2|
|Twistlock Classic|Images Impacted|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" containerCompliance severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(image\_id) as images by severity<br />\| sort by images, severity asc|
|Twistlock Classic|Images Impacted with Vulnerability by Severity|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" vulnerability image\_id cve vulnerability\_id severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(image\_id) as images, count\_distinct(cve) as vulnerabilities by severity<br />\| sort by images, vulnerabilities, severity asc|
|Twistlock Classic|Incident Category|Logs|Installed Apps/Twistlock Classic/Twistlock - Defender Incidents|\_sourceCategory={{Logsdatasource}}  incident incident\_category<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "incident\_category=\\"\*\\"" as incident\_category nodrop <br />\| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type="incident"<br />\|where if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{incident\_category}}" = "\*", true, incident\_category matches "{{incident\_category}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}")<br />\| count as incidents by incident\_category<br />\| sort by incidents, incident\_category asc<br />\| limit 10|
|Twistlock Classic|Management Activity|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  Twistlock-Console type log\_type management\_audit<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "username=\\"\*\\"" as username nodrop \| parse "source\_ip=\\"\*\\"" as source\_ip nodrop \| parse "api=\\"\*\\"" as api nodrop \| parse "status=\\"\*\\"" as status nodrop<br />\| where type matches "management\_audit"<br />\| timeslice 1s<br />\|where if ("{{username}}" = "\*", true, username matches "{{username}}") AND if ("{{source\_ip}}" = "\*", true, source\_ip matches "{{source\_ip}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{api}}" = "\*", true, api matches "{{api}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by \_timeslice, type, log\_type, source\_ip, api, username, status <br />\| fields -alerts<br />\| sort by \_timeslice|
|Twistlock Classic|Most Vulnerable Hosts|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type scan\_summary host hostname<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "vulnerabilities=\\"\*\\"" as vulnerabilities nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop<br />\| where type matches "scan\_summary" and log\_type = "host"<br />\| withtime vulnerabilities<br />\| where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{hostname}}" = "\*", true, hostname matches "{{hostname}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}")<br />\| most\_recent(vulnerabilities\_withtime) as vulnerabilities by hostname<br />\| num(vulnerabilities) as vulnerabilities <br />\| where vulnerabilities \> 0 <br />\| sort by vulnerabilities, hostname asc|
|Twistlock Classic|Most Vulnerable Images|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type scan\_summary image<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop<br />\| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "vulnerabilities=\\"\*\\"" as vulnerabilities nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "severity=\\"\*\\"" as severity nodrop<br />\| where type matches "scan\_summary" and log\_type = "image"<br />\| withtime vulnerabilities<br />\| where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\| most\_recent(vulnerabilities\_withtime) as vulnerabilities by image\_name<br />\| num(vulnerabilities) as vulnerabilities <br />\| where vulnerabilities \> 0 <br />\| sort by vulnerabilities, image\_name asc|
|Twistlock Classic|Number of Distinct Processes Spawned on Container - Trend|Logs|Installed Apps/Twistlock Classic/Twistlock - Defender Incidents|\_sourceCategory={{Logsdatasource}}  Twistlock-Defender type process interactive<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop \| parse "type=\\"\*\\"" as type nodrop \| parse "pid=\\"\*\\"" as pid nodrop \| parse "path=\\"\*\\"" as path nodrop \| parse "interactive=\\"\*\\"" as interactive nodrop \| parse "md5=\\"\*\\"" as md5 nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop <br />\| where type="process"<br />\| timeslice 5m<br />\| where if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{interactive}}" = "\*", true, interactive matches "{{interactive}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}")<br />\| count\_distinct(pid) as uniqueProcessIds by \_timeslice, container\_id<br />\| transpose row \_timeslice column container\_id|
|Twistlock Classic|Recent Critical Vulnerabilities|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* vulnerability cve critical<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "\*scan\*" and log\_type="vulnerability" and severity="critical"<br />\| timeslice 1s<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count by \_timeslice, type, log\_type, host, container\_id, image\_id, severity, cve|
|Twistlock Classic|Recent Defender Incidents|Logs|Installed Apps/Twistlock Classic/Twistlock - Defender Incidents|\_sourceCategory={{Logsdatasource}}  incident incident\_category<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "incident\_category=\\"\*\\"" as incident\_category nodrop <br />\| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type="incident"<br />\| timeslice 1s<br />\|where if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{incident\_category}}" = "\*", true, incident\_category matches "{{incident\_category}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}")<br />\|count as incidents by \_timeslice, component, type, host, incident\_category, service\_name, container\_id, image\_name<br />\| sort by \_timeslice|
|Twistlock Classic|Registry Impacted|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" containerCompliance severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "registry\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(image\_id) as images by severity<br />\| sort by images, severity asc|
|Twistlock Classic|Registry Impacted with Vulnerability by Severity|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" vulnerability image\_id cve vulnerability\_id<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop <br />\| where type matches "registry\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(image\_id) as images, count\_distinct(cve) as vulnerabilities by severity<br />\| sort by images, vulnerabilities, severity asc|
|Twistlock Classic|Registry Scan - Top Descriptions|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" containerCompliance<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "registry\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents, count\_distinct(image\_id) as images by description<br />\| sort by incidents, images, description asc|
|Twistlock Classic|Registry Scan - Top Rules Triggered|Logs|Installed Apps/Twistlock Classic/Twistlock - Compliance Violations|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" containerCompliance rule<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "registry\_scan" and log\_type="containerCompliance"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by rule<br />\| sort by incidents, rule asc|
|Twistlock Classic|Registry Scan CVE Status|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" vulnerability image\_id cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop  <br />\| where type matches "registry\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "Fix Available", vendor\_status) as cve\_status<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count by cve\_status \| sort by \_count, cve\_status asc|
|Twistlock Classic|Registry Scan CVEs - Fix Available|Logs|Installed Apps/Twistlock Classic/Twistlock - CVE Status|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" vulnerability image\_id cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop  <br />\| where type matches "registry\_scan" and log\_type="vulnerability" and !isEmpty(vendor\_status)<br />\| if (vendor\_status matches "fixed\*", "fixed", vendor\_status) as cve\_status<br />\| where cve\_status = "fixed"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{cve\_status}}" = "\*", true, cve\_status matches "{{cve\_status}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as fixedCVECount by cve, severity, vendor\_status \| fields -fixedCVECount<br />\| sort by severity asc, cve|
|Twistlock Classic|Registry Vulnerability - Top CVE|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" vulnerability image\_id cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop  <br />\| where type matches "registry\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(image\_id) as images by cve, severity<br />\| sort by images, cve|
|Twistlock Classic|Registry Vulnerability - Top Descriptions|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" vulnerability image\_id cve description<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop <br />\| where type matches "registry\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents, count\_distinct(image\_id) as images, count\_distinct(cve) as vulnerabilities by description<br />\| sort by incidents, images, description asc|
|Twistlock Classic|Registry Vulnerability - Top Rules Triggered|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" vulnerability rule<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop  <br />\| where type matches "registry\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by rule<br />\| sort by incidents, rule asc|
|Twistlock Classic|Rules Triggered|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* rule<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "\*scan\*" and !isEmpty(rule)<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(rule) as rules|
|Twistlock Classic|Runtime Filesystem Alert Details|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  Twistlock-Defender type log\_type \*audit\* filesystem alert<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*audit\*" and log\_type="filesystem" and effect="alert"<br />\|where if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by type, log\_type, container\_id, container\_name, image\_id, image\_name<br />\| sort by alerts, type, log\_type, container\_id, container\_name, image\_id, image\_name|
|Twistlock Classic|Runtime Network Alert Details|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  Twistlock-Defender type log\_type \*audit\* network alert<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*audit\*" and log\_type="network" and effect="alert"<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by type, log\_type, container\_id, container\_name, image\_id, image\_name<br />\| sort by alerts, type, log\_type, container\_id, container\_name, image\_id, image\_name|
|Twistlock Classic|Runtime Processes Alert Details|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  Twistlock-Defender type log\_type \*audit\* processes alert<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*audit\*" and log\_type="processes" and effect="alert"<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by type, log\_type, service\_name, container\_id, container\_name, image\_id, image\_name<br />\| sort by alerts, type, log\_type, service\_name, container\_id, container\_name, image\_id, image\_name|
|Twistlock Classic|Scans|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop<br />\| where type matches "\*scan\*"<br />\| where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{hostname}}" = "\*", true, hostname matches "{{hostname}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\| count as incidents|
|Twistlock Classic|Scans  by Component|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop<br />\| where type matches "\*scan\*"<br />\| where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{hostname}}" = "\*", true, hostname matches "{{hostname}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\| count as incidents by component<br />\| sort by incidents, component|
|Twistlock Classic|Scans by Log Type|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop<br />\| where type matches "\*scan\*"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{hostname}}" = "\*", true, hostname matches "{{hostname}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by log\_type<br />\| sort by incidents, log\_type|
|Twistlock Classic|Scans by Type|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop<br />\| where type matches "\*scan\*"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{hostname}}" = "\*", true, hostname matches "{{hostname}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by type<br />\| sort by incidents, type|
|Twistlock Classic|Scans by Type and Log Type|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\*<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "compliance\_id=\\"\*\\"" as compliance\_id nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop<br />\| where type matches "\*scan\*"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{hostname}}" = "\*", true, hostname matches "{{hostname}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{compliance\_id}}" = "\*", true, compliance\_id matches "{{compliance\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as incidents by type, log\_type<br />\| sort by type asc, incidents, log\_type asc|
|Twistlock Classic|Top Container Compliance Violations|Logs|Installed Apps/Twistlock Classic/Twistlock - Scans|\_sourceCategory={{Logsdatasource}}  type log\_type "container\_scan" container<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop<br />\| where type matches "container\_scan" and log\_type = "container"<br />\| num(compliance) as compliance \| compliance as compliance\_id<br />// \| where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ({{compliance\_id}} = "\*", true, compliance\_id = {{compliance\_id}}) AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\| count as scans by compliance\_id<br />\| sort by scans, compliance\_id asc<br />\| limit 10|
|Twistlock Classic|Top Hosts with Most CVEs|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "host\_scan" vulnerability host cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\" log\_type=\\"\*\\" vulnerability\_id=\\"\*\\" description=\\"\*\\" cve=\\"\*\\" severity=\\"\*\\" package=\\"\*\\" package\_version=\\"\*\\" vendor\_status=\\"\*\\" rule=\\"\*\\" host=\\"\*\\"" as type, log\_type, vulnerability\_id, description, cve, severity, package, package\_version, vendor\_status, rule, host nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(cve) as vulnerabilities by host<br />\| sort by vulnerabilities, host asc|
|Twistlock Classic|Top Images with Most CVEs|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "image\_scan" vulnerability image\_id cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(cve) as vulnerabilities by image\_id<br />\| sort by vulnerabilities, image\_id asc|
|Twistlock Classic|Top Processes Spawned on Containers|Logs|Installed Apps/Twistlock Classic/Twistlock - Defender Incidents|\_sourceCategory={{Logsdatasource}}  Twistlock-Defender type process interactive<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop \| parse "type=\\"\*\\"" as type nodrop \| parse "pid=\\"\*\\"" as pid nodrop \| parse "path=\\"\*\\"" as path nodrop \| parse "interactive=\\"\*\\"" as interactive nodrop \| parse "md5=\\"\*\\"" as md5 nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop <br />\| where type="process"<br />\|where if ("{{path}}" = "\*", true, path matches "{{path}}") AND if ("{{interactive}}" = "\*", true, interactive matches "{{interactive}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{pid}}" = "\*", true, pid matches "{{pid}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{md5}}" = "\*", true, md5 matches "{{md5}}")<br />\| count as spawnedFreq by path, interactive<br />\| sort by spawnedFreq, path asc, interactive|
|Twistlock Classic|Top Registry with Most CVEs|Logs|Installed Apps/Twistlock Classic/Twistlock - Detected Vulnerabilities|\_sourceCategory={{Logsdatasource}}  type log\_type "registry\_scan" vulnerability image\_id cve<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop  <br />\| where type matches "registry\_scan" and log\_type="vulnerability"<br />\|where if ("{{package\_version}}" = "\*", true, package\_version matches "{{package\_version}}") AND if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{package}}" = "\*", true, package matches "{{package}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(cve) as vulnerabilities by image\_id<br />\| sort by vulnerabilities, image\_id asc|
|Twistlock Classic|Top Runtime Filesystem Alerts|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  Twistlock-Defender type log\_type runtime \*audit\* filesystem alert<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*runtime\_audit\*" and log\_type="filesystem" and effect="alert"<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by type, log\_type, msg<br />\| sort by alerts, type asc, log\_type asc, msg asc|
|Twistlock Classic|Top Runtime Network Alerts|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  Twistlock-Defender type log\_type runtime \*audit\* network alert<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*runtime\_audit\*" and log\_type="network" and effect="alert"<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by type, log\_type, msg<br />\| sort by alerts, type asc, log\_type asc, msg asc|
|Twistlock Classic|Top Runtime Processes Alerts|Logs|Installed Apps/Twistlock Classic/Twistlock - Runtime|\_sourceCategory={{Logsdatasource}}  Twistlock-Defender type log\_type runtime \*audit\* processes alert<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "effect=\\"\*\\"" as effect nodrop \| parse "msg=\\"\*\\"" as msg nodrop \| parse "service\_name=\\"\*\\"" as service\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop<br />\| where type matches "\*runtime\_audit\*" and log\_type="processes" and effect="alert"<br />\|where if ("{{service\_name}}" = "\*", true, service\_name matches "{{service\_name}}") AND if ("{{status}}" = "\*", true, status matches "{{status}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{msg}}" = "\*", true, msg matches "{{msg}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{effect}}" = "\*", true, effect matches "{{effect}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count as alerts by type, log\_type, msg<br />\| sort by alerts, type asc, log\_type asc, msg asc|
|Twistlock Classic|Vulnerability Scan Events by Severity|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type \*scan\* vulnerability severity<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "description=\\"\*\\"" as description nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| where type matches "\*scan\*" and log\_type="vulnerability"<br />\| timeslice 1d<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count by \_timeslice, severity<br />\| transpose row \_timeslice column severity|
|Twistlock Classic|Vulnerable Hosts|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type host\_scan vulnerability host critical<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "description=\\"\*\\"" as description nodrop<br />\| where type matches "host\_scan" and log\_type="vulnerability" and !isEmpty(host) and severity="critical"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(host) as hosts|
|Twistlock Classic|Vulnerable Images|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type image\_scan vulnerability image\_id severity critical<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "hostname=\\"\*\\"" as hostname nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "compliance=\\"\*\\"" as compliance nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "description=\\"\*\\"" as description nodrop<br />\| where type matches "image\_scan" and log\_type="vulnerability" and !isEmpty(image\_id) and severity="critical"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(image\_id) as images|
|Twistlock Classic|Vulnerable Registry Images|Logs|Installed Apps/Twistlock Classic/Twistlock - Overview|\_sourceCategory={{Logsdatasource}}  type log\_type registry\_scan vulnerability image\_id severity critical<br />\| parse regex "\\s+(?\<component\>Twistlock-Console\|Twistlock-Defender?)\\s\*.\*\\s\*time=\\"" nodrop<br />\| parse "type=\\"\*\\"" as type nodrop \| parse "log\_type=\\"\*\\"" as log\_type nodrop \| parse "vulnerability\_id=\\"\*\\"" as vulnerability\_id nodrop<br />\| parse "description=\\"\*\\"" as description nodrop \| parse "cve=\\"\*\\"" as cve nodrop \| parse "severity=\\"\*\\"" as severity nodrop \| parse "package=\\"\*\\"" as package nodrop \| parse "package\_version=\\"\*\\"" as package\_version nodrop \| parse "vendor\_status=\\"\*\\"" as vendor\_status nodrop \| parse "rule=\\"\*\\"" as rule nodrop \| parse "host=\\"\*\\"" as host nodrop \| parse "image\_id=\\"\*\\"" as image\_id nodrop \| parse "image\_name=\\"\*\\"" as image\_name nodrop \| parse "container\_id=\\"\*\\"" as container\_id nodrop \| parse "container\_name=\\"\*\\"" as container\_name nodrop<br />\| where type matches "registry\_scan" and log\_type="vulnerability" and !isEmpty(image\_id) and severity="critical"<br />\|where if ("{{description}}" = "\*", true, description matches "{{description}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{host}}" = "\*", true, host matches "{{host}}") AND if ("{{cve}}" = "\*", true, cve matches "{{cve}}") AND if ("{{rule}}" = "\*", true, rule matches "{{rule}}") AND if ("{{component}}" = "\*", true, component matches "{{component}}") AND if ("{{image\_id}}" = "\*", true, image\_id matches "{{image\_id}}") AND if ("{{vulnerability\_id}}" = "\*", true, vulnerability\_id matches "{{vulnerability\_id}}") AND if ("{{vendor\_status}}" = "\*", true, vendor\_status matches "{{vendor\_status}}") AND if ("{{container\_name}}" = "\*", true, container\_name matches "{{container\_name}}") AND if ("{{type}}" = "\*", true, type matches "{{type}}") AND if ("{{container\_id}}" = "\*", true, container\_id matches "{{container\_id}}") AND if ("{{image\_name}}" = "\*", true, image\_name matches "{{image\_name}}") AND if ("{{log\_type}}" = "\*", true, log\_type matches "{{log\_type}}")<br />\|count\_distinct(image\_id) as images|

