# Google Cloud IAM
## Sumo Logic App For: Google Cloud IAM
The Sumo Logic App for Google Cloud IAM gives you visibility into the activities in your Cloud IAM. The preconfigured dashboards allow you to monitor the IAM project activities, operations, role activities, and policy changes.
Docs Link: [Google Cloud IAM](https://help.sumologic.com/?cid=4058)

## Searches

### Log Searches

- **Added Roles Over Time**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity 
- **Google Cloud IAM Project Messages**: from Search: Installed Apps/Google Cloud IAM/Google Cloud IAM Project Messages 
- **Google Cloud IAM Project Messages**: from Search: Google Cloud IAM/Google Cloud IAM Project Messages 
- **Google Cloud IAM Role Messages**: from Search: Google Cloud IAM/Google Cloud IAM Role Messages 
- **Google Cloud IAM Role Messages**: from Search: Installed Apps/Google Cloud IAM/Google Cloud IAM Role Messages 
- **Google Cloud IAM Service Account Messages**: from Search: Installed Apps/Google Cloud IAM/Google Cloud IAM Service Account Messages 
- **Google Cloud IAM Service Account Messages**: from Search: Google Cloud IAM/Google Cloud IAM Service Account Messages 
- **IAM Policy Changes by Project**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity 
- **Messages by Project**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview 
- **Operations**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview 
- **Recent IAM Role Activity**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview 
- **Recent Project Activity**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview 
- **Recent Service Account Activity**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview 
- **Removed Roles Over Time**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity 
- **Role Assignments**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity 
- **Role Assignments Over Time**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity 
- **Role Existence**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity 
- **Role Existence Over Time**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity 
- **User Operations**: from Dashboard: Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Google Cloud IAM|Added Roles Over Time|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" and log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br /><br />\| timeslice 1h<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.policyDelta.bindingDeltas[\*]" as labels, project, changes<br />\| parse regex field=changes "\\"role\\":\\"roles\\\\\\/(?\<role\>[a-zA-Z.]+)\\",\\"member\\":\\".\*\\",\\"action\\":\\"(?\<action\>[A-Z]+)\\"" multi<br />\| where action="ADD"<br />\|where if ("{{Role}}" = "\*", true, role matches "{{Role}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count by \_timeslice, role<br />\| transpose row \_timeslice column role|
|Google Cloud IAM|Google Cloud IAM Project Messages|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM Project Messages|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data" as data<br />\| json field=data "resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" \| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json field=data "timestamp", "resource.labels.project\_id", "protoPayload.authenticationInfo.principalEmail", "protoPayload.serviceData.policyDelta.bindingDeltas[\*]" as timestamp, project, user, changes<br /><br />\| parse regex field=changes "\\"role\\":\\"roles\\\\\\/(?\<role\>[a-zA-Z.]+)\\",\\"member\\":\\"(?\<member\>.\*?)\\",\\"action\\":\\"(?\<action\>[A-Z]+)\\"" multi<br />\| count by action, role, member, timestamp, user<br />\| sort by timestamp asc<br />\| 1 as operation<br />\| accum operation as total\_operations by user<br />\| fields timestamp, user, action, role, member, total\_operations<br />\| sort by timestamp|
|Google Cloud IAM|Google Cloud IAM Project Messages|Logs|Google Cloud IAM/Google Cloud IAM Project Messages|\_sourceCategory = Labs/GCP/cloudaudit logName resource timestamp<br />\| json "message.data" as data<br />\| json field=data "resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" \| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json field=data "timestamp", "resource.labels.project\_id", "protoPayload.authenticationInfo.principalEmail", "protoPayload.serviceData.policyDelta.bindingDeltas[\*]" as timestamp, project, user, changes<br /><br />\| parse regex field=changes "\\"role\\":\\"roles\\\\\\/(?\<role\>[a-zA-Z.]+)\\",\\"member\\":\\"(?\<member\>.\*?)\\",\\"action\\":\\"(?\<action\>[A-Z]+)\\"" multi<br />\| count by action, role, member, timestamp, user<br />\| sort by timestamp asc<br />\| 1 as operation<br />\| accum operation as total\_operations by user<br />\| fields timestamp, user, action, role, member, total\_operations<br />\| sort by timestamp|
|Google Cloud IAM|Google Cloud IAM Role Messages|Logs|Google Cloud IAM/Google Cloud IAM Role Messages|\_sourceCategory = Labs/GCP/cloudaudit logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "iam\_role"<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.timestamp", "message.data.resource.labels.project\_id" as timestamp, project<br />\| json "message.data.protoPayload" as payload<br />\| json field=payload "authenticationInfo.principalEmail", "response.title" as user, name<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br /><br />\| count by user, method, name, timestamp, project<br />\| sort by timestamp asc<br />\| 1 as operation<br />\| accum operation as total\_operations by user<br />\| fields timestamp, user, method, project, name, total\_operations<br />\| sort by timestamp|
|Google Cloud IAM|Google Cloud IAM Role Messages|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM Role Messages|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "iam\_role"<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.timestamp", "message.data.resource.labels.project\_id" as timestamp, project<br />\| json "message.data.protoPayload" as payload<br />\| json field=payload "authenticationInfo.principalEmail", "response.title" as user, name<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br /><br />\| count by user, method, name, timestamp, project<br />\| sort by timestamp asc<br />\| 1 as operation<br />\| accum operation as total\_operations by user<br />\| fields timestamp, user, method, project, name, total\_operations<br />\| sort by timestamp|
|Google Cloud IAM|Google Cloud IAM Service Account Messages|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM Service Account Messages|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "service\_account" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data" as data<br />\| json field=data "timestamp", "resource.labels.project\_id", "resource.labels.email\_id", "protoPayload.authenticationInfo.principalEmail" as timestamp, project, service\_account, user<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br /><br />\| count by user, method, service\_account, timestamp<br />\| sort by timestamp asc<br />\| 1 as operation<br />\| accum operation as total\_operations by user<br />\| fields timestamp, user, method, service\_account, total\_operations<br />\| sort by timestamp|
|Google Cloud IAM|Google Cloud IAM Service Account Messages|Logs|Google Cloud IAM/Google Cloud IAM Service Account Messages|\_sourceCategory = Labs/GCP/cloudaudit logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "service\_account" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data" as data<br />\| json field=data "timestamp", "resource.labels.project\_id", "resource.labels.email\_id", "protoPayload.authenticationInfo.principalEmail" as timestamp, project, service\_account, user<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br /><br />\| count by user, method, service\_account, timestamp<br />\| sort by timestamp asc<br />\| 1 as operation<br />\| accum operation as total\_operations by user<br />\| fields timestamp, user, method, service\_account, total\_operations<br />\| sort by timestamp|
|Google Cloud IAM|IAM Policy Changes by Project|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" \| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.protoPayload.methodName" as labels, method<br />\| where method = "SetIamPolicy"<br />\| json "message.data.resource.labels.project\_id" as project<br /><br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count as changes by \_timeslice, project<br />\| transpose row \_timeslice column project|
|Google Cloud IAM|Messages by Project|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "iam\_role" or type = "project" or type = "service\_account"<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels" as labels<br />\| json field=labels "project\_id" as project<br /><br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count as messages by \_timeslice, project<br />\| transpose row \_timeslice column project|
|Google Cloud IAM|Operations|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" or type = "iam\_role" or type = "service\_account"<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels" as labels<br />\| json field=labels "project\_id" as project<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br /><br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count as changes by \_timeslice, method<br />\| transpose row \_timeslice column method|
|Google Cloud IAM|Recent IAM Role Activity|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "iam\_role"<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.timestamp", "message.data.resource.labels.project\_id", "message.data.protoPayload" as labels, timestamp, project, payload<br />\| json field=payload "authenticationInfo.principalEmail", "response.title" as user, name<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count by user, method, name, timestamp, project<br />\| fields timestamp, user, method, project, name<br />\| sort by timestamp|
|Google Cloud IAM|Recent Project Activity|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data" as data<br />\| json field=data "resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json field=data "resource.labels", "timestamp", "resource.labels.project\_id", "protoPayload.authenticationInfo.principalEmail", "protoPayload.serviceData.policyDelta.bindingDeltas[\*]" as labels, timestamp, project, user, changes<br /><br />\| parse regex field=changes "\\"role\\":\\"roles\\\\\\/(?\<role\>[a-zA-Z.]+)\\",\\"member\\":\\"(?\<member\>.\*?)\\",\\"action\\":\\"(?\<action\>[A-Z]+)\\"" multi<br />\|where if ("{{Role}}" = "\*", true, role matches "{{Role}}") AND if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count by action, role, member, timestamp, user<br />\| fields timestamp, user, action, role, member<br />\| sort by timestamp|
|Google Cloud IAM|Recent Service Account Activity|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Overview|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "service\_account" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data" as data<br />\| json field=data "timestamp", "resource.labels", "resource.labels.project\_id", "resource.labels.email\_id", "protoPayload.authenticationInfo.principalEmail" as timestamp, labels, project, service\_account, user<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br />\|where if ("{{User}}" = "\*", true, user matches "{{User}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count by user, method, service\_account, timestamp<br />\| fields timestamp, user, method, service\_account<br />\| sort by timestamp|
|Google Cloud IAM|Removed Roles Over Time|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" and log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br /><br />\| timeslice 1h<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.policyDelta.bindingDeltas[\*]" as labels, project, changes<br />\| parse regex field=changes "\\"role\\":\\"roles\\\\\\/(?\<role\>[a-zA-Z.]+)\\",\\"member\\":\\".\*\\",\\"action\\":\\"(?\<action\>[A-Z]+)\\"" multi<br />\| where action="REMOVE"<br />\|where if ("{{Role}}" = "\*", true, role matches "{{Role}}") AND if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count by \_timeslice, role<br />\| transpose row \_timeslice column role|
|Google Cloud IAM|Role Assignments|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" and log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br /><br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.policyDelta.bindingDeltas[\*]" as labels, project, changes<br />\| parse regex field=changes "\\"action\\":\\"(?\<action\>[A-Z]+)\\"" multi<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count as total by action<br />\| sort by total|
|Google Cloud IAM|Role Assignments Over Time|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" and log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br /><br />\| timeslice 1h<br />\| json "message.data.resource.labels", "message.data.resource.labels.project\_id", "message.data.protoPayload.serviceData.policyDelta.bindingDeltas[\*]" as labels, project, changes<br />\| parse regex field=changes "\\"action\\":\\"(?\<action\>[A-Z]+)\\"" multi<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count by \_timeslice, action<br />\| transpose row \_timeslice column action|
|Google Cloud IAM|Role Existence|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "iam\_role" <br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.timestamp", "message.data.resource.labels.project\_id" as labels, timestamp, project<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count as total by method <br />\| sort by total|
|Google Cloud IAM|Role Existence Over Time|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data.resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "iam\_role" and log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json "message.data.resource.labels", "message.data.timestamp", "message.data.resource.labels.project\_id" as labels, timestamp, project<br />\| parse regex "\\"methodName\\":\\"[^\\"]+\\.(?\<method\>[^\\"]+)\\""<br /><br />\| timeslice 1h<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count by \_timeslice, method<br />\| transpose row \_timeslice column method|
|Google Cloud IAM|User Operations|Logs|Installed Apps/Google Cloud IAM/Google Cloud IAM - Role Activity|\_sourceCategory={{Logsdatasource}}  logName resource timestamp<br />\| json "message.data" as data<br />\| json field=data "resource.type" as type <br />\| parse regex "\\"logName\\":\\"(?\<log\_name\>[^\\"]+)\\"" <br />\| where type = "project" or type = "iam\_role"<br />\| where log\_name matches "projects/\*/logs/cloudaudit.googleapis.com%2Factivity"<br />\| json field=data "resource.labels", "resource.labels.project\_id", "protoPayload.methodName", "protoPayload.authenticationInfo.principalEmail" as labels, project, method, user<br />\|where if ("{{Project}}" = "\*", true, project matches "{{Project}}")<br />\|count as operations by user<br />\| sort by operations|

