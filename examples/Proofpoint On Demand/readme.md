# Proofpoint On Demand
## Sumo Logic App For: Proofpoint On Demand
Proofpoint On Demand is a cloud-based cybersecurity platform that offers a range of services to protect businesses against cyber threats. The platform includes email security, threat intelligence, information protection, and compliance solutions. The Proofpoint on Demand App for Sumo Logic provides insights into how their email security policies are functioning and can gain visibility into the effectiveness of their email security policies and make informed decisions to improve their security posture. The App further provides information on whether the communication is secured by encryption or not.
Docs Link: [Proofpoint On Demand](https://help.sumologic.com/?cid=10194)

## Searches

### Log Searches

- **Actions of Messages Over Time**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Actions of Messages Over Time**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Blocked Messages Trend**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Blocked Messages Trend**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Geo Locations of Blocked Messages**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Geo Locations of Blocked Messages**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Geo Locations of Senders**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Geo Locations of Senders**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Geo Locations of Unencrypted Sender Domains**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Geo Locations of Unencrypted Sender Domains**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Impostor Detection Trend**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Impostor Detection Trend**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Message Traffic Trend**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Message Traffic Trend**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Messages by Quarantine Folder**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Messages by Quarantine Folder**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Messages from High Risk Countries**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Messages from High Risk Countries**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Recent Messages**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Recent Messages**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **TLS Messages Trend**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **TLS Messages Trend**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 Anti-Spam Results**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 Anti-Spam Results**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 Anti-Virus Results**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 Anti-Virus Results**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 DLP Detection Results**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 DLP Detection Results**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 DMARC Detection Results**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 DMARC Detection Results**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 Receivers**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Top 10 Receivers**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Top 10 Senders**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Top 10 Senders**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Top 10 Unencrypted Receiver Domains**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 Unencrypted Receiver Domains**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 Unencrypted Sender Domains**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Top 10 Unencrypted Sender Domains**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Security Overview 
- **Unique Inbound Domains**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Unique Inbound Domains**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Unique Outbound Domains**: from Dashboard: Proofpoint On Demand/Proofpoint on Demand - Message Monitoring 
- **Unique Outbound Domains**: from Dashboard: Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Proofpoint On Demand|Actions of Messages Over Time|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| timeslice 1d<br />\| count\_distinct(guid) as frequency by \_timeslice,final\_action<br />\| fillmissing timeslice, values all in final\_action<br />\| transpose row \_timeslice column final\_action<br />|
|Proofpoint On Demand|Actions of Messages Over Time|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| timeslice 1d<br />\| count\_distinct(guid) as frequency by \_timeslice,final\_action<br />\| fillmissing timeslice, values all in final\_action<br />\| transpose row \_timeslice column final\_action<br />|
|Proofpoint On Demand|Blocked Messages Trend|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where disposition matches ("\*reject\*") or disposition matches("\*discard\*")<br />\| timeslice 1d<br />\| count\_distinct(guid) as frequency by \_timeslice,disposition<br />\| fillmissing timeslice, values all in disposition<br />\| transpose row \_timeslice column disposition<br />|
|Proofpoint On Demand|Blocked Messages Trend|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where disposition matches ("\*reject\*") or disposition matches("\*discard\*")<br />\| timeslice 1d<br />\| count\_distinct(guid) as frequency by \_timeslice,disposition<br />\| fillmissing timeslice, values all in disposition<br />\| transpose row \_timeslice column disposition<br />|
|Proofpoint On Demand|Geo Locations of Blocked Messages|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where disposition matches ("\*reject\*") or disposition matches("\*discard\*")<br />\| count\_distinct(guid) as frequency by ip<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip|
|Proofpoint On Demand|Geo Locations of Blocked Messages|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where disposition matches ("\*reject\*") or disposition matches("\*discard\*")<br />\| count\_distinct(guid) as frequency by ip<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip|
|Proofpoint On Demand|Geo Locations of Senders|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| count\_distinct(guid) as frequency by ip<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip|
|Proofpoint On Demand|Geo Locations of Senders|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| count\_distinct(guid) as frequency by ip<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip|
|Proofpoint On Demand|Geo Locations of Unencrypted Sender Domains|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !(is\_encrypted matches "true")<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(guid) as frequency by ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip|
|Proofpoint On Demand|Geo Locations of Unencrypted Sender Domains|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !(is\_encrypted matches "true")<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(guid) as frequency by ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip|
|Proofpoint On Demand|Impostor Detection Trend|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where final\_module matches ("\*spam\*")<br />\| where final\_rule matches("\*impostor\*")<br />\| timeslice 1d<br />\| count\_distinct(guid) as frequency by \_timeslice<br />\| fillmissing timeslice|
|Proofpoint On Demand|Impostor Detection Trend|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where final\_module matches ("\*spam\*")<br />\| where final\_rule matches("\*impostor\*")<br />\| timeslice 1d<br />\| count\_distinct(guid) as frequency by \_timeslice<br />\| fillmissing timeslice|
|Proofpoint On Demand|Message Traffic Trend|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| timeslice 1d<br />\| count\_distinct(guid) as frequency by \_timeslice,route\_direction<br />\| fillmissing timeslice, values all in route\_direction<br />\| transpose row \_timeslice column route\_direction|
|Proofpoint On Demand|Message Traffic Trend|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| timeslice 1d<br />\| count\_distinct(guid) as frequency by \_timeslice,route\_direction<br />\| fillmissing timeslice, values all in route\_direction<br />\| transpose row \_timeslice column route\_direction|
|Proofpoint On Demand|Messages by Quarantine Folder|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !isBlank(quarantine\_folder)<br />\| count\_distinct(guid) as total\_messages by quarantine\_folder<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Messages by Quarantine Folder|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !isBlank(quarantine\_folder)<br />\| count\_distinct(guid) as total\_messages by quarantine\_folder<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Messages from High Risk Countries|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(guid) as frequency by ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = ip <br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isBlank(country\_code)|
|Proofpoint On Demand|Messages from High Risk Countries|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(guid) as frequency by ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = ip <br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isBlank(country\_code)|
|Proofpoint On Demand|Recent Messages|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| extract field=sender\_email "\\\<(?\<individual\_sender\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=receiver\_email "\\\<(?\<individual\_receiver\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| where !(subject="[]")<br />\| json field=subject "[0]" as final\_subject<br />\| json field=message\_id "[0]" as final\_msg\_id<br />\| count\_distinct(guid) by \_messageTime,individual\_sender\_email,individual\_receiver\_email,disposition,time\_stamp,final\_subject,final\_msg\_id<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time\_stamp<br />\| top 100 individual\_sender\_email,individual\_receiver\_email,disposition,time\_stamp,final\_subject,final\_msg\_id by time\_stamp|
|Proofpoint On Demand|Recent Messages|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| extract field=sender\_email "\\\<(?\<individual\_sender\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=receiver\_email "\\\<(?\<individual\_receiver\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| where !(subject="[]")<br />\| json field=subject "[0]" as final\_subject<br />\| json field=message\_id "[0]" as final\_msg\_id<br />\| count\_distinct(guid) by \_messageTime,individual\_sender\_email,individual\_receiver\_email,disposition,time\_stamp,final\_subject,final\_msg\_id<br />\| formatDate(toLong(\_messageTime), "dd-MM-yyyy HH:mm:ss") as time\_stamp<br />\| top 100 individual\_sender\_email,individual\_receiver\_email,disposition,time\_stamp,final\_subject,final\_msg\_id by time\_stamp|
|Proofpoint On Demand|TLS Messages Trend|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| timeslice 1d<br />\| if(is\_encrypted matches("true"),"is\_encrypted","is\_unencrypted") as is\_encrypted\_final<br />\| count\_distinct(guid) by \_timeslice, is\_encrypted\_final<br />\| fillmissing timeslice, values all in is\_encrypted\_final<br />\| transpose row \_timeslice column is\_encrypted\_final|
|Proofpoint On Demand|TLS Messages Trend|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| timeslice 1d<br />\| if(is\_encrypted matches("true"),"is\_encrypted","is\_unencrypted") as is\_encrypted\_final<br />\| count\_distinct(guid) by \_timeslice, is\_encrypted\_final<br />\| fillmissing timeslice, values all in is\_encrypted\_final<br />\| transpose row \_timeslice column is\_encrypted\_final|
|Proofpoint On Demand|Top 10 Anti-Spam Results|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where final\_module matches ("spam")<br />\| count\_distinct(guid) as total\_messages by final\_rule<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Top 10 Anti-Spam Results|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where final\_module matches ("spam")<br />\| count\_distinct(guid) as total\_messages by final\_rule<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Top 10 Anti-Virus Results|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where final\_module matches ("av")<br />\| count\_distinct(guid) as total\_messages by final\_rule<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Top 10 Anti-Virus Results|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where final\_module matches ("av")<br />\| count\_distinct(guid) as total\_messages by final\_rule<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Top 10 DLP Detection Results|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where final\_module matches ("regulation")<br />\| count\_distinct(guid) as total\_messages by final\_rule<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Top 10 DLP Detection Results|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where final\_module matches ("regulation")<br />\| count\_distinct(guid) as total\_messages by final\_rule<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Top 10 DMARC Detection Results|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !isNull(action\_dmarc)<br />\| json field=action\_dmarc "filterdResult" as action\_dmarc\_rule<br />\| count\_distinct(guid) as total\_messages by action\_dmarc\_rule<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Top 10 DMARC Detection Results|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !isNull(action\_dmarc)<br />\| json field=action\_dmarc "filterdResult" as action\_dmarc\_rule<br />\| count\_distinct(guid) as total\_messages by action\_dmarc\_rule<br />\| sort by total\_messages<br />\| limit 10|
|Proofpoint On Demand|Top 10 Receivers|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| extract field=receiver\_email "\\\<(?\<individual\_receiver\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_receiver\_email "(?\<receiver\_email\>[a-zA-Z0-9.\_-]+@[a-zA-Z0-9.\_-]+\\.[a-zA-Z0-9\_-]+)"<br />\| count\_distinct(guid) as frequency by receiver\_email<br />\| sort by frequency<br />\| limit 10|
|Proofpoint On Demand|Top 10 Receivers|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| extract field=receiver\_email "\\\<(?\<individual\_receiver\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_receiver\_email "(?\<receiver\_email\>[a-zA-Z0-9.\_-]+@[a-zA-Z0-9.\_-]+\\.[a-zA-Z0-9\_-]+)"<br />\| count\_distinct(guid) as frequency by receiver\_email<br />\| sort by frequency<br />\| limit 10|
|Proofpoint On Demand|Top 10 Senders|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| extract field=sender\_email "\\\<(?\<individual\_sender\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_sender\_email "(?\<sender\_email\>[a-zA-Z0-9.\_-]+@[a-zA-Z0-9.\_-]+\\.[a-zA-Z0-9\_-]+)"<br />\| count\_distinct(guid) as frequency by sender\_email<br />\| sort by frequency<br />\| limit 10|
|Proofpoint On Demand|Top 10 Senders|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| extract field=sender\_email "\\\<(?\<individual\_sender\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_sender\_email "(?\<sender\_email\>[a-zA-Z0-9.\_-]+@[a-zA-Z0-9.\_-]+\\.[a-zA-Z0-9\_-]+)"<br />\| count\_distinct(guid) as frequency by sender\_email<br />\| sort by frequency<br />\| limit 10|
|Proofpoint On Demand|Top 10 Unencrypted Receiver Domains|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !(is\_encrypted matches "true")<br />// extracting individual emails from array of emails<br />\| extract field=receiver\_email "\\\<(?\<individual\_receiver\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_receiver\_email "@(?\<inbound\_domain\>[a-z0-9-.]\*)"<br />\| where !isBlank(inbound\_domain)<br />\| count\_distinct(guid) as frequency by inbound\_domain<br />\| sort by frequency<br />\| limit 10|
|Proofpoint On Demand|Top 10 Unencrypted Receiver Domains|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !(is\_encrypted matches "true")<br />// extracting individual emails from array of emails<br />\| extract field=receiver\_email "\\\<(?\<individual\_receiver\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_receiver\_email "@(?\<inbound\_domain\>[a-z0-9-.]\*)"<br />\| where !isBlank(inbound\_domain)<br />\| count\_distinct(guid) as frequency by inbound\_domain<br />\| sort by frequency<br />\| limit 10|
|Proofpoint On Demand|Top 10 Unencrypted Sender Domains|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !(is\_encrypted matches "true")<br />// extracting individual emails from array of emails<br />\| extract field=sender\_email "\\\<(?\<individual\_sender\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_sender\_email "@(?\<outbound\_domain\>[a-z0-9-.]\*)"<br />\| where !isBlank(outbound\_domain)<br />\| count\_distinct(guid) as frequency by outbound\_domain<br />\| sort by frequency<br />\| limit 10|
|Proofpoint On Demand|Top 10 Unencrypted Sender Domains|Logs|Proofpoint On Demand/Proofpoint on Demand - Security Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />\| where !(is\_encrypted matches "true")<br />// extracting individual emails from array of emails<br />\| extract field=sender\_email "\\\<(?\<individual\_sender\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_sender\_email "@(?\<outbound\_domain\>[a-z0-9-.]\*)"<br />\| where !isBlank(outbound\_domain)<br />\| count\_distinct(guid) as frequency by outbound\_domain<br />\| sort by frequency<br />\| limit 10|
|Proofpoint On Demand|Unique Inbound Domains|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />// extracting individual emails from array of emails<br />\| extract field=receiver\_email "\\\<(?\<individual\_receiver\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_receiver\_email ".@(?\<inbound\_domain\>[a-z0-9-.]\*)"<br />\| count\_distinct (inbound\_domain)|
|Proofpoint On Demand|Unique Inbound Domains|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />// extracting individual emails from array of emails<br />\| extract field=receiver\_email "\\\<(?\<individual\_receiver\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_receiver\_email ".@(?\<inbound\_domain\>[a-z0-9-.]\*)"<br />\| count\_distinct (inbound\_domain)|
|Proofpoint On Demand|Unique Outbound Domains|Logs|Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />// extracting individual emails from array of emails<br />\| extract field=sender\_email "\\\<(?\<individual\_sender\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_sender\_email "@(?\<outbound\_domain\>[a-z0-9-.]\*)"<br />\| count\_distinct(outbound\_domain)|
|Proofpoint On Demand|Unique Outbound Domains|Logs|Installed Apps/Proofpoint On Demand/Proofpoint on Demand - Message Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "guid","filter.modules.dmarc","filter.routeDirection","msg.header.from","msg.header.to","filter.disposition","connection.ip","ts","msg.header.subject","msg.header.message-id","filter.quarantine.folder","filter.isMsgEncrypted" as guid,action\_dmarc,route\_direction,sender\_email,receiver\_email,disposition,ip,time\_stamp,subject,message\_id,quarantine\_folder,is\_encrypted nodrop<br />\| json "filter.actions[?(@.isFinal == true)].action" as final\_action<br />\| json "filter.actions[?(@.isFinal == true)].rule" as final\_rule<br />\| json "filter.actions[?(@.isFinal == true)].module" as final\_module<br />\| if ( isNull(is\_encrypted), "null", is\_encrypted) as is\_encrypted<br />\| replace(final\_action, "[\\"", "") as final\_action<br />\| replace(final\_action, "\\"]", "") as final\_action<br />\| replace(final\_rule, "[\\"", "") as final\_rule<br />\| replace(final\_rule, "\\"]", "") as final\_rule<br />\| replace(final\_module, "[\\"", "") as final\_module<br />\| replace(final\_module, "\\"]", "") as final\_module<br />\| where route\_direction matches "{{route\_direction}}"<br />\| where final\_action matches "{{action}}"<br />\| where disposition matches "{{disposition}}"<br />\| where is\_encrypted matches "{{is\_encrypted}}"<br />\| where final\_rule matches "{{rule}}"<br />\| where final\_module matches "{{module}}"<br />// extracting individual emails from array of emails<br />\| extract field=sender\_email "\\\<(?\<individual\_sender\_email\>[\\w\\s\\-@.]\*)\\\>\\"?[,\\n\\]]" multi<br />\| extract field=individual\_sender\_email "@(?\<outbound\_domain\>[a-z0-9-.]\*)"<br />\| count\_distinct(outbound\_domain)|

