# Azure App Service Environment

## Searches

### Log Searches

- **Count By Operation Type**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview 
- **Distribution  by Operation Type (Read, Write and Delete)**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations 
- **Distribution by Operations**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations 
- **Failed Scaling Operations**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview 
- **Failed Upgrade Operations**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview 
- **Operations Trend**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview 
- **Recent Delete Operations**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations 
- **Recent Failed Operations By Server Farm**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview 
- **Recent Scaling Status By ServerFarm**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations 
- **Recent Upgrade Status By Server Farm**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations 
- **Recent Write Operations**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations 
- **Scaling Operations**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations 
- **Top 10 Hosting Environments By Scaling Events**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations 
- **Top 10 Hosting Environments By Upgrade Events**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations 
- **Top 10 operations that caused the most errors**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations 
- **Total Hosting Environments**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview 
- **Upgrade Operations**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations 
- **Users / Applications by Operation type**: from Dashboard: Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Azure App Service Environment|Count By Operation Type|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription", "time" as resultType, category, resource\_id, operationName, resultDescription, time<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs"<br />\| count by operationName|
|Azure App Service Environment|Distribution  by Operation Type (Read, Write and Delete)|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} <br /> provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative"<br />\| "OTHERS" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by operationType<br />\| sort by \_count|
|Azure App Service Environment|Distribution by Operations|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative" <br />\| count by operationName<br />\| order by \_count|
|Azure App Service Environment|Failed Scaling Operations|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription" as resultType, category, resource\_id, operationName, resultDescription<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs" and resultType="Failed" and operationName="Microsoft.Web/serverfarms/scale"<br />\| count by resource\_type, serverfarm\_name, resource\_group, resource\_name|
|Azure App Service Environment|Failed Upgrade Operations|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription" as resultType, category, resource\_id, operationName, resultDescription<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs" and resultType="Failed" and operationName="Microsoft.Web/serverfarms/upgrade"<br />\| count by resource\_type, serverfarm\_name, resource\_group, resource\_name|
|Azure App Service Environment|Operations Trend|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription", "time" as resultType, category, resource\_id, operationName, resultDescription, time<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs"<br />\| timeslice 1h<br />\| count by \_timeslice, operationName<br />\| transpose row \_timeslice column operationName|
|Azure App Service Environment|Recent Delete Operations|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "properties.entity", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, entity, identity\_claims\_name, authmethods nodrop<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative"and toUppercase(operationName) matches /DELETE/ <br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message, entity<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure App Service Environment|Recent Failed Operations By Server Farm|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription", "time" as resultType, category, resource\_id, operationName, resultDescription, time<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs" and resultType="Failed"<br />\| withtime resultType<br />\| most\_recent(resultType\_withtime) as currentOperationStatus by resource\_group, resource\_name, serverfarm\_name|
|Azure App Service Environment|Recent Scaling Status By ServerFarm|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription", "time" as resultType, category, resource\_id, operationName, resultDescription, time<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs" and resultType="Started" and operationName="Microsoft.Web/serverfarms/scale"<br />\| withtime resultType<br />\| most\_recent(resultType\_withtime) as currentScalingStatus by resource\_group, resource\_name, serverfarm\_name|
|Azure App Service Environment|Recent Upgrade Status By Server Farm|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription", "time" as resultType, category, resource\_id, operationName, resultDescription, time<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs" and resultType="Started" and operationName="Microsoft.Web/serverfarms/upgrade"<br />\| withtime resultType<br />\| most\_recent(resultType\_withtime) as currentUpgradeStatus by resource\_group, resource\_name, serverfarm\_name|
|Azure App Service Environment|Recent Write Operations|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']"  as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, identity\_claims\_name, authmethods nodrop<br />\| where resultType in ("Accept", "Success") and category="Administrative" and toUppercase(operationName) matches /WRITE/<br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message, resultType<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure App Service Environment|Scaling Operations|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription" as resultType, category, resource\_id, operationName, resultDescription<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs" and resultType="Started" and operationName="Microsoft.Web/serverfarms/scale"<br />\| format("resource\_type=%s resource\_group=%s serverfarm\_name=%s resource\_name=%s", resource\_type, serverfarm\_name, resource\_group, resource\_name) as resource\_identifier<br />\| timeslice 1h<br />\| count by \_timeslice, resource\_identifier<br />\| transpose row \_timeslice column resource\_identifier|
|Azure App Service Environment|Top 10 Hosting Environments By Scaling Events|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription" as resultType, category, resource\_id, operationName, resultDescription<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs" and resultType="Started" and operationName="Microsoft.Web/serverfarms/scale"<br />\| count by resource\_group, resource\_name<br />\| top 10  resource\_group, resource\_name by \_count|
|Azure App Service Environment|Top 10 Hosting Environments By Upgrade Events|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription" as resultType, category, resource\_id, operationName, resultDescription<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs" and resultType="Started" and operationName="Microsoft.Web/serverfarms/upgrade"<br />\| count by resource\_group, resource\_name<br />\| top 10  resource\_group, resource\_name by \_count|
|Azure App Service Environment|Top 10 operations that caused the most errors|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}   provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| json "resultType", "operationName", "properties.statusMessage", "category"  as resultType, operationName, failureMessage, category<br />\| where category="Administrative" and resultType="Failure"<br />\| count as Count by resource\_name, operationname, failureMessage<br />\| order by Count <br />\| limit 10|
|Azure App Service Environment|Total Hosting Environments|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription" as resultType, category, resource\_id, operationName, resultDescription<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs"<br />\| count by resource\_name<br />\| count|
|Azure App Service Environment|Upgrade Operations|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=HOSTINGENVIRONMENTS  resource\_name={{resource\_name}} "AppServiceEnvironmentPlatformLogs"<br />\| json "ResultType", "Category", "ResourceId", "OperationName", "ResultDescription" as resultType, category, resource\_id, operationName, resultDescription<br />\| parse field=resultDescription "(\*/serverfarms/\*)" as \_, serverfarm\_name<br />\| where Category="AppServiceEnvironmentPlatformLogs"<br />\| where resultType="Started" and operationName="Microsoft.Web/serverfarms/upgrade"<br />\| format("resource\_type=%s resource\_group=%s serverfarm\_name=%s resource\_name=%s", resource\_type, serverfarm\_name, resource\_group, resource\_name) as resource\_identifier<br />\| timeslice 1h<br />\| count by \_timeslice, resource\_identifier<br />\| transpose row \_timeslice column resource\_identifier|
|Azure App Service Environment|Users / Applications by Operation type|Logs|Installed Apps/Azure App Service Environment/Azure App Service Environment - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid nodrop<br />\| where resultType in ("Accept", "Success") and category="Administrative"<br />\| if (idtyp =="user", name, appid) as name<br />\| "Others" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by name, operationType<br />\| transpose row name column operationType|

