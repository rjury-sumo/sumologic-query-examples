# Palo Alto Networks 8

## Searches

### Log Searches

- **Bandwidth Consumption (Bytes) by Virtual Systems**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Bandwidth Consumption (Percentage) by App**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Configuration Activity Status Flow**: from Search: Palo Alto Networks 8/Searches/Configuration Activity Status Flow 
- **Configuration Status**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Correlation Events by Severity**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Failed Configuration Events**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Non Informational Correlation Events**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Non Informational System Events**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Non Informational Threats**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Requested Apps of Top 10 most active source IPs**: from Search: Palo Alto Networks 8/Searches/Requested Apps of Top 10 most active source IPs 
- **Source Host Locations**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **System Events by Severity**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Targets of Top 10 Attackers**: from Search: Palo Alto Networks 8/Searches/Targets of Top 10 Attackers 
- **Threat Type by Severity**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Threats by Severity**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Traps Events**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New 
- **Traps Events by Severity**: from Dashboard: Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Palo Alto Networks 8|Bandwidth Consumption (Bytes) by Virtual Systems|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/traffic TRAFFIC<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action, 32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC"<br />\| timeslice 5m<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|sum(bytes) as %"Bytes" by vsys, \_timeslice<br />\| transpose row \_timeslice column vsys|
|Palo Alto Networks 8|Bandwidth Consumption (Percentage) by App|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/traffic TRAFFIC<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action, 32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC"<br />\| timeslice 5m<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|sum(bytes) by app, \_timeslice <br />\| transpose row \_timeslice column app|
|Palo Alto Networks 8/Searches|Configuration Activity Status Flow|Logs|Palo Alto Networks 8/Searches/Configuration Activity Status Flow|\_sourceCategory = Labs/PaloAltoNetworksv8/config ",CONFIG," <br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as src\_user, 10 as cmd, 11 as admin, 12 as client, 13 as result, 14 as path, 15 as seqno, 16 as action\_flags, 17 as vsys, 18 as before\_change\_detail, 19 as after\_change\_detail, 20 as Device\_Group\_Hierarchy, 21 as vsys\_name, 22 as DeviceName<br />\| where type = "CONFIG"<br />\| trim(path) as path<br />\| transaction on serialnum with states Submitted, Succeeded, Failed in result results by flow<br />\| count, max(latency) by fromstate, tostate|
|Palo Alto Networks 8|Configuration Status|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/config ",CONFIG,"<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as src\_user, 10 as cmd, 11 as admin, 12 as client, 13 as result, 14 as path, 15 as seqno, 16 as action\_flags, 17 as vsys, 18 as before\_change\_detail, 19 as after\_change\_detail, 20 as Device\_Group\_Hierarchy, 21 as vsys\_name, 22 as DeviceName<br />\| where type = "CONFIG"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{result}}" = "\*", true, result matches "{{result}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount by result<br />\| sort by eventCount, result asc|
|Palo Alto Networks 8|Correlation Events by Severity|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/correlation ",CORRELATION,"<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as src\_user, 10 as vsys, 11 as Category, 12 as Severity, 13 as Device\_Group\_Hierarchy, 14 as vsys\_name, 15 as DeviceName, 16 as vSysID, 17 as Object\_Name, 18 as Object\_ID, 19 as Evidence<br />\| where type = "CORRELATION"<br />\|where if ("{{vsysid}}" = "\*", true, vsysid matches "{{vsysid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount by Severity<br />\| sort by eventCount, Severity asc|
|Palo Alto Networks 8|Failed Configuration Events|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/config ",CONFIG," Failed<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as src\_user, 10 as cmd, 11 as admin, 12 as client, 13 as result, 14 as path, 15 as seqno, 16 as action\_flags, 17 as vsys, 18 as before\_change\_detail, 19 as after\_change\_detail, 20 as Device\_Group\_Hierarchy, 21 as vsys\_name, 22 as DeviceName<br />\| where type = "CONFIG" and result="Failed"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{result}}" = "\*", true, result matches "{{result}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount|
|Palo Alto Networks 8|Non Informational Correlation Events|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/correlation ",CORRELATION,"<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as src\_user, 10 as vsys, 11 as Category, 12 as Severity, 13 as Device\_Group\_Hierarchy, 14 as vsys\_name, 15 as DeviceName, 16 as vSysID, 17 as Object\_Name, 18 as Object\_ID, 19 as Evidence<br />\| where type = "CORRELATION" and severity \<\> "informational"<br />\|where if ("{{vsysid}}" = "\*", true, vsysid matches "{{vsysid}}") AND if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount|
|Palo Alto Networks 8|Non Informational System Events|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/system ",SYSTEM,"<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as vsys, 9 as eventID, 10 as Object, 11 as f3, 12 as f4, 13 as Module, 14 as severity, 15 as description, 16 as seqNum, 17 as action\_flags, 18 as Device\_Group\_Hierarchy, 19 as vsys\_name, 20 as DeviceName<br />\| where type = "SYSTEM" and severity \<\> "informational"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount|
|Palo Alto Networks 8|Non Informational Threats|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/threat THREAT !(",file," or ",url,")<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action, 32 as urlORFileName, 33 as Threat\_Content\_Name, 34 as category, 35 as severity, 36 as direction, 37 as seqNum, 38 as action\_flags, 39 as src\_country, 40 as dest\_country, 41 as f4, 42 as content\_type, 43 as pcap\_id, 44 as filedigest, 45 as cloud, 46 as url\_idx, 47 as user\_agent, 48 as filetype, 49 as xff, 50 as referer, 51 as sender, 52 as subject, 53 as recipient, 54 as reportid, 55 as Device\_Group\_Hierarchy, 56 as vsys\_name, 57 as DeviceName, 58 as f5, 59 as Source\_VM\_UUID, 60 as Destination\_VM\_UUID, 61 as Parent\_Session\_ID, 62 as Tunnel\_ID\_IMSI, 63 as Monitor\_Tag\_IMEI, 64 as method, 65 as parent\_start\_time, 66 as Tunnel, 67 as thr\_category, 68 as contentver, 69 as f6, 70 as SCTP\_Association\_ID, 71 as Payload\_Protocol\_ID, 72 as http\_headers<br />\| where type = "THREAT" and severity \<\> "informational" and subtype not in ("file", "url")<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount|
|Palo Alto Networks 8/Searches|Requested Apps of Top 10 most active source IPs|Logs|Palo Alto Networks 8/Searches/Requested Apps of Top 10 most active source IPs|\_sourceCategory = Labs/PaloAltoNetworksv8/traffic TRAFFIC<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action1,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC"<br />\| join<br />( \* \| count as ipAPPCnt by src\_ip, app ) as src\_app, <br />( \* \| count as evtCnt by src\_ip \| top 10 src\_ip by evtCnt) as topIP <br />on topIP.src\_ip = src\_app.src\_ip timewindow 12h <br />\| fields src\_app\_src\_ip, src\_app\_app, src\_app\_ipAppcnt <br />\| sum(src\_app\_ipappcnt) by src\_app\_src\_ip, src\_app\_app <br />\| transpose row src\_app\_src\_ip column src\_app\_app|
|Palo Alto Networks 8|Source Host Locations|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/traffic TRAFFIC<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action, 32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count by src\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| where !isNull(latitude)|
|Palo Alto Networks 8|System Events by Severity|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/system ",SYSTEM,"<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as vsys, 9 as eventID, 10 as Object, 11 as f3, 12 as f4, 13 as Module, 14 as severity, 15 as description, 16 as seqNum, 17 as action\_flags, 18 as Device\_Group\_Hierarchy, 19 as vsys\_name, 20 as DeviceName<br />\| where type = "SYSTEM"<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount by Severity<br />\| sort by eventCount, Severity asc|
|Palo Alto Networks 8/Searches|Targets of Top 10 Attackers|Logs|Palo Alto Networks 8/Searches/Targets of Top 10 Attackers|\_sourceCategory = Labs/PaloAltoNetworksv8/threat THREAT<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action1, 32 as urlORFileName, 33 as Threat\_Content\_Name, 34 as category, 35 as severity, 36 as direction, 37 as seqNum, 38 as action\_flags, 39 as src\_country, 40 as dest\_country, 41 as f4, 42 as content\_type, 43 as pcap\_id, 44 as filedigest, 45 as cloud, 46 as url\_idx, 47 as user\_agent, 48 as filetype, 49 as xff, 50 as referer, 51 as sender, 52 as subject, 53 as recipient, 54 as reportid, 55 as Device\_Group\_Hierarchy, 56 as vsys\_name, 57 as DeviceName, 58 as f5, 59 as Source\_VM\_UUID, 60 as Destination\_VM\_UUID, 61 as Parent\_Session\_ID, 62 as Tunnel\_ID\_IMSI, 63 as Monitor\_Tag\_IMEI, 64 as method, 65 as parent\_start\_time, 66 as Tunnel, 67 as thr\_category, 68 as contentver, 69 as f6, 70 as SCTP\_Association\_ID, 71 as Payload\_Protocol\_ID, 72 as http\_headers<br />\| where type = "THREAT"<br />\| join <br />( \* \| count as ipAPPCnt by src\_ip, dest\_ip, src\_port, dest\_port, Threat\_Content\_Name) as threat,<br />( \* \| count as evtCnt by src\_ip \| top 10 src\_ip by evtCnt) as src\_ip <br />on threat. src\_ip = src\_ip. src\_ip timewindow 12h<br />\| count\_distinct(threat\_dest\_ip) as DistinctTargets by threat\_src\_ip, threat\_dest\_port, threat\_Threat\_Content\_Name<br />\| sort -DistinctTargets|
|Palo Alto Networks 8|Threat Type by Severity|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/threat THREAT !(",file," or ",url,")<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action, 32 as urlORFileName, 33 as Threat\_Content\_Name, 34 as category, 35 as severity, 36 as direction, 37 as seqNum, 38 as action\_flags, 39 as src\_country, 40 as dest\_country, 41 as f4, 42 as content\_type, 43 as pcap\_id, 44 as filedigest, 45 as cloud, 46 as url\_idx, 47 as user\_agent, 48 as filetype, 49 as xff, 50 as referer, 51 as sender, 52 as subject, 53 as recipient, 54 as reportid, 55 as Device\_Group\_Hierarchy, 56 as vsys\_name, 57 as DeviceName, 58 as f5, 59 as Source\_VM\_UUID, 60 as Destination\_VM\_UUID, 61 as Parent\_Session\_ID, 62 as Tunnel\_ID\_IMSI, 63 as Monitor\_Tag\_IMEI, 64 as method, 65 as parent\_start\_time, 66 as Tunnel, 67 as thr\_category, 68 as contentver, 69 as f6, 70 as SCTP\_Association\_ID, 71 as Payload\_Protocol\_ID, 72 as http\_headers<br />\| where type = "THREAT" and subtype not in ("file", "url")<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount by subtype, severity <br />\| transpose row severity column subtype|
|Palo Alto Networks 8|Threats by Severity|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/threat THREAT !(",file," or ",url,")<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action, 32 as urlORFileName, 33 as Threat\_Content\_Name, 34 as category, 35 as severity, 36 as direction, 37 as seqNum, 38 as action\_flags, 39 as src\_country, 40 as dest\_country, 41 as f4, 42 as content\_type, 43 as pcap\_id, 44 as filedigest, 45 as cloud, 46 as url\_idx, 47 as user\_agent, 48 as filetype, 49 as xff, 50 as referer, 51 as sender, 52 as subject, 53 as recipient, 54 as reportid, 55 as Device\_Group\_Hierarchy, 56 as vsys\_name, 57 as DeviceName, 58 as f5, 59 as Source\_VM\_UUID, 60 as Destination\_VM\_UUID, 61 as Parent\_Session\_ID, 62 as Tunnel\_ID\_IMSI, 63 as Monitor\_Tag\_IMEI, 64 as method, 65 as parent\_start\_time, 66 as Tunnel, 67 as thr\_category, 68 as contentver, 69 as f6, 70 as SCTP\_Association\_ID, 71 as Payload\_Protocol\_ID, 72 as http\_headers<br />\| where type = "THREAT" and subtype not in ("file", "url")<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{vsys\_name}}" = "\*", true, vsys\_name matches "{{vsys\_name}}")<br />\|count as eventCount by Severity<br />\| sort by eventCount, Severity asc|
|Palo Alto Networks 8|Traps Events|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/trapsv4 CEF "\|Palo Alto Networks\|"<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* dhost=\* duser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Policy\|\*\|rt=\* shost=\* suser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, suser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|System\|\*\|rt=\* shost=\* suser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, suser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|System\|\*\|rt=\* shost=\* duser=\* management core fname=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, duser, fname, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Config\|\*\|rt=\* shost=\* suser=\* dhost=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, suser, dhost, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* dhost=\* duser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* shost=\* suser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, suser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* dhost=\* duser=\* deviceProcessName=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, deviceProcessName, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* dhost=\* duser=\* cs4Label=\* cs4=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, cs4Label, cs4, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Threat\|\*\|rt=\* shost=\* duser=\* cs2Label=\* cs2=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, duser, cs2Label, cs2, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Threat\|\*\|rt=\* dhost=\* duser=\* cs2Label=\* cs2=\* deviceProcessName=\* fileHash=\* cs3Label=\* cs3=\* dvc=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, cs2Label, cs2, deviceProcessName, fileHash, cs3Label, cs3, dvc, msg nodrop<br />\| parse field = msg "Agent Service Status Changed: \*-\> \*" as oldStatus, newStatus nodrop<br />\| parse field = msg " received new content- version \*" as contentVersion nodrop<br />\| parse field = msg "Content version was \* to \* successfully" as action, contentVersion nodrop <br />\| parse field = msg "Access Violation- child process: \*" as childProcess nodrop<br />\| parse field = msg "New Notification event. Prevention Key: \*" as preventionKey nodrop <br />\| parse field = cs2 "WildFire Unknown deviceProcessName=\* fileHash=\*" as deviceProcessName, fileHash nodrop<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{externalseverity}}" = "\*", true, externalseverity matches "{{externalseverity}}")<br />\|count as eventCount|
|Palo Alto Networks 8|Traps Events by Severity|Logs|Palo Alto Networks 8/Palo Alto Networks 8 - Overview - New|\_sourceCategory = Labs/PaloAltoNetworksv8/trapsv4 CEF "\|Palo Alto Networks\|"<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* dhost=\* duser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Policy\|\*\|rt=\* shost=\* suser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, suser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|System\|\*\|rt=\* shost=\* suser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, suser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|System\|\*\|rt=\* shost=\* duser=\* management core fname=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, duser, fname, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Config\|\*\|rt=\* shost=\* suser=\* dhost=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, suser, dhost, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* dhost=\* duser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* shost=\* suser=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, suser, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* dhost=\* duser=\* deviceProcessName=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, deviceProcessName, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Agent\|\*\|rt=\* dhost=\* duser=\* cs4Label=\* cs4=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, cs4Label, cs4, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Threat\|\*\|rt=\* shost=\* duser=\* cs2Label=\* cs2=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, shost, duser, cs2Label, cs2, msg nodrop<br />\| parse "CEF:0\|Palo Alto Networks\|\*\|\*\|\*\|Threat\|\*\|rt=\* dhost=\* duser=\* cs2Label=\* cs2=\* deviceProcessName=\* fileHash=\* cs3Label=\* cs3=\* dvc=\* msg=\*" as TrapsComponent, productVersion, event, ExternalSeverity, rt, dhost, duser, cs2Label, cs2, deviceProcessName, fileHash, cs3Label, cs3, dvc, msg nodrop<br />\| parse field = msg "Agent Service Status Changed: \*-\> \*" as oldStatus, newStatus nodrop<br />\| parse field = msg " received new content- version \*" as contentVersion nodrop<br />\| parse field = msg "Content version was \* to \* successfully" as action, contentVersion nodrop <br />\| parse field = msg "Access Violation- child process: \*" as childProcess nodrop<br />\| parse field = msg "New Notification event. Prevention Key: \*" as preventionKey nodrop <br />\| parse field = cs2 "WildFire Unknown deviceProcessName=\* fileHash=\*" as deviceProcessName, fileHash nodrop<br />\|where if ("{{severity}}" = "\*", true, severity matches "{{severity}}") AND if ("{{vsys}}" = "\*", true, vsys matches "{{vsys}}") AND if ("{{subtype}}" = "\*", true, subtype matches "{{subtype}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{externalseverity}}" = "\*", true, externalseverity matches "{{externalseverity}}")<br />\|count as eventCount by ExternalSeverity<br />\| sort by eventCount, ExternalSeverity asc|

