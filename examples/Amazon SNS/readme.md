# Amazon SNS
## Sumo Logic App For: Amazon SNS
The Sumo Logic App for Amazon SNS is a unified logs and metrics (ULM) App that provides insights into the operations and utilization of your SNS service. The preconfigured dashboards help you monitor the key metrics by application, platform, region, and topic name, view the SNS events for activities, and help you plan the capacity of your SNS service.
Docs Link: [Amazon SNS](https://help.sumologic.com/?cid=4062)

## Searches

### Log Searches

- **Event Status**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Event Status Trend**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Events by User**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Events Trend by Event Name**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Failed Event Details**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Failed Events**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Failure Events Location**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Most Active TopicNames**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Successful Event Details**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Successful Events**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Successful Events Location**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Top Error Codes**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New 
- **Top Users**: from Dashboard: Amazon SNS/Amazon SNS - CloudTrail Events - New

### Metric Searches

- **Message Publish Size**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New 
- **Message Publish Size**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New 
- **Number of Messages Published**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New 
- **Number of Messages Published**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New 
- **Number of Notifications Delivered**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New 
- **Number of Notifications Delivered**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New 
- **Number of Notifications Failed**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New 
- **Number of Notifications Failed**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New 
- **SMS Success Rate**: from Dashboard: Amazon SNS/Amazon SNS - Metric by Application and Platform - New

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Amazon SNS|Event Status|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\""<br />\| json "eventName" nodrop \| json "eventSource" nodrop \| json "errorCode" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop<br />\| where eventSource="sns.amazonaws.com"<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| if (isEmpty(userName), user, userName) as user<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count by eventStatus|
|Amazon SNS|Event Status Trend|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\""<br />\| json "eventName" nodrop \| json "eventSource" nodrop \| json "errorCode" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop<br />\| where eventSource="sns.amazonaws.com"<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| if (isEmpty(userName), user, userName) as user<br />\| timeslice 1d<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count by \_timeslice, eventStatus<br />\| fillmissing timeslice(1d), values ("Success", "Failure") in eventStatus<br />\| transpose row \_timeslice column eventStatus|
|Amazon SNS|Events by User|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\""<br />\| json "eventSource" nodrop \| json "eventName" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.type" as type nodrop \| json "userIdentity.arn" as arn nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.userName" as userName nodrop \| json "errorCode" nodrop<br />\| where eventSource="sns.amazonaws.com"<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| parse field=arn ":assumed-role/\*" as user nodrop \| parse field=arn "arn:aws:iam::\*:\*" as accountId, user nodrop<br />\| if (isEmpty(userName), user, userName) as user<br />\| timeslice 1d<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count as eventCount by user, eventName<br />\| transpose row user column eventName|
|Amazon SNS|Events Trend by Event Name|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\""<br />\| json "eventSource" nodrop \| json "eventName" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "errorCode" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop <br />\| where eventSource="sns.amazonaws.com"<br />\| if (isEmpty(userName), user, userName) as user<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus <br />\| timeslice 1h<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count as eventCount by \_timeslice, eventName<br />\| transpose row \_timeslice column eventName|
|Amazon SNS|Failed Event Details|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\"" errorCode<br />\| json "eventName" nodrop \| json "eventSource" nodrop \| json "errorCode" nodrop \| json "errorMessage" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.type" as type nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop \| parse field=arn "arn:aws:iam::\*:\*" as accountId, user nodrop<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| where eventSource="sns.amazonaws.com" and eventStatus="Failure"<br />\| if (isEmpty(userName), user, userName) as user<br />\| timeslice 1s<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count as eventCount by \_timeslice, eventName, errorCode, errorMessage, awsRegion, sourceIPAddress, accountId, user, type<br />\| sort by \_timeslice|
|Amazon SNS|Failed Events|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\"" errorCode<br />\| json "eventName" nodrop \| json "eventSource" nodrop \| json "errorCode" nodrop \| json "errorMessage" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.type" as type nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop \| parse field=arn "arn:aws:iam::\*:\*" as accountId, user nodrop<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| where eventSource="sns.amazonaws.com" and eventStatus="Failure"<br />\| if (isEmpty(userName), user, userName) as user<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count as eventCount by eventName<br />\| sort by eventCount|
|Amazon SNS|Failure Events Location|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\"" errorCode<br />\| json "eventSource" nodrop \| json "sourceIPAddress" nodrop \| json "eventName" nodrop \| json "errorCode" nodrop \| json "awsRegion" nodrop \| json "errorCode" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| where eventSource="sns.amazonaws.com" and eventStatus="Failure"<br />\| if (isEmpty(userName), user, userName) as user<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count by sourceIPAddress, eventName<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = sourceIPAddress<br />\| sort \_count|
|Amazon SNS|Message Publish Size|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|application={{application}}  Namespace=AWS/SNS metric=PublishSize Statistic=Average Application=\*|
|Amazon SNS|Message Publish Size|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|platform={{platform}}  Namespace=AWS/SNS metric=PublishSize Statistic=Average Platform=\*|
|Amazon SNS|Most Active TopicNames|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\"" topicArn<br />\| json "eventName" nodrop \| json "eventSource" nodrop \| json "errorCode" nodrop \| json "errorMessage" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop \| json "requestParameters.topicArn" as topicArn1 nodrop \| json "responseElements.topicArn" as topicArn2 nodrop<br />\| if (!isEmpty(topicArn1), topicArn1, topicArn2) as topicArn<br />\| where eventSource="sns.amazonaws.com" and !isEmpty(topicArn)<br />\| parse field=topicArn "arn:aws:sns:\*:\*:\*" as topicRegion, topicAccountId, topicName<br />\| count as eventCount by topicName<br />\| top 10 topicName by eventCount|
|Amazon SNS|Number of Messages Published|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|platform={{platform}}  Namespace=AWS/SNS metric=NumberOfMessagesPublished Statistic=Sum Platform=\*|
|Amazon SNS|Number of Messages Published|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|application={{application}}  Namespace=AWS/SNS metric=NumberOfMessagesPublished Statistic=Sum Application=\*|
|Amazon SNS|Number of Notifications Delivered|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|platform={{platform}}  Namespace=AWS/SNS metric=NumberOfNotificationsDelivered Statistic=Sum Platform=\* |
|Amazon SNS|Number of Notifications Delivered|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|application={{application}}  Namespace=AWS/SNS metric=NumberOfNotificationsDelivered Statistic=Sum Application=\* |
|Amazon SNS|Number of Notifications Failed|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|platform={{platform}}  Namespace=AWS/SNS metric=NumberOfNotificationsFailed Statistic=Sum Platform=\*|
|Amazon SNS|Number of Notifications Failed|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|application={{application}}  Namespace=AWS/SNS metric=NumberOfNotificationsFailed Statistic=Sum Application=\*|
|Amazon SNS|SMS Success Rate|Metrics|Amazon SNS/Amazon SNS - Metric by Application and Platform - New|country={{country}} smstype={{smstype}}  Namespace=AWS/SNS metric=SMSSuccessRate Statistic=Average SMSType=\* |
|Amazon SNS|Successful Event Details|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\"" !errorCode<br />\| json "eventName" nodrop \| json "eventSource" nodrop \| json "errorCode" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userAgent" nodrop \| json "userIdentity.type" as type nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "requestParameters.topicArn" as topicArn nodrop \| json "requestParameters.name" as name nodrop \| json "requestID" nodrop \| json "userIdentity.userName" as username nodrop \| parse field=arn "arn:aws:iam::\*:\*" as accountId, user nodrop<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| where eventSource="sns.amazonaws.com" and eventStatus="Success"<br />\| if (isEmpty(userName), user, userName) as user<br />\| timeslice 1s<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count as eventCount by \_timeslice, eventName, awsRegion, sourceIPAddress, accountId, user, type, requestId, name, topicArn, userAgent<br />\| sort by \_timeslice|
|Amazon SNS|Successful Events|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\"" !errorCode<br />\| json "eventName" nodrop \| json "eventSource" nodrop \| json "errorCode" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userAgent" nodrop \| json "userIdentity.type" as type nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "requestParameters.topicArn" as topicArn nodrop \| json "requestParameters.name" as name nodrop \| json "requestID" nodrop \| json "userIdentity.userName" as username nodrop \| parse field=arn "arn:aws:iam::\*:\*" as accountId, user nodrop<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| where eventSource="sns.amazonaws.com" and eventStatus="Success"<br />\| if (isEmpty(userName), user, userName) as user<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count as eventCount by eventName<br />\| sort by eventCount|
|Amazon SNS|Successful Events Location|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\"" !errorCode<br />\| json "eventSource" nodrop \| json "sourceIPAddress" nodrop \| json "eventName" nodrop \| json "awsRegion" nodrop \| json "errorCode" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| where eventSource="sns.amazonaws.com" and eventStatus="Success"<br />\| if (isEmpty(userName), user, userName) as user<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count by sourceIPAddress, eventName<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = sourceIPAddress<br />\| sort \_count|
|Amazon SNS|Top Error Codes|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\"" errorCode<br />\| json "eventName" nodrop \| json "eventSource" nodrop \| json "errorCode" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.arn" as arn nodrop \| parse field=arn ":assumed-role/\*" as user nodrop \| json "userIdentity.userName" as username nodrop<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| where eventSource="sns.amazonaws.com" and eventStatus="Failure"<br />\| if (isEmpty(userName), user, userName) as user<br />\| count as eventCount by errorCode <br />\| top 10 errorCode by eventCount|
|Amazon SNS|Top Users|Logs|Amazon SNS/Amazon SNS - CloudTrail Events - New|\_sourceCategory = Labs/AWS/CloudTrail\* "\\"eventsource\\":\\"sns.amazonaws.com\\""<br />\| json "eventSource" nodrop \| json "eventName" nodrop \| json "awsRegion" nodrop \| json "sourceIPAddress" nodrop \| json "userIdentity.type" as type nodrop \| json "userIdentity.arn" as arn nodrop \| json "userIdentity.accountId" as accountId nodrop \| json "userIdentity.userName" as userName nodrop \| json "errorCode" nodrop<br />\| where eventSource="sns.amazonaws.com"<br />\| if (isEmpty(errorCode), "Success", "Failure") as eventStatus<br />\| parse field=arn ":assumed-role/\*" as user nodrop \| parse field=arn "arn:aws:iam::\*:\*" as accountId, user nodrop<br />\| if (isEmpty(userName), user, userName) as user<br />\|where if ("{{eventname}}" = "\*", true, eventname matches "{{eventname}}") AND if ("{{accountid}}" = "\*", true, accountid matches "{{accountid}}") AND if ("{{sourceipaddress}}" = "\*", true, sourceipaddress matches "{{sourceipaddress}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{awsregion}}" = "\*", true, awsregion matches "{{awsregion}}") AND if ("{{eventstatus}}" = "\*", true, eventstatus matches "{{eventstatus}}")<br />\|count as eventCount by user<br />\| top 10 user by eventCount|

