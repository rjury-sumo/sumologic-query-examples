# Netskope
## Sumo Logic App For: Netskope
Netskope is a Cloud Access Security Broker (CASB) hosted in the cloud. The Netskope product is primarily used for enforcing security policies for cloud-based resources, such as Box and Microsoft Office 365.The Netskope App provides visibility into security posture for your applications and helps you determine the overall usage of software and SaaS applications.
Docs Link: [Netskope](https://help.sumologic.com/?cid=1965)

## Searches

### Log Searches

- **Alert Locations by Source IP**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Alerts - Time Compare Today vs Last Week Avg**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Details 
- **Alerts by Application**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Details 
- **Alerts by Type**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Alerts Outlier Over Time**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Details 
- **Alerts Over Time**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Anomalies by Activity**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Anomalies by Activity**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Anomalies by Alert Name**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Anomalies by Alert Name**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Anomalies by App**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Anomalies by App**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Anomalies by App Category**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Anomalies by App Category**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Anomalies by Risk Level**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Anomalies by Risk Level**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Anomalies Count**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Anomalies Count**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Anomalies Count**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Anomalies Over Time**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Anomalies Over Time**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **App by Alerts - Distribution**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Applications by Activity Distribution**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **Applications by Activity Distribution**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **Applications by Category**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **Applications Distribution by Category**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Applications Distribution by CCL**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Applications Distribution by Users**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Applications Used Over Time**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Apps used by User after Credentials Breach**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials 
- **Apps used on Infected Machines**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Breach Count**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials 
- **Breach Count**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Browser Distribution by User**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Compromised Credentials by Source of Info**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials 
- **Compromised Credentials Users Count**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials 
- **Device Distribution by User**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **DLP incidents by Activity**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **DLP Incidents by Browser and Browser Version**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **DLP incidents by Category**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **DLP incidents by File Type**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **DLP Incidents by OS and OS Version**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **DLP Incidents by Policy Over Time**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **DLP incidents by Severity**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **DLP Incidents Count**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **DLP Incidents Count**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **Failed Logins**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Malware by Activity**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Malware by Category**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Malware by Severity**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Malware Incidents by App**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Malware Types affecting Unique UserIP**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Network Usage Over Time**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **Network Usage Over Time**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **Objects with High and Critical Severity**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **OS Distribution by User**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Recent Alerts**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Recent Alerts with Poor Cloud Confidence Level**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Details 
- **Recent Anomalies by High Risk Level**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Recent Anomalies by High Risk Level**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Recent Compromised Credentials**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials 
- **Recent DLP incidents with High and Critical Severity**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **Recent Malwares**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Recent User Activity**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Suspicious Destination IP Locations**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Details 
- **Suspicious Source IP Locations**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Details 
- **Top 10 Activity**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Top 10 Affected File Types**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Top 10 Alerts**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Top 10 Applications by Avg Connection Duration**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **Top 10 Applications by Avg Page Duration**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **Top 10 Applications by Total Alerts**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **Top 10 Applications by Total Alerts**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **Top 10 Applications by Total Bytes**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **Top 10 Applications by Total Bytes**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **Top 10 Breaches by breach score**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials 
- **Top 10 Devices by User Access**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **Top 10 Devices by User Access**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **Top 10 DLP Policy Violations**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **Top 10 DLP Profile**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **Top 10 DLP Rules**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **Top 10 Malware by Malware Id, Malware Name**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Top 10 Malware Type**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Top 10 Source IPs**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Top 10 UserIP violating DLP Policy**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **Top 10 Users**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Top 10 Users**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Top 10 Users affected by Malwares**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Top 10 Users by Alerts**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Top 10 Users by Total Alerts**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Top 20 Applications by Category**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **Top User by Anomaly Risk Level**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Top User by Anomaly Risk Level**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Top Users and Hostname by DLP Incidents Count**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **Total  Activities**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Total  Sessions**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Total  Unique Applications**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Total  Unique Sessions**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Total  Unique Site**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Total  Unique Users**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Total Alerts**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Total App Affected**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Total Files Infected**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Total Malwares Detected**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Total Malwares Detected**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Total Policy Alerts**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview 
- **Total Unique Apps**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **Total Unique Apps**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **Total Unique Users**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **Total Users Affected**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **User Activities after Credentials Breach**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials 
- **User Activity Distribution**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **User Activity on Infected machines**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **User Agent Distribution**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Detail 
- **User Agent Distribution**: from Dashboard: Netskope/Application Usage/Netskope - Application Detail - New 
- **User Locations by DestinationIP**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **User Locations by SourceIP**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Overview 
- **User Locations by SourceIP**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **UserIP affected by Unique Malware Name**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Malware 
- **Users Affected**: from Dashboard: Netskope/Security Alerts/Netskope - Anomalies - New 
- **Users Affected**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Anomalies 
- **Users Affected**: from Dashboard: Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention 
- **Users by Country**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users 
- **Users by Traffic Type**: from Dashboard: Installed Apps/Netskope/Application Usage/Netskope - Application Users

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Netskope/Security Alerts|Alert Locations by Source IP|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where !isNull(alert\_type) and is\_alert="yes"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by src\_ip, alert\_name<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code, alert\_name<br />\| sort \_count|
|Netskope/Security Alerts|Alerts - Time Compare Today vs Last Week Avg|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Details|\_sourceCategory={{Logsdatasource}}  "yes"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, alert\_name, is\_alert, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where is\_alert="yes" and !isNull(alert\_type)<br />\| timeslice 1h<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{alert\_type}}" = "\*", true, alert\_type matches "{{alert\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{CLOUD\_CONFIDENCE\_LEVEL}}" = "\*", true, ccl matches "{{CLOUD\_CONFIDENCE\_LEVEL}}")<br />\|count by \_timeslice<br />\| compare with timeshift -1w 1 avg as last\_week\_avg|
|Netskope/Security Alerts|Alerts by Application|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Details|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where  is\_alert="yes" and !isNull(alert\_type)<br />\| timeslice 1h<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{alert\_type}}" = "\*", true, alert\_type matches "{{alert\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{CLOUD\_CONFIDENCE\_LEVEL}}" = "\*", true, ccl matches "{{CLOUD\_CONFIDENCE\_LEVEL}}")<br />\|count by \_timeslice, app<br />\| transpose row \_timeslice column app|
|Netskope/Security Alerts|Alerts by Type|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  "yes"<br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where !isNull(alert\_type) and is\_alert="yes"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by alert\_type<br />\| sort by \_count|
|Netskope/Security Alerts|Alerts Outlier Over Time|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Details|\_sourceCategory={{Logsdatasource}}  "yes"<br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| timeslice 1h<br />\| where is\_alert="yes" and !isNull(alert\_type)<br />\| fillmissing timeslice(1h)<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{alert\_type}}" = "\*", true, alert\_type matches "{{alert\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{CLOUD\_CONFIDENCE\_LEVEL}}" = "\*", true, ccl matches "{{CLOUD\_CONFIDENCE\_LEVEL}}")<br />\|count(alert\_id) as todays\_views by \_timeslice<br />\| compare with timeshift 1d as vs\_yesterday\| (todays\_views - todays\_views\_vs\_yesterday) as delta<br />\| outlier delta threshold = 2, window = 5, consecutive=2|
|Netskope/Security Alerts|Alerts Over Time|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  "yes"<br />\| json "srcip", "dstip","alert", "alert\_name", "alert\_type", "appcategory", "category", "app", "os", "user", "device", "acked" as src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, category, app, os, user, device, acked nodrop<br />\| where !isNull(alert\_type) and is\_alert="yes"<br />\| timeslice 1h<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by \_timeslice, alert\_type<br />\| transpose row \_timeslice column alert\_type|
|Netskope/Security Alerts|Anomalies by Activity|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by activity<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by Activity|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by activity<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by Alert Name|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level", "browser" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level, browser nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by alert\_name<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by Alert Name|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level", "browser" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level, browser nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by alert\_name<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by App|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by app<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by App|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by app<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by App Category|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by appcategory<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by App Category|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by appcategory<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by Risk Level|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by risk\_level<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies by Risk Level|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by risk\_level<br />\| sort by \_count|
|Netskope/Security Alerts|Anomalies Count|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count|
|Netskope/Security Alerts|Anomalies Count|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\| count|
|Netskope/Security Alerts|Anomalies Count|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count|
|Netskope/Security Alerts|Anomalies Over Time|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\| timeslice 1h<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by \_timeslice, risk\_level<br />\| fillmissing timeslice(1h)<br />\| transpose row \_timeslice column risk\_level|
|Netskope/Security Alerts|Anomalies Over Time|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\| timeslice 1h<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by \_timeslice, risk\_level<br />\| fillmissing timeslice(1h)<br />\| transpose row \_timeslice column risk\_level|
|Netskope/Security Alerts|App by Alerts - Distribution|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where !isNull(alert\_type) and is\_alert="yes"<br />\| count by app<br />\| sort by \_count|
|Netskope/Application Usage|Applications by Activity Distribution|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope "nspolicy" "no" <br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop\| where is\_alert="no" and isNull(alert\_type) and type="nspolicy"<br />\| if(isNull(activity), "Unknown", activity) as activity<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by activity, app<br />\| total \_count as activity\_count by app<br />\| transpose row app, activity\_count column activity<br />\| sort by activity\_count|
|Netskope/Application Usage|Applications by Activity Distribution|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  "nspolicy" "no" <br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| if(isNull(activity), "Unknown", activity) as activity<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by activity, app<br />\| total \_count as activity\_count by app<br />\| transpose row app, activity\_count column activity<br />\| sort by activity\_count|
|Netskope/Application Usage|Applications by Category|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "page\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, page\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isNull(alert) and type="page" and !isNull({{GROUP\_BY\_FIELD}})<br />\| if(isNull(appcategory), "unknown", appcategory) as appcategory<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count\_distinct({{GROUP\_BY\_FIELD}}) by appcategory<br />\| sort by \_count\_distinct|
|Netskope/Application Usage|Applications Distribution by Category|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "page" <br />\| json "\_id", "alert", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where isBlank(is\_alert) and type="connection"<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by app, appcategory\| count(app) by appcategory<br />\| sort by \_count|
|Netskope/Application Usage|Applications Distribution by CCL|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "page" <br />\| json "\_id", "alert", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where isBlank(is\_alert) and type="connection"<br />\| count by ccl<br />\| sort by \_count|
|Netskope/Application Usage|Applications Distribution by Users|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy" <br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by app, user<br />\| count by app<br />\| sort by \_count|
|Netskope/Application Usage|Applications Used Over Time|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "nspolicy" "no"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| timeslice 1h<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by \_timeslice, app<br />\| fillmissing timeslice(1h)<br />\| transpose row \_timeslice column app|
|Netskope/Security Alerts|Apps used by User after Credentials Breach|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials|\_sourceCategory={{Logsdatasource}}  ("Compromised Credential" OR "nspolicy")<br />\| join (json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "breach\_id", "breach\_date", "breach\_media\_references", "breach\_target\_references", "breach\_score", "email\_source", "matched\_username" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, breach\_id, breach\_date, breach\_media\_references, breach\_target\_references, breach\_score, email\_source, matched\_username nodrop<br />\| where alert\_type = "Compromised Credential"<br />\| where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{breach\_id}}" = "\*", true, breach\_id matches "{{breach\_id}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{breach\_date}}" = "\*", true, breach\_date matches "{{breach\_date}}")<br />\| max(breach\_date) as latest\_breach\_date by user) as UT,<br />(json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isNull(alert\_type) and type="nspolicy"<br />\| fields app, user, timestamp) as  AUT<br />on UT.user = AUT.user<br />\| toLong(UT\_latest\_breach\_date) as UT\_latest\_breach\_date<br />\| toLong(AUT\_timestamp) as AUT\_timestamp<br />\| where AUT\_timestamp \>= UT\_latest\_breach\_date<br />\| AUT\_app as app<br />\| UT\_user as user<br />\| UT\_latest\_breach\_date as latest\_breach\_date<br />\|count by user, latest\_breach\_date, app<br />\| formatDate(fromMillis(toLong(latest\_breach\_date\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as latest\_breach\_date<br />\| transpose row latest\_breach\_date, user column app<br />\| sort by latest\_breach\_date|
|Netskope/Security Alerts|Apps used on Infected Machines|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  ("Malware" OR "nspolicy")<br />\| join (json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object\_type", "object", "object\_count" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object\_type, object, object\_count nodrop<br />\| where alert\_type = "Malware"<br />\| max(timestamp) as latest\_alert\_date by src\_ip) as UT,<br />(json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| fields app, src\_ip, timestamp) as  AUT<br />on UT.src\_ip = AUT.src\_ip<br />\| where AUT\_timestamp \>= UT\_latest\_alert\_date<br />\| formatDate(fromMillis(toLong(UT\_latest\_alert\_date\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as latest\_alert\_date<br />\| UT\_src\_ip as src\_ip<br />\| AUT\_app as app<br />\|where if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by src\_ip, latest\_alert\_date, app<br />\| transpose row latest\_alert\_date, src\_ip column app|
|Netskope/Security Alerts|Breach Count|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials|\_sourceCategory={{Logsdatasource}}  "Compromised Credential"<br />\| json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "breach\_id", "breach\_date", "breach\_media\_references", "breach\_target\_references", "breach\_score", "email\_source", "matched\_username" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, breach\_id, breach\_date, breach\_media\_references, breach\_target\_references, breach\_score, email\_source, matched\_username nodrop<br />\| where alert\_type = "Compromised Credential"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{breach\_id}}" = "\*", true, breach\_id matches "{{breach\_id}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{breach\_date}}" = "\*", true, breach\_date matches "{{breach\_date}}")<br />\|count\_distinct (breach\_id)|
|Netskope/Security Alerts|Breach Count|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  "Compromised Credential"<br />\| json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "breach\_id", "breach\_date", "breach\_media\_references", "breach\_target\_references", "breach\_score", "email\_source", "matched\_username" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, breach\_id, breach\_date, breach\_media\_references, breach\_target\_references, breach\_score, email\_source, matched\_username nodrop<br />\| where alert\_type = "Compromised Credential"<br />\| count\_distinct (breach\_id)|
|Netskope/Application Usage|Browser Distribution by User|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user,browser <br />\| count(user) by browser <br />\| sort by \_count|
|Netskope/Security Alerts|Compromised Credentials by Source of Info|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials|\_sourceCategory={{Logsdatasource}}  "Compromised Credential"<br />\| json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "breach\_id", "breach\_date", "breach\_media\_references", "breach\_target\_references", "breach\_score", "email\_source", "matched\_username" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, breach\_id, breach\_date, breach\_media\_references, breach\_target\_references, breach\_score, email\_source, matched\_username nodrop<br />\| where alert\_type = "Compromised Credential"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{breach\_id}}" = "\*", true, breach\_id matches "{{breach\_id}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{breach\_date}}" = "\*", true, breach\_date matches "{{breach\_date}}")<br />\|count by alert\_name<br />\| sort by \_count|
|Netskope/Security Alerts|Compromised Credentials Users Count|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials|\_sourceCategory={{Logsdatasource}}  "Compromised Credential"<br />\| json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "breach\_id", "breach\_date", "breach\_media\_references", "breach\_target\_references", "breach\_score", "email\_source", "matched\_username" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, breach\_id, breach\_date, breach\_media\_references, breach\_target\_references, breach\_score, email\_source, matched\_username nodrop<br />\| where alert\_type = "Compromised Credential"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{breach\_id}}" = "\*", true, breach\_id matches "{{breach\_id}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{breach\_date}}" = "\*", true, breach\_date matches "{{breach\_date}}")<br />\|count by user<br />\| count|
|Netskope/Application Usage|Device Distribution by User|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by device, user<br />\| count by device<br />\| sort by device|
|Netskope/Security Alerts|DLP incidents by Activity|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by activity<br />\| sort by \_count|
|Netskope/Security Alerts|DLP Incidents by Browser and Browser Version|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy", "os\_version", "browser", "browser\_version" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy, os\_version, browser, browser\_version nodrop<br />\| if (isNull(browser\_version), "Unknown", browser\_version) as browser\_version<br />\| if (isNull(browser), "Unknown", browser) as browser<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by browser, browser\_version<br />\| sort by \_count|
|Netskope/Security Alerts|DLP incidents by Category|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by appcategory<br />\| sort by \_count|
|Netskope/Security Alerts|DLP incidents by File Type|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by file\_type<br />\| sort by \_count|
|Netskope/Security Alerts|DLP Incidents by OS and OS Version|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy", "os\_version" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy, os\_version nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by os, os\_version<br />\| sort by \_count|
|Netskope/Security Alerts|DLP Incidents by Policy Over Time|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\| timeslice 1h<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by \_timeslice, policy<br />\| transpose row \_timeslice column policy<br />\| fillmissing timeslice(1h)|
|Netskope/Security Alerts|DLP incidents by Severity|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by dlp\_rule\_severity<br />\| sort by \_count|
|Netskope/Security Alerts|DLP Incidents Count|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\| count|
|Netskope/Security Alerts|DLP Incidents Count|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count|
|Netskope/Application Usage|Failed Logins|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy" "Login Failed"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "traffic\_type" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, traffic\_type nodrop<br />\| where is\_alert="no" and type="nspolicy" and isBlank(alert\_type) and activity = "Login Failed"<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{traffic\_type}}" = "\*", true, traffic\_type matches "{{traffic\_type}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by app, user, src\_ip, dest\_ip|
|Netskope/Security Alerts|Malware by Activity|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by activity<br />\| sort by \_count|
|Netskope/Security Alerts|Malware by Category|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by appcategory<br />\| sort by \_count|
|Netskope/Security Alerts|Malware by Severity|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by malware\_severity<br />\| sort by \_count|
|Netskope/Security Alerts|Malware Incidents by App|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by app<br />\| sort by \_count|
|Netskope/Security Alerts|Malware Types affecting Unique UserIP|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object", "local\_md5", "userip" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object, local\_md5, userip nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}")<br />\|count by userip, malware\_type<br />\| count by malware\_type|
|Netskope/Application Usage|Network Usage Over Time|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "conn\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, conn\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isBlank(alert) and type="connection" and !isNull(app)<br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|sum(client\_bytes) as upload\_bytes, sum(server\_bytes) as download\_bytes by \_timeslice<br />\| upload\_bytes/1024/1024 as upload\_bytes\_sumMB<br />\| download\_bytes/1024/1024 as download\_bytes\_sumMB<br />\| upload\_bytes\_sumMB+download\_bytes\_sumMB as total\_bytes\_sumMB<br />\| fields -upload\_bytes, download\_bytes|
|Netskope/Application Usage|Network Usage Over Time|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "page\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, page\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isNull(alert) and type="page" and !isNull(app)<br />\| timeslice 1h<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|sum(client\_bytes) as upload\_bytes, sum(server\_bytes) as download\_bytes by \_timeslice<br />\| upload\_bytes/1024/1024 as upload\_bytes\_sumMB<br />\| download\_bytes/1024/1024 as download\_bytes\_sumMB<br />\| upload\_bytes\_sumMB+download\_bytes\_sumMB as total\_bytes\_sumMB<br />\| fields -upload\_bytes, download\_bytes<br />\|where if ("{{download\_bytes\_sumMB}}" = "\> -2147483648", true, download\_bytes\_sumMB {{download\_bytes\_sumMB}}) AND if ("{{total\_bytes\_sumMB}}" = "\> -2147483648", true, total\_bytes\_sumMB {{total\_bytes\_sumMB}}) AND if ("{{upload\_bytes\_sumMB}}" = "\> -2147483648", true, upload\_bytes\_sumMB {{upload\_bytes\_sumMB}})|
|Netskope/Security Alerts|Objects with High and Critical Severity|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy", "os\_version" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy, os\_version nodrop<br />\| where alert\_type = "DLP" and (dlp\_rule\_severity = "High" or dlp\_rule\_severity = "Critical")<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by object<br />\| top 10 object by \_count|
|Netskope/Application Usage|OS Distribution by User|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user,os <br />\| count(user) by os <br />\| sort by \_count|
|Netskope/Security Alerts|Recent Alerts|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where !isNull(alert\_type) and is\_alert="yes"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user, alert\_name, alert\_type, app, site, appcategory, acked, device, os, src\_ip, dest\_ip, timestamp<br />\| sort by timestamp<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| fields alert\_date, alert\_name, user, alert\_type, app, site, appcategory, acked, device, os, src\_ip, dest\_ip|
|Netskope/Security Alerts|Recent Alerts with Poor Cloud Confidence Level|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Details|\_sourceCategory={{Logsdatasource}}  "yes"<br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{alert\_type}}" = "\*", true, alert\_type matches "{{alert\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{CLOUD\_CONFIDENCE\_LEVEL}}" = "\*", true, ccl matches "{{CLOUD\_CONFIDENCE\_LEVEL}}")<br />\| count by user, alert\_name, alert\_type, app, site, appcategory, acked, device, os, src\_ip, dest\_ip, timestamp, ccl, activity, is\_alert<br />\| where is\_alert="yes" and !isNull(alert\_type)<br />\| sort by timestamp<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| fields alert\_date, alert\_name, alert\_type, user, activity, app, site, ccl, src\_ip, dest\_ip, appcategory, device, os|
|Netskope/Security Alerts|Recent Anomalies by High Risk Level|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "high" "anomaly" <br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level", "browser" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level, browser nodrop<br />\| where alert\_type = "anomaly" and risk\_level="high"<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by timestamp, user, risk\_level, os, browser, app, activity, from\_user, shared\_credential\_user, src\_ip, dest\_ip, alert\_name<br />\| sort by timestamp<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| fields alert\_date, user, risk\_level, os, browser, app, activity, from\_user, shared\_credential\_user, src\_ip, dest\_ip, alert\_name|
|Netskope/Security Alerts|Recent Anomalies by High Risk Level|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "high" "anomaly" <br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level", "browser" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level, browser nodrop<br />\| where alert\_type = "anomaly" and risk\_level="high"<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by timestamp, user, risk\_level, os, browser, app, activity, from\_user, shared\_credential\_user, src\_ip, dest\_ip, alert\_name<br />\| sort by timestamp<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| fields alert\_date, user, risk\_level, os, browser, app, activity, from\_user, shared\_credential\_user, src\_ip, dest\_ip, alert\_name|
|Netskope/Security Alerts|Recent Compromised Credentials|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials|\_sourceCategory={{Logsdatasource}}  "Compromised Credential"<br />\| json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "breach\_id", "breach\_date", "breach\_media\_references", "breach\_target\_references", "breach\_score", "email\_source", "matched\_username" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, breach\_id, breach\_date, breach\_media\_references, breach\_target\_references, breach\_score, email\_source, matched\_username nodrop<br />\| where alert\_type = "Compromised Credential"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{breach\_id}}" = "\*", true, breach\_id matches "{{breach\_id}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{breach\_date}}" = "\*", true, breach\_date matches "{{breach\_date}}")<br />\|count by timestamp, alert\_name, user, breach\_id, breach\_date, breach\_score, matched\_username, breach\_media\_references, breach\_target\_references<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| sort by timestamp<br />\| fields alert\_date, alert\_name, user, breach\_id, breach\_date, breach\_score, matched\_username, breach\_media\_references, breach\_target\_references|
|Netskope/Security Alerts|Recent DLP incidents with High and Critical Severity|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  "DLP" "High"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP" and (dlp\_rule\_severity ="High" or dlp\_rule\_severity !="Critical")<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by dlp\_rule, dlp\_rule\_severity, object, object\_type, dlp\_file, timestamp, activity, action<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| sort by timestamp<br />\| fields -timestamp|
|Netskope/Security Alerts|Recent Malwares|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object\_type", "object", "object\_count" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object\_type, object, object\_count nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by timestamp, malware\_name, malware\_severity, malware\_type, app, user, instance\_name, src\_ip, dst\_ip, os, browser, file\_type, object, object\_type, object\_count<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| sort by timestamp<br />\| fields alert\_date, malware\_name, malware\_severity, malware\_type, app, user, instance\_name, src\_ip, dst\_ip, os, browser, file\_type, object\_type, object|
|Netskope/Application Usage|Recent User Activity|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "traffic\_type" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, traffic\_type nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{traffic\_type}}" = "\*", true, traffic\_type matches "{{traffic\_type}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by timestamp, app, user, activity, object, object\_type, traffic\_type, site, os, browser, from\_user, to\_user<br />\| sort by timestamp<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| fields alert\_date, app, user, activity, from\_user, to\_user, object, object\_type, traffic\_type, site, os, browser|
|Netskope/Security Alerts|Suspicious Destination IP Locations|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Details|\_sourceCategory={{Logsdatasource}}  "yes"<br />\| json "\_id", "alert", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, alert, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where !isNull(alert\_type) and  !isBlank(dest\_ip) and !isPrivateIP(dest\_ip) and  alert="yes" <br />\| where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{alert\_type}}" = "\*", true, alert\_type matches "{{alert\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{CLOUD\_CONFIDENCE\_LEVEL}}" = "\*", true, ccl matches "{{CLOUD\_CONFIDENCE\_LEVEL}}")<br />\| count by dest\_ip, alert<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip=dest\_ip|
|Netskope/Security Alerts|Suspicious Source IP Locations|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Details|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "alert", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, alert, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where !isNull(alert\_type) and !isBlank(src\_ip) and  alert="yes"<br />\| where !isPrivateIP(src\_ip)<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{alert\_type}}" = "\*", true, alert\_type matches "{{alert\_type}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}") AND if ("{{CLOUD\_CONFIDENCE\_LEVEL}}" = "\*", true, ccl matches "{{CLOUD\_CONFIDENCE\_LEVEL}}")<br />\| count by src\_ip, alert<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip=src\_ip|
|Netskope/Application Usage|Top 10 Activity|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy" <br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| if(isNull(activity), "Unknown", activity) as activity<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by activity<br />\| top 10 activity by \_count|
|Netskope/Security Alerts|Top 10 Affected File Types|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by file\_type<br />\| top 10 file\_type by \_count|
|Netskope/Security Alerts|Top 10 Alerts|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where !isNull(alert\_type) and is\_alert="yes"<br />\| if (isNull(alert\_name), "Unknown", alert\_name) as alert\_name<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by alert\_name<br />\| sort by \_count|
|Netskope/Application Usage|Top 10 Applications by Avg Connection Duration|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "conn\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, conn\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isBlank(alert) and type="connection" and !isNull({{GROUP\_BY\_FIELD}})<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|avg(conn\_duration) as average\_conn\_duration by {{GROUP\_BY\_FIELD}}<br />\| top 10 {{GROUP\_BY\_FIELD}} by average\_conn\_duration|
|Netskope/Application Usage|Top 10 Applications by Avg Page Duration|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "page\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, page\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isNull(alert) and type="page" and !isNull({{GROUP\_BY\_FIELD}})<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|avg(page\_duration) as average\_page\_duration by {{GROUP\_BY\_FIELD}}<br />\| top 10 {{GROUP\_BY\_FIELD}} by average\_page\_duration|
|Netskope/Application Usage|Top 10 Applications by Total Alerts|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope ("DLP" OR "anomaly" OR "Malware" OR "Compromised Credentials") "yes" <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "category", "app", "site", "os", "user", "device", "acked" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, category, app, site, os, user, device, acked nodrop<br />\| where is\_alert="yes" and alert\_type in ("DLP", "anomaly", "Malware", "Compromised Credentials")<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by alert\_type, {{GROUP\_BY\_FIELD}}<br />\| total \_count as total\_alerts by {{GROUP\_BY\_FIELD}}<br />\| transpose row {{GROUP\_BY\_FIELD}}, total\_alerts column alert\_type<br />\| sort by total\_alerts<br />\| limit 10|
|Netskope/Application Usage|Top 10 Applications by Total Alerts|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  ("anomaly" OR "Compromised Credential" OR "policy" OR "Legal Hold" OR "malsite" OR "Malware" OR "DLP" OR "Security Assessment" OR "watchlist" OR "quarantine" OR "Remediation" OR "uba") "yes" <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "category", "app", "site", "os", "user", "device", "acked" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, category, app, site, os, user, device, acked nodrop<br />\| where is\_alert="yes" and alert\_type in ("anomaly", "Compromised Credential", "policy", "Legal Hold", "malsite", "Malware", "DLP", "Security Assessment", "watchlist", "quarantine", "Remediation", "uba")<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by alert\_type, {{GROUP\_BY\_FIELD}}<br />\| total \_count as total\_alerts by {{GROUP\_BY\_FIELD}}<br />\| transpose row {{GROUP\_BY\_FIELD}}, total\_alerts column alert\_type<br />\| sort by total\_alerts<br />\| limit 10|
|Netskope/Application Usage|Top 10 Applications by Total Bytes|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "conn\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, conn\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isBlank(alert) and type="connection" and !isNull({{GROUP\_BY\_FIELD}})<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by {{GROUP\_BY\_FIELD}}, appcategory, ccl, client\_bytes, server\_bytes, user, app\_session\_id, conn\_duration<br />\| sum(client\_bytes) as upload\_bytes, sum(server\_bytes) as download\_bytes, count(user) as user\_count, count(app\_session\_id) as session\_count, avg(conn\_duration) as avg\_conn\_duration by {{GROUP\_BY\_FIELD}}, appcategory, ccl<br />\| upload\_bytes/1024/1024 as upload\_bytes\_sumMB<br />\| download\_bytes/1024/1024 as download\_bytes\_sumMB<br />\| upload\_bytes\_sumMB+download\_bytes\_sumMB as total\_bytes\_sumMB<br />\| fields -upload\_bytes, download\_bytes<br />\| where  download\_bytes\_sumMB \>= {{download\_bytes\_sumMB}} AND total\_bytes\_sumMB \>= {{total\_bytes\_sumMB}} AND  upload\_bytes\_sumMB \>= {{upload\_bytes\_sumMB}}<br />\| sort by {{SORT\_BY}}<br />\| limit 10|
|Netskope/Application Usage|Top 10 Applications by Total Bytes|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "page\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, page\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isNull(alert) and type="page" and !isNull({{GROUP\_BY\_FIELD}})<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by {{GROUP\_BY\_FIELD}}, appcategory, ccl, client\_bytes, server\_bytes, user, app\_session\_id, page\_duration<br />\| sum(client\_bytes) as upload\_bytes, sum(server\_bytes) as download\_bytes, count(user) as user\_count, count(app\_session\_id) as session\_count, avg(page\_duration) as avg\_page\_duration by {{GROUP\_BY\_FIELD}}, appcategory, ccl<br />\| upload\_bytes/1024/1024 as upload\_bytes\_MB<br />\| download\_bytes/1024/1024 as download\_bytes\_sumMB<br />\| upload\_bytes\_MB+download\_bytes\_sumMB as total\_bytes\_sumMB<br />\| fields -upload\_bytes, download\_bytes<br />\| sort by {{SORT\_BY}}<br />\| limit 10<br />\|where if ("{{download\_bytes\_sumMB}}" = "\> -2147483648", true, download\_bytes\_sumMB {{download\_bytes\_sumMB}}) AND if ("{{total\_bytes\_sumMB}}" = "\> -2147483648", true, total\_bytes\_sumMB {{total\_bytes\_sumMB}})|
|Netskope/Security Alerts|Top 10 Breaches by breach score|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials|\_sourceCategory={{Logsdatasource}}  "Compromised Credential"<br />\| json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "breach\_id", "breach\_date", "breach\_media\_references", "breach\_target\_references", "breach\_score", "email\_source", "matched\_username" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, breach\_id, breach\_date, breach\_media\_references, breach\_target\_references, breach\_score, email\_source, matched\_username nodrop<br />\| where alert\_type = "Compromised Credential"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{breach\_id}}" = "\*", true, breach\_id matches "{{breach\_id}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{breach\_date}}" = "\*", true, breach\_date matches "{{breach\_date}}")<br />\|count by alert\_name, breach\_id, breach\_date, breach\_score<br />\| replace(breach\_score,"'","") as breach\_score<br />\| toLong(breach\_score) as breach\_score<br />\| top 10 breach\_date, alert\_name, breach\_id by breach\_score|
|Netskope/Application Usage|Top 10 Devices by User Access|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope "nspolicy" "no"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isNull(alert\_type) and type="nspolicy"<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by device<br />\| top 10 device by \_count|
|Netskope/Application Usage|Top 10 Devices by User Access|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  "nspolicy" "no"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by device<br />\| top 10 device by \_count|
|Netskope/Security Alerts|Top 10 DLP Policy Violations|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "userip", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, userip, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP" and !isNull(userip)<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by policy, userip<br />\| count by policy<br />\| sort by \_count<br />\| limit 10|
|Netskope/Security Alerts|Top 10 DLP Profile|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by dlp\_profile<br />\| top 10 dlp\_profile by \_count|
|Netskope/Security Alerts|Top 10 DLP Rules|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by dlp\_rule<br />\| top 10 dlp\_rule by \_count|
|Netskope/Security Alerts|Top 10 Malware by Malware Id, Malware Name|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object", "local\_md5" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object, local\_md5 nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}")<br />\|count by malware\_name, malware\_id<br />\| top 10 malware\_name, malware\_id by \_count|
|Netskope/Security Alerts|Top 10 Malware Type|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object", "local\_md5" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object, local\_md5 nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by malware\_type<br />\| top 10 malware\_type by \_count|
|Netskope/Security Alerts|Top 10 Source IPs|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object", "local\_md5" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object, local\_md5 nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp) and !isNull(src\_ip)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by src\_ip<br />\| top 10 src\_ip by \_count|
|Netskope/Security Alerts|Top 10 UserIP violating DLP Policy|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "userip", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, userip, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP" and !isNull(userip)<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by policy, userip<br />\| count by userip<br />\| sort by \_count<br />\| limit 10|
|Netskope/Application Usage|Top 10 Users|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by user<br />\| top 10 user by \_count|
|Netskope/Application Usage|Top 10 Users|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "conn\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, conn\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isBlank(alert) and type="connection" and !isNull(user)<br />\|where if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{traffic\_type}}" = "\*", true, traffic\_type matches "{{traffic\_type}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user, device, client\_bytes, server\_bytes, app, app\_session\_id, site<br />\| sum(client\_bytes) as upload\_bytes, sum(server\_bytes) as download\_bytes, count\_distinct(app) as app\_count, count\_distinct(app\_session\_id) as session\_count, count\_distinct(device) as device\_count, count\_distinct(site) as site\_count by user<br />\| upload\_bytes/1024/1024 as upload\_bytes\_sumMB<br />\| download\_bytes/1024/1024 as download\_bytes\_sumMB<br />\| upload\_bytes\_sumMB+download\_bytes\_sumMB as total\_bytes\_sumMB<br />\| fields -upload\_bytes, download\_bytes<br />\| sort by {{SORT\_USER\_BY}} <br />\| limit 10|
|Netskope/Security Alerts|Top 10 Users affected by Malwares|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object", "local\_md5" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object, local\_md5 nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user, malware\_severity<br />\| total \_count as total\_malwares by user<br />\| transpose row user, total\_malwares column malware\_severity<br />\| sort by total\_malwares<br />\| fields -total\_malwares<br />\| limit 10|
|Netskope/Security Alerts|Top 10 Users by Alerts|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity nodrop<br />\| where !isNull(alert\_type) and is\_alert="yes"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user<br />\| top 10 user by \_count|
|Netskope/Application Usage|Top 10 Users by Total Alerts|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "yes" ("DLP" OR "anomaly" OR "Malware" OR "Compromised Credential")<br />\| json "\_id", "alert", "alert\_type", "user" nodrop<br />\| where alert="yes" and alert\_type in ("anomaly", "Compromised Credential", "policy", "Legal Hold", "malsite", "Malware", "DLP", "Security Assessment", "watchlist", "quarantine", "Remediation", "uba")<br />\|where if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by alert\_type, user<br />\| total \_count as total\_alerts by user<br />\| transpose row user, total\_alerts column alert\_type<br />\| sort by total\_alerts<br />\| limit 10|
|Netskope/Application Usage|Top 20 Applications by Category|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "conn\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, conn\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isBlank(alert) and type="connection" and !isNull({{GROUP\_BY\_FIELD}})<br />\| if(isNull(appcategory), "unknown", appcategory) as appcategory<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count\_distinct({{GROUP\_BY\_FIELD}}) by appcategory<br />\| sort by \_count\_distinct \| limit 20|
|Netskope/Security Alerts|Top User by Anomaly Risk Level|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user, risk\_level<br />\| total \_count by user<br />\| transpose row user, \_total column risk\_level<br />\| sort by \_total<br />\| fields -\_total<br />\| limit 10|
|Netskope/Security Alerts|Top User by Anomaly Risk Level|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user, risk\_level<br />\| total \_count by user<br />\| transpose row user, \_total column risk\_level<br />\| sort by \_total<br />\| fields -\_total<br />\| limit 10|
|Netskope/Security Alerts|Top Users and Hostname by DLP Incidents Count|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy", "os\_version", "browser", "browser\_version", "hostname" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy, os\_version, browser, browser\_version, hostname nodrop<br />\| if (isNull(hostname), "Unknown", hostname) as hostname<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by user, hostname<br />\| top 10 user, hostname by \_count|
|Netskope/Application Usage|Total  Activities|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "app\_session\_id", "alert\_type" as event\_id, is\_alert, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, app\_session\_id, alert\_type nodrop<br />\| where is\_alert="no" and type="nspolicy" and isBlank(alert\_type)<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count(activity)|
|Netskope/Application Usage|Total  Sessions|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy" <br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "app\_session\_id" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, app\_session\_id  nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by app\_session\_id<br />\| count|
|Netskope/Application Usage|Total  Unique Applications|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "page" <br />\| json "\_id", "alert", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser" as alert\_id, is\_alert, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser nodrop<br />\| where isBlank(is\_alert) and type="connection"<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by app<br />\| count|
|Netskope/Application Usage|Total  Unique Sessions|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "app\_session\_id" as event\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, app\_session\_id nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by app\_session\_id<br />\| count|
|Netskope/Application Usage|Total  Unique Site|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "page"<br />\| json "\_id", "alert", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser" as alert\_id, is\_alert, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser nodrop<br />\| where isBlank(is\_alert) and type="connection"<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by site<br />\| count|
|Netskope/Application Usage|Total  Unique Users|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "app\_session\_id" as event\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, app\_session\_id nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user<br />\| count|
|Netskope/Security Alerts|Total Alerts|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "\_id", "srcip", "dstip", "alert", "alert\_name", "alert\_type", "appcategory", "category", "app", "os", "user", "device", "acked" as alert\_id, src\_ip, dest\_ip, is\_alert, alert\_name, alert\_type, appcategory, category, app, os, user, device, acked nodrop<br />\| where !isNull(alert\_type) and is\_alert="yes"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count(alert\_id)|
|Netskope/Security Alerts|Total App Affected|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by app<br />\| count|
|Netskope/Security Alerts|Total Files Infected|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by file\_id<br />\| count|
|Netskope/Security Alerts|Total Malwares Detected|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\| where alert\_type = "Malware"<br />\| count by malware\_id<br />\| count|
|Netskope/Security Alerts|Total Malwares Detected|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\| count by malware\_id<br />\| count|
|Netskope/Security Alerts|Total Policy Alerts|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Alert Overview|\_sourceCategory={{Logsdatasource}}  "policy"<br />\| json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "activity", "srcip", "dstip", "appcategory", "policy", "access\_method", "severity", "traffic\_type", "organization\_unit", "device", "os", "browser" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, activity, src\_ip, dst\_ip, appcategory, policy, access\_method, severity, traffic\_type, organization\_unit, device, os, browser nodrop<br />\| where alert\_type = "policy"<br />\| count by alert\_id<br />\| count|
|Netskope/Application Usage|Total Unique Apps|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "page\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, is\_alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, page\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isNull(is\_alert) and type="page" and !isNull({{GROUP\_BY\_FIELD}})<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by {{GROUP\_BY\_FIELD}}<br />\| count|
|Netskope/Application Usage|Total Unique Apps|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "conn\_duration", "hostname", "req\_cnt", "resp\_cnt" as event\_id, is\_alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, conn\_duration, hostname, req\_cnt, resp\_cnt nodrop<br />\| where isBlank(is\_alert) and type="connection" and !isNull({{GROUP\_BY\_FIELD}})<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by {{GROUP\_BY\_FIELD}}<br />\| count|
|Netskope/Application Usage|Total Unique Users|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy" <br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by user<br />\| count|
|Netskope/Security Alerts|Total Users Affected|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user<br />\| count|
|Netskope/Security Alerts|User Activities after Credentials Breach|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Compromised Credentials|\_sourceCategory={{Logsdatasource}}  ("Compromised Credential" OR "nspolicy")<br />\| join (json "\_id", "alert\_name", "alert\_type", "user", "acked", "timestamp", "ccl", "breach\_id", "breach\_date", "breach\_media\_references", "breach\_target\_references", "breach\_score", "email\_source", "matched\_username" as alert\_id, alert\_name, alert\_type, user, acked, timestamp, ccl, breach\_id, breach\_date, breach\_media\_references, breach\_target\_references, breach\_score, email\_source, matched\_username nodrop<br />\| where alert\_type = "Compromised Credential"<br />\| where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{breach\_id}}" = "\*", true, breach\_id matches "{{breach\_id}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{breach\_date}}" = "\*", true, breach\_date matches "{{breach\_date}}")<br />\| max(breach\_date) as latest\_breach\_date by user) as UT,<br />(json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isNull(alert\_type) and type="nspolicy"<br />\| fields activity, user, app, timestamp) as  AUT<br />on UT.user = AUT.user<br />\| toLong(UT\_latest\_breach\_date) as UT\_latest\_breach\_date<br />\| toLong(AUT\_timestamp) as AUT\_timestamp<br />\| where AUT\_timestamp \>= UT\_latest\_breach\_date<br />\|count by UT\_user, UT\_latest\_breach\_date, AUT\_activity, AUT\_app<br />\| UT\_user as user<br />\| formatDate(fromMillis(toLong(UT\_latest\_breach\_date\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as latest\_breach\_date<br />\| AUT\_activity as activity<br />\| AUT\_app as app<br />\| fields latest\_breach\_date, user, activity, app|
|Netskope/Application Usage|User Activity Distribution|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| if(isNull(activity), "Unknown", activity) as activity<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by activity<br />\| sort by \_count|
|Netskope/Security Alerts|User Activity on Infected machines|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  ("Malware" OR "nspolicy")<br />\| join (json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object\_type", "object", "object\_count" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object\_type, object, object\_count nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| max(timestamp) as latest\_alert\_date by src\_ip) as UT,<br />(json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| fields src\_ip, user, activity, timestamp) as  AUT<br />on UT.src\_ip = AUT.src\_ip<br />\| where AUT\_timestamp \>= UT\_latest\_alert\_date<br />\| UT\_src\_ip as src\_ip<br />\| formatDate(fromMillis(toLong(UT\_latest\_alert\_date\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as latest\_alert\_date<br />\| AUT\_user as user<br />\| AUT\_activity as activity<br />\|where if ("{{user}}" = "\*", true, user matches "{{user}}")<br />\|count by latest\_alert\_date,src\_ip,user,activity|
|Netskope/Application Usage|User Agent Distribution|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Detail|\_sourceCategory={{Logsdatasource}}  "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "conn\_duration", "hostname", "req\_cnt", "resp\_cnt", "useragent" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, conn\_duration, hostname, req\_cnt, resp\_cnt, useragent nodrop<br />\| where isBlank(alert) and type="connection"<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by useragent|
|Netskope/Application Usage|User Agent Distribution|Logs|Netskope/Application Usage/Netskope - Application Detail - New|\_sourceCategory = Labs/Netskope "page"<br />\| json "\_id", "alert", "app\_session\_id", "browser", "bypass\_traffic", "client\_bytes", "appcategory", "app", "os", "user", "device", "domain", "http\_transaction\_count","num\_bytes","server\_bytes", "site", "timestamp", "ccl", "traffic\_type", "type", "url", "page", "page\_duration", "hostname", "req\_cnt", "resp\_cnt", "useragent" as event\_id, alert, app\_session\_id, browser, bypass\_traffic, client\_bytes, appcategory, app, os, user, device, domain, http\_transaction\_count,num\_bytes,server\_bytes, site, timestamp, ccl, traffic\_type, type, url, page, page\_duration, hostname, req\_cnt, resp\_cnt, useragent nodrop<br />\| where isNull(alert) and type="page"<br />\|where if ("{{browser}}" = "\*", true, browser matches "{{browser}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by useragent|
|Netskope/Application Usage|User Locations by DestinationIP|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "app\_session\_id" as event\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, app\_session\_id nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| where !isPrivateIP(dest\_ip)<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count({{Geolookup}}) by dest\_ip <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = dest\_ip|
|Netskope/Application Usage|User Locations by SourceIP|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Overview|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type","type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user" as alert\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy" and isValidIP(src\_ip)<br />\| where !isPrivateIP(src\_ip)<br />\|where if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{device}}" = "\*", true, device matches "{{device}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by src\_ip <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip|
|Netskope/Application Usage|User Locations by SourceIP|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "app\_session\_id" as event\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, app\_session\_id nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| where !isPrivateIP(src\_ip)<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count({{Geolookup}}) by src\_ip <br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = src\_ip|
|Netskope/Security Alerts|UserIP affected by Unique Malware Name|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Malware|\_sourceCategory={{Logsdatasource}}  "Malware"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "action", "browser", "file\_id", "file\_type", "instance\_name", "malware\_id", "malware\_name", "malware\_severity", "malware\_type", "object", "local\_md5", "userip" as alert\_id, src\_ip, dst\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, action, browser, file\_id, file\_type, instance\_name, malware\_id, malware\_name, malware\_severity, malware\_type, object, local\_md5, userip nodrop<br />\| where alert\_type = "Malware" and !isBlank(timestamp)<br />\| formatDate(fromMillis(toLong(timestamp\*1000)),"MM-dd-yyyy HH:mm:ss:SSS") as alert\_date<br />\|where if ("{{malware\_severity}}" = "\*", true, malware\_severity matches "{{malware\_severity}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{malware\_type}}" = "\*", true, malware\_type matches "{{malware\_type}}") AND if ("{{malware\_name}}" = "\*", true, malware\_name matches "{{malware\_name}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{malware\_id}}" = "\*", true, malware\_id matches "{{malware\_id}}")<br />\|count by userip, malware\_name<br />\| count by userip<br />\| sort by \_count|
|Netskope/Security Alerts|Users Affected|Logs|Netskope/Security Alerts/Netskope - Anomalies - New|\_sourceCategory = Labs/Netskope "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user<br />\| count|
|Netskope/Security Alerts|Users Affected|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Anomalies|\_sourceCategory={{Logsdatasource}}  "anomaly"<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "from\_user", "shared\_credential\_user", "risk\_level" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, from\_user, shared\_credential\_user, risk\_level nodrop<br />\| where alert\_type = "anomaly"<br />\|where if ("{{alert\_name}}" = "\*", true, alert\_name matches "{{alert\_name}}") AND if ("{{os}}" = "\*", true, os matches "{{os}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{alert\_id}}" = "\*", true, alert\_id matches "{{alert\_id}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by user<br />\| count|
|Netskope/Security Alerts|Users Affected|Logs|Installed Apps/Netskope/Security Alerts/Netskope - Data Loss Prevention|\_sourceCategory={{Logsdatasource}}  DLP<br />\| json "\_id", "srcip", "dstip", "alert\_name", "alert\_type", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "dlp\_incident\_id", "dlp\_file","dlp\_rule", "dlp\_profile", "dlp\_rule\_severity", "file\_type", "object", "url", "object\_type", "policy" as alert\_id, src\_ip, dest\_ip, alert\_name, alert\_type, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, dlp\_incident\_id, dlp\_file,dlp\_rule, dlp\_profile, dlp\_rule\_severity, file\_type, object, url, object\_type, policy nodrop<br />\| where alert\_type = "DLP"<br />\|where if ("{{dlp\_profile}}" = "\*", true, dlp\_profile matches "{{dlp\_profile}}") AND if ("{{dlp\_file}}" = "\*", true, dlp\_file matches "{{dlp\_file}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{dlp\_rule\_severity}}" = "\*", true, dlp\_rule\_severity matches "{{dlp\_rule\_severity}}") AND if ("{{dlp\_incident\_id}}" = "\*", true, dlp\_incident\_id matches "{{dlp\_incident\_id}}") AND if ("{{file\_type}}" = "\*", true, file\_type matches "{{file\_type}}") AND if ("{{policy}}" = "\*", true, policy matches "{{policy}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{dlp\_rule}}" = "\*", true, dlp\_rule matches "{{dlp\_rule}}")<br />\|count by user<br />\| count|
|Netskope/Application Usage|Users by Country|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "app\_session\_id", "src\_country", "traffic\_type" as event\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, app\_session\_id, src\_country, traffic\_type nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| if (isNull(src\_country), "Unknown", src\_country) as src\_country<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{traffic\_type}}" = "\*", true, traffic\_type matches "{{traffic\_type}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by src\_country<br />\| sort by \_count|
|Netskope/Application Usage|Users by Traffic Type|Logs|Installed Apps/Netskope/Application Usage/Netskope - Application Users|\_sourceCategory={{Logsdatasource}}  "no" "nspolicy"<br />\| json "\_id", "alert", "alert\_type", "type", "srcip", "dstip", "appcategory", "app", "os", "user", "device", "acked", "site", "timestamp", "ccl", "activity", "browser", "object", "object\_type", "from\_user", "to\_user", "app\_session\_id", "src\_country", "traffic\_type" as event\_id, is\_alert, alert\_type, type, src\_ip, dest\_ip, appcategory, app, os, user, device, acked, site, timestamp, ccl, activity, browser, object, object\_type, from\_user, to\_user, app\_session\_id, src\_country, traffic\_type nodrop<br />\| where is\_alert="no" and isBlank(alert\_type) and type="nspolicy"<br />\| if (isNull(traffic\_type), "Unknown", traffic\_type) as traffic\_type<br />\|where if ("{{to\_user}}" = "\*", true, to\_user matches "{{to\_user}}") AND if ("{{activity}}" = "\*", true, activity matches "{{activity}}") AND if ("{{ccl}}" = "\*", true, ccl matches "{{ccl}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{user}}" = "\*", true, user matches "{{user}}") AND if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}") AND if ("{{traffic\_type}}" = "\*", true, traffic\_type matches "{{traffic\_type}}") AND if ("{{object}}" = "\*", true, object matches "{{object}}") AND if ("{{appcategory}}" = "\*", true, appcategory matches "{{appcategory}}") AND if ("{{from\_user}}" = "\*", true, from\_user matches "{{from\_user}}") AND if ("{{site}}" = "\*", true, site matches "{{site}}") AND if ("{{app}}" = "\*", true, app matches "{{app}}")<br />\|count by traffic\_type<br />\| sort by \_count|

