# PCI Compliance For Palo Alto Networks

## Searches

### Log Searches

- **Allowed Network Activity by Direction**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Allowed Network Activity by Transport and Internet Layer Protocol**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Allowed Traffic Over Time**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Denied Traffic Over Time**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Inbound Network Activity**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New 
- **Network Traffic Over Time**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Outbound Network Activity**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New 
- **Silently Dropped Traffic Over Time**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Top 10 Host - Receiving Inbound Traffic**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New 
- **Top 10 Host - Sending Outbound Traffic**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New 
- **Top Destination IP**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Top Destination IP**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Top Source IP**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Top Source IP**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New 
- **Traffic to Cardholder Environment**: from Dashboard: PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|PCI Compliance For Palo Alto Networks|Allowed Network Activity by Direction|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="allow"<br />\| where ((compareCIDRPrefix("172.16.0.0", src\_ip, toInt(12)) or compareCIDRPrefix("192.168.0.0", src\_ip, toInt(16)) or compareCIDRPrefix("10.0.0.0", src\_ip, toInt(8)) and (!compareCIDRPrefix("172.16.0.0", dest\_ip, toInt(12)) and !compareCIDRPrefix("192.168.0.0", dest\_ip, toInt(16)) and !compareCIDRPrefix("10.0.0.0", dest\_ip, toInt(8)))) or <br />(compareCIDRPrefix("172.16.0.0", dest\_ip, toInt(12)) or compareCIDRPrefix("192.168.0.0", dest\_ip, toInt(16)) or compareCIDRPrefix("10.0.0.0", dest\_ip, toInt(8)) and (!compareCIDRPrefix("172.16.0.0", src\_ip, toInt(12)) and !compareCIDRPrefix("192.168.0.0", src\_ip, toInt(16)) and !compareCIDRPrefix("10.0.0.0", src\_ip, toInt(8)))))<br /><br />\| if (compareCIDRPrefix("172.16.0.0", src\_ip, toInt(12)) or compareCIDRPrefix("192.168.0.0", src\_ip, toInt(16)) or compareCIDRPrefix("10.0.0.0", src\_ip, toInt(8)), "outbound","inbound") as direction<br />\| timeslice 5m<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by \_timeslice, direction \| transpose row \_timeslice column direction|
|PCI Compliance For Palo Alto Networks|Allowed Network Activity by Transport and Internet Layer Protocol|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="allow"<br />\| timeslice 5m<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by \_timeslice, protocol<br />\| transpose row \_timeslice column protocol|
|PCI Compliance For Palo Alto Networks|Allowed Traffic Over Time|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="allow"<br />\| timeslice 5m<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by \_timeslice|
|PCI Compliance For Palo Alto Networks|Denied Traffic Over Time|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC deny<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="deny"<br />\| timeslice 5m<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by \_timeslice|
|PCI Compliance For Palo Alto Networks|Inbound Network Activity|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action = "allow"<br />\| where (compareCIDRPrefix("172.16.0.0", dest\_ip, toInt(12)) or compareCIDRPrefix("192.168.0.0", dest\_ip, toInt(16)) or compareCIDRPrefix("10.0.0.0", dest\_ip, toInt(8))) and (!compareCIDRPrefix("172.16.0.0", src\_ip, toInt(12)) and !compareCIDRPrefix("192.168.0.0", src\_ip, toInt(16)) and !compareCIDRPrefix("10.0.0.0", src\_ip, toInt(8)))<br />\| dest\_ip as %"Destination Host"<br />\|where if ("{{action}}" = "\*", true, action matches "{{action}}")<br />\|count by src\_ip, %"Destination Host" \| transpose row %"Destination Host" column src\_ip \| sort by %"Destination Host"|
|PCI Compliance For Palo Alto Networks|Network Traffic Over Time|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC <br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC"<br />\| timeslice 5m<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by \_timeslice, action<br />\| transpose row \_timeslice column action|
|PCI Compliance For Palo Alto Networks|Outbound Network Activity|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action = "allow"<br />\| where (compareCIDRPrefix("172.16.0.0", src\_ip, toInt(12)) or compareCIDRPrefix("192.168.0.0", src\_ip, toInt(16)) or compareCIDRPrefix("10.0.0.0", src\_ip, toInt(8))) and (!compareCIDRPrefix("172.16.0.0", dest\_ip, toInt(12)) and !compareCIDRPrefix("192.168.0.0", dest\_ip, toInt(16)) and !compareCIDRPrefix("10.0.0.0", dest\_ip, toInt(8)))<br />\| src\_ip as %"Source Host"<br />\|where if ("{{action}}" = "\*", true, action matches "{{action}}")<br />\|count by %"Source Host", dest\_ip \| transpose row %"Source Host" column dest\_ip \| sort by %"Source Host"|
|PCI Compliance For Palo Alto Networks|Silently Dropped Traffic Over Time|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC (drop or icmp)<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action matches "drop\*"<br />\| timeslice 5m<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count by \_timeslice|
|PCI Compliance For Palo Alto Networks|Top 10 Host - Receiving Inbound Traffic|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action = "allow"<br />\| where (compareCIDRPrefix("172.16.0.0", dest\_ip, toInt(12)) or compareCIDRPrefix("192.168.0.0", dest\_ip, toInt(16)) or compareCIDRPrefix("10.0.0.0", dest\_ip, toInt(8))) and (!compareCIDRPrefix("172.16.0.0", src\_ip, toInt(12)) and !compareCIDRPrefix("192.168.0.0", src\_ip, toInt(16)) and !compareCIDRPrefix("10.0.0.0", src\_ip, toInt(8)))<br />\| dest\_ip as %"Destination Host"<br />\|where if ("{{action}}" = "\*", true, action matches "{{action}}")<br />\|sum(bytes) as bytesReceived by %"Destination Host" \| bytesReceived/1024/1024 as megabytes\_Received \| fields -bytesReceived \| sort by megabytes\_Received \| Limit 10|
|PCI Compliance For Palo Alto Networks|Top 10 Host - Sending Outbound Traffic|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action = "allow"<br />\| where (compareCIDRPrefix("172.16.0.0", src\_ip, toInt(12)) or compareCIDRPrefix("192.168.0.0", src\_ip, toInt(16)) or compareCIDRPrefix("10.0.0.0", src\_ip, toInt(8))) and (!compareCIDRPrefix("172.16.0.0", dest\_ip, toInt(12)) and !compareCIDRPrefix("192.168.0.0", dest\_ip, toInt(16)) and !compareCIDRPrefix("10.0.0.0", dest\_ip, toInt(8)))<br />\| src\_ip as %"Source Host"<br />\|where if ("{{action}}" = "\*", true, action matches "{{action}}")<br />\|sum (bytes\_sent) as bytesSent by %"Source Host" \| bytessent/1024/1024 as megabytes\_Sent \| fields -bytessent \| sort by megabytes\_Sent \| Limit 10|
|PCI Compliance For Palo Alto Networks|Top Destination IP|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC deny<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="deny"<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count as eventCount by dest\_ip \| dest\_ip as %"Destination IP"<br />\| top 10 %"Destination IP" by eventCount|
|PCI Compliance For Palo Alto Networks|Top Destination IP|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="allow"<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count as eventCount by dest\_ip \| dest\_ip as %"Destination IP"<br />\| top 10 %"Destination IP" by eventCount|
|PCI Compliance For Palo Alto Networks|Top Source IP|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC deny<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="deny"<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count as eventCount by src\_ip \| src\_ip as %"Source IP"<br />\| top 10 %"Source IP" by eventCount|
|PCI Compliance For Palo Alto Networks|Top Source IP|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Accepted and Rejected Traffic - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="allow"<br />\|where if ("{{dest\_ip}}" = "\*", true, dest\_ip matches "{{dest\_ip}}")<br />\|count as eventCount by src\_ip \| src\_ip as %"Source IP"<br />\| top 10 %"Source IP" by eventCount|
|PCI Compliance For Palo Alto Networks|Traffic to Cardholder Environment|Logs|PCI Compliance For Palo Alto Networks/PCI Compliance For Palo Alto Networks - PCI Req 01 - Traffic Direction Monitoring - New|\_sourceCategory = \*PaloAltoNetworks\* TRAFFIC allow (3306 or 5439 or 5432 or 1433 or 2638 or 5984 or 6262 or 1521) // 3306 - MySQL/RDS, 5439 - Amazon Redshift, 5432 - PostgreSQL, 1433 - MS SQL Server, 2638 - SQLAnywhere, 5984 - couchdb. 6262 - sybase, 1521 oracle Other port used can be added here<br />\| csv \_raw extract 1 as f1, 2 as Receive\_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src\_ip, 9 as dest\_ip, 10 as NAT\_src\_ip, 11 as NAT\_dest\_ip, 12 as ruleName, 13 as src\_user, 14 as dest\_user, 15 as app, 16 as vsys, 17 as src\_zone, 18 as dest\_zone, 19 as inbound\_interface, 20 as outbound\_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src\_port, 26 as dest\_port, 27 as NAT\_src\_port, 28 as NAT\_dest\_port, 29 as flags, 30 as protocol, 31 as action,32 as bytes, 33 as bytes\_sent, 34 as bytes\_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src\_Country, 43 as dest\_country, 44 as pkts\_sent, 45 as pkts\_received, 46 as session\_end\_reason, 47 as Device\_Group\_Hierarchy , 48 as vsys\_Name, 49 as DeviceName, 50 as action\_source, 51 as Source\_VM\_UUID, 52 as Destination\_VM\_UUID, 53 as Tunnel\_ID\_IMSI, 54 as Monitor\_Tag\_IMEI, 55 as Parent\_Session\_ID, 56 as parent\_start\_time, 57 as Tunnel, 58 as SCTP\_Association\_ID, 59 as SCTP\_Chunks, 60 as SCTP\_Chunks\_Sent, 61 as SCTP\_Chunks\_Received<br />\| where type = "TRAFFIC" and action="allow" and dest\_port in ("3306", "5439", "5432", "1433", "2638", "5984", "6262", "1521")<br />\| where (compareCIDRPrefix("172.16.0.0", dest\_ip, toInt(12)) or compareCIDRPrefix("192.168.0.0", dest\_ip, toInt(16)) or compareCIDRPrefix("10.0.0.0", dest\_ip, toInt(8)) and (dest\_port in ("3306", "5439", "5432", "1433", "2638", "5984", "6262", "1521"))) <br />\| where (!compareCIDRPrefix("172.16.0.0", src\_ip, toInt(12)) and !compareCIDRPrefix("192.168.0.0", src\_ip, toInt(16)) and !compareCIDRPrefix("10.0.0.0", src\_ip, toInt(8)))<br />\| timeslice 1s<br />\|where if ("{{action}}" = "\*", true, action matches "{{action}}")<br />\|count as eventCount by \_timeslice, dest\_ip, dest\_port, src\_ip, inbound\_interface, outbound\_interface<br />\| sort by \_timeslice, dest\_ip asc, dest\_port asc, src\_ip asc, eventCount<br />\| "Direct external traffic to secure port" as message \| "Critical" as Severity|

