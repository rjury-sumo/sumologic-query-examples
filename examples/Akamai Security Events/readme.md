# Akamai Security Events
## Sumo Logic App For: Akamai Security Events
Akamai Security Events App  allows you to visualize security events generated on the Akamai platform. The preconfigured dashboards provide insights into attack data, sources of attack , attack queries, geo location of attack source, context on attackâ€™s HTTP request, and rules triggered by the attack.
Docs Link: [Akamai Security Events](https://help.sumologic.com/?cid=210823)

## Searches

### Log Searches

- **Attack Information**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attack Information**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Client's Host**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Client's Host**: from Dashboard: Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Method**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Method**: from Dashboard: Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Policy ID**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Policy ID**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Port**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Port**: from Dashboard: Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Protocol**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Protocol**: from Dashboard: Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Request Query**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Request Query**: from Dashboard: Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by Rule Action**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Rule Action**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Rule Data**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Rule Data**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Rule Message**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Rule Message**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Rule Tag**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by Rule Tag**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Attacks by URL**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Attacks by URL**: from Dashboard: Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Geo Locations of Attacks**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Geo Locations of Attacks**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events  - Overview 
- **Geo Locations of Attacks**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Geo Locations of Attacks**: from Dashboard: Akamai Security Events/Akamai Security Events  - Overview 
- **HTTP Response Codes**: from Dashboard: Akamai Security Events/Akamai Security Events  - Overview 
- **HTTP Response Codes**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events  - Overview 
- **Last 20 Attacks**: from Dashboard: Akamai Security Events/Akamai Security Events  - Overview 
- **Last 20 Attacks**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events  - Overview 
- **Rules Triggered Over Time**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events  - Overview 
- **Rules Triggered Over Time**: from Dashboard: Akamai Security Events/Akamai Security Events  - Overview 
- **Threat by Actor**: from Dashboard: Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threat by Actor**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threat by Geo Location**: from Dashboard: Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threat by Geo Location**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threat Count**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threat Count**: from Dashboard: Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threat Table**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threat Table**: from Dashboard: Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threats by Malicious Confidence**: from Dashboard: Akamai Security Events/Akamai Security Events - Threat Intel 
- **Threats by Malicious Confidence**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel 
- **Top 15  Source Cities of Attack**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Top 15  Source Cities of Attack**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Top 15  Source Countries of Attack**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Top 15  Source Countries of Attack**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Top 15 Client's Hosts**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events  - Overview 
- **Top 15 Client's Hosts**: from Dashboard: Akamai Security Events/Akamai Security Events  - Overview 
- **Top 15 IPs of Attack Source**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data 
- **Top 15 IPs of Attack Source**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events  - Overview 
- **Top 15 IPs of Attack Source**: from Dashboard: Akamai Security Events/Akamai Security Events -  Attack Data 
- **Top 15 IPs of Attack Source**: from Dashboard: Akamai Security Events/Akamai Security Events  - Overview 
- **Total Bytes Served by Request ID**: from Dashboard: Akamai Security Events/Akamai Security Events -  HTTP Data 
- **Total Bytes Served by Request ID**: from Dashboard: Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Akamai Security Events|Attack Information|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\| json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by attack\_date, client\_ip, city, country, rule\_action, rule, rule\_message, rule\_selector, rule\_version, config\_id, policy\_id,http\_response|
|Akamai Security Events|Attack Information|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\| json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by attack\_date, client\_ip, city, country, rule\_action, rule, rule\_message, rule\_selector, rule\_version, config\_id, policy\_id,http\_response|
|Akamai Security Events|Attacks by Client's Host|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory={{\_sourceCategory}}<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by host|
|Akamai Security Events|Attacks by Client's Host|Logs|Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory = Labs/akamai-security-events<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by host|
|Akamai Security Events|Attacks by Method|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory={{\_sourceCategory}}<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by method|
|Akamai Security Events|Attacks by Method|Logs|Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory = Labs/akamai-security-events<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by method|
|Akamai Security Events|Attacks by Policy ID|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by policy\_id<br />\|sort by \_count|
|Akamai Security Events|Attacks by Policy ID|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}}<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by policy\_id<br />\|sort by \_count|
|Akamai Security Events|Attacks by Port|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory={{\_sourceCategory}}<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by port|
|Akamai Security Events|Attacks by Port|Logs|Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory = Labs/akamai-security-events<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by port|
|Akamai Security Events|Attacks by Protocol|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory={{\_sourceCategory}}<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by protocol|
|Akamai Security Events|Attacks by Protocol|Logs|Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory = Labs/akamai-security-events<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by protocol|
|Akamai Security Events|Attacks by Request Query|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory={{\_sourceCategory}}<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by query|
|Akamai Security Events|Attacks by Request Query|Logs|Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory = Labs/akamai-security-events<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by query|
|Akamai Security Events|Attacks by Rule Action|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by rule\_action<br />|
|Akamai Security Events|Attacks by Rule Action|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by rule\_action<br />|
|Akamai Security Events|Attacks by Rule Data|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by rule\_data<br />\| sort by \_count|
|Akamai Security Events|Attacks by Rule Data|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by rule\_data<br />\| sort by \_count|
|Akamai Security Events|Attacks by Rule Message|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\| where  !isEmpty(rule\_message)<br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by rule\_message<br />\|sort by \_count|
|Akamai Security Events|Attacks by Rule Message|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\| where  !isEmpty(rule\_message)<br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by rule\_message<br />\|sort by \_count|
|Akamai Security Events|Attacks by Rule Tag|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by rule\_tag<br />\|sort by \_count|
|Akamai Security Events|Attacks by Rule Tag|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by rule\_tag<br />\|sort by \_count|
|Akamai Security Events|Attacks by URL|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory={{\_sourceCategory}}<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by url|
|Akamai Security Events|Attacks by URL|Logs|Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory = Labs/akamai-security-events<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| count by url|
|Akamai Security Events|Geo Locations of Attacks|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP" as client\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code <br />\| sort \_count<br />|
|Akamai Security Events|Geo Locations of Attacks|Logs|Installed Apps/Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP" as client\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code <br />\| sort \_count<br />|
|Akamai Security Events|Geo Locations of Attacks|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP" as client\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code <br />\| sort \_count<br />|
|Akamai Security Events|Geo Locations of Attacks|Logs|Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP" as client\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code <br />\| sort \_count<br />|
|Akamai Security Events|HTTP Response Codes|Logs|Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by http\_response<br />\| sort -\_count |
|Akamai Security Events|HTTP Response Codes|Logs|Installed Apps/Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by http\_response<br />\| sort -\_count |
|Akamai Security Events|Last 20 Attacks|Logs|Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" , "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\| json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\|count by attack\_date, client\_ip, city, country, rule\_action, rule, rule\_message, rule\_selector, rule\_data, method, host, port, path, query,config\_id, policy\_id,http\_response, bytes<br />\| sort by attack\_date<br />\| limit 20|
|Akamai Security Events|Last 20 Attacks|Logs|Installed Apps/Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" , "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\| json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\|count by attack\_date, client\_ip, city, country, rule\_action, rule, rule\_message, rule\_selector, rule\_data, method, host, port, path, query,config\_id, policy\_id,http\_response, bytes<br />\| sort by attack\_date<br />\| limit 20|
|Akamai Security Events|Rules Triggered Over Time|Logs|Installed Apps/Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| timeslice 1d<br />\| count by \_timeslice, rule\_action<br />\| transpose row \_timeslice column rule\_action|
|Akamai Security Events|Rules Triggered Over Time|Logs|Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| timeslice 1d<br />\| count by \_timeslice, rule\_action<br />\| transpose row \_timeslice column rule\_action|
|Akamai Security Events|Threat by Actor|Logs|Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count as threat\_count by Actor|
|Akamai Security Events|Threat by Actor|Logs|Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count as threat\_count by Actor|
|Akamai Security Events|Threat by Geo Location|Logs|Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code, area\_code, metro\_code from geo://default on ip = client\_ip<br />\|where malicious\_confidence matches "high"<br />\|count by latitude, longitude, label\_name<br />|
|Akamai Security Events|Threat by Geo Location|Logs|Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\|where malicious\_confidence matches "high"<br />\|count by latitude, longitude, label\_name<br />|
|Akamai Security Events|Threat Count|Logs|Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count |
|Akamai Security Events|Threat Count|Logs|Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count |
|Akamai Security Events|Threat Table|Logs|Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by client\_ip, rule\_action, rule, rule\_data , host, rule\_message,rule\_selector, rule\_tag, malicious\_confidence, Actor,label\_name<br />\| sort -\_count|
|Akamai Security Events|Threat Table|Logs|Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by client\_ip, rule\_action, rule, rule\_data , host, rule\_message,rule\_selector, rule\_tag, malicious\_confidence, Actor,label\_name<br />\| sort -\_count|
|Akamai Security Events|Threats by Malicious Confidence|Logs|Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by malicious\_confidence|
|Akamai Security Events|Threats by Malicious Confidence|Logs|Installed Apps/Akamai Security Events/Akamai Security Events - Threat Intel|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| where !(label\_name matches "\*TorProxy\*")<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by malicious\_confidence|
|Akamai Security Events|Top 15  Source Cities of Attack|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by city<br />\| limit 15|
|Akamai Security Events|Top 15  Source Cities of Attack|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by city<br />\| limit 15|
|Akamai Security Events|Top 15  Source Countries of Attack|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by country<br />\| limit 15|
|Akamai Security Events|Top 15  Source Countries of Attack|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\|count by country<br />\| limit 15|
|Akamai Security Events|Top 15 Client's Hosts|Logs|Installed Apps/Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by host<br />\| sort -\_count <br />\| limit 15<br />|
|Akamai Security Events|Top 15 Client's Hosts|Logs|Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by host<br />\| sort -\_count <br />\| limit 15<br />|
|Akamai Security Events|Top 15 IPs of Attack Source|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by client\_ip<br />\| sort -\_count <br />\| limit 15|
|Akamai Security Events|Top 15 IPs of Attack Source|Logs|Installed Apps/Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory={{\_sourceCategory}} <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by client\_ip<br />\| sort -\_count <br />\| limit 15|
|Akamai Security Events|Top 15 IPs of Attack Source|Logs|Akamai Security Events/Akamai Security Events -  Attack Data|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by client\_ip<br />\| sort -\_count <br />\| limit 15|
|Akamai Security Events|Top 15 IPs of Attack Source|Logs|Akamai Security Events/Akamai Security Events  - Overview|\_sourceCategory = Labs/akamai-security-events <br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| count by client\_ip<br />\| sort -\_count <br />\| limit 15|
|Akamai Security Events|Total Bytes Served by Request ID|Logs|Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory = Labs/akamai-security-events<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| sum(bytes), values(url) as url by request\_id<br />\| sort -\_sum<br />\| \_sum / 1024 / 1024 as mb\_bytes<br />\| fields request\_id, url, mb\_bytes<br />|
|Akamai Security Events|Total Bytes Served by Request ID|Logs|Installed Apps/Akamai Security Events/Akamai Security Events -  HTTP Data|\_sourceCategory={{\_sourceCategory}}<br />\| json field=\_raw "attackData.clientIP", "attackData.configId", "attackData.policyId", "attackData.ruleAction", "attackData.rule", "attackData.ruleData" ,  "attackData.ruleMessage", "attackData.ruleSelector", "attackData.ruleTag", "attackData.ruleVersion", "httpMessage.start", "httpMessage.status" as client\_ip, config\_id, policy\_id, rule\_action, rule, rule\_data ,rule\_message, rule\_selector, rule\_tag, rule\_version, time\_epoch, http\_response nodrop<br />\| time\_epoch \* 1000 as time\_epoch\_ms<br />\|formatDate(toLong(time\_epoch\_ms), "MM-dd-yyyyHH:mm:ss") as attack\_date <br />\|json field=\_raw "geo.city", "geo.continent", "geo.country", "geo.regionCode", "geo.asn" as city, continent, country, region\_code, asn nodrop<br />\| json field=\_raw "httpMessage.bytes", "httpMessage.host", "httpMessage.method", "httpMessage.path", "httpMessage.port", "httpMessage.protocol", "httpMessage.query", "httpMessage.requestId" as bytes, host, method, path, port, protocol, query, request\_id nodrop<br />\| concat(host, path) as url<br />\| sum(bytes), values(url) as url by request\_id<br />\| sort -\_sum<br />\| \_sum / 1024 / 1024 as mb\_bytes<br />\| fields request\_id, url, mb\_bytes<br />|

