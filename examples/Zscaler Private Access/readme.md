# Zscaler Private Access
## Sumo Logic App For: Zscaler Private Access
The Zscaler Private Access App collects logs from ZPA with Log Streaming Service (LSS) to provide easy-to-access visual insights into user status, user activity, connector status, performance, and audit information.
Docs Link: [Zscaler Private Access](https://help.sumologic.com/?cid=210524)

## Searches

### Log Searches

- **AppGroups**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **AppGroups**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **AppGroups Over Time**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **AppGroups Over Time**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Applications**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Applications**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Applications over time**: from Dashboard: Zscaler Private Access/ZPA - Performance 
- **Applications Over Time**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Applications over time**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Performance 
- **Applications Over Time**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Audit Logs**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Audit 
- **Audit Logs**: from Dashboard: Zscaler Private Access/ZPA - Audit 
- **Authentication Audit Logs**: from Dashboard: Zscaler Private Access/ZPA - Audit 
- **Authentication Audit Logs**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Audit 
- **Average Server Setup Time by User**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Performance 
- **Average Server Setup Time by User**: from Dashboard: Zscaler Private Access/ZPA - Performance 
- **Average Setup Time by Connector**: from Dashboard: Zscaler Private Access/ZPA - Performance 
- **Average Setup Time by Connector**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Performance 
- **Changes  by Users**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Audit 
- **Changes  by Users**: from Dashboard: Zscaler Private Access/ZPA - Audit 
- **Connected Users**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Connected Users**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Connected Users**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Connected Users**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Connector Groups by CPU Utilization**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Connector Groups by CPU Utilization**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Connector Groups by Memory Utilization**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Connector Groups by Memory Utilization**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Connector Locations**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Connector Locations**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Connector Logs**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Connector Logs**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Connector Service Count**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Connector Service Count**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Connectors**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Connectors**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Connectors by CPU Utilization**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Connectors by CPU Utilization**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Connectors by Memory Utilization**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Connectors by Memory Utilization**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Connectors Over Time**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Connectors Over Time**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **CPU Utilization By Connector**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **CPU Utilization By Connector**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Distribution by Object Type**: from Dashboard: Zscaler Private Access/ZPA - Audit 
- **Distribution by Object Type**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Audit 
- **Malicious IP Addresses**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Malicious IP Addresses**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Mem Utilization By Connector**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Mem Utilization By Connector**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Platforms**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Platforms**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Polcies Over Time**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Polcies Over Time**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Policies**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Policies**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Policy Blocks**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Policy Blocks**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Recently Authenticated  Users**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Recently Authenticated  Users**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Recently Authenticated Users**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Recently Authenticated Users**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Recently Blocked Users**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Recently Blocked Users**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Server Setup Time, Connector ZEN Setup Time, Connection Setup Time by Application**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Performance 
- **Server Setup Time, Connector ZEN Setup Time, Connection Setup Time by Application**: from Dashboard: Zscaler Private Access/ZPA - Performance 
- **Server Setup Time, Connector ZEN Setup Time, Connection Setup Time by Connector**: from Dashboard: Zscaler Private Access/ZPA - Performance 
- **Server Setup Time, Connector ZEN Setup Time, Connection Setup Time by Connector**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Performance 
- **Sign In Failures by User**: from Dashboard: Zscaler Private Access/ZPA - Audit 
- **Sign In Failures by User**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Audit 
- **Threat Intel Analysis of Connections**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Threat Intel Analysis of Connections**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Timeout Blocks**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Timeout Blocks**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Top 10 Applications Connection Setup Time**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Performance 
- **Top 10 Applications Connection Setup Time**: from Dashboard: Zscaler Private Access/ZPA - Performance 
- **Top 10 Slowest Connectors by Connection Setup Time**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Performance 
- **Top 10 Slowest Connectors by Connection Setup Time**: from Dashboard: Zscaler Private Access/ZPA - Performance 
- **Top 10 Slowest Servers**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Performance 
- **Top 10 Slowest Servers**: from Dashboard: Zscaler Private Access/ZPA - Performance 
- **Top AppGroups**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Top AppGroups**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Top Applications**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Top Applications**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Top Connectors**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Top Connectors**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Top Platforms**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Top Platforms**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Top Policies**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Top Policies**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Top Users by Events**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Top Users by Events**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Total Users**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **Total Users**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Total Users**: from Dashboard: Zscaler Private Access/ZPA - Overview 
- **Total Users**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Overview 
- **Transmitted Bytes By Connector**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Transmitted Bytes By Connector**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Transmitted Errors By Connector**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Transmitted Errors By Connector**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Transmitted Packets By Connector**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Transmitted Packets By Connector**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **Transmitted Packets Outlier**: from Dashboard: Zscaler Private Access/ZPA - Connectors 
- **Transmitted Packets Outlier**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Connectors 
- **User Activity - Access Policy Blocks**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - User Activity 
- **User Activity - Access Policy Blocks**: from Dashboard: Zscaler Private Access/ZPA - User Activity 
- **User Activity - Timeout Policy Blocks**: from Dashboard: Zscaler Private Access/ZPA - User Activity 
- **User Activity - Timeout Policy Blocks**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - User Activity 
- **User Activity Logs**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - User Activity 
- **User Activity Logs**: from Dashboard: Zscaler Private Access/ZPA - User Activity 
- **User Locations**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **User Locations**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **User Status Logs**: from Dashboard: Zscaler Private Access/ZPA - Users 
- **User Status Logs**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Users 
- **Users by Authentication**: from Dashboard: Installed Apps/Zscaler Private Access/ZPA - Audit 
- **Users by Authentication**: from Dashboard: Zscaler Private Access/ZPA - Audit

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Zscaler Private Access|AppGroups|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "AppGroup","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count\_distinct(AppGroup)|
|Zscaler Private Access|AppGroups|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "AppGroup","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count\_distinct(AppGroup)|
|Zscaler Private Access|AppGroups Over Time|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "AppGroup","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| timeslice 1d<br />\| count by \_timeslice,AppGroup<br />\| transpose row \_timeslice column AppGroup|
|Zscaler Private Access|AppGroups Over Time|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "AppGroup","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| timeslice 1d<br />\| count by \_timeslice,AppGroup<br />\| transpose row \_timeslice column AppGroup|
|Zscaler Private Access|Applications|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Application","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count\_distinct(Application )|
|Zscaler Private Access|Applications|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Application","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count\_distinct(Application )|
|Zscaler Private Access|Applications over time|Logs|Zscaler Private Access/ZPA - Performance|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Application"<br />\| where username!="ZPA LSS Client" <br />\| timeslice 10m<br />\| count by Application, \_timeslice<br />\| transpose row \_timeslice column Application|
|Zscaler Private Access|Applications Over Time|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Application","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| timeslice 1d<br />\| count by \_timeslice,Application<br />\| transpose row \_timeslice column Application|
|Zscaler Private Access|Applications over time|Logs|Installed Apps/Zscaler Private Access/ZPA - Performance|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Application"<br />\| where username!="ZPA LSS Client" <br />\| timeslice 10m<br />\| count by Application, \_timeslice<br />\| transpose row \_timeslice column Application|
|Zscaler Private Access|Applications Over Time|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Application","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| timeslice 1d<br />\| count by \_timeslice,Application<br />\| transpose row \_timeslice column Application|
|Zscaler Private Access|Audit Logs|Logs|Installed Apps/Zscaler Private Access/ZPA - Audit|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "User","ObjectType","ObjectName","AuditOperationType","AuditOldValue","AuditNewValue","ModifiedTime"<br />\| where User matches "{{User}}" and AuditOperationType != "Sign Out" and AuditOperationType != "Sign In"<br />\| count by User,ObjectType,ObjectName,AuditOperationType,AuditOldValue,AuditNewValue,ModifiedTime,\_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime|
|Zscaler Private Access|Audit Logs|Logs|Zscaler Private Access/ZPA - Audit|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "User","ObjectType","ObjectName","AuditOperationType","AuditOldValue","AuditNewValue","ModifiedTime"<br />\| where User matches "{{User}}" and AuditOperationType != "Sign Out" and AuditOperationType != "Sign In"<br />\| count by User,ObjectType,ObjectName,AuditOperationType,AuditOldValue,AuditNewValue,ModifiedTime,\_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime|
|Zscaler Private Access|Authentication Audit Logs|Logs|Zscaler Private Access/ZPA - Audit|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "User","ObjectType","ObjectName","AuditOperationType","AuditOldValue","AuditNewValue","ModifiedTime"<br />\| where User matches "{{User}}" and (AuditOperationType = "Sign Out" or AuditOperationType = "Sign In")<br />\| count by User,ObjectType,AuditOperationType,\_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime|
|Zscaler Private Access|Authentication Audit Logs|Logs|Installed Apps/Zscaler Private Access/ZPA - Audit|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "User","ObjectType","ObjectName","AuditOperationType","AuditOldValue","AuditNewValue","ModifiedTime"<br />\| where User matches "{{User}}" and (AuditOperationType = "Sign Out" or AuditOperationType = "Sign In")<br />\| count by User,ObjectType,AuditOperationType,\_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime|
|Zscaler Private Access|Average Server Setup Time by User|Logs|Installed Apps/Zscaler Private Access/ZPA - Performance|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username", "ServerSetupTime"<br />\| where username!="ZPA LSS Client"<br />\| avg(ServerSetupTime) as ServerSetupTime\_avg by Username<br />\| sort ServerSetupTime\_avg desc<br />\| limit 20<br /><br />|
|Zscaler Private Access|Average Server Setup Time by User|Logs|Zscaler Private Access/ZPA - Performance|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username", "ServerSetupTime"<br />\| where username!="ZPA LSS Client"<br />\| avg(ServerSetupTime) as ServerSetupTime\_avg by Username<br />\| sort ServerSetupTime\_avg desc<br />\| limit 20<br /><br />|
|Zscaler Private Access|Average Setup Time by Connector|Logs|Zscaler Private Access/ZPA - Performance|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />\| json field=\_raw "AppLearnTime" nodrop<br />\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime) or !isEmpty(AppLearnTime)) <br />\| avg(ServerSetupTime) as ServerSetupTime\_avg,avg(ConnectorZENSetupTime) as ConnectorZENSetupTime\_avg,avg(ConnectionSetupTime) as ConnectionSetupTime\_avg,avg(AppLearnTime) as AppLearnTime\_avg<br />\| limit 20|
|Zscaler Private Access|Average Setup Time by Connector|Logs|Installed Apps/Zscaler Private Access/ZPA - Performance|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />\| json field=\_raw "AppLearnTime" nodrop<br />\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime) or !isEmpty(AppLearnTime)) <br />\| avg(ServerSetupTime) as ServerSetupTime\_avg,avg(ConnectorZENSetupTime) as ConnectorZENSetupTime\_avg,avg(ConnectionSetupTime) as ConnectionSetupTime\_avg,avg(AppLearnTime) as AppLearnTime\_avg<br />\| limit 20|
|Zscaler Private Access|Changes  by Users|Logs|Installed Apps/Zscaler Private Access/ZPA - Audit|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "ObjectType","User"<br />\| where User matches "{{User}}"<br />\| count by User|
|Zscaler Private Access|Changes  by Users|Logs|Zscaler Private Access/ZPA - Audit|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "ObjectType","User"<br />\| where User matches "{{User}}"<br />\| count by User|
|Zscaler Private Access|Connected Users|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "Username"<br />\| json field=\_raw "SessionStatus","CountryCode","PublicIP", "ConnectionStatus", "ClientPublicIP", "ClientCountryCode" nodrop<br />\| if(isEmpty(PublicIP), if(isEmpty(ClientPublicIP),"0", ClientPublicIP), PublicIP) as PublicIP<br />\| if(isEmpty(CountryCode), if(isEmpty(ClientCountryCode),"0", ClientCountryCode), CountryCode) as CountryCode<br />\| if(isEmpty(SessionStatus), if(isEmpty(ConnectionStatus),"Invalid", ConnectionStatus), SessionStatus) as SessionStatus<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| withtime SessionStatus<br />\| most\_recent(SessionStatus\_withtime) as SessionStatus by Username,CountryCode,PublicIP<br />\| where ( SessionStatus="ZPN\_STATUS\_AUTHENTICATED" or SessionStatus = "open" or SessionStatus = "active")<br />\| limit 100<br />|
|Zscaler Private Access|Connected Users|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "Username"<br />\| json field=\_raw "SessionStatus","CountryCode","PublicIP", "ConnectionStatus", "ClientPublicIP", "ClientCountryCode" nodrop<br />\| if(isEmpty(PublicIP), if(isEmpty(ClientPublicIP),"0", ClientPublicIP), PublicIP) as PublicIP<br />\| if(isEmpty(CountryCode), if(isEmpty(ClientCountryCode),"0", ClientCountryCode), CountryCode) as CountryCode<br />\| if(isEmpty(SessionStatus), if(isEmpty(ConnectionStatus),"Invalid", ConnectionStatus), SessionStatus) as SessionStatus<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| withtime SessionStatus<br />\| most\_recent(SessionStatus\_withtime) as SessionStatus by Username,CountryCode,PublicIP<br />\| where ( SessionStatus="ZPN\_STATUS\_AUTHENTICATED" or SessionStatus = "open" or SessionStatus = "active")<br />\| limit 100<br />|
|Zscaler Private Access|Connected Users|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "SessionStatus", "Username", "ConnectionStatus" nodrop<br />\| if(isEmpty(SessionStatus), if(isEmpty(ConnectionStatus),"Invalid", ConnectionStatus), SessionStatus) as SessionStatus<br />\| where Username!="ZPA LSS Client"<br />\| withtime SessionStatus<br />\| most\_recent(SessionStatus\_withtime) as SessionStatus by Username<br />\| where ( SessionStatus="ZPN\_STATUS\_AUTHENTICATED" or SessionStatus = "open" or SessionStatus = "active")<br />\| count|
|Zscaler Private Access|Connected Users|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "SessionStatus", "Username", "ConnectionStatus" nodrop<br />\| if(isEmpty(SessionStatus), if(isEmpty(ConnectionStatus),"Invalid", ConnectionStatus), SessionStatus) as SessionStatus<br />\| where Username!="ZPA LSS Client"<br />\| withtime SessionStatus<br />\| most\_recent(SessionStatus\_withtime) as SessionStatus by Username<br />\| where ( SessionStatus="ZPN\_STATUS\_AUTHENTICATED" or SessionStatus = "open" or SessionStatus = "active")<br />\| count|
|Zscaler Private Access|Connector Groups by CPU Utilization|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "CPUUtilization", "ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| max(CPUUtilization) by ConnectorGroup<br />\| sort by \_max desc|
|Zscaler Private Access|Connector Groups by CPU Utilization|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "CPUUtilization", "ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| max(CPUUtilization) by ConnectorGroup<br />\| sort by \_max desc|
|Zscaler Private Access|Connector Groups by Memory Utilization|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "MemUtilization", "ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| max(MemUtilization) by ConnectorGroup<br />\| sort by \_max desc|
|Zscaler Private Access|Connector Groups by Memory Utilization|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "MemUtilization", "ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| max(MemUtilization) by ConnectorGroup<br />\| sort by \_max desc|
|Zscaler Private Access|Connector Locations|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "PublicIP","ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = PublicIP<br />\| where !isNull(latitude)<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code, ConnectorGroup<br />\| sort \_count<br /><br /><br />|
|Zscaler Private Access|Connector Locations|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "PublicIP","ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = PublicIP<br />\| where !isNull(latitude)<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code, ConnectorGroup<br />\| sort \_count<br /><br /><br />|
|Zscaler Private Access|Connector Logs|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "ErrorsTxInterface", "Connector","ConnectorGroup","CountryCode","CPUUtilization","MemUtilization","ServiceCount","PublicIP","LogTimestamp"<br />\| where Connector matches "{{Connector}}"<br />\| count by LogTimestamp,Connector,ConnectorGroup,CountryCode,CPUUtilization,MemUtilization,ServiceCount,PublicIP, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime<br />\| limit 1000|
|Zscaler Private Access|Connector Logs|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "ErrorsTxInterface", "Connector","ConnectorGroup","CountryCode","CPUUtilization","MemUtilization","ServiceCount","PublicIP","LogTimestamp"<br />\| where Connector matches "{{Connector}}"<br />\| count by LogTimestamp,Connector,ConnectorGroup,CountryCode,CPUUtilization,MemUtilization,ServiceCount,PublicIP, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime<br />\| limit 1000|
|Zscaler Private Access|Connector Service Count|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "ServiceCount","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 10m<br />\| sum(ServiceCount) by \_timeslice, Connector<br />\| transpose row \_timeslice column Connector|
|Zscaler Private Access|Connector Service Count|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "ServiceCount","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 10m<br />\| sum(ServiceCount) by \_timeslice, Connector<br />\| transpose row \_timeslice column Connector|
|Zscaler Private Access|Connectors|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Connector"<br />\| where Username matches "{{Username}}"<br />\| count\_distinct(Connector) |
|Zscaler Private Access|Connectors|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Connector"<br />\| where Username matches "{{Username}}"<br />\| count\_distinct(Connector) |
|Zscaler Private Access|Connectors by CPU Utilization|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "CPUUtilization", "ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| max(CPUUtilization) by Connector<br />\| sort by \_max desc|
|Zscaler Private Access|Connectors by CPU Utilization|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "CPUUtilization", "ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| max(CPUUtilization) by Connector<br />\| sort by \_max desc|
|Zscaler Private Access|Connectors by Memory Utilization|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "MemUtilization", "ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| max(MemUtilization) by Connector<br />\| sort by \_max desc|
|Zscaler Private Access|Connectors by Memory Utilization|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "MemUtilization", "ConnectorGroup","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| max(MemUtilization) by Connector<br />\| sort by \_max desc|
|Zscaler Private Access|Connectors Over Time|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Connector","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| timeslice 1d<br />\| count by \_timeslice,Connector<br />\| transpose row \_timeslice column Connector|
|Zscaler Private Access|Connectors Over Time|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Connector","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| timeslice 1d<br />\| count by \_timeslice,Connector<br />\| transpose row \_timeslice column Connector|
|Zscaler Private Access|CPU Utilization By Connector|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "CPUUtilization","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(CPUUtilization) as CPUUtilization by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|CPU Utilization By Connector|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "CPUUtilization","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(CPUUtilization) as CPUUtilization by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Distribution by Object Type|Logs|Zscaler Private Access/ZPA - Audit|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "ObjectType","User"<br />\| where User matches "{{User}}"<br />\| count by ObjectType|
|Zscaler Private Access|Distribution by Object Type|Logs|Installed Apps/Zscaler Private Access/ZPA - Audit|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "ObjectType","User"<br />\| where User matches "{{User}}"<br />\| count by ObjectType|
|Zscaler Private Access|Malicious IP Addresses|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "Username"<br />\| json field=\_raw "PublicIP", "ClientPublicIP" nodrop<br />\| if(isEmpty(PublicIP), if(isEmpty(ClientPublicIP),"0", ClientPublicIP), PublicIP) as PublicIP<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=PublicIP<br />\| where type="ip\_address" <br />\| count\_distinct(PublicIP)|
|Zscaler Private Access|Malicious IP Addresses|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "Username"<br />\| json field=\_raw "PublicIP", "ClientPublicIP" nodrop<br />\| if(isEmpty(PublicIP), if(isEmpty(ClientPublicIP),"0", ClientPublicIP), PublicIP) as PublicIP<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=PublicIP<br />\| where type="ip\_address" <br />\| count\_distinct(PublicIP)|
|Zscaler Private Access|Mem Utilization By Connector|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "MemUtilization","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(MemUtilization) as MemUtilization by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Mem Utilization By Connector|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "MemUtilization","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(MemUtilization) as MemUtilization by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Platforms|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "Platform","Username"<br />\| where !isEmpty(Platform) and Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count\_distinct(Platform)|
|Zscaler Private Access|Platforms|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "Platform","Username"<br />\| where !isEmpty(Platform) and Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count\_distinct(Platform)|
|Zscaler Private Access|Polcies Over Time|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Policy"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| timeslice 1d<br />\| count by \_timeslice,Policy<br />\| transpose row \_timeslice column Policy|
|Zscaler Private Access|Polcies Over Time|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Policy"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| timeslice 1d<br />\| count by \_timeslice,Policy<br />\| transpose row \_timeslice column Policy|
|Zscaler Private Access|Policies|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Policy"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count\_distinct(Policy)|
|Zscaler Private Access|Policies|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Policy"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count\_distinct(Policy)|
|Zscaler Private Access|Policy Blocks|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Policy", "InternalReason"<br />\| where Username!="ZPA LSS Client" and (InternalReason = "BRK\_MT\_SETUP\_FAIL\_REJECTED\_BY\_POLICY" or InternalReason = "BRK\_MT\_SETUP\_FAIL\_NO\_POLICY\_FOUND") and Username matches "{{Username}}"<br />\| count|
|Zscaler Private Access|Policy Blocks|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Policy", "InternalReason"<br />\| where Username!="ZPA LSS Client" and (InternalReason = "BRK\_MT\_SETUP\_FAIL\_REJECTED\_BY\_POLICY" or InternalReason = "BRK\_MT\_SETUP\_FAIL\_NO\_POLICY\_FOUND") and Username matches "{{Username}}"<br />\| count|
|Zscaler Private Access|Recently Authenticated  Users|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "SessionStatus","Username"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| where SessionStatus="ZPN\_STATUS\_AUTHENTICATED"<br />\| count\_distinct(Username)|
|Zscaler Private Access|Recently Authenticated  Users|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "SessionStatus","Username"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| where SessionStatus="ZPN\_STATUS\_AUTHENTICATED"<br />\| count\_distinct(Username)|
|Zscaler Private Access|Recently Authenticated Users|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "SessionStatus","Username", "CountryCode", "Platform","PublicIP"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| where SessionStatus="ZPN\_STATUS\_AUTHENTICATED"<br />\| count\_distinct(Username) by Username,CountryCode, Platform, PublicIP<br />\| limit 100|
|Zscaler Private Access|Recently Authenticated Users|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "SessionStatus","Username", "CountryCode", "Platform","PublicIP"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| where SessionStatus="ZPN\_STATUS\_AUTHENTICATED"<br />\| count\_distinct(Username) by Username,CountryCode, Platform, PublicIP<br />\| limit 100|
|Zscaler Private Access|Recently Blocked Users|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "Username", "ClientCountryCode","ClientPublicIP", "Policy", "InternalReason"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"  and (InternalReason = "BRK\_MT\_SETUP\_FAIL\_REJECTED\_BY\_POLICY" or InternalReason = "BRK\_MT\_SETUP\_FAIL\_NO\_POLICY\_FOUND" or InternalReason ="BRK\_MT\_SETUP\_FAIL\_SAML\_EXPIRED")<br />\| count\_distinct(Username) by Username,ClientCountryCode, ClientPublicIP,Policy<br />\| limit 100|
|Zscaler Private Access|Recently Blocked Users|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "Username", "ClientCountryCode","ClientPublicIP", "Policy", "InternalReason"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"  and (InternalReason = "BRK\_MT\_SETUP\_FAIL\_REJECTED\_BY\_POLICY" or InternalReason = "BRK\_MT\_SETUP\_FAIL\_NO\_POLICY\_FOUND" or InternalReason ="BRK\_MT\_SETUP\_FAIL\_SAML\_EXPIRED")<br />\| count\_distinct(Username) by Username,ClientCountryCode, ClientPublicIP,Policy<br />\| limit 100|
|Zscaler Private Access|Server Setup Time, Connector ZEN Setup Time, Connection Setup Time by Application|Logs|Installed Apps/Zscaler Private Access/ZPA - Performance|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Application"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />//\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime)) <br />\| avg(ServerSetupTime) as ServerSetupTime\_avg,avg(ConnectorZENSetupTime) as ConnectorZENSetupTime\_avg,avg(ConnectionSetupTime) as ConnectionSetupTime\_avg by Application<br />\| limit 20|
|Zscaler Private Access|Server Setup Time, Connector ZEN Setup Time, Connection Setup Time by Application|Logs|Zscaler Private Access/ZPA - Performance|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Application"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />//\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime)) <br />\| avg(ServerSetupTime) as ServerSetupTime\_avg,avg(ConnectorZENSetupTime) as ConnectorZENSetupTime\_avg,avg(ConnectionSetupTime) as ConnectionSetupTime\_avg by Application<br />\| limit 20|
|Zscaler Private Access|Server Setup Time, Connector ZEN Setup Time, Connection Setup Time by Connector|Logs|Zscaler Private Access/ZPA - Performance|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Connector"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime)) <br />\| avg(ServerSetupTime) as ServerSetupTime\_avg,avg(ConnectorZENSetupTime) as ConnectorZENSetupTime\_avg,avg(ConnectionSetupTime) as ConnectionSetupTime\_avg by Connector<br />\| limit 10|
|Zscaler Private Access|Server Setup Time, Connector ZEN Setup Time, Connection Setup Time by Connector|Logs|Installed Apps/Zscaler Private Access/ZPA - Performance|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Connector"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime)) <br />\| avg(ServerSetupTime) as ServerSetupTime\_avg,avg(ConnectorZENSetupTime) as ConnectorZENSetupTime\_avg,avg(ConnectionSetupTime) as ConnectionSetupTime\_avg by Connector<br />\| limit 10|
|Zscaler Private Access|Sign In Failures by User|Logs|Zscaler Private Access/ZPA - Audit|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "ObjectType","User"<br />\| where User matches "{{User}}" and ObjectType = "Sign In Failure"<br />\| count by User|
|Zscaler Private Access|Sign In Failures by User|Logs|Installed Apps/Zscaler Private Access/ZPA - Audit|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "ObjectType","User"<br />\| where User matches "{{User}}" and ObjectType = "Sign In Failure"<br />\| count by User|
|Zscaler Private Access|Threat Intel Analysis of Connections|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "Username"<br />\| json field=\_raw "PublicIP", "ClientPublicIP" nodrop<br />\| if(isEmpty(PublicIP), if(isEmpty(ClientPublicIP),"0", ClientPublicIP), PublicIP) as PublicIP<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=PublicIP<br />\| where type="ip\_address" <br />\| count by  Username, type, actor, PublicIP, malicious\_confidence<br />\| limit 100|
|Zscaler Private Access|Threat Intel Analysis of Connections|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "Username"<br />\| json field=\_raw "PublicIP", "ClientPublicIP" nodrop<br />\| if(isEmpty(PublicIP), if(isEmpty(ClientPublicIP),"0", ClientPublicIP), PublicIP) as PublicIP<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=PublicIP<br />\| where type="ip\_address" <br />\| count by  Username, type, actor, PublicIP, malicious\_confidence<br />\| limit 100|
|Zscaler Private Access|Timeout Blocks|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Policy", "InternalReason"<br />\| where Username!="ZPA LSS Client" and (InternalReason = "BRK\_MT\_SETUP\_FAIL\_SAML\_EXPIRED") and Username matches "{{Username}}"<br />\| count|
|Zscaler Private Access|Timeout Blocks|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Policy", "InternalReason"<br />\| where Username!="ZPA LSS Client" and (InternalReason = "BRK\_MT\_SETUP\_FAIL\_SAML\_EXPIRED") and Username matches "{{Username}}"<br />\| count|
|Zscaler Private Access|Top 10 Applications Connection Setup Time|Logs|Installed Apps/Zscaler Private Access/ZPA - Performance|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Application"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />//\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime)) <br />\| avg(ConnectionSetupTime) as ConnectionSetupTime\_avg by Application<br />\| limit 10|
|Zscaler Private Access|Top 10 Applications Connection Setup Time|Logs|Zscaler Private Access/ZPA - Performance|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Application"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />//\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime)) <br />\| avg(ConnectionSetupTime) as ConnectionSetupTime\_avg by Application<br />\| limit 10|
|Zscaler Private Access|Top 10 Slowest Connectors by Connection Setup Time|Logs|Installed Apps/Zscaler Private Access/ZPA - Performance|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Connector"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime)) <br />\| avg(ConnectionSetupTime) as ConnectionSetupTime\_avg by Connector<br />\| sort by ConnectionSetupTime\_avg desc<br />\| limit 20|
|Zscaler Private Access|Top 10 Slowest Connectors by Connection Setup Time|Logs|Zscaler Private Access/ZPA - Performance|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Connector"<br />\| json field=\_raw "ServerSetupTime" nodrop<br />\| json field=\_raw "ConnectorZENSetupTime" nodrop<br />\| json field=\_raw "ConnectionSetupTime" nodrop<br />\| where username!="ZPA LSS Client" <br />\| where (!isEmpty(ServerSetupTime) or !isEmpty(ConnectorZENSetupTime) or !isEmpty(ConnectionSetupTime)) <br />\| avg(ConnectionSetupTime) as ConnectionSetupTime\_avg by Connector<br />\| sort by ConnectionSetupTime\_avg desc<br />\| limit 20|
|Zscaler Private Access|Top 10 Slowest Servers|Logs|Installed Apps/Zscaler Private Access/ZPA - Performance|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Host"<br />\| json field=\_raw "ServerSetupTime" <br />\| where username!="ZPA LSS Client" <br />\| avg(ServerSetupTime) as ServerSetupTime\_avg by Host<br />\| sort by ServerSetupTime\_avg desc<br />\| limit 10|
|Zscaler Private Access|Top 10 Slowest Servers|Logs|Zscaler Private Access/ZPA - Performance|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Host"<br />\| json field=\_raw "ServerSetupTime" <br />\| where username!="ZPA LSS Client" <br />\| avg(ServerSetupTime) as ServerSetupTime\_avg by Host<br />\| sort by ServerSetupTime\_avg desc<br />\| limit 10|
|Zscaler Private Access|Top AppGroups|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "AppGroup","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count by AppGroup<br />\| limit 10|
|Zscaler Private Access|Top AppGroups|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "AppGroup","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count by AppGroup<br />\| limit 10|
|Zscaler Private Access|Top Applications|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Application","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count by Application <br />\| limit 10|
|Zscaler Private Access|Top Applications|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Application","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count by Application <br />\| limit 10|
|Zscaler Private Access|Top Connectors|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Connector","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count by Connector <br />\| limit 10|
|Zscaler Private Access|Top Connectors|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Connector","Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count by Connector <br />\| limit 10|
|Zscaler Private Access|Top Platforms|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "Platform","Username"<br />\| where !isEmpty(Platform) and Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count by Platform|
|Zscaler Private Access|Top Platforms|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "Platform","Username"<br />\| where !isEmpty(Platform) and Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count by Platform|
|Zscaler Private Access|Top Policies|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username","Policy"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count by Policy <br />\| limit 10|
|Zscaler Private Access|Top Policies|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username","Policy"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count by Policy <br />\| limit 10|
|Zscaler Private Access|Top Users by Events|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count by Username <br />\| limit 10|
|Zscaler Private Access|Top Users by Events|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count by Username <br />\| limit 10|
|Zscaler Private Access|Total Users|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "Username"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count\_distinct(Username)|
|Zscaler Private Access|Total Users|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "Username"<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| count\_distinct(Username)|
|Zscaler Private Access|Total Users|Logs|Zscaler Private Access/ZPA - Overview|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count\_distinct(Username)|
|Zscaler Private Access|Total Users|Logs|Installed Apps/Zscaler Private Access/ZPA - Overview|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "Username"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count\_distinct(Username)|
|Zscaler Private Access|Transmitted Bytes By Connector|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "BytesTxInterface","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(BytesTxInterface) as Transmittedbytes by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Transmitted Bytes By Connector|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "BytesTxInterface","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(BytesTxInterface) as Transmittedbytes by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Transmitted Errors By Connector|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "ErrorsTxInterface","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(ErrorsTxInterface) as Errors by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Transmitted Errors By Connector|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "ErrorsTxInterface","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(ErrorsTxInterface) as Errors by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Transmitted Packets By Connector|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "PacketsTxInterface","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(PacketsTxInterface) as TransmittedPackets by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Transmitted Packets By Connector|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "PacketsTxInterface","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 1h <br />\| sum(PacketsTxInterface) as TransmittedPackets by \_timeslice, Connector<br />\| sort \_timeslice<br />\| transpose row \_timeslice column Connector<br />|
|Zscaler Private Access|Transmitted Packets Outlier|Logs|Zscaler Private Access/ZPA - Connectors|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "PacketsTxInterface","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 15m <br />\| sum(PacketsTxInterface) as TransmittedPackets by \_timeslice<br />\| sort \_timeslice<br />\| outlier TransmittedPackets<br />|
|Zscaler Private Access|Transmitted Packets Outlier|Logs|Installed Apps/Zscaler Private Access/ZPA - Connectors|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "PacketsTxInterface","Connector"<br />\| where Connector matches "{{Connector}}"<br />\| timeslice 15m <br />\| sum(PacketsTxInterface) as TransmittedPackets by \_timeslice<br />\| sort \_timeslice<br />\| outlier TransmittedPackets<br />|
|Zscaler Private Access|User Activity - Access Policy Blocks|Logs|Installed Apps/Zscaler Private Access/ZPA - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "LogTimestamp","ConnectionStatus","Username", "ClientCountryCode","ClientPublicIP", "Policy", "Application", "AppGroup","ConnectionID", "ServicePort", "InternalReason"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client" and Application matches "{{Application}}" and (InternalReason = "BRK\_MT\_SETUP\_FAIL\_REJECTED\_BY\_POLICY" or InternalReason = "BRK\_MT\_SETUP\_FAIL\_NO\_POLICY\_FOUND")<br />\| count by LogTimestamp,ConnectionStatus,Username, ClientCountryCode, ClientPublicIP, Policy, Application, AppGroup, ConnectionID, ServicePort, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime, \_count<br />\| limit 1000|
|Zscaler Private Access|User Activity - Access Policy Blocks|Logs|Zscaler Private Access/ZPA - User Activity|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "LogTimestamp","ConnectionStatus","Username", "ClientCountryCode","ClientPublicIP", "Policy", "Application", "AppGroup","ConnectionID", "ServicePort", "InternalReason"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client" and Application matches "{{Application}}" and (InternalReason = "BRK\_MT\_SETUP\_FAIL\_REJECTED\_BY\_POLICY" or InternalReason = "BRK\_MT\_SETUP\_FAIL\_NO\_POLICY\_FOUND")<br />\| count by LogTimestamp,ConnectionStatus,Username, ClientCountryCode, ClientPublicIP, Policy, Application, AppGroup, ConnectionID, ServicePort, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime, \_count<br />\| limit 1000|
|Zscaler Private Access|User Activity - Timeout Policy Blocks|Logs|Zscaler Private Access/ZPA - User Activity|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "LogTimestamp","ConnectionStatus","Username", "ClientCountryCode","ClientPublicIP", "Policy", "Application", "AppGroup","ConnectionID", "ServicePort", "InternalReason"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client" and Application matches "{{Application}}" and InternalReason="BRK\_MT\_SETUP\_FAIL\_SAML\_EXPIRED"<br />\| count by LogTimestamp,ConnectionStatus,Username, ClientCountryCode, ClientPublicIP, Policy, Application, AppGroup, ConnectionID, ServicePort, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime, \_count<br />\| limit 1000|
|Zscaler Private Access|User Activity - Timeout Policy Blocks|Logs|Installed Apps/Zscaler Private Access/ZPA - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "LogTimestamp","ConnectionStatus","Username", "ClientCountryCode","ClientPublicIP", "Policy", "Application", "AppGroup","ConnectionID", "ServicePort", "InternalReason"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client" and Application matches "{{Application}}" and InternalReason="BRK\_MT\_SETUP\_FAIL\_SAML\_EXPIRED"<br />\| count by LogTimestamp,ConnectionStatus,Username, ClientCountryCode, ClientPublicIP, Policy, Application, AppGroup, ConnectionID, ServicePort, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime, \_count<br />\| limit 1000|
|Zscaler Private Access|User Activity Logs|Logs|Installed Apps/Zscaler Private Access/ZPA - User Activity|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "LogTimestamp","ConnectionStatus","Username", "ClientCountryCode","ClientPublicIP", "Policy", "Application", "AppGroup","ConnectionID", "ServicePort"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client" and Application matches "{{Application}}"<br />\| count by LogTimestamp,ConnectionStatus,Username, ClientCountryCode, ClientPublicIP, Policy, Application, AppGroup, ConnectionID, ServicePort, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime, \_count<br />\| limit 1000|
|Zscaler Private Access|User Activity Logs|Logs|Zscaler Private Access/ZPA - User Activity|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "LogTimestamp","ConnectionStatus","Username", "ClientCountryCode","ClientPublicIP", "Policy", "Application", "AppGroup","ConnectionID", "ServicePort"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client" and Application matches "{{Application}}"<br />\| count by LogTimestamp,ConnectionStatus,Username, ClientCountryCode, ClientPublicIP, Policy, Application, AppGroup, ConnectionID, ServicePort, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime, \_count<br />\| limit 1000|
|Zscaler Private Access|User Locations|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "Username"<br />\| json field=\_raw "PublicIP", "ClientPublicIP" nodrop<br />\| if(isEmpty(PublicIP), ClientPublicIP, PublicIP) as PublicIP<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = PublicIP<br />\| where !isNull(latitude)<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code,Username<br />\| sort \_count<br /><br /><br />|
|Zscaler Private Access|User Locations|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "Username"<br />\| json field=\_raw "PublicIP", "ClientPublicIP" nodrop<br />\| if(isEmpty(PublicIP), ClientPublicIP, PublicIP) as PublicIP<br />\| where Username!="ZPA LSS Client" and Username matches "{{Username}}"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = PublicIP<br />\| where !isNull(latitude)<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code,Username<br />\| sort \_count<br /><br /><br />|
|Zscaler Private Access|User Status Logs|Logs|Zscaler Private Access/ZPA - Users|\_sourceCategory = Labs/ZPA\* <br />\| json field=\_raw "LogTimestamp","SessionStatus","Username", "CountryCode", "Platform","PublicIP"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count by LogTimestamp,SessionStatus,Username, CountryCode, Platform,PublicIP, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime<br />\| limit 1000|
|Zscaler Private Access|User Status Logs|Logs|Installed Apps/Zscaler Private Access/ZPA - Users|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "LogTimestamp","SessionStatus","Username", "CountryCode", "Platform","PublicIP"<br />\| where Username matches "{{Username}}" and Username!="ZPA LSS Client"<br />\| count by LogTimestamp,SessionStatus,Username, CountryCode, Platform,PublicIP, \_messageTime<br />\| sort \_messageTime desc<br />\| fields - \_messageTime<br />\| limit 1000|
|Zscaler Private Access|Users by Authentication|Logs|Installed Apps/Zscaler Private Access/ZPA - Audit|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "ObjectType","User"<br />\| where User matches "{{User}}" and ObjectType = "Authentication"<br />\| count by User|
|Zscaler Private Access|Users by Authentication|Logs|Zscaler Private Access/ZPA - Audit|\_sourceCategory = Labs/ZPA\*  <br />\| json field=\_raw "ObjectType","User"<br />\| where User matches "{{User}}" and ObjectType = "Authentication"<br />\| count by User|

