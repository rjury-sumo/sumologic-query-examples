# Azure Web Apps
## Sumo Logic App For: Azure Web Apps
The Sumo Logic App for Azure Web Apps allows you to collect Azure web server and application diagnostics logs and monitor the health of your Azure Web Apps environment. The App provides preconfigured Dashboards that allow you to monitor server operation and traffic requests and response times.
Docs Link: [Azure Web Apps](https://help.sumologic.com/?cid=6012)

## Searches

### Log Searches

- **400 and 500 Server Errors**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **400 and 500 Server Errors**: from Dashboard: Azure Web Apps/Azure Web Apps - Overview - New 
- **Apps With IP Restrictions Enabled**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions 
- **Azure Web Apps - All HTTP Response Codes with their Count**: from Search: Azure Web Apps/Server Operation Searches/Azure Web Apps - All HTTP Response Codes with their Count 
- **Azure Web Apps - All HTTP Response Codes with their Count**: from Search: Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - All HTTP Response Codes with their Count 
- **Azure Web Apps - Client Errors (4xx response codes) per Day**: from Search: Azure Web Apps/Server Operation Searches/Azure Web Apps - Client Errors (4xx response codes) per Day 
- **Azure Web Apps - Client Errors (4xx response codes) per Day**: from Search: Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Client Errors (4xx response codes) per Day 
- **Azure Web Apps - HTTP Status Code Summary over time**: from Search: Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - HTTP Status Code Summary over time 
- **Azure Web Apps - HTTP Status Code Summary over time**: from Search: Azure Web Apps/Server Operation Searches/Azure Web Apps - HTTP Status Code Summary over time 
- **Azure Web Apps - Malicious URL Requests**: from Search: Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Malicious URL Requests 
- **Azure Web Apps - Malicious URL Requests**: from Search: Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Malicious URL Requests 
- **Azure Web Apps - Slowest URLs by Average Time**: from Search: Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Slowest URLs by Average Time 
- **Azure Web Apps - Slowest URLs by Average Time**: from Search: Azure Web Apps/Server Operation Searches/Azure Web Apps - Slowest URLs by Average Time 
- **Azure Web Apps - Time Taken to Serve Requests**: from Search: Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Time Taken to Serve Requests 
- **Azure Web Apps - Time Taken to Serve Requests**: from Search: Azure Web Apps/Server Operation Searches/Azure Web Apps - Time Taken to Serve Requests 
- **Azure Web Apps - Top 404 URLs**: from Search: Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Top 404 URLs 
- **Azure Web Apps - Top 404 URLs**: from Search: Azure Web Apps/Server Operation Searches/Azure Web Apps - Top 404 URLs 
- **Azure Web Apps - Top Browsers**: from Search: Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top Browsers 
- **Azure Web Apps - Top Browsers**: from Search: Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top Browsers 
- **Azure Web Apps - Top Clients**: from Search: Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top Clients 
- **Azure Web Apps - Top Clients**: from Search: Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top Clients 
- **Azure Web Apps - Top Clients Causing Errors**: from Search: Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Top Clients Causing Errors 
- **Azure Web Apps - Top Clients Causing Errors**: from Search: Azure Web Apps/Server Operation Searches/Azure Web Apps - Top Clients Causing Errors 
- **Azure Web Apps - Top URLs by Count**: from Search: Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top URLs by Count 
- **Azure Web Apps - Top URLs by Count**: from Search: Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top URLs by Count 
- **Azure Web Apps - Traffic Volume Served per Day**: from Search: Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Traffic Volume Served per Day 
- **Azure Web Apps - Traffic Volume Served per Day**: from Search: Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Traffic Volume Served per Day 
- **Container Killed  Events**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Platform 
- **Container Started Events**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Platform 
- **Container Stopped Events**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Platform 
- **Distribution  by Operation Type (Read, Write and Delete)**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations 
- **Distribution by Operations**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations 
- **Errors by Country**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Errors by Country**: from Dashboard: Azure Web Apps/Azure Web Apps - Overview - New 
- **Events by Recommendation Category**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Failed Policy Events**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **High Impact Recommendations**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Latest Deployment Version By Site**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Platform 
- **Log Levels Over Time**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Media Types Requested Over Time**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform 
- **Number of Containers Killed**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Platform 
- **Number of Containers Started**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Platform 
- **Number of Containers Stopped**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Platform 
- **OS Platform**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform 
- **OS Platform Breakdown**: from Dashboard: Azure Web Apps/Azure Web Apps - Overview - New 
- **OS Platform Breakdown by Country**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **OS Platform Breakdown by Country**: from Dashboard: Azure Web Apps/Azure Web Apps - Overview - New 
- **OSes and Browsers**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform 
- **Policy Events by Severity Level**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Policy Events With Warning or Error**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Recent Delete Operations**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations 
- **Recent Errors by App Name**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Recent Failed Policy Events**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Recent Policy Events With Warning or Error**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Recent Recommendation Events**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Recent Resource Health Incidents**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Health 
- **Recent Service Health Incidents**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Health 
- **Recent Write Operations**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations 
- **Recommendations by Impact**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Requests by action**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions 
- **Requests by App**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights 
- **Requests by Hostname - Distribution**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations 
- **Requests by Hostname - Trend**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations 
- **Requests Count by Method**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights 
- **Requests Count by Referer**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights 
- **Requests Count by Username**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights 
- **Resource Health by  Status**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Health 
- **Response Codes Over Time**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Response Throughput**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations 
- **Response Time and Data Volume**: from Dashboard: Azure Web Apps/Azure Web Apps - Overview - New 
- **Response Time and Data Volume**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Response Time Histogram**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations 
- **Scan Status by App Name**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit 
- **Server Errors by Site**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Service Health by Incident Type**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Health 
- **Service Health by Incident Type**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Health 
- **Start/ Restart Events by Web App**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Health 
- **Stop Events by Web App**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Health 
- **Top 10 Allowed IPs**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions 
- **Top 10 containers with errors**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Platform 
- **Top 10 Denied IPs**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions 
- **Top 10 Denied Reponses**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions 
- **Top 10 Infected FIles Names**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit 
- **Top 10 operations that caused the most errors**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations 
- **Top 10 Recent Scanning Error Messages**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit 
- **Top 10 Slowest Pages**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations 
- **Top 10 Slowest Pages by Country**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform 
- **Top 10 URL With Highest Server Bytes Received**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Network 
- **Top 10 URL With Highest Server Bytes Sent**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Network 
- **Top 10 Web Apps by Infected FIles Count**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit 
- **Top Clients IPs**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights 
- **Top Requested Documents**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform 
- **Top Requested Documents by Country**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform 
- **Total Files Scanned**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit 
- **Total Infected Files**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit 
- **Total Recommendations**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations 
- **Traffic Over Time**: from Dashboard: Azure Web Apps/Azure Web Apps - Overview - New 
- **Traffic Over Time**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Traffic Over Time (Outlier)**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights 
- **Traffic Over Time (Outlier)**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Traffic Over Time (Outlier)**: from Dashboard: Azure Web Apps/Azure Web Apps - Overview - New 
- **US Visits by State**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights 
- **Users / Applications by Operation type**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations 
- **Visits by Allowed Source IPs**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions 
- **Visits by Country**: from Dashboard: Azure Web Apps/Azure Web Apps - Overview - New 
- **Visits by Country**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights 
- **Visits by Denied Source IPs**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions 
- **Write and Delete Operations**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview

### Metric Searches

- **Average Memory Working Set**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Current Assemblies**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics 
- **Current Assemblies**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics 
- **Data In**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Data In**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Network 
- **Data Out**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Network 
- **Data Out**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Error by Web App**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Errors**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Gen0 Garbage Collections**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Gen0 Garbage Collections**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Gen1 Garbage Collections**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Gen1 Garbage Collections**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Gen2 Garbage Collections**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Gen2 Garbage Collections**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Handles**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics 
- **Handles**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics 
- **Health Check Status**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Health 
- **Http 2xx**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Http 3xx**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Http 4xx**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Http 5xx**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Errors 
- **Http Response Time**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations 
- **IO Other Bytes/ Second**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations 
- **IO Other Operations/ Second**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations 
- **IO Read Bytes/ Second**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations 
- **IO Read Operations/ Second**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations 
- **IO Write Bytes/ Second**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations 
- **IO Write Operations/ Second**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations 
- **Maximum App  Connections**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Network 
- **Memory Working Set**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Private Bytes in MB**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Requests**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations 
- **Threads**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics 
- **Threads**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics 
- **Top 10 Web Apps - Data In**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Network 
- **Top 10 Web Apps - Data Out**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Network 
- **Top 10 Web Apps - IO Read Bytes/ Second**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Top 10 Web Apps - IO Write Bytes/ Second**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Top 10 Web Apps - Maximum Connections**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Network 
- **Top 10 Web Apps by Max Private Bytes [MB]**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Top 10 Web Apps by Max Working Set Memory [MB]**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Memory 
- **Web App Operations Statistics**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations 
- **Web App Statistics**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Overview 
- **Web App Statistics**: from Dashboard: Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Azure Web Apps|400 and 500 Server Errors|Logs|Azure Web Apps/Azure Web Apps - Overview - New|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if(sc\_status matches "5\*" OR sc\_status matches "4\*", "Error","") as Errors<br />\| where Errors!=""<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}") AND if ("{{cs\_host}}" = "\*", true, cs\_host matches "{{cs\_host}}")<br />\|count as Count by cs\_host<br />\| sort by Count|
|Azure Web Apps|400 and 500 Server Errors|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if(sc\_status matches "5\*" OR sc\_status matches "4\*", "Error","") as Errors<br />\| where Errors!=""<br />\|where cs\_host matches "{{cs\_host}}" <br />\|count as Count by cs\_host<br />\| sort by Count|
|Azure Web Apps|Apps With IP Restrictions Enabled|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceIPSecAuditLogs"<br />\| json "Properties.CIp", "Properties.Result", "Category", "ResourceId" as client\_ip, result, category, resource\_id<br />\| where Category="AppServiceIPSecAuditLogs" and client\_ip matches "{{client\_ip}}"<br />\| parse field=client\_ip "\*:\*" as client\_ip, port<br />\| count by resource\_name<br />\| fields - \_count|
|Azure Web Apps|Average Memory Working Set|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=MemoryWorkingSet statistic=average |
|Azure Web Apps/Server Operation Searches|Azure Web Apps - All HTTP Response Codes with their Count|Logs|Azure Web Apps/Server Operation Searches/Azure Web Apps - All HTTP Response Codes with their Count|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| count by sc\_status <br />\| sort by \_count|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - All HTTP Response Codes with their Count|Logs|Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - All HTTP Response Codes with their Count|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| count by sc\_status <br />\| sort by \_count|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Client Errors (4xx response codes) per Day|Logs|Azure Web Apps/Server Operation Searches/Azure Web Apps - Client Errors (4xx response codes) per Day|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| where sc\_status matches "4\*" <br />\| timeslice by 1d <br />\| count by \_timeslice|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Client Errors (4xx response codes) per Day|Logs|Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Client Errors (4xx response codes) per Day|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| where sc\_status matches "4\*" <br />\| timeslice by 1d <br />\| count by \_timeslice|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - HTTP Status Code Summary over time|Logs|Azure Web Apps/Server Operation Searches/Azure Web Apps - HTTP Status Code Summary over time|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors <br />\| timeslice by 1d <br />\| sum(successes) as successes,  sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by \_timeslice|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - HTTP Status Code Summary over time|Logs|Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - HTTP Status Code Summary over time|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if(sc\_status matches "2\*", 1, 0) as successes <br />\| if(sc\_status matches "3\*", 1, 0) as redirects <br />\| if(sc\_status matches "5\*", 1, 0) as server\_errors <br />\| if(sc\_status matches "4\*", 1, 0) as client\_errors <br />\| timeslice by 1d <br />\| sum(successes) as successes,  sum(redirects) as redirects, sum(client\_errors) as client\_errors,  sum(server\_errors) as server\_errors by \_timeslice|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Malicious URL Requests|Logs|Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Malicious URL Requests|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by client\_ip, malicious\_confidence, type, actor|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Malicious URL Requests|Logs|Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Malicious URL Requests|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by client\_ip, malicious\_confidence, type, actor|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Slowest URLs by Average Time|Logs|Azure Web Apps/Server Operation Searches/Azure Web Apps - Slowest URLs by Average Time|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| (time\_taken/1000) as seconds <br />\| avg(seconds) as avgtimeinseconds by cs\_uri\_stem <br />\| sort by avgtimeinseconds <br />\| limit 100|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Slowest URLs by Average Time|Logs|Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Slowest URLs by Average Time|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| (time\_taken/1000) as seconds <br />\| avg(seconds) as avgtimeinseconds by cs\_uri\_stem <br />\| sort by avgtimeinseconds <br />\| limit 100|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Time Taken to Serve Requests|Logs|Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Time Taken to Serve Requests|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| (time\_taken/1000) as seconds <br />\| seconds/60 as minutes|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Time Taken to Serve Requests|Logs|Azure Web Apps/Server Operation Searches/Azure Web Apps - Time Taken to Serve Requests|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| (time\_taken/1000) as seconds <br />\| seconds/60 as minutes|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Top 404 URLs|Logs|Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Top 404 URLs|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| where sc\_status matches "404" <br />\| count\_frequent cs\_uri\_stem <br />\| limit 100|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Top 404 URLs|Logs|Azure Web Apps/Server Operation Searches/Azure Web Apps - Top 404 URLs|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| where sc\_status matches "404" <br />\| count\_frequent cs\_uri\_stem <br />\| limit 100|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Top Browsers|Logs|Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top Browsers|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| count\_frequent cs\_user\_agent \| limit 100|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Top Browsers|Logs|Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top Browsers|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| count\_frequent cs\_user\_agent \| limit 100|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Top Clients|Logs|Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top Clients|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| count\_frequent client\_ip \| limit 100|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Top Clients|Logs|Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top Clients|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| count\_frequent client\_ip \| limit 100|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Top Clients Causing Errors|Logs|Installed Apps/Azure Web Apps/Server Operation Searches/Azure Web Apps - Top Clients Causing Errors|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| where sc\_status matches "4\*" <br />\| count\_frequent client\_ip <br />\| limit 100|
|Azure Web Apps/Server Operation Searches|Azure Web Apps - Top Clients Causing Errors|Logs|Azure Web Apps/Server Operation Searches/Azure Web Apps - Top Clients Causing Errors|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| where sc\_status matches "4\*" <br />\| count\_frequent client\_ip <br />\| limit 100|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Top URLs by Count|Logs|Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top URLs by Count|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| count\_frequent cs\_uri\_stem \| limit 100|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Top URLs by Count|Logs|Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Top URLs by Count|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| count\_frequent cs\_uri\_stem \| limit 100|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Traffic Volume Served per Day|Logs|Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Traffic Volume Served per Day|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice by 1d \| count as hits by \_timeslice|
|Azure Web Apps/Trafic Insight Searches|Azure Web Apps - Traffic Volume Served per Day|Logs|Installed Apps/Azure Web Apps/Trafic Insight Searches/Azure Web Apps - Traffic Volume Served per Day|tenant\_name=\* subscription\_id=\* location=\* resource\_group=\* provider\_name=microsoft.web resource\_type=sites  resource\_name=\*  "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice by 1d \| count as hits by \_timeslice|
|Azure Web Apps|Container Killed  Events|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Platform|"AppServicePlatformLogs" "ContainerLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category="AppServicePlatformLogs" and operationName="ContainerLogs" and toLowerCase(properties) matches "\*fail\*" and !(toLowerCase(properties) matches "\*exit\*")<br />\| parse regex field=properties "message\\":\\"(?\<message\>[^\\"]+)"<br />\| parse regex field=properties "containerName\\":\\"(?\<containerName\>[^\\"]+)"<br />\| timeslice 5m<br />\| count by resource\_name, \_timeslice<br />\| transpose row \_timeslice column resource\_name|
|Azure Web Apps|Container Started Events|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}<br />"AppServicePlatformLogs" "ContainerLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category="AppServicePlatformLogs" and operationName="ContainerLogs" and toLowerCase(properties) matches "\*ready\*" and !(toLowerCase(properties) matches "\*exit\*")<br />\| parse regex field=properties "message\\":\\"(?\<message\>[^\\"]+)"<br />\| parse regex field=properties "containerName\\":\\"(?\<containerName\>[^\\"]+)"<br />\| timeslice 5m<br />\| count by resource\_name, \_timeslice<br />\| transpose row \_timeslice column resource\_name|
|Azure Web Apps|Container Stopped Events|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}<br />"AppServicePlatformLogs" "ContainerLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category="AppServicePlatformLogs" and operationName="ContainerLogs" and toLowerCase(properties) matches "\*exit\*"<br />\| parse regex field=properties "message\\":\\"(?\<message\>[^\\"]+)"<br />\| parse regex field=properties "containerName\\":\\"(?\<containerName\>[^\\"]+)"<br />\| timeslice 5m<br />\| count by resource\_name, \_timeslice<br />\| transpose row \_timeslice column resource\_name|
|Azure Web Apps|Current Assemblies|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=CurrentAssemblies statistic=average|
|Azure Web Apps|Current Assemblies|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=CurrentAssemblies statistic=average  \| avg|
|Azure Web Apps|Data In|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=BytesReceived statistic=total \| quantize using sum|
|Azure Web Apps|Data In|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=BytesReceived statistic=total \| quantize using sum|
|Azure Web Apps|Data Out|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=BytesSent statistic=total  \| quantize using sum|
|Azure Web Apps|Data Out|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=BytesSent statistic=total  \| quantize using sum|
|Azure Web Apps|Distribution  by Operation Type (Read, Write and Delete)|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}} <br /> provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative"<br />\| "OTHERS" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by operationType<br />\| sort by \_count|
|Azure Web Apps|Distribution by Operations|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| json "resultType", "category", "operationName", "resourceId" as resultType, category, operationName, resourceid<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative" <br />\| count by operationName<br />\| order by \_count|
|Azure Web Apps|Error by Web App|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} (metric=Http4xx or metric=Http5xx) statistic=total  \| quantize using sum \| sum by resource\_name, resource\_group |
|Azure Web Apps|Errors|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}  (metric=Http5xx or metric=Http401 or metric=Http403 or metric=Http404 or metric=Http406) statistic=total  \| quantize using sum \| sum by metric, resource\_group, resource\_name|
|Azure Web Apps|Errors by Country|Logs|Azure Web Apps/Azure Web Apps - Overview - New|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\| if(sc\_status matches "5\*" OR sc\_status matches "4\*", "Error","") as Errors<br />\| where Errors!=""<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\|count by country\_name<br />\| sort by \_count|
|Azure Web Apps|Errors by Country|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if(sc\_status matches "5\*" OR sc\_status matches "4\*", "Error","") as Errors<br />\| where Errors!=""<br />\| count by client\_ip<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\| where !isNull(latitude)<br />\|count as Count by longitude,latitude,country\_name |
|Azure Web Apps|Events by Recommendation Category|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "recommendationResourceLink" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink nodrop<br />\| where category="Recommendation" <br />\| count by recommendationCategory<br />\| sort by \_count|
|Azure Web Apps|Failed Policy Events|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" resource\_name={{resource\_name}} Policy<br />\| JSON "category", "resultType", "level", "properties.resourceLocation", "properties.entity" as category, resultType, level, location, entity nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Failure"<br />\| count |
|Azure Web Apps|Gen0 Garbage Collections|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Gen0Collections statistic=total \| quantize using sum |
|Azure Web Apps|Gen0 Garbage Collections|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Gen0Collections statistic=total \| quantize using sum \| sum|
|Azure Web Apps|Gen1 Garbage Collections|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Gen1Collections statistic=total \| quantize using sum \| sum|
|Azure Web Apps|Gen1 Garbage Collections|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Gen1Collections statistic=total \| quantize using sum |
|Azure Web Apps|Gen2 Garbage Collections|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Gen2Collections statistic=total \| quantize using sum |
|Azure Web Apps|Gen2 Garbage Collections|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Gen2Collections statistic=total \| quantize using sum \| sum|
|Azure Web Apps|Handles|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Handles statistic=average |
|Azure Web Apps|Handles|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Handles statistic=average \| avg|
|Azure Web Apps|Health Check Status|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=HealthCheckStatus statistic=average   \| avg by resource\_name, resource\_group|
|Azure Web Apps|High Impact Recommendations|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "recommendationResourceLink" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink nodrop<br />\| where category="Recommendation" and recommendationImpact = "High"<br />\| count|
|Azure Web Apps|Http 2xx|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}  metric=Http2xx statistic=total  \| quantize using sum \| sum|
|Azure Web Apps|Http 3xx|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}  metric=Http3xx statistic=total  \| quantize using sum \| sum|
|Azure Web Apps|Http 4xx|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}  metric=Http4xx statistic=total  \| quantize using sum \| sum|
|Azure Web Apps|Http 5xx|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}  metric=Http5xx statistic=total  \| quantize using sum \| sum|
|Azure Web Apps|Http Response Time|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=HttpResponseTime   statistic=total|
|Azure Web Apps/Azure Web Apps - I|IO Other Bytes/ Second|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoOtherBytesPerSecond statistic=total|
|Azure Web Apps/Azure Web Apps - I|IO Other Operations/ Second|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoOtherOperationsPerSecond statistic=total|
|Azure Web Apps/Azure Web Apps - I|IO Read Bytes/ Second|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoReadBytesPerSecond statistic=total|
|Azure Web Apps/Azure Web Apps - I|IO Read Operations/ Second|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoReadOperationsPerSecond statistic=total  |
|Azure Web Apps/Azure Web Apps - I|IO Write Bytes/ Second|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoWriteBytesPerSecond statistic =total|
|Azure Web Apps/Azure Web Apps - I|IO Write Operations/ Second|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoWriteOperationsPerSecond statistic = total|
|Azure Web Apps|Latest Deployment Version By Site|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}<br />"AppServicePlatformLogs" "ContainerLogs"<br />\| json "properties", "category", "resourceId", "time" as properties, category, resource\_id, time nodrop<br />\| where category="AppServicePlatformLogs" and operationName="ContainerLogs"<br />\| parse regex field=properties "message\\":\\"(?\<message\>[^\\"]+)"<br />\| parse regex field=properties "containerName\\":\\"(?\<containerName\>[^\\"]+)"<br />\| parse field=message "Site is running with deployment version: \*" as version<br />\| count by resource\_name, containerName, version, time<br />\| dedup 1 by resource\_name, containerName, version, time<br />\| fields - \_count|
|Azure Web Apps|Log Levels Over Time|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} level<br />\| json "resultDescription", "category", "resourceId", "level" as description, category, resource\_id, log\_level<br />\| toLowerCase(log\_level) as log\_level<br />\| if (log\_level matches "\*error\*","Error" , if (log\_level matches "\*info\*", "Info", if (log\_level matches "\*warn\*", "Warn", "Others"))) as log\_level  <br />\|count by log\_level|
|Azure Web Apps|Maximum App  Connections|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=AppConnections statistic=maximum \| quantize using max|
|Azure Web Apps|Media Types Requested Over Time|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs" <br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| parse regex field=cs\_uri\_stem "\\.(?\<media\_type\>[A-Za-z]+)\$" \| timeslice 5m<br />\|where cs\_host matches "{{cs\_host}}" AND src\_user matches "{{src\_user}}" AND client\_ip matches "{{client\_ip}}"<br />\|count as Requests by \_timeslice,media\_type  \| sort - \_timeslice \| transpose row \_timeslice column media\_type|
|Azure Web Apps|Memory Working Set|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=MemoryWorkingSet statistic=maximum|
|Azure Web Apps|Number of Containers Killed|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}<br />"AppServicePlatformLogs" "ContainerLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category="AppServicePlatformLogs" and operationName="ContainerLogs" and toLowerCase(properties) matches "\*fail\*" and !(toLowerCase(properties) matches "\*exit\*")<br />\| parse regex field=properties "message\\":\\"(?\<message\>[^\\"]+)"<br />\| parse regex field=properties "containerName\\":\\"(?\<containerName\>[^\\"]+)"<br />\| count by resource\_name|
|Azure Web Apps|Number of Containers Started|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}<br />"AppServicePlatformLogs" "ContainerLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category="AppServicePlatformLogs" and operationName="ContainerLogs" and toLowerCase(properties) matches "\*ready\*" and !(toLowerCase(properties) matches "\*exit\*")<br />\| parse regex field=properties "message\\":\\"(?\<message\>[^\\"]+)"<br />\| parse regex field=properties "containerName\\":\\"(?\<containerName\>[^\\"]+)"<br />\| count by resource\_name|
|Azure Web Apps|Number of Containers Stopped|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}<br />"AppServicePlatformLogs" "ContainerLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category="AppServicePlatformLogs" and operationName="ContainerLogs" and toLowerCase(properties) matches "\*exit\*"<br />\| parse regex field=properties "message\\":\\"(?\<message\>[^\\"]+)"<br />\| parse regex field=properties "containerName\\":\\"(?\<containerName\>[^\\"]+)"<br />\| count by resource\_name|
|Azure Web Apps|OS Platform|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if (cs\_user\_agent matches "\*iPad\*" OR cs\_user\_agent matches "\*iPhone\*" OR cs\_user\_agent matches "\*BlackBerry\*" OR cs\_user\_agent matches "\*SAMSUNG\*" OR cs\_user\_agent matches "\*SAMSUNG\*" OR cs\_user\_agent matches "\*Galaxy\*" or cs\_user\_agent matches "\*Windows Phone\*" or cs\_user\_agent matches "\*Android\*","mobile","PC") as type<br />\| if (cs\_user\_agent matches "\*Macintosh\*" or (cs\_user\_agent matches "\*iMac\*"),"Mac",type) as type<br />\|where cs\_host matches "{{cs\_host}}" AND src\_user matches "{{src\_user}}" AND client\_ip matches "{{client\_ip}}"<br />\|count type<br />\| sort by \_count|
|Azure Web Apps|OS Platform Breakdown|Logs|Azure Web Apps/Azure Web Apps - Overview - New|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if (cs\_user\_agent matches "\*iPad\*" OR cs\_user\_agent matches "\*iPhone\*" OR cs\_user\_agent matches "\*BlackBerry\*" OR cs\_user\_agent matches "\*SAMSUNG\*" OR cs\_user\_agent matches "\*SAMSUNG\*" OR cs\_user\_agent matches "\*Galaxy\*" or cs\_user\_agent matches "\*Windows Phone\*" or cs\_user\_agent matches "\*Android\*","mobile","PC") as type<br />\| if (cs\_user\_agent matches "\*Macintosh\*" or (cs\_user\_agent matches "\*iMac\*"),"Mac",type) as type<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}") AND if ("{{cs\_host}}" = "\*", true, cs\_host matches "{{cs\_host}}")<br />\|count type<br />\| sort by \_count|
|Azure Web Apps|OS Platform Breakdown by Country|Logs|Azure Web Apps/Azure Web Apps - Overview - New|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\| json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if (cs\_user\_agent matches "\*iPad\*" OR cs\_user\_agent matches "\*iPhone\*" OR cs\_user\_agent matches "\*BlackBerry\*" OR cs\_user\_agent matches "\*SAMSUNG\*" OR cs\_user\_agent matches "\*SAMSUNG\*" OR cs\_user\_agent matches "\*Galaxy\*" or cs\_user\_agent matches "\*Windows Phone\*" or cs\_user\_agent matches "\*Android\*","mobile","PC") as type<br />\| if (cs\_user\_agent matches "\*Macintosh\*" or (cs\_user\_agent matches "\*iMac\*"),"Mac",type) as type<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\|count by type , country\_name<br />\| transpose row  country\_name column  type|
|Azure Web Apps|OS Platform Breakdown by Country|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\| json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if (cs\_user\_agent matches "\*iPad\*" OR cs\_user\_agent matches "\*iPhone\*" OR cs\_user\_agent matches "\*BlackBerry\*" OR cs\_user\_agent matches "\*SAMSUNG\*" OR cs\_user\_agent matches "\*SAMSUNG\*" OR cs\_user\_agent matches "\*Galaxy\*" or cs\_user\_agent matches "\*Windows Phone\*" or cs\_user\_agent matches "\*Android\*","mobile","PC") as type<br />\| if (cs\_user\_agent matches "\*Macintosh\*" or (cs\_user\_agent matches "\*iMac\*"),"Mac",type) as type<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\| if (isBlank(country\_name), "Unknown", country\_name) as country\_name<br />\|count by type , country\_name<br />\| transpose row  country\_name column  type|
|Azure Web Apps|OSes and Browsers|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if ((cs\_user\_agent matches "\*Windows NT\*") or (cs\_user\_agent matches "\*Windows+NT\*"),"Windows","Other") as OS \|<br />if (cs\_user\_agent matches "\*Macintosh\*","MacOS",OS) as OS \|<br />if ((cs\_user\_agent matches "\*Windows Phone\*") or (cs\_user\_agent matches "\*Windows+Phone\*"),"Windows Phone",OS) as OS \|<br />if (cs\_user\_agent matches "\*Linux\*","Linux",OS) as OS \|<br />if (cs\_user\_agent matches "\*iPad\*","iPad",OS) as OS \|<br />if (cs\_user\_agent matches "\*iPhone\*","iPhone",OS) as OS \|<br />if (cs\_user\_agent matches "\*Android\*","Android",OS) as OS \|<br />if (cs\_user\_agent matches "\*MSIE\*","Internet Explorer","Other") as Browser \|<br />if (cs\_user\_agent matches "\*Firefox\*","Firefox",Browser) as Browser \|<br />if (cs\_user\_agent matches "\*Safari\*","Safari",Browser) as Browser \| <br />if (cs\_user\_agent matches "\*Chrome\*","Chrome",Browser) as Browser \|<br />if (cs\_user\_agent matches "\*Explorer\*","Internet Explorer",Browser) as Browser<br />\|where cs\_host matches "{{cs\_host}}" AND src\_user matches "{{src\_user}}" AND client\_ip matches "{{client\_ip}}"<br />\|count(cs\_user\_agent) by OS,Browser <br />\| transpose row os column browser as \*|
|Azure Web Apps|Policy Events by Severity Level|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name={{provider\_name}} resource\_type={{resource\_type}} resource\_name={{resource\_name}} Policy <br />\| JSON "category", "resultType", "level", "properties.message", "properties.resourceLocation", "properties.entity", "properties.policies" as category, resultType, level, message, location, entity, policies nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Success"<br />\| resource\_name as logicalServerName  \| count as Count by level, resource\_group, logicalServerName, location<br />\| transpose row resource\_group, logicalServerName, location column level|
|Azure Web Apps|Policy Events With Warning or Error|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" resource\_name={{resource\_name}} Policy<br />\| JSON "category", "resultType", "level", "properties.resourceLocation", "properties.entity" as category, resultType, level, location, entity nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Success" and level != "Information"<br />\| count |
|Azure Web Apps|Private Bytes in MB|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=PrivateBytes statistic=average|
|Azure Web Apps|Recent Delete Operations|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "properties.entity", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, entity, identity\_claims\_name, authmethods nodrop<br />\| where (resultType="Accept" or resultType="Success") and category="Administrative"and toUppercase(operationName) matches /DELETE/ <br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message, entity<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure Web Apps|Recent Errors by App Name|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} ("AppServiceAppLogs" or "AppServiceConsoleLogs") <br />\| json "resourceId", "resultDescription" as resourceid, resultDescription nodrop<br />\| where toLowerCase(resultDescription) matches /\\berror\\b/<br /> \| count by resourceid, resource\_name, resultDescription<br />\| tourl(format("https://portal.azure.com/#@domainname.onmicrosoft.com/resource/%s/appServices", resourceId), resource\_name) as resource\_name<br />\| fields - resourceid|
|Azure Web Apps|Recent Failed Policy Events|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" resource\_name={{resource\_name}} Policy<br />\| JSON "category", "resultType", "level", "properties.message", "properties.resourceLocation", "properties.entity", "properties.policies" as category, resultType, level, message, location, entity, policies nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Failure"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count as Count by time, level, resource\_group, resource\_name, location, policies<br />\| fields -Count|
|Azure Web Apps|Recent Policy Events With Warning or Error|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group={{resource\_group}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" resource\_name={{resource\_name}} Policy<br />\| JSON "category", "resultType", "level", "properties.message", "properties.resourceLocation", "properties.entity", "properties.policies" as category, resultType, level, message, location, entity, policies nodrop<br />\| toLowerCase(entity) as entity<br />\| where category="Policy" and   if ("{{location}}"="\*", true, location matches "{{location}}") and resultType="Success" and level!= "Information"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count as Count by time, level, resource\_group, resource\_name, location, policies<br />\| fields -Count|
|Azure Web Apps|Recent Recommendation Events|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "properties.recommendationResourceLink", "resourceId" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink, resourceId nodrop<br />\| where category="Recommendation" <br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| resource\_name as logicalServerName<br />\| count by \_messageTime, time, logicalServerName, recommendationName, recommendationCategory, recommendationImpact, recommendationResourceLink<br />\| tourl(recommendationResourceLink, recommendationName) as recommendationName<br />\| sort by \_messageTime desc<br />\| fields -\_messageTime, \_count, recommendationResourceLink|
|Azure Web Apps|Recent Resource Health Incidents|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Health|tenant\_name={{tenant\_name}}<br />provider\_name={{provider\_name}}<br />resource\_type={{resource\_type}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}} ResourceHealth <br />\| JSON "category", "operationName", "time","level","resultType", "properties.title", "properties.details", "properties.currentHealthStatus", "properties.type", "properties.cause" as category, operationName, time,level,resultType, title, details, currentHealthStatus, type, cause nodrop<br />\| where category="ResourceHealth"<br />\| parse field=operationName "\*/\*/\*" as category, operation\_name, action nodrop<br />\| count as Count by time, level, resource\_name, resource\_group, resultType, operation\_name, title, details, currentHealthStatus, type, cause|
|Azure Web Apps|Recent Service Health Incidents|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} ServiceHealth <br />\| JSON "category", "operationName", "time","level","resultType", "properties.incidentType", "properties.service", "properties.region", "properties.impactStartTime", "properties.impactMitigationTime", "properties.defaultLanguageTitle", "properties.stage" as category, operationName, time,level,resultType, incidentType, service, service\_region, impactStartTime, impactMitigationTime, defaultLanguageTitle, stage nodrop<br />\| replace(toLowerCase(service\_region), " ", "") as service\_region<br />\| where category="ServiceHealth" and (toUpperCase(service) matches /APP/  AND toUpperCase(service) matches /SERVICE/) <br />\| parse field=operationName "\*/\*/\*" as category, operation\_name, action nodrop<br />\| count as Count by time , level, service, resultType, operation\_name, impactStartTime, impactMitigationTime, defaultLanguageTitle, stage|
|Azure Web Apps|Recent Write Operations|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']"  as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, identity\_claims\_name, authmethods nodrop<br />\| where resultType in ("Accept", "Success") and category="Administrative" and toUppercase(operationName) matches /WRITE/<br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, identity\_claims\_name, authmethods, resultSignature, statusCode, message, resultType<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|
|Azure Web Apps|Recommendations by Impact|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "recommendationResourceLink" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink nodrop<br />\| where category="Recommendation" <br />\| count by recommendationImpact<br />\| sort by \_count|
|Azure Web Apps|Requests|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Requests statistic =total \| quantize using sum |
|Azure Web Apps|Requests by action|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceIPSecAuditLogs"<br />\| json "Properties.CIp", "Properties.Result", "Properties.Details", "Category", "Properties.CsHost" as client\_ip, result, response, category, cs\_host nodrop<br />\| where Category="AppServiceIPSecAuditLogs" and client\_ip matches "{{client\_ip}}"<br />\| parse field=client\_ip "\*:\*" as client\_ip, port<br />\| count by result|
|Azure Web Apps|Requests by App|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+)/"<br />\| timeslice 5m<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}"<br />\|count by \_timeslice, app<br />\| transpose row \_timeslice column app|
|Azure Web Apps|Requests by Hostname - Distribution|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\|where client\_ip matches "{{client\_ip}}" <br />\|count as Requests by cs\_host<br />\| sort by Requests|
|Azure Web Apps|Requests by Hostname - Trend|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, resource\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice 5m<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}"<br />\|count as Requests by cs\_host,\_timeslice  <br />\| transpose row \_timeslice column cs\_host|
|Azure Web Apps|Requests Count by Method|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken nodrop<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+)/"<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}"<br />\| timeslice 5m<br />\|count as Count by \_timeslice, cs\_method<br />\| transpose row \_timeslice column cs\_method|
|Azure Web Apps|Requests Count by Referer|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken nodrop<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+)/"<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}"<br />\|count by cs\_referrer|
|Azure Web Apps|Requests Count by Username|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken nodrop<br />\| parse regex field=cs\_uri\_stem "/(?\<app\>[^\\./]+)/"<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}" AND  src\_user !="-" AND  !isBlank(src\_user)<br />\|count as Count by src\_user|
|Azure Web Apps|Resource Health by  Status|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Health|tenant\_name={{tenant\_name}}<br />provider\_name={{provider\_name}}<br />resource\_type={{resource\_type}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}} ResourceHealth <br />\| JSON "category", "properties.currentHealthStatus" as category, currentHealthStatus<br />\| where category="ResourceHealth"<br />\| count as Count by currentHealthStatus|
|Azure Web Apps|Response Codes Over Time|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| if(sc\_status matches "2\*", 1, 0) as successes \| if(sc\_status matches "3\*", 1, 0) as redirects \| if(sc\_status matches "4\*", 1, 0) as client\_errors \| if(sc\_status matches "5\*", 1, 0) as server\_errors \| timeslice by 5m<br />\|where cs\_host matches "{{cs\_host}}"  AND sc\_status matches "{{sc\_status}}"<br />\|sum(successes) as successes, sum(client\_errors) as client\_errors,  sum(redirects) as redirects, sum(server\_errors) as server\_errors by \_timeslice<br />\| sort by \_timeslice asc|
|Azure Web Apps|Response Throughput|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| where (time\_taken!="") <br />\| (sc\_bytes/time\_taken) as sc\_throughput<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}"<br />\|avg(sc\_throughput) as Avg\_Outbound\_throughput  by cs\_uri\_stem \| sort + Avg\_Outbound\_throughput \| limit 10|
|Azure Web Apps|Response Time and Data Volume|Logs|Azure Web Apps/Azure Web Apps - Overview - New|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice 1m<br />\| time\_taken/1000 as seconds<br />\| (cs\_bytes/(1024)) as Kbytes<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\|avg(seconds) as response\_time\_sec, sum(Kbytes) as Kbytes by \_timeslice|
|Azure Web Apps|Response Time and Data Volume|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice 1m<br />\| time\_taken/1000 as seconds<br />\| (cs\_bytes/(1024)) as Kbytes<br />\|avg(seconds) as response\_time\_sec, sum(Kbytes) as Kbytes by \_timeslice|
|Azure Web Apps|Response Time Histogram|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}" AND sc\_status matches "{{sc\_status}}"<br />\|avg(time\_taken) as response\_time by cs\_uri\_stem<br />\| fields response\_time<br />\| int(response\_time/50) as bucket\| (bucket+1)\*50 as MaxBucketTime \| count as Requests by MaxBucketTime \| sort by +MaxBucketTime|
|Azure Web Apps|Scan Status by App Name|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceAntivirusScanAuditLogs"<br />\| json "Properties", "Category", "ResourceId" as properties, category, resource\_id<br />\| where Category="AppServiceAntivirusScanAuditLogs"<br />\| count by properties.ScanStatus|
|Azure Web Apps|Server Errors by Site|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Errors|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| where sc\_status matches "5\*"<br />\|where cs\_host matches "{{cs\_host}}" AND sc\_status matches "{{sc\_status}}"<br />\|count as count by cs\_host,sc\_status<br />\| transpose row cs\_host column sc\_status as \*|
|Azure Web Apps|Service Health by Incident Type|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} ServiceHealth<br />\| JSON "category", "properties.incidentType", "properties.service", "properties.region" as category, incidentType, service, service\_region<br />\| replace(toLowerCase(service\_region), " ", "") as service\_region<br />\| where category="ServiceHealth" and (toUpperCase(service) matches /APP/  OR toUpperCase(service) matches /SERVICE/)<br />\| count by incidentType<br />\| order by incidentType|
|Azure Web Apps|Service Health by Incident Type|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} ServiceHealth <br />\| JSON "category", "properties.incidentType", "properties.service", "properties.region" as category, incidentType, service, service\_region<br />\| replace(toLowerCase(service\_region), " ", "") as service\_region<br />\| where category="ServiceHealth" and (toUpperCase(service) matches /APP/  AND toUpperCase(service) matches /SERVICE/) <br />\| count as Count by incidentType|
|Azure Web Apps|Start/ Restart Events by Web App|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceAppLogs"<br />\| json "resultDescription", "category", "resourceId" as resultDescription, category, resource\_id<br />\| where category="AppServiceAppLogs" and (toLowerCase(resultDescription) contains "application started" or toLowerCase(resultDescription) contains "starting service")<br />\| timeslice 5m<br />\| count by resource\_name, \_timeslice<br />\| transpose row \_timeslice column resource\_name<br />|
|Azure Web Apps|Stop Events by Web App|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Health|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceAppLogs"<br />\| json "resultDescription", "category", "resourceId" as resultDescription, category, resource\_id<br />\| where category="AppServiceAppLogs" and toLowerCase(resultDescription) contains "application is shutting down"<br />\| timeslice 5m<br />\| count by resource\_name, \_timeslice<br />\| transpose row \_timeslice column resource\_name|
|Azure Web Apps|Threads|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Threads statistic = average|
|Azure Web Apps|Threads|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - OS Statistics|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=Threads statistic = average \| avg|
|Azure Web Apps|Top 10 Allowed IPs|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceIPSecAuditLogs"<br />\| json "Properties.CIp", "Properties.Result", "Properties.Details", "Category", "Properties.CsHost", "ResourceId" as client\_ip, result, response, category, cs\_host, resource\_id nodrop<br />\| where Category="AppServiceIPSecAuditLogs" and client\_ip matches "{{client\_ip}}"<br />\| where result matches "Allowed"<br />\| parse field=client\_ip "\*:\*" as client\_ip, port nodrop<br />\| tourl(format("https://portal.azure.com/#@domainname.onmicrosoft.com/resource/%s/appServices", resource\_id), cs\_host) as cs\_host<br />\| count by client\_ip, response, cs\_host<br />\| top 10  cs\_host, client\_ip, response by \_count|
|Azure Web Apps|Top 10 containers with errors|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}}<br />"AppServicePlatformLogs" (\*error\* or \*fail\* or \*exception\*)<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id nodrop<br />\| where category="AppServicePlatformLogs" and operationName="ContainerLogs"<br />\| parse regex field=properties "message\\":\\"(?\<message\>[^\\"]+)"<br />\| count by message<br />\| top 10 message by \_count|
|Azure Web Apps|Top 10 Denied IPs|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceIPSecAuditLogs"<br />\| json "Properties.CIp", "Properties.Result", "Properties.Details", "Category", "Properties.CsHost", "ResourceId" as client\_ip, result, response, category, cs\_host, resource\_id nodrop<br />\| where Category="AppServiceIPSecAuditLogs" and client\_ip matches "{{client\_ip}}"<br />\| where result matches "Denied"<br />\| parse field=client\_ip "\*:\*" as client\_ip, port nodrop<br />\| tourl(format("https://portal.azure.com/#@domainname.onmicrosoft.com/resource/%s/appServices", resource\_id), cs\_host) as cs\_host<br />\| count by client\_ip, response, cs\_host<br />\| top 10  cs\_host, client\_ip, response by \_count|
|Azure Web Apps|Top 10 Denied Reponses|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceIPSecAuditLogs"<br />\| json "Properties.CIp", "Properties.Result", "Properties.Details", "Category", "ResourceId" as client\_ip, result, response, category, resource\_id<br />\| where Category="AppServiceIPSecAuditLogs" and client\_ip matches "{{client\_ip}}"<br />\| where result matches "Denied"<br />\| parse field=client\_ip "\*:\*" as client\_ip, port<br />\| count by response<br />\| top 10 response by \_count|
|Azure Web Apps|Top 10 Infected FIles Names|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceAntivirusScanAuditLogs"<br />\| json "Category", "Properties.ListOfInfectedFiles[\*]", "ResourceId" as category, ListOfInfectedFiles, resource\_id<br />\| where Category="AppServiceAntivirusScanAuditLogs"<br />\| extract field=ListOfInfectedFiles "(?\<InfectedFile\>\\w+)" multi<br />\| where InfectedFile != ""<br />\| count by InfectedFile<br />\| top 10 InfectedFile by InfectedFile|
|Azure Web Apps|Top 10 operations that caused the most errors|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}   provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| json "resultType", "operationName", "properties.statusMessage", "category"  as resultType, operationName, failureMessage, category<br />\| where category="Administrative" and resultType="Failure"<br />\| count as Count by resource\_name, operationname, failureMessage<br />\| order by Count <br />\| limit 10|
|Azure Web Apps|Top 10 Recent Scanning Error Messages|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceAntivirusScanAuditLogs"<br />\| json "Category", "Properties.ScanStatus", "Properties.ErrorMessage", "ResourceId" as category, scan\_status, error\_message, resource\_id<br />\| where Category="AppServiceAntivirusScanAuditLogs" and toLowerCase(scan\_status) matches "failed"<br />\| count by error\_message<br />\| top 10 error\_message by error\_message|
|Azure Web Apps|Top 10 Slowest Pages|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}"<br />\|avg(time\_taken) as AvgResTime by cs\_uri\_stem \| int(AvgResTime/1000) as AvgTimeInSec \| fields -avgrestime<br />\| sort by -AvgTimeInSec,+cs\_uri\_stem \| limit 10|
|Azure Web Apps|Top 10 Slowest Pages by Country|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\|where cs\_host matches "{{cs\_host}}" AND src\_user matches "{{src\_user}}" AND client\_ip matches "{{client\_ip}}"<br />\| if (isBlank(country\_name), "Unknown", country\_name) as country\_name<br />\|avg(time\_taken) as AvgResTime by cs\_uri\_stem ,country\_name\| int(AvgResTime/1000) as AvgTimeInSec \| fields -avgrestime<br />\| sort - AvgTimeInSec,+cs\_uri\_stem  \| limit 10|
|Azure Web Apps|Top 10 URL With Highest Server Bytes Received|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\|sum(cs\_bytes) as total\_bytes\_received, avg(cs\_bytes) as avg\_bytes\_received, max(cs\_bytes) as max\_bytes\_received, pct(cs\_bytes, 95) as pct95\_bytes\_received  by cs\_uri\_stem<br />\| sort by total\_bytes\_received desc <br />\| limit 10|
|Azure Web Apps|Top 10 URL With Highest Server Bytes Sent|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\|sum(sc\_bytes) as total\_bytes\_sent, avg(sc\_bytes) as avg\_bytes\_sent, max(sc\_bytes) as max\_bytes\_sent, pct(sc\_bytes, 95) as pct95\_bytes\_sent  by cs\_uri\_stem<br />\| sort by total\_bytes\_sent desc <br />\| limit 10|
|Azure Web Apps|Top 10 Web Apps - Data In|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=BytesReceived statistic=total \|  quantize using sum  \| sum by resource\_name, resource\_group \| topk(10, sum) \| eval \_value/(1024\*1024)|
|Azure Web Apps|Top 10 Web Apps - Data Out|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=BytesSent  statistic=total \|  quantize using sum  \| sum by resource\_name, resource\_group \| topk(10, sum) \| eval \_value/(1024\*1024)|
|Azure Web Apps|Top 10 Web Apps - IO Read Bytes/ Second|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoReadBytesPerSecond statistic=total \| topk(10, avg)|
|Azure Web Apps|Top 10 Web Apps - IO Write Bytes/ Second|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoWriteBytesPerSecond statistic =total \| topk(10,avg)|
|Azure Web Apps|Top 10 Web Apps - Maximum Connections|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Network|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=AppConnections statistic=maximum  \| quantize using max \| max by resource\_group, resource\_name\| topk(10, max)|
|Azure Web Apps|Top 10 Web Apps by Infected FIles Count|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceAntivirusScanAuditLogs"<br />\| json "Properties", "Category", "ResourceId" as properties, category, resource\_id<br />\| where Category="AppServiceAntivirusScanAuditLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\| sum(properties.NumberOfInfectedFiles) as NumberOfInfectedFiles by resource\_name<br />\| top 10 resource\_name by NumberOfInfectedFiles|
|Azure Web Apps|Top 10 Web Apps by Max Private Bytes [MB]|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=PrivateBytes  statistic=maximum \| quantize using max \| max by resource\_group, resource\_name  \|  topk(10, max) \| eval \_value/(1024\*1024)|
|Azure Web Apps|Top 10 Web Apps by Max Working Set Memory [MB]|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Memory|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=MemoryWorkingSet statistic=maximum \| quantize using max \| max by resource\_group, resource\_name  \|  topk(10, max) \| eval \_value/(1024\*1024)|
|Azure Web Apps|Top Clients IPs|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}"<br />\|count as Requests by client\_ip  \| sort -Requests \| limit 10|
|Azure Web Apps|Top Requested Documents|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\|where cs\_host matches "{{cs\_host}}" AND src\_user matches "{{src\_user}}" AND client\_ip matches "{{client\_ip}}"<br />\|count(\*) as requests by cs\_uri\_stem <br />\| sort by -requests, +cs\_uri\_stem \| limit 10<br />\| cs\_uri\_stem as request\_target<br />\| fields - cs\_uri\_stem|
|Azure Web Apps|Top Requested Documents by Country|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Content and Client Platform|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\|where cs\_host matches "{{cs\_host}}" AND src\_user matches "{{src\_user}}" AND client\_ip matches "{{client\_ip}}" <br />\| if (isBlank(country\_name), "Unknown", country\_name) as country\_name<br />\|count(\*) as requests by cs\_uri\_stem ,country\_name<br />\| sort - requests,+cs\_uri\_stem \| limit 10|
|Azure Web Apps|Total Files Scanned|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceAntivirusScanAuditLogs"<br />\| json "Properties.TotalFilesScanned", "Category", "ResourceId" as TotalFilesScanned, category, resource\_id<br />\| where Category="AppServiceAntivirusScanAuditLogs"<br />\| sum(TotalFilesScanned) as TotalFilesScanned|
|Azure Web Apps|Total Infected Files|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Antivirus Scan Audit|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceAntivirusScanAuditLogs"<br />\| json "Properties.NumberOfInfectedFiles", "Category", "ResourceId" as NumberOfInfectedFiles, category, resource\_id<br />\| where Category="AppServiceAntivirusScanAuditLogs"<br />\| sum(NumberOfInfectedFiles) as NumberOfInfectedFiles|
|Azure Web Apps|Total Recommendations|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Policy and Recommendations|tenant\_name={{tenant\_name}}<br />subscription\_id={{subscription\_id}}<br />resource\_group={{resource\_group}}<br />resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} provider\_name="MICROSOFT.WEB" resource\_type="SITES" Recommendation<br />\| JSON "category", "level", "resultSignature", <br />"properties.recommendationCategory", "properties.recommendationImpact", "properties.recommendationName", "recommendationResourceLink" as category,  level, resultSignature, recommendationCategory, recommendationImpact, recommendationName, recommendationResourceLink nodrop<br />\| where category="Recommendation" <br />\| count|
|Azure Web Apps|Traffic Over Time|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice 5m<br />\|count by \_timeslice|
|Azure Web Apps|Traffic Over Time|Logs|Azure Web Apps/Azure Web Apps - Overview - New|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice 5m<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\|count by \_timeslice|
|Azure Web Apps|Traffic Over Time (Outlier)|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice 5m<br />\|count by \_timeslice<br />\| outlier \_count|
|Azure Web Apps|Traffic Over Time (Outlier)|Logs|Azure Web Apps/Azure Web Apps - Overview - New|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice 1m<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}")<br />\|count by \_timeslice<br />\| outlier \_count|
|Azure Web Apps|Traffic Over Time (Outlier)|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| timeslice 1m<br />\|count by \_timeslice<br />\| outlier \_count|
|Azure Web Apps|US Visits by State|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| lookup longitude,latitude,country\_name,region,city from geo://location on ip=client\_ip<br />\| where country\_name matches "United States"<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}" AND sc\_status matches "{{sc\_status}}" AND !isNull(latitude)<br />\|count as Count by longitude,latitude,region,city|
|Azure Web Apps|Users / Applications by Operation type|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Administrative Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name={{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}} Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid" as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid nodrop<br />\| where resultType in ("Accept", "Success") and category="Administrative"<br />\| if (idtyp =="user", name, appid) as name<br />\| "Others" as operationType<br />\| if (toUppercase(operationName) matches /WRITE/, "WRITE", operationType) as operationType <br />\| if (toUppercase(operationName) matches /READ/, "READ", operationType) as operationType <br />\| if (toUppercase(operationName) matches /DELETE/, "DELETE", operationType) as operationType <br />\| count by name, operationType<br />\| transpose row name column operationType|
|Azure Web Apps|Visits by Allowed Source IPs|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceIPSecAuditLogs"<br />\| json "Properties.CIp", "Properties.Result", "Category", "ResourceId" as client\_ip, result, category, resource\_id<br />\| where Category="AppServiceIPSecAuditLogs" and client\_ip matches "{{client\_ip}}"<br />\| where result matches "Allowed"<br />\| parse field=client\_ip "\*:\*" as client\_ip, port<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\|count by longitude,latitude,country\_name|
|Azure Web Apps|Visits by Country|Logs|Azure Web Apps/Azure Web Apps - Overview - New|\_sourceCategory = Labs/Azure/WebApp "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\|where if ("{{site\_name}}" = "\*", true, site\_name matches "{{site\_name}}") AND if ("{{cs\_host}}" = "\*", true, cs\_host matches "{{cs\_host}}")<br />\|count by longitude,latitude,country\_name|
|Azure Web Apps|Visits by Country|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Traffic Insights|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceHTTPLogs"<br />\| json "properties", "category", "resourceId" as properties, category, resource\_id<br />\| where category = "AppServiceHTTPLogs"<br />\| parse field=resource\_id "\*/SITES/\*" as \_, site\_name<br />\|json field = properties  "UserAgent","ScStatus","CsUsername", "SPort", "CsMethod", "CsBytes", "CIp", "CsUriStem", "ScBytes","Referer","CsHost", "Cookie", "TimeTaken" as cs\_user\_agent, sc\_status, src\_user, src\_port, cs\_method, cs\_bytes, client\_ip, cs\_uri\_stem, sc\_bytes, cs\_referrer, cs\_host, cs\_cookie, time\_taken<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\|where cs\_host matches "{{cs\_host}}" AND client\_ip matches "{{client\_ip}}"  AND sc\_status matches "{{sc\_status}}" AND !isNull(latitude)<br />\|count as Count by longitude,latitude,country\_name|
|Azure Web Apps|Visits by Denied Source IPs|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - IP Restrictions|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} "AppServiceIPSecAuditLogs"<br />\| json "Properties.CIp", "Properties.Result", "Category", "ResourceId" as client\_ip, result, category, resource\_id<br />\| where Category="AppServiceIPSecAuditLogs" and client\_ip matches "{{client\_ip}}"<br />\| where result matches "Denied"<br />\| parse field=client\_ip "\*:\*" as client\_ip, port<br />\| lookup latitude,longitude,country\_name from geo://location on ip=client\_ip<br />\|count by longitude,latitude,country\_name|
|Azure Web Apps/Azure Web Apps - I|Web App Operations Statistics|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - I/O Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=IoOtherBytesPerSecond statistic=total \| avg by resource\_group, resource\_name|
|Azure Web Apps|Web App Statistics|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Server Operations|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=HttpResponseTime   statistic=average<br />\| quantize using avg<br />\| avg by resource\_name|
|Azure Web Apps|Web App Statistics|Metrics|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} location={{location}} resource\_group={{resource\_group}} provider\_name=microsoft.web resource\_type=sites  resource\_name={{resource\_name}} metric=HttpResponseTime   statistic=average<br />\| quantize using avg<br />\| avg by resource\_name|
|Azure Web Apps|Write and Delete Operations|Logs|Installed Apps/Azure Web Apps/Azure Web Apps - Overview|tenant\_name={{tenant\_name}} subscription\_id={{subscription\_id}} resource\_group = {{resource\_group}} resource\_name = {{resource\_name}}<br />provider\_name={{provider\_name}} resource\_type={{resource\_type}}  Administrative <br />\| JSON "properties.statusCode", "properties.message", "resultType", "category", "operationName", "callerIpAddress", "resultSignature", "level", "identity.claims.idtyp", "identity.claims.name", "identity.claims.appid", "\$['identity']['claims']['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']","\$['identity']['claims']['http://schemas.microsoft.com/claims/authnmethodsreferences']", "\$['identity']['claims']['http://schemas.microsoft.com/identity/claims/objectidentifier']"  as statusCode, message, resultType, category, operationName, callerIpAddress, resultSignature, level, idtyp, name, appid, identity\_claims\_name, authmethods, objectIdentifier nodrop<br />\| where resultType in ("Success","Accept") and category="Administrative" and toUppercase(operationName) matches /WRITE\|DELETE/<br />\| if (idtyp =="user", name, appid) as name<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss") as time<br />\| count by \_messageTime, time, resource\_name, callerIpAddress, name, objectIdentifier, identity\_claims\_name, authmethods, resultSignature, statusCode, message, resource\_group<br />\| sort by \_messageTime desc<br />\| limit 20 <br />\| fields -\_count,\_messageTime|

