# Squid Proxy - OpenTelemetry

## Searches

### Log Searches

- **4xx Status Codes by Server**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **5xx Status Codes by Server**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **Bytes Served**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Cacheable Content Response Time (ms)**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service 
- **Client Errors**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **Client Errors (HTTP Response) - Outlier**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **Denied Request Trend**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Denied Requests**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **Destination Experiencing avg response time more than 5 Seconds?**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service 
- **Destination Locations**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **HTTP Method**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **HTTP Response**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **HTTP Response Trend**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **Non 2xx Response actions**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Overall Content Response Time (ms)**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service 
- **Recent Denied Requests**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Redirections**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **Redirections (HTTP Response) - Outlier**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **Remote Hosts Traffic by Requests**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Remote Hosts Traffic by Requests**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Request Trend by Squid Action**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Response Time For TCP_DENIED Action (ms)?**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service 
- **Response Time For TCP_MISS Action (ms)?**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service 
- **Response Time For TCP_TUNNEL Action (ms)**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service 
- **Server Errors**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **Server Errors (HTTP Response) - Outlier**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **Success (2xx) Response Actions**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Time Spent to Serve Request**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend 
- **Top 10 URLs with 4XX Errors**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **Top 10 URLs with 5xx Errors**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **Top Access Denied URLs**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **Top Destination**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **Top Remote Hosts**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **Top URLs Accessed**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview 
- **URLs Experiencing Client Errors**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **URLs Experiencing Redirections**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis 
- **URLs Experiencing Server Errors**: from Dashboard: Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Squid Proxy - OpenTelemetry|4xx Status Codes by Server|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}}  webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| count as count by status\_code,host.name,webengine.cluster.name<br />|
|Squid Proxy - OpenTelemetry|5xx Status Codes by Server|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}}  webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| count as count by status\_code,host.name,webengine.cluster.name<br />|
|Squid Proxy - OpenTelemetry|Bytes Served|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message  nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !isEmpty(method)<br />\| sum(bytes) as %"BytesServed" by method<br />\| sort by %"BytesServed", method asc|
|Squid Proxy - OpenTelemetry|Cacheable Content Response Time (ms)|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*\_HIT" or action matches "\*\_MISS"<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy - OpenTelemetry|Client Errors|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| count as eventCount by status\_code<br />\| sort by eventCount|
|Squid Proxy - OpenTelemetry|Client Errors (HTTP Response) - Outlier|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| timeslice 15m <br />\| count as clientErrors by \_timeslice <br />\| outlier clientErrors|
|Squid Proxy - OpenTelemetry|Denied Request Trend|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy \*DENIED\*<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*DENIED\*"<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice|
|Squid Proxy - OpenTelemetry|Denied Requests|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} webengine.system=squidproxy \*DENIED\*<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*DENIED\*"<br />\| count as %"DeniedRequests"|
|Squid Proxy - OpenTelemetry|Destination Experiencing avg response time more than 5 Seconds?|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| lookup latitude, longitude from geo://location on ip=peerhost<br />\| avg (elapsed) as avg\_elapsed by latitude, longitude <br />\| round(avg\_elapsed)<br />\| avg\_elapsed/1000 as avg\_elapsed<br />\| where  avg\_elapsed\> 0<br />\| sort by -  avg\_elapsed <br />\| where !isNull(latitude)<br />|
|Squid Proxy - OpenTelemetry|Destination Locations|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| peerhost as dest\_ip<br />\| count by dest\_ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = dest\_ip<br />\| where !isNull(latitude)<br />\| sum(\_count) as \_count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort by \_count|
|Squid Proxy - OpenTelemetry|HTTP Method|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name=\* webengine.system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests" by method<br />\| where !isEmpty(method)<br />\| sort %"Requests", method asc|
|Squid Proxy - OpenTelemetry|HTTP Response|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !isEmpty(status\_code)<br />\| "" as status\_code\_type<br />\| if(status\_code matches "2\*", "successes", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "3\*", "redirections", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "4\*", "clientErrors", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "5\*", "serverErrors", status\_code\_type) as status\_code\_type <br />\| where status\_code\_type \<\> ""<br />\| count as eventCount by status\_code\_type<br />\| sort by eventCount|
|Squid Proxy - OpenTelemetry|HTTP Response Trend|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !isEmpty(status\_code)<br />\| "" as status\_code\_type<br />\| if(status\_code matches "2\*", "successes", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "3\*", "redirections", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "4\*", "clientErrors", status\_code\_type) as status\_code\_type<br />\| if(status\_code matches "5\*", "serverErrors", status\_code\_type) as status\_code\_type <br />\| where status\_code\_type \<\> ""<br />\| timeslice 15m<br />\| count as eventCount by \_timeslice, status\_code\_type<br />\| transpose row \_timeslice column status\_code\_type|
|Squid Proxy - OpenTelemetry|Non 2xx Response actions|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !(status\_code matches "2\*") and !isEmpty(status\_code)<br />\| timeslice 1h<br />\| count by \_timeslice, action, status\_code<br />\| transpose row \_timeslice column action, status\_code|
|Squid Proxy - OpenTelemetry|Overall Content Response Time (ms)|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy - OpenTelemetry|Recent Denied Requests|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy \*DENIED\*<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| peerhost as dest\_ip<br />\| where action matches "\*DENIED\*"<br />\| timeslice 1s<br />\| count as eventCount by \_timeslice, remotehost, method, peerstatus, dest\_ip, type, action, status\_code, url<br />\| sort by \_timeslice|
|Squid Proxy - OpenTelemetry|Redirections|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "3\*"<br />\| count as eventCount by status\_code<br />\| sort by eventCount|
|Squid Proxy - OpenTelemetry|Redirections (HTTP Response) - Outlier|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "3\*"<br />\| timeslice 15m <br />\| count as redirections by \_timeslice <br />\| outlier redirections|
|Squid Proxy - OpenTelemetry|Remote Hosts Traffic by Requests|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests", sum(bytes) as bytes by remotehost<br />\| bytes / (1024 \* 1024) as MegaBytes<br />\| where !isEmpty(remotehost)<br />\| total %"MegaBytes" as total\_MegaBytes<br />\| total %"Requests" as %"Total\_Requests"<br />\| %"MegaBytes"/total\_MegaBytes\*100 as %"% Total MegaBytes"<br />\| %"Requests"/%"Total\_Requests"\*100 as %"% Total\_Requests"<br />\| sort by %"% Total\_Requests"<br />\| fields remotehost, %"Requests", %"% Total\_Requests", %"MegaBytes", %"% Total MegaBytes"|
|Squid Proxy - OpenTelemetry|Remote Hosts Traffic by Requests|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests", sum(bytes) as bytes by remotehost<br />\| bytes / (1024 \* 1024) as MegaBytes<br />\| where !isEmpty(remotehost)<br />\| total %"MegaBytes" as total\_MegaBytes<br />\| total %"Requests" as %"Total\_Requests"<br />\| %"MegaBytes"/total\_MegaBytes\*100 as %"% Total MegaBytes"<br />\| %"Requests"/%"Total\_Requests"\*100 as %"% Total\_Requests"<br />\| sort by %"% Total\_Requests"<br />\| fields remotehost, %"Requests", %"% Total\_Requests", %"MegaBytes", %"% Total MegaBytes"|
|Squid Proxy - OpenTelemetry|Request Trend by Squid Action|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| timeslice 1h<br />\| count as %"Requests" by \_timeslice, action<br />\| transpose row \_timeslice column action|
|Squid Proxy - OpenTelemetry|Response Time For TCP\_DENIED Action (ms)?|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "TCP\_DENIED"<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy - OpenTelemetry|Response Time For TCP\_MISS Action (ms)?|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "TCP\_MISS"<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy - OpenTelemetry|Response Time For TCP\_TUNNEL Action (ms)|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Quality of Service|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*\_TUNNEL"<br />\| 100 as bucket\_size // use 0.1 second as the bucket size<br />\| floor(elapsed/bucket\_size)\*bucket\_size as response\_time<br />\| format("%.0f-%.0f",floor(elapsed/bucket\_size)\*bucket\_size,ceil(elapsed/bucket\_size)\*bucket\_size) as response\_time\_str<br />\| if (response\_time \> 10\*bucket\_size, format("\>%.0f",10\*bucket\_size),response\_time\_str) as response\_time<br />\| count as requests by response\_time <br />\| sort by + response\_time|
|Squid Proxy - OpenTelemetry|Server Errors|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| count as eventCount by status\_code<br />\| sort by eventCount|
|Squid Proxy - OpenTelemetry|Server Errors (HTTP Response) - Outlier|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| timeslice 15m <br />\| count as serverErrors by \_timeslice <br />\| outlier serverErrors|
|Squid Proxy - OpenTelemetry|Success (2xx) Response Actions|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "2\*"<br />\| timeslice 1h<br />\| count by \_timeslice, action, status\_code<br />\| transpose row \_timeslice column action, status\_code|
|Squid Proxy - OpenTelemetry|Time Spent to Serve Request|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Activity Trend|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where !isEmpty(method)<br />\| avg(elapsed) as TimeSpent by method<br />\| TimeSpent / 1000 as %"AvgTimeSpentInSec"<br />\| fields - TimeSpent<br />\| sort by %"AvgTimeSpentInSec"|
|Squid Proxy - OpenTelemetry|Top 10 URLs with 4XX Errors|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}}  webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by eventCount, url asc \| limit 10|
|Squid Proxy - OpenTelemetry|Top 10 URLs with 5xx Errors|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}}  webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by eventCount, url asc \| limit 10|
|Squid Proxy - OpenTelemetry|Top Access Denied URLs|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} webengine.system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where action matches "\*\_DENIED"<br />\| count as %"Requests" by url<br />\| where !isEmpty(url)<br />\| top 10 url by %"Requests", url asc<br />\| urldecode(url) as url|
|Squid Proxy - OpenTelemetry|Top Destination|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} webengine.system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| peerhost as dest\_ip<br />\| count as %"Requests" by dest\_ip<br />\| where !isEmpty(dest\_ip)<br />\| Top 10 dest\_ip by %"Requests"|
|Squid Proxy - OpenTelemetry|Top Remote Hosts|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} webengine.system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests" by remotehost<br />\| where !isEmpty(remotehost)<br />\| top 10 remotehost by %"Requests"|
|Squid Proxy - OpenTelemetry|Top URLs Accessed|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - Overview|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} webengine.system=squidproxy<br />\| json "message" nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[\\w]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| count as %"Requests" by url<br />\| where !isEmpty(url)<br />\| top 10 url by %"Requests", url asc<br />\| urldecode(url) as url|
|Squid Proxy - OpenTelemetry|URLs Experiencing Client Errors|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "4\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by status\_code, eventCount, url|
|Squid Proxy - OpenTelemetry|URLs Experiencing Redirections|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "3\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by status\_code, eventCount, url|
|Squid Proxy - OpenTelemetry|URLs Experiencing Server Errors|Logs|Installed Apps/Squid Proxy - OpenTelemetry/Squid Proxy - HTTP Response Analysis|sumo.datasource=squidproxy webengine.cluster.name={{webengine.cluster.name}} host.name={{host.name}} webengine.system=squidproxy<br />\| json "log" as message nodrop <br />\| if (isEMpty(message), \_raw, message) as message<br />\| parse regex field = message "(?\<time\>[\\d.]+)\\s+(?\<elapsed\>[\\d]+)\\s+(?\<remotehost\>[^\\s]+)\\s+(?\<action\>[^/]+)/(?\<status\_code\>[\\d]+)\\s+(?\<bytes\>[\\d]+)\\s+(?\<method\>[^\\s]+)\\s+(?\<url\>[^\\s]+)\\s(?\<rfc931\>[^\\s]+)\\s+(?\<peerstatus\>[^/]+)/(?\<peerhost\>[^\\s]+)\\s+(?\<type\>[^\\s\|\$]+?)(?:\\s+\|\$)" nodrop \| parse field = message "Connection: \*\\\\r\\\\n" as connection\_status nodrop \| parse field = message "Host: \*\\\\r\\\\n" as host nodrop \| parse field = message "User-Agent: \*\\\\r\\\\n" as user\_agent nodrop \| parse field = message "TE: \*\\\\r\\\\n" as te nodrop<br />\| where status\_code matches "5\*"<br />\| count as eventCount by url, status\_Code<br />\| sort by status\_code, eventCount, url|

