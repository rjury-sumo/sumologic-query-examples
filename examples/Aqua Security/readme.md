# Aqua Security
## Sumo Logic App For: Aqua Security
The Aqua Security App for Sumo Logic provides users with a holistic cyber-security monitoring and forensics solution for containerized and cloud native environments.
Docs Link: [Aqua Security](https://github.com/aquasecurity/Sumo-Logic-App/)

## Searches

### Log Searches

- **Failed Docker CIS**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Failed Docker CIS**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Failed Kube CIS**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Failed Kube CIS**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Failed Linux CIS**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Failed Linux CIS**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Host Assurance**: from Dashboard: Aqua Security/Aqua Security - Host Security and Compliance 
- **Host Assurance**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Host Security and Compliance 
- **Images failed by malware**: from Dashboard: Aqua Security/Aqua Security - Image Security and Compliance 
- **Images failed by malware**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Image Security and Compliance 
- **Images failed by severe CVE**: from Dashboard: Aqua Security/Aqua Security - Image Security and Compliance 
- **Images failed by severe CVE**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Image Security and Compliance 
- **Infected Images**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Infected Images**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Network Security Events by Pod**: from Dashboard: Aqua Security/Aqua Security - Runtime Events 
- **Network Security Events by Pod**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Runtime Events 
- **Non-compliant Images List**: from Dashboard: Aqua Security/Aqua Security - Image Security and Compliance 
- **Non-compliant Images List**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Image Security and Compliance 
- **Noncompliant Hosts**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Noncompliant Hosts**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Noncompliant Images**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Noncompliant Images**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Runtime Events**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Runtime Events**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Severe Vulnerabilities**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Severe Vulnerabilities**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Unauthorized File Activity**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Unauthorized File Activity**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Runtime Events 
- **Unauthorized File Activity**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Unauthorized File Activity**: from Dashboard: Aqua Security/Aqua Security - Runtime Events 
- **Unauthorized Image Activity**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Unauthorized Image Activity**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview 
- **Unauthorized Image Starts**: from Dashboard: Aqua Security/Aqua Security - Runtime Events 
- **Unauthorized Image Starts**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Runtime Events 
- **Unauthorized Network Activity**: from Dashboard: Aqua Security/Aqua Security - Overview 
- **Unauthorized Network Activity**: from Dashboard: Installed Apps/Aqua Security/Aqua Security - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Aqua Security|Failed Docker CIS|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} docker\_cis<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name" nodrop<br />\| where controls contains "docker\_cis" <br />\| count\_distinct(image) by image|
|Aqua Security|Failed Docker CIS|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua docker\_cis<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name" nodrop<br />\| where controls contains "docker\_cis" <br />\| count\_distinct(image) by image|
|Aqua Security|Failed Kube CIS|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} kube\_cis<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name" nodrop<br />\| where controls contains "kube\_cis" <br />\| count\_distinct(image) by image|
|Aqua Security|Failed Kube CIS|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua kube\_cis<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name" nodrop<br />\| where controls contains "kube\_cis" <br />\| count\_distinct(image) by image|
|Aqua Security|Failed Linux CIS|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} linux\_cis<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name" nodrop<br />\| where controls contains "linux\_cis" <br />\| count\_distinct(image) by image|
|Aqua Security|Failed Linux CIS|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua linux\_cis<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name" nodrop<br />\| where controls contains "linux\_cis" <br />\| count\_distinct(image) by image|
|Aqua Security|Host Assurance|Logs|Aqua Security/Aqua Security - Host Security and Compliance|\_sourceCategory = Labs/Aqua "policy.failure" "host.policy"<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "reason", "containerid", "resource", "data", "user" nodrop<br />\| json "image" as host nodrop<br />\| json field=data "controls", "policy\_id", "policy\_name", "blocking" nodrop<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "host.policy"<br />\| parse regex field=controls "\\"(?\<control\>.+?)\\"" multi<br />\| count\_distinct(host) as distinct\_hosts by host, control<br />\| sort by host|
|Aqua Security|Host Assurance|Logs|Installed Apps/Aqua Security/Aqua Security - Host Security and Compliance|\_sourceCategory={{\_sourceCategory}} "policy.failure" "host.policy"<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "reason", "containerid", "resource", "data", "user" nodrop<br />\| json "image" as host nodrop<br />\| json field=data "controls", "policy\_id", "policy\_name", "blocking" nodrop<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "host.policy"<br />\| parse regex field=controls "\\"(?\<control\>.+?)\\"" multi<br />\| count\_distinct(host) as distinct\_hosts by host, control<br />\| sort by host|
|Aqua Security|Images failed by malware|Logs|Aqua Security/Aqua Security - Image Security and Compliance|\_sourceCategory = Labs/Aqua malware "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "image", "category", "action", "podnamespace", "poddeployment", "reason", "containerid", "resource", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "policy\_name", "blocking" nodrop<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy" and controls contains "malware"<br />\| count\_distinct(image) as distinct\_images by image |
|Aqua Security|Images failed by malware|Logs|Installed Apps/Aqua Security/Aqua Security - Image Security and Compliance|\_sourceCategory={{\_sourceCategory}} malware "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "image", "category", "action", "podnamespace", "poddeployment", "reason", "containerid", "resource", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "policy\_name", "blocking" nodrop<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy" and controls contains "malware"<br />\| count\_distinct(image) as distinct\_images by image |
|Aqua Security|Images failed by severe CVE|Logs|Aqua Security/Aqua Security - Image Security and Compliance|\_sourceCategory = Labs/Aqua max\_severity "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "image", "category", "action", "podnamespace", "poddeployment", "reason", "containerid", "resource", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "policy\_name", "blocking" nodrop<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy" and controls contains "max\_severity"<br />\| count\_distinct(image) as distinct\_images by image |
|Aqua Security|Images failed by severe CVE|Logs|Installed Apps/Aqua Security/Aqua Security - Image Security and Compliance|\_sourceCategory={{\_sourceCategory}} max\_severity "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "image", "category", "action", "podnamespace", "poddeployment", "reason", "containerid", "resource", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "policy\_name", "blocking" nodrop<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy" and controls contains "max\_severity"<br />\| count\_distinct(image) as distinct\_images by image |
|Aqua Security|Infected Images|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} malware "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name"<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy"<br />\| count\_distinct(image) by image|
|Aqua Security|Infected Images|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua malware "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name"<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy"<br />\| count\_distinct(image) by image|
|Aqua Security|Network Security Events by Pod|Logs|Aqua Security/Aqua Security - Runtime Events|\_sourceCategory = Labs/Aqua "access.control" network<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "reason", "containerid", "resource" nodrop<br />\| where rule\_type = "access.control" and category = "network"<br />\| count by poddeployment, podnamespace |
|Aqua Security|Network Security Events by Pod|Logs|Installed Apps/Aqua Security/Aqua Security - Runtime Events|\_sourceCategory={{\_sourceCategory}} "access.control" network<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "reason", "containerid", "resource" nodrop<br />\| where rule\_type = "access.control" and category = "network"<br />\| count by poddeployment, podnamespace |
|Aqua Security|Non-compliant Images List|Logs|Aqua Security/Aqua Security - Image Security and Compliance|\_sourceCategory = Labs/Aqua "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "image", "category", "action", "podnamespace", "poddeployment", "reason", "containerid", "resource", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "policy\_name", "blocking" nodrop<br />\| parse regex field=controls "\\"(?\<control\>.+?)\\"" multi<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy"<br />\| count\_distinct(image) as distinct\_images by image, control<br />\| sort by image|
|Aqua Security|Non-compliant Images List|Logs|Installed Apps/Aqua Security/Aqua Security - Image Security and Compliance|\_sourceCategory={{\_sourceCategory}} "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "image", "category", "action", "podnamespace", "poddeployment", "reason", "containerid", "resource", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "policy\_name", "blocking" nodrop<br />\| parse regex field=controls "\\"(?\<control\>.+?)\\"" multi<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy"<br />\| count\_distinct(image) as distinct\_images by image, control<br />\| sort by image|
|Aqua Security|Noncompliant Hosts|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua alert "policy.failure" "host.policy"<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name" nodrop<br />\| toLowerCase(user) as policy<br />\| where type = "alert" and action = "policy.failure" and policy = "host.policy" and result \> 1 <br />\| count\_distinct(image)|
|Aqua Security|Noncompliant Hosts|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} alert "policy.failure" "host.policy"<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name" nodrop<br />\| toLowerCase(user) as policy<br />\| where type = "alert" and action = "policy.failure" and policy = "host.policy" and result \> 1 <br />\| count\_distinct(image)|
|Aqua Security|Noncompliant Images|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} alert "policy.failure" image<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data" nodrop<br />\| json field=data "blocking"<br />\| where type = "alert" and action = "policy.failure" and category="image" and result \> 1 <br />\| count\_distinct(image, blocking)|
|Aqua Security|Noncompliant Images|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua alert "policy.failure" image<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data" nodrop<br />\| json field=data "blocking"<br />\| where type = "alert" and action = "policy.failure" and category="image" and result \> 1 <br />\| count\_distinct(image, blocking)|
|Aqua Security|Runtime Events|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua "runtime.policy" ("\\"result\\":2" or "\\"result\\":3")<br />\| json "rule\_type", "result", "category" nodrop<br />\| where rule\_type = "runtime.policy" and (result=2 or result=3) <br />\| timeslice 1h<br />\| count by \_timeslice|
|Aqua Security|Runtime Events|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} "runtime.policy" ("\\"result\\":2" or "\\"result\\":3")<br />\| json "rule\_type", "result", "category" nodrop<br />\| where rule\_type = "runtime.policy" and (result=2 or result=3) <br />\| timeslice 1h<br />\| count by \_timeslice|
|Aqua Security|Severe Vulnerabilities|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua max\_severity "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name"<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy" and controls contains "max\_severity"<br />\| count\_distinct(image)|
|Aqua Security|Severe Vulnerabilities|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} max\_severity "policy.failure" "image.policy"<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "type", "data", "user" nodrop<br />\| json field=data "controls", "policy\_id", "blocking", "policy\_name"<br />\| toLowerCase(action) as action\_f \| toLowerCase(user) as user\_f <br />\| where action\_f = "policy.failure" and user\_f = "image.policy" and controls contains "max\_severity"<br />\| count\_distinct(image)|
|Aqua Security|Unauthorized File Activity|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} "runtime.policy" file ("\\"result\\":2" or "\\"result\\":3")<br />\| json "rule\_type", "result" , "category", "action" nodrop<br />\| where rule\_type = "runtime.policy" and category = "file" and (result = 2 or result = 3) <br />\| count|
|Aqua Security|Unauthorized File Activity|Logs|Installed Apps/Aqua Security/Aqua Security - Runtime Events|\_sourceCategory={{\_sourceCategory}} "runtime.policy" file ("\\"result\\":2" or "\\"result\\":3")<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "reason", "containerid", "resource" nodrop<br />\| where rule\_type = "runtime.policy" and category = "file" and (result = 2 or result = 3) <br />\| count by podnamespace, poddeployment, action, resource|
|Aqua Security|Unauthorized File Activity|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua "runtime.policy" file ("\\"result\\":2" or "\\"result\\":3")<br />\| json "rule\_type", "result" , "category", "action" nodrop<br />\| where rule\_type = "runtime.policy" and category = "file" and (result = 2 or result = 3) <br />\| count|
|Aqua Security|Unauthorized File Activity|Logs|Aqua Security/Aqua Security - Runtime Events|\_sourceCategory = Labs/Aqua "runtime.policy" file ("\\"result\\":2" or "\\"result\\":3")<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "reason", "containerid", "resource" nodrop<br />\| where rule\_type = "runtime.policy" and category = "file" and (result = 2 or result = 3) <br />\| count by podnamespace, poddeployment, action, resource|
|Aqua Security|Unauthorized Image Activity|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua container<br />\| json "rule\_type", "result" , "category" nodrop<br />\| where category = "container" and result \> 1 <br />\| count|
|Aqua Security|Unauthorized Image Activity|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} container<br />\| json "rule\_type", "result" , "category" nodrop<br />\| where category = "container" and result \> 1 <br />\| count|
|Aqua Security|Unauthorized Image Starts|Logs|Aqua Security/Aqua Security - Runtime Events|\_sourceCategory = Labs/Aqua container<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "reason", "containerid", "resource" nodrop<br />\| where category = "container" and result \> 1 <br />\| count by podnamespace, poddeployment, reason|
|Aqua Security|Unauthorized Image Starts|Logs|Installed Apps/Aqua Security/Aqua Security - Runtime Events|\_sourceCategory={{\_sourceCategory}} container<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment", "image", "reason", "containerid", "resource" nodrop<br />\| where category = "container" and result \> 1 <br />\| count by podnamespace, poddeployment, reason|
|Aqua Security|Unauthorized Network Activity|Logs|Aqua Security/Aqua Security - Overview|\_sourceCategory = Labs/Aqua "access.control" network<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment" nodrop<br />\| where rule\_type = "access.control" and category = "network"<br />\| count|
|Aqua Security|Unauthorized Network Activity|Logs|Installed Apps/Aqua Security/Aqua Security - Overview|\_sourceCategory={{\_sourceCategory}} "access.control" network<br />\| json "rule\_type", "result", "category", "action", "podnamespace", "poddeployment" nodrop<br />\| where rule\_type = "access.control" and category = "network"<br />\| count|

