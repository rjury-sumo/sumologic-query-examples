# F5 - BIG-IP - LTM

## Searches

### Log Searches

- **Applications**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview 
- **Attack Summary**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **Attacks Detected**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **Bytes (MB) Out by Host**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections 
- **Bytes(MB) IN - Outlier**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis 
- **Bytes(MB) IN by Host**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections 
- **F5 - BIG-IP LTM - User Session**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **Geo Location of Attacks**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview 
- **Geo Location of User Session**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview 
- **Login Events Over Time**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **Login Request - Outlier**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis 
- **Number of Session IDs by Users**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **OS Breakdown**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **Packets In by Host**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections 
- **Packets Out - Outlier Analysis**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis 
- **Packets Out by Host**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections 
- **Pool Status**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview 
- **Severity Levels of Violations**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **TCP Connections - Outlier**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis 
- **TCP Connections by Host**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections 
- **Threat Breakdown by Sources**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis 
- **Threat by Actor**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis 
- **Threat by Geo Location**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis 
- **Threat Count**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis 
- **Threat Table**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis 
- **Threats by Malicious Confidence**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis 
- **TMM CPU Usage**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections 
- **TMM CPU Usage  - Outlier**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis 
- **TMM Memory Usage - Outlier**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis 
- **TMM Memory Usage by Host**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections 
- **Top 20 Pools**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview 
- **Total TCP Connections**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections 
- **Users By Application Profile**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **Violations Triggered**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session 
- **Violations Triggered by Hosts**: from Dashboard: Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|F5 - BIG-IP - LTM|Applications|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview|\_sourceCategory={{Logsdatasource}}   systemInfo<br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| json field=\_raw "virtualServers"<br />\| parse regex field=virtualServers "name\\"\\:\\"(?\<virtualServer\_name\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "enabledState\\"\\:\\"(?\<enabledState\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "application\\"\\:\\"(?\<application\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "availabilityState\\"\\:\\"(?\<availabilityState\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "tenant\\"\\:\\"(?\<tenant\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "pool\\"\\:\\"(?\<pool\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "destination\\"\\:\\"(?\<destination\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "clientside.curConns\\"\\:(?\<current\_connections\>[\\S]+?)\\," multi<br />\| parse regex field=virtualServers "clientside.bitsOut\\"\\:(?\<client\_bits\_out\>[\\S]+?)\\," multi<br />\| count by application<br />\| fields - \_count<br /><br />|
|F5 - BIG-IP - LTM|Attack Summary|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| where attack\_type !="N/A"<br />\| count by attack\_type, username, geo\_location, ip\_client, violations,severity<br />\| sort by \_count |
|F5 - BIG-IP - LTM|Attacks Detected|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| where attack\_type !="N/A"<br />\| count by attack\_type<br />\| sort by \_count |
|F5 - BIG-IP - LTM|Bytes (MB) Out by Host|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections|\_sourceCategory={{Logsdatasource}} <br />\| json "system.hostname" as host<br />\| json field=\_raw "\$['system']['tmmTraffic']['clientSideTraffic.bitsOut']" as clientside\_bits\_out<br />\| (clientside\_bits\_out / 8) / 1Ki / 1Mi as clientside\_Mbytes\_out<br />\| timeslice 1h<br />\| sum( clientside\_Mbytes\_out ) by \_timeslice, host<br />\| transpose row \_timeslice column host|
|F5 - BIG-IP - LTM|Bytes(MB) IN - Outlier|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis|\_sourceCategory={{Logsdatasource}}  <br />\| json "system.hostname" as host<br />\| json field=\_raw "\$['system']['tmmTraffic']['clientSideTraffic.bitsIn']" as clientside\_bits\_in<br />\| (clientside\_bits\_in / 8) / 1Ki / 1Mi as clientside\_Mbytes\_in<br />\| timeslice 1h<br />\| sum( clientside\_Mbytes\_in ) by \_timeslice<br />\| outlier \_sum window=10,threshold=2,consecutive=2,direction=+ |
|F5 - BIG-IP - LTM|Bytes(MB) IN by Host|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections|\_sourceCategory={{Logsdatasource}} <br />\| json "system.hostname" as host<br />\| json field=\_raw "\$['system']['tmmTraffic']['clientSideTraffic.bitsIn']" as clientside\_bits\_in<br />\| (clientside\_bits\_in / 8) / 1Ki / 1Mi as clientside\_Mbytes\_in<br />\| timeslice 1h<br />\| sum( clientside\_Mbytes\_in ) by \_timeslice, host<br />\| transpose row \_timeslice column host|
|F5 - BIG-IP - LTM|F5 - BIG-IP LTM - User Session|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip\_client<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code,username|
|F5 - BIG-IP - LTM|Geo Location of Attacks|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| where violations !="N/A"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip\_client<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code|
|F5 - BIG-IP - LTM|Geo Location of User Session|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = ip\_client<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code,username|
|F5 - BIG-IP - LTM|Login Events Over Time|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| timeslice 5m<br />\| count\_distinct (session\_id) by \_timeslice|
|F5 - BIG-IP - LTM|Login Request - Outlier|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis|\_sourceCategory={{Logsdatasource}}    <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| timeslice 1h<br />\| count\_distinct (session\_id) as login\_count by \_timeslice<br />\| fillmissing timeslice(1h)<br />\| outlier login\_count window=10,threshold=2,consecutive=2,direction=+ |
|F5 - BIG-IP - LTM|Number of Session IDs by Users|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| count\_distinct( session\_id) group by username<br />\| sort by \_count\_distinct<br />\| limit 10|
|F5 - BIG-IP - LTM|OS Breakdown|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count type<br />\| sort by \_count|
|F5 - BIG-IP - LTM|Packets In by Host|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections|\_sourceCategory={{Logsdatasource}} <br />\| json "system.hostname" as host<br />\| json field=\_raw "\$['system']['tmmTraffic']['clientSideTraffic.bitsIn']" as clientside\_pkts\_in<br />\| timeslice 1h <br />\| sum( clientside\_pkts\_in ) by \_timeslice, host<br />\| transpose row \_timeslice column host|
|F5 - BIG-IP - LTM|Packets Out - Outlier Analysis|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis|\_sourceCategory={{Logsdatasource}}  <br />\| json "system.hostname" as host<br />\| json field=\_raw "\$['system']['tmmTraffic']['clientSideTraffic.bitsOut']" as clientside\_pkts\_out<br />\| timeslice 1h<br />\| sum( clientside\_pkts\_out ) by \_timeslice<br />\| outlier \_sum window=10,threshold=2,consecutive=2,direction=+|
|F5 - BIG-IP - LTM|Packets Out by Host|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections|\_sourceCategory={{Logsdatasource}} <br />\| json "system.hostname" as host<br />\| json field=\_raw "\$['system']['tmmTraffic']['clientSideTraffic.bitsOut']" as clientside\_pkts\_out<br />\| timeslice 1h <br />\| sum( clientside\_pkts\_out ) by \_timeslice, host<br />\| transpose row \_timeslice column host|
|F5 - BIG-IP - LTM|Pool Status|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview|\_sourceCategory={{Logsdatasource}}   systemInfo<br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| json field=\_raw "virtualServers"<br />\| parse regex field=virtualServers "name\\"\\:\\"(?\<virtualServer\_name\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "enabledState\\"\\:\\"(?\<enabledState\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "application\\"\\:\\"(?\<application\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "availabilityState\\"\\:\\"(?\<availabilityState\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "tenant\\"\\:\\"(?\<tenant\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "pool\\"\\:\\"(?\<pool\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "destination\\"\\:\\"(?\<destination\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "clientside.curConns\\"\\:(?\<current\_connections\>[\\S]+?)\\," multi<br />\| parse regex field=virtualServers "clientside.bitsOut\\"\\:(?\<client\_bits\_out\>[\\S]+?)\\," multi<br />\| count by virtualServer\_name, pool, application, enabledState, availabilityState<br />|
|F5 - BIG-IP - LTM|Severity Levels of Violations|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| count by severity<br />\| sort by \_count |
|F5 - BIG-IP - LTM|TCP Connections - Outlier|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="systemInfo"<br />\| json field=\_raw "virtualServers"<br />\| parse regex field=virtualServers "name\\"\\:\\"(?\<virtualServer\_name\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "clientside.curConns\\"\\:(?\<clientside\_cur\_conns\>[\\S]+?)\\," multi<br />\| timeslice 1h<br />\| sum( clientside\_cur\_conns ) by \_timeslice<br />\| outlier \_sum window=10,threshold=2,consecutive=2,direction=+ |
|F5 - BIG-IP - LTM|TCP Connections by Host|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "telemetryEventCategory" , "system.hostname"  as telemetryEventCategory, host<br />\| where telemetryEventCategory="systemInfo"<br />\| json field=\_raw "virtualServers"<br />\| parse regex field=virtualServers "name\\"\\:\\"(?\<virtualServer\_name\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "clientside.curConns\\"\\:(?\<clientside\_cur\_conns\>[\\S]+?)\\," multi<br />\| timeslice 1h<br />\| sum( clientside\_cur\_conns ) by \_timeslice, host<br />\| transpose row \_timeslice column host|
|F5 - BIG-IP - LTM|Threat Breakdown by Sources|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="LTM"<br />\| json  "application", "tenant", "virtual\_name", "http\_uri", "http\_method", "client\_ip", "hostname"<br />\| count as ip\_count by client\_ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_source |
|F5 - BIG-IP - LTM|Threat by Actor|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="LTM"<br />\| json  "application", "tenant", "virtual\_name", "http\_uri", "http\_method", "client\_ip", "hostname"<br />\| count as ip\_count by client\_ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by Actor|
|F5 - BIG-IP - LTM|Threat by Geo Location|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="LTM"<br />\| json  "application", "tenant", "virtual\_name", "http\_uri", "http\_method", "client\_ip", "hostname"<br />\| count as ip\_count by client\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = client\_ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code, malicious\_confidence<br />\| sort \_count|
|F5 - BIG-IP - LTM|Threat Count|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="LTM"<br />\| json  "application", "tenant", "virtual\_name", "http\_uri", "http\_method", "client\_ip", "hostname"<br />\| count as ip\_count by client\_ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|F5 - BIG-IP - LTM|Threat Table|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="LTM"<br />\| json  "application", "tenant", "virtual\_name", "http\_uri", "http\_method", "client\_ip", "hostname"<br />\| count as ip\_count by client\_ip, \_source, application, tenant, http\_method, http\_uri, hostname<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by client\_ip, hostname, malicious\_confidence, Actor, label\_name, application, tenant, http\_method, http\_uri<br />\| sort by threat\_count|
|F5 - BIG-IP - LTM|Threats by Malicious Confidence|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Threat Analysis|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="LTM"<br />\| json  "application", "tenant", "virtual\_name", "http\_uri", "http\_method", "client\_ip", "hostname"<br />\| count as ip\_count by client\_ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=client\_ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by malicious\_confidence|
|F5 - BIG-IP - LTM|TMM CPU Usage|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections|\_sourceCategory={{Logsdatasource}} <br />\| json "system.tmmCpu" as cpu<br />\| json "system.tmmMemory" as memory<br />\| json "system.hostname" as host<br />\| timeslice 15m<br />\| avg( cpu ) by \_timeslice, host<br />\| transpose row \_timeslice column host|
|F5 - BIG-IP - LTM|TMM CPU Usage  - Outlier|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis|\_sourceCategory={{Logsdatasource}}   <br />\| json "system.tmmCpu" as cpu<br />\| json "system.tmmMemory" as memory<br />\| json "system.hostname" as host<br />\| timeslice 1h<br />\| avg( cpu ) by \_timeslice<br />\| outlier \_avg window=10,threshold=2,consecutive=2,direction=+ |
|F5 - BIG-IP - LTM|TMM Memory Usage - Outlier|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Outlier Analysis|\_sourceCategory={{Logsdatasource}}   <br />\| json "system.tmmCpu" as cpu<br />\| json "system.tmmMemory" as memory<br />\| json "system.hostname" as host<br />\| timeslice 1h<br />\| avg( memory ) by \_timeslice<br />\| outlier \_avg window=10,threshold=2,consecutive=2,direction=+ |
|F5 - BIG-IP - LTM|TMM Memory Usage by Host|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections|\_sourceCategory={{Logsdatasource}} <br />\| json "system.tmmCpu" as cpu<br />\| json "system.tmmMemory" as memory<br />\| json "system.hostname" as host<br />\| timeslice 15m<br />\| avg( memory ) by \_timeslice, host<br />\| transpose row \_timeslice column host|
|F5 - BIG-IP - LTM|Top 20 Pools|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview|\_sourceCategory={{Logsdatasource}}   systemInfo<br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| json field=\_raw "virtualServers"<br />\| parse regex field=virtualServers "name\\"\\:\\"(?\<virtualServer\_name\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "enabledState\\"\\:\\"(?\<enabledState\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "application\\"\\:\\"(?\<application\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "availabilityState\\"\\:\\"(?\<availabilityState\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "tenant\\"\\:\\"(?\<tenant\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "pool\\"\\:\\"(?\<pool\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "destination\\"\\:\\"(?\<destination\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "clientside.curConns\\"\\:(?\<current\_connections\>[\\S]+?)\\," multi<br />\| parse regex field=virtualServers "clientside.bitsOut\\"\\:(?\<client\_bits\_out\>[\\S]+?)\\," multi<br />\| count by pool<br />\| sort by \_count<br />\| limit 20<br /><br />|
|F5 - BIG-IP - LTM|Total TCP Connections|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Metrics and Connections|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="systemInfo"<br />\| json field=\_raw "virtualServers"<br />\| parse regex field=virtualServers "name\\"\\:\\"(?\<virtualServer\_name\>[\\S]+?)\\"" multi<br />\| parse regex field=virtualServers "clientside.curConns\\"\\:(?\<clientside\_cur\_conns\>[\\S]+?)\\," multi<br />\| timeslice 1h<br />\| sum( clientside\_cur\_conns ) by \_timeslice|
|F5 - BIG-IP - LTM|Users By Application Profile|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| count\_distinct( application) group by username, application<br />\| fields - \_count\_distinct|
|F5 - BIG-IP - LTM|Violations Triggered|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - User Session|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| where violations !="N/A"<br />\| count by violations<br />\| sort by \_count |
|F5 - BIG-IP - LTM|Violations Triggered by Hosts|Logs|Installed Apps/F5 - BIG-IP - LTM/F5 - BIG-IP LTM - Overview|\_sourceCategory={{Logsdatasource}}   <br />\| json field=\_raw "telemetryEventCategory"  as telemetryEventCategory<br />\| where telemetryEventCategory="ASM"<br />\| json  "method", "ip\_client","violations", "policy\_name", "web\_application\_name", "hostname", "protocol", "severity", "attack\_type", "geo\_location", "username", "session\_id" ,"dest\_ip", "threat\_campaign\_names", "staged\_threat\_campaign\_names" , "blocking\_exception\_reason", "uri", "request", "tenant", "application" nodrop<br />\| parse regex field=request  "(?\<mthd\>[A-Z]+)\\s(?\<URL\>\\S+)\\sHTTP\\/[\\d.]+[\\S]+User-Agent\\:\\s(?\<user\_agent\>.+)[\\S]+Host\\:\\s(?\<src\_ip\>\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}).+" nodrop<br />\| where violations !="N/A"<br />\| count by hostname, severity |

