# OneLogin
## Sumo Logic App For: OneLogin
OneLogin is an Identity Management provider that supplies a comprehensive set of enterprise-grade identity and access management solutions, including single sign-on (SSO), user provisioning, and multi-factor authentication. The Sumo Logic App for OneLogin provides real-time visibility and analysis of OneLogin user activity through event data, such as user logins, administrative operations, and provisioning.
Docs Link: [OneLogin](https://help.sumologic.com/?cid=8989)

## Searches

### Log Searches

- **Assumed Users**: from Dashboard: Installed Apps/OneLogin/OneLogin - Security 
- **Authentication Events**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Authentication Events - One Day Time Comparison**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Event Distributions by App**: from Dashboard: Installed Apps/OneLogin/OneLogin - App Monitoring 
- **Event Distributions by EventIDs**: from Dashboard: Installed Apps/OneLogin/OneLogin - App Monitoring 
- **Event Outlier Over Time**: from Dashboard: Installed Apps/OneLogin/OneLogin - Overview 
- **Events by App**: from Dashboard: Installed Apps/OneLogin/OneLogin - Overview 
- **Failed Actions**: from Dashboard: Installed Apps/OneLogin/OneLogin - App Monitoring 
- **Failed Login Outlier**: from Dashboard: Installed Apps/OneLogin/OneLogin - Overview 
- **Failed Logins**: from Dashboard: Installed Apps/OneLogin/OneLogin - Security 
- **Global Risk Reasons**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Logins by App**: from Dashboard: Installed Apps/OneLogin/OneLogin - App Monitoring 
- **Logins by Country**: from Dashboard: Installed Apps/OneLogin/OneLogin - Security 
- **Logins by Country**: from Dashboard: Installed Apps/OneLogin/OneLogin - Overview 
- **Low Trust by Location**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **MFA Request Failure by Location**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Password Changes**: from Dashboard: Installed Apps/OneLogin/OneLogin - Security 
- **Risk Scores (None, Low, Medium, High)**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Successful Login Outlier**: from Dashboard: Installed Apps/OneLogin/OneLogin - Overview 
- **Successful Logins**: from Dashboard: Installed Apps/OneLogin/OneLogin - Security 
- **Top 10 Provisioning Errors and Warnings**: from Dashboard: Installed Apps/OneLogin/OneLogin - App Monitoring 
- **Top 10 Users by Events**: from Dashboard: Installed Apps/OneLogin/OneLogin - Overview 
- **User Activity**: from Dashboard: Installed Apps/OneLogin/OneLogin - Security 
- **User Modifications**: from Dashboard: Installed Apps/OneLogin/OneLogin - Security 
- **Users Created in Apps**: from Dashboard: Installed Apps/OneLogin/OneLogin - Security 
- **Users prompted for MFA by Country**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Users prompted for MFA by Location**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Users prompted for MFA during Login**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Users whose MFA was suppressed by Location**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Users whose MFA was suppressed during Login**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Users with High Risk Logons (Risk > 51)**: from Dashboard: Installed Apps/OneLogin/OneLogin - Adaptive MFA 
- **Visitor Locations**: from Dashboard: Installed Apps/OneLogin/OneLogin - Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|OneLogin|Assumed Users|Logs|Installed Apps/OneLogin/OneLogin - Security|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name","event.notes" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name, note nodrop <br />\| json "event.event\_timestamp" as event\_timestamp nodrop <br />\| user\_name as dest\_user <br />\| actor\_user\_name as src\_user<br />\| where event\_id = 3<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}")<br />\|count by event\_timestamp, dest\_user, note, src\_user<br />\| sort by event\_timestamp|
|OneLogin|Authentication Events|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name", "event.notes", "event.risk\_score", "event.risk\_reasons" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name, notes, risk\_score, risk\_reasons nodrop <br />\| where event\_id in ("5","6", "7", "8", "9", "22", "24", "105", "122")<br />\| count by event\_id<br />\| lookup event\_name from https://s3.amazonaws.com/sumologic-app-data/onelogin\_events.csv on event\_id=event\_id<br />\| fields event\_name,event\_id, \_count \| where event\_name \> ""<br />\| order by \_count desc|
|OneLogin|Authentication Events - One Day Time Comparison|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name", "event.notes", "event.risk\_score", "event.risk\_reasons" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name, notes, risk\_score, risk\_reasons nodrop <br />\| where event\_id in ("5","6", "7", "8", "9", "22", "24", "105", "122")<br />\| lookup event\_name from https://s3.amazonaws.com/sumologic-app-data/onelogin\_events.csv on event\_id=event\_id<br />\| where event\_name \> ""<br />\| count by event\_name<br /><br />//\| fields event\_name,event\_id, \_count <br />//\| order by \_count desc <br />\| compare with timeshift 1d|
|OneLogin|Event Distributions by App|Logs|Installed Apps/OneLogin/OneLogin - App Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where !isNull(app\_name)<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\| count by app\_name<br />\| sort by \_count|
|OneLogin|Event Distributions by EventIDs|Logs|Installed Apps/OneLogin/OneLogin - App Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\| count by event\_id<br />\| lookup event\_name from https://s3.amazonaws.com/sumologic-app-data/onelogin\_events.csv on event\_id=event\_id<br />\| if(isBlank(event\_name), format("event\_id: %s", event\_id), event\_name) as event\_id<br />\| sort by \_count|
|OneLogin|Event Outlier Over Time|Logs|Installed Apps/OneLogin/OneLogin - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| timeslice 1h<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count by \_timeslice <br />\| outlier \_count window=5|
|OneLogin|Events by App|Logs|Installed Apps/OneLogin/OneLogin - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| lookup latitude, longitude, country\_code,country\_name from geo://location on ip = src\_ip <br />\| lookup event\_name from https://s3.amazonaws.com/sumologic-app-data/onelogin\_events.csv on event\_id=event\_id<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count by app\_name|
|OneLogin|Failed Actions|Logs|Installed Apps/OneLogin/OneLogin - App Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| json "event.error\_description" as error\_description nodrop <br />\| where event\_id in ("49","61","62","63","64","65","77","116","125","129","517","518","519","520","521","522","523","524","525","526","527")<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count by error\_description<br />\| sort by \_count desc|
|OneLogin|Failed Login Outlier|Logs|Installed Apps/OneLogin/OneLogin - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id in ("6","9","77","154","141")<br />\| timeslice 1h<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count by \_timeslice<br />\| outlier \_count|
|OneLogin|Failed Logins|Logs|Installed Apps/OneLogin/OneLogin - Security|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id in ("6","9","77","154","141")<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}")<br />\|count by user\_name<br />\| sort by \_count|
|OneLogin|Global Risk Reasons|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.risk\_reasons" as risk\_reasons nodrop <br />\| where !isEmpty(risk\_reasons) <br />\| parse regex field=risk\_reasons "(?\<risk\>.+) \\([0-9]+%\\)" multi<br />\| count by risk<br />\| sort by \_count|
|OneLogin|Logins by App|Logs|Installed Apps/OneLogin/OneLogin - App Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id = 8 and !isNull(app\_name)<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\| count by app\_name<br />\| sort by \_count|
|OneLogin|Logins by Country|Logs|Installed Apps/OneLogin/OneLogin - Security|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id in ("5","8")<br />\| lookup latitude, longitude, country\_code,country\_name from geo://location on ip = src\_ip <br />\| where country\_name!="" and !isNull(country\_name)<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}")<br />\|count by country\_name <br />\| order by \_count|
|OneLogin|Logins by Country|Logs|Installed Apps/OneLogin/OneLogin - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id in ("5","8")<br />\| lookup latitude, longitude, country\_code,country\_name from geo://location on ip = src\_ip <br />\| where country\_name!="" and !isNull(country\_name)<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count by country\_name <br />\| order by \_count|
|OneLogin|Low Trust by Location|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "event.event\_type\_id" as event nodrop \| where event = 5<br />\| json field=\_raw "event.risk\_score" as risk nodrop \| where risk \> 0<br />\| json field=\_raw "event.risk\_reasons" as risk\_reasons nodrop <br />\| json field=\_raw "event.user\_name" as username nodrop <br />\| json field=\_raw "event.ipaddr" as src\_ip nodrop <br />\| number(risk)<br />\| where risk\_reasons matches "\*Low trust for session\*"<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip <br />\| count\_distinct(src\_ip) as \_count by longitude, latitude|
|OneLogin|MFA Request Failure by Location|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "event.event\_type\_id" as event\_id nodrop <br />\| json field=\_raw "event.risk\_score" as risk nodrop <br />\| json field=\_raw "event.risk\_reasons" as risk\_reasons nodrop <br />\| json field=\_raw "event.user\_name" as username nodrop <br />\| json field=\_raw "event.ipaddr" as src\_ip nodrop <br />\| json field=\_raw "event.notes" as notes nodrop <br />\| where event\_id in ("105")<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip <br />\| count\_distinct(src\_ip) as \_count by longitude, latitude|
|OneLogin|Password Changes|Logs|Installed Apps/OneLogin/OneLogin - Security|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id in ("10","11")<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}")<br />\|count by user\_name<br />\| sort by \_count|
|OneLogin|Risk Scores (None, Low, Medium, High)|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.risk\_score", "event.risk\_reasons" as risk\_score, risk\_reasons nodrop<br />\| number(risk\_score)<br />\| where risk\_score \>= 0<br />\| if (risk\_score \< 5, "No Risk (0-4)", if (risk\_score \< 26, "Low Risk (5-25)", if (risk\_score \< 51, "Medium Risk (26-50)", "High Risk (51-100)"))) as RISK<br />//\| risk\_score = 0 ? "ZERO RISK" : "NO RISK SCORE" as RISK<br />//\| risk\_score \< 20 ? "LOW" : RISK as RISK<br />\| fields risk\_score, risk\_reasons, RISK<br />\| count\_frequent RISK <br /><br /><br />|
|OneLogin|Successful Login Outlier|Logs|Installed Apps/OneLogin/OneLogin - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id in ("5","8")<br />\| timeslice 1h<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count by \_timeslice<br />\| outlier \_count|
|OneLogin|Successful Logins|Logs|Installed Apps/OneLogin/OneLogin - Security|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id in ("5","8")<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}")<br />\|count by user\_name<br />\| sort by \_count|
|OneLogin|Top 10 Provisioning Errors and Warnings|Logs|Installed Apps/OneLogin/OneLogin - App Monitoring|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| json "event.error\_description" as error\_description nodrop<br />\| where event\_id in ("25","79","60")<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count by error\_description<br />\| sort by \_count desc<br />\| limit 10|
|OneLogin|Top 10 Users by Events|Logs|Installed Apps/OneLogin/OneLogin - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| lookup latitude, longitude, country\_code,country\_name from geo://location on ip = src\_ip<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count by user\_name <br />\| top 10 user\_name by \_count|
|OneLogin|User Activity|Logs|Installed Apps/OneLogin/OneLogin - Security|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where !isNull(user\_name) and !isEmpty(user\_name)<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}")<br />\|count by user\_name<br />\| sort by \_count|
|OneLogin|User Modifications|Logs|Installed Apps/OneLogin/OneLogin - Security|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| json "event.event\_timestamp","event.notes","event.error\_description" as event\_timestamp, note, error\_description nodrop <br />\| user\_name as dest\_user <br />\| actor\_user\_name as src\_user<br />\| where event\_id in ("52","53","54","55")<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}")<br />\|count by event\_timestamp, dest\_user, src\_user, note, error\_description<br />\| sort by event\_timestamp|
|OneLogin|Users Created in Apps|Logs|Installed Apps/OneLogin/OneLogin - Security|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| where event\_id in ("13","51","80") and !isNull(app\_name) and !isEmpty(app\_name)<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{src\_ip}}" = "\*", true, src\_ip matches "{{src\_ip}}") AND if ("{{actor\_user\_name}}" = "\*", true, actor\_user\_name matches "{{actor\_user\_name}}")<br />\|count by app\_name|
|OneLogin|Users prompted for MFA by Country|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name", "event.notes" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name, notes nodrop <br />\| where event\_id in ("5","8")<br />\| where notes matches "Authentication method: password + OTP."<br />\| lookup latitude, longitude, country\_code,country\_name from geo://location on ip = src\_ip <br />\| where country\_name!="" and !isNull(country\_name)<br />\| count by country\_name <br />\| order by \_count|
|OneLogin|Users prompted for MFA by Location|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "event.event\_type\_id" as event\_id nodrop <br />\| json field=\_raw "event.risk\_score" as risk nodrop <br />\| json field=\_raw "event.risk\_reasons" as risk\_reasons nodrop <br />\| json field=\_raw "event.user\_name" as username nodrop <br />\| json field=\_raw "event.ipaddr" as src\_ip nodrop <br />\| json field=\_raw "event.notes" as notes nodrop <br />\| where event\_id in ("5","8")<br />\| where notes matches "Authentication method: password + OTP."<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip <br />\| count\_distinct(src\_ip) as \_count by longitude, latitude|
|OneLogin|Users prompted for MFA during Login|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "event.event\_type\_id" as event nodrop \| where event = 5<br />\| json field=\_raw "event.risk\_score" as risk nodrop \| where risk \> 3<br />\| json field=\_raw "event.risk\_reasons" as risk\_reasons nodrop <br />\| json field=\_raw "event.user\_name" as username nodrop <br />\| json field=\_raw "event.ipaddr" as IP nodrop <br />\| number(risk)<br />\| count by username <br />\| sort by \_count<br />|
|OneLogin|Users whose MFA was suppressed by Location|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "event.event\_type\_id" as event nodrop <br />\| json field=\_raw "event.risk\_score" as risk nodrop <br />\| json field=\_raw "event.risk\_reasons" as risk\_reasons nodrop <br />\| json field=\_raw "event.notes" as notes nodrop \| where notes matches "\*Authentication method: password + OTP Suppressed.\*"<br />\| json field=\_raw "event.user\_name" as username nodrop <br />\| json field=\_raw "event.ipaddr" as src\_ip nodrop <br />\| number(risk)<br />\| lookup latitude, longitude, country\_code from geo://location on ip = src\_ip <br />\| count\_distinct(src\_ip) as \_count by longitude, latitude|
|OneLogin|Users whose MFA was suppressed during Login|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json field=\_raw "event.event\_type\_id" as event nodrop \| where event = 5<br />\| json field=\_raw "event.risk\_score" as risk nodrop <br />\| json field=\_raw "event.risk\_reasons" as risk\_reasons nodrop <br />\| json field=\_raw "event.user\_name" as username nodrop <br />\| json field=\_raw "event.notes" as notes nodrop <br />\| json field=\_raw "event.ipaddr" as IP nodrop <br />\| where notes matches "\*OTP Suppressed\*"<br />\| number(event)<br />\| count by username <br />// average worker salary, divided by seconds in an 8 hour workday, 20 seconds for non-push MFA \* that number (eg. 75K)<br />\| \_count \* .20 as savings <br />\| format("\$%.2f",savings) as savings  <br />\| sort by \_count|
|OneLogin|Users with High Risk Logons (Risk \> 51)|Logs|Installed Apps/OneLogin/OneLogin - Adaptive MFA|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name", "event.notes", "event.risk\_score", "event.risk\_reasons" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name, notes, risk\_score, risk\_reasons nodrop <br />\| number(risk\_score)<br />\| where event\_id in ("5","6", "7", "8", "9", "22", "24", "105", "122")<br />\| where risk\_score \> 51<br />\| fields event\_id, user\_name, app\_name, risk\_score, risk\_reasons, notes<br />\| count by user\_name<br />\| sort by \_count<br /><br /><br />|
|OneLogin|Visitor Locations|Logs|Installed Apps/OneLogin/OneLogin - Overview|\_sourceCategory={{Logsdatasource}}  <br />\| json "event.event\_type\_id", "event.app\_name","event.ipaddr", "event.user\_name", "event.actor\_user\_name" as event\_id, app\_name, src\_ip, user\_name, actor\_user\_name nodrop <br />\| lookup latitude, longitude, country\_code,country\_name from geo://location on ip = src\_ip <br />\| lookup event\_name from https://s3.amazonaws.com/sumologic-app-data/onelogin\_events.csv on event\_id=event\_id<br />\|where if ("{{user\_name}}" = "\*", true, user\_name matches "{{user\_name}}") AND if ("{{event\_id}}" = "\*", true, event\_id matches "{{event\_id}}") AND if ("{{app\_name}}" = "\*", true, app\_name matches "{{app\_name}}")<br />\|count\_distinct(src\_ip) as \_count by longitude, latitude|

