# Box
## Sumo Logic App For: Box
The Sumo Logic App for Box provides insight into user behavior patterns, monitors resources, and even tracks administrative activities. The app consists of three predefined Dashboards, providing visibility into your environment for real time analysis.
Docs Link: [Box](https://help.sumologic.com/?cid=1055)

## Searches

### Log Searches

- **Access Types Over Time**: from Dashboard: Installed Apps/Box/Box Resource Access 
- **Administrative Activities**: from Dashboard: Installed Apps/Box/Box User Monitoring 
- **Collaboration Details**: from Dashboard: Box/Box Collaborations and Shares - New 
- **Collaboration Details**: from Dashboard: Installed Apps/Box/Box Collaborations and Shares 
- **Collaborations by Item**: from Dashboard: Box/Box Collaborations and Shares - New 
- **Collaborations by Item**: from Dashboard: Installed Apps/Box/Box Collaborations and Shares 
- **Recent Login Devices Added**: from Dashboard: Installed Apps/Box/Box User Monitoring 
- **Resources Moved or Copied**: from Dashboard: Installed Apps/Box/Box Resource Access 
- **Shared Resources**: from Dashboard: Box/Box Collaborations and Shares - New 
- **Shared Resources**: from Dashboard: Installed Apps/Box/Box Collaborations and Shares 
- **Top 10  Resource Consumers**: from Dashboard: Installed Apps/Box/Box Resource Access 
- **Top 10 Automated Users**: from Dashboard: Installed Apps/Box/Box User Monitoring 
- **Top 10 Failed Logins**: from Dashboard: Installed Apps/Box/Box User Monitoring 
- **Top 10 Logins by IP**: from Dashboard: Installed Apps/Box/Box User Monitoring 
- **Top 10 Logins by User**: from Dashboard: Installed Apps/Box/Box User Monitoring 
- **Top 10 Most Accessed Resources**: from Dashboard: Installed Apps/Box/Box Resource Access 
- **Top 10 Most Downloaded or Viewed Resources**: from Dashboard: Installed Apps/Box/Box Resource Access 
- **Top 10 Resource Creators**: from Dashboard: Installed Apps/Box/Box Resource Access 
- **Users with Most Collaboration Activities**: from Dashboard: Installed Apps/Box/Box Collaborations and Shares 
- **Users with Most Collaboration Activities**: from Dashboard: Box/Box Collaborations and Shares - New

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Box|Access Types Over Time|Logs|Installed Apps/Box/Box Resource Access|\_sourceCategory={{\_sourceCategory}} type "event\_type"  ((ITEM and !SHARED) or COMMENT\_CREATE or TASK or LOCK !COLLAB)<br />\| timeslice 1h<br />\| json "event\_type" as event\_type<br />\| count as count by event\_type,\_timeslice<br />\| transpose row \_timeslice column event\_type<br /><br />|
|Box|Administrative Activities|Logs|Installed Apps/Box/Box User Monitoring|\_sourceCategory={{\_sourceCategory}}  type "event\_type"  ("NEW\_USER" or "DELETE\_USER" or "EDIT\_USER"  or group or (CHANGE ADMIN))<br />\| json "created\_at","ip\_address","event\_type","created\_by.name","created\_by.login" as messagetime,src\_ip,event\_type, src\_user,src\_login nodrop<br />\| json "source.name","source.login","source.type"  as dest\_user,dest\_login, item\_type nodrop<br />\| count as EventCount by \_messagetime,messagetime, event\_type, src\_ip,src\_user,src\_login,dest\_user,dest\_login \| sort by \_messagetime<br />\| fields -EventCount,\_messagetime<br />|
|Box|Collaboration Details|Logs|Box/Box Collaborations and Shares - New|\_sourceCategory = Labs/Box  type "event\_type" (  collaboration  !collab )<br />// the following json is for User events<br />//\| json "recorded\_at","event\_type","source.role","source.status","source.item.name","source.item.type","created\_by.name","source.accessible\_by.login","source.accessible\_by.name" as messagetime,event\_type,role,status,item\_name,item\_type,src\_user,dest\_login,dest\_name nodrop<br />\| json "created\_at","event\_type","source.folder\_name","created\_by.name","created\_by.login","ip\_address","source.user\_name" as messagetime,event\_type,item\_name,src\_user,src\_login,src\_ip,dest\_name nodrop<br />\| count by messagetime,event\_type,item\_name,src\_user,src\_login,dest\_name \| sort by messagetime<br />\| fields -\_count|
|Box|Collaboration Details|Logs|Installed Apps/Box/Box Collaborations and Shares|\_sourceCategory={{\_sourceCategory}}  type "event\_type" (  collaboration  !collab )<br />// the following json is for User events<br />//\| json "recorded\_at","event\_type","source.role","source.status","source.item.name","source.item.type","created\_by.name","source.accessible\_by.login","source.accessible\_by.name" as messagetime,event\_type,role,status,item\_name,item\_type,src\_user,dest\_login,dest\_name nodrop<br />\| json "created\_at","event\_type","source.folder\_name","created\_by.name","created\_by.login","ip\_address","source.user\_name" as messagetime,event\_type,item\_name,src\_user,src\_login,src\_ip,dest\_name nodrop<br />\| count by messagetime,event\_type,item\_name,src\_user,src\_login,dest\_name \| sort by messagetime<br />\| fields -\_count|
|Box|Collaborations by Item|Logs|Box/Box Collaborations and Shares - New|\_sourceCategory = Labs/Box  type "event\_type" ( collab or shared)<br />\| json "event\_type"<br />\| where (event\_type matches "COLLAB\*") or (event\_type matches "ITEM\_SHARED\*")<br />\| json "source.name","source.type" as item\_name1,item\_type1 nodrop <br />\| json "source.role","source.status","source.item.name","source.item.type","created\_by.name","source.accessible\_by.login","source.accessible\_by.name" as role,status,item\_name2,item\_type2,src\_user, dest\_login,dest\_user nodrop <br />\| if (!(item\_name1="" or isNull(item\_name1)), item\_name1,item\_name2) as item\_name<br />\| if (!(item\_type1="" or isNull(item\_type1)), item\_type1,item\_type2) as item\_type<br />\| fields -item\_name1,item\_name2,item\_type1,item\_type2<br />\|count\_distinct(src\_user) as Collaborators by item\_name,item\_type<br />\| sort by Collaborators|
|Box|Collaborations by Item|Logs|Installed Apps/Box/Box Collaborations and Shares|\_sourceCategory={{\_sourceCategory}}  type "event\_type" ( collab or shared)<br />\| json "event\_type"<br />\| where (event\_type matches "COLLAB\*") or (event\_type matches "ITEM\_SHARED\*")<br />\| json "source.name","source.type" as item\_name1,item\_type1 nodrop <br />\| json "source.role","source.status","source.item.name","source.item.type","created\_by.name","source.accessible\_by.login","source.accessible\_by.name" as role,status,item\_name2,item\_type2,src\_user, dest\_login,dest\_user nodrop <br />\| if (!(item\_name1="" or isNull(item\_name1)), item\_name1,item\_name2) as item\_name<br />\| if (!(item\_type1="" or isNull(item\_type1)), item\_type1,item\_type2) as item\_type<br />\| fields -item\_name1,item\_name2,item\_type1,item\_type2<br />\|count\_distinct(src\_user) as Collaborators by item\_name,item\_type<br />\| sort by Collaborators|
|Box|Recent Login Devices Added|Logs|Installed Apps/Box/Box User Monitoring|\_sourceCategory={{\_sourceCategory}}  type device add<br />\| json "event\_type","created\_by.name","created\_by.login","created\_at","ip\_address" as event\_type,src\_user,src\_login, messagetime, src\_ip nodrop <br />\| where event\_type="ADD\_LOGIN\_ACTIVITY\_DEVICE"<br />\| count by \_messagetime,messagetime,src\_login, src\_user,src\_ip \| sort by \_messagetime <br />\| fields -\_count, \_messagetime|
|Box|Resources Moved or Copied|Logs|Installed Apps/Box/Box Resource Access|\_sourceCategory={{\_sourceCategory}}  type (MOVE or COPY) event\_type<br />//\| json "source.type","source.name","source.parent.name","created\_by.login","created\_by.name","source.path\_collection.entries[1].name","source.path\_collection.entries[1].type","recorded\_at" as resource\_type, resource\_name, parent\_name,src\_user\_login, src\_user,  dest\_name,dest\_type,messagetime nodrop<br />\| json "source.type", "source.item\_name","event\_type","created\_at","created\_by.login","created\_by.name","ip\_address" as item\_type,item\_name, event\_type, messagetime,src\_login,src\_user,src\_ip  nodrop <br />\| count by \_messagetime,messagetime, item\_type, item\_name,event\_type,src\_login, src\_user \| sort by \_messagetime<br />\| fields -\_count,\_messagetime|
|Box|Shared Resources|Logs|Box/Box Collaborations and Shares - New|\_sourceCategory = Labs/Box  type "event\_type" ("ITEM\_SHARED\_CREATE" or "ITEM\_SHARED" or share)<br />// the following json is for User events<br />//\| json "recorded\_at","event\_type","created\_by.name","created\_by.login","source.name","source.type","source.shared\_link.access" as messagetime,event\_type, src\_user,src\_login,item\_name,item\_type, access<br />\| json "created\_at","event\_type","source.item\_name","source.item\_type","created\_by.name","created\_by.login","ip\_address" as messagetime,event\_type,item\_name,item\_type,src\_user,src\_login,src\_ip nodrop<br />\| where event\_type matches "\*SHARE\*"<br />\| count as EventCount by messagetime,event\_type, item\_name,item\_type,src\_user,src\_login \| sort by messagetime<br />\| fields -EventCount <br />|
|Box|Shared Resources|Logs|Installed Apps/Box/Box Collaborations and Shares|\_sourceCategory={{\_sourceCategory}}  type "event\_type" ("ITEM\_SHARED\_CREATE" or "ITEM\_SHARED" or share)<br />// the following json is for User events<br />//\| json "recorded\_at","event\_type","created\_by.name","created\_by.login","source.name","source.type","source.shared\_link.access" as messagetime,event\_type, src\_user,src\_login,item\_name,item\_type, access<br />\| json "created\_at","event\_type","source.item\_name","source.item\_type","created\_by.name","created\_by.login","ip\_address" as messagetime,event\_type,item\_name,item\_type,src\_user,src\_login,src\_ip nodrop<br />\| where event\_type matches "\*SHARE\*"<br />\| count as EventCount by messagetime,event\_type, item\_name,item\_type,src\_user,src\_login \| sort by messagetime<br />\| fields -EventCount <br />|
|Box|Top 10  Resource Consumers|Logs|Installed Apps/Box/Box Resource Access|\_sourceCategory={{\_sourceCategory}}  type  event\_type (DOWNLOAD or PREVIEW )  <br />//\| json "source.type","source.name", "event\_type","recorded\_at","created\_by.login","created\_by.name","source.parent.name","source.created\_by.login","source.created\_by.name" as item\_type,item\_name, event\_type, time,src\_login,src\_user, parent\_name,owner\_login,owner nodrop  <br />\| json "source.type", "source.item\_name","event\_type","created\_at","created\_by.login","created\_by.name","ip\_address" as item\_type,item\_name, event\_type, time,src\_login,src\_user,src\_ip  nodrop <br />\| count as Events by src\_user,src\_login<br />\| Top 10 src\_user,src\_login by Events|
|Box|Top 10 Automated Users|Logs|Installed Apps/Box/Box User Monitoring|\_sourceCategory={{\_sourceCategory}}  type "event\_type" user authenticate oauth2<br />\| json "created\_at","ip\_address","event\_type","created\_by.name","created\_by.login" as messagetime,src\_ip,event\_type, src\_user,src\_login nodrop<br />\| json "source.name","source.login","source.type"  as dest\_user,dest\_login, item\_type nodrop <br />\| count as EventCount by src\_user,src\_login,src\_ip \| top 10  src\_user,src\_login,src\_ip by EventCount|
|Box|Top 10 Failed Logins|Logs|Installed Apps/Box/Box User Monitoring|\_sourceCategory={{\_sourceCategory}}  type "event\_type" login<br />\| json "created\_at","ip\_address","event\_type","created\_by.name","created\_by.login" as messagetime,src\_ip,event\_type, src\_user,src\_login nodrop<br />\| json "source.name","source.login","source.type"  as dest\_user,dest\_login, item\_type nodrop<br />\| where event\_type="FAILED\_LOGIN" <br />\| count as EventCount by src\_user,src\_login,src\_ip \| top 10 src\_user,src\_login,src\_ip by EventCount|
|Box|Top 10 Logins by IP|Logs|Installed Apps/Box/Box User Monitoring|\_sourceCategory={{\_sourceCategory}}  type "event\_type" login<br />\| json "created\_at","ip\_address","event\_type","created\_by.name","created\_by.login" as messagetime,src\_ip,event\_type, src\_user,src\_login nodrop<br />\| json "source.name","source.login","source.type"  as dest\_user,dest\_login, item\_type nodrop<br />\| where event\_type="LOGIN" <br />\| count as EventCount by src\_ip \| top 10 src\_ip by EventCount|
|Box|Top 10 Logins by User|Logs|Installed Apps/Box/Box User Monitoring|\_sourceCategory={{\_sourceCategory}}  type "event\_type" login<br />\| json "created\_at","ip\_address","event\_type","created\_by.name","created\_by.login" as messagetime,src\_ip,event\_type, src\_user,src\_login nodrop<br />\| json "source.name","source.login","source.type"  as dest\_user,dest\_login, item\_type nodrop<br />\| where event\_type="LOGIN" <br />\| count as EventCount by src\_user,src\_login<br />\| top 10 src\_user,src\_login by EventCount|
|Box|Top 10 Most Accessed Resources|Logs|Installed Apps/Box/Box Resource Access|\_sourceCategory={{\_sourceCategory}} type "event\_type"  !COLLABORATION  !ADMIN !GROUP !DEVICE  "item\_name"<br />//\| json "event\_type","source.type","source.name" as event\_type,item\_type,item\_name nodrop <br />\| json "source.item\_type", "source.item\_name","event\_type","created\_at","created\_by.login","created\_by.name","ip\_address" as item\_type,item\_name, event\_type, messagetime,src\_login,src\_user,src\_ip  nodrop <br />\| count as Events by item\_type,item\_name<br />\| top 10  item\_name,item\_type by Events \| sort by Events<br /><br />|
|Box|Top 10 Most Downloaded or Viewed Resources|Logs|Installed Apps/Box/Box Resource Access|\_sourceCategory={{\_sourceCategory}}  type  event\_type (DOWNLOAD or PREVIEW)<br />//\| json "source.type", "event\_type","recorded\_at","created\_by.login","created\_by.name","source.name","source.parent.name","source.created\_by.login","source.created\_by.name" as resource\_type,event\_type, time,src\_login,src\_user, resource\_name,parent\_name,owner\_login,owner <br />\| json "source.type", "source.item\_name","event\_type","created\_at","created\_by.login","created\_by.name","ip\_address" as item\_type,item\_name, event\_type, time,src\_login,src\_user,src\_ip  nodrop <br />\| count as Events by item\_name,item\_type<br />\| Top 10 item\_name,item\_type by Events<br />\| sort by Events|
|Box|Top 10 Resource Creators|Logs|Installed Apps/Box/Box Resource Access|\_sourceCategory={{\_sourceCategory}}  type (upload or create) event\_type<br />//\| json "source.type", "event\_type","created\_at","created\_by.name","source.name","source.parent.name" as resource\_type,event\_type, created\_at, src\_user, resource\_name,parent\_name nodrop<br />\| json "source.type", "source.item\_name","event\_type","created\_at","created\_by.login","created\_by.name","ip\_address" as item\_type,item\_name, event\_type, messagetime,src\_login,src\_user,src\_ip  nodrop <br />\| count as count by src\_user,src\_login \| top 10  src\_user,src\_login by count<br />|
|Box|Users with Most Collaboration Activities|Logs|Installed Apps/Box/Box Collaborations and Shares|\_sourceCategory={{\_sourceCategory}}  type "event\_type" ( collaboration !collab )<br />// the following json is for User events<br />//\| json "event\_type","source.role","source.status","source.item.name","source.item.type","created\_by.name","created\_by.login","source.accessible\_by.login","source.accessible\_by.name" as event\_type,role,status,item\_name,item\_type,src\_user,src\_login, dest\_login1,dest\_user1 nodrop <br />\| json "event\_type","created\_by.login","created\_by.name","source.user\_name" as  event\_type, src\_login,src\_user,dest\_user nodrop<br />//\| if (!(dest\_user1="" or isNull(dest\_user1)), dest\_user1,dest\_user2) as dest\_user<br />//\| if (!(dest\_login1="" or isNull(dest\_login1)), dest\_login1,dest\_login2) as dest\_login<br />\| where src\_user!=""<br />\| count by src\_user,src\_login \| top 10 src\_user,src\_login by \_count<br />|
|Box|Users with Most Collaboration Activities|Logs|Box/Box Collaborations and Shares - New|\_sourceCategory = Labs/Box  type "event\_type" ( collaboration !collab )<br />// the following json is for User events<br />//\| json "event\_type","source.role","source.status","source.item.name","source.item.type","created\_by.name","created\_by.login","source.accessible\_by.login","source.accessible\_by.name" as event\_type,role,status,item\_name,item\_type,src\_user,src\_login, dest\_login1,dest\_user1 nodrop <br />\| json "event\_type","created\_by.login","created\_by.name","source.user\_name" as  event\_type, src\_login,src\_user,dest\_user nodrop<br />//\| if (!(dest\_user1="" or isNull(dest\_user1)), dest\_user1,dest\_user2) as dest\_user<br />//\| if (!(dest\_login1="" or isNull(dest\_login1)), dest\_login1,dest\_login2) as dest\_login<br />\| where src\_user!=""<br />\| count by src\_user,src\_login \| top 10 src\_user,src\_login by \_count<br />|

