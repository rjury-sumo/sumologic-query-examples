# Nginx - OpenTelemetry

## Searches

### Log Searches

- **4xx Codes by Server**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **4xx Codes by Server**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **4xx Errors - Client Locations**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **4xx Errors - Client Locations**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **5xx Codes by Server**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **5xx Codes by Server**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **All Errors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **All Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Browsers and Operating Systems**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Browsers and Operating Systems**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Bytes Served**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Bytes Served**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Bytes Served**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis 
- **Bytes Served**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis 
- **Client Errors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis 
- **Client Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis 
- **Client Locations with Critical Errors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Client Locations with Critical Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Client OS Platforms**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Client OS Platforms**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Critical Error Messages**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Critical Error Messages**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Critical Messages**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Critical Messages**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Desktop OS Version**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Desktop OS Version**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Error Responses by Server**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Error Responses by Server**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Highly Malicious Threat Table**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Highly Malicious Threat Table**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **HTTP Methods**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **HTTP Methods**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Log Level - One Day Time Comparison**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Log Level - One Day Time Comparison**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Media Types Served**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Media Types Served**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Messages by Log Level - Over Time**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Messages by Log Level - Over Time**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Non 200 Response Status Codes**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Non 200 Response Status Codes**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Number of Hits by Server - One Day Time Comparison**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Number of Requests by Client - One Day Time Comparison**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Number of Requests by Client - One Day Time Comparison**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Number of Visitors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis 
- **Number of Visitors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis 
- **Popular Mobile Device Versions**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Popular Mobile Device Versions**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Responses Over Time**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Responses Over Time**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Responses Over Time**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Responses Over Time**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Server Errors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis 
- **Server Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis 
- **Server Errors Over Time**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Server Errors Over Time**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Threat Breakdown by Sources**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat Breakdown by Sources**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat by Actors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat by Actors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat by Malicious Confidence**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat Count**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat Count**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat Locations**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat Locations**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat Table**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Threat Table**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Top 10 Bots Observed**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Top 10 Bots Observed**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Top 10 Search Terms from Popular Search Engines**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Top 10 URLs with 4xx Errors**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Top 10 URLs with 4xx Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Top 10 URLs with 5xx Errors**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Top 10 URLs with 5xx Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Top 5 Clients Causing 4xx Errors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Top 5 Clients causing Errors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Top 5 Clients causing Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Top 5 Critical Messages**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Top 5 Critical Messages**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Top 5 Highly Malicious URLs**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Top 5 Highly Malicious URLs**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Threat Intel 
- **Top 5 Referrers**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Top 5 Referrers**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Top 5 Servers with Errors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Top 5 Servers with Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Top 5 URIs causing 404 Responses**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Top 5 URIs causing 404 Responses**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations 
- **Top 5 URLs**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Top 5 URLs**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight 
- **Top 5 URLs with Errors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Top 5 URLs with Errors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Error Logs 
- **Traffic Distribution by Server**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Traffic Distribution by Server**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Traffic Volume and Bytes Served**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Traffic Volume and Bytes Served**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Unique Visitors**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Unique Visitors**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **United States**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations 
- **United States**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations 
- **Visitor Locations**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Visitor Locations**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Visitor Locations (Top 5 Countries) - Today Vs. Yesterday**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Visitor Locations (Top 5 Countries) - Today Vs. Yesterday**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Trends 
- **Visitor Platforms**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Visitor Platforms**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Visitors Platforms Over Time**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Visitors Platforms Over Time**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types 
- **Visits by Country Over Time**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations 
- **Visits by Country Over Time**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations 
- **Visits by US Regions Over Time**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations 
- **Visits by US Regions Over Time**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations 
- **WorldWide**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations 
- **WorldWide**: from Dashboard: Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations

### Metric Searches

- **Active Connections**: from Dashboard: Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Active Connections**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Active Connections by Server**: from Dashboard: Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Active Connections by Server**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Active vs Dropped Connections**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Active vs Dropped Connections**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Active vs Dropped Connections**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Active vs Dropped Connections**: from Dashboard: Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Client Requests per Second**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Client Requests per Second**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Dropped Connections**: from Dashboard: Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Dropped Connections**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Requests: Reading, Writing and Waiting**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Requests: Reading, Writing and Waiting**: from Dashboard: Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Total Number of Client Requests**: from Dashboard: Nginx - OpenTelemetry/Nginx - Overview 
- **Total Number of Client Requests**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Total Number of Client Requests**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Nginx - Overview 
- **Total Number of Client Requests**: from Dashboard: Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Total Number of Handled Connections**: from Dashboard: Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests 
- **Total Number of Handled Connections**: from Dashboard: Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests

## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Nginx - OpenTelemetry|4xx Codes by Server|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "4\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| count as count by status\_code, Host|
|Nginx - OpenTelemetry|4xx Codes by Server|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "4\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| count as count by status\_code, Host|
|Nginx - OpenTelemetry/Logs|4xx Errors - Client Locations|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "4\*"<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry/Logs|4xx Errors - Client Locations|Logs|Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "4\*"<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry|5xx Codes by Server|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "5\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| count as count by status\_code, Host|
|Nginx - OpenTelemetry|5xx Codes by Server|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "5\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| count as count by status\_code, Host|
|Nginx - OpenTelemetry/Metrics|Active Connections|Metrics|Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests|deployment.environment={{deployment.environment}} sumo.datasource=nginx metric=nginx.connections\_current state=active webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by metric|
|Nginx - OpenTelemetry/Metrics|Active Connections|Metrics|Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests|deployment.environment={{deployment.environment}} sumo.datasource=nginx metric=nginx.connections\_current state=active webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by metric|
|Nginx - OpenTelemetry/Metrics|Active Connections by Server|Metrics|Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_current state=active  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}    \| sum by webengine.cluster.name |
|Nginx - OpenTelemetry/Metrics|Active Connections by Server|Metrics|Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_current state=active  webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}    \| sum by webengine.cluster.name |
|Nginx - OpenTelemetry|Active vs Dropped Connections|Metrics|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric=nginx.connections\_current state=active webengine.cluster.name={{webengine.cluster.name}} \| quantize using sum \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Metrics|Active vs Dropped Connections|Metrics|Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests|deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_current state=active webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Metrics|Active vs Dropped Connections|Metrics|Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests|deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_current state=active webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry|Active vs Dropped Connections|Metrics|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric=nginx.connections\_current state=active webengine.cluster.name={{webengine.cluster.name}} \| quantize using sum \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Logs|All Errors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss:SSS") as messageDate<br />\| count by messageDate, log\_level, Client\_Ip, Server, Method, URL, Message<br />\| fields - \_count<br />\| sort by messageDate<br />\| limit 50|
|Nginx - OpenTelemetry/Logs|All Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss:SSS") as messageDate<br />\| count by messageDate, log\_level, Client\_Ip, Server, Method, URL, Message<br />\| fields - \_count<br />\| sort by messageDate<br />\| limit 50|
|Nginx - OpenTelemetry/Logs|Browsers and Operating Systems|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (user\_agent matches "\*Windows \*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*Win64\*","Windows","") as OS <br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Darwin/\*" OR user\_agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (user\_agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (user\_agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (user\_agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND user\_agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (user\_agent matches "\*Mobile/\*" OR user\_agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND user\_agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (user\_agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (user\_agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (user\_agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (user\_agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser  <br />\| count by OS,browser<br />\| transpose row Browser column OS|
|Nginx - OpenTelemetry/Logs|Browsers and Operating Systems|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (user\_agent matches "\*Windows \*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*Win64\*","Windows","") as OS <br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Darwin/\*" OR user\_agent matches "\*Mac OS\*","MacOS",OS) as OS <br />\| if (user\_agent matches "\* CrOS \*","Chrome OS",OS) as OS<br />\| if (user\_agent matches "\*Linux\*","Linux",OS) as OS <br />\| if (user\_agent matches "\*iPad\*","iPad",OS) as OS <br />\| if (user\_agent matches "\*iPhone\*","iPhone",OS) as OS <br />\| if (user\_agent matches "\*Android\*","Android",OS) as OS <br />\| if (user\_agent matches "\*Windows Phone\*","Windows Phone",OS) as OS <br />\| if (OS == "","Other",OS) as OS <br />\| if (user\_agent matches "Mozilla/\*; rv:\*)\*","Mozilla","") as Browser<br />\| if (user\_agent matches "\*MSIE\*","Internet Explorer",Browser) as Browser <br />\| if (user\_agent matches "\*Firefox\*","Firefox",Browser) as Browser <br />\| if (user\_agent matches "\*Safari\*","Safari",Browser) as Browser <br />\| if (OS=="Android" AND user\_agent matches "\*WebKit\*","WebKit",Browser) as Browser<br />\| if ((OS=="iPhone" OR OS=="iPad") AND (user\_agent matches "\*Mobile/\*" OR user\_agent matches "\*AppleWebKit\*(KHTML\*Gecko)\*"),"Mobile Safari",Browser) as Browser<br />\| if (browser == "" AND OS=="MacOS" AND user\_agent matches "Mozilla/\* (Macintosh;\*(KHTML, like Gecko)\*","Safari",Browser) as Browser <br />\| if (user\_agent matches "\*MobileSafari/\*","Mobile Safari",Browser) as Browser<br />\| if (user\_agent matches "\*Chrome\*","Chrome",Browser) as Browser <br />\| if (user\_agent matches "Opera\*","Opera",Browser) as Browser <br />\| if (user\_agent matches "Dolphin\*","Dolphin",Browser) as Browser <br />\| if (Browser == "","Other",Browser) as Browser  <br />\| count by OS,browser<br />\| transpose row Browser column OS|
|Nginx - OpenTelemetry/Logs|Bytes Served|Logs|Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where size != "-" and !isEmpty(size)<br />\| number(size)<br />\| timeslice {{TimeSlice}} \| (size/(1048576\*1000)) as gbytes <br />\| sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier gbytes window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+- |
|Nginx - OpenTelemetry/Logs|Bytes Served|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where size != "-" and !isEmpty(size)<br />\| number(size)<br />\| timeslice {{TimeSlice}} \| (size/(1048576\*1000)) as gbytes <br />\| sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier gbytes window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+- |
|Nginx - OpenTelemetry/Logs|Bytes Served|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| sum(Size) as Bytes\_Served<br />\| Bytes\_Served/(1024\*1024\*1000) as Gbytes\_Served<br />\| fields Gbytes\_Served|
|Nginx - OpenTelemetry/Logs|Bytes Served|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| sum(Size) as Bytes\_Served<br />\| Bytes\_Served/(1024\*1024\*1000) as Gbytes\_Served<br />\| fields Gbytes\_Served|
|Nginx - OpenTelemetry/Logs|Client Errors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| timeslice {{TimeSlice}}<br />\| sum(client\_errors) as client\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier client\_errors window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Nginx - OpenTelemetry/Logs|Client Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if(status\_code matches "4\*", 1, 0) as client\_errors <br />\| timeslice {{TimeSlice}}<br />\| sum(client\_errors) as client\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier client\_errors window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Nginx - OpenTelemetry/Logs|Client Locations with Critical Errors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| where !isEmpty(client\_ip)<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry/Logs|Client Locations with Critical Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| where !isEmpty(client\_ip)<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry|Client OS Platforms|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by User\_Agent<br />\| if (User\_Agent matches "\*iPad\*" or User\_Agent matches "\*iPhone\*" or User\_Agent matches "\*BlackBerry\*" or User\_Agent matches "\*SAMSUNG\*" or User\_Agent matches "\*Galaxy\*" or User\_Agent matches "\*Windows Phone\*" or User\_Agent matches "\*Android\*","Mobile","PC") as type<br />\| if (User\_Agent matches "\*Macintosh\*" or (User\_Agent matches "\*iMac\*"),"Mac",type) as type<br />\| count type<br />\| sort by \_count, type asc|
|Nginx - OpenTelemetry|Client OS Platforms|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by User\_Agent<br />\| if (User\_Agent matches "\*iPad\*" or User\_Agent matches "\*iPhone\*" or User\_Agent matches "\*BlackBerry\*" or User\_Agent matches "\*SAMSUNG\*" or User\_Agent matches "\*Galaxy\*" or User\_Agent matches "\*Windows Phone\*" or User\_Agent matches "\*Android\*","Mobile","PC") as type<br />\| if (User\_Agent matches "\*Macintosh\*" or (User\_Agent matches "\*iMac\*"),"Mac",type) as type<br />\| count type<br />\| sort by \_count, type asc|
|Nginx - OpenTelemetry|Client Requests per Second|Metrics|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.requests webengine.cluster.name={{webengine.cluster.name}} \| sum by metric \| rate|
|Nginx - OpenTelemetry|Client Requests per Second|Metrics|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.requests webengine.cluster.name={{webengine.cluster.name}} \| sum by metric \| rate|
|Nginx - OpenTelemetry|Critical Error Messages|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}}  sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| count|
|Nginx - OpenTelemetry|Critical Error Messages|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}}  sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| count|
|Nginx - OpenTelemetry/Logs|Critical Messages|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss:SSS") as messageDate<br />\| count by messageDate, log\_level, Server, Message<br />\| fields messageDate, log\_level, Server, Message<br />\| sort by messageDate<br />\| limit 20|
|Nginx - OpenTelemetry/Logs|Critical Messages|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| formatDate(\_messageTime, "MM/dd/yyyy HH:mm:ss:SSS") as messageDate<br />\| count by messageDate, log\_level, Server, Message<br />\| fields messageDate, log\_level, Server, Message<br />\| sort by messageDate<br />\| limit 20|
|Nginx - OpenTelemetry/Logs|Desktop OS Version|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx ("macintosh" OR "mac os" OR "windows" OR "i686" or "PC" or ("Linux" AND !android))<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=user\_agent "(?\<os\>Mac OS) (?\<version\>[^;\\)]+?)(?:;\|\\))" nodrop <br />\| parse regex field=user\_agent "(?\<os\>Windows)(?: NT \| )(?\<version\>[\\d.]+)" nodrop <br />\| parse regex field=user\_agent "(?\<os\>Linux) (?\<version\>\\S+?)(?:\\)\|;)" nodrop <br />\| where os != ""<br />\| count as count by os, version<br />\| transpose row Version column Os|
|Nginx - OpenTelemetry/Logs|Desktop OS Version|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx ("macintosh" OR "mac os" OR "windows" OR "i686" or "PC" or ("Linux" AND !android))<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=user\_agent "(?\<os\>Mac OS) (?\<version\>[^;\\)]+?)(?:;\|\\))" nodrop <br />\| parse regex field=user\_agent "(?\<os\>Windows)(?: NT \| )(?\<version\>[\\d.]+)" nodrop <br />\| parse regex field=user\_agent "(?\<os\>Linux) (?\<version\>\\S+?)(?:\\)\|;)" nodrop <br />\| where os != ""<br />\| count as count by os, version<br />\| transpose row Version column Os|
|Nginx - OpenTelemetry/Metrics|Dropped Connections|Metrics|Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests|deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_handled webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum |
|Nginx - OpenTelemetry/Metrics|Dropped Connections|Metrics|Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests|deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_handled webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum |
|Nginx - OpenTelemetry/Logs|Error Responses by Server|Logs|Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| timeslice 5m<br />\| count as count by \_timeslice, Host<br />\| transpose row \_timeslice column Host|
|Nginx - OpenTelemetry/Logs|Error Responses by Server|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "4\*" or status\_code matches "5\*"<br />\| if (isEmpty(pod),\_sourceHost,pod) as Host<br />\| timeslice 5m<br />\| count as count by \_timeslice, Host<br />\| transpose row \_timeslice column Host|
|Nginx - OpenTelemetry/Logs|Highly Malicious Threat Table|Logs|Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| lookup type, actor, raw, threatlevel as Malicious\_Confidence from sumo://threat/cs on threat=Client\_Ip <br />\| where  type="ip\_address" and !isNull(Malicious\_Confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| where Malicious\_Confidence matches "high"<br />\| count by Malicious\_Confidence, Actor, Client\_Ip, Status\_Code, URL, Referrer, User\_Agent<br />\| sort by \_count<br />\| limit 20|
|Nginx - OpenTelemetry/Logs|Highly Malicious Threat Table|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| lookup type, actor, raw, threatlevel as Malicious\_Confidence from sumo://threat/cs on threat=Client\_Ip <br />\| where  type="ip\_address" and !isNull(Malicious\_Confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| where Malicious\_Confidence matches "high"<br />\| count by Malicious\_Confidence, Actor, Client\_Ip, Status\_Code, URL, Referrer, User\_Agent<br />\| sort by \_count<br />\| limit 20|
|Nginx - OpenTelemetry/Logs|HTTP Methods|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by Method|
|Nginx - OpenTelemetry/Logs|HTTP Methods|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by Method|
|Nginx - OpenTelemetry/Logs|Log Level - One Day Time Comparison|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br /><br />\| count by log\_level<br />\| sort by \_count \| compare with timeshift 1d|
|Nginx - OpenTelemetry/Logs|Log Level - One Day Time Comparison|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br /><br />\| count by log\_level<br />\| sort by \_count \| compare with timeshift 1d|
|Nginx - OpenTelemetry/Logs|Media Types Served|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=url "^/[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$" <br />\| parse regex field=url "/\\S+?(?\<email\_prefix\>(?:%40\|@)[^.]+?)\\.\\w+" nodrop <br />\| where email\_prefix="" <br />\| count as count by type<br />\| sort by count, type asc|
|Nginx - OpenTelemetry/Logs|Media Types Served|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=url "^/[^\\?]+?\\.(?\<type\>[a-zA-Z]{2,4})\$" <br />\| parse regex field=url "/\\S+?(?\<email\_prefix\>(?:%40\|@)[^.]+?)\\.\\w+" nodrop <br />\| where email\_prefix="" <br />\| count as count by type<br />\| sort by count, type asc|
|Nginx - OpenTelemetry/Logs|Messages by Log Level - Over Time|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| timeslice 1h<br />\| count by \_timeslice, Log\_Level<br />\| transpose row \_timeslice column Log\_Level|
|Nginx - OpenTelemetry/Logs|Messages by Log Level - Over Time|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| timeslice 1h<br />\| count by \_timeslice, Log\_Level<br />\| transpose row \_timeslice column Log\_Level|
|Nginx - OpenTelemetry/Logs|Non 200 Response Status Codes|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where !(status\_code matches "2\*") <br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|Nginx - OpenTelemetry/Logs|Non 200 Response Status Codes|Logs|Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where !(status\_code matches "2\*") <br />\| count as count by status\_code <br />\| sort by count, status\_code asc|
|Nginx - OpenTelemetry/Logs|Number of Hits by Server - One Day Time Comparison|Logs|Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (isEmpty(pod),webengine.node.name,pod) as Host<br />\| count as Number\_of\_Hits by Host  <br />\| compare with timeshift 1d|
|Nginx - OpenTelemetry/Logs|Number of Hits by Server - One Day Time Comparison|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (isEmpty(pod),webengine.node.name,pod) as Host<br />\| count as Number\_of\_Hits by Host  <br />\| compare with timeshift 1d|
|Nginx - OpenTelemetry/Logs|Number of Requests by Client - One Day Time Comparison|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where !isEmpty(Client\_Ip)<br />\| count by client\_ip<br />\| sort by \_count<br />\| compare with timeshift 1d|
|Nginx - OpenTelemetry/Logs|Number of Requests by Client - One Day Time Comparison|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where !isEmpty(Client\_Ip)<br />\| count by client\_ip<br />\| sort by \_count<br />\| compare with timeshift 1d|
|Nginx - OpenTelemetry/Logs|Number of Visitors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where !isEmpty(Client\_Ip)<br />\| timeslice {{TimeSlice}}<br />\| count as count by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier count window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Nginx - OpenTelemetry/Logs|Number of Visitors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where !isEmpty(Client\_Ip)<br />\| timeslice {{TimeSlice}}<br />\| count as count by \_timeslice <br />\| sort \_timeslice asc<br />\| outlier count window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Nginx - OpenTelemetry/Logs|Popular Mobile Device Versions|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx (iphone or ipad or android or samsung) <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=nginx\_log\_message "\\((?\<device\>iPhone).+? CPU iPhone OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex field=nginx\_log\_message "\\((?\<device\>iPad).+? CPU OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex field=nginx\_log\_message " (?\<device\>Android) (?\<version\>[\\d\\.]+)" nodrop <br />\| parse regex field=nginx\_log\_message "(?\<device\>SAMSUNG).+?(?\<version\>(?:GT-\\w+\|SGH-\\w+\|SPH-\\w+\|SCH-\\w+))" <br />\| where device != ""<br />\| count as count by device, version <br />\| transpose row version column device|
|Nginx - OpenTelemetry/Logs|Popular Mobile Device Versions|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx (iphone or ipad or android or samsung) <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=nginx\_log\_message "\\((?\<device\>iPhone).+? CPU iPhone OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex field=nginx\_log\_message "\\((?\<device\>iPad).+? CPU OS (?\<version\>.+?) like Mac"  nodrop <br />\| parse regex field=nginx\_log\_message " (?\<device\>Android) (?\<version\>[\\d\\.]+)" nodrop <br />\| parse regex field=nginx\_log\_message "(?\<device\>SAMSUNG).+?(?\<version\>(?:GT-\\w+\|SGH-\\w+\|SPH-\\w+\|SCH-\\w+))" <br />\| where device != ""<br />\| count as count by device, version <br />\| transpose row version column device|
|Nginx - OpenTelemetry/Metrics|Requests: Reading, Writing and Waiting|Metrics|Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_current state=reading webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Metrics|Requests: Reading, Writing and Waiting|Metrics|Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_current state=reading webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Logs|Responses Over Time|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if(Status\_Code matches "2\*", 1, 0) as Successes <br />\| if(Status\_Code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(Status\_Code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 1h <br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc|
|Nginx - OpenTelemetry|Responses Over Time|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if(Status\_Code matches "2\*", 1, 0) as Successes <br />\| if(Status\_Code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(Status\_Code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 5m<br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc|
|Nginx - OpenTelemetry|Responses Over Time|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if(Status\_Code matches "2\*", 1, 0) as Successes <br />\| if(Status\_Code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(Status\_Code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 5m<br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc|
|Nginx - OpenTelemetry/Logs|Responses Over Time|Logs|Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if(Status\_Code matches "2\*", 1, 0) as Successes <br />\| if(Status\_Code matches "3\*", 1, 0) as Redirects <br />\| if(status\_code matches "4\*", 1, 0) as Client\_Errors <br />\| if(Status\_Code matches "5\*", 1, 0) as Server\_Errors <br />\| timeslice by 1h <br />\| sum(Successes) as Successes, sum(Client\_Errors) as Client\_Errors,  sum(Redirects) as Redirects, sum(Server\_Errors) as Server\_Errors by \_timeslice<br />\| sort by \_timeslice asc|
|Nginx - OpenTelemetry/Logs|Server Errors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice {{TimeSlice}}<br />\| sum(server\_errors) as server\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier server\_errors window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Nginx - OpenTelemetry/Logs|Server Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Outlier Analysis| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if(status\_code matches "5\*", 1, 0) as server\_errors <br />\| timeslice {{TimeSlice}}<br />\| sum(server\_errors) as server\_errors by \_timeslice<br />\| sort \_timeslice asc<br />\| outlier server\_errors window={{Window}},threshold={{Threshold}},consecutive={{Consecutive}},direction=+|
|Nginx - OpenTelemetry/Logs|Server Errors Over Time|Logs|Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, status\_code<br />\| transpose row \_timeslice column status\_code |
|Nginx - OpenTelemetry/Logs|Server Errors Over Time|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "5\*"<br />\| timeslice 5m<br />\| count as count by \_timeslice, status\_code<br />\| transpose row \_timeslice column status\_code |
|Nginx - OpenTelemetry/Logs|Threat Breakdown by Sources|Logs|Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_source |
|Nginx - OpenTelemetry/Logs|Threat Breakdown by Sources|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip, \_source<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by \_source |
|Nginx - OpenTelemetry/Logs|Threat by Actors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by Actor|
|Nginx - OpenTelemetry/Logs|Threat by Actors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by Actor|
|Nginx - OpenTelemetry/Logs|Threat by Malicious Confidence|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by malicious\_confidence|
|Nginx - OpenTelemetry/Logs|Threat by Malicious Confidence|Logs|Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count by malicious\_confidence|
|Nginx - OpenTelemetry/Logs|Threat Count|Logs|Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|Nginx - OpenTelemetry/Logs|Threat Count|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\|sum (ip\_count) as threat\_count|
|Nginx - OpenTelemetry/Logs|Threat Locations|Logs|Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry/Logs|Threat Locations|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| where type="ip\_address" and !isNull(malicious\_confidence)<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry/Logs|Threat Table|Logs|Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by malicious\_confidence, Actor, Client\_Ip, method, status\_code, URL, size, referrer, user\_agent<br />\| sort by \_count<br />\| limit 50|
|Nginx - OpenTelemetry/Logs|Threat Table|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| where  type="ip\_address" and !isNull(malicious\_confidence)<br />\| json field=raw "labels[\*].name" as label\_name <br />\| replace(label\_name, "\\\\/","-\>") as label\_name<br />\| replace(label\_name, "\\""," ") as label\_name<br />\| if (isEmpty(actor), "Unassigned", actor) as Actor<br />\| count by malicious\_confidence, Actor, Client\_Ip, method, status\_code, URL, size, referrer, user\_agent<br />\| sort by \_count<br />\| limit 50|
|Nginx - OpenTelemetry/Logs|Top 10 Bots Observed|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=user\_agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Exabot?)\\W"<br />\| where bot\_name != ""<br />\| if (bot\_name="bing","Bing",bot\_name) as bot\_name<br />\| count as count by bot\_name<br />\| sort by count<br />\| limit 10|
|Nginx - OpenTelemetry/Logs|Top 10 Bots Observed|Logs|Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx ("Googlebot" OR "AskJeeves" OR "Digger" OR "Lycos"<br />OR "msnbot" OR "Inktomi Slurp" OR "Yahoo" OR "Nutch" OR "bingbot" OR<br />"BingPreview" OR "Mediapartners-Google" OR "proximic" OR "AhrefsBot" OR<br />"AdsBot-Google" OR "Ezooms" OR "AddThis.com" OR "facebookexternalhit" OR<br />"MetaURI" OR "Feedfetcher-Google" OR "PaperLiBot" OR "TweetmemeBot" OR<br />"Sogou web spider" OR "GoogleProducer" OR "RockmeltEmbedder" OR<br />"ShareThisFetcher" OR "YandexBot" OR "rogerbot-crawler" OR "ShowyouBot" OR "Baiduspider" OR "Sosospider" OR "Exabot")<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=user\_agent "(?\<bot\_name\>facebook)externalhit?\\W+" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\S+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>PaperLiBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>TweetmemeBot?)/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>msn?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Nutch?)-.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)bot\\W" nodrop<br />\| parse regex field=user\_agent "Feedfetcher-(?\<bot\_name\>Google?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yahoo?)!\\s+Slurp[;/].+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>bing?)bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Bing?)Preview\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Sogou?)\\s+web\\s" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Yandex?)Bot\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>rogerbot?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>AddThis\\.com?)\\s+robot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>ShareThis?)Fetcher/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ahrefs?)Bot/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>MetaURI?)\\s+API/.+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Showyou?)Bot\\s+" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Google?)Producer;" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Ezooms?)\\W" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Rockmelt?)Embedder\\s+" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Sosospider?)\\W" nodrop <br />\| parse regex field=user\_agent "(?\<bot\_name\>Baidu?)spider" nodrop<br />\| parse regex field=user\_agent "(?\<bot\_name\>Exabot?)\\W"<br />\| where bot\_name != ""<br />\| if (bot\_name="bing","Bing",bot\_name) as bot\_name<br />\| count as count by bot\_name<br />\| sort by count<br />\| limit 10|
|Nginx - OpenTelemetry/Logs|Top 10 Search Terms from Popular Search Engines|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx (google OR bing OR aol OR ask OR yahoo) ("p=" OR "q=" OR "wd=" OR "searchfor=")<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where search\_term != ""<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*", "Google", "") as engine<br />\| if(referrer matches "\*bing.\*", "Bing", engine) as engine<br />\| if(referrer matches "\*ask.com\*", "Ask.com", engine) as engine<br />\| if(referrer matches "\*aol.\*", "AOL", engine) as engine<br />\| if(referrer matches "\*yahoo.\*", "Yahoo", engine) as engine<br />\| where engine !="" <br />\| count as count by search\_term<br />\| sort count<br />\| limit 10|
|Nginx - OpenTelemetry/Logs|Top 10 Search Terms from Popular Search Engines|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx (google OR bing OR aol OR ask OR yahoo) ("p=" OR "q=" OR "wd=" OR "searchfor=")<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| parse regex field=referrer "(?:\\?\|&)(?:p\|q\|wd\|searchfor)=(?\<search\_term\>[^=]+?)(?:&\|\$)" nodrop <br />\| where search\_term != ""<br />\| urldecode(search\_term)<br />\| if(referrer matches "\*google.\*", "Google", "") as engine<br />\| if(referrer matches "\*bing.\*", "Bing", engine) as engine<br />\| if(referrer matches "\*ask.com\*", "Ask.com", engine) as engine<br />\| if(referrer matches "\*aol.\*", "AOL", engine) as engine<br />\| if(referrer matches "\*yahoo.\*", "Yahoo", engine) as engine<br />\| where engine !="" <br />\| count as count by search\_term<br />\| sort count<br />\| limit 10|
|Nginx - OpenTelemetry|Top 10 URLs with 4xx Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where Status\_Code matches "4\*"<br />\| count as count by URL, Status\_Code<br />\| sort by count, URL asc \| limit 10|
|Nginx - OpenTelemetry|Top 10 URLs with 4xx Errors|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where Status\_Code matches "4\*"<br />\| count as count by URL, Status\_Code<br />\| sort by count, URL asc \| limit 10|
|Nginx - OpenTelemetry|Top 10 URLs with 5xx Errors|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where Status\_Code matches "5\*"<br />\| count as count by URL, Status\_Code<br />\| sort by count, URL asc \| limit 10|
|Nginx - OpenTelemetry|Top 10 URLs with 5xx Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where Status\_Code matches "5\*"<br />\| count as count by URL, Status\_Code<br />\| sort by count, URL asc \| limit 10|
|Nginx - OpenTelemetry/Logs|Top 5 Clients Causing 4xx Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "4\*"<br />\| count as count by Client\_Ip<br />\| sort count <br />\| limit 5 |
|Nginx - OpenTelemetry/Logs|Top 5 Clients Causing 4xx Errors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code matches "4\*"<br />\| count as count by Client\_Ip<br />\| sort count <br />\| limit 5 |
|Nginx - OpenTelemetry/Logs|Top 5 Clients causing Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where !isEmpty(client\_ip)<br />\| count by client\_ip<br />\| sort by \_count<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 Clients causing Errors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where !isEmpty(client\_ip)<br />\| count by client\_ip<br />\| sort by \_count<br />\| limit 5|
|Nginx - OpenTelemetry|Top 5 Critical Messages|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| count as Count by Message, Server<br />\| sort by Count<br />\| limit 5|
|Nginx - OpenTelemetry|Top 5 Critical Messages|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where log\_level in ("emerg", "alert", "crit")<br />\| count as Count by Message, Server<br />\| sort by Count<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 Highly Malicious URLs|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip, URL<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| where malicious\_confidence matches "high"<br />\| count by URL<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 Highly Malicious URLs|Logs|Nginx - OpenTelemetry/Logs/Nginx - Threat Intel| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as ip\_count by Client\_Ip, URL<br />\| lookup type, actor, raw, threatlevel as malicious\_confidence from sumo://threat/cs on threat=Client\_Ip <br />\| where malicious\_confidence matches "high"<br />\| count by URL<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 Referrers|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where referrer != "-"<br />\| count as count by referrer<br />\| sort by count<br />\| limit 5 |
|Nginx - OpenTelemetry/Logs|Top 5 Referrers|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where referrer != "-"<br />\| count as count by referrer<br />\| sort by count<br />\| limit 5 |
|Nginx - OpenTelemetry/Logs|Top 5 Servers with Errors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where !isEmpty(server)<br />\| count by server<br />\| sort by \_count<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 Servers with Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| where !isEmpty(server)<br />\| count by server<br />\| sort by \_count<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 URIs causing 404 Responses|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code = "404"<br />\| count as count by url<br />\| sort count, url asc<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 URIs causing 404 Responses|Logs|Nginx - OpenTelemetry/Logs/Nginx - Web Server Operations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where status\_code = "404"<br />\| count as count by url<br />\| sort count, url asc<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 URLs|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as count by url<br />\| sort by count<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 URLs|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Traffic Insight| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count as count by url<br />\| sort by count<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 URLs with Errors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| count by URL<br />\| sort by \_count<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Top 5 URLs with Errors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Error Logs| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "\\s\\[(?\<Log\_Level\>\\S+)\\]\\s\\d+#\\d+:\\s(?:\\\*\\d+\\s\|)(?\<Message\>[A-Za-z][^,]+)(?:,\|\$)"<br />\| parse regex field=nginx\_log\_message "client:\\s+(?\<Client\_Ip\>[^,]\*),\\s+server:\\s+(?\<Server\>[^,\$]\*)(?:,\\s+request:\\s+\\"(?\<Method\>[^ ]+)\\s+(?\<URL\>[^ ]+)\\s+HTTP\\/[\\d\\.]+\\",\\s+host:\\s+\\"(?\<Host\>[^\\"]+)\\")?"<br />\| count by URL<br />\| sort by \_count<br />\| limit 5|
|Nginx - OpenTelemetry/Metrics|Total Number of Client Requests|Metrics|Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.requests webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Metrics|Total Number of Client Requests|Metrics|Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.requests webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry|Total Number of Client Requests|Metrics|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.requests webengine.cluster.name={{webengine.cluster.name}} \| quantize using sum  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry|Total Number of Client Requests|Metrics|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.requests webengine.cluster.name={{webengine.cluster.name}} \| quantize using sum  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Metrics|Total Number of Handled Connections|Metrics|Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests|deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_handled webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Metrics|Total Number of Handled Connections|Metrics|Installed Apps/Nginx - OpenTelemetry/Metrics/Nginx - Connections and Requests|deployment.environment={{deployment.environment}} sumo.datasource=nginx metric = nginx.connections\_handled webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}}  \| sum by webengine.cluster.name|
|Nginx - OpenTelemetry/Logs|Traffic Distribution by Server|Logs|Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (isEmpty(pod),webengine.node.name,pod) as Host<br />\| timeslice 1h<br />\| count by \_timeslice, Host  <br />\| transpose row \_timeslice column Host|
|Nginx - OpenTelemetry/Logs|Traffic Distribution by Server|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (isEmpty(pod),webengine.node.name,pod) as Host<br />\| timeslice 1h<br />\| count by \_timeslice, Host  <br />\| transpose row \_timeslice column Host|
|Nginx - OpenTelemetry/Logs|Traffic Volume and Bytes Served|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where size != "-"<br />\| timeslice 1h<br />\| (size/(1048576\*1000)) as gbytes <br />\| count as hits, sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc|
|Nginx - OpenTelemetry/Logs|Traffic Volume and Bytes Served|Logs|Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| where size != "-"<br />\| timeslice 1h<br />\| (size/(1048576\*1000)) as gbytes <br />\| count as hits, sum(gbytes) as gbytes by \_timeslice <br />\| sort \_timeslice asc|
|Nginx - OpenTelemetry/Logs|Unique Visitors|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| Count by Client\_Ip<br />\| Count|
|Nginx - OpenTelemetry/Logs|Unique Visitors|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| Count by Client\_Ip<br />\| Count|
|Nginx - OpenTelemetry/Logs|United States|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| where country\_name="United States" AND !isNull(region) AND region !=""<br />\| sort \_count|
|Nginx - OpenTelemetry/Logs|United States|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| where country\_name="United States" AND !isNull(region) AND region !=""<br />\| sort \_count|
|Nginx - OpenTelemetry|Visitor Locations|Logs|Installed Apps/Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry|Visitor Locations|Logs|Nginx - OpenTelemetry/Nginx - Overview| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry/Logs|Visitor Locations (Top 5 Countries) - Today Vs. Yesterday|Logs|Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| where !isEmpty(country\_name)<br />\| count as Visitors\_Locations by country\_name<br />\| sort Visitors\_Locations <br />\| compare with timeshift 1d<br />\| order by Visitors\_Locations desc<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Visitor Locations (Top 5 Countries) - Today Vs. Yesterday|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Trends| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx <br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\sHTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| where !isEmpty(country\_name)<br />\| count as Visitors\_Locations by country\_name<br />\| sort Visitors\_Locations <br />\| compare with timeshift 1d<br />\| order by Visitors\_Locations desc<br />\| limit 5|
|Nginx - OpenTelemetry/Logs|Visitor Platforms|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count type<br />\| sort by \_count|
|Nginx - OpenTelemetry/Logs|Visitor Platforms|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| count type<br />\| sort by \_count|
|Nginx - OpenTelemetry/Logs|Visitors Platforms Over Time|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| timeslice 5m<br />\| count by \_timeslice, type<br />\| transpose row \_timeslice column type|
|Nginx - OpenTelemetry/Logs|Visitors Platforms Over Time|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Access Types| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| if (user\_agent matches "\*iPad\*" OR user\_agent matches "\*iPhone\*" OR user\_agent matches "\*Android\*" OR user\_agent matches "\*BlackBerry\*" OR user\_agent matches "\*Galaxy\*" OR user\_agent matches "LGE-\*" OR user\_agent matches "SCH-\*" OR user\_agent matches "\*HUAWEI-\*" OR user\_agent matches "\*SAMSUNG\*" OR user\_agent matches "\*samsung\*" OR user\_agent matches "Dalvik/\*" OR user\_agent matches "Nokia\*" OR user\_agent matches "LG-\*" OR user\_agent matches "\*CFNetwork\*"  OR user\_agent matches "\*UP.Browser/\*" OR user\_agent matches "\*QQ\*rowser\*" OR user\_agent matches "\*NetFront/\*" OR user\_agent matches "\*Windows Phone\*" OR user\_agent matches "\*Mobile Safari\*" OR user\_agent matches "\*iemobile\*","Mobile","") as type<br />\| if (user\_agent matches "\*Windows\*" OR user\_agent matches "\*Win64\*" OR user\_agent matches "\*Win32\*" OR user\_agent matches "\*i686\*" OR user\_agent matches "\*x86\*","PC",type) as type<br />\| if (user\_agent matches "\*Macintosh\*" OR user\_agent matches "\*Mac OS\*","Mac",type) as type<br />\| if (type = "","bots/unknown",type) as type<br />\| timeslice 5m<br />\| count by \_timeslice, type<br />\| transpose row \_timeslice column type|
|Nginx - OpenTelemetry/Logs|Visits by Country Over Time|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| timeslice 5m<br />\| count by \_timeslice, Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| where !isNull(country\_name) AND country\_name != ""<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \* |
|Nginx - OpenTelemetry/Logs|Visits by Country Over Time|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| timeslice 5m<br />\| count by \_timeslice, Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| where !isNull(country\_name) AND country\_name != ""<br />\| count by \_timeslice, country\_name<br />\| transpose row \_timeslice column country\_name as \* |
|Nginx - OpenTelemetry/Logs|Visits by US Regions Over Time|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| timeslice 5m<br />\| count by \_timeslice, Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| where country\_name="United States" AND !isNull(region) AND region !=""<br />\| count by \_timeslice, region<br />\| transpose row \_timeslice column region as \* |
|Nginx - OpenTelemetry/Logs|Visits by US Regions Over Time|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| timeslice 5m<br />\| count by \_timeslice, Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| where country\_name="United States" AND !isNull(region) AND region !=""<br />\| count by \_timeslice, region<br />\| transpose row \_timeslice column region as \* |
|Nginx - OpenTelemetry/Logs|WorldWide|Logs|Installed Apps/Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|
|Nginx - OpenTelemetry/Logs|WorldWide|Logs|Nginx - OpenTelemetry/Logs/Nginx - Visitor Locations| deployment.environment={{deployment.environment}} webengine.cluster.name={{webengine.cluster.name}} webengine.node.name={{webengine.node.name}} sumo.datasource=nginx<br />\| json auto maxdepth 1 nodrop<br />\| if (isEmpty(log), \_raw, log) as nginx\_log\_message<br />\| parse regex field=nginx\_log\_message "(?\<Client\_Ip\>(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\|\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})"<br />\| parse regex field=nginx\_log\_message "(?\<Method\>[A-Z]+)\\s+(?\<URL\>\\S+)\\s+HTTP/[\\d\\.]+\\"\\s+(?\<Status\_Code\>\\d+)\\s+(?\<Size\>[\\d-]+)\\s+\\"(?\<Referrer\>.\*?)\\"\\s+\\"(?\<User\_Agent\>.+?)\\".\*"<br />\| count by Client\_Ip<br />\| lookup latitude, longitude, country\_code, country\_name, region, city, postal\_code from geo://location on ip = Client\_Ip<br />\| count by latitude, longitude, country\_code, country\_name, region, city, postal\_code<br />\| sort \_count|

