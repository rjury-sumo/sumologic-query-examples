# Rapid7
## Sumo Logic App For: Rapid7
The Rapid7 App for Sumo Logic is a comprehensive solution that enables organizations to gain deeper insights into their asset and vulnerability management activities. The app is based on Sumo Logic's cloud-to-cloud Rapid7 source, which collects Assets and Vulnerabilities from Rapid7 and delivers them to Sumo Logic for analysis.

Using the Rapid7 App, users can monitor essential metrics concerning asset and vulnerability management. The app offers crucial information, including asset count, distribution of assets based on risk score and type, and a detailed breakdown of vulnerabilities based on severity and status. The app also includes tracking the count of newly identified vulnerabilities, vulnerabilities based on severity, and the most frequently occurring vulnerabilities. Using this information, users can prioritize remediation efforts, minimize attack surfaces, and make well-informed decisions to enhance their overall security posture.

In Summary, organizations can gain a deeper understanding of their asset and vulnerability management activities, enabling them to take proactive measures and optimize their overall security by leveraging this app.
Docs Link: [Rapid7](https://help.sumologic.com/?cid=10199)

## Searches

### Log Searches

- **Assets by Type**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Assets Overview 
- **Assets from Risky Geo Locations**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Assets Overview 
- **Geo Locations of Assets**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Assets Overview 
- **New Vulnerability Findings**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview 
- **Recent Scanned Assets**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Assets Overview 
- **Recent Vulnerabilities**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview 
- **Remediated Vulnerability Findings**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview 
- **Top 10 Assets by Vulnerability**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Assets Overview 
- **Top 10 Operating Systems**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Assets Overview 
- **Top 10 Solutions**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview 
- **Top 10 Vulnerabilities**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview 
- **Top 10 Vulnerable Assets**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Assets Overview 
- **Total Assets**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Assets Overview 
- **Vulnerabilities by Severity**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview 
- **Vulnerabilities Over Time**: from Dashboard: Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Rapid7|Assets by Type|Logs|Installed Apps/Rapid7/Rapid7 - Assets Overview|\_sourceCategory={{Logsdatasource}}   assessed\_for\_policies // fetches assets<br />\| json "id", "type", "os\_system\_name", "risk\_score", "host\_name", "ip","severe\_vulnerabilities", "total\_vulnerabilities", "last\_assessed\_for\_vulnerabilities", "mac", "last\_scan\_end", "tags[\*].name" as id, type, operating\_system, risk\_score, host\_name, ip, severe\_vulnerabilities, total\_vulnerabilities, last\_assessed\_time, mac, last\_scan\_end, tag\_name\_list nodrop<br />\| extract field=tag\_name\_list "\\"?(?\<tag\_name\>[\\w\\s\\-&.-z)(,]\*?)\\"?[,\\n\\]]" multi<br />\| where tag\_name matches "{{tag}}"<br />\| where operating\_system matches "{{operating\_system}}"<br />\| where !isNull(type)<br />\|count\_distinct(id) as frequency by type<br />\| sort by frequency|
|Rapid7|Assets from Risky Geo Locations|Logs|Installed Apps/Rapid7/Rapid7 - Assets Overview|\_sourceCategory={{Logsdatasource}}   assessed\_for\_policies // fetches assets<br />\| json "id", "type", "os\_system\_name", "risk\_score", "host\_name", "ip","severe\_vulnerabilities", "total\_vulnerabilities", "last\_assessed\_for\_vulnerabilities", "mac", "last\_scan\_end", "tags[\*].name" as id, type, operating\_system, risk\_score, host\_name, ip, severe\_vulnerabilities, total\_vulnerabilities, last\_assessed\_time, mac, last\_scan\_end, tag\_name\_list nodrop<br />\| extract field=tag\_name\_list "\\"?(?\<tag\_name\>[\\w\\s\\-&.-z)(,]\*?)\\"?[,\\n\\]]" multi<br />\| where tag\_name matches "{{tag}}"<br />\| where operating\_system matches "{{operating\_system}}"<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = ip<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isBlank(country\_code)|
|Rapid7|Geo Locations of Assets|Logs|Installed Apps/Rapid7/Rapid7 - Assets Overview|\_sourceCategory={{Logsdatasource}}   assessed\_for\_policies // fetches assets<br />\| json "id", "type", "os\_system\_name", "risk\_score", "host\_name", "ip","severe\_vulnerabilities", "total\_vulnerabilities", "last\_assessed\_for\_vulnerabilities", "mac", "last\_scan\_end", "tags[\*].name" as id, type, operating\_system, risk\_score, host\_name, ip, severe\_vulnerabilities, total\_vulnerabilities, last\_assessed\_time, mac, last\_scan\_end, tag\_name\_list nodrop<br />\| extract field=tag\_name\_list "\\"?(?\<tag\_name\>[\\w\\s\\-&.-z)(,]\*?)\\"?[,\\n\\]]" multi<br />\| where tag\_name matches "{{tag}}"<br />\| where operating\_system matches "{{operating\_system}}"<br />\| where isValidIPv4(ip) or isValidIPv6(ip)<br />\| where !isNull(ip)<br />\| if(isValidIPv4(ip), if(!isPrivateIP(ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by ip<br />\| lookup latitude, longitude from geo://location on ip = ip|
|Rapid7|New Vulnerability Findings|Logs|Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview|\_sourceCategory={{Logsdatasource}}   asset\_id // vulnerabilities related to assets<br />\| json "vulnerability\_id","finding\_status","solution\_id","solution\_summary","solution\_type" as vulnerability\_id, finding\_status, solution\_id, solution\_summary, solution\_type nodrop<br />\| where finding\_status="new"<br />\| count\_distinct(vulnerability\_id)|
|Rapid7|Recent Scanned Assets|Logs|Installed Apps/Rapid7/Rapid7 - Assets Overview|\_sourceCategory={{Logsdatasource}}   assessed\_for\_policies // fetches assets<br />\| json "id", "type", "os\_system\_name", "risk\_score", "host\_name", "ip","severe\_vulnerabilities", "total\_vulnerabilities", "last\_assessed\_for\_vulnerabilities", "mac", "last\_scan\_end", "tags[\*].name" as id, type, operating\_system, risk\_score, host\_name, ip, severe\_vulnerabilities, total\_vulnerabilities, last\_assessed\_time, mac, last\_scan\_end, tag\_name\_list nodrop<br />\| extract field=tag\_name\_list "\\"?(?\<tag\_name\>[\\w\\s\\-&.-z)(,]\*?)\\"?[,\\n\\]]" multi<br />\| where tag\_name matches "{{tag}}"<br />\| where operating\_system matches "{{operating\_system}}"<br />\| if(isNull(host\_name),"-",host\_name) as host\_name<br />\| count\_distinct(id) as frequency by id, ip, host\_name, operating\_system, last\_assessed\_time, total\_vulnerabilities, severe\_vulnerabilities, risk\_score, last\_scan\_end<br />\| extract field=last\_assessed\_time "(?\<date\>.\*)T(?\<time\>\\d\*:\\d\*:\\d\*)"<br />\| concat(date," ",time) as last\_assessed\_time<br />\| extract field=last\_scan\_end "(?\<date\>.\*)T(?\<time\>\\d\*:\\d\*:\\d\*)"<br />\| concat(date," ",time) as last\_scan\_end<br />\| number(risk\_score)<br />\| format( "%.2f",risk\_score) as risk\_score<br />\| top 100 id, ip, host\_name, operating\_system, last\_assessed\_time, total\_vulnerabilities, severe\_vulnerabilities, risk\_score, last\_scan\_end by last\_scan\_end|
|Rapid7|Recent Vulnerabilities|Logs|Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview|\_sourceCategory={{Logsdatasource}}   (cvss\_v2\_access\_complexity or asset\_id) <br />\| join<br />(json "id","severity","risk\_score","title" as id, severity,risk\_score, title) as vulnerability,<br />(json "vulnerability\_id","asset\_id","finding\_status","last\_found" as vulnerability\_id, asset\_id, finding\_status, last\_found) as asset\_vulnerability<br />on vulnerability.id=asset\_vulnerability.vulnerability\_id // get information of asset related vulnerabilities from knowledge base<br />\| fields vulnerability\_severity, vulnerability\_id, vulnerability\_risk\_score, asset\_vulnerability\_asset\_id, asset\_vulnerability\_finding\_status, vulnerability\_title, asset\_vulnerability\_last\_found<br />\| first(asset\_vulnerability\_finding\_status) as asset\_vulnerability\_finding\_status group by vulnerability\_id, asset\_vulnerability\_asset\_id, vulnerability\_severity, vulnerability\_risk\_score, vulnerability\_title, asset\_vulnerability\_last\_found<br />\| count\_distinct(vulnerability\_id) as frequency by vulnerability\_id, vulnerability\_severity, vulnerability\_risk\_score, vulnerability\_title, asset\_vulnerability\_last\_found, asset\_vulnerability\_finding\_status, asset\_vulnerability\_asset\_id<br />\| extract field=asset\_vulnerability\_last\_found "(?\<date\>.\*)T(?\<time\>\\d\*:\\d\*:\\d\*)" <br />\| concat(date," ",time) as asset\_vulnerability\_last\_found<br />\| asset\_vulnerability\_asset\_id as asset\_id<br />\| asset\_vulnerability\_last\_found as last\_found<br />\| top 100 vulnerability\_title, vulnerability\_id, vulnerability\_severity, vulnerability\_risk\_score, asset\_vulnerability\_finding\_status, asset\_id by last\_found|
|Rapid7|Remediated Vulnerability Findings|Logs|Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview|\_sourceCategory={{Logsdatasource}}   asset\_id //vulnerabilities related to assets<br />\| json "vulnerability\_id","finding\_status","solution\_id","solution\_summary","solution\_type" as vulnerability\_id, finding\_status, solution\_id, solution\_summary, solution\_type nodrop<br />\| where finding\_status="remediated"<br />\| count\_distinct(vulnerability\_id)|
|Rapid7|Top 10 Assets by Vulnerability|Logs|Installed Apps/Rapid7/Rapid7 - Assets Overview|\_sourceCategory={{Logsdatasource}}   assessed\_for\_policies // fetches assets<br />\| json "id", "type", "os\_system\_name", "risk\_score", "host\_name", "ip","severe\_vulnerabilities", "total\_vulnerabilities", "last\_assessed\_for\_vulnerabilities", "mac", "last\_scan\_end", "tags[\*].name" as id, type, operating\_system, risk\_score, host\_name, ip, severe\_vulnerabilities, total\_vulnerabilities, last\_assessed\_time, mac, last\_scan\_end, tag\_name\_list nodrop<br />\| extract field=tag\_name\_list "\\"?(?\<tag\_name\>[\\w\\s\\-&.-z)(,]\*?)\\"?[,\\n\\]]" multi<br />\| where tag\_name matches "{{tag}}"<br />\| where operating\_system matches "{{operating\_system}}"<br />\| if(isNull(host\_name),"-",host\_name) as host\_name<br />\| if(isNull(mac),"-",mac) as mac<br />\| count\_distinct(id) as frequency by id, ip, host\_name, mac, last\_assessed\_time, severe\_vulnerabilities, total\_vulnerabilities<br />\| extract field=last\_assessed\_time "(?\<date\>.\*)T(?\<time\>\\d\*:\\d\*:\\d\*)"<br />\| concat(date," ",time) as last\_assessed\_time<br />\| number(total\_vulnerabilities)<br />\| sort by total\_vulnerabilities<br />\| limit 10<br />\| fields -frequency, \_some\_matched, date, time|
|Rapid7|Top 10 Operating Systems|Logs|Installed Apps/Rapid7/Rapid7 - Assets Overview|\_sourceCategory={{Logsdatasource}}   assessed\_for\_policies // fetches assets<br />\| json "id", "type", "os\_system\_name", "risk\_score", "host\_name", "ip","severe\_vulnerabilities", "total\_vulnerabilities", "last\_assessed\_for\_vulnerabilities", "mac", "last\_scan\_end", "tags[\*].name" as id, type, operating\_system, risk\_score, host\_name, ip, severe\_vulnerabilities, total\_vulnerabilities, last\_assessed\_time, mac, last\_scan\_end, tag\_name\_list nodrop<br />\| extract field=tag\_name\_list "\\"?(?\<tag\_name\>[\\w\\s\\-&.-z)(,]\*?)\\"?[,\\n\\]]" multi<br />\| where tag\_name matches "{{tag}}"<br />\| where operating\_system matches "{{operating\_system}}"<br />\| where !isNull(os\_system\_name)<br />\| count\_distinct(id) as frequency by os\_system\_name<br />\| sort by frequency<br />\| limit 10|
|Rapid7|Top 10 Solutions|Logs|Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview|\_sourceCategory={{Logsdatasource}}   asset\_id // vulnerabilities related to assets<br />\| json "vulnerability\_id","finding\_status","solution\_id","solution\_summary","solution\_type" as vulnerability\_id, finding\_status, solution\_id, solution\_summary, solution\_type nodrop<br />\| where !isNUll(solution\_id) or !isNull(solution\_summary) or !isNull(solution\_type)<br />\| count\_distinct(vulnerability\_id) as vulnerabilities by solution\_id, solution\_summary, solution\_type<br />\| sort by vulnerabilities<br />\| limit 10|
|Rapid7|Top 10 Vulnerabilities|Logs|Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview|\_sourceCategory={{Logsdatasource}}   (cvss\_v2\_access\_complexity or asset\_id) <br />\| join<br />(json "id","severity","risk\_score" as id, severity,risk\_score) as vulnerability,<br />(json "vulnerability\_id","asset\_id","finding\_status" as vulnerability\_id, asset\_id, finding\_status) as asset\_vulnerability<br />on vulnerability.id=asset\_vulnerability.vulnerability\_id // get information of asset related vulnerabilities from knowledge base<br />\| fields vulnerability\_severity, vulnerability\_id, vulnerability\_risk\_score, asset\_vulnerability\_asset\_id, asset\_vulnerability\_finding\_status<br />\| first(asset\_vulnerability\_finding\_status) as aasset\_vulnerability\_finding\_status group by vulnerability\_id, asset\_vulnerability\_asset\_id, vulnerability\_severity, vulnerability\_risk\_score<br />\| count\_distinct(asset\_vulnerability\_asset\_id) as related\_assets by vulnerability\_id, vulnerability\_severity, vulnerability\_risk\_score<br />\| sort by related\_assets     <br />\| limit 10|
|Rapid7|Top 10 Vulnerable Assets|Logs|Installed Apps/Rapid7/Rapid7 - Assets Overview|\_sourceCategory={{Logsdatasource}}   assessed\_for\_policies // fetches assets<br />\| json "id", "type", "os\_system\_name", "risk\_score", "host\_name", "ip","severe\_vulnerabilities", "total\_vulnerabilities", "last\_assessed\_for\_vulnerabilities", "mac", "last\_scan\_end", "tags[\*].name" as id, type, operating\_system, risk\_score, host\_name, ip, severe\_vulnerabilities, total\_vulnerabilities, last\_assessed\_time, mac, last\_scan\_end, tag\_name\_list nodrop<br />\| extract field=tag\_name\_list "\\"?(?\<tag\_name\>[\\w\\s\\-&.-z)(,]\*?)\\"?[,\\n\\]]" multi<br />\| where tag\_name matches "{{tag}}"<br />\| where operating\_system matches "{{operating\_system}}"<br />\| where !isNull(risk\_score) <br />\| if(isNull(host\_name),"-",host\_name) as host\_name<br />\| count\_distinct(id) as frequency by id, ip, host\_name, mac, last\_assessed\_time, risk\_score<br />\| extract field=last\_assessed\_time "(?\<date\>.\*)T(?\<time\>\\d\*:\\d\*:\\d\*)"<br />\| concat(date," ",time) as last\_assessed\_time<br />\| number(risk\_score)<br />\| sort by risk\_score<br />\| format( "%.2f",risk\_score) as risk\_score<br />\| limit 10<br />\| fields -frequency, \_some\_matched, date, time|
|Rapid7|Total Assets|Logs|Installed Apps/Rapid7/Rapid7 - Assets Overview|\_sourceCategory={{Logsdatasource}}   assessed\_for\_policies // fetches assets<br />\| json "id", "type", "os\_system\_name", "risk\_score", "host\_name", "ip","severe\_vulnerabilities", "total\_vulnerabilities", "last\_assessed\_for\_vulnerabilities", "mac", "last\_scan\_end", "tags[\*].name" as id, type, operating\_system, risk\_score, host\_name, ip, severe\_vulnerabilities, total\_vulnerabilities, last\_assessed\_time, mac, last\_scan\_end, tag\_name\_list nodrop<br />\| extract field=tag\_name\_list "\\"?(?\<tag\_name\>[\\w\\s\\-&.-z)(,]\*?)\\"?[,\\n\\]]" multi<br />\| where tag\_name matches "{{tag}}"<br />\| where operating\_system matches "{{operating\_system}}"<br />\| count\_distinct(id)|
|Rapid7|Vulnerabilities by Severity|Logs|Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview|\_sourceCategory={{Logsdatasource}}   cvss\_v2\_access\_complexity <br />\| json "id","severity" as id, severity nodrop<br />\| where [subquery: \_sourceCategory={{Logsdatasource}}   asset\_id //vulnerabilities related to assets<br />  \| json "vulnerability\_id" as id nodrop<br />  \| compose id]<br />\| count\_distinct(id) as frequency by severity<br />\| sort by frequency|
|Rapid7|Vulnerabilities Over Time|Logs|Installed Apps/Rapid7/Rapid7 - Vulnerabilities Overview|\_sourceCategory={{Logsdatasource}}   asset\_id // vulnerabilities related to assets <br />\| json "vulnerability\_id","finding\_status","solution\_id","solution\_summary","solution\_type" as vulnerability\_id, finding\_status, solution\_id, solution\_summary, solution\_type nodrop<br />\| where !(finding\_status="same")<br />\| where !isNull(finding\_status)<br />\| timeslice 1d<br />\| count\_distinct(vulnerability\_id) as frequency by \_timeslice, finding\_status<br />\| fillmissing timeslice, values all in finding\_status<br />\| transpose row \_timeslice column finding\_status|

