# Proofpoint TAP
## Sumo Logic App For: Proofpoint TAP
The Proofpoint TAP App for Sumo Logic is designed to provide comprehensive visibility and analysis of messages and clicks of malicious URLs. This app leverages the Sumo Logic Cloud-to-Cloud Proofpoint TAP source to collect and ingest data from Proofpoint TAP, enabling security teams to gain valuable insights and take proactive measures to protect their organization's infrastructure.
Docs Link: [Proofpoint TAP](https://help.sumologic.com/?cid=10210)

## Searches

### Log Searches

- **Blocked Clicks**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Blocked Messages**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Clicks from High Risk Countries**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Clicks Trend**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Geo Locations of Clicks**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Geo Locations of Senders**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Geo Locations of Senders**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Messages by Disposition Status**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Messages by Sandbox Status**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Messages from High Risk Countries**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Messages Trend**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Number of Clicks**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Number of Messages**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Recent Clicks**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Recent Messages**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Senders from High Risk Countries**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Threats by Category**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Threats by Category**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Threats by Status**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Threats by Status**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Threats by Type**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Top 10 Clicked URLs**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Top 10 Clusters**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Top 10 Policy Routes Matched**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Top 10 PPS Modules**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Top 10 Receivers**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview 
- **Top 10 Receivers**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Top 10 Senders**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview 
- **Top 10 Senders**: from Dashboard: Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview

### Metric Searches


## Search Table

|app\_topic|search\_name|type|origin|search|
|:--|:--|:--|:--|:--|
|Proofpoint TAP|Blocked Clicks|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| where type matches "CLICK\_BLOCKED"<br />\| count\_distinct(id)|
|Proofpoint TAP|Blocked Messages|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| where type matches "MESSAGE\_BLOCKED"<br />\| count\_distinct(id)|
|Proofpoint TAP|Clicks from High Risk Countries|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| where isValidIPv4(click\_ip) or isValidIPv6(click\_ip)<br />\| where !isNull(click\_ip)<br />\| if(isValidIPv4(click\_ip), if(!isPrivateIP(click\_ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by click\_ip<br />\| lookup latitude, longitude,country\_code from geo://location on ip = click\_ip<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isEmpty(country\_code)|
|Proofpoint TAP|Clicks Trend|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| timeslice 1d<br />\| count\_distinct(id) as frequency by \_timeslice,type<br />\| fillmissing timeslice, values all in type<br />\| transpose row \_timeslice column type<br />|
|Proofpoint TAP|Geo Locations of Clicks|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| where isValidIPv4(click\_ip) or isValidIPv6(click\_ip)<br />\| where !isNull(click\_ip)<br />\| if(isValidIPv4(click\_ip), if(!isPrivateIP(click\_ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by click\_ip<br />\| lookup latitude, longitude from geo://location on ip = click\_ip|
|Proofpoint TAP|Geo Locations of Senders|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| where isValidIPv4(sender\_ip) or isValidIPv6(sender\_ip)<br />\| where !isNull(sender\_ip)<br />\| if(isValidIPv4(sender\_ip), if(!isPrivateIP(sender\_ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by sender\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = sender\_ip|
|Proofpoint TAP|Geo Locations of Senders|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| where isValidIPv4(sender\_ip) or isValidIPv6(sender\_ip)<br />\| where !isNull(sender\_ip)<br />\| if(isValidIPv4(sender\_ip), if(!isPrivateIP(sender\_ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by sender\_ip<br />\| lookup latitude, longitude from geo://location on ip = sender\_ip|
|Proofpoint TAP|Messages by Disposition Status|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| extract field=dispositions "\\"?(?\<disposition\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| where !isEmpty(disposition)<br />\| count\_distinct(id) as frequency by disposition<br />\| sort by frequency|
|Proofpoint TAP|Messages by Sandbox Status|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| extract field=sandboxStatuses "\\"?(?\<sandboxStatus\>[\\w\\s\\-&.,]\*?)\\"?[,\\n\\]]" multi<br />\| where sandboxStatus!="null" and !isBlank(sandboxStatus)<br />\| count\_distinct(id) as frequency by sandboxStatus<br />\| sort by frequency|
|Proofpoint TAP|Messages from High Risk Countries|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| where isValidIPv4(sender\_ip) or isValidIPv6(sender\_ip)<br />\| where !isNull(sender\_ip)<br />\| if(isValidIPv4(sender\_ip), if(!isPrivateIP(sender\_ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by sender\_ip<br />\| lookup latitude, longitude, country\_code from geo://location on ip = sender\_ip<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isEmpty(country\_code)<br />|
|Proofpoint TAP|Messages Trend|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| timeslice 1d<br />\| count\_distinct(id) as frequency by \_timeslice,type<br />\| fillmissing timeslice, values all in type<br />\| transpose row \_timeslice column type<br />|
|Proofpoint TAP|Number of Clicks|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| count\_distinct(id)|
|Proofpoint TAP|Number of Messages|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| count\_distinct(id)|
|Proofpoint TAP|Recent Clicks|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus","url" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status,url nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| count\_distinct(id) by \_messageTime,id,type,url,sender,recipient,category,threat\_status,threat\_url<br />\| formatDate(toLong(\_messageTime),"dd-MM-yyyy HH:mm:ss") as time\_stamp<br />\| tourl(threat\_url, threat\_url,"","") as threat\_url<br />\| top 100 url,sender,recipient,type,category,threat\_status,threat\_url by time\_stamp|
|Proofpoint TAP|Recent Messages|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| count\_distinct(id) by \_messageTime,id,type,sender,recipient,modules\_run,policy\_route,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject<br />\| formatDate(toLong(\_messageTime),"dd-MM-yyyy HH:mm:ss") as time\_stamp<br />\| top 100 subject,type,sender,recipient,threat\_categories,threat\_types,threat\_status,modules\_run,policy\_route,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule by time\_stamp|
|Proofpoint TAP|Senders from High Risk Countries|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| where isValidIPv4(sender\_ip) or isValidIPv6(sender\_ip)<br />\| where !isNull(sender\_ip)<br />\| if(isValidIPv4(sender\_ip), if(!isPrivateIP(sender\_ip),true,false),true) as is\_public<br />\| where is\_public<br />\| count\_distinct(id) as frequency by sender\_ip<br />\| lookup latitude, longitude,country\_code from geo://location on ip = sender\_ip<br />\| lookup country\_code from https://sumologic-app-data.s3.amazonaws.com/riskycountries.csv on country\_code=country\_code<br />\| where !isEmpty(country\_code)|
|Proofpoint TAP|Threats by Category|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| count\_distinct(id) as frequency by threat\_category<br />\| sort by frequency|
|Proofpoint TAP|Threats by Category|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| count\_distinct(id) as frequency by category<br />\| sort by frequency|
|Proofpoint TAP|Threats by Status|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| count\_distinct(id) as frequency by status<br />\| sort by frequency|
|Proofpoint TAP|Threats by Status|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| count\_distinct(id) as frequency by threat\_status<br />\| sort by frequency|
|Proofpoint TAP|Threats by Type|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| count\_distinct(id) as frequency by threat\_type<br />\| sort by frequency|
|Proofpoint TAP|Top 10 Clicked URLs|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus","url" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status,url nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| count\_distinct(id) as frequency by url<br />\| sort by frequency <br />\| limit 10|
|Proofpoint TAP|Top 10 Clusters|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| count\_distinct(id) as frequency by cluster<br />\| sort by frequency<br />\| limit 10<br />|
|Proofpoint TAP|Top 10 Policy Routes Matched|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| where !isEmpty(policy)<br />\| count\_distinct(id) as frequency by policy<br />\| sort by frequency<br />\| limit 10|
|Proofpoint TAP|Top 10 PPS Modules|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| where !isEmpty(module)<br />\| count\_distinct(id) as frequency by module<br />\| sort by frequency<br />\| limit 10|
|Proofpoint TAP|Top 10 Receivers|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| where !isEmpty(recipient)<br />\| count\_distinct(id) as frequency by recipient<br />\| sort by frequency<br />\| limit 10|
|Proofpoint TAP|Top 10 Receivers|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| count\_distinct(id) as frequency by recipient<br />\| sort by frequency<br />\| limit 10|
|Proofpoint TAP|Top 10 Senders|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Clicks Overview|\_sourceCategory={{Logsdatasource}}   ("CLICK\_PERMITTED" or "CLICK\_BLOCKED")<br />\| json "id","type","threatUrl","classification","clickIP","senderIP","sender","recipient","threatStatus" as id,type,threat\_url,category,click\_ip,sender\_ip,sender,recipient,threat\_status nodrop<br /><br />\| where type matches "{{click\_type}}"<br />\| where category matches "{{threat\_category}}"<br />\| where threat\_status matches "{{threat\_status}}"<br /><br />\| count\_distinct(id) as frequency by sender<br />\| sort by frequency<br />\| limit 10|
|Proofpoint TAP|Top 10 Senders|Logs|Installed Apps/Proofpoint TAP/Proofpoint TAP - Messages Overview|\_sourceCategory={{Logsdatasource}}   ("MESSAGE\_BLOCKED" OR "MESSAGE\_DELIVERED")<br />\| json "id","type","cluster","sender","recipient","messageParts[\*].disposition","messageParts[\*].sandboxStatus","messageSize","modulesRun","policyRoutes","senderIP","threatsInfoMap[\*].classification","threatsInfoMap[\*].threatType","threatsInfoMap[\*].threatStatus","impostorScore","malwareScore","phishScore","spamScore","quarantineFolder","quarantineRule","subject" as id,type,cluster,sender,recipient,dispositions,sandboxStatuses,messageSize,modules\_run,policy\_route,sender\_ip,threat\_categories,threat\_types,threat\_status,impostor\_score,malware\_score,phish\_score,spam\_score,quarantine\_folder,quarantine\_rule,subject nodrop<br /><br />\| extract field=threat\_status "\\"?(?\<status\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_types "\\"?(?\<threat\_type\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=threat\_categories "\\"?(?\<threat\_category\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=modules\_run "\\"?(?\<module\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br />\| extract field=policy\_route "\\"?(?\<policy\>[\\w\\s\\-&.,]\*)\\"?[,\\n\\]]" multi<br /><br />\| where type matches "{{message\_type}}"<br />\| where threat\_category matches "{{threat\_category}}"<br />\| where threat\_type matches "{{threat\_type}}"<br />\| where status matches "{{threat\_status}}"<br />\| where module matches "{{module}}"<br />\| where policy matches "{{policy\_route}}"<br /><br />\| where !isEmpty(sender)<br />\| count\_distinct(id) as frequency by sender<br />\| sort by frequency<br />\| limit 10|

