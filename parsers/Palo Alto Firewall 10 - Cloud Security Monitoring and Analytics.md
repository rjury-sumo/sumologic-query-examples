# Parsers For Palo Alto Firewall 10 - Cloud Security Monitoring and Analytics

## Parser:
```
| csv _raw extract 1 as f1, 2 as Receive_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src_ip, 9 as dest_ip, 10 as NAT_src_ip, 11 as NAT_dest_ip, 12 as ruleName, 13 as src_user, 14 as dest_user, 15 as app, 16 as vsys, 17 as src_zone, 18 as dest_zone, 19 as inbound_interface, 20 as outbound_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src_port, 26 as dest_port, 27 as NAT_src_port, 28 as NAT_dest_port, 29 as flags, 30 as protocol, 31 as action, 32 as bytes, 33 as bytes_sent, 34 as bytes_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src_Country, 43 as dest_country, 44 as f5, 45 as pkts_sent, 46 as pkts_received, 47 as session_end_reason, 48 as Device_Group_Hierarchy_l1, 49 as Device_Group_Hierarchy_l2, 50 as Device_Group_Hierarchy_l3, 51 as Device_Group_Hierarchy_l4, 52 as vsys_Name, 53 as DeviceName, 54 as action_source, 55 as Source_VM_UUID, 56 as Destination_VM_UUID, 57 as Tunnel_ID_IMSI, 58 as Monitor_Tag_IMEI, 59 as Parent_Session_ID, 60 as parent_start_time, 61 as Tunnel, 62 as SCTP_Association_ID, 63 as SCTP_Chunks, 64 as SCTP_Chunks_Sent, 65 as SCTP_Chunks_Received, 66 as UUIDforrule, 67 as HTTP2Connection, 68 as AppFlapCount ,69 as PolicyID ,70 as LinkSwitches ,71 as SDWANCluster ,72 as SDWANDeviceType ,73 as SDWANClusterType ,74 as SDWANSite ,75 as DynamicUserGroupName ,76 as XFFAddress ,77 as SourceDeviceCategory ,78 as SourceDeviceProfile ,79 as SourceDeviceModel ,80 as SourceDeviceVendor ,81 as SourceDeviceOSFamily ,82 as SourceDeviceOSVersion ,83 as SourceHostname ,84 as SourceMACAddress ,85 as DestinationDeviceCategory ,86 as DestinationDeviceProfile ,87 as DestinationDeviceModel ,88 as DestinationDeviceVendor ,89 as DestinationDeviceOSFamily ,90 as DestinationDeviceOSVersion ,91 as DestinationHostname ,92 as DestinationMACAddress ,93 as ContainerID ,94 as PODNamespace ,95 as PODName ,96 as SourceExternalDynamicList ,97 as DestinationExternalDynamicList ,98 as HostID ,99 as UserDeviceSerialNumber ,100 as SourceDynamicAddressGroup ,101 as DestinationDynamicAddressGroup ,102 as SessionOwner ,103 as HighResolutionTimestamp
 
```
### Use Cases:
Allowed Network Activity by Direction, Allowed Traffic Over Time, App is Incomplete, Not-Applicable, or Insufficient Data, App is Named, Daily Trend, Day Over Day Outbound DNS Activity, Denied Traffic Over Time, Detail, DNS Traffic - Multi-Dimensional Outlier (Outbound), DNS Traffic - Parameterized Outlier Lookup, Horizontal Port Scanning (1src, 1port, multi-dest), INBOUND Traffic from OFAC Countries, Outbound DNS by src_ip, Outbound Traffic by App, Outbound Traffic by src_ip, Outbound Traffic Deltas by App - Now vs Last Week, Same Time Window, OUTBOUND Traffic to OFAC Countries, Port Scanning Behavior (1src, 1dst, multi-port), Port Scanning Behavior (1src, 1port, multi-dest), Source IP by Bytes Sent, Stacked Count by Port, THREAT Traffic Categories by Timeslice, Top 10 Host - Receiving Inbound Traffic, Top 10 Host - Sending Outbound Traffic, Top 20 Hosts with Outbound DNS Traffic, Top 20 Hosts with Outbound Traffic, Top Destination IP, Top Source IP, Total, Traffic from OFAC Countries - Inbound, Traffic to OFAC Countries - Outbound, Trend, Vertical Port Scan (1src, 1dst, multi-port)



## Parser:
```
| csv _raw extract 1 as f1, 2 as Receive_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src_ip, 9 as dest_ip, 10 as NAT_src_ip, 11 as NAT_dest_ip, 12 as ruleName, 13 as src_user, 14 as dest_user, 15 as app, 16 as vsys, 17 as src_zone, 18 as dest_zone, 19 as inbound_interface, 20 as outbound_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src_port, 26 as dest_port, 27 as NAT_src_port, 28 as NAT_dest_port, 29 as flags, 30 as protocol, 31 as action, 32 as bytes, 33 as bytes_sent, 34 as bytes_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src_Country, 43 as dest_country, 44 as f5, 45 as pkts_sent, 46 as pkts_received, 47 as session_end_reason, 48 as Device_Group_Hierarchy_l1, 49 as Device_Group_Hierarchy_l2, 50 as Device_Group_Hierarchy_l3, 51 as Device_Group_Hierarchy_l4, 52 as vsys_Name, 53 as DeviceName, 54 as action_source, 55 as Source_VM_UUID, 56 as Destination_VM_UUID, 57 as Tunnel_ID_IMSI, 58 as Monitor_Tag_IMEI, 59 as Parent_Session_ID, 60 as parent_start_time, 61 as Tunnel, 62 as SCTP_Association_ID, 63 as SCTP_Chunks, 64 as SCTP_Chunks_Sent, 65 as SCTP_Chunks_Received, 66 as UUIDforrule, 67 as HTTP2Connection, 68 as AppFlapCount ,69 as PolicyID ,70 as LinkSwitches ,71 as SDWANCluster ,72 as SDWANDeviceType ,73 as SDWANClusterType ,74 as SDWANSite ,75 as DynamicUserGroupName ,76 as XFFAddress ,77 as SourceDeviceCategory ,78 as SourceDeviceProfile ,79 as SourceDeviceModel ,80 as SourceDeviceVendor ,81 as SourceDeviceOSFamily ,82 as SourceDeviceOSVersion ,83 as SourceHostname ,84 as SourceMACAddress ,85 as DestinationDeviceCategory ,86 as DestinationDeviceProfile ,87 as DestinationDeviceModel ,88 as DestinationDeviceVendor ,89 as DestinationDeviceOSFamily ,90 as DestinationDeviceOSVersion ,91 as DestinationHostname ,92 as DestinationMACAddress ,93 as ContainerID ,94 as PODNamespace ,95 as PODName ,96 as SourceExternalDynamicList ,97 as DestinationExternalDynamicList ,98 as HostID ,99 as UserDeviceSerialNumber ,100 as SourceDynamicAddressGroup ,101 as DestinationDynamicAddressGroup ,102 as SessionOwner ,103 as HighResolutionTimestamp ,104 as ASliceServiceType ,105 as ASliceDifferentiator
 
```
### Use Cases:
Allowed Network Activity by Direction, Allowed Traffic Over Time, App is Incomplete, Not-Applicable, or Insufficient Data, App is Named, Daily Trend, Day Over Day Outbound DNS Activity, Denied Traffic Over Time, Detail, DNS Traffic - Multi-Dimensional Outlier (Outbound), DNS Traffic - Parameterized Outlier Lookup, Horizontal Port Scanning (1src, 1port, multi-dest), INBOUND Traffic from OFAC Countries, Outbound DNS by src_ip, Outbound Traffic by App, Outbound Traffic by src_ip, Outbound Traffic Deltas by App - Now vs Last Week, Same Time Window, OUTBOUND Traffic to OFAC Countries, Port Scanning Behavior (1src, 1dst, multi-port), Port Scanning Behavior (1src, 1port, multi-dest), Source IP by Bytes Sent, Stacked Count by Port, THREAT Traffic Categories by Timeslice, Top 10 Host - Receiving Inbound Traffic, Top 10 Host - Sending Outbound Traffic, Top 20 Hosts with Outbound DNS Traffic, Top 20 Hosts with Outbound Traffic, Top Destination IP, Top Source IP, Total, Traffic from OFAC Countries - Inbound, Traffic to OFAC Countries - Outbound, Trend, Vertical Port Scan (1src, 1dst, multi-port)



## Parser:
```
| csv _raw extract 1 as f1, 2 as Receive_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src_ip, 9 as dest_ip, 10 as NAT_src_ip, 11 as NAT_dest_ip, 12 as ruleName, 13 as src_user, 14 as dest_user, 15 as app, 16 as vsys, 17 as src_zone, 18 as dest_zone, 19 as inbound_interface, 20 as outbound_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src_port, 26 as dest_port, 27 as NAT_src_port, 28 as NAT_dest_port, 29 as flags, 30 as protocol, 31 as action, 32 as bytes, 33 as bytes_sent, 34 as bytes_recv, 35 as Packets, 36 as StartTime, 37 as ElapsedTime, 38 as Category, 39 as f4, 40 as seqNum, 41 as ActionFlags, 42 as src_Country, 43 as dest_country, 44 as f5, 45 as pkts_sent, 46 as pkts_received, 47 as session_end_reason, 48 as Device_Group_Hierarchy_l1, 49 as Device_Group_Hierarchy_l2, 50 as Device_Group_Hierarchy_l3, 51 as Device_Group_Hierarchy_l4, 52 as vsys_Name, 53 as DeviceName, 54 as action_source, 55 as Source_VM_UUID, 56 as Destination_VM_UUID, 57 as Tunnel_ID_IMSI, 58 as Monitor_Tag_IMEI, 59 as Parent_Session_ID, 60 as parent_start_time, 61 as Tunnel, 62 as SCTP_Association_ID, 63 as SCTP_Chunks, 64 as SCTP_Chunks_Sent, 65 as SCTP_Chunks_Received, 66 as UUIDforrule, 67 as HTTP2Connection, 68 as AppFlapCount ,69 as PolicyID ,70 as LinkSwitches ,71 as SDWANCluster ,72 as SDWANDeviceType ,73 as SDWANClusterType ,74 as SDWANSite ,75 as DynamicUserGroupName ,76 as XFFAddress ,77 as SourceDeviceCategory ,78 as SourceDeviceProfile ,79 as SourceDeviceModel ,80 as SourceDeviceVendor ,81 as SourceDeviceOSFamily ,82 as SourceDeviceOSVersion ,83 as SourceHostname ,84 as SourceMACAddress ,85 as DestinationDeviceCategory ,86 as DestinationDeviceProfile ,87 as DestinationDeviceModel ,88 as DestinationDeviceVendor ,89 as DestinationDeviceOSFamily ,90 as DestinationDeviceOSVersion ,91 as DestinationHostname ,92 as DestinationMACAddress ,93 as ContainerID ,94 as PODNamespace ,95 as PODName ,96 as SourceExternalDynamicList ,97 as DestinationExternalDynamicList ,98 as HostID ,99 as UserDeviceSerialNumber ,100 as SourceDynamicAddressGroup ,101 as DestinationDynamicAddressGroup ,102 as SessionOwner ,103 as HighResolutionTimestamp ,104 as ASliceServiceType ,105 as ASliceDifferentiator
| json field=raw "labels[*].name" as label_name 
 
```
### Use Cases:
Allowed Network Activity by Direction, Allowed Traffic Over Time, App is Incomplete, Not-Applicable, or Insufficient Data, App is Named, Daily Trend, Day Over Day Outbound DNS Activity, Denied Traffic Over Time, Detail, DNS Traffic - Multi-Dimensional Outlier (Outbound), DNS Traffic - Parameterized Outlier Lookup, Horizontal Port Scanning (1src, 1port, multi-dest), INBOUND Traffic from OFAC Countries, Outbound DNS by src_ip, Outbound Traffic by App, Outbound Traffic by src_ip, Outbound Traffic Deltas by App - Now vs Last Week, Same Time Window, OUTBOUND Traffic to OFAC Countries, Port Scanning Behavior (1src, 1dst, multi-port), Port Scanning Behavior (1src, 1port, multi-dest), Source IP by Bytes Sent, Stacked Count by Port, THREAT Traffic Categories by Timeslice, Top 10 Host - Receiving Inbound Traffic, Top 10 Host - Sending Outbound Traffic, Top 20 Hosts with Outbound DNS Traffic, Top 20 Hosts with Outbound Traffic, Top Destination IP, Top Source IP, Total, Traffic from OFAC Countries - Inbound, Traffic to OFAC Countries - Outbound, Trend, Vertical Port Scan (1src, 1dst, multi-port)



## Parser:
```
| csv _raw extract 1 as f1, 2 as Receive_Time, 3 as serialNum, 4 as type, 5 as subtype, 6 as f2, 7 as LogGenerationTime, 8 as src_ip, 9 as dest_ip, 10 as NAT_src_ip, 11 as NAT_dest_ip, 12 as ruleName, 13 as src_user, 14 as dest_user, 15 as app, 16 as vsys, 17 as src_zone, 18 as dest_zone, 19 as inbound_interface, 20 as outbound_interface, 21 as LogAction, 22 as f3, 23 as SessonID, 24 as RepeatCount, 25 as src_port, 26 as dest_port, 27 as NAT_src_port, 28 as NAT_dest_port, 29 as flags, 30 as protocol, 31 as action, 32 as urlORFileName, 33 as Threat_Content_Name, 34 as category, 35 as severity, 36 as direction, 37 as seqNum, 38 as action_flags, 39 as src_country, 40 as dest_country, 41 as f4, 42 as content_type, 43 as pcap_id, 44 as filedigest, 45 as cloud, 46 as url_idx, 47 as user_agent, 48 as filetype, 49 as xff, 50 as referer, 51 as sender, 52 as subject, 53 as recipient, 54 as reportid, 55 as Device_Group_Hierarchy_l1, 56 as Device_Group_Hierarchy_l2, 57 as Device_Group_Hierarchy_l3, 58 as Device_Group_Hierarchy_l4, 59 as vsys_name, 60 as DeviceName, 61 as f5, 62 as Source_VM_UUID, 63 as Destination_VM_UUID, 64 as method, 65 as Tunnel_ID_IMSI, 66 as Monitor_Tag_IMEI, 67 as Parent_Session_ID, 68 as parent_start_time, 69 as Tunnel, 70 as thr_category, 71 as contentver, 72 as f6, 73 as SCTP_Association_ID, 74 as Payload_Protocol_ID, 75 as http_headers, 76 as URLCategoryList, 77 as UUIDforrule, 78 as HTTP2Connection, 79 as DynamicUserGroupName, 80 as XFFAddress, 81 as SourceDeviceCategory, 82 as SourceDeviceProfile, 83 as SourceDeviceModel, 84 as SourceDeviceVendor, 85 as SourceDeviceOSFamily, 86 as SourceDeviceOSVersion, 87 as SourceHostname, 88 as SourceMACAddress, 89 as DestinationDeviceCategory, 90 as DestinationDeviceProfile, 91 as DestinationDeviceModel, 92 as DestinationDeviceVendor, 93 as DestinationDeviceOSFamily, 94 as DestinationDeviceOSVersion, 95 as DestinationHostname, 96 as DestinationMACAddress, 97 as ContainerID, 98 as PODNamespace, 99 as PODName, 100 as SourceExternalDynamicList, 101 as DestinationExternalDynamicList, 102 as HostID, 103 as UserDeviceSerialNumber, 104 as DomainEDL, 105 as SourceDynamicAddressGroup, 106 as DestinationDynamicAddressGroup, 107 as PartialHash, 108 as HighResolutionTimestamp, 109 as Reason, 110 as Justification, 111 as ASliceServiceTyp
 
```
### Use Cases:
Allowed Network Activity by Direction, Allowed Traffic Over Time, App is Incomplete, Not-Applicable, or Insufficient Data, App is Named, Daily Trend, Day Over Day Outbound DNS Activity, Denied Traffic Over Time, Detail, DNS Traffic - Multi-Dimensional Outlier (Outbound), DNS Traffic - Parameterized Outlier Lookup, Horizontal Port Scanning (1src, 1port, multi-dest), INBOUND Traffic from OFAC Countries, Outbound DNS by src_ip, Outbound Traffic by App, Outbound Traffic by src_ip, Outbound Traffic Deltas by App - Now vs Last Week, Same Time Window, OUTBOUND Traffic to OFAC Countries, Port Scanning Behavior (1src, 1dst, multi-port), Port Scanning Behavior (1src, 1port, multi-dest), Source IP by Bytes Sent, Stacked Count by Port, THREAT Traffic Categories by Timeslice, Top 10 Host - Receiving Inbound Traffic, Top 10 Host - Sending Outbound Traffic, Top 20 Hosts with Outbound DNS Traffic, Top 20 Hosts with Outbound Traffic, Top Destination IP, Top Source IP, Total, Traffic from OFAC Countries - Inbound, Traffic to OFAC Countries - Outbound, Trend, Vertical Port Scan (1src, 1dst, multi-port)


